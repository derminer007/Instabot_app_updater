const {app,BrowserWindow,ipcMain,dialog}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),ANZAHL_FOLLOWER_BUTTON='div.x9f619.x1n2onr6\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_NEW_MSG_BUTTON='div.x1i10hfl.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.x6s0dn4.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x1ypdohk.x78zum5.xl56j7k.x1y1aw1k.x1sxyh0.xwib8y2.xurb0ha.xcdnw81',K_SEARCH_BAR_INPUT='body\x20>\x20div.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x1k90msu.x6o7n8i.x1qfuztq.x10l6tqk.x17qophe.x13vifvy.x1hc1fzr.x71s49j.xh8yej3\x20>\x20div\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.x1q0g3np.x1a02dak.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20input',K_USERNAME_SPALTE_PART1='div:nth-child(',K_CLEARNAME_SPALTE_PART2=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1pi30zi.x1swvt13.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span\x20>\x20span',K_CHAT_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.x972fbf.xcfux6l.x1qhh985.xm0m39n.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.xexx8yu.x18d9i69.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1lq5wgf.xgqcy7u.x30kzoy.x9jhf4c.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x9bdzbf.x1ypdohk.x78zum5.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x1n2onr6.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xn3w4p2.x5ib6vp.xc73u3c.x1tu34mt.xzloghq',K_NACHRICHT_SCHREIBEN_INPUT_DIV='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1i64zmx.xw3qccf.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f.notranslate',K_SENDEN_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.xfs2ol5[role=\x22button\x22][tabindex=\x220\x22]',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_SPAN_PART2=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x3b090a=new BrowserWindow({'width':0x320,'height':0x258,'webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x3b090a['loadFile'](path['join'](__dirname,'index.html'));}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x16a48b){var _0x59b217=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x18906f){console['log']('window\x20id:'+_0x18906f['id']),_0x18906f['id']>0x1&&(_0x59b217=!![]);}),console['log']('child\x20opened\x20='+_0x59b217);if(!_0x59b217){const _0xd4eb0a=new BrowserWindow({'width':0x320,'height':0x258,'webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0xd4eb0a['loadFile'](_0x16a48b['url']);}else console['log']('child\x20window\x20opened\x20already');}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x4e2cb8=0x1,_0x4b0115=0x0){let _0x6dfd60='',_0x1ca16a=null;if(process['platform']==='darwin')_0x6dfd60='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome';else{if(process['platform']==='win32')_0x6dfd60='chromium_local/chrome-win/chrome.exe';else{if(process['platform']==='linux'){}}}if(_0x4e2cb8===0x0&&!pageStack[_0x4b0115])return browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0x6dfd60}),_0x1ca16a=await browser['newPage'](),_0x1ca16a['setDefaultNavigationTimeout'](0x1d4c),_0x1ca16a['setDefaultTimeout'](0x1d4c),pageStack[_0x4b0115]=_0x1ca16a,_0x1ca16a;return(browser===null||pageStack[_0x4b0115]['isClosed']())&&(browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0x6dfd60})),(pageStack[_0x4b0115]===null||pageStack[_0x4b0115]['isClosed']())&&(_0x1ca16a=await browser['newPage'](),_0x1ca16a['setDefaultNavigationTimeout'](0x1d4c),_0x1ca16a['setDefaultTimeout'](0x1d4c),pageStack[_0x4b0115]=_0x1ca16a),pageStack[_0x4b0115];}ipcMain['on']('login',async(_0x188d7b,_0x496db8,_0x502b3e)=>{const _0x640019=await getBrowserPage();await _0x640019['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x640019,_0x496db8,_0x502b3e),setTimeout(async()=>{await browser['close']();},0x1388);}),ipcMain['handle']('sendMessage',async(_0x442320,_0x229c18,_0x3eaaa8,_0x533e76,_0x15256f,_0x49a3cf,_0x40b050,_0x50a412)=>{isStopping=![];let _0x6edb74=null;return _0x40b050?_0x6edb74=await getBrowserPage(_0x15256f,_0x50a412):_0x6edb74=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x229c18),new Promise((_0x273f0a,_0x9aeb6f)=>{send_message(_0x6edb74,_0x229c18,_0x3eaaa8,_0x533e76,_0x15256f,_0x49a3cf)['then'](_0xed4f61=>_0x273f0a(_0xed4f61))['catch'](_0x36837c=>_0x9aeb6f(_0x36837c));});}),ipcMain['handle']('stop-action',async(_0x111d48,_0x4e5a33)=>{isStopping=!![];const _0x3a993c=await getBrowserPage(0x1,_0x4e5a33);await _0x3a993c['close']();}),ipcMain['handle']('fetch_followers',async(_0x286f0b,_0x5d1121,_0x2670bc,_0x1f231d,_0x4d8b45)=>{isStopping=![];const _0x27b9e1=await getBrowserPage();return fetch_followers_from_account(_0x27b9e1,_0x5d1121,_0x2670bc,_0x1f231d,_0x4d8b45);}),ipcMain['handle']('fetch_likes',async(_0x2b07c4,_0x21c6c4,_0x249914,_0x38648a,_0x27af37)=>{isStopping=![];const _0xb003f5=await getBrowserPage();return fetch_likers_from_post(_0xb003f5,_0x21c6c4,_0x249914,_0x38648a,_0x27af37);}),ipcMain['handle']('fetch_comments',async(_0x40f1d8,_0x31708e,_0x12154f,_0x5bfded,_0x8aba5e)=>{isStopping=![];const _0x26ae38=await getBrowserPage();return fetch_comments_from_post(_0x26ae38,_0x31708e,_0x12154f,_0x5bfded,_0x8aba5e);}),ipcMain['handle']('update-app',async _0x403dbf=>{const {spawn:_0x2d51d0}=require('child_process'),_0x4f2431=require('path');if(process['platform']==='darwin'){const _0x4e3d64=_0x4f2431['join'](__dirname,'mac-updater-intern.sh'),_0x4ab502=_0x2d51d0('/bin/bash',[_0x4e3d64]);_0x4ab502['stdout']['on']('data',_0x57d931=>{console['log']('stdout:\x20'+_0x57d931);}),_0x4ab502['stderr']['on']('data',_0x2cdffc=>{console['error']('stderr:\x20'+_0x2cdffc);}),_0x4ab502['on']('close',_0xdb135c=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0xdb135c);});}else{if(process['platform']==='win32'){const _0xf92d39=_0x4f2431['join'](__dirname,'../','../','../');process['chdir'](_0xf92d39),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x5792ae='soft-ui-updater-windows.ps1',_0xe3849c='soft-ui-updater-windows.exe',_0x38f7ad=_0x2d51d0('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x5792ae]);console['log']('Windows\x20Pfad:\x20'+_0xf92d39),_0x38f7ad['stdout']['on']('data',_0x3be4da=>{console['log']('stdout:\x20'+_0x3be4da);}),_0x38f7ad['stderr']['on']('data',_0x31e013=>{console['error']('stderr:\x20'+_0x31e013);}),_0x38f7ad['on']('close',_0x443b00=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x443b00);});}}});function getRnd(_0x5bd93f,_0x42dddb){return Math['random']()*(_0x42dddb-_0x5bd93f+0x1)+_0x5bd93f;}function delay(_0xc4b6da,_0x108280){let _0x5552aa=getRnd(_0xc4b6da,_0x108280);return new Promise(function(_0x525e60){setTimeout(_0x525e60,_0x5552aa);});}async function scroll(_0x1232e6,_0x24b585,_0x5b7786=0x2){const _0x218ccf=await _0x1232e6['waitForSelector'](_0x24b585);for(let _0x11fdaa=0x0;_0x11fdaa<_0x5b7786;_0x11fdaa++){console['log']('Scrolling\x20'+_0x11fdaa),await _0x1232e6['evaluate'](_0x3c0603=>{const _0x41d6c1=document['querySelector'](_0x3c0603);_0x41d6c1&&_0x41d6c1['scrollBy'](0x0,0x190);},_0x24b585),await delay(0x320,0x5dc);}}async function saveCookies(_0x1009ee){let _0x597d14=await _0x1009ee['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x597d14,null,0x2));}async function notificationClear(_0x560ffd){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x560ffd['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x560ffd['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x117df3){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x117df3);}}async function getTargetProfiles(_0x4974d4){return new Promise((_0xad415e,_0x23292e)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x4974d4,(_0x2dc9fa,_0x397cec)=>{_0x2dc9fa?_0x23292e(_0x2dc9fa):_0xad415e(_0x397cec);});});}async function login(_0x59f886,_0x3daf35,_0x582860){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x59f886,_0x3daf35),await createUserIfNotExists(_0x3daf35,_0x582860);}catch(_0x4d0b48){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4d0b48);}try{await _0x59f886['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x59f886['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x59f886['click']('button._a9--._ap36._a9_0');}catch(_0xe74eed){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x59f886['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x59f886['type']('input[name=\x27username\x27]',_0x3daf35,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x59f886['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x59f886['type']('input[name=\x27password\x27]',_0x582860,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x59f886['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x59f886['click']('button[type=\x27submit\x27]');}catch(_0x742478){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x59f886),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x59f886,_0x3daf35);}catch(_0xab199f){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0xab199f);}}catch(_0x3f8588){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x3f8588);}}async function send_message(_0x31aca8,_0x5468e2,_0x1be5aa,_0x211f78,_0x10e6c2,_0x5f8280){_0x5f8280=_0x5f8280['split'](';'),console['log'](_0x5f8280[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x10e6c2);if(_0x10e6c2==0x0){try{await login(_0x31aca8,_0x5f8280[0x0],_0x5f8280[0x1]);}catch(_0x181faa){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x181faa);return;}await _0x31aca8['goto']('https://www.instagram.com/direct/inbox/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x31aca8);}let _0x5c188d;await set_clearname_from_username(_0x31aca8,_0x1be5aa);const _0x401bea='SELECT\x20clearname\x20FROM\x20'+_0x1be5aa+'\x20WHERE\x20username\x20IS\x20?';db['all'](_0x401bea,[_0x5468e2],(_0x522ec6,_0x1085b3)=>{_0x522ec6&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x522ec6['message']);if(_0x1085b3['length']===0x0)return;_0x5c188d=_0x1085b3['map'](_0x3ee19f=>_0x3ee19f['clearname']);});try{try{const _0x110c3b=K_NEW_MSG_BUTTON;await delay(0xfa0,0x1d4c),await _0x31aca8['waitForSelector'](_0x110c3b),await _0x31aca8['click'](_0x110c3b),console['log']('Message-Button\x20geklickt'),console['log'](_0x5468e2+'\x20'+_0x211f78),await delay(0xfa0,0x1d4c);try{const _0x388bba='input[name=\x22queryBox\x22]',_0x31e28f=K_SEARCH_BAR_INPUT;await _0x31aca8['waitForSelector'](_0x31e28f),await _0x31aca8['click'](_0x31e28f),await delay(0xfa0,0x1d4c),await _0x31aca8['waitForSelector'](_0x388bba),await _0x31aca8['click'](_0x388bba),await delay(0xfa0,0x1d4c),await _0x31aca8['type'](_0x388bba,_0x5468e2,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),console['log']('Account\x20Name\x20eingefügt');const _0x2d431c=K_USERNAME_SPALTE_PART1,_0x32bbfc=K_CLEARNAME_SPALTE_PART2;let _0x48d4eb=0x1;try{while(_0x48d4eb!=0x14){console['log']('Schleife');let _0x4b66a2=_0x2d431c+_0x48d4eb+_0x32bbfc;const _0x5d173b=await _0x31aca8['waitForSelector'](_0x4b66a2),_0x434df3=await _0x31aca8['evaluate'](_0x38ab40=>_0x38ab40['innerHTML'],_0x5d173b);console['log'](_0x434df3+';'+_0x5c188d+';'+_0x5468e2),delay(0x3e8,0xbb8);if(_0x434df3==_0x5c188d){console['log']('Account\x20gefunden'),await _0x31aca8['click'](_0x4b66a2);break;}else{if(_0x434df3==_0x5468e2){console['log']('Account\x20gefunden'),await _0x31aca8['click'](_0x4b66a2);break;}}_0x48d4eb++;}try{await delay(0xbb8,0x1388);const _0x303d22=await _0x31aca8['waitForSelector'](K_CHAT_BUTTON_DIV);console['log'](_0x303d22),await delay(0xbb8,0x1388),await _0x303d22['click']();try{await delay(0xbb8,0x1388);const _0x51a7f4=await _0x31aca8['waitForSelector'](K_NACHRICHT_SCHREIBEN_INPUT_DIV);await _0x51a7f4['type'](_0x211f78,{'delay':getRnd(0x50,0x78)}),await delay(0xbb8,0x1388);try{const _0x5c5e73=await _0x31aca8['waitForSelector'](K_SENDEN_BUTTON_DIV);return await _0x5c5e73['click'](),await delay(0xbb8,0x1388),new Promise(_0x59312f=>{_0x59312f('Nachricht\x20erfolgreich\x20verschickt!');});}catch(_0x20ea77){console['log']('Message-Button\x20nicht\x20geklickt:\x20'+_0x20ea77);}}catch(_0x17fdcb){console['log']('Chat-Fenster\x20nicht\x20gefunden:\x20'+_0x17fdcb);}}catch(_0x4072ea){console['log']('error:\x20'+_0x4072ea);}}catch(_0x1870ff){return console['log']('User\x20nicht\x20gefunden:'+_0x1870ff),await _0x31aca8['goto']('https://www.instagram.com/direct/inbox/'),new Promise((_0x3f6e81,_0x3e3bb2)=>{_0x3e3bb2('user_not_found');});}}catch(_0x3b0b86){console['log']('DM-Fenster\x20nicht\x20gefunden:'+_0x3b0b86);}}catch(_0x6e9220){console['log']('Message-Button\x20nicht\x20geklickt:'+_0x6e9220);}}catch(_0x24b673){console['log']('Nachricht\x20senden\x20fehlgeschlagen:\x20'+_0x24b673);}return console['log']('Ende'),await _0x31aca8['goto']('https://www.instagram.com/direct/inbox/'),new Promise((_0x4d2247,_0x252db1)=>{_0x252db1('ig_update');});}function handle_fail(_0x44b3df){if(isStopping)return new Promise(_0x42b221=>{_0x42b221('Scraper\x20gestoppt.');});else{let _0x1abb6b='';switch(_0x44b3df){case 0x0:_0x1abb6b='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x1abb6b='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x1abb6b='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x1abb6b='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x3027d3,_0x2006b3)=>{_0x2006b3(_0x1abb6b);});}}async function fetch_followers_from_account(_0x534a80,_0x37f7f6,_0x3564bf,_0x4b0f4a,_0xc46522){try{await login(_0x534a80,_0xc46522['username'],_0xc46522['password']);}catch(_0x526226){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x526226),handle_fail(0x0);}let _0x5de455=0x0;try{await _0x534a80['goto']('https://www.instagram.com/'+_0x37f7f6+'/'),await notificationClear(_0x534a80);try{if(_0x3564bf<=0x0){const _0x2df9b1=await _0x534a80['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x2dcacc=await _0x534a80['evaluate'](_0x46b52b=>_0x46b52b['innerHTML'],_0x2df9b1);_0x5de455=Math['ceil'](_0x2dcacc/0x4);}else _0x5de455=Math['ceil'](_0x3564bf/0x4);let _0x359dac=await _0x534a80['waitForSelector'](FOLLOWER_BUTTON);await delay(0xbb8,0x1388),await _0x359dac['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x37f7f6+'\x20gesichtet');}catch(_0x7f6b0e){return console['log']('Follower\x20Liste\x20von\x20'+_0x37f7f6+'\x20nicht\x20gefunden:'+_0x7f6b0e),handle_fail(0x0);}}catch(_0x223bd6){return console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x223bd6),handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x5de455),await scroll(_0x534a80,FOLLOWER_FENSTER,_0x5de455),await _0x534a80['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x51fd51=await _0x534a80['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x327d50=await _0x534a80['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x3564bf<=0x0&&(_0x3564bf=_0x51fd51['length']);for(let _0x4d1f6a=0x0;_0x4d1f6a<_0x51fd51['length']&&_0x4d1f6a<_0x3564bf;_0x4d1f6a++){console['log'](await _0x51fd51[_0x4d1f6a]['evaluate'](_0x40af14=>_0x40af14['textContent']));const _0x3f9c58='INSERT\x20INTO\x20'+_0x4b0f4a+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x3f9c58,[await _0x51fd51[_0x4d1f6a]['evaluate'](_0x3e5edb=>_0x3e5edb['textContent']),await _0x327d50[_0x4d1f6a]['evaluate'](_0x22e754=>_0x22e754['textContent'])],function(_0x564dbe){_0x564dbe?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x4b0f4a+'\x27:',_0x564dbe['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return new Promise(_0x39c928=>{_0x39c928('Scraping\x20finished!');});}catch(_0x5c6466){return console['log']('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x37f7f6+'\x20nicht\x20gefunden:'+_0x5c6466),handle_fail(0x0);}}async function fetch_likers_from_post(_0x1a4603,_0x494648,_0xdc0eef,_0x1c0b56,_0x513fe7){try{await login(_0x1a4603,_0x513fe7['username'],_0x513fe7['password']);}catch(_0x3d6a14){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x3d6a14);return handle_fail(0x1);return;}try{let _0x116a82=_0x494648['substring'](0x0,_0x494648['lastIndexOf']('/')),_0xe1d7b0=_0x116a82+'/liked_by';console['log'](_0xe1d7b0),await _0x1a4603['goto'](_0xe1d7b0),await delay(0x7d0,0xfa0),await notificationClear(_0x1a4603),await delay(0xc8,0x1f4),await _0x1a4603['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x2dbd48=await _0x1a4603['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x3b8343=await _0x1a4603['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x2dbd48['length']);let _0x5d6540=path['join'](__dirname,'/likers.csv');_0xdc0eef<=0x0&&(_0xdc0eef=_0x2dbd48['length']);try{for(let _0x5e4d0e=0x0;_0x5e4d0e<_0x2dbd48['length']&&_0x5e4d0e<_0xdc0eef;_0x5e4d0e++){console['log'](await _0x2dbd48[_0x5e4d0e]['evaluate'](_0x2d4c85=>_0x2d4c85['textContent']));try{const _0x3873c2='INSERT\x20INTO\x20'+_0x1c0b56+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x3873c2,[await _0x2dbd48[_0x5e4d0e]['evaluate'](_0x168098=>_0x168098['textContent']),await _0x3b8343[_0x5e4d0e]['evaluate'](_0x2a54e7=>_0x2a54e7['textContent'])],function(_0x2115e9){_0x2115e9?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x1c0b56+'\x27:',_0x2115e9['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x65dd4d){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x5e4d0e+'\x20:\x20'+_0x65dd4d),handle_fail(0x1);}}return new Promise(_0x386402=>{_0x386402('Scraping\x20finished!');});}catch(_0x39d8c8){return console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben'),handle_fail(0x1);}}catch(_0x2a6f35){return console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x2a6f35),handle_fail(0x1);}}async function fetch_comments_from_post(_0x13da57,_0x2908d1,_0x102d08,_0x3e972a,_0x2fc01b){try{await login(_0x13da57,_0x2fc01b['username'],_0x2fc01b['password']);}catch(_0x24f348){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x24f348),handle_fail(0x2);}try{console['log'](_0x2908d1),await _0x13da57['goto'](_0x2908d1),await delay(0x7d0,0xfa0),await notificationClear(_0x13da57),await delay(0xc8,0x1f4);const _0x5cff58=COM_COMMENTS_BOX_BODY_DIV;let _0x2be3e2;if(_0x102d08<=0x0){const _0x540fe7=await _0x13da57['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x50882b=await _0x13da57['evaluate'](_0x31ac12=>_0x31ac12['innerHTML'],_0x540fe7),_0x95b0dd=String(_0x50882b)['replace'](/[^0-9]/g,''),_0xecde9e=Number(_0x95b0dd)/0x14;_0x2be3e2=Math['ceil'](_0xecde9e/0x3);}else _0x2be3e2=Math['ceil'](_0x102d08/0x3);console['log']('Auto-scrolls:\x20'+_0x2be3e2),await scroll(_0x13da57,_0x5cff58,_0x2be3e2);try{const _0x129238=COM_REPLY_BUTTON_SPAN;await _0x13da57['waitForSelector'](_0x129238),await delay(0x1f4,0x320);const _0x3e0e69=await _0x13da57['$$'](_0x129238);console['log'](_0x3e0e69),await delay(0xc8,0x1f4);try{for(let _0x23f8dd=0x0;_0x23f8dd<_0x3e0e69['length'];_0x23f8dd++){_0x3e0e69[_0x23f8dd]['click'](),await delay(0x320,0x5dc);}}catch(_0x110119){return console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x110119),handle_fail(0x2);}}catch(_0x119b64){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x1113e7=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x13da57['waitForSelector'](_0x1113e7),await delay(0x1f4,0x320);const _0xcdf6a3=await _0x13da57['$$'](_0x1113e7);let _0x20eace=path['join'](__dirname,'/comments.csv');_0x102d08<=0x0&&(_0x102d08=_0xcdf6a3['length']);console['log']('fetch_limit:\x20'+_0x102d08),console['log']('comments_len:\x20'+_0xcdf6a3['length']),_0x102d08++;try{for(let _0x26c160=0x1;_0x26c160<_0xcdf6a3['length']&&_0x26c160<_0x102d08;_0x26c160++){try{console['log'](await _0xcdf6a3[_0x26c160]['evaluate'](_0x4fb1bd=>_0x4fb1bd['textContent']));const _0xa16bdd=await db['prepare']('INSERT\x20INTO\x20'+_0x3e972a+'\x20(username)\x20VALUES\x20(?)');await _0xa16bdd['run'](await _0xcdf6a3[_0x26c160]['evaluate'](_0x32b3f2=>_0x32b3f2['textContent']),function(_0x1730c0){_0x1730c0&&console['log']('error\x20in\x20add-user:'+_0x1730c0);}),await _0xa16bdd['finalize']();}catch(_0x3c3236){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x26c160+'\x20:\x20'+_0x3c3236),handle_fail(0x2);}}await delay(0x4b0,0x7d0);try{await set_clearname_from_username(_0x13da57,_0x3e972a);}catch(_0x24661b){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x24661b);}return new Promise(_0x28be95=>{_0x28be95('Scraping\x20finished!');});}catch(_0x5c6cdb){return console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben'),handle_fail(0x2);}}catch(_0x300872){return console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x300872),handle_fail(0x2);}}async function set_clearname_from_username(_0x56cafd,_0x277f36){try{let _0x18c806,_0x155f3c;const _0x3acecb='SELECT\x20username\x20FROM\x20'+_0x277f36+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x3acecb,[],(_0x5192c2,_0x114479)=>{_0x5192c2&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x5192c2['message']),_0x114479['length']===0x0&&(_0x155f3c=_0x114479['length']),_0x18c806=_0x114479['map'](_0x38a4cf=>_0x38a4cf['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x155f3c);if(_0x155f3c===0x0){console['log']('Leave');return;}const _0x5ec23c=await _0x56cafd['waitForSelector'](IG_SEARCH_BUTTON);await _0x5ec23c['click'](),await delay(0x4b0,0x7d0);for(let _0x234b6a of _0x18c806){const _0x18e14d=await _0x56cafd['waitForSelector'](IG_SEARCH_INPUT);await _0x18e14d['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x56cafd['type'](IG_SEARCH_INPUT,_0x234b6a,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x4c56be=0x1;while(_0x4c56be!=0x14){console['log']('Schleife');let _0x39b2a2=IG_NAME_SPAN_PART1+_0x4c56be+IG_USERNAME_SPAN_PART2;const _0x5487f9=await _0x56cafd['waitForSelector'](_0x39b2a2),_0x15df97=await _0x56cafd['evaluate'](_0x5aa9b5=>_0x5aa9b5['innerHTML'],_0x5487f9);await delay(0xc8,0x1f4);if(_0x15df97==_0x234b6a){let _0x3e082a=IG_NAME_SPAN_PART1+_0x4c56be+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x1e66f0=await _0x56cafd['waitForSelector'](_0x3e082a);let _0x58aa00=await _0x56cafd['evaluate'](_0x312db9=>_0x312db9['innerHTML'],_0x1e66f0);const _0x5d0274=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x5a3122=_0x58aa00['match'](_0x5d0274);_0x5a3122?_0x58aa00=_0x5a3122[0x1]['trim']():_0x58aa00=_0x58aa00['trim']();const _0x5e8573='UPDATE\x20'+_0x277f36+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x5e8573,[_0x58aa00,_0x15df97],function(_0x1c6725){_0x1c6725&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x1c6725['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x4c56be++;}}await _0x5ec23c['click']();}catch(_0x1bd80f){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.');}}const campaignPath=path['resolve'](__dirname,'data/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(campaign_name\x20TEXT\x20PRIMARY\x20KEY,\x20list_id\x20TEXT,\x20zeitabstand\x20REAL,\x20message_id\x20TEXT,\x20account\x20TEXT,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x398b74,_0x383dc3)=>{const _0x53d914='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x53d914,[],(_0x33677e,_0x4f9912)=>{_0x33677e?_0x383dc3(_0x33677e):_0x398b74(_0x4f9912);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x53d788,_0x46ca7e)=>{const _0x825bd2='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x825bd2,[],async(_0x156612,_0x5dda3e)=>{if(_0x156612)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x156612['message']),_0x46ca7e({'status':'error','message':_0x156612['message']});else try{const _0x251537=await Promise['all'](_0x5dda3e['map'](_0x14a3e9=>{return new Promise(_0x46ba2f=>{if(!_0x14a3e9['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x14a3e9['campaign_name']),_0x46ba2f({'campaign_name':_0x14a3e9['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x2c8b43='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x14a3e9['list_id'],_0x970147='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20'+_0x14a3e9['list_id']+'\x20WHERE\x20contacted\x20=\x201';db['get'](_0x2c8b43,[],(_0x534321,_0x39c3a9)=>{_0x534321?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x14a3e9['campaign_name']+':',_0x534321['message']),_0x46ba2f({'campaign_name':_0x14a3e9['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):db['get'](_0x970147,[],(_0x377ce4,_0x1c8466)=>{_0x377ce4?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x14a3e9['campaign_name']+':',_0x377ce4['message']),_0x46ba2f({'campaign_name':_0x14a3e9['campaign_name'],'lead_count':_0x39c3a9?_0x39c3a9['lead_count']:0x0,'contacted_count':'N/A'})):_0x46ba2f({'campaign_name':_0x14a3e9['campaign_name'],'lead_count':_0x39c3a9?_0x39c3a9['lead_count']:0x0,'contacted_count':_0x1c8466?_0x1c8466['contacted_count']:0x0});});});});}));_0x53d788({'status':'success','campaigns':_0x251537});}catch(_0x597ffd){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x597ffd),_0x46ca7e({'status':'error','message':_0x597ffd['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x17de98,_0x23c042)=>{return new Promise((_0x6f20da,_0x138622)=>{const _0x5c8a90='SELECT\x20campaign.list_id,\x20message.message_text,\x20campaign.zeitabstand,\x20campaign.account\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x5c8a90,[_0x23c042],(_0x38b71a,_0x38ee5d)=>{_0x38b71a?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x38b71a),_0x138622(_0x38b71a)):(console['log']('ROWS'),console['log'](_0x38ee5d),debugDatabaseContents(),_0x6f20da(_0x38ee5d));});});});const showTableContents=_0x41688d=>{return new Promise((_0x4a985b,_0x4b68a1)=>{const _0x7f471e='SELECT\x20*\x20FROM\x20'+_0x41688d+';';campaignDB['all'](_0x7f471e,(_0x50b397,_0x3d1dd1)=>{_0x50b397?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x41688d+':',_0x50b397),_0x4b68a1(_0x50b397)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x41688d+':',_0x3d1dd1),_0x4a985b({'status':'success','message':_0x3d1dd1}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x140c66){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x140c66);}}ipcMain['handle']('create-campaign',async(_0x477711,_0x3d4054)=>{return new Promise((_0x338d08,_0x1edbd8)=>{const _0x199461='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x199461,[String(_0x3d4054)],function(_0x1c4452){_0x1c4452?_0x1edbd8(_0x1c4452):_0x338d08({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x515ab7,_0xfef007)=>{return new Promise((_0x343b67,_0x2ed615)=>{const _0xb052da='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0xb052da,[_0xfef007],function(_0x4d2c3f){_0x4d2c3f?_0x2ed615(_0x4d2c3f):_0x343b67({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x483569,_0x5c34f8,_0x48c87e,_0x82d40a,_0x2cecfd,_0x43615a)=>{const _0x4154d8=await createMessageID(_0x2cecfd);return new Promise((_0x250dbe,_0x417f26)=>{if(!_0x5c34f8||!_0x48c87e||!_0x82d40a||!_0x4154d8||!_0x43615a)return _0x417f26({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x4154d8);const _0x1f2b02='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x1f2b02,[_0x48c87e,_0x82d40a,_0x4154d8,_0x43615a,_0x5c34f8],function(_0x36805d){if(_0x36805d)_0x417f26({'status':'error','message':_0x36805d['message']});else this['changes']===0x0?_0x417f26({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x250dbe({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x4a21cb,_0x2b86db,_0x444442,_0x30f7f1)=>{return new Promise((_0x15c01c,_0x42552a)=>{const _0x144bd7='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username)\x20VALUES\x20(?,\x20?,\x20?)';campaignDB['run'](_0x144bd7,[_0x2b86db,_0x444442,_0x30f7f1],function(_0x1ad8dc){return _0x1ad8dc?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x1ad8dc['message']),_0x42552a('insert-dm-response',{'success':![],'message':_0x1ad8dc['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x15c01c('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x550a9a=>{return new Promise((_0x3b83aa,_0x37c3ab)=>{const _0x398ba0='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x398ba0,[_0x550a9a],(_0xadb8c8,_0x26a905)=>{if(_0xadb8c8)_0x37c3ab({'status':'error','message':_0xadb8c8['message']});else{if(_0x26a905)_0x3b83aa(_0x26a905['message_id']);else{const _0x235d7a='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x235d7a,[_0x550a9a],function(_0x181389){_0x181389?_0x37c3ab({'status':'error','message':_0x181389['message']}):_0x3b83aa(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0xd18c7,_0x1e0d1f)=>{return new Promise((_0x4a10e9,_0x2e78af)=>{const _0x879934='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x1e0d1f;db['get'](_0x879934,(_0x3136ad,_0x5b1562)=>{_0x3136ad?_0x2e78af({'status':'error','message':_0x3136ad['message']}):_0x4a10e9({'status':'success','count':_0x5b1562['count']});});});});const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20password\x20TEXT,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x365627,_0x573c32){try{const _0x7444b8=await new Promise((_0x275350,_0x2ef2da)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x573c32],(_0x983c19,_0x19e04e)=>{if(_0x983c19)_0x2ef2da(_0x983c19);else{if(_0x19e04e['length']>0x0){let _0x2f66f5=JSON['parse'](_0x19e04e[0x0]['cookie']);console['log'](_0x2f66f5),_0x275350(_0x2f66f5);}else _0x2ef2da(new Error('User\x20with\x20username\x20'+_0x573c32+'\x20does\x20not\x20exist.'));}});});await _0x365627['setCookie'](..._0x7444b8),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x3054d9){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x3054d9);}}async function saveCookiesForUser(_0x2d38a7,_0x44f12b){try{let _0x5c7186=await _0x2d38a7['cookies']();_0x5c7186=JSON['stringify'](_0x5c7186),igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x44f12b],(_0x4a5cd,_0x3fe700)=>{if(_0x4a5cd){console['error']('Error\x20checking\x20user\x20existence:',_0x4a5cd);throw _0x4a5cd;}else{if(_0x3fe700){const _0x38552a=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x38552a['run'](_0x5c7186,_0x44f12b,function(_0x3b5ec5){_0x3b5ec5?console['error']('Error\x20updating\x20cookies:',_0x3b5ec5):console['log']('Cookies\x20updated\x20for\x20user:',_0x44f12b);});}else{const _0x541700=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x541700['run'](_0x44f12b,_0x5c7186,function(_0x334c56){_0x334c56?console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x334c56):console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x44f12b);});}}});}catch(_0x2c1616){console['error']('Error\x20fetching\x20cookies:',_0x2c1616);throw _0x2c1616;}}async function createUserIfNotExists(_0x536344,_0xc211b1){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x536344],(_0x4c0fe8,_0x5dff64)=>{if(_0x4c0fe8){console['error']('Error\x20checking\x20user\x20existence:',_0x4c0fe8);throw _0x4c0fe8;}else{if(!_0x5dff64){const _0x519345=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20password)\x20VALUES\x20(?,\x20?)');_0x519345['run'](_0x536344,_0xc211b1,function(_0x22c37d){_0x22c37d?console['error']('Error\x20inserting\x20new\x20user:',_0x22c37d):console['log']('New\x20user\x20created:',_0x536344);});}else console['log']('User\x20already\x20exists:',_0x536344);}});}catch(_0x3c43d8){console['error']('Error\x20creating\x20user:',_0x3c43d8);throw _0x3c43d8;}}ipcMain['handle']('create-relation',async(_0x57688f,_0x3a9fda)=>{return new Promise((_0x59e86d,_0x404f8c)=>{const _0x383b53='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x3a9fda+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT)';db['run'](_0x383b53,function(_0x3d81c3){_0x3d81c3?_0x404f8c(_0x3d81c3):_0x59e86d({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x360d5f,_0x1cdc34)=>{return console['log']('droping\x20table'+_0x1cdc34),new Promise((_0x305571,_0x415daf)=>{const _0x50ba03='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x1cdc34;console['log']('droping\x20table'+_0x1cdc34),db['run'](_0x50ba03,function(_0x2f4495){_0x2f4495?_0x415daf(_0x2f4495):_0x305571({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x1d982c=>{return new Promise((_0x5b5b41,_0x2610e0)=>{const _0x10ba9c='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x10ba9c,[],(_0x4932ed,_0x499def)=>{_0x4932ed?_0x2610e0(_0x4932ed):_0x5b5b41(_0x499def['map'](_0x524524=>_0x524524['name']));});});}),ipcMain['handle']('add-user',async(_0x2a68e3,_0x23491f,_0x3a4518)=>{return new Promise(_0x427656=>{const _0x2bcccf=db['prepare']('INSERT\x20INTO\x20'+_0x3a4518+'\x20(username)\x20VALUES\x20(?)');_0x2bcccf['run'](_0x23491f,function(_0x34c0d0){_0x34c0d0?console['log']('error\x20in\x20add-user:'+_0x34c0d0):_0x427656({'status':'success','id':this['lastID']});}),_0x2bcccf['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x1d7c75,_0x24d795)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x1228b7,_0x4fa5e4)=>{if(_0x1228b7)_0x24d795(_0x1228b7);else{_0x1d7c75({'status':'success','users':_0x4fa5e4});for(_0x4fa5e4 of _0x4fa5e4){console['log'](_0x4fa5e4['username']);}}});});}),ipcMain['handle']('get-data',async(_0x3dc87b,_0x2a8ac0)=>{return new Promise((_0xb9ea03,_0x28c7e4)=>{const _0x4b18ab='SELECT\x20*\x20FROM\x20'+_0x2a8ac0;console['log'](_0x4b18ab),db['all'](_0x4b18ab,[],(_0x7576c3,_0x40c4e9)=>{_0x7576c3?_0x28c7e4(_0x7576c3):_0xb9ea03(_0x40c4e9);});});}),ipcMain['handle']('get-accounts',async _0xbcadee=>{return new Promise((_0x44726d,_0x5177c2)=>{const _0x145c57='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x145c57),igaccountsDB['all'](_0x145c57,[],(_0x39ab30,_0x5248c3)=>{_0x39ab30?_0x5177c2(_0x39ab30):_0x44726d(_0x5248c3);});});}),ipcMain['handle']('get-targets',async(_0x3ba986,_0x4b4390)=>{return getTargetProfiles(_0x4b4390);}),ipcMain['handle']('delete-user',async(_0x43a997,_0xf7d716,_0x58d132)=>{return new Promise((_0x280714,_0x1292b1)=>{const _0x30687e=db['prepare']('DELETE\x20FROM\x20'+_0x58d132+'\x20WHERE\x20username\x20=\x20?');_0x30687e['run'](_0xf7d716,function(_0x1fbe63){_0x1fbe63?_0x1292b1(_0x1fbe63):_0x280714({'status':'success','changes':this['changes']});}),_0x30687e['finalize']();});}),ipcMain['handle']('delete-account',async(_0x247a67,_0xb25cda)=>{const _0x32a236=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x32a236['run'](_0xb25cda,function(_0x5cab7d){_0x5cab7d&&console['log'](_0x5cab7d);}),_0x32a236['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x4387ce,_0x39a337)=>{const _0x177016='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x177016,[],(_0x331567,_0x19dd8d)=>{_0x331567?_0x39a337({'status':'error','message':_0x331567['message']}):_0x4387ce({'status':'success','contactedCount':_0x19dd8d['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x45bbbc,_0x37d4e1)=>{const _0x2db30f='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x2db30f,[],(_0x576f9a,_0x504400)=>{_0x576f9a?_0x37d4e1({'status':'error','message':_0x576f9a['message']}):_0x45bbbc({'status':'success','contactedCount':_0x504400['contactedCount']});});});});