const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');async function extractFirstName(_0x449c7c,_0x3974cf){try{const _0x2f2a87=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x3974cf},'body':JSON['stringify']({'clearname':_0x449c7c})});if(!_0x2f2a87['ok']){const _0x19196b=await _0x2f2a87['text']();throw new Error(_0x2f2a87['status']+':\x20'+_0x19196b);}const _0x3ef4d0=await _0x2f2a87['json']();return _0x3ef4d0;}catch(_0x26150c){console['error']('Error\x20in\x20extractFirstName:',_0x26150c);throw _0x26150c;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div:has(>\x20div[style=\x22height:\x20auto;\x20overflow:\x20hidden\x20auto;\x22])',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Message\x27]','div.x9f619.xjbqb8w.x78zum5.x15mokao.x1ga7v0g.x16uus16.xbiv7yw.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div','div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div'],K_OPTIONS_BUTTON=['[aria-label=\x22Options\x22]','section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.x1jfgfrl\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div'],K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD=['[aria-label=\x22Message\x22]','div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f'],K_SEND_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Send\x27]','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_ALREADY_CHATTED='[aria-label=\x22Double\x20tap\x20to\x20like\x22]',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x4c5297=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x4c5297['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x4c5297['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x47a3aa){var _0x3f4e43=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x108b3f){console['log']('window\x20id:'+_0x108b3f['id']),_0x108b3f['id']>0x1&&(_0x3f4e43=!![]);}),console['log']('child\x20opened\x20='+_0x3f4e43);if(!_0x3f4e43){const _0x1f458d=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x1f458d['loadFile'](_0x47a3aa['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x34b062=require('fs'),_0x2b101f=path['join'](app['getPath']('userData'),'data'),_0x22156b=['campaign.db','crm.db','igaccounts.db'],_0x4737eb=[];try{_0x34b062['mkdirSync'](_0x2b101f,{'recursive':!![]});for(const _0x2308be of _0x22156b){const _0x26206e=path['join'](process['resourcesPath'],'app','build','data',_0x2308be),_0x391e5c=path['join'](_0x2b101f,_0x2308be);!_0x34b062['existsSync'](_0x391e5c)?(_0x34b062['copyFileSync'](_0x26206e,_0x391e5c),console['log']('[InitDB]\x20Kopiert\x20'+_0x2308be+'\x20nach:\x20'+_0x391e5c)):console['log']('[InitDB]\x20'+_0x2308be+'\x20existiert\x20bereits:\x20'+_0x391e5c),_0x4737eb['push'](_0x391e5c);}}catch(_0x2b0474){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x2b0474);}return _0x4737eb;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x5a4534,AppUpdate:_0x14d4c2}=require('electron-updater');_0x5a4534['autoDownload']=![],_0x5a4534['autoInstallOnAppQuit']=!![],_0x5a4534['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x5a4534['on']('update-available',_0x56da01=>{console['log']('Update\x20verfügbar:',_0x56da01),_0x5a4534['downloadUpdate']();}),_0x5a4534['on']('update-downloaded',_0x4618ac=>{console['log']('Update\x20heruntergeladen:',_0x4618ac),_0x5a4534['quitAndInstall']();}),_0x5a4534['on']('error',_0x1d4e8a=>{console['error']('Fehler\x20beim\x20Updaten:',_0x1d4e8a);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x4bcc61,AppUpdate:_0x5152b7}=require('electron-updater');_0x4bcc61['autoDownload']=![],_0x4bcc61['autoInstallOnAppQuit']=!![],_0x4bcc61['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x4bcc61['on']('update-available',_0x13413b=>{console['log']('Update\x20verfügbar:',_0x13413b),_0x4bcc61['downloadUpdate']();}),_0x4bcc61['on']('update-downloaded',_0x4304b7=>{console['log']('Update\x20heruntergeladen:',_0x4304b7),console['log']('Neustarten\x20zum\x20Updaten');}),_0x4bcc61['on']('error',_0x35eb15=>{console['error']('Fehler\x20beim\x20Updaten:',_0x35eb15);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x46db0e='',_0x7e31db=null;if(process['platform']==='darwin')_0x46db0e=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x46db0e=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x46db0e}),_0x7e31db=await browser_login['newPage'](),_0x7e31db['setDefaultNavigationTimeout'](0x1d4c),_0x7e31db['setDefaultTimeout'](0x1d4c),await _0x7e31db['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x7e31db;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x51396e=0x1,_0x2b01d4=0x0){try{let _0x4a3163='',_0x170bc6=null;const _0xd01edc=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x4a3163=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x4a3163=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x51396e===0x0&&!pageStack[_0x2b01d4])return browser=await puppeteer['launch']({'headless':_0xd01edc,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x4a3163}),_0x170bc6=await browser['newPage'](),_0x170bc6['setDefaultNavigationTimeout'](0x1d4c),_0x170bc6['setDefaultTimeout'](0x1d4c),await _0x170bc6['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x2b01d4]=_0x170bc6,_0x170bc6;return(browser===null||pageStack[_0x2b01d4]===null||pageStack[_0x2b01d4]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0xd01edc,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x4a3163})),(pageStack[_0x2b01d4]===null||pageStack[_0x2b01d4]['isClosed']())&&(_0x170bc6=await browser['newPage'](),_0x170bc6['setDefaultNavigationTimeout'](0x1d4c),_0x170bc6['setDefaultTimeout'](0x1d4c),await _0x170bc6['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x2b01d4]=_0x170bc6),pageStack[_0x2b01d4];}catch(_0x419e9c){console['error']('Failed\x20to\x20launch\x20browser:',_0x419e9c);const _0x29a1c1=new Error('Browser\x20konnte\x20nicht\x20gestartet\x20werden.\x20Bitte\x20starte\x20die\x20App\x20neu.\x20:\x20'+_0x419e9c);throw _0x29a1c1;}}ipcMain['on']('login',async(_0x3f0dd4,_0x1d96b5)=>{const _0x46a08f=await getBrowserPageLogin();await _0x46a08f['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x46a08f,_0x1d96b5),ipcMain['on']('setLoginCookies',async(_0x13d1ee,_0x1f053e)=>{try{await set_login_cookies(_0x46a08f,_0x1f053e);}catch(_0x123a8c){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x123a8c);}});}),ipcMain['on']('export-relation',async(_0x5decaf,_0x29f67f)=>{try{await exportDatabase(_0x29f67f),_0x5decaf['reply']('export-relation-response',{'success':!![]});}catch(_0x1d464d){console['error'](_0x1d464d),_0x5decaf['reply']('export-relation-response',{'success':![],'message':_0x1d464d['message']});}}),ipcMain['handle']('sendMessage',async(_0x45fb8a,_0x323c29,_0x498b43,_0x28587a,_0x3e92b3,_0x42daa6,_0x319947,_0x5e0979,_0xdfddde,_0x1a5786,_0x928c1e)=>{isStopping=![];let _0x26d1e4=null;return _0x319947?_0x26d1e4=await getBrowserPage(_0x3e92b3,_0x5e0979):_0x26d1e4=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x323c29),send_message(_0x26d1e4,_0x323c29,_0x498b43,_0x28587a,_0x3e92b3,_0x42daa6,_0xdfddde,_0x1a5786,_0x928c1e);}),ipcMain['handle']('stop-action',async(_0x504e4f,_0x51ba0f)=>{isStopping=!![];const _0xdb458=await getBrowserPage(0x1,_0x51ba0f);await _0xdb458['close']();}),ipcMain['handle']('fetch_followers',async(_0x942b79,_0x54f62e,_0x591ba9,_0x54f563,_0x2b8e70,_0x5fa995)=>{isStopping=![];const _0x456350=await getBrowserPage();return fetch_followers_from_account(_0x942b79,_0x456350,_0x54f62e,_0x591ba9,_0x54f563,_0x2b8e70,_0x5fa995);}),ipcMain['handle']('get-account-details',async(_0x450699,_0x305c7b,_0x556803,_0x46ba26)=>{isStopping=![];const _0x382a94=await getBrowserPage();return fetch_account_details(_0x382a94,_0x305c7b,_0x556803,_0x46ba26);}),ipcMain['handle']('fetch_likes',async(_0x19ffff,_0x4131de,_0x10252c,_0x24737a,_0x458139,_0x1ade04)=>{isStopping=![];const _0x1865ea=await getBrowserPage();return fetch_likers_from_post(_0x19ffff,_0x1865ea,_0x4131de,_0x10252c,_0x24737a,_0x458139,_0x1ade04);}),ipcMain['handle']('fetch_comments',async(_0x14c7c7,_0x5b9a5d,_0x2c2610,_0x2e1c8c,_0x46e621,_0x37b829)=>{isStopping=![];const _0x12657=await getBrowserPage();return fetch_comments_from_post(_0x14c7c7,_0x12657,_0x5b9a5d,_0x2c2610,_0x2e1c8c,_0x46e621,_0x37b829);});async function updateAppSilent(){const {spawn:_0x60beae}=require('child_process'),_0x4ae233=require('path'),_0x422878=require('electron-log');return _0x422878['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x363c4a,_0x341dcd)=>{const {updateElectronApp:_0x3d912b,UpdateSourceType:_0x2e162f}=require('update-electron-app');_0x3d912b({'updateSource':{'type':_0x2e162f['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x422878}),_0x363c4a('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x38782a,_0x39d953)=>{doFullElectronUpdateSilent(),_0x38782a('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x93046c}=require('child_process'),_0x1eb114=require('path'),_0x3c6d00=require('electron-log');return _0x3c6d00['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x2d7d94,_0xd1a7dc)=>{const {updateElectronApp:_0x334052,UpdateSourceType:_0x12f56f}=require('update-electron-app');_0x334052({'updateSource':{'type':_0x12f56f['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x3c6d00}),_0x2d7d94('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x561a9e,_0x3a5ba6)=>{doFullElectronUpdate(),_0x561a9e('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0x486d46,_0x5550b5)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x486d46('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x19ebfe=path['join'](__dirname,'mac-updater-intern.sh'),_0x2919bc=spawn('/bin/bash',[_0x19ebfe],{'detached':!![],'stdio':'ignore'});_0x2919bc['unref'](),setTimeout(()=>{_0x486d46('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0x5550b5(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0x74be8f=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x3ca8c5,_0x97b5e5)=>{console['log']('Update\x20Silent:\x20'+_0x97b5e5);if(_0x97b5e5){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0x5dbd67,_0x10d634){return Math['random']()*(_0x10d634-_0x5dbd67+0x1)+_0x5dbd67;}function delay(_0x4b2aec,_0x8a5741){let _0x2d91c9=getRnd(_0x4b2aec,_0x8a5741);return new Promise(function(_0x20620f){setTimeout(_0x20620f,_0x2d91c9);});}async function scroll(_0x286eae,_0x3d2f49,_0x4720a0=0x2,_0x4b7863){const _0x260a03=await _0x286eae['waitForSelector'](_0x3d2f49);for(let _0x59f1e9=0x0;_0x59f1e9<_0x4720a0;_0x59f1e9++){console['log']('Scrolling\x20'+_0x59f1e9),await _0x286eae['evaluate'](_0x1cc9c9=>{const _0x567492=document['querySelector'](_0x1cc9c9);_0x567492&&_0x567492['scrollBy'](0x0,0x190);},_0x3d2f49),await delay(0x320,0x5dc),_0x4b7863();}}async function saveCookies(_0x50de11){let _0x21e25d=await _0x50de11['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x21e25d,null,0x2));}async function notificationClear(_0x2825e0){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xfa0,0x1388),await _0x2825e0['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x2825e0['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x3ac8f4){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x3ac8f4);}}async function getTargetProfiles(_0x32b867){return new Promise((_0x3b2e53,_0x49b95b)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x32b867,(_0x2f9594,_0x1f6ce8)=>{_0x2f9594?_0x49b95b(_0x2f9594):_0x3b2e53(_0x1f6ce8);});});}async function login_legacy(_0x185c02,_0x4ea454,_0x2c975a){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x185c02,_0x4ea454),await createUserIfNotExists(_0x4ea454,_0x2c975a);}catch(_0x5e9724){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5e9724);}try{await _0x185c02['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x185c02['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x185c02['click']('button._a9--._ap36._a9_0');}catch(_0x21410d){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x185c02['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x185c02['type']('input[name=\x27username\x27]',_0x4ea454,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x185c02['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x185c02['type']('input[name=\x27password\x27]',_0x2c975a,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x185c02['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x185c02['click']('button[type=\x27submit\x27]');}catch(_0x3c8c3c){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x185c02),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x185c02,_0x4ea454);}catch(_0x3e2607){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x3e2607);}}catch(_0x5a6245){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x5a6245);}}async function login(_0x47ea87,_0x4b1928){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x47ea87,_0x4b1928),await createUserIfNotExists(_0x4b1928);}catch(_0x248f31){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x248f31);}try{await _0x47ea87['goto']('https://www.instagram.com/accounts/login/');}catch(_0x5b0fe6){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x5b0fe6);}}async function set_login_cookies(_0x1b95a4,_0x23689f){try{await saveCookiesForUser(_0x1b95a4,_0x23689f);}catch(_0x3e1505){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x3e1505);}}async function waitForXPath(_0x3ff514,_0x15d77f,_0x19b3d6={}){return await _0x3ff514['waitForFunction'](_0x4e09ed=>{return document['evaluate'](_0x4e09ed,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x19b3d6,_0x15d77f),_0x3ff514['evaluateHandle'](_0x5da5e3=>document['evaluate'](_0x5da5e3,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x15d77f);}async function waitForSelectorWithFallbacks(_0x4e56f3,_0x4dcc48,_0x5d8ecb={}){!Array['isArray'](_0x4dcc48)&&(_0x4dcc48=[_0x4dcc48]);for(let _0x4f8e35=0x0;_0x4f8e35<_0x4dcc48['length'];_0x4f8e35++){const _0x28d794=_0x4dcc48[_0x4f8e35],_0x2946d3=_0x28d794['startsWith']('//')||_0x28d794['startsWith']('(//');try{console['log']('Versuche\x20'+(_0x2946d3?'XPath':'Selector')+'\x20'+(_0x4f8e35+0x1)+'/'+_0x4dcc48['length']+':\x20'+_0x28d794['substring'](0x0,0x32)+'...');const _0x427ed1=_0x4f8e35===0x0?_0x5d8ecb['timeout']||0x1388:0x7d0;let _0xb271b9;if(_0x2946d3){const _0x2cbd7c=await waitForXPath(_0x4e56f3,_0x28d794,{..._0x5d8ecb,'timeout':_0x427ed1});if(!_0x2cbd7c)throw new Error('XPath-Element\x20nicht\x20gefunden');_0xb271b9=_0x2cbd7c;}else _0xb271b9=await _0x4e56f3['waitForSelector'](_0x28d794,{..._0x5d8ecb,'timeout':_0x427ed1});return console['log']((_0x2946d3?'XPath':'Selector')+'\x20'+(_0x4f8e35+0x1)+'\x20gefunden!'),_0xb271b9;}catch(_0x52dfba){console['log']((_0x2946d3?'XPath':'Selector')+'\x20'+(_0x4f8e35+0x1)+'\x20nicht\x20gefunden:\x20'+_0x52dfba['message']);if(_0x4f8e35===_0x4dcc48['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x4dcc48['length']+'\x20Selektoren/XPath\x20konnte\x20gefunden\x20werden:\x20'+_0x52dfba['message']);}}throw new Error('Keine\x20Selektoren/XPath\x20angegeben');}async function checkLoginStatus(_0x15ecfd){const _0x385501=['[type=\x22password\x22]','//a[normalize-space(text())=\x27Log\x20In\x27]','//div[@role=\x27button\x27\x20and\x20normalize-space(.)=\x27Log\x20in\x27]','//h3[normalize-space(text())=\x27Something\x20went\x20wrong\x27]'];let _0x40f2c8=null;try{_0x40f2c8=await waitForSelectorWithFallbacks(_0x15ecfd,_0x385501,{'timeout':0x7d0});}catch(_0x11f02f){return console['log']('Eingeloggt,\x20kein\x20Login\x20notwendig:\x20'+_0x11f02f),!![];}if(_0x40f2c8){console['log']('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return![];}else return console['log']('Eingeloggt,\x20führe\x20keine\x20Login\x20durch'),!![];}async function send_message(_0x2679d2,_0x5337f5,_0x4dd61c,_0x2c7947,_0x4cae09,_0x50cbab,_0x13e58d,_0x7f2892,_0x4df31a){return new Promise(async(_0x3c279d,_0x9ca555)=>{_0x50cbab=_0x50cbab['split'](';'),console['log'](_0x50cbab[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x4cae09);try{await setCookiesForUser(_0x2679d2,_0x50cbab[0x0]);}catch(_0x46db95){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x46db95),_0x3c279d({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x46db95});return;}await delay(0x6a4,0x7d0);try{await _0x2679d2['goto']('https://www.instagram.com/'+_0x5337f5+'/'),await delay(0x1b58,0x1d4c),await notificationClear(_0x2679d2);}catch(_0x32d030){_0x3c279d({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x32d030});return;}try{await checkLoginStatus(_0x2679d2);}catch(_0x3030b7){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x3030b7),_0x9ca555('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return;}console['log']('UserSkip:\x20'+_0x13e58d);if(_0x13e58d==0x1)try{const _0xc712f9=await _0x2679d2['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x18e0c1=>_0x18e0c1['textContent']['trim']());console['log'](_0xc712f9);if(_0xc712f9==='Following'||_0xc712f9==='Folge\x20ich')return _0x3c279d({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x324cee){}try{const _0x3a7d83=await waitForSelectorWithFallbacks(_0x2679d2,K_DIRECT_MSG_BUTTON);await _0x3a7d83['click']();}catch(_0x1e2d45){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x1e2d45);try{try{const _0x56be9b=await waitForSelectorWithFallbacks(_0x2679d2,K_OPTIONS_BUTTON);await _0x56be9b['click']();}catch(_0x30a00f){console['log']('Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x30a00f),_0x3c279d({'status':0x1f4,'message':'Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x30a00f});return;}await delay(0x1f4,0x320);const _0x1bc63c=await waitForXPath(_0x2679d2,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x1bc63c['click']();}catch(_0x109034){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x109034),_0x3c279d({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x2679d2);}catch(_0x3237dc){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x3237dc);}try{const _0x8754da=await waitForSelectorWithFallbacks(_0x2679d2,K_CHAT_INPUT_FIELD);if(_0x7f2892){const _0xa68e4a=await _0x2679d2['$'](K_ALREADY_CHATTED);if(_0xa68e4a)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x5337f5),_0x3c279d({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x442ac9=await _0x2679d2['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x442ac9),_0x2c7947=_0x2c7947['replace']('{USERNAME}',_0x5337f5);let _0x4b4d9b;if(_0x2c7947['includes']('{NAME}')||_0x2c7947['includes']('{name}'))try{const _0x3e2c61=await extractFirstName(_0x442ac9,_0x4df31a);console['log']('Response\x20Clearname\x20valid:\x20'+_0x3e2c61['valid']),_0x3e2c61['valid']?(_0x2c7947=_0x2c7947['replaceAll'](/{NAME}|{name}/g,_0x3e2c61['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x3e2c61['name']),_0x4b4d9b=_0x3e2c61['name']):(_0x2c7947=_0x2c7947['replaceAll'](/ ?({NAME}|{name})/g,''),_0x4b4d9b='UNKNOWN_NAME');}catch(_0x25b329){console['log'](_0x25b329['message']),_0x4b4d9b=_0x25b329['message'];let _0xea2af5=_0x442ac9['replace'](/[^\p{L}\s]/gu,''),_0x4df881=_0xea2af5['split']('\x20')[0x0];_0x4df881['length']>0x2&&!_0x4df881['includes']('Instagram')?_0x2c7947=_0x2c7947['replaceAll'](/{NAME}|{name}/g,_0x4df881):_0x2c7947=_0x2c7947['replaceAll'](/ ?({NAME}|{name})/g,'');}await _0x8754da['type'](_0x2c7947,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0x781bdc=await waitForSelectorWithFallbacks(_0x2679d2,K_SEND_MSG_BUTTON);await _0x781bdc['click'](),await delay(0x320,0x3e8),_0x3c279d({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x442ac9,'extracted_clearname':_0x4b4d9b});}catch(_0x5177eb){let _0x210ac0=_0x5177eb;console['log']('Fehler\x20beim\x20Senden\x20der\x20Nachricht:\x20'+_0x210ac0),_0x3c279d({'status':0x1f4,'message':'Error\x20500:\x20'+_0x210ac0});}});}function handle_fail(_0x5173f9){if(isStopping)return new Promise(_0x54d628=>{_0x54d628('Scraper\x20gestoppt.');});else{let _0x4c2c19='';switch(_0x5173f9){case 0x0:_0x4c2c19='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x4c2c19='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x4c2c19='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x4c2c19='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x338e9e,_0xc4bdfb)=>{_0xc4bdfb(_0x4c2c19);});}}async function fetch_account_details(_0x323703,_0x47671b,_0x49d12f,_0x506f30){try{await setCookiesForUser(_0x323703,_0x49d12f['username']);}catch(_0x42d53a){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x42d53a);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x42d53a);return handle_fail(0x0);}_0x323703['setDefaultNavigationTimeout'](0x7530),await _0x323703['goto']('https://www.instagram.com/'+_0x47671b+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x323703);const _0x5e0505=await _0x323703['evaluate'](()=>{const _0x29f038=document['querySelector']('meta[property=\x22og:image\x22]');return _0x29f038?_0x29f038['getAttribute']('content'):null;});await _0x323703['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x57f66f=await _0x323703['evaluate'](()=>{const _0x2a7e29=document['querySelector']('meta[name=\x22description\x22]');if(!_0x2a7e29)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x50127b=_0x2a7e29['getAttribute']('content');if(!_0x50127b)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x50127b);const _0x370f5f=/\s*[–-]\s*/,_0x4d1e3b=_0x50127b['split'](_0x370f5f);if(_0x4d1e3b['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x276d4b=_0x4d1e3b[0x0],_0x58a328=_0x4d1e3b[0x1],_0x5074d7=_0x276d4b['split'](',\x20');if(_0x5074d7['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x1b5266=_0x5074d7[0x0]['split']('\x20')[0x0],_0x2b1439=_0x5074d7[0x1]['split']('\x20')[0x0],_0x4342f7=_0x5074d7[0x2]['split']('\x20')[0x0];let _0x40cc3c='',_0x312b5f='';const _0x2f54e4='\x20on\x20Instagram:\x20',_0x30ae7c=_0x58a328['split'](_0x2f54e4);return _0x40cc3c=_0x30ae7c[0x0]['trim'](),_0x40cc3c=_0x40cc3c['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x30ae7c['length']>0x1&&(_0x312b5f=_0x30ae7c[0x1]['trim'](),_0x312b5f['startsWith']('\x22')&&_0x312b5f['endsWith']('\x22')&&(_0x312b5f=_0x312b5f['substring'](0x1,_0x312b5f['length']-0x1)['trim']()),_0x312b5f=_0x312b5f['replace'](/&quot;/g,'')['trim']()),{'followers':_0x1b5266,'following':_0x2b1439,'posts':_0x4342f7,'nameText':_0x40cc3c,'bio':_0x312b5f};});console['log']('Extracted\x20profile\x20data:',_0x57f66f);const _0x213a1f=_0x57f66f['nameText'],_0x5a91b8=_0x5e0505,_0x2ae8ec=_0x57f66f['bio'],_0x27cf48=_0x57f66f['followers'],_0x37a2b2=_0x57f66f['following'],_0x22196b=_0x57f66f['posts'],_0x118872=![],_0x260683=![],_0x26af64=![],_0x76073d='\x0a\x20\x20INSERT\x20INTO\x20'+_0x506f30+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x76073d,[_0x47671b,_0x213a1f,_0x5a91b8,_0x2ae8ec,_0x27cf48,_0x37a2b2,_0x22196b,_0x118872,_0x260683,_0x26af64],function(_0x395077){_0x395077?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x395077['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x10aa01,_0x2b144d,_0x52cfb2,_0x11aec9,_0x56165a,_0x2022c7,_0x3e8f48){let _0x398ce5=0x4,_0x212c40=0x0,_0x46bc1e=0x0;try{await setCookiesForUser(_0x2b144d,_0x2022c7['username']);}catch(_0x3401c5){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x3401c5);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x3401c5);return handle_fail(0x0);}let _0x5bc2be=0x0;try{await _0x2b144d['goto']('https://www.instagram.com/'+_0x52cfb2+'/'),await notificationClear(_0x2b144d);try{if(_0x11aec9<=0x0){const _0x5153c1=await _0x2b144d['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x13ac68=await _0x2b144d['evaluate'](_0xfcbe34=>_0xfcbe34['innerHTML'],_0x5153c1);_0x5bc2be=Math['ceil'](_0x13ac68/0x4);}else _0x5bc2be=Math['ceil'](_0x11aec9/0x4);_0x398ce5+=_0x5bc2be,_0x46bc1e=Math['round'](++_0x212c40/_0x398ce5*0x64),_0x10aa01['sender']['send']('fetch-progress',_0x46bc1e,!![]);let _0x6a140=await _0x2b144d['waitForSelector']('a[href=\x22/'+_0x52cfb2+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x6a140['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x52cfb2+'\x20gesichtet'),_0x46bc1e=Math['round'](++_0x212c40/_0x398ce5*0x64),_0x10aa01['sender']['send']('fetch-progress',_0x46bc1e,!![]);}catch(_0x2718b3){console['log']('Follower\x20Liste\x20von\x20'+_0x52cfb2+'\x20nicht\x20gefunden:'+_0x2718b3);throw new Error('Follower\x20Liste\x20von\x20'+_0x52cfb2+'\x20nicht\x20gefunden:'+_0x2718b3);return handle_fail(0x0);}}catch(_0x4b6437){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x4b6437);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x4b6437);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x5bc2be),await scroll(_0x2b144d,FOLLOWER_FENSTER,_0x5bc2be,_0x1435e6=>{_0x46bc1e=Math['round'](++_0x212c40/_0x398ce5*0x64),_0x10aa01['sender']['send']('fetch-progress',_0x46bc1e,!![]);}),await _0x2b144d['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x5d7b8a=await _0x2b144d['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x3c72e5=await _0x2b144d['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x46bc1e=Math['round'](++_0x212c40/_0x398ce5*0x64),_0x10aa01['sender']['send']('fetch-progress',_0x46bc1e,!![]);_0x11aec9<=0x0&&(_0x11aec9=_0x5d7b8a['length']);let _0xaac7c0=[];for(let _0x43a6be=0x0;_0x43a6be<_0x5d7b8a['length']&&_0x43a6be<_0x11aec9;_0x43a6be++){_0xaac7c0['push'](await _0x5d7b8a[_0x43a6be]['evaluate'](_0x30dab1=>_0x30dab1['textContent']));const _0x56f4cf='INSERT\x20INTO\x20'+_0x56165a+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x56f4cf,[await _0x5d7b8a[_0x43a6be]['evaluate'](_0x954f74=>_0x954f74['textContent']),await _0x3c72e5[_0x43a6be]['evaluate'](_0x22b8b7=>_0x22b8b7['textContent'])],function(_0x300a83){_0x300a83?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x56165a+'\x27:',_0x300a83['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x46bc1e=Math['round'](++_0x212c40/_0x398ce5*0x64),_0x10aa01['sender']['send']('fetch-progress',_0x46bc1e,!![]),_0x3e8f48&&(_0x10aa01['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x10aa01,_0x2b144d,_0x2022c7,_0x56165a,_0xaac7c0)),new Promise(_0x163be5=>{_0x163be5('Scraping\x20finished!');});}catch(_0x98c8f9){if(_0x3e8f48)throw new Error(_0x98c8f9);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x52cfb2+'\x20nicht\x20gefunden:\x20'+_0x98c8f9);return handle_fail(0x0);}}async function fetch_details_from_list(_0x2371dd,_0x19e49b,_0x379070,_0x51d6a0,_0x532077){let _0x3ae1ba=0x0,_0x270a16=0x0;for(let _0x1caa19=0x0;_0x1caa19<_0x532077['length'];_0x1caa19++){console['log']('Processing\x20profile:',_0x532077[_0x1caa19]);try{await fetch_account_details(_0x19e49b,_0x532077[_0x1caa19],_0x379070,_0x51d6a0);}catch(_0xa85750){console['error']('Detailed\x20Scraping\x20von:\x20',_0x532077[_0x1caa19],_0xa85750);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x532077[_0x1caa19]+'\x20'+_0xa85750);}_0x270a16=Math['round'](++_0x3ae1ba/_0x532077['length']*0x64),_0x2371dd['sender']['send']('fetch-progress',_0x270a16,!![],!![]);}}async function fetch_likers_from_post(_0x51c85f,_0x4fbf1e,_0x2266fd,_0x34c693,_0x4ed03d,_0x3f5e30,_0x14817a){let _0x58c251=0x4,_0x5a76fd=0x0,_0x4190a7=0x0;try{await setCookiesForUser(_0x4fbf1e,_0x3f5e30['username']);}catch(_0x1fd2c0){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x1fd2c0);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x1fd2c0);return handle_fail(0x1);return;}_0x4190a7=Math['round'](++_0x5a76fd/_0x58c251*0x64),_0x51c85f['sender']['send']('fetch-progress',_0x4190a7,!![]);try{let _0x37ebe1=_0x2266fd['substring'](0x0,_0x2266fd['lastIndexOf']('/'));_0x37ebe1['includes']('/reel/')&&(_0x37ebe1=_0x37ebe1['replace']('/reel/','/p/'));let _0x28cb5c=_0x37ebe1+'/liked_by';console['log'](_0x28cb5c),await _0x4fbf1e['goto'](_0x28cb5c),await delay(0x7d0,0xfa0),await notificationClear(_0x4fbf1e),await delay(0xc8,0x1f4),_0x4190a7=Math['round'](++_0x5a76fd/_0x58c251*0x64),_0x51c85f['sender']['send']('fetch-progress',_0x4190a7,!![]),await _0x4fbf1e['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0xc7eb6f=await _0x4fbf1e['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x37a696=await _0x4fbf1e['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0xc7eb6f['length']);let _0x48b805=path['join'](__dirname,'/likers.csv');_0x4190a7=Math['round'](++_0x5a76fd/_0x58c251*0x64),_0x51c85f['sender']['send']('fetch-progress',_0x4190a7,!![]);_0x34c693<=0x0&&(_0x34c693=_0xc7eb6f['length']);try{let _0x5f5a8c=[];for(let _0x700274=0x0;_0x700274<_0xc7eb6f['length']&&_0x700274<_0x34c693;_0x700274++){_0x5f5a8c['push'](await _0xc7eb6f[_0x700274]['evaluate'](_0x137dae=>_0x137dae['textContent']));try{const _0x26e69b='INSERT\x20INTO\x20'+_0x4ed03d+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x26e69b,[await _0xc7eb6f[_0x700274]['evaluate'](_0x566a82=>_0x566a82['textContent']),await _0x37a696[_0x700274]['evaluate'](_0x27a4a7=>_0x27a4a7['textContent'])],function(_0x139005){_0x139005?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x4ed03d+'\x27:',_0x139005['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x5131cd){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x700274+'\x20:\x20'+_0x5131cd);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x700274+'\x20:\x20'+_0x5131cd);return handle_fail(0x1);}}return _0x4190a7=Math['round'](++_0x5a76fd/_0x58c251*0x64),_0x51c85f['sender']['send']('fetch-progress',_0x4190a7,!![]),_0x14817a&&(_0x51c85f['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x51c85f,_0x4fbf1e,_0x3f5e30,_0x4ed03d,_0x5f5a8c)),new Promise(_0x3c3765=>{_0x3c3765('Scraping\x20finished!');});}catch(_0x18fd41){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x18fd41);return handle_fail(0x1);}}catch(_0x3d4d3b){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x3d4d3b);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x3d4d3b);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x45d7d2,_0xa76d34,_0x41876a,_0x452647,_0x158524,_0x5337cc,_0x7d21b0){let _0x11bf51=0x3,_0x1c21d8=0x0,_0x6f8383=0x0;try{await setCookiesForUser(_0xa76d34,_0x5337cc['username']);}catch(_0x303dfe){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x303dfe);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x303dfe);return handle_fail(0x2);}try{console['log'](_0x41876a),await _0xa76d34['goto'](_0x41876a),await delay(0x7d0,0xfa0),await notificationClear(_0xa76d34),await delay(0xc8,0x1f4);const _0x1de67b=COM_COMMENTS_BOX_BODY_DIV;let _0x3a6457;const _0x179fdc=await _0xa76d34['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x43d424=await _0xa76d34['evaluate'](_0x4364a2=>_0x4364a2['innerHTML'],_0x179fdc),_0x68dfdc=String(_0x43d424)['replace'](/[^0-9]/g,''),_0x5a3e26=Number(_0x68dfdc)/0x14;_0x452647<=0x0?_0x3a6457=Math['ceil'](_0x5a3e26/0x3):_0x3a6457=Math['ceil'](_0x452647/0x3);_0x11bf51+=_0x3a6457,_0x6f8383=Math['round'](++_0x1c21d8/_0x11bf51*0x64),_0x45d7d2['sender']['send']('fetch-progress',_0x6f8383,!![]),console['log']('Auto-scrolls:\x20'+_0x3a6457),await scroll(_0xa76d34,_0x1de67b,_0x3a6457,_0x1e634b=>{_0x6f8383=Math['round'](++_0x1c21d8/_0x11bf51*0x64),_0x45d7d2['sender']['send']('fetch-progress',_0x6f8383,!![]);});try{const _0x5d4bd1=COM_REPLY_BUTTON_SPAN;await _0xa76d34['waitForSelector'](_0x5d4bd1),await delay(0x1f4,0x320);const _0x46a23c=await _0xa76d34['$$'](_0x5d4bd1);console['log'](_0x46a23c);let _0x2e99e7=_0x46a23c['length'];await delay(0xc8,0x1f4);try{for(let _0x24bda8=0x0;_0x24bda8<_0x2e99e7;_0x24bda8++){_0x46a23c[_0x24bda8]['click'](),await delay(0x320,0x5dc);}}catch(_0x210e66){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x210e66);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x210e66);return handle_fail(0x2);}}catch(_0x2841b9){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x5d7454=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0xa76d34['waitForSelector'](_0x5d7454),await delay(0x1f4,0x320),_0x6f8383=Math['round'](++_0x1c21d8/_0x11bf51*0x64),_0x45d7d2['sender']['send']('fetch-progress',_0x6f8383,!![]);const _0x587ec5=await _0xa76d34['$$'](_0x5d7454);let _0x5e26cf=path['join'](__dirname,'/comments.csv');_0x452647<=0x0&&(_0x452647=_0x587ec5['length']);console['log']('fetch_limit:\x20'+_0x452647),console['log']('comments_len:\x20'+_0x587ec5['length']),_0x452647++;try{let _0x1389fd=[];for(let _0x33de09=0x1;_0x33de09<_0x587ec5['length']&&_0x33de09<_0x452647;_0x33de09++){try{_0x1389fd['push'](await _0x587ec5[_0x33de09]['evaluate'](_0x53c52f=>_0x53c52f['textContent']));const _0x2d809a=await db['prepare']('INSERT\x20INTO\x20'+_0x158524+'\x20(username)\x20VALUES\x20(?)');await _0x2d809a['run'](await _0x587ec5[_0x33de09]['evaluate'](_0x346c3a=>_0x346c3a['textContent']),function(_0x45bc82){_0x45bc82&&console['log']('error\x20in\x20add-user:'+_0x45bc82);}),await _0x2d809a['finalize']();}catch(_0x4a382e){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x33de09+'\x20:\x20'+_0x4a382e);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x33de09+'\x20:\x20'+_0x4a382e);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x6f8383=Math['round'](++_0x1c21d8/_0x11bf51*0x64),_0x45d7d2['sender']['send']('fetch-progress',_0x6f8383,!![]),_0x45d7d2['sender']['send']('fetch-progress',0x64,!![]),_0x7d21b0&&(_0x45d7d2['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x45d7d2,_0xa76d34,_0x5337cc,_0x158524,_0x1389fd)),_0x45d7d2['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x4ca422=>{_0x4ca422('Scraping\x20finished!');});}catch(_0x229cff){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x229cff);return handle_fail(0x2);}}catch(_0x5ac52a){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x5ac52a);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x5ac52a);return handle_fail(0x2);}}async function set_clearname_from_username(_0x28e431,_0x10b8d7,_0x2a12ec=null){try{let _0x5361d2,_0x1c2ace;const _0x1c673b='SELECT\x20username\x20FROM\x20'+_0x10b8d7+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x1c673b,[],(_0x6ef1ad,_0x324dcf)=>{_0x6ef1ad&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x6ef1ad['message']),_0x324dcf['length']===0x0&&(_0x1c2ace=_0x324dcf['length']),_0x5361d2=_0x324dcf['map'](_0x5c22a4=>_0x5c22a4['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x1c2ace);if(_0x1c2ace===0x0){console['log']('Leave');return;}const _0x51dfc8=await _0x28e431['waitForSelector'](IG_SEARCH_BUTTON);await _0x51dfc8['click'](),await delay(0x4b0,0x7d0);for(let _0x5b43fb of _0x5361d2){const _0x56f340=await _0x28e431['waitForSelector'](IG_SEARCH_INPUT);await _0x56f340['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x28e431['type'](IG_SEARCH_INPUT,_0x5b43fb,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x2de9b2=0x1;while(_0x2de9b2!=0x14){console['log']('Schleife');try{let _0x19ce34=IG_NAME_SPAN_PART1+_0x2de9b2+IG_USERNAME_SPAN_PART2;const _0x211e27=await _0x28e431['waitForSelector'](_0x19ce34),_0x29fa37=await _0x28e431['evaluate'](_0x4f7a31=>_0x4f7a31['innerHTML'],_0x211e27);await delay(0xc8,0x1f4);if(_0x29fa37==_0x5b43fb){let _0xcdf3d=IG_NAME_SPAN_PART1+_0x2de9b2+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x1a6484=await _0x28e431['waitForSelector'](_0xcdf3d);let _0x498b07=await _0x28e431['evaluate'](_0x5ba948=>_0x5ba948['innerHTML'],_0x1a6484);const _0x31dad6=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x5d9b82=_0x498b07['match'](_0x31dad6);_0x5d9b82?_0x498b07=_0x5d9b82[0x1]['trim']():_0x498b07=_0x498b07['trim']();_0x498b07['includes']('•')&&(_0x498b07=_0x498b07['substring'](0x0,_0x498b07['indexOf']('•')-0x1));const _0x158379='UPDATE\x20'+_0x10b8d7+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x158379,[_0x498b07,_0x29fa37],function(_0x1adc96){_0x1adc96&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x1adc96['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x2de9b2++;}catch(_0x429566){const _0x47807e='UPDATE\x20'+_0x10b8d7+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x47807e,['',_0x5b43fb],function(_0x4fc684){_0x4fc684&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x4fc684['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x429566);break;}}_0x2a12ec&&_0x2a12ec();}await _0x51dfc8['click']();}catch(_0x67f49d){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x67f49d);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x3d8a63,_0x60f937)=>{const _0x370142='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x370142,[],(_0x3ed485,_0x21e309)=>{_0x3ed485?_0x60f937(_0x3ed485):_0x3d8a63(_0x21e309);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x118e05,_0xd0f08b)=>{const _0x45a73a='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x45a73a,[],async(_0x56909e,_0x1be165)=>{if(_0x56909e)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x56909e['message']),_0xd0f08b({'status':'error','message':_0x56909e['message']});else try{const _0x4b3d22=await Promise['all'](_0x1be165['map'](_0x4b13a0=>{return new Promise(_0x2b4535=>{if(!_0x4b13a0['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x4b13a0['campaign_name']),_0x2b4535({'campaign_name':_0x4b13a0['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x4e329d='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x4b13a0['list_id'],_0x321c96='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x4b13a0['list_id']+'\x22';db['get'](_0x4e329d,[],(_0x387a79,_0x3366e9)=>{_0x387a79?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x4b13a0['campaign_name']+':',_0x387a79['message']),_0x2b4535({'campaign_name':_0x4b13a0['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x321c96,[],(_0x4af91b,_0x2ac282)=>{_0x4af91b?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x4b13a0['campaign_name']+':',_0x4af91b['message']),_0x2b4535({'campaign_name':_0x4b13a0['campaign_name'],'lead_count':_0x3366e9?_0x3366e9['lead_count']:0x0,'contacted_count':'N/A'})):_0x2b4535({'campaign_name':_0x4b13a0['campaign_name'],'lead_count':_0x3366e9?_0x3366e9['lead_count']:0x0,'contacted_count':_0x2ac282?_0x2ac282['contacted_count']:0x0});});});});}));_0x118e05({'status':'success','campaigns':_0x4b3d22});}catch(_0xc3f97e){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0xc3f97e),_0xd0f08b({'status':'error','message':_0xc3f97e['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x218b01,_0x5e41c4)=>{return new Promise((_0x95de32,_0x4bc64c)=>{const _0x1a5c63='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x1a5c63,[_0x5e41c4],(_0x43eb17,_0x40248a)=>{_0x43eb17?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x43eb17),_0x4bc64c(_0x43eb17)):(console['log']('ROWS'),console['log'](_0x40248a),debugDatabaseContents(),_0x95de32(_0x40248a));});});});const showTableContents=_0x5eba9c=>{return new Promise((_0x3eec14,_0x230a63)=>{const _0x46f5ad='SELECT\x20*\x20FROM\x20'+_0x5eba9c+';';campaignDB['all'](_0x46f5ad,(_0x32122a,_0x30cee9)=>{_0x32122a?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x5eba9c+':',_0x32122a),_0x230a63(_0x32122a)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x5eba9c+':',_0x30cee9),_0x3eec14({'status':'success','message':_0x30cee9}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x5942e9){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x5942e9);}}ipcMain['handle']('create-campaign',async(_0x2a4224,_0x38cac6)=>{return new Promise((_0x1fe9d2,_0x2e9426)=>{const _0x449d50='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x449d50,[String(_0x38cac6)],function(_0x1d873c){_0x1d873c?_0x2e9426(_0x1d873c):_0x1fe9d2({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x5ba731,_0x120f70)=>{return new Promise((_0x3b87e4,_0x5da646)=>{const _0x3c3541='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x3c3541,[_0x120f70],function(_0x524965){_0x524965?_0x5da646(_0x524965):_0x3b87e4({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x5d65ae,_0x26846f,_0x9e0205,_0x1b471a,_0x19def,_0x3f55d0,_0x33308c,_0x5c7c7a)=>{const _0xf891db=await createMessageID(_0x19def);return new Promise((_0x53f914,_0x33e598)=>{if(!_0x26846f||!_0x9e0205||!_0x1b471a||!_0xf891db||!_0x3f55d0)return _0x33e598({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0xf891db);const _0xac8080='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0xac8080,[_0x9e0205,_0x1b471a,_0xf891db,_0x3f55d0,_0x33308c,_0x5c7c7a,_0x26846f],function(_0xb82f13){if(_0xb82f13)_0x33e598({'status':'error','message':_0xb82f13['message']});else this['changes']===0x0?_0x33e598({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x53f914({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x3013c3,_0x3055b6,_0x282abf,_0x11b930,_0x3650b)=>{return new Promise((_0x199cf,_0x2ee071)=>{const _0x5a8df2='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x5a8df2,[_0x3055b6,_0x282abf,_0x11b930,_0x3650b],function(_0x171abd){return _0x171abd?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x171abd['message']),_0x2ee071('insert-dm-response',{'success':![],'message':_0x171abd['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x199cf('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x4df292=>{return new Promise((_0x5b4637,_0x393a03)=>{const _0x1087fb='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x1087fb,[_0x4df292],(_0x5d0f8c,_0x1e6954)=>{if(_0x5d0f8c)_0x393a03({'status':'error','message':_0x5d0f8c['message']});else{if(_0x1e6954)_0x5b4637(_0x1e6954['message_id']);else{const _0x3e354b='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x3e354b,[_0x4df292],function(_0x4bbbc6){_0x4bbbc6?_0x393a03({'status':'error','message':_0x4bbbc6['message']}):_0x5b4637(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x39a118,_0x1d8f70)=>{return new Promise((_0x34de9f,_0x1d96de)=>{const _0x598b4e='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x1d8f70;db['get'](_0x598b4e,(_0x36803f,_0x2fb2c8)=>{_0x36803f?_0x1d96de({'status':'error','message':_0x36803f['message']}):_0x34de9f({'status':'success','count':_0x2fb2c8['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x1613a6,_0x456d90){try{const _0x1cb0c0=await new Promise((_0x381e62,_0x129c6d)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x456d90],(_0x32806f,_0x5e8da5)=>{if(_0x32806f)_0x129c6d(_0x32806f);else{if(_0x5e8da5['length']>0x0){let _0x466f15=JSON['parse'](_0x5e8da5[0x0]['cookie']);console['log'](_0x466f15),_0x381e62(_0x466f15);}else _0x129c6d(new Error('User\x20with\x20username\x20'+_0x456d90+'\x20does\x20not\x20exist.'));}});});await _0x1613a6['setCookie'](..._0x1cb0c0),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x54dbb1){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x54dbb1);}}async function saveCookiesForUser(_0x44a03e,_0x3852bf){try{const _0x59a964=await _0x44a03e['cookies']();if(!_0x59a964||_0x59a964['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x3852bf);const _0x47d8a7=JSON['stringify'](_0x59a964);if(_0x47d8a7['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x3852bf);return new Promise((_0xdbb986,_0x47b748)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x3852bf],(_0x5b69c9,_0x4e5591)=>{if(_0x5b69c9)return console['error']('Error\x20checking\x20user\x20existence:',_0x5b69c9),_0x47b748(_0x5b69c9);if(_0x4e5591){const _0x17e5b8=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x17e5b8['run'](_0x47d8a7,_0x3852bf,function(_0x4ef9f0){return _0x4ef9f0?(console['error']('Error\x20updating\x20cookies:',_0x4ef9f0),_0x47b748(_0x4ef9f0)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x3852bf),_0xdbb986());});}else{const _0x1eae44=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x1eae44['run'](_0x3852bf,_0x47d8a7,function(_0x2c6655){return _0x2c6655?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x2c6655),_0x47b748(_0x2c6655)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x3852bf),_0xdbb986());});}});});}catch(_0x3b08ed){console['error']('Error\x20fetching\x20cookies:',_0x3b08ed);throw _0x3b08ed;}}async function createUserIfNotExists(_0x3b0cd8){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x3b0cd8],(_0x4232b8,_0x21090f)=>{if(_0x4232b8){console['error']('Error\x20checking\x20user\x20existence:',_0x4232b8);throw _0x4232b8;}else{if(!_0x21090f){const _0x196a2f=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x196a2f['run'](_0x3b0cd8,function(_0x428802){_0x428802?console['error']('Error\x20inserting\x20new\x20user:',_0x428802):console['log']('New\x20user\x20created:',_0x3b0cd8);});}else console['log']('User\x20already\x20exists:',_0x3b0cd8);}});}catch(_0x17b550){console['error']('Error\x20creating\x20user:',_0x17b550);throw _0x17b550;}}ipcMain['handle']('create-relation',async(_0x31662e,_0x4013ad)=>{return new Promise((_0x599ce6,_0x4f5348)=>{const _0x3060bf='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x4013ad+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x3060bf,function(_0x3aa6e7){_0x3aa6e7?_0x4f5348(_0x3aa6e7):_0x599ce6({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x3331fa,_0x337096)=>{return console['log']('droping\x20table'+_0x337096),new Promise((_0x435073,_0x1d4fc9)=>{const _0x5391b8='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x337096;console['log']('droping\x20table'+_0x337096),db['run'](_0x5391b8,function(_0x4ff4e1){_0x4ff4e1?_0x1d4fc9(_0x4ff4e1):_0x435073({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x444ef3=>{return new Promise((_0x3ece75,_0x51a792)=>{const _0x58d0fe='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x58d0fe,[],(_0x2aa3a2,_0x489e40)=>{_0x2aa3a2?_0x51a792(_0x2aa3a2):_0x3ece75(_0x489e40['map'](_0x165483=>_0x165483['name']));});});}),ipcMain['handle']('add-user',async(_0x290de2,_0x29204c,_0x480312)=>{return new Promise(_0x57bf2c=>{const _0x3ce4ce=db['prepare']('INSERT\x20INTO\x20'+_0x480312+'\x20(username)\x20VALUES\x20(?)');_0x3ce4ce['run'](_0x29204c,function(_0x5313e2){_0x5313e2?console['log']('error\x20in\x20add-user:'+_0x5313e2):_0x57bf2c({'status':'success','id':this['lastID']});}),_0x3ce4ce['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x131f0a,_0x4a75c9)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x4bb357,_0x5b2a17)=>{if(_0x4bb357)_0x4a75c9(_0x4bb357);else{_0x131f0a({'status':'success','users':_0x5b2a17});for(_0x5b2a17 of _0x5b2a17){console['log'](_0x5b2a17['username']);}}});});}),ipcMain['handle']('get-data',async(_0x10d573,_0x513893)=>{return new Promise((_0x37763f,_0x3343c2)=>{const _0xec6998='SELECT\x20*\x20FROM\x20'+_0x513893;console['log'](_0xec6998),db['all'](_0xec6998,[],(_0xf597b4,_0x9c9b3f)=>{_0xf597b4?_0x3343c2(_0xf597b4):_0x37763f(_0x9c9b3f);});});}),ipcMain['handle']('get-accounts',async _0x1685d5=>{return new Promise((_0x32434c,_0x476336)=>{const _0x117b93='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x117b93),igaccountsDB['all'](_0x117b93,[],(_0x3fbfd3,_0x12da20)=>{_0x3fbfd3?_0x476336(_0x3fbfd3):_0x32434c(_0x12da20);});});}),ipcMain['handle']('get-targets',async(_0x40058,_0x5d29be)=>{return getTargetProfiles(_0x5d29be);}),ipcMain['handle']('delete-user',async(_0x261b43,_0x4ca19b,_0x458336)=>{return new Promise((_0x242a51,_0x3682cb)=>{const _0x3c7fdc=db['prepare']('DELETE\x20FROM\x20'+_0x458336+'\x20WHERE\x20username\x20=\x20?');_0x3c7fdc['run'](_0x4ca19b,function(_0x2c4b6b){_0x2c4b6b?_0x3682cb(_0x2c4b6b):_0x242a51({'status':'success','changes':this['changes']});}),_0x3c7fdc['finalize']();});}),ipcMain['handle']('delete-account',async(_0x2b47a9,_0x10f3a7)=>{const _0x5b4199=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x5b4199['run'](_0x10f3a7,function(_0x39b855){_0x39b855&&console['log'](_0x39b855);}),_0x5b4199['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x4b8e1a,_0x321f29)=>{const _0x1bb72c='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x1bb72c,[],(_0x3ac1de,_0x44fe84)=>{_0x3ac1de?_0x321f29({'status':'error','message':_0x3ac1de['message']}):_0x4b8e1a({'status':'success','contactedCount':_0x44fe84['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x304c28,_0x57b968)=>{const _0x129e54='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x129e54,[],(_0x3dacc3,_0x4192c9)=>{_0x3dacc3?_0x57b968({'status':'error','message':_0x3dacc3['message']}):_0x304c28({'status':'success','contactedCount':_0x4192c9['contactedCount']});});});});function exportDatabase(_0x25e513){return new Promise((_0x8eea92,_0x1f1115)=>{const _0x280aa5='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x25e513+'\x0a\x20\x20\x20\x20';db['all'](_0x280aa5,[],async(_0x565bb6,_0x9d3561)=>{if(_0x565bb6){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x565bb6['message']),_0x1f1115(_0x565bb6);return;}if(!_0x9d3561||_0x9d3561['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x8eea92();return;}const _0x1aee9c=XLSX['utils']['json_to_sheet'](_0x9d3561),_0x2fcace=XLSX['utils']['sheet_to_csv'](_0x1aee9c);try{const {canceled:_0x560995,filePath:_0x440488}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x25e513+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x560995||!_0x440488){console['log']('Speichern\x20abgebrochen.'),_0x8eea92();return;}fs['writeFile'](_0x440488,_0x2fcace,'utf8',_0x576398=>{_0x576398?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x576398['message']),_0x1f1115(_0x576398)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x440488),_0x8eea92());});}catch(_0x9a4119){console['error']('Fehler\x20im\x20Speicherdialog:',_0x9a4119),_0x1f1115(_0x9a4119);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x4febf1,_0x3bf55c)=>{shell['openExternal'](_0x3bf55c);});