const {app,BrowserWindow,ipcMain,dialog}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),ANZAHL_FOLLOWER_BUTTON='div.x9f619.x1n2onr6\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_NEW_MSG_BUTTON='div.x1i10hfl.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.x6s0dn4.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x1ypdohk.x78zum5.xl56j7k.x1y1aw1k.x1sxyh0.xwib8y2.xurb0ha.xcdnw81',K_SEARCH_BAR_INPUT='body\x20>\x20div.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x1k90msu.x6o7n8i.x1qfuztq.x10l6tqk.x17qophe.x13vifvy.x1hc1fzr.x71s49j.xh8yej3\x20>\x20div\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.x1q0g3np.x1a02dak.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20input',K_USERNAME_SPALTE_PART1='div:nth-child(',K_CLEARNAME_SPALTE_PART2=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1pi30zi.x1swvt13.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span\x20>\x20span',K_CHAT_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.x972fbf.xcfux6l.x1qhh985.xm0m39n.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.xexx8yu.x18d9i69.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1lq5wgf.xgqcy7u.x30kzoy.x9jhf4c.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x9bdzbf.x1ypdohk.x78zum5.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x1n2onr6.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xn3w4p2.x5ib6vp.xc73u3c.x1tu34mt.xzloghq',K_NACHRICHT_SCHREIBEN_INPUT_DIV='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1i64zmx.xw3qccf.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f.notranslate',K_SENDEN_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.xfs2ol5[role=\x22button\x22][tabindex=\x220\x22]',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x41818c=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x41818c['loadFile'](path['join'](__dirname,'index.html'));}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x4e68b2){var _0x22411f=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x361064){console['log']('window\x20id:'+_0x361064['id']),_0x361064['id']>0x1&&(_0x22411f=!![]);}),console['log']('child\x20opened\x20='+_0x22411f);if(!_0x22411f){const _0x2d4f46=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x2d4f46['loadFile'](_0x4e68b2['url']);}else console['log']('child\x20window\x20opened\x20already');}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x325027=0x1,_0x39a0ea=0x0){let _0x7bb85e='',_0x34bb72=null;if(process['platform']==='darwin')_0x7bb85e='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome';else{if(process['platform']==='win32')_0x7bb85e='chromium_local/chrome-win/chrome.exe';else{if(process['platform']==='linux'){}}}if(_0x325027===0x0&&!pageStack[_0x39a0ea])return browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0x7bb85e}),_0x34bb72=await browser['newPage'](),_0x34bb72['setDefaultNavigationTimeout'](0x1d4c),_0x34bb72['setDefaultTimeout'](0x1d4c),pageStack[_0x39a0ea]=_0x34bb72,_0x34bb72;return(browser===null||pageStack[_0x39a0ea]['isClosed']())&&(browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0x7bb85e})),(pageStack[_0x39a0ea]===null||pageStack[_0x39a0ea]['isClosed']())&&(_0x34bb72=await browser['newPage'](),_0x34bb72['setDefaultNavigationTimeout'](0x1d4c),_0x34bb72['setDefaultTimeout'](0x1d4c),pageStack[_0x39a0ea]=_0x34bb72),pageStack[_0x39a0ea];}ipcMain['on']('login',async(_0x5a3c08,_0x49404a,_0x4e3778)=>{const _0x276cad=await getBrowserPage();await _0x276cad['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x276cad,_0x49404a,_0x4e3778);}),ipcMain['handle']('sendMessage',async(_0xbc34e0,_0x59b730,_0x54dc42,_0x14a7ce,_0x2b6e07,_0x37bf5a,_0x3f552c,_0x14c6e2)=>{isStopping=![];let _0x10e349=null;return _0x3f552c?_0x10e349=await getBrowserPage(_0x2b6e07,_0x14c6e2):_0x10e349=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x59b730),new Promise((_0x444f3c,_0x61ec43)=>{send_message(_0x10e349,_0x59b730,_0x54dc42,_0x14a7ce,_0x2b6e07,_0x37bf5a)['then'](_0x3c3c17=>_0x444f3c(_0x3c3c17))['catch'](_0x54a4a4=>_0x61ec43(_0x54a4a4));});}),ipcMain['handle']('stop-action',async(_0x3783ae,_0x43a71a)=>{isStopping=!![];const _0xd2fa9b=await getBrowserPage(0x1,_0x43a71a);await _0xd2fa9b['close']();}),ipcMain['handle']('fetch_followers',async(_0x42459b,_0x34ecc4,_0x591969,_0x21f4d7,_0x210b40)=>{isStopping=![];const _0x14b634=await getBrowserPage();return fetch_followers_from_account(_0x14b634,_0x34ecc4,_0x591969,_0x21f4d7,_0x210b40);}),ipcMain['handle']('fetch_likes',async(_0x5d3ce2,_0x25275d,_0x3acfda,_0x66891f,_0x171cdb)=>{isStopping=![];const _0x77d4bb=await getBrowserPage();return fetch_likers_from_post(_0x77d4bb,_0x25275d,_0x3acfda,_0x66891f,_0x171cdb);}),ipcMain['handle']('fetch_comments',async(_0x750334,_0x4f22e9,_0xbb2c3,_0x27e61f,_0x4a1b56)=>{isStopping=![];const _0x146ec1=await getBrowserPage();return fetch_comments_from_post(_0x146ec1,_0x4f22e9,_0xbb2c3,_0x27e61f,_0x4a1b56);}),ipcMain['handle']('update-app',async _0xa913eb=>{const {spawn:_0x24b15a}=require('child_process'),_0x38315b=require('path');if(process['platform']==='darwin'){const _0x164bda=_0x38315b['join'](__dirname,'mac-updater-intern.sh'),_0x1c8ea9=_0x24b15a('/bin/bash',[_0x164bda]);_0x1c8ea9['stdout']['on']('data',_0x52ae16=>{console['log']('stdout:\x20'+_0x52ae16);}),_0x1c8ea9['stderr']['on']('data',_0x4e44c6=>{console['error']('stderr:\x20'+_0x4e44c6);}),_0x1c8ea9['on']('close',_0x396d72=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x396d72);});}else{if(process['platform']==='win32'){const _0x16a2f4=_0x38315b['join'](__dirname,'../','../','../');process['chdir'](_0x16a2f4),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x1e4d11='soft-ui-updater-windows.ps1',_0x52bba3='soft-ui-updater-windows.exe',_0x2bbfad=_0x24b15a('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x1e4d11]);console['log']('Windows\x20Pfad:\x20'+_0x16a2f4),_0x2bbfad['stdout']['on']('data',_0x5a5a13=>{console['log']('stdout:\x20'+_0x5a5a13);}),_0x2bbfad['stderr']['on']('data',_0x5983f8=>{console['error']('stderr:\x20'+_0x5983f8);}),_0x2bbfad['on']('close',_0x57d514=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x57d514);});}}});function getRnd(_0x4bb17a,_0x214d0f){return Math['random']()*(_0x214d0f-_0x4bb17a+0x1)+_0x4bb17a;}function delay(_0x43fdf5,_0x466c6e){let _0x3a0ace=getRnd(_0x43fdf5,_0x466c6e);return new Promise(function(_0x91c889){setTimeout(_0x91c889,_0x3a0ace);});}async function scroll(_0x5f08da,_0x1031fb,_0x4be357=0x2){const _0x1aa770=await _0x5f08da['waitForSelector'](_0x1031fb);for(let _0x40a238=0x0;_0x40a238<_0x4be357;_0x40a238++){console['log']('Scrolling\x20'+_0x40a238),await _0x5f08da['evaluate'](_0xadfc7=>{const _0x42c3c2=document['querySelector'](_0xadfc7);_0x42c3c2&&_0x42c3c2['scrollBy'](0x0,0x190);},_0x1031fb),await delay(0x320,0x5dc);}}async function saveCookies(_0x1fb23c){let _0x25e00c=await _0x1fb23c['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x25e00c,null,0x2));}async function notificationClear(_0x53761e){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x53761e['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x53761e['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x59c332){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x59c332);}}async function getTargetProfiles(_0x10f9ea){return new Promise((_0xedae8b,_0x107c63)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x10f9ea,(_0x32ae0e,_0x2b55e4)=>{_0x32ae0e?_0x107c63(_0x32ae0e):_0xedae8b(_0x2b55e4);});});}async function login(_0x2b69a6,_0x5703a9,_0xd6d042){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x2b69a6,_0x5703a9),await createUserIfNotExists(_0x5703a9,_0xd6d042);}catch(_0x51fdcd){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x51fdcd);}try{await _0x2b69a6['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x2b69a6['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x2b69a6['click']('button._a9--._ap36._a9_0');}catch(_0x1903c4){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x2b69a6['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x2b69a6['type']('input[name=\x27username\x27]',_0x5703a9,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x2b69a6['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x2b69a6['type']('input[name=\x27password\x27]',_0xd6d042,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x2b69a6['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x2b69a6['click']('button[type=\x27submit\x27]');}catch(_0xbc97fe){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x2b69a6),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x2b69a6,_0x5703a9);}catch(_0x4567e9){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x4567e9);}}catch(_0x42ab65){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x42ab65);}}async function send_message(_0x184258,_0x45c987,_0x53cc96,_0x42425d,_0x33a167,_0x284ffd){_0x284ffd=_0x284ffd['split'](';'),console['log'](_0x284ffd[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x33a167);if(_0x33a167==0x0){try{await login(_0x184258,_0x284ffd[0x0],_0x284ffd[0x1]);}catch(_0x2532f6){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x2532f6);return;}await _0x184258['goto']('https://www.instagram.com/direct/inbox/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x184258);}let _0x1476b2;await set_clearname_from_username(_0x184258,_0x53cc96);const _0x2d8879='SELECT\x20clearname\x20FROM\x20'+_0x53cc96+'\x20WHERE\x20username\x20IS\x20?';db['all'](_0x2d8879,[_0x45c987],(_0x2dd6d0,_0x20be80)=>{_0x2dd6d0&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x2dd6d0['message']);if(_0x20be80['length']===0x0)return;_0x1476b2=_0x20be80['map'](_0x41c98c=>_0x41c98c['clearname']);});try{try{const _0x41e67c=K_NEW_MSG_BUTTON;await delay(0xfa0,0x1d4c),await _0x184258['waitForSelector'](_0x41e67c),await _0x184258['click'](_0x41e67c),console['log']('Message-Button\x20geklickt'),console['log'](_0x45c987+'\x20'+_0x42425d),await delay(0xfa0,0x1d4c);try{const _0x8891bd='input[name=\x22queryBox\x22]',_0x1a1cb0=K_SEARCH_BAR_INPUT;await _0x184258['waitForSelector'](_0x1a1cb0),await _0x184258['click'](_0x1a1cb0),await delay(0xfa0,0x1d4c),await _0x184258['waitForSelector'](_0x8891bd),await _0x184258['click'](_0x8891bd),await delay(0xfa0,0x1d4c),await _0x184258['type'](_0x8891bd,_0x45c987,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),console['log']('Account\x20Name\x20eingefügt');const _0x1c4d90=K_USERNAME_SPALTE_PART1,_0x2baaa=K_CLEARNAME_SPALTE_PART2;let _0x436fb8=0x1;try{while(_0x436fb8!=0x14){console['log']('Schleife');let _0x3b5574=_0x1c4d90+_0x436fb8+_0x2baaa;const _0x5b7c54=await _0x184258['waitForSelector'](_0x3b5574),_0x1bce49=await _0x184258['evaluate'](_0x19cd78=>_0x19cd78['innerHTML'],_0x5b7c54);console['log'](_0x1bce49+';'+_0x1476b2+';'+_0x45c987),delay(0x3e8,0xbb8);if(_0x1bce49==_0x1476b2){console['log']('Account\x20gefunden'),await _0x184258['click'](_0x3b5574);break;}else{if(_0x1bce49==_0x45c987){console['log']('Account\x20gefunden'),await _0x184258['click'](_0x3b5574);break;}}_0x436fb8++;}try{await delay(0xbb8,0x1388);const _0x1c54ec=await _0x184258['waitForSelector'](K_CHAT_BUTTON_DIV);console['log'](_0x1c54ec),await delay(0xbb8,0x1388),await _0x1c54ec['click']();try{await delay(0xbb8,0x1388);const _0x564da5=await _0x184258['waitForSelector'](K_NACHRICHT_SCHREIBEN_INPUT_DIV);await _0x564da5['type'](_0x42425d,{'delay':getRnd(0x50,0x78)}),await delay(0xbb8,0x1388);try{const _0x79d7ff=await _0x184258['waitForSelector'](K_SENDEN_BUTTON_DIV);return await _0x79d7ff['click'](),await delay(0xbb8,0x1388),new Promise(_0x42280f=>{_0x42280f('Nachricht\x20erfolgreich\x20verschickt!');});}catch(_0x59d5db){console['log']('Message-Button\x20nicht\x20geklickt:\x20'+_0x59d5db);}}catch(_0x4f1e99){console['log']('Chat-Fenster\x20nicht\x20gefunden:\x20'+_0x4f1e99);}}catch(_0x3a5148){console['log']('error:\x20'+_0x3a5148);}}catch(_0x5a78c6){return console['log']('User\x20nicht\x20gefunden:'+_0x5a78c6),await _0x184258['goto']('https://www.instagram.com/direct/inbox/'),new Promise((_0x2032b0,_0x2f83d0)=>{_0x2f83d0('user_not_found');});}}catch(_0x1f588b){console['log']('DM-Fenster\x20nicht\x20gefunden:'+_0x1f588b);}}catch(_0xfa0451){console['log']('Message-Button\x20nicht\x20geklickt:'+_0xfa0451);}}catch(_0x312016){console['log']('Nachricht\x20senden\x20fehlgeschlagen:\x20'+_0x312016);}return console['log']('Ende'),await _0x184258['goto']('https://www.instagram.com/direct/inbox/'),new Promise((_0x1d4fb3,_0x2c72e0)=>{_0x2c72e0('ig_update');});}function handle_fail(_0x496578){if(isStopping)return new Promise(_0x3f9518=>{_0x3f9518('Scraper\x20gestoppt.');});else{let _0x5e2e5d='';switch(_0x496578){case 0x0:_0x5e2e5d='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x5e2e5d='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x5e2e5d='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x5e2e5d='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x5bc262,_0x159fb6)=>{_0x159fb6(_0x5e2e5d);});}}async function fetch_followers_from_account(_0x1d7533,_0x3f9b7d,_0x2c9491,_0x3dd601,_0x30efa7){try{await login(_0x1d7533,_0x30efa7['username'],_0x30efa7['password']);}catch(_0x4eb8d2){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4eb8d2),handle_fail(0x0);}let _0x4a160c=0x0;try{await _0x1d7533['goto']('https://www.instagram.com/'+_0x3f9b7d+'/'),await notificationClear(_0x1d7533);try{if(_0x2c9491<=0x0){const _0x3e457e=await _0x1d7533['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x27a440=await _0x1d7533['evaluate'](_0x539392=>_0x539392['innerHTML'],_0x3e457e);_0x4a160c=Math['ceil'](_0x27a440/0x4);}else _0x4a160c=Math['ceil'](_0x2c9491/0x4);let _0x15ec31=await _0x1d7533['waitForSelector']('a[href=\x22/'+_0x3f9b7d+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x15ec31['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x3f9b7d+'\x20gesichtet');}catch(_0x4ed046){return console['log']('Follower\x20Liste\x20von\x20'+_0x3f9b7d+'\x20nicht\x20gefunden:'+_0x4ed046),handle_fail(0x0);}}catch(_0x775a75){return console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x775a75),handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x4a160c),await scroll(_0x1d7533,FOLLOWER_FENSTER,_0x4a160c),await _0x1d7533['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x216b18=await _0x1d7533['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x261e11=await _0x1d7533['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x2c9491<=0x0&&(_0x2c9491=_0x216b18['length']);for(let _0xe7c62f=0x0;_0xe7c62f<_0x216b18['length']&&_0xe7c62f<_0x2c9491;_0xe7c62f++){console['log'](await _0x216b18[_0xe7c62f]['evaluate'](_0x579d02=>_0x579d02['textContent']));const _0x11685c='INSERT\x20INTO\x20'+_0x3dd601+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x11685c,[await _0x216b18[_0xe7c62f]['evaluate'](_0x8234e4=>_0x8234e4['textContent']),await _0x261e11[_0xe7c62f]['evaluate'](_0x3671dd=>_0x3671dd['textContent'])],function(_0x52972a){_0x52972a?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x3dd601+'\x27:',_0x52972a['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return new Promise(_0x141cca=>{_0x141cca('Scraping\x20finished!');});}catch(_0x477461){return console['log']('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x3f9b7d+'\x20nicht\x20gefunden:'+_0x477461),handle_fail(0x0);}}async function fetch_likers_from_post(_0xef9bf2,_0x17f47c,_0x12b949,_0x3ca5a0,_0xfb78b3){try{await login(_0xef9bf2,_0xfb78b3['username'],_0xfb78b3['password']);}catch(_0x4a5a0b){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4a5a0b);return handle_fail(0x1);return;}try{let _0x539031=_0x17f47c['substring'](0x0,_0x17f47c['lastIndexOf']('/')),_0x436a28=_0x539031+'/liked_by';console['log'](_0x436a28),await _0xef9bf2['goto'](_0x436a28),await delay(0x7d0,0xfa0),await notificationClear(_0xef9bf2),await delay(0xc8,0x1f4),await _0xef9bf2['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x408fe0=await _0xef9bf2['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x398cde=await _0xef9bf2['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x408fe0['length']);let _0x5323c1=path['join'](__dirname,'/likers.csv');_0x12b949<=0x0&&(_0x12b949=_0x408fe0['length']);try{for(let _0x2c8d28=0x0;_0x2c8d28<_0x408fe0['length']&&_0x2c8d28<_0x12b949;_0x2c8d28++){console['log'](await _0x408fe0[_0x2c8d28]['evaluate'](_0x15d61a=>_0x15d61a['textContent']));try{const _0xdb3cc1='INSERT\x20INTO\x20'+_0x3ca5a0+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0xdb3cc1,[await _0x408fe0[_0x2c8d28]['evaluate'](_0x194342=>_0x194342['textContent']),await _0x398cde[_0x2c8d28]['evaluate'](_0x3c5518=>_0x3c5518['textContent'])],function(_0x4c711f){_0x4c711f?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x3ca5a0+'\x27:',_0x4c711f['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x413d4a){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x2c8d28+'\x20:\x20'+_0x413d4a),handle_fail(0x1);}}return new Promise(_0x3786ba=>{_0x3786ba('Scraping\x20finished!');});}catch(_0x180575){return console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben'),handle_fail(0x1);}}catch(_0x15d822){return console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x15d822),handle_fail(0x1);}}async function fetch_comments_from_post(_0x1c6aa6,_0x30c7ed,_0xbefc74,_0x1cf3d6,_0x4be684){try{await login(_0x1c6aa6,_0x4be684['username'],_0x4be684['password']);}catch(_0x5a016a){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5a016a),handle_fail(0x2);}try{console['log'](_0x30c7ed),await _0x1c6aa6['goto'](_0x30c7ed),await delay(0x7d0,0xfa0),await notificationClear(_0x1c6aa6),await delay(0xc8,0x1f4);const _0x1448ee=COM_COMMENTS_BOX_BODY_DIV;let _0x5877c5;if(_0xbefc74<=0x0){const _0x3768b2=await _0x1c6aa6['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x4ba808=await _0x1c6aa6['evaluate'](_0x235193=>_0x235193['innerHTML'],_0x3768b2),_0x30f714=String(_0x4ba808)['replace'](/[^0-9]/g,''),_0x2034cd=Number(_0x30f714)/0x14;_0x5877c5=Math['ceil'](_0x2034cd/0x3);}else _0x5877c5=Math['ceil'](_0xbefc74/0x3);console['log']('Auto-scrolls:\x20'+_0x5877c5),await scroll(_0x1c6aa6,_0x1448ee,_0x5877c5);try{const _0x131e78=COM_REPLY_BUTTON_SPAN;await _0x1c6aa6['waitForSelector'](_0x131e78),await delay(0x1f4,0x320);const _0x41492d=await _0x1c6aa6['$$'](_0x131e78);console['log'](_0x41492d),await delay(0xc8,0x1f4);try{for(let _0x5d4b04=0x0;_0x5d4b04<_0x41492d['length'];_0x5d4b04++){_0x41492d[_0x5d4b04]['click'](),await delay(0x320,0x5dc);}}catch(_0x2826a5){return console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x2826a5),handle_fail(0x2);}}catch(_0xa179de){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x13d550=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x1c6aa6['waitForSelector'](_0x13d550),await delay(0x1f4,0x320);const _0x46e079=await _0x1c6aa6['$$'](_0x13d550);let _0x403a2b=path['join'](__dirname,'/comments.csv');_0xbefc74<=0x0&&(_0xbefc74=_0x46e079['length']);console['log']('fetch_limit:\x20'+_0xbefc74),console['log']('comments_len:\x20'+_0x46e079['length']),_0xbefc74++;try{for(let _0x32f012=0x1;_0x32f012<_0x46e079['length']&&_0x32f012<_0xbefc74;_0x32f012++){try{console['log'](await _0x46e079[_0x32f012]['evaluate'](_0x2ffd35=>_0x2ffd35['textContent']));const _0xd73349=await db['prepare']('INSERT\x20INTO\x20'+_0x1cf3d6+'\x20(username)\x20VALUES\x20(?)');await _0xd73349['run'](await _0x46e079[_0x32f012]['evaluate'](_0x41ce27=>_0x41ce27['textContent']),function(_0x1a5401){_0x1a5401&&console['log']('error\x20in\x20add-user:'+_0x1a5401);}),await _0xd73349['finalize']();}catch(_0xceabee){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x32f012+'\x20:\x20'+_0xceabee),handle_fail(0x2);}}await delay(0x4b0,0x7d0);try{await set_clearname_from_username(_0x1c6aa6,_0x1cf3d6);}catch(_0x118b45){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x118b45);}return new Promise(_0x3bb4b8=>{_0x3bb4b8('Scraping\x20finished!');});}catch(_0x3fb8bf){return console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben'),handle_fail(0x2);}}catch(_0x4421d0){return console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x4421d0),handle_fail(0x2);}}async function set_clearname_from_username(_0x19b410,_0x155fe4){try{let _0xa2b3cb,_0x19a2f5;const _0x4b7b50='SELECT\x20username\x20FROM\x20'+_0x155fe4+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x4b7b50,[],(_0x39b243,_0x158a96)=>{_0x39b243&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x39b243['message']),_0x158a96['length']===0x0&&(_0x19a2f5=_0x158a96['length']),_0xa2b3cb=_0x158a96['map'](_0x47401d=>_0x47401d['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x19a2f5);if(_0x19a2f5===0x0){console['log']('Leave');return;}const _0x176467=await _0x19b410['waitForSelector'](IG_SEARCH_BUTTON);await _0x176467['click'](),await delay(0x4b0,0x7d0);for(let _0x31971b of _0xa2b3cb){const _0x3a1286=await _0x19b410['waitForSelector'](IG_SEARCH_INPUT);await _0x3a1286['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x19b410['type'](IG_SEARCH_INPUT,_0x31971b,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x3e40a3=0x1;while(_0x3e40a3!=0x14){console['log']('Schleife');try{let _0x4971b3=IG_NAME_SPAN_PART1+_0x3e40a3+IG_USERNAME_SPAN_PART2;const _0x55988b=await _0x19b410['waitForSelector'](_0x4971b3),_0x329705=await _0x19b410['evaluate'](_0x1c6178=>_0x1c6178['innerHTML'],_0x55988b);await delay(0xc8,0x1f4);if(_0x329705==_0x31971b){let _0x296c92=IG_NAME_SPAN_PART1+_0x3e40a3+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x32df89=await _0x19b410['waitForSelector'](_0x296c92);let _0x45410c=await _0x19b410['evaluate'](_0x5618c0=>_0x5618c0['innerHTML'],_0x32df89);const _0x18486a=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x4f89f3=_0x45410c['match'](_0x18486a);_0x4f89f3?_0x45410c=_0x4f89f3[0x1]['trim']():_0x45410c=_0x45410c['trim']();const _0x166a0e='UPDATE\x20'+_0x155fe4+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x166a0e,[_0x45410c,_0x329705],function(_0x150e2d){_0x150e2d&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x150e2d['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x3e40a3++;}catch(_0x452dde){const _0x2f673a='UPDATE\x20'+_0x155fe4+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x2f673a,['',_0x31971b],function(_0x47d759){_0x47d759&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x47d759['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x452dde);break;}}}await _0x176467['click']();}catch(_0x3c80c9){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x3c80c9);}}const campaignPath=path['resolve'](__dirname,'data/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(campaign_name\x20TEXT\x20PRIMARY\x20KEY,\x20list_id\x20TEXT,\x20zeitabstand\x20REAL,\x20message_id\x20TEXT,\x20account\x20TEXT,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x255e25,_0x38b42a)=>{const _0x558160='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x558160,[],(_0x58a8ed,_0x5c3a7b)=>{_0x58a8ed?_0x38b42a(_0x58a8ed):_0x255e25(_0x5c3a7b);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0xc7f05e,_0x182f24)=>{const _0x207c8a='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x207c8a,[],async(_0x2e2984,_0x4bfc42)=>{if(_0x2e2984)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x2e2984['message']),_0x182f24({'status':'error','message':_0x2e2984['message']});else try{const _0x17c1c6=await Promise['all'](_0x4bfc42['map'](_0x5c0a7a=>{return new Promise(_0x2a12aa=>{if(!_0x5c0a7a['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x5c0a7a['campaign_name']),_0x2a12aa({'campaign_name':_0x5c0a7a['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x49fac9='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x5c0a7a['list_id'],_0x56f13b='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20'+_0x5c0a7a['list_id']+'\x20WHERE\x20contacted\x20=\x201';db['get'](_0x49fac9,[],(_0x201e0d,_0x5d382b)=>{_0x201e0d?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x5c0a7a['campaign_name']+':',_0x201e0d['message']),_0x2a12aa({'campaign_name':_0x5c0a7a['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):db['get'](_0x56f13b,[],(_0x565e2b,_0x272ec9)=>{_0x565e2b?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x5c0a7a['campaign_name']+':',_0x565e2b['message']),_0x2a12aa({'campaign_name':_0x5c0a7a['campaign_name'],'lead_count':_0x5d382b?_0x5d382b['lead_count']:0x0,'contacted_count':'N/A'})):_0x2a12aa({'campaign_name':_0x5c0a7a['campaign_name'],'lead_count':_0x5d382b?_0x5d382b['lead_count']:0x0,'contacted_count':_0x272ec9?_0x272ec9['contacted_count']:0x0});});});});}));_0xc7f05e({'status':'success','campaigns':_0x17c1c6});}catch(_0x2cddd8){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x2cddd8),_0x182f24({'status':'error','message':_0x2cddd8['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x290875,_0x1740ee)=>{return new Promise((_0x79da8c,_0xcc20ff)=>{const _0x46c765='SELECT\x20campaign.list_id,\x20message.message_text,\x20campaign.zeitabstand,\x20campaign.account\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x46c765,[_0x1740ee],(_0x1a3439,_0x4e470b)=>{_0x1a3439?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x1a3439),_0xcc20ff(_0x1a3439)):(console['log']('ROWS'),console['log'](_0x4e470b),debugDatabaseContents(),_0x79da8c(_0x4e470b));});});});const showTableContents=_0x1d8a20=>{return new Promise((_0x555151,_0x312e29)=>{const _0x33eab0='SELECT\x20*\x20FROM\x20'+_0x1d8a20+';';campaignDB['all'](_0x33eab0,(_0x34ee6b,_0x46db0f)=>{_0x34ee6b?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x1d8a20+':',_0x34ee6b),_0x312e29(_0x34ee6b)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x1d8a20+':',_0x46db0f),_0x555151({'status':'success','message':_0x46db0f}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x55cf94){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x55cf94);}}ipcMain['handle']('create-campaign',async(_0xdb7509,_0x43cd66)=>{return new Promise((_0x1b112d,_0x4164d5)=>{const _0x3c5e53='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x3c5e53,[String(_0x43cd66)],function(_0x370aa2){_0x370aa2?_0x4164d5(_0x370aa2):_0x1b112d({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x23f6f3,_0x234730)=>{return new Promise((_0x59c6a9,_0x31c94d)=>{const _0x523033='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x523033,[_0x234730],function(_0x431f79){_0x431f79?_0x31c94d(_0x431f79):_0x59c6a9({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x193303,_0x2f6a7e,_0xc8797d,_0x368ee2,_0x459e3a,_0x418c83)=>{const _0x1e2bd1=await createMessageID(_0x459e3a);return new Promise((_0x5e6f6d,_0x58b6d6)=>{if(!_0x2f6a7e||!_0xc8797d||!_0x368ee2||!_0x1e2bd1||!_0x418c83)return _0x58b6d6({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x1e2bd1);const _0x455acb='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x455acb,[_0xc8797d,_0x368ee2,_0x1e2bd1,_0x418c83,_0x2f6a7e],function(_0x78e66f){if(_0x78e66f)_0x58b6d6({'status':'error','message':_0x78e66f['message']});else this['changes']===0x0?_0x58b6d6({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x5e6f6d({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x5a40c7,_0x102207,_0x5e6eca,_0x4498c8)=>{return new Promise((_0x1fe2d3,_0x4d779a)=>{const _0x422192='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username)\x20VALUES\x20(?,\x20?,\x20?)';campaignDB['run'](_0x422192,[_0x102207,_0x5e6eca,_0x4498c8],function(_0x2f9b31){return _0x2f9b31?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x2f9b31['message']),_0x4d779a('insert-dm-response',{'success':![],'message':_0x2f9b31['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x1fe2d3('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x4323e0=>{return new Promise((_0x32462d,_0x1641f1)=>{const _0x2b5bc0='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x2b5bc0,[_0x4323e0],(_0xd53a3c,_0x216736)=>{if(_0xd53a3c)_0x1641f1({'status':'error','message':_0xd53a3c['message']});else{if(_0x216736)_0x32462d(_0x216736['message_id']);else{const _0x296146='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x296146,[_0x4323e0],function(_0x1cd75f){_0x1cd75f?_0x1641f1({'status':'error','message':_0x1cd75f['message']}):_0x32462d(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x379c0a,_0x6d108d)=>{return new Promise((_0x11e8a5,_0xf186bb)=>{const _0x46afeb='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x6d108d;db['get'](_0x46afeb,(_0x918eb9,_0x1f3547)=>{_0x918eb9?_0xf186bb({'status':'error','message':_0x918eb9['message']}):_0x11e8a5({'status':'success','count':_0x1f3547['count']});});});});const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20password\x20TEXT,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x73cfb9,_0x4908f1){try{const _0x586abf=await new Promise((_0xeb36f3,_0x12903b)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x4908f1],(_0x524e41,_0x453984)=>{if(_0x524e41)_0x12903b(_0x524e41);else{if(_0x453984['length']>0x0){let _0x45735b=JSON['parse'](_0x453984[0x0]['cookie']);console['log'](_0x45735b),_0xeb36f3(_0x45735b);}else _0x12903b(new Error('User\x20with\x20username\x20'+_0x4908f1+'\x20does\x20not\x20exist.'));}});});await _0x73cfb9['setCookie'](..._0x586abf),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x5574a6){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x5574a6);}}async function saveCookiesForUser(_0x16c144,_0x55af97){try{let _0x113240=await _0x16c144['cookies']();_0x113240=JSON['stringify'](_0x113240),igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x55af97],(_0x38353d,_0x4f9399)=>{if(_0x38353d){console['error']('Error\x20checking\x20user\x20existence:',_0x38353d);throw _0x38353d;}else{if(_0x4f9399){const _0x41f7bb=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x41f7bb['run'](_0x113240,_0x55af97,function(_0x188f40){_0x188f40?console['error']('Error\x20updating\x20cookies:',_0x188f40):console['log']('Cookies\x20updated\x20for\x20user:',_0x55af97);});}else{const _0xc70e39=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0xc70e39['run'](_0x55af97,_0x113240,function(_0x5c2f5a){_0x5c2f5a?console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x5c2f5a):console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x55af97);});}}});}catch(_0x53fed5){console['error']('Error\x20fetching\x20cookies:',_0x53fed5);throw _0x53fed5;}}async function createUserIfNotExists(_0x3221e2,_0x5bd501){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x3221e2],(_0x482b1b,_0x5200ac)=>{if(_0x482b1b){console['error']('Error\x20checking\x20user\x20existence:',_0x482b1b);throw _0x482b1b;}else{if(!_0x5200ac){const _0x34f7da=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20password)\x20VALUES\x20(?,\x20?)');_0x34f7da['run'](_0x3221e2,_0x5bd501,function(_0x58e40){_0x58e40?console['error']('Error\x20inserting\x20new\x20user:',_0x58e40):console['log']('New\x20user\x20created:',_0x3221e2);});}else console['log']('User\x20already\x20exists:',_0x3221e2);}});}catch(_0x2545a7){console['error']('Error\x20creating\x20user:',_0x2545a7);throw _0x2545a7;}}ipcMain['handle']('create-relation',async(_0xcf329c,_0x43e458)=>{return new Promise((_0xb25776,_0x2e8211)=>{const _0x4c8a32='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x43e458+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT)';db['run'](_0x4c8a32,function(_0x14ceb9){_0x14ceb9?_0x2e8211(_0x14ceb9):_0xb25776({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x5b7ae3,_0x504835)=>{return console['log']('droping\x20table'+_0x504835),new Promise((_0x504468,_0x4f3f85)=>{const _0x48d2f2='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x504835;console['log']('droping\x20table'+_0x504835),db['run'](_0x48d2f2,function(_0x580c13){_0x580c13?_0x4f3f85(_0x580c13):_0x504468({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x5343bf=>{return new Promise((_0x540023,_0x42a6b7)=>{const _0x44b6d3='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x44b6d3,[],(_0x154b6a,_0x10cc0d)=>{_0x154b6a?_0x42a6b7(_0x154b6a):_0x540023(_0x10cc0d['map'](_0x4061f6=>_0x4061f6['name']));});});}),ipcMain['handle']('add-user',async(_0x116609,_0x547cdd,_0x4a062d)=>{return new Promise(_0x1f88a9=>{const _0x5424be=db['prepare']('INSERT\x20INTO\x20'+_0x4a062d+'\x20(username)\x20VALUES\x20(?)');_0x5424be['run'](_0x547cdd,function(_0x366bf9){_0x366bf9?console['log']('error\x20in\x20add-user:'+_0x366bf9):_0x1f88a9({'status':'success','id':this['lastID']});}),_0x5424be['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x589d42,_0x895ffa)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x219c6b,_0x22dbab)=>{if(_0x219c6b)_0x895ffa(_0x219c6b);else{_0x589d42({'status':'success','users':_0x22dbab});for(_0x22dbab of _0x22dbab){console['log'](_0x22dbab['username']);}}});});}),ipcMain['handle']('get-data',async(_0x3a5341,_0x29b37e)=>{return new Promise((_0x3f804f,_0x3b82d3)=>{const _0x5be332='SELECT\x20*\x20FROM\x20'+_0x29b37e;console['log'](_0x5be332),db['all'](_0x5be332,[],(_0x4e1950,_0x2f79bb)=>{_0x4e1950?_0x3b82d3(_0x4e1950):_0x3f804f(_0x2f79bb);});});}),ipcMain['handle']('get-accounts',async _0x6b370b=>{return new Promise((_0x1a121b,_0xaebdf1)=>{const _0x7c4d17='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x7c4d17),igaccountsDB['all'](_0x7c4d17,[],(_0x449a3a,_0x1ace5f)=>{_0x449a3a?_0xaebdf1(_0x449a3a):_0x1a121b(_0x1ace5f);});});}),ipcMain['handle']('get-targets',async(_0x17a4ec,_0x181c63)=>{return getTargetProfiles(_0x181c63);}),ipcMain['handle']('delete-user',async(_0x55ef2f,_0x291148,_0x3414e0)=>{return new Promise((_0x112e20,_0x2ee5cf)=>{const _0x289b24=db['prepare']('DELETE\x20FROM\x20'+_0x3414e0+'\x20WHERE\x20username\x20=\x20?');_0x289b24['run'](_0x291148,function(_0x331c50){_0x331c50?_0x2ee5cf(_0x331c50):_0x112e20({'status':'success','changes':this['changes']});}),_0x289b24['finalize']();});}),ipcMain['handle']('delete-account',async(_0x387668,_0x3655b8)=>{const _0x10b4e5=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x10b4e5['run'](_0x3655b8,function(_0x64b8e8){_0x64b8e8&&console['log'](_0x64b8e8);}),_0x10b4e5['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x14bf3e,_0x577c34)=>{const _0x26e512='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x26e512,[],(_0x195446,_0x4dd836)=>{_0x195446?_0x577c34({'status':'error','message':_0x195446['message']}):_0x14bf3e({'status':'success','contactedCount':_0x4dd836['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x57ed6c,_0x207c10)=>{const _0x465df4='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x465df4,[],(_0x5ed29e,_0x2aeb2c)=>{_0x5ed29e?_0x207c10({'status':'error','message':_0x5ed29e['message']}):_0x57ed6c({'status':'success','contactedCount':_0x2aeb2c['contactedCount']});});});});