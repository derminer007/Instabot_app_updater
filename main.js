const {app,BrowserWindow,ipcMain,dialog}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div',K_OPTIONS_BUTTON='section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.xs5motx\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD='div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f',K_SEND_MSG_BUTTON='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x27a574=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x27a574['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x27a574['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x91e56c){var _0x1bb502=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x2a65c0){console['log']('window\x20id:'+_0x2a65c0['id']),_0x2a65c0['id']>0x1&&(_0x1bb502=!![]);}),console['log']('child\x20opened\x20='+_0x1bb502);if(!_0x1bb502){const _0x59c96f=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x59c96f['loadFile'](_0x91e56c['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0);});const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x499964='',_0x3f4423=null;if(process['platform']==='darwin')_0x499964=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x499964=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x499964}),_0x3f4423=await browser_login['newPage'](),_0x3f4423['setDefaultNavigationTimeout'](0x1d4c),_0x3f4423['setDefaultTimeout'](0x1d4c),_0x3f4423;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x3a2b60=0x1,_0x3c4cb6=0x0){let _0x3da863='',_0x42d9ec=null;const _0x4a0824=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x3da863=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x3da863=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x3a2b60===0x0&&!pageStack[_0x3c4cb6])return browser=await puppeteer['launch']({'headless':_0x4a0824,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x3da863}),_0x42d9ec=await browser['newPage'](),_0x42d9ec['setDefaultNavigationTimeout'](0x1d4c),_0x42d9ec['setDefaultTimeout'](0x1d4c),pageStack[_0x3c4cb6]=_0x42d9ec,_0x42d9ec;return(browser===null||pageStack[_0x3c4cb6]===null||pageStack[_0x3c4cb6]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x4a0824,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x3da863})),(pageStack[_0x3c4cb6]===null||pageStack[_0x3c4cb6]['isClosed']())&&(_0x42d9ec=await browser['newPage'](),_0x42d9ec['setDefaultNavigationTimeout'](0x1d4c),_0x42d9ec['setDefaultTimeout'](0x1d4c),pageStack[_0x3c4cb6]=_0x42d9ec),pageStack[_0x3c4cb6];}ipcMain['on']('login',async(_0x5c761a,_0x29f871)=>{const _0x3e6596=await getBrowserPageLogin();await _0x3e6596['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x3e6596,_0x29f871),ipcMain['on']('setLoginCookies',async(_0x480b15,_0x1290d9)=>{try{await set_login_cookies(_0x3e6596,_0x1290d9);}catch(_0x3aae6f){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x3aae6f);}});}),ipcMain['on']('export-relation',async(_0x41e32f,_0xb06a86)=>{try{await exportDatabase(_0xb06a86),_0x41e32f['reply']('export-relation-response',{'success':!![]});}catch(_0x305404){console['error'](_0x305404),_0x41e32f['reply']('export-relation-response',{'success':![],'message':_0x305404['message']});}}),ipcMain['handle']('sendMessage',async(_0x24a4fa,_0x59ccb4,_0x248da3,_0x1aee36,_0x6f0580,_0x346e3d,_0x479c6c,_0x583206)=>{isStopping=![];let _0x3ad367=null;return _0x479c6c?_0x3ad367=await getBrowserPage(_0x6f0580,_0x583206):_0x3ad367=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x59ccb4),send_message(_0x3ad367,_0x59ccb4,_0x248da3,_0x1aee36,_0x6f0580,_0x346e3d);}),ipcMain['handle']('stop-action',async(_0x49e134,_0x5e2d03)=>{isStopping=!![];const _0x2c92ea=await getBrowserPage(0x1,_0x5e2d03);await _0x2c92ea['close']();}),ipcMain['handle']('fetch_followers',async(_0x4aeeca,_0x1924e6,_0x197045,_0xf75fdb,_0x28f620,_0x3d81f6)=>{isStopping=![];const _0x12db51=await getBrowserPage();return fetch_followers_from_account(_0x4aeeca,_0x12db51,_0x1924e6,_0x197045,_0xf75fdb,_0x28f620,_0x3d81f6);}),ipcMain['handle']('get-account-details',async(_0x2f86bc,_0x3114cf,_0x384353,_0x46e2d9)=>{isStopping=![];const _0x308925=await getBrowserPage();return fetch_account_details(_0x308925,_0x3114cf,_0x384353,_0x46e2d9);}),ipcMain['handle']('fetch_likes',async(_0x3ef95f,_0x35d9a6,_0x1f0af6,_0x2b382b,_0x2143a7,_0x229e76)=>{isStopping=![];const _0x11e05f=await getBrowserPage();return fetch_likers_from_post(_0x3ef95f,_0x11e05f,_0x35d9a6,_0x1f0af6,_0x2b382b,_0x2143a7,_0x229e76);}),ipcMain['handle']('fetch_comments',async(_0xc4fade,_0x3a4130,_0x446b2a,_0x5dae94,_0x50d0a5,_0x5aeb78)=>{isStopping=![];const _0x4a03ce=await getBrowserPage();return fetch_comments_from_post(_0xc4fade,_0x4a03ce,_0x3a4130,_0x446b2a,_0x5dae94,_0x50d0a5,_0x5aeb78);}),ipcMain['handle']('update-app',async _0x52beed=>{const {spawn:_0x11fe8c}=require('child_process'),_0x206056=require('path');return new Promise((_0x3baf00,_0x5805bb)=>{(process['env']['NODE_ENV']==='development'||process['env']['SKIP_UPDATES']==='true')&&(console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x3baf00('Update\x20übersprungen'));if(process['platform']==='darwin'){const _0x9cb5c3=_0x206056['join'](__dirname,'mac-updater-intern.sh'),_0x5c37ed=_0x11fe8c('/bin/bash',[_0x9cb5c3]);_0x5c37ed['stdout']['on']('data',_0x319a62=>{console['log']('stdout:\x20'+_0x319a62);}),_0x5c37ed['stderr']['on']('data',_0x4b514e=>{console['error']('stderr:\x20'+_0x4b514e);}),_0x5c37ed['on']('close',_0x169534=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x169534),_0x169534===0x0?_0x3baf00('Update\x20erfolgreich\x20abgeschlossen.'):_0x5805bb(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x169534));});}else{if(process['platform']==='win32'){const _0x4f60d1=_0x206056['join'](__dirname,'../','../','../');process['chdir'](_0x4f60d1),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x25accf='soft-ui-updater-windows.ps1',_0x5d3aec=_0x11fe8c('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x25accf]);_0x5d3aec['stdout']['on']('data',_0x11ecfc=>{console['log']('stdout:\x20'+_0x11ecfc);}),_0x5d3aec['stderr']['on']('data',_0x2aa226=>{console['error']('stderr:\x20'+_0x2aa226);}),_0x5d3aec['on']('close',_0x2f36b6=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x2f36b6),_0x2f36b6===0x0?_0x3baf00('Update\x20erfolgreich\x20abgeschlossen.'):_0x5805bb(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x2f36b6));});}else _0x5805bb(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}});});function getRnd(_0x37b0c1,_0x5b8682){return Math['random']()*(_0x5b8682-_0x37b0c1+0x1)+_0x37b0c1;}function delay(_0x49aeae,_0x41d5a7){let _0x422480=getRnd(_0x49aeae,_0x41d5a7);return new Promise(function(_0x38fc02){setTimeout(_0x38fc02,_0x422480);});}async function scroll(_0x319f24,_0x3a6fd9,_0x31d012=0x2,_0x3b9dcd){const _0x380bad=await _0x319f24['waitForSelector'](_0x3a6fd9);for(let _0x10c89b=0x0;_0x10c89b<_0x31d012;_0x10c89b++){console['log']('Scrolling\x20'+_0x10c89b),await _0x319f24['evaluate'](_0x297cdc=>{const _0x22b474=document['querySelector'](_0x297cdc);_0x22b474&&_0x22b474['scrollBy'](0x0,0x190);},_0x3a6fd9),await delay(0x320,0x5dc),_0x3b9dcd();}}async function saveCookies(_0x2a0d9e){let _0x5d5b26=await _0x2a0d9e['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x5d5b26,null,0x2));}async function notificationClear(_0x91cc97){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x91cc97['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x91cc97['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x1d3821){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x1d3821);}}async function getTargetProfiles(_0x36535f){return new Promise((_0x531997,_0x452140)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x36535f,(_0x18e01a,_0x3df297)=>{_0x18e01a?_0x452140(_0x18e01a):_0x531997(_0x3df297);});});}async function login_legacy(_0x2d1a75,_0x51a62e,_0x6ac959){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x2d1a75,_0x51a62e),await createUserIfNotExists(_0x51a62e,_0x6ac959);}catch(_0x29397a){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x29397a);}try{await _0x2d1a75['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x2d1a75['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x2d1a75['click']('button._a9--._ap36._a9_0');}catch(_0x42a512){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x2d1a75['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x2d1a75['type']('input[name=\x27username\x27]',_0x51a62e,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x2d1a75['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x2d1a75['type']('input[name=\x27password\x27]',_0x6ac959,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x2d1a75['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x2d1a75['click']('button[type=\x27submit\x27]');}catch(_0x23d912){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x2d1a75),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x2d1a75,_0x51a62e);}catch(_0x4a0e0e){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x4a0e0e);}}catch(_0x3535a0){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x3535a0);}}async function login(_0x57c7c2,_0x563663){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x57c7c2,_0x563663),await createUserIfNotExists(_0x563663);}catch(_0x4ede9b){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4ede9b);}try{await _0x57c7c2['goto']('https://www.instagram.com/accounts/login/');}catch(_0x2fdb62){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x2fdb62);}}async function set_login_cookies(_0x31d593,_0x368e6b){try{await saveCookiesForUser(_0x31d593,_0x368e6b);}catch(_0x18da35){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x18da35);}}async function waitForXPath(_0x388eb4,_0x274bf4,_0x58d95d={}){return await _0x388eb4['waitForFunction'](_0x3290bf=>{return document['evaluate'](_0x3290bf,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x58d95d,_0x274bf4),_0x388eb4['evaluateHandle'](_0x2e6db4=>document['evaluate'](_0x2e6db4,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x274bf4);}async function send_message(_0x38cc45,_0x2a2e5e,_0x2d1a5e,_0xa27167,_0x1ac2c6,_0x58d756){return new Promise(async(_0x3f0398,_0x18db42)=>{_0x58d756=_0x58d756['split'](';'),console['log'](_0x58d756[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x1ac2c6);try{await setCookiesForUser(_0x38cc45,_0x58d756[0x0]);}catch(_0x5e79a7){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x5e79a7),_0x18db42({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x5e79a7});return;}try{await _0x38cc45['goto']('https://www.instagram.com/'+_0x2a2e5e+'/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x38cc45);}catch(_0x407df5){_0x18db42({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x407df5});return;}try{await _0x38cc45['waitForSelector'](K_DIRECT_MSG_BUTTON),await _0x38cc45['click'](K_DIRECT_MSG_BUTTON);}catch(_0xc164ec){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0xc164ec);try{await _0x38cc45['waitForSelector'](K_OPTIONS_BUTTON),await _0x38cc45['click'](K_OPTIONS_BUTTON),await delay(0x1f4,0x320);const _0x3f32d5=await waitForXPath(_0x38cc45,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x3f32d5['click']();}catch(_0x3b570b){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x3b570b),_0x3f0398({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x38cc45);}catch(_0x1645b6){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x1645b6);}try{const _0x45f00d=await _0x38cc45['waitForSelector'](K_CHAT_INPUT_FIELD),_0x141c9a=await _0x38cc45['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x141c9a),_0xa27167=_0xa27167['replace']('{USERNAME}',_0x2a2e5e);let _0x5bcb30=_0x141c9a['split']('\x20')[0x0];_0xa27167=_0xa27167['replace']('{NAME}',_0x5bcb30),_0xa27167=_0xa27167['replace']('{name}',_0x5bcb30),await _0x45f00d['type'](_0xa27167,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0x1716d3=await _0x38cc45['waitForSelector'](K_SEND_MSG_BUTTON);await _0x1716d3['click'](),await delay(0x320,0x3e8),_0x3f0398({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!'});}catch(_0x5d2bae){console['error']('Nachricht\x20nicht\x20gesendet:\x20'+_0x5d2bae),_0x18db42('Nachricht\x20nicht\x20gesendet:\x20'+_0x5d2bae);}});}function handle_fail(_0x106015){if(isStopping)return new Promise(_0x147758=>{_0x147758('Scraper\x20gestoppt.');});else{let _0x213874='';switch(_0x106015){case 0x0:_0x213874='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x213874='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x213874='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x213874='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x28815c,_0x535c78)=>{_0x535c78(_0x213874);});}}async function fetch_account_details(_0x550710,_0x5d1db9,_0x173456,_0x3fa019){try{await setCookiesForUser(_0x550710,_0x173456['username']);}catch(_0x527e9b){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x527e9b);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x527e9b);return handle_fail(0x0);}_0x550710['setDefaultNavigationTimeout'](0x7530),await _0x550710['goto']('https://www.instagram.com/'+_0x5d1db9+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x550710);const _0x14fcfc=await _0x550710['evaluate'](()=>{const _0x21d9ce=document['querySelector']('meta[property=\x22og:image\x22]');return _0x21d9ce?_0x21d9ce['getAttribute']('content'):null;});await _0x550710['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x413ed5=await _0x550710['evaluate'](()=>{const _0x3ab71f=document['querySelector']('meta[name=\x22description\x22]');if(!_0x3ab71f)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x3ca963=_0x3ab71f['getAttribute']('content');if(!_0x3ca963)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x3ca963);const _0xcbf4da=/\s*[–-]\s*/,_0x395443=_0x3ca963['split'](_0xcbf4da);if(_0x395443['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x4ef309=_0x395443[0x0],_0x2e43b1=_0x395443[0x1],_0x23a95a=_0x4ef309['split'](',\x20');if(_0x23a95a['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0xca6f76=_0x23a95a[0x0]['split']('\x20')[0x0],_0x36b81d=_0x23a95a[0x1]['split']('\x20')[0x0],_0x4461a4=_0x23a95a[0x2]['split']('\x20')[0x0];let _0x1d7add='',_0xb74175='';const _0x416799='\x20on\x20Instagram:\x20',_0x7e7f13=_0x2e43b1['split'](_0x416799);return _0x1d7add=_0x7e7f13[0x0]['trim'](),_0x1d7add=_0x1d7add['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x7e7f13['length']>0x1&&(_0xb74175=_0x7e7f13[0x1]['trim'](),_0xb74175['startsWith']('\x22')&&_0xb74175['endsWith']('\x22')&&(_0xb74175=_0xb74175['substring'](0x1,_0xb74175['length']-0x1)['trim']()),_0xb74175=_0xb74175['replace'](/&quot;/g,'')['trim']()),{'followers':_0xca6f76,'following':_0x36b81d,'posts':_0x4461a4,'nameText':_0x1d7add,'bio':_0xb74175};});console['log']('Extracted\x20profile\x20data:',_0x413ed5);const _0x3928de=_0x413ed5['nameText'],_0x446276=_0x14fcfc,_0x4c5e61=_0x413ed5['bio'],_0x4607d3=_0x413ed5['followers'],_0x2ed62a=_0x413ed5['following'],_0x13f90f=_0x413ed5['posts'],_0x4d70af=![],_0xf2f7f9=![],_0x18e85c=![],_0x413b6c='\x0a\x20\x20INSERT\x20INTO\x20'+_0x3fa019+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x413b6c,[_0x5d1db9,_0x3928de,_0x446276,_0x4c5e61,_0x4607d3,_0x2ed62a,_0x13f90f,_0x4d70af,_0xf2f7f9,_0x18e85c],function(_0xc1db82){_0xc1db82?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0xc1db82['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x2d10f6,_0x4a7c6a,_0x571c83,_0x1395a3,_0x33c259,_0x2bf345,_0x11868f){let _0x5ada95=0x4,_0x54abd2=0x0,_0x264924=0x0;try{await setCookiesForUser(_0x4a7c6a,_0x2bf345['username']);}catch(_0x2ffbdd){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x2ffbdd);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2ffbdd);return handle_fail(0x0);}let _0xe6f51=0x0;try{await _0x4a7c6a['goto']('https://www.instagram.com/'+_0x571c83+'/'),await notificationClear(_0x4a7c6a);try{if(_0x1395a3<=0x0){const _0x3aa068=await _0x4a7c6a['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x1115e8=await _0x4a7c6a['evaluate'](_0x23e9a5=>_0x23e9a5['innerHTML'],_0x3aa068);_0xe6f51=Math['ceil'](_0x1115e8/0x4);}else _0xe6f51=Math['ceil'](_0x1395a3/0x4);_0x5ada95+=_0xe6f51,_0x264924=Math['round'](++_0x54abd2/_0x5ada95*0x64),_0x2d10f6['sender']['send']('fetch-progress',_0x264924,!![]);let _0x1beb0f=await _0x4a7c6a['waitForSelector']('a[href=\x22/'+_0x571c83+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x1beb0f['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x571c83+'\x20gesichtet'),_0x264924=Math['round'](++_0x54abd2/_0x5ada95*0x64),_0x2d10f6['sender']['send']('fetch-progress',_0x264924,!![]);}catch(_0x570919){console['log']('Follower\x20Liste\x20von\x20'+_0x571c83+'\x20nicht\x20gefunden:'+_0x570919);throw new Error('Follower\x20Liste\x20von\x20'+_0x571c83+'\x20nicht\x20gefunden:'+_0x570919);return handle_fail(0x0);}}catch(_0x45059b){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x45059b);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x45059b);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0xe6f51),await scroll(_0x4a7c6a,FOLLOWER_FENSTER,_0xe6f51,_0x251e8b=>{_0x264924=Math['round'](++_0x54abd2/_0x5ada95*0x64),_0x2d10f6['sender']['send']('fetch-progress',_0x264924,!![]);}),await _0x4a7c6a['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x5417bb=await _0x4a7c6a['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x3fdaf1=await _0x4a7c6a['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x264924=Math['round'](++_0x54abd2/_0x5ada95*0x64),_0x2d10f6['sender']['send']('fetch-progress',_0x264924,!![]);_0x1395a3<=0x0&&(_0x1395a3=_0x5417bb['length']);let _0x16df73=[];for(let _0x59cfd3=0x0;_0x59cfd3<_0x5417bb['length']&&_0x59cfd3<_0x1395a3;_0x59cfd3++){_0x16df73['push'](await _0x5417bb[_0x59cfd3]['evaluate'](_0x44b605=>_0x44b605['textContent']));const _0x355acb='INSERT\x20INTO\x20'+_0x33c259+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x355acb,[await _0x5417bb[_0x59cfd3]['evaluate'](_0x557126=>_0x557126['textContent']),await _0x3fdaf1[_0x59cfd3]['evaluate'](_0x16fd89=>_0x16fd89['textContent'])],function(_0x20e403){_0x20e403?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x33c259+'\x27:',_0x20e403['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x264924=Math['round'](++_0x54abd2/_0x5ada95*0x64),_0x2d10f6['sender']['send']('fetch-progress',_0x264924,!![]),_0x11868f&&(_0x2d10f6['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x2d10f6,_0x4a7c6a,_0x2bf345,_0x33c259,_0x16df73)),new Promise(_0x2f1c20=>{_0x2f1c20('Scraping\x20finished!');});}catch(_0x309a50){if(_0x11868f)throw new Error(_0x309a50);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x571c83+'\x20nicht\x20gefunden:\x20'+_0x309a50);return handle_fail(0x0);}}async function fetch_details_from_list(_0x1c61ff,_0xd0175e,_0x4a42ad,_0xcb6f9e,_0x3e5071){let _0x342d85=0x0,_0x229116=0x0;for(let _0x48ded2=0x0;_0x48ded2<_0x3e5071['length'];_0x48ded2++){console['log']('Processing\x20profile:',_0x3e5071[_0x48ded2]);try{await fetch_account_details(_0xd0175e,_0x3e5071[_0x48ded2],_0x4a42ad,_0xcb6f9e);}catch(_0x1aa769){console['error']('Detailed\x20Scraping\x20von:\x20',_0x3e5071[_0x48ded2],_0x1aa769);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x3e5071[_0x48ded2]+'\x20'+_0x1aa769);}_0x229116=Math['round'](++_0x342d85/_0x3e5071['length']*0x64),_0x1c61ff['sender']['send']('fetch-progress',_0x229116,!![],!![]);}}async function fetch_likers_from_post(_0x137b79,_0x3beb73,_0x35cec2,_0x11ef3f,_0x7f28e1,_0x5822e6,_0x4cda15){let _0x1ea7a9=0x4,_0x49779d=0x0,_0x3917c6=0x0;try{await setCookiesForUser(_0x3beb73,_0x5822e6['username']);}catch(_0x2542e2){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x2542e2);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x2542e2);return handle_fail(0x1);return;}_0x3917c6=Math['round'](++_0x49779d/_0x1ea7a9*0x64),_0x137b79['sender']['send']('fetch-progress',_0x3917c6,!![]);try{let _0x728aa2=_0x35cec2['substring'](0x0,_0x35cec2['lastIndexOf']('/')),_0x2288f1=_0x728aa2+'/liked_by';console['log'](_0x2288f1),await _0x3beb73['goto'](_0x2288f1),await delay(0x7d0,0xfa0),await notificationClear(_0x3beb73),await delay(0xc8,0x1f4),_0x3917c6=Math['round'](++_0x49779d/_0x1ea7a9*0x64),_0x137b79['sender']['send']('fetch-progress',_0x3917c6,!![]),await _0x3beb73['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x4c2292=await _0x3beb73['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x2a97d0=await _0x3beb73['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x4c2292['length']);let _0xf089e4=path['join'](__dirname,'/likers.csv');_0x3917c6=Math['round'](++_0x49779d/_0x1ea7a9*0x64),_0x137b79['sender']['send']('fetch-progress',_0x3917c6,!![]);_0x11ef3f<=0x0&&(_0x11ef3f=_0x4c2292['length']);try{let _0x211269=[];for(let _0x200632=0x0;_0x200632<_0x4c2292['length']&&_0x200632<_0x11ef3f;_0x200632++){_0x211269['push'](await _0x4c2292[_0x200632]['evaluate'](_0x30f2e1=>_0x30f2e1['textContent']));try{const _0x24d0d1='INSERT\x20INTO\x20'+_0x7f28e1+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x24d0d1,[await _0x4c2292[_0x200632]['evaluate'](_0x593397=>_0x593397['textContent']),await _0x2a97d0[_0x200632]['evaluate'](_0x22effd=>_0x22effd['textContent'])],function(_0x299050){_0x299050?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x7f28e1+'\x27:',_0x299050['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x4a2729){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x200632+'\x20:\x20'+_0x4a2729);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x200632+'\x20:\x20'+_0x4a2729);return handle_fail(0x1);}}return _0x3917c6=Math['round'](++_0x49779d/_0x1ea7a9*0x64),_0x137b79['sender']['send']('fetch-progress',_0x3917c6,!![]),_0x4cda15&&(_0x137b79['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x137b79,_0x3beb73,_0x5822e6,_0x7f28e1,_0x211269)),new Promise(_0x6ebbe5=>{_0x6ebbe5('Scraping\x20finished!');});}catch(_0x1a9240){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x1a9240);return handle_fail(0x1);}}catch(_0x478a7d){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x478a7d);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x478a7d);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x10b973,_0x4d2d2c,_0x1f8064,_0x3ceeca,_0x43f1ed,_0x5d062f,_0x3b86b3){let _0x1bcc6b=0x3,_0x49c7da=0x0,_0x11026a=0x0;try{await setCookiesForUser(_0x4d2d2c,_0x5d062f['username']);}catch(_0xa80d79){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0xa80d79);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0xa80d79);return handle_fail(0x2);}try{console['log'](_0x1f8064),await _0x4d2d2c['goto'](_0x1f8064),await delay(0x7d0,0xfa0),await notificationClear(_0x4d2d2c),await delay(0xc8,0x1f4);const _0x11a794=COM_COMMENTS_BOX_BODY_DIV;let _0x1ed36d;const _0x41d26b=await _0x4d2d2c['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x1b7423=await _0x4d2d2c['evaluate'](_0x1016ff=>_0x1016ff['innerHTML'],_0x41d26b),_0x876181=String(_0x1b7423)['replace'](/[^0-9]/g,''),_0x40a84c=Number(_0x876181)/0x14;_0x3ceeca<=0x0?_0x1ed36d=Math['ceil'](_0x40a84c/0x3):_0x1ed36d=Math['ceil'](_0x3ceeca/0x3);_0x1bcc6b+=_0x1ed36d,_0x11026a=Math['round'](++_0x49c7da/_0x1bcc6b*0x64),_0x10b973['sender']['send']('fetch-progress',_0x11026a,!![]),console['log']('Auto-scrolls:\x20'+_0x1ed36d),await scroll(_0x4d2d2c,_0x11a794,_0x1ed36d,_0x500d6d=>{_0x11026a=Math['round'](++_0x49c7da/_0x1bcc6b*0x64),_0x10b973['sender']['send']('fetch-progress',_0x11026a,!![]);});try{const _0x256f50=COM_REPLY_BUTTON_SPAN;await _0x4d2d2c['waitForSelector'](_0x256f50),await delay(0x1f4,0x320);const _0x285a3d=await _0x4d2d2c['$$'](_0x256f50);console['log'](_0x285a3d);let _0x57d23f=_0x285a3d['length'];await delay(0xc8,0x1f4);try{for(let _0x2514fc=0x0;_0x2514fc<_0x57d23f;_0x2514fc++){_0x285a3d[_0x2514fc]['click'](),await delay(0x320,0x5dc);}}catch(_0x4b5ffc){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x4b5ffc);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x4b5ffc);return handle_fail(0x2);}}catch(_0x4c91a0){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x2f0751=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x4d2d2c['waitForSelector'](_0x2f0751),await delay(0x1f4,0x320),_0x11026a=Math['round'](++_0x49c7da/_0x1bcc6b*0x64),_0x10b973['sender']['send']('fetch-progress',_0x11026a,!![]);const _0x845773=await _0x4d2d2c['$$'](_0x2f0751);let _0x595983=path['join'](__dirname,'/comments.csv');_0x3ceeca<=0x0&&(_0x3ceeca=_0x845773['length']);console['log']('fetch_limit:\x20'+_0x3ceeca),console['log']('comments_len:\x20'+_0x845773['length']),_0x3ceeca++;try{let _0x228fb5=[];for(let _0x3d382c=0x1;_0x3d382c<_0x845773['length']&&_0x3d382c<_0x3ceeca;_0x3d382c++){try{_0x228fb5['push'](await _0x845773[_0x3d382c]['evaluate'](_0x54003b=>_0x54003b['textContent']));const _0x2323c9=await db['prepare']('INSERT\x20INTO\x20'+_0x43f1ed+'\x20(username)\x20VALUES\x20(?)');await _0x2323c9['run'](await _0x845773[_0x3d382c]['evaluate'](_0x22453b=>_0x22453b['textContent']),function(_0x5aac38){_0x5aac38&&console['log']('error\x20in\x20add-user:'+_0x5aac38);}),await _0x2323c9['finalize']();}catch(_0x597389){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x3d382c+'\x20:\x20'+_0x597389);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x3d382c+'\x20:\x20'+_0x597389);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x11026a=Math['round'](++_0x49c7da/_0x1bcc6b*0x64),_0x10b973['sender']['send']('fetch-progress',_0x11026a,!![]),_0x10b973['sender']['send']('fetch-progress',0x64,!![]),_0x3b86b3&&(_0x10b973['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x10b973,_0x4d2d2c,_0x5d062f,_0x43f1ed,_0x228fb5)),_0x10b973['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x210a89=>{_0x210a89('Scraping\x20finished!');});}catch(_0x59e5bb){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x59e5bb);return handle_fail(0x2);}}catch(_0x556a3d){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x556a3d);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x556a3d);return handle_fail(0x2);}}async function set_clearname_from_username(_0x299c52,_0x2fc803,_0x4b8895=null){try{let _0x5c74ea,_0x4d6797;const _0x2701d2='SELECT\x20username\x20FROM\x20'+_0x2fc803+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x2701d2,[],(_0x59dca1,_0x4af559)=>{_0x59dca1&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x59dca1['message']),_0x4af559['length']===0x0&&(_0x4d6797=_0x4af559['length']),_0x5c74ea=_0x4af559['map'](_0x45d096=>_0x45d096['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x4d6797);if(_0x4d6797===0x0){console['log']('Leave');return;}const _0x5c30cb=await _0x299c52['waitForSelector'](IG_SEARCH_BUTTON);await _0x5c30cb['click'](),await delay(0x4b0,0x7d0);for(let _0x15534a of _0x5c74ea){const _0x2737ea=await _0x299c52['waitForSelector'](IG_SEARCH_INPUT);await _0x2737ea['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x299c52['type'](IG_SEARCH_INPUT,_0x15534a,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x17f096=0x1;while(_0x17f096!=0x14){console['log']('Schleife');try{let _0x24cb41=IG_NAME_SPAN_PART1+_0x17f096+IG_USERNAME_SPAN_PART2;const _0x1f92c7=await _0x299c52['waitForSelector'](_0x24cb41),_0x27284b=await _0x299c52['evaluate'](_0x1df515=>_0x1df515['innerHTML'],_0x1f92c7);await delay(0xc8,0x1f4);if(_0x27284b==_0x15534a){let _0x5f5ec1=IG_NAME_SPAN_PART1+_0x17f096+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x28112c=await _0x299c52['waitForSelector'](_0x5f5ec1);let _0x4b6c9e=await _0x299c52['evaluate'](_0x31f3a5=>_0x31f3a5['innerHTML'],_0x28112c);const _0x3b904f=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x5d1056=_0x4b6c9e['match'](_0x3b904f);_0x5d1056?_0x4b6c9e=_0x5d1056[0x1]['trim']():_0x4b6c9e=_0x4b6c9e['trim']();_0x4b6c9e['includes']('•')&&(_0x4b6c9e=_0x4b6c9e['substring'](0x0,_0x4b6c9e['indexOf']('•')-0x1));const _0x4f9036='UPDATE\x20'+_0x2fc803+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x4f9036,[_0x4b6c9e,_0x27284b],function(_0xf15238){_0xf15238&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0xf15238['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x17f096++;}catch(_0x1ebf50){const _0x12d957='UPDATE\x20'+_0x2fc803+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x12d957,['',_0x15534a],function(_0x167de3){_0x167de3&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x167de3['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x1ebf50);break;}}_0x4b8895&&_0x4b8895();}await _0x5c30cb['click']();}catch(_0x5010aa){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x5010aa);}}const campaignPath=path['resolve'](__dirname,'data/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(campaign_name\x20TEXT\x20PRIMARY\x20KEY,\x20list_id\x20TEXT,\x20zeitabstand\x20REAL,\x20message_id\x20TEXT,\x20account\x20TEXT,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x338305,_0x1cb577)=>{const _0x333253='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x333253,[],(_0x2abbaf,_0x5825a8)=>{_0x2abbaf?_0x1cb577(_0x2abbaf):_0x338305(_0x5825a8);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x4b8d7e,_0x39345e)=>{const _0x266356='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x266356,[],async(_0x5590cf,_0x2ac264)=>{if(_0x5590cf)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x5590cf['message']),_0x39345e({'status':'error','message':_0x5590cf['message']});else try{const _0x185ba8=await Promise['all'](_0x2ac264['map'](_0x18a6f6=>{return new Promise(_0x5c6fb3=>{if(!_0x18a6f6['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x18a6f6['campaign_name']),_0x5c6fb3({'campaign_name':_0x18a6f6['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x22df58='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x18a6f6['list_id'],_0x429035='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x18a6f6['list_id']+'\x22';db['get'](_0x22df58,[],(_0x466065,_0x1f7848)=>{_0x466065?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x18a6f6['campaign_name']+':',_0x466065['message']),_0x5c6fb3({'campaign_name':_0x18a6f6['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x429035,[],(_0x1c6f72,_0x3d5f3b)=>{_0x1c6f72?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x18a6f6['campaign_name']+':',_0x1c6f72['message']),_0x5c6fb3({'campaign_name':_0x18a6f6['campaign_name'],'lead_count':_0x1f7848?_0x1f7848['lead_count']:0x0,'contacted_count':'N/A'})):_0x5c6fb3({'campaign_name':_0x18a6f6['campaign_name'],'lead_count':_0x1f7848?_0x1f7848['lead_count']:0x0,'contacted_count':_0x3d5f3b?_0x3d5f3b['contacted_count']:0x0});});});});}));_0x4b8d7e({'status':'success','campaigns':_0x185ba8});}catch(_0x5ebae9){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x5ebae9),_0x39345e({'status':'error','message':_0x5ebae9['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x4ef5eb,_0x29220b)=>{return new Promise((_0xc7920,_0x3227ca)=>{const _0x55f644='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x55f644,[_0x29220b],(_0x7a033,_0x290d4a)=>{_0x7a033?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x7a033),_0x3227ca(_0x7a033)):(console['log']('ROWS'),console['log'](_0x290d4a),debugDatabaseContents(),_0xc7920(_0x290d4a));});});});const showTableContents=_0x3bdabb=>{return new Promise((_0x287198,_0x1512fc)=>{const _0x1c3181='SELECT\x20*\x20FROM\x20'+_0x3bdabb+';';campaignDB['all'](_0x1c3181,(_0x542ebd,_0x29b779)=>{_0x542ebd?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x3bdabb+':',_0x542ebd),_0x1512fc(_0x542ebd)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x3bdabb+':',_0x29b779),_0x287198({'status':'success','message':_0x29b779}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0xad1f6a){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0xad1f6a);}}ipcMain['handle']('create-campaign',async(_0x3064f6,_0x35029a)=>{return new Promise((_0x2df576,_0x38b70d)=>{const _0x3048ca='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x3048ca,[String(_0x35029a)],function(_0x540297){_0x540297?_0x38b70d(_0x540297):_0x2df576({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x236e6e,_0x56ad49)=>{return new Promise((_0x217819,_0x2a04b5)=>{const _0x267240='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x267240,[_0x56ad49],function(_0x56f34c){_0x56f34c?_0x2a04b5(_0x56f34c):_0x217819({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x3ff221,_0x441042,_0x14e6d3,_0x4e28cb,_0x3a6ee8,_0x27d414)=>{const _0xe5df30=await createMessageID(_0x3a6ee8);return new Promise((_0x21f7b7,_0x2d4867)=>{if(!_0x441042||!_0x14e6d3||!_0x4e28cb||!_0xe5df30||!_0x27d414)return _0x2d4867({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0xe5df30);const _0x1f0315='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x1f0315,[_0x14e6d3,_0x4e28cb,_0xe5df30,_0x27d414,_0x441042],function(_0x1a1c25){if(_0x1a1c25)_0x2d4867({'status':'error','message':_0x1a1c25['message']});else this['changes']===0x0?_0x2d4867({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x21f7b7({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x2b1ba6,_0x130719,_0x3e6b47,_0x1adb76,_0x48ec25)=>{return new Promise((_0x11b501,_0x1155dd)=>{const _0x58705e='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x58705e,[_0x130719,_0x3e6b47,_0x1adb76,_0x48ec25],function(_0x13efa1){return _0x13efa1?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x13efa1['message']),_0x1155dd('insert-dm-response',{'success':![],'message':_0x13efa1['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x11b501('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x5ce0e4=>{return new Promise((_0x5eb706,_0x1a50a3)=>{const _0x5d86d3='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x5d86d3,[_0x5ce0e4],(_0x55ff9c,_0x40603d)=>{if(_0x55ff9c)_0x1a50a3({'status':'error','message':_0x55ff9c['message']});else{if(_0x40603d)_0x5eb706(_0x40603d['message_id']);else{const _0x3bd101='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x3bd101,[_0x5ce0e4],function(_0x308fbf){_0x308fbf?_0x1a50a3({'status':'error','message':_0x308fbf['message']}):_0x5eb706(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x965ddb,_0x228ceb)=>{return new Promise((_0x4d0bf4,_0x3c4ff0)=>{const _0x3d7d09='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x228ceb;db['get'](_0x3d7d09,(_0x504f60,_0x3e208a)=>{_0x504f60?_0x3c4ff0({'status':'error','message':_0x504f60['message']}):_0x4d0bf4({'status':'success','count':_0x3e208a['count']});});});});const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x51d168,_0x34d7fa){try{const _0x3b3aaa=await new Promise((_0x19dcf9,_0x46a549)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x34d7fa],(_0xaa22aa,_0x42fd8d)=>{if(_0xaa22aa)_0x46a549(_0xaa22aa);else{if(_0x42fd8d['length']>0x0){let _0x1be550=JSON['parse'](_0x42fd8d[0x0]['cookie']);console['log'](_0x1be550),_0x19dcf9(_0x1be550);}else _0x46a549(new Error('User\x20with\x20username\x20'+_0x34d7fa+'\x20does\x20not\x20exist.'));}});});await _0x51d168['setCookie'](..._0x3b3aaa),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x1fc960){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x1fc960);}}async function saveCookiesForUser(_0x468e0d,_0x3ab394){try{const _0x536e93=await _0x468e0d['cookies']();if(!_0x536e93||_0x536e93['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x3ab394);const _0x1ce569=JSON['stringify'](_0x536e93);if(_0x1ce569['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x3ab394);return new Promise((_0x534b55,_0x37e851)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x3ab394],(_0x2b2b53,_0x220855)=>{if(_0x2b2b53)return console['error']('Error\x20checking\x20user\x20existence:',_0x2b2b53),_0x37e851(_0x2b2b53);if(_0x220855){const _0xebe4a8=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0xebe4a8['run'](_0x1ce569,_0x3ab394,function(_0x1979b5){return _0x1979b5?(console['error']('Error\x20updating\x20cookies:',_0x1979b5),_0x37e851(_0x1979b5)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x3ab394),_0x534b55());});}else{const _0x5fc7f6=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x5fc7f6['run'](_0x3ab394,_0x1ce569,function(_0x136014){return _0x136014?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x136014),_0x37e851(_0x136014)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x3ab394),_0x534b55());});}});});}catch(_0x4a84e2){console['error']('Error\x20fetching\x20cookies:',_0x4a84e2);throw _0x4a84e2;}}async function createUserIfNotExists(_0x29ca03){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x29ca03],(_0x202974,_0x5c83f9)=>{if(_0x202974){console['error']('Error\x20checking\x20user\x20existence:',_0x202974);throw _0x202974;}else{if(!_0x5c83f9){const _0x558c34=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x558c34['run'](_0x29ca03,function(_0x40b9a4){_0x40b9a4?console['error']('Error\x20inserting\x20new\x20user:',_0x40b9a4):console['log']('New\x20user\x20created:',_0x29ca03);});}else console['log']('User\x20already\x20exists:',_0x29ca03);}});}catch(_0x18963b){console['error']('Error\x20creating\x20user:',_0x18963b);throw _0x18963b;}}ipcMain['handle']('create-relation',async(_0x2b5824,_0xdfc3ec)=>{return new Promise((_0x545e32,_0x58b4fd)=>{const _0x569f6b='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0xdfc3ec+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x569f6b,function(_0x466208){_0x466208?_0x58b4fd(_0x466208):_0x545e32({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0xdcb4b5,_0x1b27d3)=>{return console['log']('droping\x20table'+_0x1b27d3),new Promise((_0x4addbc,_0x2be933)=>{const _0x20731c='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x1b27d3;console['log']('droping\x20table'+_0x1b27d3),db['run'](_0x20731c,function(_0x885275){_0x885275?_0x2be933(_0x885275):_0x4addbc({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x281fbf=>{return new Promise((_0x3b8e6c,_0x1beb2b)=>{const _0x47f443='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x47f443,[],(_0xf07aca,_0x2845c6)=>{_0xf07aca?_0x1beb2b(_0xf07aca):_0x3b8e6c(_0x2845c6['map'](_0x47954e=>_0x47954e['name']));});});}),ipcMain['handle']('add-user',async(_0x58e41a,_0x11f462,_0xf8afd8)=>{return new Promise(_0x3399cc=>{const _0x2b15d4=db['prepare']('INSERT\x20INTO\x20'+_0xf8afd8+'\x20(username)\x20VALUES\x20(?)');_0x2b15d4['run'](_0x11f462,function(_0x5cae0c){_0x5cae0c?console['log']('error\x20in\x20add-user:'+_0x5cae0c):_0x3399cc({'status':'success','id':this['lastID']});}),_0x2b15d4['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x4a31a8,_0x3df2ad)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x173174,_0x3c7c57)=>{if(_0x173174)_0x3df2ad(_0x173174);else{_0x4a31a8({'status':'success','users':_0x3c7c57});for(_0x3c7c57 of _0x3c7c57){console['log'](_0x3c7c57['username']);}}});});}),ipcMain['handle']('get-data',async(_0x28b28d,_0xaedef3)=>{return new Promise((_0x4b82d9,_0x207244)=>{const _0x3dbb4f='SELECT\x20*\x20FROM\x20'+_0xaedef3;console['log'](_0x3dbb4f),db['all'](_0x3dbb4f,[],(_0x49067b,_0x255fc8)=>{_0x49067b?_0x207244(_0x49067b):_0x4b82d9(_0x255fc8);});});}),ipcMain['handle']('get-accounts',async _0x28a162=>{return new Promise((_0x40a619,_0x24fd3e)=>{const _0x1206bf='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x1206bf),igaccountsDB['all'](_0x1206bf,[],(_0x1f55fe,_0x2c55e0)=>{_0x1f55fe?_0x24fd3e(_0x1f55fe):_0x40a619(_0x2c55e0);});});}),ipcMain['handle']('get-targets',async(_0x2a41d4,_0x5571f5)=>{return getTargetProfiles(_0x5571f5);}),ipcMain['handle']('delete-user',async(_0x138d3a,_0x143011,_0x136486)=>{return new Promise((_0x5152a1,_0x3d7355)=>{const _0x1351f3=db['prepare']('DELETE\x20FROM\x20'+_0x136486+'\x20WHERE\x20username\x20=\x20?');_0x1351f3['run'](_0x143011,function(_0x37362a){_0x37362a?_0x3d7355(_0x37362a):_0x5152a1({'status':'success','changes':this['changes']});}),_0x1351f3['finalize']();});}),ipcMain['handle']('delete-account',async(_0x1d2c7b,_0x4e7209)=>{const _0x354811=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x354811['run'](_0x4e7209,function(_0x79dd5f){_0x79dd5f&&console['log'](_0x79dd5f);}),_0x354811['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x283f2b,_0xfdbc9)=>{const _0x729f26='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x729f26,[],(_0x586da7,_0x194918)=>{_0x586da7?_0xfdbc9({'status':'error','message':_0x586da7['message']}):_0x283f2b({'status':'success','contactedCount':_0x194918['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x29a231,_0x4b29ba)=>{const _0x4fd7cb='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x4fd7cb,[],(_0x12ee12,_0x923cca)=>{_0x12ee12?_0x4b29ba({'status':'error','message':_0x12ee12['message']}):_0x29a231({'status':'success','contactedCount':_0x923cca['contactedCount']});});});});function exportDatabase(_0x4b87b8){return new Promise((_0x53a496,_0x5958c1)=>{const _0x5ed90e='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x4b87b8+'\x0a\x20\x20\x20\x20';db['all'](_0x5ed90e,[],async(_0x2779fa,_0x4fa1a4)=>{if(_0x2779fa){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x2779fa['message']),_0x5958c1(_0x2779fa);return;}if(!_0x4fa1a4||_0x4fa1a4['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x53a496();return;}const _0x30429a=XLSX['utils']['json_to_sheet'](_0x4fa1a4),_0x23d8ef=XLSX['utils']['sheet_to_csv'](_0x30429a);try{const {canceled:_0x4db8f3,filePath:_0x2a1221}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x4b87b8+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x4db8f3||!_0x2a1221){console['log']('Speichern\x20abgebrochen.'),_0x53a496();return;}fs['writeFile'](_0x2a1221,_0x23d8ef,'utf8',_0x3b6fd2=>{_0x3b6fd2?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x3b6fd2['message']),_0x5958c1(_0x3b6fd2)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x2a1221),_0x53a496());});}catch(_0x3208ea){console['error']('Fehler\x20im\x20Speicherdialog:',_0x3208ea),_0x5958c1(_0x3208ea);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x25e31e,_0x5bc58b)=>{const _0x2a5ece=await getBrowserPageLogin();await _0x2a5ece['goto'](_0x5bc58b),console['log']('Stripe\x20startet');});