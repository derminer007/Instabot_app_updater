const {app,BrowserWindow,ipcMain,dialog}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),ANZAHL_FOLLOWER_BUTTON='div.x9f619.x1n2onr6\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',LIKERS_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_NEW_MSG_BUTTON='div.x1i10hfl.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.x6s0dn4.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x1ypdohk.x78zum5.xl56j7k.x1y1aw1k.x1sxyh0.xwib8y2.xurb0ha.xcdnw81',K_SEARCH_BAR_INPUT='body\x20>\x20div.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x1k90msu.x6o7n8i.x1qfuztq.x10l6tqk.x17qophe.x13vifvy.x1hc1fzr.x71s49j.xh8yej3\x20>\x20div\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.x1q0g3np.x1a02dak.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20input',K_USERNAME_SPALTE_PART1='body\x20>\x20div.xhu9ww4.xidawru.x13ywhbb.x1dbek64.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x1k90msu.x6o7n8i.x1qfuztq.x17qophe.x10l6tqk.x13vifvy.x1hc1fzr.x71s49j.xh8yej3\x20>\x20div\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x6ikm8r.x1rife3k.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div:nth-child(',K_USERNAME_SPALTE_PART2=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1pi30zi.x1swvt13.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',K_CHAT_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.x972fbf.xcfux6l.x1qhh985.xm0m39n.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.xexx8yu.x18d9i69.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1lq5wgf.xgqcy7u.x30kzoy.x9jhf4c.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x9bdzbf.x1ypdohk.x78zum5.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x1n2onr6.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xn3w4p2.x5ib6vp.xc73u3c.x1tu34mt.xzloghq',K_NACHRICHT_SCHREIBEN_INPUT_DIV='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1i64zmx.xw3qccf.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f.notranslate',K_SENDEN_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.xfs2ol5[role=\x22button\x22][tabindex=\x220\x22]';function createWindow(){const _0x4e55c4=new BrowserWindow({'width':0x320,'height':0x258,'webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x4e55c4['loadFile'](path['join'](__dirname,'index.html'));}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x581dad){var _0x3b82b7=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x3b887e){console['log']('window\x20id:'+_0x3b887e['id']),_0x3b887e['id']>0x1&&(_0x3b82b7=!![]);}),console['log']('child\x20opened\x20='+_0x3b82b7);if(!_0x3b82b7){const _0x275e65=new BrowserWindow({'width':0x320,'height':0x258,'webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x275e65['loadFile'](_0x581dad['url']);}else console['log']('child\x20window\x20opened\x20already');}let browser=null,page=null,isStopping=![];async function getBrowserPage(){let _0x379045='';if(process['platform']==='darwin')_0x379045='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome';else{if(process['platform']==='win32')_0x379045='chromium_local/chrome-win/chrome.exe';else{if(process['platform']==='linux'){}}}return(browser===null||page['isClosed']())&&(browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0x379045})),(page===null||page['isClosed']())&&(page=await browser['newPage'](),page['setDefaultNavigationTimeout'](0x1d4c),page['setDefaultTimeout'](0x1d4c)),page;}ipcMain['on']('login',async(_0x2f50bd,_0x11c3dd,_0x5d0fcc)=>{const _0x2d9419=await getBrowserPage();await _0x2d9419['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x2d9419,_0x11c3dd,_0x5d0fcc),setTimeout(async()=>{await browser['close']();},0x1388);}),ipcMain['handle']('sendMessage',async(_0x146e42,_0x2089f3,_0x18ee03,_0x4d3d18,_0x4d953c)=>{isStopping=![];const _0x4c9f77=await getBrowserPage();return console['log']('send\x20Message\x20gestartet'),console['log'](_0x2089f3),new Promise((_0x572d79,_0x21119e)=>{send_message(_0x4c9f77,_0x2089f3,_0x18ee03,_0x4d3d18,_0x4d953c)['then'](_0x42b221=>_0x572d79(_0x42b221))['catch'](_0x292be7=>_0x21119e(_0x292be7));});}),ipcMain['handle']('stop-action',async _0x298f47=>{isStopping=!![];const _0x3439ba=await getBrowserPage();await _0x3439ba['close']();}),ipcMain['handle']('fetch_followers',async(_0x335776,_0x9013e8,_0x1ab09a,_0x3a2ad1,_0x5b9c07)=>{isStopping=![];const _0x41893f=await getBrowserPage();return fetch_followers_from_account(_0x41893f,_0x9013e8,_0x1ab09a,_0x3a2ad1,_0x5b9c07);}),ipcMain['handle']('fetch_likes',async(_0x374cc6,_0x1b98f2,_0x3b48b1,_0x13be1f,_0x1e1d8f)=>{isStopping=![];const _0x164ab8=await getBrowserPage();return fetch_likers_from_post(_0x164ab8,_0x1b98f2,_0x3b48b1,_0x13be1f,_0x1e1d8f);}),ipcMain['handle']('fetch_comments',async(_0x161f68,_0x11e008,_0x101394,_0x2fed21,_0x2289ad)=>{isStopping=![];const _0x548d43=await getBrowserPage();return fetch_comments_from_post(_0x548d43,_0x11e008,_0x101394,_0x2fed21,_0x2289ad);}),ipcMain['handle']('update-app',async _0x3d8d74=>{const {spawn:_0x9b5cfa}=require('child_process'),_0x4c70a8=require('path');if(process['platform']==='darwin'){const _0x3ad89e=_0x4c70a8['join'](__dirname,'mac-updater-intern.sh'),_0x1ab0d4=_0x9b5cfa('/bin/bash',[_0x3ad89e]);_0x1ab0d4['stdout']['on']('data',_0x4617be=>{console['log']('stdout:\x20'+_0x4617be);}),_0x1ab0d4['stderr']['on']('data',_0x356107=>{console['error']('stderr:\x20'+_0x356107);}),_0x1ab0d4['on']('close',_0x4a6cd7=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x4a6cd7);});}else{if(process['platform']==='win32'){const _0x41a4d0=_0x4c70a8['join'](__dirname,'../','../','../');process['chdir'](_0x41a4d0),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x386fc4='soft-ui-updater-windows.ps1',_0x1061b6='soft-ui-updater-windows.exe',_0x171539=_0x9b5cfa('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x386fc4]);console['log']('Windows\x20Pfad:\x20'+_0x41a4d0),_0x171539['stdout']['on']('data',_0x3811f3=>{console['log']('stdout:\x20'+_0x3811f3);}),_0x171539['stderr']['on']('data',_0x411d08=>{console['error']('stderr:\x20'+_0x411d08);}),_0x171539['on']('close',_0x2e3ea1=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x2e3ea1);});}}});function getRnd(_0x5a70f1,_0xe14ed6){return Math['random']()*(_0xe14ed6-_0x5a70f1+0x1)+_0x5a70f1;}function delay(_0x5719a,_0x592f67){let _0x11b79d=getRnd(_0x5719a,_0x592f67);return new Promise(function(_0x1a37fd){setTimeout(_0x1a37fd,_0x11b79d);});}async function scroll(_0x118ca6,_0xc7e56a,_0xb783d6=0x2){const _0x30b53c=await _0x118ca6['waitForSelector'](_0xc7e56a);for(let _0xdc90bd=0x0;_0xdc90bd<_0xb783d6;_0xdc90bd++){console['log']('Scrolling\x20'+_0xdc90bd),await _0x118ca6['evaluate'](_0x2afdff=>{const _0x3208aa=document['querySelector'](_0x2afdff);_0x3208aa&&_0x3208aa['scrollBy'](0x0,0x190);},_0xc7e56a),await delay(0x320,0x5dc);}}async function saveCookies(_0x52a3a9){let _0x2e1971=await _0x52a3a9['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x2e1971,null,0x2));}async function notificationClear(_0x5ed4d3){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x5ed4d3['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x5ed4d3['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x235d73){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x235d73);}}async function getTargetProfiles(_0x3c4d61){return new Promise((_0x234862,_0x5baad8)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x3c4d61,(_0x28b1ac,_0x47aabe)=>{_0x28b1ac?_0x5baad8(_0x28b1ac):_0x234862(_0x47aabe);});});}async function login(_0x4ad2b4,_0x380340,_0x5f4a47){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x4ad2b4,_0x380340),await createUserIfNotExists(_0x380340,_0x5f4a47);}catch(_0x41ee09){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x41ee09);}try{await _0x4ad2b4['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x4ad2b4['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x4ad2b4['click']('button._a9--._ap36._a9_0');}catch(_0x3c4831){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x4ad2b4['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x4ad2b4['type']('input[name=\x27username\x27]',_0x380340,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x4ad2b4['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x4ad2b4['type']('input[name=\x27password\x27]',_0x5f4a47,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x4ad2b4['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x4ad2b4['click']('button[type=\x27submit\x27]');}catch(_0x55b0da){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x4ad2b4),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x4ad2b4,_0x380340);}catch(_0x35449c){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x35449c);}}catch(_0x45f507){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x45f507);}}async function send_message(_0x350682,_0x539354,_0x36bab3,_0x33c5bc,_0x4e8dd5){console['log'](_0x4e8dd5),console['log']('Anfang'),console['log']('Counter:\x20'+_0x33c5bc);if(_0x33c5bc==0x0){try{console['log'](_0x4e8dd5),await login(_0x350682,_0x4e8dd5['username'],_0x4e8dd5['password']);}catch(_0x1661a4){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x1661a4);return;}await _0x350682['goto']('https://www.instagram.com/direct/inbox/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x350682);}try{try{const _0x1b5b9e=K_NEW_MSG_BUTTON;await delay(0xfa0,0x1d4c),await _0x350682['waitForSelector'](_0x1b5b9e),await _0x350682['click'](_0x1b5b9e),console['log']('Message-Button\x20geklickt'),console['log'](_0x539354+'\x20'+_0x36bab3),await delay(0xfa0,0x1d4c);try{const _0x415dba='input[name=\x22queryBox\x22]',_0xc7d3c=K_SEARCH_BAR_INPUT;await _0x350682['waitForSelector'](_0xc7d3c),await _0x350682['click'](_0xc7d3c),await delay(0xfa0,0x1d4c),await _0x350682['waitForSelector'](_0x415dba),await _0x350682['click'](_0x415dba),await delay(0xfa0,0x1d4c),await _0x350682['type'](_0x415dba,_0x539354,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),console['log']('Account\x20Name\x20eingefügt');const _0x17d11a=K_USERNAME_SPALTE_PART1,_0x10a31f=K_USERNAME_SPALTE_PART2;let _0x37440b=0x1;try{while(_0x37440b!=0x14){console['log']('Schleife');let _0x3a3d27=_0x17d11a+_0x37440b+_0x10a31f;const _0x1a236c=await _0x350682['waitForSelector'](_0x3a3d27),_0x33f9a4=await _0x350682['evaluate'](_0x1e621c=>_0x1e621c['innerHTML'],_0x1a236c);console['log'](_0x33f9a4+'\x20'+_0x539354),delay(0x3e8,0xbb8);if(_0x33f9a4==_0x539354){console['log']('Account\x20gefunden'),await _0x350682['click'](_0x3a3d27);break;}_0x37440b++;}try{await delay(0xbb8,0x1388);const _0x366518=await _0x350682['waitForSelector'](K_CHAT_BUTTON_DIV);console['log'](_0x366518),await delay(0xbb8,0x1388),await _0x366518['click']();try{await delay(0xbb8,0x1388);const _0x563600=await _0x350682['waitForSelector'](K_NACHRICHT_SCHREIBEN_INPUT_DIV);await _0x563600['type'](_0x36bab3,{'delay':getRnd(0x50,0x78)}),await delay(0xbb8,0x1388);try{const _0x2be4b1=await _0x350682['waitForSelector'](K_SENDEN_BUTTON_DIV);return await _0x2be4b1['click'](),await delay(0xbb8,0x1388),new Promise(_0x162d75=>{_0x162d75('Nachricht\x20erfolgreich\x20verschickt!');});}catch(_0x55aa15){console['log']('Message-Button\x20nicht\x20geklickt:\x20'+_0x55aa15);}}catch(_0x16079e){console['log']('Chat-Fenster\x20nicht\x20gefunden:\x20'+_0x16079e);}}catch(_0x4639da){console['log']('error:\x20'+_0x4639da);}}catch(_0x2ebead){console['log']('User\x20nicht\x20gefunden:'+_0x2ebead);}}catch(_0x79220e){console['log']('DM-Fenster\x20nicht\x20gefunden:'+_0x79220e);}}catch(_0x5c1bb1){console['log']('Message-Button\x20nicht\x20geklickt:'+_0x5c1bb1);}}catch(_0x26c0b8){console['log']('Nachricht\x20senden\x20fehlgeschlagen:\x20'+_0x26c0b8);}return console['log']('Ende'),new Promise((_0x19ca17,_0x365bde)=>{_0x365bde('Fehler\x20beim\x20Anschreiben.\x20Lade\x20bitte\x20die\x20neuste\x20Version\x20herunter');});}function handle_fail(_0x3d1d4e){if(isStopping)return new Promise(_0x4a350e=>{_0x4a350e('Scraper\x20gestoppt.');});else{let _0xab2b72='';switch(_0x3d1d4e){case 0x0:_0xab2b72='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0xab2b72='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0xab2b72='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0xab2b72='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0xe7dc72,_0x2a1210)=>{_0x2a1210(_0xab2b72);});}}async function fetch_followers_from_account(_0x2e47aa,_0x41a089,_0x4cb04b,_0x1e1f16,_0x5752e6){try{await login(_0x2e47aa,_0x5752e6['username'],_0x5752e6['password']);}catch(_0x107d2a){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x107d2a),handle_fail(0x0);}let _0x1c5745=0x0;try{await _0x2e47aa['goto']('https://www.instagram.com/'+_0x41a089+'/'),await notificationClear(_0x2e47aa);try{if(_0x4cb04b<=0x0){const _0x143dbb=await _0x2e47aa['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x2423fa=await _0x2e47aa['evaluate'](_0x4d0931=>_0x4d0931['innerHTML'],_0x143dbb);_0x1c5745=Math['ceil'](_0x2423fa/0x4);}else _0x1c5745=Math['ceil'](_0x4cb04b/0x4);let _0x55d88d=await _0x2e47aa['waitForSelector'](FOLLOWER_BUTTON);await delay(0xbb8,0x1388),await _0x55d88d['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x41a089+'\x20gesichtet');}catch(_0x49679a){return console['log']('Follower\x20Liste\x20von\x20'+_0x41a089+'\x20nicht\x20gefunden:'+_0x49679a),handle_fail(0x0);}}catch(_0x169c8f){return console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x169c8f),handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x1c5745),await scroll(_0x2e47aa,FOLLOWER_FENSTER,_0x1c5745),await _0x2e47aa['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x449ad5=await _0x2e47aa['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY);_0x4cb04b<=0x0&&(_0x4cb04b=_0x449ad5['length']);for(let _0x32685e=0x0;_0x32685e<_0x449ad5['length']&&_0x32685e<_0x4cb04b;_0x32685e++){console['log'](await _0x449ad5[_0x32685e]['evaluate'](_0x6cbfcb=>_0x6cbfcb['textContent']));const _0x206851=await db['prepare']('INSERT\x20INTO\x20'+_0x1e1f16+'\x20(username)\x20VALUES\x20(?)');await _0x206851['run'](await _0x449ad5[_0x32685e]['evaluate'](_0x5a286d=>_0x5a286d['textContent']),function(_0x344db0){_0x344db0&&console['log']('error\x20in\x20add-user:'+_0x344db0);}),await _0x206851['finalize']();}return new Promise(_0x4ca728=>{_0x4ca728('Scraping\x20finished!');});}catch(_0x4e117a){return console['log']('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x41a089+'\x20nicht\x20gefunden:'+_0x4e117a),handle_fail(0x0);}}async function fetch_likers_from_post(_0x31d40c,_0x39c690,_0x40a271,_0x5613e7,_0x359fb){try{await login(_0x31d40c,_0x359fb['username'],_0x359fb['password']);}catch(_0x2f3561){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x2f3561);return handle_fail(0x1);return;}try{let _0x17e144=_0x39c690['substring'](0x0,_0x39c690['lastIndexOf']('/')),_0x4140ea=_0x17e144+'/liked_by';console['log'](_0x4140ea),await _0x31d40c['goto'](_0x4140ea),await delay(0x7d0,0xfa0),await notificationClear(_0x31d40c),await delay(0xc8,0x1f4);let _0x88356b=LIKERS_USERNAME_SPALTEN_ARRAY;await _0x31d40c['waitForSelector'](_0x88356b),await delay(0x1f4,0x320);const _0x19da82=await _0x31d40c['$$'](_0x88356b);await delay(0x1f4,0x320),console['log'](_0x19da82['length']);let _0x1c33ed=path['join'](__dirname,'/likers.csv');_0x40a271<=0x0&&(_0x40a271=_0x19da82['length']);try{for(let _0x1b319e=0x0;_0x1b319e<_0x19da82['length']&&_0x1b319e<_0x40a271;_0x1b319e++){console['log'](await _0x19da82[_0x1b319e]['evaluate'](_0x1b9c8c=>_0x1b9c8c['textContent']));try{const _0x3c227a=await db['prepare']('INSERT\x20INTO\x20'+_0x5613e7+'\x20(username)\x20VALUES\x20(?)');await _0x3c227a['run'](await _0x19da82[_0x1b319e]['evaluate'](_0x2b788f=>_0x2b788f['textContent']),function(_0x2ed7f1){_0x2ed7f1&&console['log']('error\x20in\x20add-user:'+_0x2ed7f1);}),await _0x3c227a['finalize']();}catch(_0x53a471){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x1b319e+'\x20:\x20'+_0x53a471),handle_fail(0x1);}}return new Promise(_0x1af052=>{_0x1af052('Scraping\x20finished!');});}catch(_0x410511){return console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben'),handle_fail(0x1);}}catch(_0x3605ee){return console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x3605ee),handle_fail(0x1);}}async function fetch_comments_from_post(_0xbdca77,_0xfc6a61,_0xca011c,_0x114b0b,_0x59182b){try{await login(_0xbdca77,_0x59182b['username'],_0x59182b['password']);}catch(_0x2c2159){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x2c2159),handle_fail(0x2);}try{console['log'](_0xfc6a61),await _0xbdca77['goto'](_0xfc6a61),await delay(0x7d0,0xfa0),await notificationClear(_0xbdca77),await delay(0xc8,0x1f4);const _0x517518=COM_COMMENTS_BOX_BODY_DIV;let _0x755042;if(_0xca011c<=0x0){const _0x28baf1=await _0xbdca77['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x442fb9=await _0xbdca77['evaluate'](_0x256783=>_0x256783['innerHTML'],_0x28baf1),_0x4b0f60=String(_0x442fb9)['replace'](/[^0-9]/g,''),_0x53b3c9=Number(_0x4b0f60)/0x14;_0x755042=Math['ceil'](_0x53b3c9/0x3);}else _0x755042=Math['ceil'](_0xca011c/0x3);console['log']('Auto-scrolls:\x20'+_0x755042),await scroll(_0xbdca77,_0x517518,_0x755042);try{const _0x189297=COM_REPLY_BUTTON_SPAN;await _0xbdca77['waitForSelector'](_0x189297),await delay(0x1f4,0x320);const _0xc0c3aa=await _0xbdca77['$$'](_0x189297);console['log'](_0xc0c3aa),await delay(0xc8,0x1f4);try{for(let _0x152030=0x0;_0x152030<_0xc0c3aa['length'];_0x152030++){_0xc0c3aa[_0x152030]['click'](),await delay(0x320,0x5dc);}}catch(_0x1dfc0e){return console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x1dfc0e),handle_fail(0x2);}}catch(_0x3478e2){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x5a3493=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0xbdca77['waitForSelector'](_0x5a3493),await delay(0x1f4,0x320);const _0x43f8d7=await _0xbdca77['$$'](_0x5a3493);let _0x5423cb=path['join'](__dirname,'/comments.csv');_0xca011c<=0x0&&(_0xca011c=_0x43f8d7['length']);console['log']('fetch_limit:\x20'+_0xca011c),console['log']('comments_len:\x20'+_0x43f8d7['length']),_0xca011c++;try{for(let _0x3dde7b=0x1;_0x3dde7b<_0x43f8d7['length']&&_0x3dde7b<_0xca011c;_0x3dde7b++){try{console['log'](await _0x43f8d7[_0x3dde7b]['evaluate'](_0xbda757=>_0xbda757['textContent']));const _0x4d70a2=await db['prepare']('INSERT\x20INTO\x20'+_0x114b0b+'\x20(username)\x20VALUES\x20(?)');await _0x4d70a2['run'](await _0x43f8d7[_0x3dde7b]['evaluate'](_0x55a513=>_0x55a513['textContent']),function(_0x10c762){_0x10c762&&console['log']('error\x20in\x20add-user:'+_0x10c762);}),await _0x4d70a2['finalize']();}catch(_0x19953b){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x3dde7b+'\x20:\x20'+_0x19953b),handle_fail(0x2);}}return new Promise(_0x30c4be=>{_0x30c4be('Scraping\x20finished!');});}catch(_0x2ae309){return console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben'),handle_fail(0x2);}}catch(_0x362a64){return console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x362a64),handle_fail(0x2);}}const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20password\x20TEXT,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x2ad83d,_0x5cb253){try{const _0x6044fb=await new Promise((_0x46b662,_0xca1029)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x5cb253],(_0x24d7ea,_0x4f2a30)=>{if(_0x24d7ea)_0xca1029(_0x24d7ea);else{if(_0x4f2a30['length']>0x0){let _0xd3e1d1=JSON['parse'](_0x4f2a30[0x0]['cookie']);console['log'](_0xd3e1d1),_0x46b662(_0xd3e1d1);}else _0xca1029(new Error('User\x20with\x20username\x20'+_0x5cb253+'\x20does\x20not\x20exist.'));}});});await _0x2ad83d['setCookie'](..._0x6044fb),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x242428){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x242428);}}async function saveCookiesForUser(_0x18b0d9,_0x39b23e){try{let _0x1ea16c=await _0x18b0d9['cookies']();_0x1ea16c=JSON['stringify'](_0x1ea16c),igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x39b23e],(_0x40e8ce,_0x248c62)=>{if(_0x40e8ce){console['error']('Error\x20checking\x20user\x20existence:',_0x40e8ce);throw _0x40e8ce;}else{if(_0x248c62){const _0x16fcf6=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x16fcf6['run'](_0x1ea16c,_0x39b23e,function(_0x2d25b4){_0x2d25b4?console['error']('Error\x20updating\x20cookies:',_0x2d25b4):console['log']('Cookies\x20updated\x20for\x20user:',_0x39b23e);});}else{const _0x4756fd=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x4756fd['run'](_0x39b23e,_0x1ea16c,function(_0x32adad){_0x32adad?console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x32adad):console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x39b23e);});}}});}catch(_0x2bf1da){console['error']('Error\x20fetching\x20cookies:',_0x2bf1da);throw _0x2bf1da;}}async function createUserIfNotExists(_0x1ff53a,_0x294544){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x1ff53a],(_0x2c13c5,_0x52d0a9)=>{if(_0x2c13c5){console['error']('Error\x20checking\x20user\x20existence:',_0x2c13c5);throw _0x2c13c5;}else{if(!_0x52d0a9){const _0x4bfaf3=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20password)\x20VALUES\x20(?,\x20?)');_0x4bfaf3['run'](_0x1ff53a,_0x294544,function(_0x109119){_0x109119?console['error']('Error\x20inserting\x20new\x20user:',_0x109119):console['log']('New\x20user\x20created:',_0x1ff53a);});}else console['log']('User\x20already\x20exists:',_0x1ff53a);}});}catch(_0x174488){console['error']('Error\x20creating\x20user:',_0x174488);throw _0x174488;}}ipcMain['handle']('create-relation',async(_0x12a61e,_0x230fc2)=>{return new Promise((_0x4ad482,_0x5ae2e5)=>{const _0x54c6aa='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x230fc2+'\x20(username\x20TEXT\x20PRIMARY\x20KEY)';db['run'](_0x54c6aa,function(_0x5222c7){_0x5222c7?_0x5ae2e5(_0x5222c7):_0x4ad482({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x2d194c,_0x359624)=>{return console['log']('droping\x20table'+_0x359624),new Promise((_0x226657,_0x410f8d)=>{const _0xb1dc78='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x359624;console['log']('droping\x20table'+_0x359624),db['run'](_0xb1dc78,function(_0x17ac0a){_0x17ac0a?_0x410f8d(_0x17ac0a):_0x226657({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x3b6b3a=>{return new Promise((_0x1a0e80,_0x5e9651)=>{const _0x11c1a7='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x11c1a7,[],(_0x35477d,_0x1a6062)=>{_0x35477d?_0x5e9651(_0x35477d):_0x1a0e80(_0x1a6062['map'](_0x5f0ce8=>_0x5f0ce8['name']));});});}),ipcMain['handle']('add-user',async(_0x51a51e,_0x30ac66,_0x31ce87)=>{return new Promise(_0x57166a=>{const _0x38e3c9=db['prepare']('INSERT\x20INTO\x20'+_0x31ce87+'\x20(username)\x20VALUES\x20(?)');_0x38e3c9['run'](_0x30ac66,function(_0x57ef3c){_0x57ef3c?console['log']('error\x20in\x20add-user:'+_0x57ef3c):_0x57166a({'status':'success','id':this['lastID']});}),_0x38e3c9['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x3ff5c2,_0x1a375c)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x427a32,_0x3a4db0)=>{if(_0x427a32)_0x1a375c(_0x427a32);else{_0x3ff5c2({'status':'success','users':_0x3a4db0});for(_0x3a4db0 of _0x3a4db0){console['log'](_0x3a4db0['username']);}}});});}),ipcMain['handle']('get-data',async(_0x9e6631,_0x469506)=>{return new Promise((_0x32700d,_0x2e5e32)=>{const _0x1dc1c6='SELECT\x20*\x20FROM\x20'+_0x469506;console['log'](_0x1dc1c6),db['all'](_0x1dc1c6,[],(_0x2f528a,_0x231a51)=>{_0x2f528a?_0x2e5e32(_0x2f528a):_0x32700d(_0x231a51);});});}),ipcMain['handle']('get-accounts',async _0x59ee46=>{return new Promise((_0x20c200,_0x28cc4b)=>{const _0x29f050='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x29f050),igaccountsDB['all'](_0x29f050,[],(_0x4a07db,_0x54dd7f)=>{_0x4a07db?_0x28cc4b(_0x4a07db):_0x20c200(_0x54dd7f);});});}),ipcMain['handle']('get-targets',async(_0x3a9643,_0x4675ec)=>{return getTargetProfiles(_0x4675ec);}),ipcMain['handle']('delete-user',async(_0x3086ee,_0x43becd,_0x486d07)=>{return new Promise((_0x159ec6,_0x2b43ec)=>{const _0x31465f=db['prepare']('DELETE\x20FROM\x20'+_0x486d07+'\x20WHERE\x20username\x20=\x20?');_0x31465f['run'](_0x43becd,function(_0x1d9067){_0x1d9067?_0x2b43ec(_0x1d9067):_0x159ec6({'status':'success','changes':this['changes']});}),_0x31465f['finalize']();});}),ipcMain['handle']('delete-account',async(_0x1ac9b7,_0x4f2ba6)=>{const _0x142268=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x142268['run'](_0x4f2ba6,function(_0x18554f){_0x18554f&&console['log'](_0x18554f);}),_0x142268['finalize']();});