const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');async function extractFirstName(_0x1ded41,_0x5a4f0d){try{const _0xf3ac06=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x5a4f0d},'body':JSON['stringify']({'clearname':_0x1ded41})});if(!_0xf3ac06['ok']){const _0x1dd583=await _0xf3ac06['text']();throw new Error(_0xf3ac06['status']+':\x20'+_0x1dd583);}const _0x1ef0e4=await _0xf3ac06['json']();return _0x1ef0e4;}catch(_0x9354c9){console['error']('Error\x20in\x20extractFirstName:',_0x9354c9);throw _0x9354c9;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div:has(>\x20div[style=\x22height:\x20auto;\x20overflow:\x20hidden\x20auto;\x22])',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='[style=\x22line-height:\x2018px;\x22]',COM_COMMENTS_BOX_BODY_DIV='div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='//span[contains(.,\x20\x27View\x20all\x27)\x20and\x20contains(.,\x20\x27replies\x27)]',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Message\x27]','div.x9f619.xjbqb8w.x78zum5.x15mokao.x1ga7v0g.x16uus16.xbiv7yw.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div','div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div'],K_OPTIONS_BUTTON=['[aria-label=\x22Options\x22]','section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.x1jfgfrl\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div'],K_EXPAND_MSG_BUTTON='[aria-label=\x22Expand\x22]',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD=['[aria-label=\x22Message\x22]','div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f'],K_SEND_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Send\x27]','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_ALREADY_CHATTED='[aria-label=\x22Like\x22]',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',K_BEITRAG_ARRAY_SELECTOR='._aagv',K_BEITRAG_LIKE_BUTTON='section\x20>\x20span\x20>\x20div\x20>\x20div',K_STORY_ARRAY_SELECTOR='._acaz',K_STORY_LIKE_BUTTON='div.x6s0dn4.x78zum5.x67bb7w\x20>\x20div.x78zum5.xvc5jky\x20>\x20span\x20>\x20div\x20>\x20div',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x5802cb=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x5802cb['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x5802cb['webContents']['openDevTools']();}app['whenReady']()['then'](async()=>{try{await initOptionsDb(),console['log']('[OptionsDB]\x20initialisiert:',path['join'](SqlDataDirectory,'options.db'));}catch(_0xd1937b){console['error']('[OptionsDB]\x20Initialisierung\x20fehlgeschlagen:',_0xd1937b);}})['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x4dc037){var _0x3b4f18=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x1f8e93){console['log']('window\x20id:'+_0x1f8e93['id']),_0x1f8e93['id']>0x1&&(_0x3b4f18=!![]);}),console['log']('child\x20opened\x20='+_0x3b4f18);if(!_0x3b4f18){const _0xf8d688=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0xf8d688['loadFile'](_0x4dc037['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));try{optionsDb&&(optionsDb['close'](),optionsDb=null,console['log']('[OptionsDB]\x20geschlossen.'));}catch(_0xab3f47){console['warn']('[OptionsDB]\x20Fehler\x20beim\x20Schließen:',_0xab3f47?.['message']||_0xab3f47);}if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x4ef641=require('fs'),_0x5df9d4=path['join'](app['getPath']('userData'),'data'),_0x41f38e=['campaign.db','crm.db','igaccounts.db'],_0x3ad13c=[];try{_0x4ef641['mkdirSync'](_0x5df9d4,{'recursive':!![]});for(const _0x1e32b2 of _0x41f38e){const _0x217281=path['join'](process['resourcesPath'],'app','build','data',_0x1e32b2),_0x5d0acc=path['join'](_0x5df9d4,_0x1e32b2);!_0x4ef641['existsSync'](_0x5d0acc)?(_0x4ef641['copyFileSync'](_0x217281,_0x5d0acc),console['log']('[InitDB]\x20Kopiert\x20'+_0x1e32b2+'\x20nach:\x20'+_0x5d0acc)):console['log']('[InitDB]\x20'+_0x1e32b2+'\x20existiert\x20bereits:\x20'+_0x5d0acc),_0x3ad13c['push'](_0x5d0acc);}}catch(_0x47826e){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x47826e);}return _0x3ad13c;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x4123bf,AppUpdate:_0x4e0542}=require('electron-updater');_0x4123bf['autoDownload']=![],_0x4123bf['autoInstallOnAppQuit']=!![],_0x4123bf['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x4123bf['on']('update-available',_0x7811b=>{console['log']('Update\x20verfügbar:',_0x7811b),_0x4123bf['downloadUpdate']();}),_0x4123bf['on']('update-downloaded',_0x3f23bb=>{console['log']('Update\x20heruntergeladen:',_0x3f23bb),_0x4123bf['quitAndInstall']();}),_0x4123bf['on']('error',_0x168977=>{console['error']('Fehler\x20beim\x20Updaten:',_0x168977);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x564df0,AppUpdate:_0x29de08}=require('electron-updater');_0x564df0['autoDownload']=![],_0x564df0['autoInstallOnAppQuit']=!![],_0x564df0['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x564df0['on']('update-available',_0x12659d=>{console['log']('Update\x20verfügbar:',_0x12659d),_0x564df0['downloadUpdate']();}),_0x564df0['on']('update-downloaded',_0x3176b2=>{console['log']('Update\x20heruntergeladen:',_0x3176b2),console['log']('Neustarten\x20zum\x20Updaten');}),_0x564df0['on']('error',_0x14f948=>{console['error']('Fehler\x20beim\x20Updaten:',_0x14f948);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let optionsDb,optionsDbPath;function ensureDirSync(_0x1e059d){try{fs_no_promise['mkdirSync'](_0x1e059d,{'recursive':!![]});}catch(_0x5b9b15){}}function initOptionsDb(){return new Promise((_0x38d15c,_0xdf15c2)=>{try{ensureDirSync(SqlDataDirectory),optionsDbPath=path['join'](SqlDataDirectory,'options.db'),optionsDb=new sqlite3['Database'](optionsDbPath,_0xd86a50=>{if(_0xd86a50)return _0xdf15c2(_0xd86a50);optionsDb['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20options\x20(key\x20TEXT\x20PRIMARY\x20KEY,\x20value\x20TEXT\x20NOT\x20NULL)',_0x4da201=>{if(_0x4da201)return _0xdf15c2(_0x4da201);optionsDb['run']('INSERT\x20OR\x20IGNORE\x20INTO\x20options\x20(key,\x20value)\x20VALUES\x20(?,\x20?)',['isHeadless','1'],_0x457809=>{if(_0x457809)return _0xdf15c2(_0x457809);_0x38d15c();});});});}catch(_0x4e5e64){_0xdf15c2(_0x4e5e64);}});}function setOption(_0x27888d,_0x4df681){return new Promise((_0x2e7b1a,_0x3d6215)=>{if(!optionsDb)return _0x3d6215(new Error('Options-DB\x20nicht\x20initialisiert'));optionsDb['run']('INSERT\x20INTO\x20options\x20(key,\x20value)\x20VALUES\x20(?,\x20?)\x20ON\x20CONFLICT(key)\x20DO\x20UPDATE\x20SET\x20value\x20=\x20excluded.value',[_0x27888d,String(_0x4df681)],_0x1a4da6=>{if(_0x1a4da6)return _0x3d6215(_0x1a4da6);_0x2e7b1a();});});}function getOption(_0x218e68){return new Promise((_0xe8bac6,_0x211424)=>{if(!optionsDb)return _0x211424(new Error('Options-DB\x20nicht\x20initialisiert'));optionsDb['get']('SELECT\x20value\x20FROM\x20options\x20WHERE\x20key\x20=\x20?',[_0x218e68],(_0x27dad6,_0x12112e)=>{if(_0x27dad6)return _0x211424(_0x27dad6);_0xe8bac6(_0x12112e?_0x12112e['value']:null);});});}async function getIsHeadless(){try{const _0x4898ce=await getOption('isHeadless');if(_0x4898ce===null||_0x4898ce===undefined)return!![];if(_0x4898ce==='1'||_0x4898ce==='true'||_0x4898ce===!![])return!![];if(_0x4898ce==='0'||_0x4898ce==='false'||_0x4898ce===![])return![];return console['log']('[OptionsDB]\x20getIsHeadless\x20unerwarteter\x20Wert:',_0x4898ce),Boolean(_0x4898ce);}catch(_0x1d4e0d){return console['warn']('[OptionsDB]\x20getIsHeadless\x20Fehler,\x20fallback=true:',_0x1d4e0d?.['message']||_0x1d4e0d),!![];}}let browser_login=null;async function getBrowserPageLogin(){let _0x3e94fc='',_0x17e9ca=null;if(process['platform']==='darwin')_0x3e94fc=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x3e94fc=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':await getIsHeadless(),'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x3e94fc}),_0x17e9ca=await browser_login['newPage'](),_0x17e9ca['setDefaultNavigationTimeout'](0x3a98),_0x17e9ca['setDefaultTimeout'](0x3a98),await _0x17e9ca['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x17e9ca;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x102be8=0x1,_0x4e4453=0x0){try{let _0x4e5c9='',_0x5d1235=null;const _0x15baaa=await getIsHeadless();if(process['platform']==='darwin')_0x4e5c9=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x4e5c9=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x102be8===0x0&&!pageStack[_0x4e4453])return browser=await puppeteer['launch']({'headless':_0x15baaa,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x4e5c9}),_0x5d1235=await browser['newPage'](),_0x5d1235['setDefaultNavigationTimeout'](0x3a98),_0x5d1235['setDefaultTimeout'](0x3a98),await _0x5d1235['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x4e4453]=_0x5d1235,_0x5d1235;return(browser===null||pageStack[_0x4e4453]===null||pageStack[_0x4e4453]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x15baaa,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x4e5c9})),(pageStack[_0x4e4453]===null||pageStack[_0x4e4453]['isClosed']())&&(_0x5d1235=await browser['newPage'](),_0x5d1235['setDefaultNavigationTimeout'](0x3a98),_0x5d1235['setDefaultTimeout'](0x3a98),await _0x5d1235['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x4e4453]=_0x5d1235),pageStack[_0x4e4453];}catch(_0x1a7e05){console['error']('Failed\x20to\x20launch\x20browser:',_0x1a7e05);const _0x144bb9=new Error('Browser\x20konnte\x20nicht\x20gestartet\x20werden.\x20Bitte\x20starte\x20die\x20App\x20neu.\x20:\x20'+_0x1a7e05);throw _0x144bb9;}}ipcMain['on']('login',async(_0x282dee,_0x2c5f1c)=>{const _0x1a3c18=await getBrowserPageLogin();await _0x1a3c18['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x1a3c18,_0x2c5f1c),ipcMain['on']('setLoginCookies',async(_0x1c1931,_0x31d96a)=>{try{await set_login_cookies(_0x1a3c18,_0x31d96a);}catch(_0x4e048c){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x4e048c);}});}),ipcMain['handle']('set-headless',async(_0x5251cd,_0x414882)=>{const _0x1efdb3=!!_0x414882;if(!optionsDb)try{await initOptionsDb();}catch(_0x4ae9c7){console['error']('[OptionsDB]\x20Init\x20on\x20set-headless\x20fehlgeschlagen:',_0x4ae9c7);}return await setOption('isHeadless',_0x1efdb3?'1':'0'),console['log']('[MAIN]\x20isHeadless\x20gesetzt\x20(DB)\x20auf:',_0x1efdb3),{'ok':!![],'headless':_0x1efdb3};}),ipcMain['handle']('get-headless',async()=>{const _0x15cbba=await getIsHeadless();return{'headless':_0x15cbba};}),ipcMain['on']('export-relation',async(_0x58443d,_0x21c496)=>{try{await exportDatabase(_0x21c496),_0x58443d['reply']('export-relation-response',{'success':!![]});}catch(_0x4b8edb){console['error'](_0x4b8edb),_0x58443d['reply']('export-relation-response',{'success':![],'message':_0x4b8edb['message']});}}),ipcMain['handle']('sendMessage',async(_0x105daa,_0x3b3308,_0x5e5766,_0x289660,_0x2dc4fc,_0xff9ad2,_0x1733e0,_0x2a276c,_0x250a94,_0x2ef6dd,_0x230a51,_0x5cb6ce,_0x1b01cb)=>{isStopping=![];let _0x1261b0=null;return _0x1733e0?_0x1261b0=await getBrowserPage(_0x2dc4fc,_0x2a276c):_0x1261b0=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x3b3308),send_message(_0x1261b0,_0x3b3308,_0x5e5766,_0x289660,_0x2dc4fc,_0xff9ad2,_0x250a94,_0x2ef6dd,_0x230a51,_0x5cb6ce,_0x1b01cb);}),ipcMain['handle']('stop-action',async(_0x186e3b,_0x4f9b6b)=>{isStopping=!![];const _0x541643=await getBrowserPage(0x1,_0x4f9b6b);await _0x541643['close']();}),ipcMain['handle']('fetch_followers',async(_0x314528,_0x33e376,_0x297cf6,_0x2fc36e,_0x208234,_0x541fdb,_0x4689ea)=>{isStopping=![];const _0x2f8f77=await getBrowserPage();return fetch_followers_from_account(_0x314528,_0x2f8f77,_0x33e376,_0x297cf6,_0x2fc36e,_0x208234,_0x541fdb,_0x4689ea);}),ipcMain['handle']('get-account-details',async(_0x43b8cb,_0x5031c0,_0x31cb96,_0x4f5a8a)=>{isStopping=![];const _0x29fcc6=await getBrowserPage();return fetch_account_details(_0x29fcc6,_0x5031c0,_0x31cb96,_0x4f5a8a);}),ipcMain['handle']('fetch_likes',async(_0x285030,_0x43a1c5,_0x3ed382,_0x1fc0a4,_0x20d6a8,_0x3279b2,_0x4b65c7)=>{isStopping=![];const _0x223285=await getBrowserPage();return fetch_likers_from_post(_0x285030,_0x223285,_0x43a1c5,_0x3ed382,_0x1fc0a4,_0x20d6a8,_0x3279b2,_0x4b65c7);}),ipcMain['handle']('fetch_comments',async(_0x37ada4,_0x5d961b,_0x45746e,_0x26360b,_0x38e0b2,_0x5e21f5,_0x4a942e)=>{isStopping=![];const _0x1c55e5=await getBrowserPage();return fetch_comments_from_post(_0x37ada4,_0x1c55e5,_0x5d961b,_0x45746e,_0x26360b,_0x38e0b2,_0x5e21f5,_0x4a942e);});async function updateAppSilent(){const {spawn:_0x4344a0}=require('child_process'),_0xc48bac=require('path'),_0x3c9632=require('electron-log');return _0x3c9632['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x107f69,_0x57b018)=>{const {updateElectronApp:_0x2d08e9,UpdateSourceType:_0x39342e}=require('update-electron-app');_0x2d08e9({'updateSource':{'type':_0x39342e['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x3c9632}),_0x107f69('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0xb81947,_0x41fcdc)=>{doFullElectronUpdateSilent(),_0xb81947('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x5df250}=require('child_process'),_0x559b57=require('path'),_0x92be87=require('electron-log');return _0x92be87['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x1efef5,_0x14e1ae)=>{const {updateElectronApp:_0x58e962,UpdateSourceType:_0x3a6f84}=require('update-electron-app');_0x58e962({'updateSource':{'type':_0x3a6f84['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x92be87}),_0x1efef5('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x1ea818,_0x37ae37)=>{doFullElectronUpdate(),_0x1ea818('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0x43abb1,_0x1ee9e7)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x43abb1('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x14e166=path['join'](__dirname,'mac-updater-intern.sh'),_0x518568=spawn('/bin/bash',[_0x14e166],{'detached':!![],'stdio':'ignore'});_0x518568['unref'](),setTimeout(()=>{_0x43abb1('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0x1ee9e7(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0x3a88b3=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x341107,_0x4199c4)=>{console['log']('Update\x20Silent:\x20'+_0x4199c4);if(_0x4199c4){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0xa13aaf,_0x4e2d38){return Math['random']()*(_0x4e2d38-_0xa13aaf+0x1)+_0xa13aaf;}function delay(_0x46f665,_0x3ba52a){let _0xb6fb5e=getRnd(_0x46f665,_0x3ba52a);return new Promise(function(_0xf616aa){setTimeout(_0xf616aa,_0xb6fb5e);});}async function scroll(_0x31d91b,_0x2e5169,_0x5f58ad=0x2,_0x2d908d){const _0x276208=await _0x31d91b['waitForSelector'](_0x2e5169);for(let _0x84d6a7=0x0;_0x84d6a7<_0x5f58ad;_0x84d6a7++){console['log']('Scrolling\x20'+_0x84d6a7),await _0x31d91b['evaluate'](_0x7116c8=>{const _0x1f39e8=document['querySelector'](_0x7116c8);_0x1f39e8&&_0x1f39e8['scrollBy'](0x0,0x190);},_0x2e5169),await delay(0x320,0x5dc),_0x2d908d();}}async function saveCookies(_0xbf1cf9){let _0x23a7ff=await _0xbf1cf9['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x23a7ff,null,0x2));}async function notificationClear(_0x30a0ef){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xfa0,0x1388),await _0x30a0ef['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x30a0ef['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x4a3b5a){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x4a3b5a);}}async function getTargetProfiles(_0x3ed94c){return new Promise((_0x185b73,_0x5712fa)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x3ed94c,(_0x2594c6,_0x1afc24)=>{_0x2594c6?_0x5712fa(_0x2594c6):_0x185b73(_0x1afc24);});});}async function login_legacy(_0x3324f1,_0x4fc90e,_0x3185ab){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x3324f1,_0x4fc90e),await createUserIfNotExists(_0x4fc90e,_0x3185ab);}catch(_0x3abeef){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x3abeef);}try{await _0x3324f1['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x3324f1['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x3324f1['click']('button._a9--._ap36._a9_0');}catch(_0x44096a){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x3324f1['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x3324f1['type']('input[name=\x27username\x27]',_0x4fc90e,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x3324f1['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x3324f1['type']('input[name=\x27password\x27]',_0x3185ab,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x3324f1['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x3324f1['click']('button[type=\x27submit\x27]');}catch(_0x4eaecb){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x3324f1),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x3324f1,_0x4fc90e);}catch(_0x156d4b){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x156d4b);}}catch(_0x38cf09){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x38cf09);}}async function login(_0x40afe9,_0x3f56a9){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x40afe9,_0x3f56a9),await createUserIfNotExists(_0x3f56a9);}catch(_0x19f697){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x19f697);}try{await _0x40afe9['goto']('https://www.instagram.com/accounts/login/');}catch(_0x54151f){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x54151f);}}async function set_login_cookies(_0xc153d,_0x2ecece){try{await saveCookiesForUser(_0xc153d,_0x2ecece);}catch(_0x13c663){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x13c663);}}async function waitForXPath(_0x57a6ff,_0x80c083,_0x133533={}){return await _0x57a6ff['waitForFunction'](_0x3c2e28=>{return document['evaluate'](_0x3c2e28,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x133533,_0x80c083),_0x57a6ff['evaluateHandle'](_0x108e6f=>document['evaluate'](_0x108e6f,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x80c083);}async function waitForSelectorWithFallbacks(_0xd46b1c,_0x1ece2a,_0x57ff42={}){!Array['isArray'](_0x1ece2a)&&(_0x1ece2a=[_0x1ece2a]);for(let _0x12c940=0x0;_0x12c940<_0x1ece2a['length'];_0x12c940++){const _0x3f6d62=_0x1ece2a[_0x12c940],_0xe078d8=_0x3f6d62['startsWith']('//')||_0x3f6d62['startsWith']('(//');try{console['log']('Versuche\x20'+(_0xe078d8?'XPath':'Selector')+'\x20'+(_0x12c940+0x1)+'/'+_0x1ece2a['length']+':\x20'+_0x3f6d62['substring'](0x0,0x32)+'...');const _0x30a045=_0x12c940===0x0?_0x57ff42['timeout']||0x1388:0x7d0;let _0x7b6d30;if(_0xe078d8){const _0x189d9d=await waitForXPath(_0xd46b1c,_0x3f6d62,{..._0x57ff42,'timeout':_0x30a045});if(!_0x189d9d)throw new Error('XPath-Element\x20nicht\x20gefunden');_0x7b6d30=_0x189d9d;}else _0x7b6d30=await _0xd46b1c['waitForSelector'](_0x3f6d62,{..._0x57ff42,'timeout':_0x30a045});return console['log']((_0xe078d8?'XPath':'Selector')+'\x20'+(_0x12c940+0x1)+'\x20gefunden!'),_0x7b6d30;}catch(_0x4f3131){console['log']((_0xe078d8?'XPath':'Selector')+'\x20'+(_0x12c940+0x1)+'\x20nicht\x20gefunden:\x20'+_0x4f3131['message']);if(_0x12c940===_0x1ece2a['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x1ece2a['length']+'\x20Selektoren/XPath\x20konnte\x20gefunden\x20werden:\x20'+_0x4f3131['message']);}}throw new Error('Keine\x20Selektoren/XPath\x20angegeben');}async function waitForXPathAll(_0x408e09,_0x4b76e5,_0xcea2df={}){return await _0x408e09['waitForFunction'](_0x4bb4fb=>{return document['evaluate'](_0x4bb4fb,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null)['snapshotLength']>0x0;},_0xcea2df,_0x4b76e5),_0x408e09['evaluateHandle'](_0x59c530=>{const _0xece2cd=document['evaluate'](_0x59c530,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null),_0x7f094c=[];for(let _0x596213=0x0;_0x596213<_0xece2cd['snapshotLength'];_0x596213++){_0x7f094c['push'](_0xece2cd['snapshotItem'](_0x596213));}return _0x7f094c;},_0x4b76e5)['then'](_0xe75e26=>_0xe75e26['getProperties']());}ipcMain['handle']('check-login',async(_0xc03e3d,_0x2195c0)=>{if(pageStack[0x0]){try{await pageStack[0x0]['close']();}catch(_0x59bd5c){}pageStack[0x0]=null;}if(browser){try{await browser['close']();}catch(_0x1d9136){}browser=null;}const _0x9c20db=await getBrowserPage(0x0,0x0),_0x50c7e7=await checkCookiesSession(_0x9c20db,_0x2195c0);return _0x50c7e7;});async function checkCookiesSession(_0x9a1bd7,_0x2aa90a){try{await setCookiesForUser(_0x9a1bd7,_0x2aa90a),console['log']('Cookies\x20für\x20'+_0x2aa90a+'\x20erfolgreich\x20geladen');}catch(_0x2bc855){return console['error']('Fehler\x20beim\x20Laden\x20der\x20Cookies\x20für\x20'+_0x2aa90a+':',_0x2bc855),![];}try{await _0x9a1bd7['goto']('https://www.instagram.com/',{'timeout':0x3a98});}catch(_0x1337d0){console['error']('Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x1337d0);}await delay(0x6a4,0x7d0);try{const _0x3f6b5b=await checkLoginStatus(_0x9a1bd7);return console['log']('Login-Status\x20für\x20'+_0x2aa90a+':\x20'+_0x3f6b5b),_0x3f6b5b;}catch(_0x476d9e){return console['warn']('Login-Prüfung\x20fehlgeschlagen\x20für\x20'+_0x2aa90a+':',_0x476d9e['message']),![];}}async function checkLoginStatus(_0x7f82f5){const _0x2782aa=['[type=\x22password\x22]','//a[normalize-space(text())=\x27Log\x20In\x27]','//div[@role=\x27button\x27\x20and\x20normalize-space(.)=\x27Log\x20in\x27]','//h3[normalize-space(text())=\x27Something\x20went\x20wrong\x27]'];let _0x24529b=null;try{_0x24529b=await waitForSelectorWithFallbacks(_0x7f82f5,_0x2782aa,{'timeout':0x7d0});}catch(_0x1d59f0){return console['log']('Eingeloggt,\x20kein\x20Login\x20notwendig:\x20'+_0x1d59f0),!![];}if(_0x24529b){console['log']('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return![];}else return console['log']('Eingeloggt,\x20führe\x20keine\x20Login\x20durch'),!![];}async function checkPageExists(_0x1852de){const _0xb5e5b6=['//span[contains(normalize-space(.),\x22Sorry,\x20this\x20page\x20isn\x27t\x20available\x22)]'];let _0x34f23f=null;try{_0x34f23f=await waitForSelectorWithFallbacks(_0x1852de,_0xb5e5b6,{'timeout':0x7d0});}catch(_0x369962){return console['log']('Seite\x20existiert:\x20'+_0x369962),!![];}if(_0x34f23f){console['log']('Angegbene\x20Seite\x20existiert\x20nicht');throw new Error('Angegbene\x20Seite\x20existiert\x20nicht');return![];}else return console['log']('Seite\x20existiert'),!![];}async function likeFirstPost(_0x5dada7){try{const _0x56852b=await _0x5dada7['$$'](K_BEITRAG_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Posts\x20gefunden:\x20'+_0x56852b['length']);if(_0x56852b&&_0x56852b['length']>0x0){const _0x286f02=_0x56852b[0x0];await _0x286f02['click'](),await delay(0xaf0,0xbb8);const _0x484d52=await _0x5dada7['evaluate'](()=>{const _0x5e479e=document['querySelector']('section\x20>\x20span\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20svg[aria-label=\x22Like\x22]');return!!_0x5e479e;});if(_0x484d52){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus');const _0x1630e4=await _0x5dada7['$$'](K_BEITRAG_LIKE_BUTTON),_0x48e1c6=_0x1630e4[0x0];await delay(0x514,0x5dc),await _0x5dada7['evaluate'](_0x318955=>{_0x318955['click']();},_0x48e1c6);}else console['log']('Beitrag\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x5dada7['goBack'](),await delay(0x7d0,0x898);}}catch(_0x552c6e){console['log']('Fehler\x20beim\x20Liken\x20des\x20ersten\x20Posts:',_0x552c6e);throw new Error('Like_Posts:\x20'+_0x552c6e);}}async function likeFirstStory(_0x2b6037){try{const _0x480c09=await _0x2b6037['$$'](K_STORY_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Stories\x20gefunden:\x20'+_0x480c09['length']);if(_0x480c09&&_0x480c09['length']>0x0){const _0x310e6a=_0x480c09[0x0];await _0x310e6a['click'](),await delay(0xaf0,0xbb8);const _0x56c0cd=await _0x2b6037['evaluate'](()=>{const _0x41c6f7=document['querySelector']('[aria-label=\x22Like\x22]');return!!_0x41c6f7;});if(_0x56c0cd){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus'),await delay(0x514,0x5dc);try{const _0x439265=await _0x2b6037['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0x2b6037['click'](_0x439265);}catch(_0x51a469){console['log']('Direkter\x20Klick\x20fehlgeschlagen,\x20versuche\x20alternative\x20Methoden:',_0x51a469);try{const _0xefd3ef=await _0x2b6037['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0x2b6037['evaluateHandle'](_0xbffcd9=>{_0xbffcd9['click']();},_0xefd3ef);}catch(_0x355e45){console['log']('Evaluatehandle\x20fehlgeschlagen,\x20versuche\x20JS-Click:',_0x355e45),await _0x2b6037['evaluate'](()=>{const _0x2c6e95=document['querySelector']('[aria-label=\x22Like\x22]');if(_0x2c6e95)_0x2c6e95['click']();else throw new Error('Element\x20nicht\x20gefunden');});}}}else console['log']('Story\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x2b6037['goBack'](),await delay(0x7d0,0x898);}}catch(_0x5b68a3){console['log']('Fehler\x20beim\x20Liken\x20der\x20ersten\x20Story:',_0x5b68a3);throw new Error('Like_Storys:\x20'+_0x5b68a3);}}async function send_message(_0x23d63b,_0x35c9be,_0x1197d8,_0x1a3001,_0x5bbdaf,_0x4c82bc,_0x468b6f,_0x1100ee,_0x5c0a8a,_0x47400f,_0x3a18da){return new Promise(async(_0x52928d,_0x58c764)=>{_0x4c82bc=_0x4c82bc['split'](';'),console['log'](_0x4c82bc[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x5bbdaf);if(_0x1a3001===null||_0x1a3001===undefined){console['log']('Nachricht\x20ist\x20null\x20oder\x20undefined'),_0x58c764('Nachricht\x20darf\x20nicht\x20leer\x20sein');return;}try{await setCookiesForUser(_0x23d63b,_0x4c82bc[0x0]);}catch(_0x17da9f){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x17da9f),_0x52928d({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x17da9f});return;}await delay(0x6a4,0x7d0);try{await _0x23d63b['goto']('https://www.instagram.com/'+_0x35c9be+'/'),await delay(0x1b58,0x1d4c),await notificationClear(_0x23d63b);}catch(_0x275162){_0x52928d({'status':0x1f5,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x275162});return;}try{await checkLoginStatus(_0x23d63b);}catch(_0x1a3fc1){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x1a3fc1),_0x58c764('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return;}if(_0x5c0a8a==0x1)try{await likeFirstPost(_0x23d63b);}catch(_0xe7a9f7){_0x58c764(_0xe7a9f7);}if(_0x47400f==0x1)try{await likeFirstStory(_0x23d63b);}catch(_0x5a64e6){_0x58c764(_0x5a64e6);}console['log']('UserSkip:\x20'+_0x468b6f);if(_0x468b6f==0x1)try{const _0x4a2eb5=await _0x23d63b['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x1d7aa4=>_0x1d7aa4['textContent']['trim']());console['log'](_0x4a2eb5);if(_0x4a2eb5==='Following'||_0x4a2eb5==='Folge\x20ich')return _0x52928d({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x528793){}await delay(0x6a4,0x7d0);try{const _0x3024e1=await waitForSelectorWithFallbacks(_0x23d63b,K_DIRECT_MSG_BUTTON);await _0x3024e1['click'](),await delay(0xa8c,0xdac);try{const _0x46e860=await waitForSelectorWithFallbacks(_0x23d63b,K_EXPAND_MSG_BUTTON);await _0x46e860['click']();}catch(_0x1b29de){console['log']('Expand-Button\x20nicht\x20gefunden.\x20Überspringen:\x20'+_0x1b29de);}}catch(_0x5c2caa){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x5c2caa);try{await delay(0xa8c,0xbb8);try{const _0x1d2980=await waitForSelectorWithFallbacks(_0x23d63b,K_OPTIONS_BUTTON);await _0x1d2980['click']();}catch(_0x1219d4){console['log']('Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x1219d4),_0x52928d({'status':0x1f6,'message':'Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x1219d4});return;}await delay(0xa8c,0xbb8);const _0x73076d=await waitForXPath(_0x23d63b,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x73076d['click']();}catch(_0x49b13f){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x49b13f),_0x52928d({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x708,0x7d0),await notificationClear(_0x23d63b);}catch(_0x4e79e6){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x4e79e6);}try{await delay(0xaf0,0xdac);const _0xc6a8e7=await waitForSelectorWithFallbacks(_0x23d63b,K_CHAT_INPUT_FIELD,{'timeout':0x3a98});if(_0x1100ee){const _0x55d8bc=await _0x23d63b['$'](K_ALREADY_CHATTED);if(_0x55d8bc)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x35c9be),_0x52928d({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x3d31f8=await _0x23d63b['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x3d31f8),_0x1a3001=_0x1a3001['replace']('{USERNAME}',_0x35c9be);let _0xd310a7;if(_0x1a3001['includes']('{NAME}')||_0x1a3001['includes']('{name}'))try{const _0x6d838=await extractFirstName(_0x3d31f8,_0x3a18da);console['log']('Response\x20Clearname\x20valid:\x20'+_0x6d838['valid']),_0x6d838['valid']?(_0x1a3001=_0x1a3001['replaceAll'](/{NAME}|{name}/g,_0x6d838['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x6d838['name']),_0xd310a7=_0x6d838['name']):(_0x1a3001=_0x1a3001['replaceAll'](/ ?({NAME}|{name})/g,''),_0xd310a7='UNKNOWN_NAME');}catch(_0xcfad58){console['log'](_0xcfad58['message']),_0xd310a7=_0xcfad58['message'];const _0x6ccd86=_0x3d31f8?_0x3d31f8['replace'](/[^\p{L}\s]/gu,''):'',_0x3adcfe=_0x6ccd86['split']('\x20')[0x0]||'';_0x3adcfe['length']>0x2&&!_0x3adcfe['includes']('Instagram')?_0x1a3001=_0x1a3001['replaceAll'](/{NAME}|{name}/g,_0x3adcfe):_0x1a3001=_0x1a3001['replaceAll'](/ ?({NAME}|{name})/g,'');}console['log']('Nachricht\x20vor\x20dem\x20Senden:\x20'+_0x1a3001);const _0x205813=_0x1a3001['split']('\x0a');await _0xc6a8e7['type'](_0x205813[0x0],{'delay':getRnd(0x50,0x78)});for(let _0xc59fc2=0x1;_0xc59fc2<_0x205813['length'];_0xc59fc2++){await _0x23d63b['keyboard']['down']('Shift'),await _0x23d63b['keyboard']['press']('Enter'),await _0x23d63b['keyboard']['up']('Shift'),await delay(0x64,0xc8),_0x205813[_0xc59fc2]['length']>0x0&&await _0xc6a8e7['type'](_0x205813[_0xc59fc2],{'delay':getRnd(0x50,0x78)});}console['log']('Nachricht\x20mit\x20Zeilenumbrüchen\x20gesendet'),await delay(0x320,0x3e8);try{const _0x3f65f6=await waitForSelectorWithFallbacks(_0x23d63b,K_SEND_MSG_BUTTON);await _0x3f65f6['click']();}catch(_0x5225f9){console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x5225f9),_0x52928d({'status':0x195,'message':'Send\x20nicht\x20gefunden.\x20Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x35c9be+'\x20überspringen.','error':_0x5225f9['message']});}await delay(0x320,0x3e8),_0x52928d({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x3d31f8,'extracted_clearname':_0xd310a7});}catch(_0x57f60b){let _0x5c8e00=_0x57f60b;console['log']('Fehler\x20beim\x20Senden\x20der\x20Nachricht:\x20'+_0x5c8e00),_0x52928d({'status':0x1f4,'message':'Error\x20500:\x20'+_0x5c8e00});}});}function handle_fail(_0x134fb6){if(isStopping)return new Promise(_0x5c1341=>{_0x5c1341('Scraper\x20gestoppt.');});else{let _0x1a7468='';switch(_0x134fb6){case 0x0:_0x1a7468='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x1a7468='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x1a7468='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x1a7468='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x21c72f,_0x134622)=>{_0x134622(_0x1a7468);});}}async function fetch_account_details(_0x5998f2,_0x3d805f,_0x48f2f0,_0x575371){try{await setCookiesForUser(_0x5998f2,_0x48f2f0['username']);}catch(_0x30c3c0){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x30c3c0);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x30c3c0);return handle_fail(0x0);}_0x5998f2['setDefaultNavigationTimeout'](0x7530),await _0x5998f2['goto']('https://www.instagram.com/'+_0x3d805f+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x5998f2);const _0x530b6e=await _0x5998f2['evaluate'](()=>{const _0x56c68b=document['querySelector']('meta[property=\x22og:image\x22]');return _0x56c68b?_0x56c68b['getAttribute']('content'):null;});await _0x5998f2['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x672dc4=await _0x5998f2['evaluate'](()=>{const _0x554b97=document['querySelector']('meta[name=\x22description\x22]');if(!_0x554b97)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x2788f0=_0x554b97['getAttribute']('content');if(!_0x2788f0)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x2788f0);const _0x2a3969=/\s*[–-]\s*/,_0xc23007=_0x2788f0['split'](_0x2a3969);if(_0xc23007['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x27b97b=_0xc23007[0x0],_0x582b68=_0xc23007[0x1],_0x201a80=_0x27b97b['split'](',\x20');if(_0x201a80['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0xb91d9e=_0x201a80[0x0]['split']('\x20')[0x0],_0x213bbc=_0x201a80[0x1]['split']('\x20')[0x0],_0x905139=_0x201a80[0x2]['split']('\x20')[0x0];let _0x31c757='',_0x5f0546='';const _0x413eb1='\x20on\x20Instagram:\x20',_0x8292fa=_0x582b68['split'](_0x413eb1);return _0x31c757=_0x8292fa[0x0]['trim'](),_0x31c757=_0x31c757['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x8292fa['length']>0x1&&(_0x5f0546=_0x8292fa[0x1]['trim'](),_0x5f0546['startsWith']('\x22')&&_0x5f0546['endsWith']('\x22')&&(_0x5f0546=_0x5f0546['substring'](0x1,_0x5f0546['length']-0x1)['trim']()),_0x5f0546=_0x5f0546['replace'](/&quot;/g,'')['trim']()),{'followers':_0xb91d9e,'following':_0x213bbc,'posts':_0x905139,'nameText':_0x31c757,'bio':_0x5f0546};});console['log']('Extracted\x20profile\x20data:',_0x672dc4);const _0x21c8d6=_0x672dc4['nameText'],_0x1ec149=_0x530b6e,_0x102dbd=_0x672dc4['bio'],_0x880c41=_0x672dc4['followers'],_0x36372d=_0x672dc4['following'],_0x1996e9=_0x672dc4['posts'],_0x41d2df=![],_0x34778a=![],_0x319b7a=![],_0x1e4152='\x0a\x20\x20INSERT\x20INTO\x20'+_0x575371+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x1e4152,[_0x3d805f,_0x21c8d6,_0x1ec149,_0x102dbd,_0x880c41,_0x36372d,_0x1996e9,_0x41d2df,_0x34778a,_0x319b7a],function(_0x11d536){_0x11d536?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x11d536['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x4ad981,_0x1b53c4,_0x326144,_0x2ed3bf,_0x3d7d86,_0x51449c,_0x2f540f,_0x2d72d0){let _0x2cae07=0x4,_0x2a6132=0x0,_0x1eea45=0x0;try{await setCookiesForUser(_0x1b53c4,_0x51449c['username']);}catch(_0x2ad654){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x2ad654);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2ad654);return handle_fail(0x0);}let _0x2e8596=0x0;try{await _0x1b53c4['goto']('https://www.instagram.com/'+_0x326144+'/'),await notificationClear(_0x1b53c4);try{await checkLoginStatus(_0x1b53c4);}catch(_0x369b39){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x369b39);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x1b53c4);}catch(_0x1a0b92){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x1a0b92);throw new Error('Username\x20nicht\x20gefunden.\x20Existiert\x20der\x20Account?');}try{if(_0x2ed3bf<=0x0){const _0x480554=await _0x1b53c4['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x273fcb=await _0x1b53c4['evaluate'](_0x22ec88=>_0x22ec88['innerHTML'],_0x480554);_0x2e8596=Math['ceil'](_0x273fcb/0x4);}else _0x2e8596=Math['ceil'](_0x2ed3bf/0x4);_0x2cae07+=_0x2e8596,_0x1eea45=Math['round'](++_0x2a6132/_0x2cae07*0x64),_0x4ad981['sender']['send']('fetch-progress',_0x1eea45,!![]);let _0x368824=await _0x1b53c4['waitForSelector']('a[href=\x22/'+_0x326144+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x368824['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x326144+'\x20gesichtet'),_0x1eea45=Math['round'](++_0x2a6132/_0x2cae07*0x64),_0x4ad981['sender']['send']('fetch-progress',_0x1eea45,!![]);}catch(_0x18925b){console['log']('Follower\x20Liste\x20von\x20'+_0x326144+'\x20nicht\x20gefunden:'+_0x18925b);throw new Error('Follower\x20Liste\x20von\x20'+_0x326144+'\x20nicht\x20gefunden:'+_0x18925b);return handle_fail(0x0);}}catch(_0x213ca4){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x213ca4);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x213ca4);return handle_fail(0x0);}try{await delay(0x12c0,0x1388),console['log']('Auto-scrolls:\x20'+_0x2e8596);try{await scroll(_0x1b53c4,FOLLOWER_FENSTER,_0x2e8596,_0x16dde3=>{});}catch{console['log']('Fallback\x20div:has\x20ausgelöst'),await scroll(_0x1b53c4,'div.x6nl9eh.x1a5l9x9.x7vuprf.x1mg3h75.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',_0x2e8596,_0x209f98=>{});}_0x1eea45=Math['round'](++_0x2a6132/_0x2cae07*0x64),_0x4ad981['sender']['send']('fetch-progress',_0x1eea45,!![]),await _0x1b53c4['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x4667f1=await _0x1b53c4['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x1b990c=await _0x1b53c4['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x1eea45=Math['round'](++_0x2a6132/_0x2cae07*0x64),_0x4ad981['sender']['send']('fetch-progress',_0x1eea45,!![]);_0x2ed3bf<=0x0&&(_0x2ed3bf=_0x4667f1['length']);let _0x14f0e6=[];for(let _0x1e52e0=0x0;_0x1e52e0<_0x4667f1['length']&&_0x1e52e0<_0x2ed3bf;_0x1e52e0++){const _0x56ce93=await _0x4667f1[_0x1e52e0]['evaluate'](_0x572ce8=>_0x572ce8['textContent']),_0x72036=await _0x1b990c[_0x1e52e0]['evaluate'](_0x36dc90=>_0x36dc90['textContent']);if(_0x2d72d0){const _0x441caa=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x51449c['username'],_0x56ce93]);if(_0x441caa){console['log']('Skipping\x20already\x20contacted\x20follower:\x20'+_0x56ce93);continue;}}_0x14f0e6['push'](_0x56ce93);const _0x1df1c5='INSERT\x20INTO\x20'+_0x3d7d86+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x1df1c5,[_0x56ce93,_0x72036],function(_0x4f03ce){_0x4f03ce?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x3d7d86+'\x27:',_0x4f03ce['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x1eea45=Math['round'](++_0x2a6132/_0x2cae07*0x64),_0x4ad981['sender']['send']('fetch-progress',_0x1eea45,!![]),_0x2f540f&&(_0x4ad981['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x4ad981,_0x1b53c4,_0x51449c,_0x3d7d86,_0x14f0e6)),new Promise(_0x3519e0=>{_0x3519e0('Scraping\x20finished!');});}catch(_0x4c3c3b){if(_0x2f540f)throw new Error(_0x4c3c3b);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x326144+'\x20nicht\x20gefunden:\x20'+_0x4c3c3b);return handle_fail(0x0);}}async function fetch_details_from_list(_0x46e895,_0x5adbdf,_0x23d407,_0x355bb3,_0x29dce7){let _0x23e995=0x0,_0x5cab23=0x0;for(let _0x188a6f=0x0;_0x188a6f<_0x29dce7['length'];_0x188a6f++){console['log']('Processing\x20profile:',_0x29dce7[_0x188a6f]);try{await fetch_account_details(_0x5adbdf,_0x29dce7[_0x188a6f],_0x23d407,_0x355bb3);}catch(_0x46f774){console['error']('Detailed\x20Scraping\x20von:\x20',_0x29dce7[_0x188a6f],_0x46f774);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x29dce7[_0x188a6f]+'\x20'+_0x46f774);}_0x5cab23=Math['round'](++_0x23e995/_0x29dce7['length']*0x64),_0x46e895['sender']['send']('fetch-progress',_0x5cab23,!![],!![]);}}async function fetch_likers_from_post(_0x2d23f2,_0x314597,_0x4b1a63,_0x279a0f,_0x53ef2e,_0x33bc9a,_0x1b12a2,_0x1a8704){let _0xcb6bf7=0x4,_0x258c8e=0x0,_0x158306=0x0;try{await setCookiesForUser(_0x314597,_0x33bc9a['username']);}catch(_0x52271e){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x52271e);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x52271e);return handle_fail(0x1);}_0x158306=Math['round'](++_0x258c8e/_0xcb6bf7*0x64),_0x2d23f2['sender']['send']('fetch-progress',_0x158306,!![]);try{let _0x4796bf=_0x4b1a63['substring'](0x0,_0x4b1a63['lastIndexOf']('/'));_0x4796bf['includes']('/reel/')&&(_0x4796bf=_0x4796bf['replace']('/reel/','/p/'));let _0x2adee6=_0x4796bf+'/liked_by';console['log'](_0x2adee6),await _0x314597['goto'](_0x2adee6),await delay(0x7d0,0xfa0),await notificationClear(_0x314597),await delay(0xc8,0x1f4);try{await checkLoginStatus(_0x314597);}catch(_0x50a963){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x50a963);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x314597);}catch(_0x112e9b){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x112e9b);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}_0x158306=Math['round'](++_0x258c8e/_0xcb6bf7*0x64),_0x2d23f2['sender']['send']('fetch-progress',_0x158306,!![]),await _0x314597['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x1e1f73=await _0x314597['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x3b5664=await _0x314597['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x1e1f73['length']);let _0x464c6c=path['join'](__dirname,'/likers.csv');_0x158306=Math['round'](++_0x258c8e/_0xcb6bf7*0x64),_0x2d23f2['sender']['send']('fetch-progress',_0x158306,!![]);_0x279a0f<=0x0&&(_0x279a0f=_0x1e1f73['length']);try{let _0x12ed67=[];for(let _0x182374=0x0;_0x182374<_0x1e1f73['length']&&_0x182374<_0x279a0f;_0x182374++){const _0x11e7b4=await _0x1e1f73[_0x182374]['evaluate'](_0x885017=>_0x885017['textContent']),_0x1fca56=await _0x3b5664[_0x182374]['evaluate'](_0x167f2e=>_0x167f2e['textContent']);if(_0x1a8704){const _0x235703=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x33bc9a['username'],_0x11e7b4]);if(_0x235703){console['log']('Skipping\x20already\x20contacted\x20liker:\x20'+_0x11e7b4);continue;}}_0x12ed67['push'](_0x11e7b4);const _0x4fccfd='INSERT\x20INTO\x20'+_0x53ef2e+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x4fccfd,[_0x11e7b4,_0x1fca56],function(_0x2a04d2){_0x2a04d2?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x53ef2e+'\x27:',_0x2a04d2['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x158306=Math['round'](++_0x258c8e/_0xcb6bf7*0x64),_0x2d23f2['sender']['send']('fetch-progress',_0x158306,!![]),_0x1b12a2&&(_0x2d23f2['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x2d23f2,_0x314597,_0x33bc9a,_0x53ef2e,_0x12ed67)),new Promise(_0x5dc087=>{_0x5dc087('Scraping\x20finished!');});}catch(_0x3ce799){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x3ce799);return handle_fail(0x1);}}catch(_0x340727){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x340727);throw new Error('Like-Seite\x20nicht\x20geöffnet:\x20'+_0x340727);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x4254dd,_0x165fb3,_0x7a89ca,_0x5515fd,_0x45bb97,_0x82444a,_0x4fa017,_0x10d0d5){let _0x143ad2=0x3,_0x270dfa=0x0,_0x4d01b2=0x0;try{await setCookiesForUser(_0x165fb3,_0x82444a['username']);}catch(_0x10ad0b){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x10ad0b);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x10ad0b);return handle_fail(0x2);}try{console['log'](_0x7a89ca),await _0x165fb3['goto'](_0x7a89ca),await delay(0x7d0,0xfa0),await notificationClear(_0x165fb3),await delay(0xc8,0x1f4);const _0x4c8345=COM_COMMENTS_BOX_BODY_DIV;try{await checkLoginStatus(_0x165fb3);}catch(_0x32556){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x32556);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x165fb3);}catch(_0x477afc){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x477afc);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}let _0x5d16bc;const _0x1efaa7=await _0x165fb3['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x263fba=await _0x165fb3['evaluate'](_0x1302bf=>_0x1302bf['innerHTML'],_0x1efaa7),_0x3290f5=String(_0x263fba)['replace'](/[^0-9]/g,''),_0x18268d=Number(_0x3290f5)/0x14;_0x5515fd<=0x0?_0x5d16bc=Math['ceil'](_0x18268d/0x3):_0x5d16bc=Math['ceil'](_0x5515fd/0x3);_0x143ad2+=_0x5d16bc,_0x4d01b2=Math['round'](++_0x270dfa/_0x143ad2*0x64),_0x4254dd['sender']['send']('fetch-progress',_0x4d01b2,!![]),console['log']('Auto-scrolls:\x20'+_0x5d16bc),await scroll(_0x165fb3,_0x4c8345,_0x5d16bc,_0x5079bb=>{_0x4d01b2=Math['round'](++_0x270dfa/_0x143ad2*0x64),_0x4254dd['sender']['send']('fetch-progress',_0x4d01b2,!![]);});try{const _0x19dcaa=COM_REPLY_BUTTON_SPAN,_0x23e966=await waitForXPathAll(_0x165fb3,_0x19dcaa);console['log']('Reply-Buttons\x20gefunden:\x20ANZAHL:\x20'+_0x23e966['size']),await delay(0x1f4,0x320);let _0x25c06e=_0x23e966['size'],_0x4aae13=[];for(const [_0xc80796,_0x23ee24]of _0x23e966){_0x4aae13['push'](_0x23ee24);}console['log']('Alle\x20Reply-Buttons:',_0x4aae13['length']);try{for(let _0x1eefd2=0x0;_0x1eefd2<_0x25c06e;_0x1eefd2++){await _0x4aae13[_0x1eefd2]['click'](),await delay(0x320,0x5dc);}}catch(_0x91732b){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x91732b);throw new Error('Nicht\x20auf\x20Replies\x20geklickt:\x20'+_0x91732b);return handle_fail(0x2);}}catch(_0x476a71){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x33d64b=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x165fb3['waitForSelector'](_0x33d64b),await delay(0x1f4,0x320),_0x4d01b2=Math['round'](++_0x270dfa/_0x143ad2*0x64),_0x4254dd['sender']['send']('fetch-progress',_0x4d01b2,!![]);const _0x2fd02a=await _0x165fb3['$$'](_0x33d64b);let _0xce622f=path['join'](__dirname,'/comments.csv');_0x5515fd<=0x0&&(_0x5515fd=_0x2fd02a['length']);console['log']('fetch_limit:\x20'+_0x5515fd),console['log']('comments_len:\x20'+_0x2fd02a['length']),_0x5515fd++;try{let _0x247ffc=[];for(let _0x25d90c=0x1;_0x25d90c<_0x2fd02a['length']&&_0x25d90c<_0x5515fd;_0x25d90c++){const _0x1df166=await _0x2fd02a[_0x25d90c]['evaluate'](_0x499362=>_0x499362['textContent']);if(_0x10d0d5){const _0x2b00d8=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x82444a['username'],_0x1df166]);if(_0x2b00d8){console['log']('Skipping\x20already\x20contacted\x20commenter:\x20'+_0x1df166);continue;}}try{_0x247ffc['push'](_0x1df166);const _0x2de8cc='INSERT\x20INTO\x20'+_0x45bb97+'\x20(username)\x20VALUES\x20(?)';db['run'](_0x2de8cc,[_0x1df166],function(_0x5b5a66){_0x5b5a66&&console['log']('error\x20in\x20add-user:'+_0x5b5a66);});}catch(_0x2d3b93){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x25d90c+'\x20:\x20'+_0x2d3b93);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x25d90c+'\x20:\x20'+_0x2d3b93);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x4d01b2=Math['round'](++_0x270dfa/_0x143ad2*0x64),_0x4254dd['sender']['send']('fetch-progress',_0x4d01b2,!![]),_0x4254dd['sender']['send']('fetch-progress',0x64,!![]),_0x4fa017&&(_0x4254dd['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x4254dd,_0x165fb3,_0x82444a,_0x45bb97,_0x247ffc)),_0x4254dd['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x469e1f=>{_0x469e1f('Scraping\x20finished!');});}catch(_0x22fae0){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x22fae0);return handle_fail(0x2);}}catch(_0x2b441a){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x2b441a);throw new Error('Comments-Seite\x20nicht\x20geöffnet:\x20'+_0x2b441a);return handle_fail(0x2);}}async function set_clearname_from_username(_0x1088ae,_0x399739,_0x450d70=null){try{let _0x4cf260,_0x4a93f0;const _0xf7e84d='SELECT\x20username\x20FROM\x20'+_0x399739+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0xf7e84d,[],(_0x5e058f,_0x4eda94)=>{_0x5e058f&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x5e058f['message']),_0x4eda94['length']===0x0&&(_0x4a93f0=_0x4eda94['length']),_0x4cf260=_0x4eda94['map'](_0xdcc3ca=>_0xdcc3ca['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x4a93f0);if(_0x4a93f0===0x0){console['log']('Leave');return;}const _0x293894=await _0x1088ae['waitForSelector'](IG_SEARCH_BUTTON);await _0x293894['click'](),await delay(0x4b0,0x7d0);for(let _0x2fd9a2 of _0x4cf260){const _0x259e8d=await _0x1088ae['waitForSelector'](IG_SEARCH_INPUT);await _0x259e8d['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x1088ae['type'](IG_SEARCH_INPUT,_0x2fd9a2,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x9a8453=0x1;while(_0x9a8453!=0x14){console['log']('Schleife');try{let _0x1386a8=IG_NAME_SPAN_PART1+_0x9a8453+IG_USERNAME_SPAN_PART2;const _0x4b8aeb=await _0x1088ae['waitForSelector'](_0x1386a8),_0x25e4aa=await _0x1088ae['evaluate'](_0x37d224=>_0x37d224['innerHTML'],_0x4b8aeb);await delay(0xc8,0x1f4);if(_0x25e4aa==_0x2fd9a2){let _0x1a5c79=IG_NAME_SPAN_PART1+_0x9a8453+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x5d707e=await _0x1088ae['waitForSelector'](_0x1a5c79);let _0x1df071=await _0x1088ae['evaluate'](_0x494854=>_0x494854['innerHTML'],_0x5d707e);const _0xb7679b=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x52eb75=_0x1df071['match'](_0xb7679b);_0x52eb75?_0x1df071=_0x52eb75[0x1]['trim']():_0x1df071=_0x1df071['trim']();_0x1df071['includes']('•')&&(_0x1df071=_0x1df071['substring'](0x0,_0x1df071['indexOf']('•')-0x1));const _0x133bd4='UPDATE\x20'+_0x399739+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x133bd4,[_0x1df071,_0x25e4aa],function(_0x358eff){_0x358eff&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x358eff['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x9a8453++;}catch(_0x422270){const _0x4367a8='UPDATE\x20'+_0x399739+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x4367a8,['',_0x2fd9a2],function(_0x4bd176){_0x4bd176&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x4bd176['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x422270);break;}}_0x450d70&&_0x450d70();}await _0x293894['click']();}catch(_0x1e7635){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x1e7635);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likePost\x20\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likeStory\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likePost\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likeStory\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x2aaafb,_0x1dca91)=>{const _0x412808='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x412808,[],(_0x3cfc21,_0x4535be)=>{_0x3cfc21?_0x1dca91(_0x3cfc21):_0x2aaafb(_0x4535be);});});});const sqlGet=(_0x1f3f8e,_0x897512,_0x2a2fe7=[])=>new Promise((_0x281081,_0x4f807e)=>_0x1f3f8e['get'](_0x897512,_0x2a2fe7,(_0x40a832,_0x627224)=>_0x40a832?_0x4f807e(_0x40a832):_0x281081(_0x627224))),sqlAll=(_0x26c918,_0x4bd350,_0x1d943c=[])=>new Promise((_0x510166,_0x2d1853)=>_0x26c918['all'](_0x4bd350,_0x1d943c,(_0x592f05,_0x58940f)=>_0x592f05?_0x2d1853(_0x592f05):_0x510166(_0x58940f)));ipcMain['handle']('get-campaign-details',async()=>{try{const _0x10f404=await sqlAll(campaignDB,'SELECT\x20campaign_name,\x20list_id,\x20zeitabstand,\x20account\x20FROM\x20campaign'),_0x1ab452=await Promise['all'](_0x10f404['map'](async _0x23744f=>{const _0x6a382=[];if(!_0x23744f['list_id'])_0x6a382['push']('Liste');if(!_0x23744f['zeitabstand'])_0x6a382['push']('Zeitabstand');if(!_0x23744f['account'])_0x6a382['push']('Instagram\x20Account');if(_0x23744f['account'])try{const _0x2e9990=await sqlGet(igaccountsDB,'SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x23744f['account']]);if(!_0x2e9990)_0x6a382['push']('Instagram\x20Login\x20nicht\x20möglich');else{const _0x258fed=_0x2e9990['cookie']&&_0x2e9990['cookie']['trim']()!==''&&_0x2e9990['cookie']['trim']()!=='[]';if(!_0x258fed)_0x6a382['push']('Instagram\x20Login');}}catch(_0x2ef33e){console['error']('Account-Prüfung\x20SQL-Fehler:',_0x2ef33e['message']),_0x6a382['push']('Instagram\x20Account');}let _0x5840af='N/A',_0x4e0ff0='N/A';if(!_0x6a382['includes']('Liste')){try{const _0x354dd6=await sqlGet(db,'SELECT\x20COUNT(*)\x20AS\x20lead_count\x20FROM\x20'+_0x23744f['list_id']);_0x5840af=_0x354dd6?.['lead_count']??0x0;}catch(_0x49cea3){if(/no such table/i['test'](_0x49cea3['message']))_0x6a382['push']('Liste\x20nicht\x20vorhanden');}try{const _0x14d786=await sqlGet(campaignDB,'SELECT\x20COUNT(*)\x20AS\x20contacted_count\x20FROM\x20dm\x20WHERE\x20list_id\x20=\x20?',[_0x23744f['list_id']]);_0x4e0ff0=_0x14d786?.['contacted_count']??0x0;}catch(_0x47219a){}}return{'campaign_name':_0x23744f['campaign_name'],'lead_count':_0x5840af,'contacted_count':_0x4e0ff0,'status':_0x6a382['length']===0x0?'Positiv':'Fehler:\x20'+_0x6a382['join'](',\x20')};}));return{'status':'success','campaigns':_0x1ab452};}catch(_0xf7c4b6){return console['error']('get-campaign-details\x20fehlgeschlagen:',_0xf7c4b6['message']),{'status':'error','message':_0xf7c4b6['message']};}}),ipcMain['handle']('get-campaign-writer-information',async(_0x9982d0,_0x3d76db)=>{return new Promise((_0x384807,_0x4a0726)=>{const _0x10cbe1='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted,\x20likePost,\x20likeStory\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x10cbe1,[_0x3d76db],(_0x439a38,_0x5f593d)=>{_0x439a38?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x439a38),_0x4a0726(_0x439a38)):(console['log']('ROWS'),console['log'](_0x5f593d),debugDatabaseContents(),_0x384807(_0x5f593d));});});});const showTableContents=_0x5b071a=>{return new Promise((_0x4a45ca,_0xc4c572)=>{const _0x5f4e09='SELECT\x20*\x20FROM\x20'+_0x5b071a+';';campaignDB['all'](_0x5f4e09,(_0x1a9700,_0x192d1d)=>{_0x1a9700?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x5b071a+':',_0x1a9700),_0xc4c572(_0x1a9700)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x5b071a+':',_0x192d1d),_0x4a45ca({'status':'success','message':_0x192d1d}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x33d68b){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x33d68b);}}ipcMain['handle']('create-campaign',async(_0x5d3344,_0x56413a)=>{return new Promise((_0x4a59c2,_0x180ae5)=>{const _0x16494f='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x16494f,[String(_0x56413a)],function(_0x17d8b1){_0x17d8b1?_0x180ae5(_0x17d8b1):_0x4a59c2({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x2c1bdd,_0x5eddb4)=>{return new Promise((_0x229525,_0x8eafae)=>{const _0xb79549='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0xb79549,[_0x5eddb4],function(_0x1e6b09){_0x1e6b09?_0x8eafae(_0x1e6b09):_0x229525({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x567ad6,_0x15191f,_0x3e0c9f,_0x4ad536,_0x21e2cc,_0x4503d3,_0x2fd2ad,_0x255938,_0x1a7449,_0x48d4f3)=>{const _0xb2e0ad=await createMessageID(_0x21e2cc);return new Promise((_0x4f8607,_0x1ff80e)=>{console['log']('ZEITABSTAND:\x20'+_0x4ad536);if(!_0x15191f||!_0x3e0c9f||_0x4ad536===undefined||_0x4ad536===null||_0x4ad536===''||!_0xb2e0ad||!_0x4503d3)return _0x1ff80e({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0xb2e0ad);const _0x176218='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?,\x20likePost\x20=\x20?,\x20likeStory\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x176218,[_0x3e0c9f,_0x4ad536,_0xb2e0ad,_0x4503d3,_0x2fd2ad,_0x255938,_0x1a7449,_0x48d4f3,_0x15191f],function(_0x7ac726){if(_0x7ac726)_0x1ff80e({'status':'error','message':_0x7ac726['message']});else this['changes']===0x0?_0x1ff80e({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x4f8607({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x3cbc3f,_0xc1de70,_0x3902a2,_0x1a237e,_0x353f03)=>{return new Promise((_0x381991,_0x16063c)=>{const _0x29da46='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x29da46,[_0xc1de70,_0x3902a2,_0x1a237e,_0x353f03],function(_0x3f8adf){return _0x3f8adf?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x3f8adf['message']),_0x16063c('insert-dm-response',{'success':![],'message':_0x3f8adf['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x381991('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x49cccd=>{return new Promise((_0x32b414,_0x49fe9e)=>{const _0x21be01='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x21be01,[_0x49cccd],(_0x55f314,_0x46cac6)=>{if(_0x55f314)_0x49fe9e({'status':'error','message':_0x55f314['message']});else{if(_0x46cac6)_0x32b414(_0x46cac6['message_id']);else{const _0x1af723='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x1af723,[_0x49cccd],function(_0x3ae2a4){_0x3ae2a4?_0x49fe9e({'status':'error','message':_0x3ae2a4['message']}):_0x32b414(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x5e46f4,_0x5c9246)=>{return new Promise((_0x492527,_0x249c77)=>{const _0x915d5d='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x5c9246;db['get'](_0x915d5d,(_0x593509,_0x45291c)=>{_0x593509?_0x249c77({'status':'error','message':_0x593509['message']}):_0x492527({'status':'success','count':_0x45291c['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x52ce8a,_0x255245){try{const _0x263328=await new Promise((_0xa467ef,_0x11b342)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x255245],(_0x15fd88,_0x3b770b)=>{if(_0x15fd88)_0x11b342(_0x15fd88);else{if(_0x3b770b['length']>0x0){let _0x52135c=JSON['parse'](_0x3b770b[0x0]['cookie']);console['log'](_0x52135c),_0xa467ef(_0x52135c);}else _0x11b342(new Error('User\x20with\x20username\x20'+_0x255245+'\x20does\x20not\x20exist.'));}});});await _0x52ce8a['setCookie'](..._0x263328),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x4ef0ff){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x4ef0ff);}}async function saveCookiesForUser(_0x480625,_0x4edd33){try{const _0x7879ad=await _0x480625['cookies']();if(!_0x7879ad||_0x7879ad['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x4edd33);const _0x19da93=JSON['stringify'](_0x7879ad);if(_0x19da93['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x4edd33);return new Promise((_0x40ce16,_0x499dbf)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x4edd33],(_0x330fae,_0x3c8a96)=>{if(_0x330fae)return console['error']('Error\x20checking\x20user\x20existence:',_0x330fae),_0x499dbf(_0x330fae);if(_0x3c8a96){const _0x38504a=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x38504a['run'](_0x19da93,_0x4edd33,function(_0x430bd9){return _0x430bd9?(console['error']('Error\x20updating\x20cookies:',_0x430bd9),_0x499dbf(_0x430bd9)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x4edd33),_0x40ce16());});}else{const _0x5ebfad=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x5ebfad['run'](_0x4edd33,_0x19da93,function(_0x4ebe1e){return _0x4ebe1e?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x4ebe1e),_0x499dbf(_0x4ebe1e)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x4edd33),_0x40ce16());});}});});}catch(_0x4ba612){console['error']('Error\x20fetching\x20cookies:',_0x4ba612);throw _0x4ba612;}}async function createUserIfNotExists(_0x150099){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x150099],(_0xa65d30,_0x271c39)=>{if(_0xa65d30){console['error']('Error\x20checking\x20user\x20existence:',_0xa65d30);throw _0xa65d30;}else{if(!_0x271c39){const _0x582979=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x582979['run'](_0x150099,function(_0x226ac7){_0x226ac7?console['error']('Error\x20inserting\x20new\x20user:',_0x226ac7):console['log']('New\x20user\x20created:',_0x150099);});}else console['log']('User\x20already\x20exists:',_0x150099);}});}catch(_0x49fab5){console['error']('Error\x20creating\x20user:',_0x49fab5);throw _0x49fab5;}}ipcMain['handle']('create-relation',async(_0x57187a,_0x239712)=>{return new Promise((_0x689f44,_0x516dc5)=>{const _0x1ef1d4='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x239712+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x1ef1d4,function(_0x1e2dfc){_0x1e2dfc?_0x516dc5(_0x1e2dfc):_0x689f44({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x21997a,_0x3ea018)=>{return console['log']('droping\x20table'+_0x3ea018),new Promise((_0x19a61a,_0xa7cf9)=>{const _0x3e0f90='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x3ea018;console['log']('droping\x20table'+_0x3ea018),db['run'](_0x3e0f90,function(_0x27b19b){_0x27b19b?_0xa7cf9(_0x27b19b):_0x19a61a({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x5f2e0a=>{return new Promise((_0x3208d,_0x6bef5d)=>{const _0x4cbe23='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x4cbe23,[],(_0x457103,_0xadb1d3)=>{_0x457103?_0x6bef5d(_0x457103):_0x3208d(_0xadb1d3['map'](_0x1b9912=>_0x1b9912['name']));});});}),ipcMain['handle']('add-user',async(_0x290d9d,_0x244b09,_0x3c1a76)=>{return new Promise(_0x116368=>{const _0x59e385=db['prepare']('INSERT\x20INTO\x20'+_0x3c1a76+'\x20(username)\x20VALUES\x20(?)');_0x59e385['run'](_0x244b09,function(_0x43af1b){_0x43af1b?console['log']('error\x20in\x20add-user:'+_0x43af1b):_0x116368({'status':'success','id':this['lastID']});}),_0x59e385['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x3b07a0,_0x4f73ac)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x381330,_0x58fd2d)=>{if(_0x381330)_0x4f73ac(_0x381330);else{_0x3b07a0({'status':'success','users':_0x58fd2d});for(_0x58fd2d of _0x58fd2d){console['log'](_0x58fd2d['username']);}}});});}),ipcMain['handle']('get-data',async(_0x8282b9,_0x44a0fe)=>{return new Promise((_0x1fe7a6,_0x52a052)=>{const _0x55da90='SELECT\x20*\x20FROM\x20'+_0x44a0fe;console['log'](_0x55da90),db['all'](_0x55da90,[],(_0x13a124,_0x13dc04)=>{_0x13a124?_0x52a052(_0x13a124):_0x1fe7a6(_0x13dc04);});});}),ipcMain['handle']('get-accounts',async _0x3e0ce9=>{return new Promise((_0x5f13f7,_0xe07b22)=>{const _0x122b20='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x122b20),igaccountsDB['all'](_0x122b20,[],(_0x41e973,_0x2eee2a)=>{_0x41e973?_0xe07b22(_0x41e973):_0x5f13f7(_0x2eee2a);});});}),ipcMain['handle']('get-targets',async(_0x436d7b,_0x490d03)=>{return getTargetProfiles(_0x490d03);}),ipcMain['handle']('delete-user',async(_0x597ea0,_0x573de7,_0x215107)=>{return new Promise((_0x45ab5e,_0x2628a6)=>{const _0x4f1baa=db['prepare']('DELETE\x20FROM\x20'+_0x215107+'\x20WHERE\x20username\x20=\x20?');_0x4f1baa['run'](_0x573de7,function(_0x33f5fa){_0x33f5fa?_0x2628a6(_0x33f5fa):_0x45ab5e({'status':'success','changes':this['changes']});}),_0x4f1baa['finalize']();});}),ipcMain['handle']('delete-account',async(_0x2e5bba,_0x241495)=>{const _0xec2b04=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0xec2b04['run'](_0x241495,function(_0xa2f44a){_0xa2f44a&&console['log'](_0xa2f44a);}),_0xec2b04['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x374ca4,_0x26ca9e)=>{const _0x4d62d6='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x4d62d6,[],(_0x52ba7f,_0x86e065)=>{_0x52ba7f?_0x26ca9e({'status':'error','message':_0x52ba7f['message']}):_0x374ca4({'status':'success','contactedCount':_0x86e065['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x36f7ea,_0x5142c5)=>{const _0x3fd70d='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x3fd70d,[],(_0x203bf7,_0x36d1d7)=>{_0x203bf7?_0x5142c5({'status':'error','message':_0x203bf7['message']}):_0x36f7ea({'status':'success','contactedCount':_0x36d1d7['contactedCount']});});});});function exportDatabase(_0xd31cb8){return new Promise((_0xadbf7e,_0x542394)=>{const _0x5659d5='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0xd31cb8+'\x0a\x20\x20\x20\x20';db['all'](_0x5659d5,[],async(_0x506960,_0x30ffec)=>{if(_0x506960){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x506960['message']),_0x542394(_0x506960);return;}if(!_0x30ffec||_0x30ffec['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0xadbf7e();return;}const _0x4de919=XLSX['utils']['json_to_sheet'](_0x30ffec),_0x5a4abf=XLSX['utils']['sheet_to_csv'](_0x4de919);try{const {canceled:_0x53b455,filePath:_0xc1f25b}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0xd31cb8+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x53b455||!_0xc1f25b){console['log']('Speichern\x20abgebrochen.'),_0xadbf7e();return;}fs['writeFile'](_0xc1f25b,_0x5a4abf,'utf8',_0x50f5a7=>{_0x50f5a7?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x50f5a7['message']),_0x542394(_0x50f5a7)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0xc1f25b),_0xadbf7e());});}catch(_0x98fc3f){console['error']('Fehler\x20im\x20Speicherdialog:',_0x98fc3f),_0x542394(_0x98fc3f);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x1b82c3,_0x22a09c)=>{shell['openExternal'](_0x22a09c);});