const {app,BrowserWindow,ipcMain,dialog}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),ANZAHL_FOLLOWER_BUTTON='div.x9f619.x1n2onr6\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xnkg4db.xwsalez.x13ywhbb.x1dbek64.x1n2onr6.xzkaem6\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x7r02ix.xf1ldfh.x131esax.xdajt7p.xxfnqb6.xb88tzc.xw2csxc.x1odjw0f.x5fp0pe\x20>\x20div\x20>\x20div\x20>\x20div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',LIKERS_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_NEW_MSG_BUTTON='div.x1i10hfl.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.x6s0dn4.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x1ypdohk.x78zum5.xl56j7k.x1y1aw1k.x1sxyh0.xwib8y2.xurb0ha.xcdnw81',K_SEARCH_BAR_INPUT='body\x20>\x20div.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x1k90msu.x6o7n8i.x1qfuztq.x10l6tqk.x17qophe.x13vifvy.x1hc1fzr.x71s49j.xh8yej3\x20>\x20div\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.x1q0g3np.x1a02dak.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20input',K_USERNAME_SPALTE_PART1='body\x20>\x20div.xnkg4db.xwsalez.x13ywhbb.x1dbek64.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x1k90msu.x6o7n8i.x1qfuztq.x17qophe.x10l6tqk.x13vifvy.x1hc1fzr.x71s49j.xh8yej3\x20>\x20div\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x6ikm8r.x1rife3k.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div:nth-child(',K_USERNAME_SPALTE_PART2=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1pi30zi.x1swvt13.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',K_CHAT_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.x972fbf.xcfux6l.x1qhh985.xm0m39n.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.xexx8yu.x18d9i69.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1lq5wgf.xgqcy7u.x30kzoy.x9jhf4c.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x9bdzbf.x1ypdohk.x78zum5.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x1n2onr6.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xn3w4p2.x5ib6vp.xc73u3c.x1tu34mt.xzloghq',K_NACHRICHT_SCHREIBEN_INPUT_DIV='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1i64zmx.xw3qccf.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f.notranslate',K_SENDEN_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.xfs2ol5[role=\x22button\x22][tabindex=\x220\x22]';function createWindow(){const _0x1ab18e=new BrowserWindow({'width':0x320,'height':0x258,'webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x1ab18e['loadFile'](path['join'](__dirname,'index.html'));}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x2bdfaa){var _0x47d91d=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x59ee48){console['log']('window\x20id:'+_0x59ee48['id']),_0x59ee48['id']>0x1&&(_0x47d91d=!![]);}),console['log']('child\x20opened\x20='+_0x47d91d);if(!_0x47d91d){const _0x7f851b=new BrowserWindow({'width':0x320,'height':0x258,'webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x7f851b['loadFile'](_0x2bdfaa['url']);}else console['log']('child\x20window\x20opened\x20already');}let browser=null,page=null,isStopping=![];async function getBrowserPage(){let _0x1485f5='';if(process['platform']==='darwin')_0x1485f5='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome';else{if(process['platform']==='win32')_0x1485f5='chromium_local/chrome-win/chrome.exe';else{if(process['platform']==='linux'){}}}return(browser===null||page['isClosed']())&&(browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0x1485f5})),(page===null||page['isClosed']())&&(page=await browser['newPage'](),page['setDefaultNavigationTimeout'](0x1d4c),page['setDefaultTimeout'](0x1d4c)),page;}ipcMain['on']('login',async(_0x5c4eed,_0x1ebe6e,_0x470538)=>{const _0x1e5f6f=await getBrowserPage();await _0x1e5f6f['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x1e5f6f,_0x1ebe6e,_0x470538),setTimeout(async()=>{await browser['close']();},0x1388);}),ipcMain['handle']('sendMessage',async(_0x48bd74,_0x5e4369,_0x488d57,_0x2577e0,_0x4f0735)=>{isStopping=![];const _0x13fb53=await getBrowserPage();return console['log']('send\x20Message\x20gestartet'),console['log'](_0x5e4369),new Promise((_0x59ec9a,_0x434d27)=>{send_message(_0x13fb53,_0x5e4369,_0x488d57,_0x2577e0,_0x4f0735)['then'](_0x4ccf86=>_0x59ec9a(_0x4ccf86))['catch'](_0x43693d=>_0x434d27(_0x43693d));});}),ipcMain['handle']('stop-action',async _0x415d8f=>{isStopping=!![];const _0x5ac4a9=await getBrowserPage();await _0x5ac4a9['close']();}),ipcMain['handle']('fetch_followers',async(_0x1ffc9c,_0x36df28,_0x3cddc8,_0x3e4b5d,_0x2349b9)=>{isStopping=![];const _0x4b8f4e=await getBrowserPage();return fetch_followers_from_account(_0x4b8f4e,_0x36df28,_0x3cddc8,_0x3e4b5d,_0x2349b9);}),ipcMain['handle']('fetch_likes',async(_0x2d7dce,_0x33e7ac,_0x93e07a,_0x42d99e,_0x12b729)=>{isStopping=![];const _0x12d45e=await getBrowserPage();return fetch_likers_from_post(_0x12d45e,_0x33e7ac,_0x93e07a,_0x42d99e,_0x12b729);}),ipcMain['handle']('fetch_comments',async(_0xa37c39,_0xfd78c3,_0x2a5165,_0xdcb86f,_0x807522)=>{isStopping=![];const _0x143df4=await getBrowserPage();return fetch_comments_from_post(_0x143df4,_0xfd78c3,_0x2a5165,_0xdcb86f,_0x807522);}),ipcMain['handle']('update-app',async _0xa4df7=>{const {spawn:_0x55d051}=require('child_process'),_0x75de80=require('path');if(process['platform']==='darwin'){const _0x4b3034=_0x75de80['join'](__dirname,'mac-updater-intern.sh'),_0x5eaa58=_0x55d051('/bin/bash',[_0x4b3034]);_0x5eaa58['stdout']['on']('data',_0x16b5fb=>{console['log']('stdout:\x20'+_0x16b5fb);}),_0x5eaa58['stderr']['on']('data',_0x2111ca=>{console['error']('stderr:\x20'+_0x2111ca);}),_0x5eaa58['on']('close',_0x588509=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x588509);});}else{if(process['platform']==='win32'){const _0x597127=_0x75de80['join'](__dirname,'../','../','../');process['chdir'](_0x597127),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x33fa78='soft-ui-updater-windows.ps1',_0x5517a4='soft-ui-updater-windows.exe',_0x44ab99=_0x55d051('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x33fa78]);console['log']('Windows\x20Pfad:\x20'+_0x597127),_0x44ab99['stdout']['on']('data',_0xfb95d=>{console['log']('stdout:\x20'+_0xfb95d);}),_0x44ab99['stderr']['on']('data',_0x3a1a9f=>{console['error']('stderr:\x20'+_0x3a1a9f);}),_0x44ab99['on']('close',_0x3c8727=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x3c8727);});}}});function getRnd(_0x3c3dd1,_0x5c1ac5){return Math['random']()*(_0x5c1ac5-_0x3c3dd1+0x1)+_0x3c3dd1;}function delay(_0x1c319a,_0xb1e2d2){let _0xc0ee63=getRnd(_0x1c319a,_0xb1e2d2);return new Promise(function(_0x14fbc8){setTimeout(_0x14fbc8,_0xc0ee63);});}async function scroll(_0x52ff7d,_0x3293df,_0x131c4f=0x2){const _0x22ab4a=await _0x52ff7d['waitForSelector'](_0x3293df);for(let _0x1c306c=0x0;_0x1c306c<_0x131c4f;_0x1c306c++){console['log']('Scrolling\x20'+_0x1c306c),await _0x52ff7d['evaluate'](_0x19ad50=>{const _0x111aaa=document['querySelector'](_0x19ad50);_0x111aaa&&_0x111aaa['scrollBy'](0x0,0x190);},_0x3293df),await delay(0x320,0x5dc);}}async function saveCookies(_0x5eb818){let _0x40067b=await _0x5eb818['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x40067b,null,0x2));}async function notificationClear(_0x1badf4){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x1badf4['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x1badf4['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x246c49){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x246c49);}}async function getTargetProfiles(_0x38a10b){return new Promise((_0x1d58ef,_0xdf8538)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x38a10b,(_0x59f657,_0x205457)=>{_0x59f657?_0xdf8538(_0x59f657):_0x1d58ef(_0x205457);});});}async function login(_0x4f2de2,_0x1c2c2e,_0x329114){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x4f2de2,_0x1c2c2e),await createUserIfNotExists(_0x1c2c2e,_0x329114);}catch(_0x3f810c){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x3f810c);}try{await _0x4f2de2['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x4f2de2['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x4f2de2['click']('button._a9--._ap36._a9_0');}catch(_0x441cfe){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x4f2de2['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x4f2de2['type']('input[name=\x27username\x27]',_0x1c2c2e,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x4f2de2['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x4f2de2['type']('input[name=\x27password\x27]',_0x329114,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x4f2de2['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x4f2de2['click']('button[type=\x27submit\x27]');}catch(_0x3247cc){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x4f2de2),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x4f2de2,_0x1c2c2e);}catch(_0xfecf05){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0xfecf05);}}catch(_0x43710d){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x43710d);}}async function send_message(_0x4e4036,_0x3b026e,_0x5a1fae,_0x2eba53,_0x3d348f){console['log'](_0x3d348f),console['log']('Anfang'),console['log']('Counter:\x20'+_0x2eba53);if(_0x2eba53==0x0){try{console['log'](_0x3d348f),await login(_0x4e4036,_0x3d348f['username'],_0x3d348f['password']);}catch(_0xdb31a3){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0xdb31a3);return;}await _0x4e4036['goto']('https://www.instagram.com/direct/inbox/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x4e4036);}try{try{const _0x2ce0f1=K_NEW_MSG_BUTTON;await delay(0xfa0,0x1d4c),await _0x4e4036['waitForSelector'](_0x2ce0f1),await _0x4e4036['click'](_0x2ce0f1),console['log']('Message-Button\x20geklickt'),console['log'](_0x3b026e+'\x20'+_0x5a1fae),await delay(0xfa0,0x1d4c);try{const _0x2dbf3c='input[name=\x22queryBox\x22]',_0x246992=K_SEARCH_BAR_INPUT;await _0x4e4036['waitForSelector'](_0x246992),await _0x4e4036['click'](_0x246992),await delay(0xfa0,0x1d4c),await _0x4e4036['waitForSelector'](_0x2dbf3c),await _0x4e4036['click'](_0x2dbf3c),await delay(0xfa0,0x1d4c),await _0x4e4036['type'](_0x2dbf3c,_0x3b026e,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),console['log']('Account\x20Name\x20eingefügt');const _0x163cb1=K_USERNAME_SPALTE_PART1,_0x506411=K_USERNAME_SPALTE_PART2;let _0x1975f6=0x1;try{while(_0x1975f6!=0x14){console['log']('Schleife');let _0x70fc7=_0x163cb1+_0x1975f6+_0x506411;const _0x419722=await _0x4e4036['waitForSelector'](_0x70fc7),_0x113260=await _0x4e4036['evaluate'](_0x177d11=>_0x177d11['innerHTML'],_0x419722);console['log'](_0x113260+'\x20'+_0x3b026e),delay(0x3e8,0xbb8);if(_0x113260==_0x3b026e){console['log']('Account\x20gefunden'),await _0x4e4036['click'](_0x70fc7);break;}_0x1975f6++;}try{await delay(0xbb8,0x1388);const _0x33154d=await _0x4e4036['waitForSelector'](K_CHAT_BUTTON_DIV);console['log'](_0x33154d),await delay(0xbb8,0x1388),await _0x33154d['click']();try{await delay(0xbb8,0x1388);const _0x42d7b4=await _0x4e4036['waitForSelector'](K_NACHRICHT_SCHREIBEN_INPUT_DIV);await _0x42d7b4['type'](_0x5a1fae,{'delay':getRnd(0x50,0x78)}),await delay(0xbb8,0x1388);try{const _0x37c8f1=await _0x4e4036['waitForSelector'](K_SENDEN_BUTTON_DIV);return await _0x37c8f1['click'](),await delay(0xbb8,0x1388),new Promise(_0x37d13f=>{_0x37d13f('Nachricht\x20erfolgreich\x20verschickt!');});}catch(_0x4ea704){console['log']('Message-Button\x20nicht\x20geklickt:\x20'+_0x4ea704);}}catch(_0x3f77cc){console['log']('Chat-Fenster\x20nicht\x20gefunden:\x20'+_0x3f77cc);}}catch(_0x1564a3){console['log']('error:\x20'+_0x1564a3);}}catch(_0x99fe5e){console['log']('User\x20nicht\x20gefunden:'+_0x99fe5e);}}catch(_0x5e6762){console['log']('DM-Fenster\x20nicht\x20gefunden:'+_0x5e6762);}}catch(_0x57ba5e){console['log']('Message-Button\x20nicht\x20geklickt:'+_0x57ba5e);}}catch(_0x31e3be){console['log']('Nachricht\x20senden\x20fehlgeschlagen:\x20'+_0x31e3be);}return console['log']('Ende'),new Promise((_0x2a5869,_0x33882a)=>{_0x33882a('Fehler\x20beim\x20Anschreiben.\x20Lade\x20bitte\x20die\x20neuste\x20Version\x20herunter');});}function handle_fail(_0x2c0715){if(isStopping)return new Promise(_0x165ae6=>{_0x165ae6('Scraper\x20gestoppt.');});else{let _0x217097='';switch(_0x2c0715){case 0x0:_0x217097='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x217097='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x217097='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x217097='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x7abef2,_0x5bd139)=>{_0x5bd139(_0x217097);});}}async function fetch_followers_from_account(_0x3dbbe5,_0x2b10b3,_0x4bc6ad,_0x42a2f5,_0x4045f6){try{await login(_0x3dbbe5,_0x4045f6['username'],_0x4045f6['password']);}catch(_0x1c68d5){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x1c68d5),handle_fail(0x0);}let _0x3a70a5=0x0;try{await _0x3dbbe5['goto']('https://www.instagram.com/'+_0x2b10b3+'/'),await notificationClear(_0x3dbbe5);try{if(_0x4bc6ad<=0x0){const _0x51aa2d=await _0x3dbbe5['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0xe32dca=await _0x3dbbe5['evaluate'](_0x153cc8=>_0x153cc8['innerHTML'],_0x51aa2d);_0x3a70a5=Math['ceil'](_0xe32dca/0x4);}else _0x3a70a5=Math['ceil'](_0x4bc6ad/0x4);let _0x4105c3=await _0x3dbbe5['waitForSelector'](FOLLOWER_BUTTON);await delay(0xbb8,0x1388),await _0x4105c3['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x2b10b3+'\x20gesichtet');}catch(_0x517c4e){return console['log']('Follower\x20Liste\x20von\x20'+_0x2b10b3+'\x20nicht\x20gefunden:'+_0x517c4e),handle_fail(0x0);}}catch(_0x3c1d63){return console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x3c1d63),handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x3a70a5),await scroll(_0x3dbbe5,FOLLOWER_FENSTER,_0x3a70a5),await _0x3dbbe5['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x4329ea=await _0x3dbbe5['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY);_0x4bc6ad<=0x0&&(_0x4bc6ad=_0x4329ea['length']);for(let _0x3a3487=0x0;_0x3a3487<_0x4329ea['length']&&_0x3a3487<_0x4bc6ad;_0x3a3487++){console['log'](await _0x4329ea[_0x3a3487]['evaluate'](_0x5de10f=>_0x5de10f['textContent']));const _0x1bb8e8=await db['prepare']('INSERT\x20INTO\x20'+_0x42a2f5+'\x20(username)\x20VALUES\x20(?)');await _0x1bb8e8['run'](await _0x4329ea[_0x3a3487]['evaluate'](_0x525a7d=>_0x525a7d['textContent']),function(_0x324e99){_0x324e99&&console['log']('error\x20in\x20add-user:'+_0x324e99);}),await _0x1bb8e8['finalize']();}return new Promise(_0x22032e=>{_0x22032e('Scraping\x20finished!');});}catch(_0x55a6b4){return console['log']('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x2b10b3+'\x20nicht\x20gefunden:'+_0x55a6b4),handle_fail(0x0);}}async function fetch_likers_from_post(_0x9f0e26,_0x18786a,_0x5599e4,_0x283c5e,_0x16a08b){try{await login(_0x9f0e26,_0x16a08b['username'],_0x16a08b['password']);}catch(_0x520f1f){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x520f1f);return handle_fail(0x1);return;}try{let _0x2a3f07=_0x18786a['substring'](0x0,_0x18786a['lastIndexOf']('/')),_0x5e7068=_0x2a3f07+'/liked_by';console['log'](_0x5e7068),await _0x9f0e26['goto'](_0x5e7068),await delay(0x7d0,0xfa0),await notificationClear(_0x9f0e26),await delay(0xc8,0x1f4);let _0x4aad54=LIKERS_USERNAME_SPALTEN_ARRAY;await _0x9f0e26['waitForSelector'](_0x4aad54),await delay(0x1f4,0x320);const _0x26d558=await _0x9f0e26['$$'](_0x4aad54);await delay(0x1f4,0x320),console['log'](_0x26d558['length']);let _0x251d6a=path['join'](__dirname,'/likers.csv');_0x5599e4<=0x0&&(_0x5599e4=_0x26d558['length']);try{for(let _0x4b16b7=0x0;_0x4b16b7<_0x26d558['length']&&_0x4b16b7<_0x5599e4;_0x4b16b7++){console['log'](await _0x26d558[_0x4b16b7]['evaluate'](_0x248f56=>_0x248f56['textContent']));try{const _0x5c83b2=await db['prepare']('INSERT\x20INTO\x20'+_0x283c5e+'\x20(username)\x20VALUES\x20(?)');await _0x5c83b2['run'](await _0x26d558[_0x4b16b7]['evaluate'](_0x3fb4b4=>_0x3fb4b4['textContent']),function(_0x25c8e3){_0x25c8e3&&console['log']('error\x20in\x20add-user:'+_0x25c8e3);}),await _0x5c83b2['finalize']();}catch(_0x2a71b3){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x4b16b7+'\x20:\x20'+_0x2a71b3),handle_fail(0x1);}}return new Promise(_0x530d4f=>{_0x530d4f('Scraping\x20finished!');});}catch(_0x3d3a44){return console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben'),handle_fail(0x1);}}catch(_0x3669ee){return console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x3669ee),handle_fail(0x1);}}async function fetch_comments_from_post(_0xfb1b37,_0x54aeb6,_0x275f55,_0x35c398,_0x3eaddd){try{await login(_0xfb1b37,_0x3eaddd['username'],_0x3eaddd['password']);}catch(_0x2e0a02){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x2e0a02),handle_fail(0x2);}try{console['log'](_0x54aeb6),await _0xfb1b37['goto'](_0x54aeb6),await delay(0x7d0,0xfa0),await notificationClear(_0xfb1b37),await delay(0xc8,0x1f4);const _0x3921a0=COM_COMMENTS_BOX_BODY_DIV;let _0x6de355;if(_0x275f55<=0x0){const _0xf5fdfd=await _0xfb1b37['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x39edf1=await _0xfb1b37['evaluate'](_0xbf8356=>_0xbf8356['innerHTML'],_0xf5fdfd),_0x2baf9f=String(_0x39edf1)['replace'](/[^0-9]/g,''),_0xa144ba=Number(_0x2baf9f)/0x14;_0x6de355=Math['ceil'](_0xa144ba/0x3);}else _0x6de355=Math['ceil'](_0x275f55/0x3);console['log']('Auto-scrolls:\x20'+_0x6de355),await scroll(_0xfb1b37,_0x3921a0,_0x6de355);try{const _0x48e4ff=COM_REPLY_BUTTON_SPAN;await _0xfb1b37['waitForSelector'](_0x48e4ff),await delay(0x1f4,0x320);const _0x5c1294=await _0xfb1b37['$$'](_0x48e4ff);console['log'](_0x5c1294),await delay(0xc8,0x1f4);try{for(let _0x39d4e5=0x0;_0x39d4e5<_0x5c1294['length'];_0x39d4e5++){_0x5c1294[_0x39d4e5]['click'](),await delay(0x320,0x5dc);}}catch(_0x415adc){return console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x415adc),handle_fail(0x2);}}catch(_0x428ec0){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x366c69=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0xfb1b37['waitForSelector'](_0x366c69),await delay(0x1f4,0x320);const _0x57eaa7=await _0xfb1b37['$$'](_0x366c69);let _0x44a273=path['join'](__dirname,'/comments.csv');_0x275f55<=0x0&&(_0x275f55=_0x57eaa7['length']);console['log']('fetch_limit:\x20'+_0x275f55),console['log']('comments_len:\x20'+_0x57eaa7['length']),_0x275f55++;try{for(let _0x2a1dd2=0x1;_0x2a1dd2<_0x57eaa7['length']&&_0x2a1dd2<_0x275f55;_0x2a1dd2++){try{console['log'](await _0x57eaa7[_0x2a1dd2]['evaluate'](_0x1977d2=>_0x1977d2['textContent']));const _0x2606c7=await db['prepare']('INSERT\x20INTO\x20'+_0x35c398+'\x20(username)\x20VALUES\x20(?)');await _0x2606c7['run'](await _0x57eaa7[_0x2a1dd2]['evaluate'](_0x431f24=>_0x431f24['textContent']),function(_0x17a36e){_0x17a36e&&console['log']('error\x20in\x20add-user:'+_0x17a36e);}),await _0x2606c7['finalize']();}catch(_0x59326f){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x2a1dd2+'\x20:\x20'+_0x59326f),handle_fail(0x2);}}return new Promise(_0xf91630=>{_0xf91630('Scraping\x20finished!');});}catch(_0x3d1c0b){return console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben'),handle_fail(0x2);}}catch(_0x45aab7){return console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x45aab7),handle_fail(0x2);}}const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20password\x20TEXT,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x1dc91c,_0x4c8832){try{const _0x54c304=await new Promise((_0x1e19c2,_0x6e55e9)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x4c8832],(_0x4fe521,_0x3804f8)=>{if(_0x4fe521)_0x6e55e9(_0x4fe521);else{if(_0x3804f8['length']>0x0){let _0x90a601=JSON['parse'](_0x3804f8[0x0]['cookie']);console['log'](_0x90a601),_0x1e19c2(_0x90a601);}else _0x6e55e9(new Error('User\x20with\x20username\x20'+_0x4c8832+'\x20does\x20not\x20exist.'));}});});await _0x1dc91c['setCookie'](..._0x54c304),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x3770e2){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x3770e2);}}async function saveCookiesForUser(_0x1430d7,_0x6cb2e9){try{let _0x20cc99=await _0x1430d7['cookies']();_0x20cc99=JSON['stringify'](_0x20cc99),igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x6cb2e9],(_0x2083d7,_0x552f71)=>{if(_0x2083d7){console['error']('Error\x20checking\x20user\x20existence:',_0x2083d7);throw _0x2083d7;}else{if(_0x552f71){const _0x180a99=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x180a99['run'](_0x20cc99,_0x6cb2e9,function(_0x5a6985){_0x5a6985?console['error']('Error\x20updating\x20cookies:',_0x5a6985):console['log']('Cookies\x20updated\x20for\x20user:',_0x6cb2e9);});}else{const _0x15789a=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x15789a['run'](_0x6cb2e9,_0x20cc99,function(_0x242d4a){_0x242d4a?console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x242d4a):console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x6cb2e9);});}}});}catch(_0x4a03d1){console['error']('Error\x20fetching\x20cookies:',_0x4a03d1);throw _0x4a03d1;}}async function createUserIfNotExists(_0x4d6783,_0x47f957){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x4d6783],(_0x4fcf20,_0x40d09f)=>{if(_0x4fcf20){console['error']('Error\x20checking\x20user\x20existence:',_0x4fcf20);throw _0x4fcf20;}else{if(!_0x40d09f){const _0x22302e=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20password)\x20VALUES\x20(?,\x20?)');_0x22302e['run'](_0x4d6783,_0x47f957,function(_0x1fee96){_0x1fee96?console['error']('Error\x20inserting\x20new\x20user:',_0x1fee96):console['log']('New\x20user\x20created:',_0x4d6783);});}else console['log']('User\x20already\x20exists:',_0x4d6783);}});}catch(_0x3bbb26){console['error']('Error\x20creating\x20user:',_0x3bbb26);throw _0x3bbb26;}}ipcMain['handle']('create-relation',async(_0x1f7a77,_0x35f39a)=>{return new Promise((_0x3bd1ec,_0x5c3d54)=>{const _0x3c263c='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x35f39a+'\x20(username\x20TEXT\x20PRIMARY\x20KEY)';db['run'](_0x3c263c,function(_0x241c18){_0x241c18?_0x5c3d54(_0x241c18):_0x3bd1ec({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x140eb2,_0x599872)=>{return console['log']('droping\x20table'+_0x599872),new Promise((_0x11bc85,_0x2135b6)=>{const _0x341cbb='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x599872;console['log']('droping\x20table'+_0x599872),db['run'](_0x341cbb,function(_0xae004c){_0xae004c?_0x2135b6(_0xae004c):_0x11bc85({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0xf4d6e1=>{return new Promise((_0x27633b,_0x30e8f4)=>{const _0x30bd76='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x30bd76,[],(_0x42c8b9,_0x5d5415)=>{_0x42c8b9?_0x30e8f4(_0x42c8b9):_0x27633b(_0x5d5415['map'](_0x1b0858=>_0x1b0858['name']));});});}),ipcMain['handle']('add-user',async(_0x5acc56,_0x4304f9,_0xdabaf3)=>{return new Promise(_0x25ab2e=>{const _0x3e2645=db['prepare']('INSERT\x20INTO\x20'+_0xdabaf3+'\x20(username)\x20VALUES\x20(?)');_0x3e2645['run'](_0x4304f9,function(_0x475e47){_0x475e47?console['log']('error\x20in\x20add-user:'+_0x475e47):_0x25ab2e({'status':'success','id':this['lastID']});}),_0x3e2645['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x312d83,_0x3cbced)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x68fd5f,_0x561ab6)=>{if(_0x68fd5f)_0x3cbced(_0x68fd5f);else{_0x312d83({'status':'success','users':_0x561ab6});for(_0x561ab6 of _0x561ab6){console['log'](_0x561ab6['username']);}}});});}),ipcMain['handle']('get-data',async(_0x3414d6,_0x165e6a)=>{return new Promise((_0x179674,_0x5d4427)=>{const _0x185c0e='SELECT\x20*\x20FROM\x20'+_0x165e6a;console['log'](_0x185c0e),db['all'](_0x185c0e,[],(_0x2210fa,_0xa1b78)=>{_0x2210fa?_0x5d4427(_0x2210fa):_0x179674(_0xa1b78);});});}),ipcMain['handle']('get-accounts',async _0x212db9=>{return new Promise((_0x1de3e6,_0x32a578)=>{const _0x4b6567='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x4b6567),igaccountsDB['all'](_0x4b6567,[],(_0x41db8e,_0x52dca5)=>{_0x41db8e?_0x32a578(_0x41db8e):_0x1de3e6(_0x52dca5);});});}),ipcMain['handle']('get-targets',async(_0x477006,_0x1ef5e6)=>{return getTargetProfiles(_0x1ef5e6);}),ipcMain['handle']('delete-user',async(_0xd9b347,_0x1bd486,_0x4684bb)=>{return new Promise((_0x3e65d9,_0x4c02ab)=>{const _0x5b2ff3=db['prepare']('DELETE\x20FROM\x20'+_0x4684bb+'\x20WHERE\x20username\x20=\x20?');_0x5b2ff3['run'](_0x1bd486,function(_0x3ade69){_0x3ade69?_0x4c02ab(_0x3ade69):_0x3e65d9({'status':'success','changes':this['changes']});}),_0x5b2ff3['finalize']();});}),ipcMain['handle']('delete-account',async(_0x426369,_0x5cf0df)=>{const _0x519c02=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x519c02['run'](_0x5cf0df,function(_0x18b742){_0x18b742&&console['log'](_0x18b742);}),_0x519c02['finalize']();});