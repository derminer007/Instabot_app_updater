const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');function quoteIdent(_0x50cf29){if(_0x50cf29===undefined||_0x50cf29===null)throw new Error('Invalid\x20identifier');const _0x21d67d=String(_0x50cf29),_0x5bbc59=_0x21d67d['replace'](/"/g,'\x22\x22');return'\x22'+_0x5bbc59+'\x22';}async function extractFirstName(_0x29ee5b,_0x3fdd72){try{const _0x53dee8=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x3fdd72},'body':JSON['stringify']({'clearname':_0x29ee5b})});if(!_0x53dee8['ok']){const _0x887e9c=await _0x53dee8['text']();throw new Error(_0x53dee8['status']+':\x20'+_0x887e9c);}const _0x290b69=await _0x53dee8['json']();return _0x290b69;}catch(_0x50cbde){console['error']('Error\x20in\x20extractFirstName:',_0x50cbde);throw _0x50cbde;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div:has(>\x20div[style=\x22height:\x20auto;\x20overflow:\x20hidden\x20auto;\x22])',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='[style=\x22line-height:\x2018px;\x22]',COM_COMMENTS_BOX_BODY_DIV='div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='//span[contains(.,\x20\x27View\x20all\x27)\x20and\x20contains(.,\x20\x27replies\x27)]',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Message\x27]','div.x9f619.xjbqb8w.x78zum5.x15mokao.x1ga7v0g.x16uus16.xbiv7yw.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div','div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div'],K_OPTIONS_BUTTON=['[aria-label=\x22Options\x22]','section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.x1jfgfrl\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div'],K_EXPAND_MSG_BUTTON='[aria-label=\x22Expand\x22]',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD=['[aria-label=\x22Message\x22]','div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f'],K_SEND_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Send\x27]','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_ALREADY_CHATTED='[aria-label=\x22Like\x22]',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',K_BEITRAG_ARRAY_SELECTOR='._aagv',K_BEITRAG_LIKE_BUTTON='section\x20>\x20span\x20>\x20div\x20>\x20div',K_STORY_ARRAY_SELECTOR='._acaz',K_STORY_LIKE_BUTTON='div.x6s0dn4.x78zum5.x67bb7w\x20>\x20div.x78zum5.xvc5jky\x20>\x20span\x20>\x20div\x20>\x20div',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x1a7fc2=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x1a7fc2['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x1a7fc2['webContents']['openDevTools']();}app['whenReady']()['then'](async()=>{try{await initOptionsDb(),console['log']('[OptionsDB]\x20initialisiert:',path['join'](SqlDataDirectory,'options.db'));}catch(_0x4cb279){console['error']('[OptionsDB]\x20Initialisierung\x20fehlgeschlagen:',_0x4cb279);}})['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x4d2f92){var _0x115986=![];BrowserWindow['getAllWindows']()['forEach'](function(_0xda2b27){console['log']('window\x20id:'+_0xda2b27['id']),_0xda2b27['id']>0x1&&(_0x115986=!![]);}),console['log']('child\x20opened\x20='+_0x115986);if(!_0x115986){const _0x36ceb7=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x36ceb7['loadFile'](_0x4d2f92['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));try{optionsDb&&(optionsDb['close'](),optionsDb=null,console['log']('[OptionsDB]\x20geschlossen.'));}catch(_0x49d30e){console['warn']('[OptionsDB]\x20Fehler\x20beim\x20Schließen:',_0x49d30e?.['message']||_0x49d30e);}if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x32a493=require('fs'),_0x124d1a=path['join'](app['getPath']('userData'),'data'),_0x5e9e39=['campaign.db','crm.db','igaccounts.db'],_0x376801=[];try{_0x32a493['mkdirSync'](_0x124d1a,{'recursive':!![]});for(const _0x46804c of _0x5e9e39){const _0x43403a=path['join'](process['resourcesPath'],'app','build','data',_0x46804c),_0x41651e=path['join'](_0x124d1a,_0x46804c);!_0x32a493['existsSync'](_0x41651e)?(_0x32a493['copyFileSync'](_0x43403a,_0x41651e),console['log']('[InitDB]\x20Kopiert\x20'+_0x46804c+'\x20nach:\x20'+_0x41651e)):console['log']('[InitDB]\x20'+_0x46804c+'\x20existiert\x20bereits:\x20'+_0x41651e),_0x376801['push'](_0x41651e);}}catch(_0x358529){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x358529);}return _0x376801;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x3006c7,AppUpdate:_0x1b5f9c}=require('electron-updater');_0x3006c7['autoDownload']=![],_0x3006c7['autoInstallOnAppQuit']=!![],_0x3006c7['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x3006c7['on']('update-available',_0x12abab=>{console['log']('Update\x20verfügbar:',_0x12abab),_0x3006c7['downloadUpdate']();}),_0x3006c7['on']('update-downloaded',_0x48ded6=>{console['log']('Update\x20heruntergeladen:',_0x48ded6),_0x3006c7['quitAndInstall']();}),_0x3006c7['on']('error',_0x1f75c6=>{console['error']('Fehler\x20beim\x20Updaten:',_0x1f75c6);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0xb7d7b5,AppUpdate:_0x480554}=require('electron-updater');_0xb7d7b5['autoDownload']=![],_0xb7d7b5['autoInstallOnAppQuit']=!![],_0xb7d7b5['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0xb7d7b5['on']('update-available',_0x50a11f=>{console['log']('Update\x20verfügbar:',_0x50a11f),_0xb7d7b5['downloadUpdate']();}),_0xb7d7b5['on']('update-downloaded',_0x4dd874=>{console['log']('Update\x20heruntergeladen:',_0x4dd874),console['log']('Neustarten\x20zum\x20Updaten');}),_0xb7d7b5['on']('error',_0x4cf574=>{console['error']('Fehler\x20beim\x20Updaten:',_0x4cf574);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let optionsDb,optionsDbPath;function ensureDirSync(_0x531268){try{fs_no_promise['mkdirSync'](_0x531268,{'recursive':!![]});}catch(_0x128ecd){}}function initOptionsDb(){return new Promise((_0x599478,_0x3d1a62)=>{try{ensureDirSync(SqlDataDirectory),optionsDbPath=path['join'](SqlDataDirectory,'options.db'),optionsDb=new sqlite3['Database'](optionsDbPath,_0x1c891f=>{if(_0x1c891f)return _0x3d1a62(_0x1c891f);optionsDb['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20options\x20(key\x20TEXT\x20PRIMARY\x20KEY,\x20value\x20TEXT\x20NOT\x20NULL)',_0x486455=>{if(_0x486455)return _0x3d1a62(_0x486455);optionsDb['run']('INSERT\x20OR\x20IGNORE\x20INTO\x20options\x20(key,\x20value)\x20VALUES\x20(?,\x20?)',['isHeadless','1'],_0x3a9dbd=>{if(_0x3a9dbd)return _0x3d1a62(_0x3a9dbd);_0x599478();});});});}catch(_0x26d581){_0x3d1a62(_0x26d581);}});}function setOption(_0x5c170c,_0x53774a){return new Promise((_0x2f41fc,_0x5f4712)=>{if(!optionsDb)return _0x5f4712(new Error('Options-DB\x20nicht\x20initialisiert'));optionsDb['run']('INSERT\x20INTO\x20options\x20(key,\x20value)\x20VALUES\x20(?,\x20?)\x20ON\x20CONFLICT(key)\x20DO\x20UPDATE\x20SET\x20value\x20=\x20excluded.value',[_0x5c170c,String(_0x53774a)],_0x1b5b0f=>{if(_0x1b5b0f)return _0x5f4712(_0x1b5b0f);_0x2f41fc();});});}function getOption(_0x3c5ca5){return new Promise((_0x31a2e3,_0x201f88)=>{if(!optionsDb)return _0x201f88(new Error('Options-DB\x20nicht\x20initialisiert'));optionsDb['get']('SELECT\x20value\x20FROM\x20options\x20WHERE\x20key\x20=\x20?',[_0x3c5ca5],(_0x13124c,_0x880814)=>{if(_0x13124c)return _0x201f88(_0x13124c);_0x31a2e3(_0x880814?_0x880814['value']:null);});});}async function getIsHeadless(){try{const _0x3f0426=await getOption('isHeadless');if(_0x3f0426===null||_0x3f0426===undefined)return!![];if(_0x3f0426==='1'||_0x3f0426==='true'||_0x3f0426===!![])return!![];if(_0x3f0426==='0'||_0x3f0426==='false'||_0x3f0426===![])return![];return console['log']('[OptionsDB]\x20getIsHeadless\x20unerwarteter\x20Wert:',_0x3f0426),Boolean(_0x3f0426);}catch(_0x407dc7){return console['warn']('[OptionsDB]\x20getIsHeadless\x20Fehler,\x20fallback=true:',_0x407dc7?.['message']||_0x407dc7),!![];}}let browser_login=null;async function getBrowserPageLogin(){let _0x321f5a='',_0x5510b7=null;if(process['platform']==='darwin')_0x321f5a=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x321f5a=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':await getIsHeadless(),'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x321f5a}),_0x5510b7=await browser_login['newPage'](),_0x5510b7['setDefaultNavigationTimeout'](0x3a98),_0x5510b7['setDefaultTimeout'](0x3a98),await _0x5510b7['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x5510b7;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x108681=0x1,_0xc252c=0x0){try{let _0x420d42='',_0x2842e4=null;const _0x1d0e1b=await getIsHeadless();if(process['platform']==='darwin')_0x420d42=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x420d42=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x108681===0x0&&!pageStack[_0xc252c])return browser=await puppeteer['launch']({'headless':_0x1d0e1b,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x420d42}),_0x2842e4=await browser['newPage'](),_0x2842e4['setDefaultNavigationTimeout'](0x3a98),_0x2842e4['setDefaultTimeout'](0x3a98),await _0x2842e4['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0xc252c]=_0x2842e4,_0x2842e4;return(browser===null||pageStack[_0xc252c]===null||pageStack[_0xc252c]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x1d0e1b,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x420d42})),(pageStack[_0xc252c]===null||pageStack[_0xc252c]['isClosed']())&&(_0x2842e4=await browser['newPage'](),_0x2842e4['setDefaultNavigationTimeout'](0x3a98),_0x2842e4['setDefaultTimeout'](0x3a98),await _0x2842e4['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0xc252c]=_0x2842e4),pageStack[_0xc252c];}catch(_0x2f9431){console['error']('Failed\x20to\x20launch\x20browser:',_0x2f9431);const _0x54f731=new Error('Browser\x20konnte\x20nicht\x20gestartet\x20werden.\x20Bitte\x20starte\x20die\x20App\x20neu.\x20:\x20'+_0x2f9431);throw _0x54f731;}}ipcMain['on']('login',async(_0x19c6bb,_0x149c64)=>{const _0x1954ca=await getBrowserPageLogin();await _0x1954ca['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x1954ca,_0x149c64),ipcMain['on']('setLoginCookies',async(_0x46be37,_0x435cce)=>{try{await set_login_cookies(_0x1954ca,_0x435cce);}catch(_0x14d5ee){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x14d5ee);}});}),ipcMain['handle']('set-headless',async(_0x58718d,_0x5ee5b0)=>{const _0x3497d4=!!_0x5ee5b0;if(!optionsDb)try{await initOptionsDb();}catch(_0x28573a){console['error']('[OptionsDB]\x20Init\x20on\x20set-headless\x20fehlgeschlagen:',_0x28573a);}return await setOption('isHeadless',_0x3497d4?'1':'0'),console['log']('[MAIN]\x20isHeadless\x20gesetzt\x20(DB)\x20auf:',_0x3497d4),{'ok':!![],'headless':_0x3497d4};}),ipcMain['handle']('get-headless',async()=>{const _0x588c83=await getIsHeadless();return{'headless':_0x588c83};}),ipcMain['on']('export-relation',async(_0xd7c673,_0x639fc8)=>{try{await exportDatabase(_0x639fc8),_0xd7c673['reply']('export-relation-response',{'success':!![]});}catch(_0x3ae4a4){console['error'](_0x3ae4a4),_0xd7c673['reply']('export-relation-response',{'success':![],'message':_0x3ae4a4['message']});}}),ipcMain['handle']('sendMessage',async(_0x13ca26,_0x222818,_0x135de1,_0x401586,_0xf98064,_0x1bf1a8,_0x14abd4,_0x27b065,_0x287866,_0x5dd984,_0x20be14,_0x16fe40,_0x3db724)=>{isStopping=![];let _0x271c25=null;return _0x14abd4?_0x271c25=await getBrowserPage(_0xf98064,_0x27b065):_0x271c25=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x222818),send_message(_0x271c25,_0x222818,_0x135de1,_0x401586,_0xf98064,_0x1bf1a8,_0x287866,_0x5dd984,_0x20be14,_0x16fe40,_0x3db724);}),ipcMain['handle']('stop-action',async(_0x409ed3,_0x43be39)=>{isStopping=!![];const _0x12d5a4=await getBrowserPage(0x1,_0x43be39);await _0x12d5a4['close']();}),ipcMain['handle']('fetch_followers',async(_0x24a58c,_0x3a64de,_0x83a371,_0x814dea,_0xdeea62,_0x3eb6c1,_0x579784)=>{isStopping=![];const _0x280045=await getBrowserPage();return fetch_followers_from_account(_0x24a58c,_0x280045,_0x3a64de,_0x83a371,_0x814dea,_0xdeea62,_0x3eb6c1,_0x579784);}),ipcMain['handle']('get-account-details',async(_0x436f06,_0x1a5526,_0x27515d,_0x1af742)=>{isStopping=![];const _0x56c347=await getBrowserPage();return fetch_account_details(_0x56c347,_0x1a5526,_0x27515d,_0x1af742);}),ipcMain['handle']('fetch_likes',async(_0x556965,_0x5075bb,_0x264464,_0x691472,_0x4905f3,_0x170d5c,_0x137a85)=>{isStopping=![];const _0x4d082b=await getBrowserPage();return fetch_likers_from_post(_0x556965,_0x4d082b,_0x5075bb,_0x264464,_0x691472,_0x4905f3,_0x170d5c,_0x137a85);}),ipcMain['handle']('fetch_comments',async(_0x1f3881,_0x240e20,_0x572d44,_0x3e1ba6,_0x3e7f92,_0x48d8b7,_0x1dd4b2)=>{isStopping=![];const _0x2f00a3=await getBrowserPage();return fetch_comments_from_post(_0x1f3881,_0x2f00a3,_0x240e20,_0x572d44,_0x3e1ba6,_0x3e7f92,_0x48d8b7,_0x1dd4b2);});async function updateAppSilent(){const {spawn:_0xc3e05b}=require('child_process'),_0x5166f7=require('path'),_0x27fb71=require('electron-log');return _0x27fb71['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x4465a5,_0xc11b52)=>{const {updateElectronApp:_0x28a03a,UpdateSourceType:_0x50923a}=require('update-electron-app');_0x28a03a({'updateSource':{'type':_0x50923a['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x27fb71}),_0x4465a5('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x38ceb,_0x55035c)=>{doFullElectronUpdateSilent(),_0x38ceb('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x3a4e89}=require('child_process'),_0x498edc=require('path'),_0x3e08a7=require('electron-log');return _0x3e08a7['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x5edf2e,_0x3b288a)=>{const {updateElectronApp:_0x26f0da,UpdateSourceType:_0x46b8cd}=require('update-electron-app');_0x26f0da({'updateSource':{'type':_0x46b8cd['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x3e08a7}),_0x5edf2e('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x5a3573,_0x319724)=>{doFullElectronUpdate(),_0x5a3573('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0x299af9,_0xe85bbf)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x299af9('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x3fdf60=path['join'](__dirname,'mac-updater-intern.sh'),_0x369c27=spawn('/bin/bash',[_0x3fdf60],{'detached':!![],'stdio':'ignore'});_0x369c27['unref'](),setTimeout(()=>{_0x299af9('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0xe85bbf(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0x245b2d=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x314bf3,_0x945698)=>{console['log']('Update\x20Silent:\x20'+_0x945698);if(_0x945698){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0x56db75,_0x1f330a){return Math['random']()*(_0x1f330a-_0x56db75+0x1)+_0x56db75;}function delay(_0xc29090,_0x30f7d2){let _0x2e4775=getRnd(_0xc29090,_0x30f7d2);return new Promise(function(_0x4c0d58){setTimeout(_0x4c0d58,_0x2e4775);});}async function scroll(_0x38a12f,_0x152e3d,_0x37bf6a=0x2,_0x21e9ee){const _0x5156d3=await _0x38a12f['waitForSelector'](_0x152e3d);for(let _0x4fbb00=0x0;_0x4fbb00<_0x37bf6a;_0x4fbb00++){console['log']('Scrolling\x20'+_0x4fbb00),await _0x38a12f['evaluate'](_0x92c29a=>{const _0x3dd18f=document['querySelector'](_0x92c29a);_0x3dd18f&&_0x3dd18f['scrollBy'](0x0,0x190);},_0x152e3d),await delay(0x320,0x5dc),_0x21e9ee();}}async function saveCookies(_0x473871){let _0x5a3441=await _0x473871['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x5a3441,null,0x2));}async function notificationClear(_0x43c60d){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xfa0,0x1388),await _0x43c60d['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x43c60d['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x3012eb){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x3012eb);}}async function getTargetProfiles(_0x3e906c){return new Promise((_0x5e4204,_0x3e4ed0)=>{const _0x3353d5=quoteIdent(_0x3e906c);db['all']('SELECT\x20*\x20FROM\x20'+_0x3353d5,(_0x29600a,_0x5a7251)=>{_0x29600a?_0x3e4ed0(_0x29600a):_0x5e4204(_0x5a7251);});});}async function login_legacy(_0x20c4ba,_0xd19046,_0x1dc0bd){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x20c4ba,_0xd19046),await createUserIfNotExists(_0xd19046,_0x1dc0bd);}catch(_0x8092a3){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x8092a3);}try{await _0x20c4ba['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x20c4ba['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x20c4ba['click']('button._a9--._ap36._a9_0');}catch(_0x15bda4){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x20c4ba['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x20c4ba['type']('input[name=\x27username\x27]',_0xd19046,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x20c4ba['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x20c4ba['type']('input[name=\x27password\x27]',_0x1dc0bd,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x20c4ba['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x20c4ba['click']('button[type=\x27submit\x27]');}catch(_0x5dcac3){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x20c4ba),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x20c4ba,_0xd19046);}catch(_0x3d2502){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x3d2502);}}catch(_0x3cf796){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x3cf796);}}async function login(_0x34c6c0,_0x53affb){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x34c6c0,_0x53affb),await createUserIfNotExists(_0x53affb);}catch(_0x5da4b7){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5da4b7);}try{await _0x34c6c0['goto']('https://www.instagram.com/accounts/login/');}catch(_0x19a560){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x19a560);}}async function set_login_cookies(_0x5c2685,_0x18ba66){try{await saveCookiesForUser(_0x5c2685,_0x18ba66);}catch(_0x29f481){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x29f481);}}async function waitForXPath(_0x484233,_0x48bd11,_0x5965a5={}){return await _0x484233['waitForFunction'](_0x522c97=>{return document['evaluate'](_0x522c97,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x5965a5,_0x48bd11),_0x484233['evaluateHandle'](_0x5d0ffb=>document['evaluate'](_0x5d0ffb,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x48bd11);}async function waitForSelectorWithFallbacks(_0x393ea9,_0x24cd02,_0x6b11c4={}){!Array['isArray'](_0x24cd02)&&(_0x24cd02=[_0x24cd02]);for(let _0x189f2b=0x0;_0x189f2b<_0x24cd02['length'];_0x189f2b++){const _0x295ad1=_0x24cd02[_0x189f2b],_0x3eea74=_0x295ad1['startsWith']('//')||_0x295ad1['startsWith']('(//');try{console['log']('Versuche\x20'+(_0x3eea74?'XPath':'Selector')+'\x20'+(_0x189f2b+0x1)+'/'+_0x24cd02['length']+':\x20'+_0x295ad1['substring'](0x0,0x32)+'...');const _0x235912=_0x189f2b===0x0?_0x6b11c4['timeout']||0x1388:0x7d0;let _0x1ae836;if(_0x3eea74){const _0x10fe54=await waitForXPath(_0x393ea9,_0x295ad1,{..._0x6b11c4,'timeout':_0x235912});if(!_0x10fe54)throw new Error('XPath-Element\x20nicht\x20gefunden');_0x1ae836=_0x10fe54;}else _0x1ae836=await _0x393ea9['waitForSelector'](_0x295ad1,{..._0x6b11c4,'timeout':_0x235912});return console['log']((_0x3eea74?'XPath':'Selector')+'\x20'+(_0x189f2b+0x1)+'\x20gefunden!'),_0x1ae836;}catch(_0x24b5a3){console['log']((_0x3eea74?'XPath':'Selector')+'\x20'+(_0x189f2b+0x1)+'\x20nicht\x20gefunden:\x20'+_0x24b5a3['message']);if(_0x189f2b===_0x24cd02['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x24cd02['length']+'\x20Selektoren/XPath\x20konnte\x20gefunden\x20werden:\x20'+_0x24b5a3['message']);}}throw new Error('Keine\x20Selektoren/XPath\x20angegeben');}async function waitForXPathAll(_0x5e79cc,_0x314e79,_0x564317={}){return await _0x5e79cc['waitForFunction'](_0x1e21a9=>{return document['evaluate'](_0x1e21a9,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null)['snapshotLength']>0x0;},_0x564317,_0x314e79),_0x5e79cc['evaluateHandle'](_0x2986e5=>{const _0x1344c9=document['evaluate'](_0x2986e5,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null),_0x23ea3a=[];for(let _0x498e35=0x0;_0x498e35<_0x1344c9['snapshotLength'];_0x498e35++){_0x23ea3a['push'](_0x1344c9['snapshotItem'](_0x498e35));}return _0x23ea3a;},_0x314e79)['then'](_0x51135=>_0x51135['getProperties']());}ipcMain['handle']('check-login',async(_0x215c75,_0x109b68)=>{if(pageStack[0x0]){try{await pageStack[0x0]['close']();}catch(_0x441716){}pageStack[0x0]=null;}if(browser){try{await browser['close']();}catch(_0x42ac5c){}browser=null;}const _0x3a5cf0=await getBrowserPage(0x0,0x0),_0xbc9a0c=await checkCookiesSession(_0x3a5cf0,_0x109b68);return _0xbc9a0c;});async function checkCookiesSession(_0x4fcc9b,_0x4c91bc){try{await setCookiesForUser(_0x4fcc9b,_0x4c91bc),console['log']('Cookies\x20für\x20'+_0x4c91bc+'\x20erfolgreich\x20geladen');}catch(_0x2905d8){return console['error']('Fehler\x20beim\x20Laden\x20der\x20Cookies\x20für\x20'+_0x4c91bc+':',_0x2905d8),![];}try{await _0x4fcc9b['goto']('https://www.instagram.com/',{'timeout':0x3a98});}catch(_0x52dcfe){console['error']('Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x52dcfe);}await delay(0x6a4,0x7d0);try{const _0x4d398b=await checkLoginStatus(_0x4fcc9b);return console['log']('Login-Status\x20für\x20'+_0x4c91bc+':\x20'+_0x4d398b),_0x4d398b;}catch(_0x1fe648){return console['warn']('Login-Prüfung\x20fehlgeschlagen\x20für\x20'+_0x4c91bc+':',_0x1fe648['message']),![];}}async function checkLoginStatus(_0x52a3c6){const _0x1686f9=['[type=\x22password\x22]','//a[normalize-space(text())=\x27Log\x20In\x27]','//div[@role=\x27button\x27\x20and\x20normalize-space(.)=\x27Log\x20in\x27]','//h3[normalize-space(text())=\x27Something\x20went\x20wrong\x27]'];let _0x474f21=null;try{_0x474f21=await waitForSelectorWithFallbacks(_0x52a3c6,_0x1686f9,{'timeout':0x7d0});}catch(_0x3f3bdb){return console['log']('Eingeloggt,\x20kein\x20Login\x20notwendig:\x20'+_0x3f3bdb),!![];}if(_0x474f21){console['log']('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return![];}else return console['log']('Eingeloggt,\x20führe\x20keine\x20Login\x20durch'),!![];}async function checkPageExists(_0x2da771){const _0x4c3ea6=['//span[contains(normalize-space(.),\x22Sorry,\x20this\x20page\x20isn\x27t\x20available\x22)]'];let _0x13f250=null;try{_0x13f250=await waitForSelectorWithFallbacks(_0x2da771,_0x4c3ea6,{'timeout':0x7d0});}catch(_0x1240de){return console['log']('Seite\x20existiert:\x20'+_0x1240de),!![];}if(_0x13f250){console['log']('Angegbene\x20Seite\x20existiert\x20nicht');throw new Error('Angegbene\x20Seite\x20existiert\x20nicht');return![];}else return console['log']('Seite\x20existiert'),!![];}async function likeFirstPost(_0x109140){try{const _0x2136e8=await _0x109140['$$'](K_BEITRAG_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Posts\x20gefunden:\x20'+_0x2136e8['length']);if(_0x2136e8&&_0x2136e8['length']>0x0){const _0x667260=_0x2136e8[0x0];await _0x667260['click'](),await delay(0xaf0,0xbb8);const _0x21e219=await _0x109140['evaluate'](()=>{const _0x400a70=document['querySelector']('section\x20>\x20span\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20svg[aria-label=\x22Like\x22]');return!!_0x400a70;});if(_0x21e219){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus');const _0x253593=await _0x109140['$$'](K_BEITRAG_LIKE_BUTTON),_0x8ffef6=_0x253593[0x0];await delay(0x514,0x5dc),await _0x109140['evaluate'](_0x5bf1a3=>{_0x5bf1a3['click']();},_0x8ffef6);}else console['log']('Beitrag\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x109140['goBack'](),await delay(0x7d0,0x898);}}catch(_0x1702ad){console['log']('Fehler\x20beim\x20Liken\x20des\x20ersten\x20Posts:',_0x1702ad);throw new Error('Like_Posts:\x20'+_0x1702ad);}}async function likeFirstStory(_0x472cc9){try{const _0x5cdf0d=await _0x472cc9['$$'](K_STORY_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Stories\x20gefunden:\x20'+_0x5cdf0d['length']);if(_0x5cdf0d&&_0x5cdf0d['length']>0x0){const _0x4417f4=_0x5cdf0d[0x0];await _0x4417f4['click'](),await delay(0xaf0,0xbb8);const _0x40d5d2=await _0x472cc9['evaluate'](()=>{const _0x1da1d2=document['querySelector']('[aria-label=\x22Like\x22]');return!!_0x1da1d2;});if(_0x40d5d2){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus'),await delay(0x514,0x5dc);try{const _0x110614=await _0x472cc9['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0x472cc9['click'](_0x110614);}catch(_0x4e0673){console['log']('Direkter\x20Klick\x20fehlgeschlagen,\x20versuche\x20alternative\x20Methoden:',_0x4e0673);try{const _0xe1144b=await _0x472cc9['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0x472cc9['evaluateHandle'](_0x4add0d=>{_0x4add0d['click']();},_0xe1144b);}catch(_0x2a653e){console['log']('Evaluatehandle\x20fehlgeschlagen,\x20versuche\x20JS-Click:',_0x2a653e),await _0x472cc9['evaluate'](()=>{const _0x2ad63b=document['querySelector']('[aria-label=\x22Like\x22]');if(_0x2ad63b)_0x2ad63b['click']();else throw new Error('Element\x20nicht\x20gefunden');});}}}else console['log']('Story\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x472cc9['goBack'](),await delay(0x7d0,0x898);}}catch(_0x4df8a7){console['log']('Fehler\x20beim\x20Liken\x20der\x20ersten\x20Story:',_0x4df8a7);throw new Error('Like_Storys:\x20'+_0x4df8a7);}}async function send_message(_0x576189,_0x2a4daa,_0x28e3c4,_0x16bd3c,_0x586d0d,_0x357baf,_0x88c3c8,_0x4a4a41,_0x5be823,_0x33090f,_0x718764){return new Promise(async(_0x430cb3,_0x42fa68)=>{_0x357baf=_0x357baf['split'](';'),console['log'](_0x357baf[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x586d0d);if(_0x16bd3c===null||_0x16bd3c===undefined){console['log']('Nachricht\x20ist\x20null\x20oder\x20undefined'),_0x42fa68('Nachricht\x20darf\x20nicht\x20leer\x20sein');return;}try{await setCookiesForUser(_0x576189,_0x357baf[0x0]);}catch(_0xb69eb0){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0xb69eb0),_0x430cb3({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0xb69eb0});return;}await delay(0x6a4,0x7d0);try{await _0x576189['goto']('https://www.instagram.com/'+_0x2a4daa+'/'),await delay(0x1b58,0x1d4c),await notificationClear(_0x576189);}catch(_0xc7eed5){_0x430cb3({'status':0x1f5,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0xc7eed5});return;}try{await checkLoginStatus(_0x576189);}catch(_0x55a849){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x55a849),_0x42fa68('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return;}if(_0x5be823==0x1)try{await likeFirstPost(_0x576189);}catch(_0xa33662){_0x42fa68(_0xa33662);}if(_0x33090f==0x1)try{await likeFirstStory(_0x576189);}catch(_0xcdc4d6){_0x42fa68(_0xcdc4d6);}console['log']('UserSkip:\x20'+_0x88c3c8);if(_0x88c3c8==0x1)try{const _0x32c123=await _0x576189['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x39f320=>_0x39f320['textContent']['trim']());console['log'](_0x32c123);if(_0x32c123==='Following'||_0x32c123==='Folge\x20ich')return _0x430cb3({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x5c7cb3){}await delay(0x6a4,0x7d0);try{const _0x3cf231=await waitForSelectorWithFallbacks(_0x576189,K_DIRECT_MSG_BUTTON);await _0x3cf231['click'](),await delay(0xa8c,0xdac);try{const _0x14f0c2=await waitForSelectorWithFallbacks(_0x576189,K_EXPAND_MSG_BUTTON);await _0x14f0c2['click']();}catch(_0x551494){console['log']('Expand-Button\x20nicht\x20gefunden.\x20Überspringen:\x20'+_0x551494);}}catch(_0x36b5ba){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x36b5ba);try{await delay(0xa8c,0xbb8);try{const _0x5ae4de=await waitForSelectorWithFallbacks(_0x576189,K_OPTIONS_BUTTON);await _0x5ae4de['click']();}catch(_0x200e10){console['log']('Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x200e10),_0x430cb3({'status':0x1f6,'message':'Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x200e10});return;}await delay(0xa8c,0xbb8);const _0x3bd499=await waitForXPath(_0x576189,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x3bd499['click']();}catch(_0x1bc873){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x1bc873),_0x430cb3({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x708,0x7d0),await notificationClear(_0x576189);}catch(_0x143d0a){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x143d0a);}try{await delay(0xaf0,0xdac);const _0x2912cc=await waitForSelectorWithFallbacks(_0x576189,K_CHAT_INPUT_FIELD,{'timeout':0x3a98});if(_0x4a4a41){const _0x4843b7=await _0x576189['$'](K_ALREADY_CHATTED);if(_0x4843b7)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x2a4daa),_0x430cb3({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x288978=await _0x576189['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x288978),_0x16bd3c=_0x16bd3c['replace']('{USERNAME}',_0x2a4daa);let _0x276fd3;if(_0x16bd3c['includes']('{NAME}')||_0x16bd3c['includes']('{name}'))try{const _0x4c1109=await extractFirstName(_0x288978,_0x718764);console['log']('Response\x20Clearname\x20valid:\x20'+_0x4c1109['valid']),_0x4c1109['valid']?(_0x16bd3c=_0x16bd3c['replaceAll'](/{NAME}|{name}/g,_0x4c1109['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x4c1109['name']),_0x276fd3=_0x4c1109['name']):(_0x16bd3c=_0x16bd3c['replaceAll'](/ ?({NAME}|{name})/g,''),_0x276fd3='UNKNOWN_NAME');}catch(_0x1f15a9){console['log'](_0x1f15a9['message']),_0x276fd3=_0x1f15a9['message'];const _0x19d1f7=_0x288978?_0x288978['replace'](/[^\p{L}\s]/gu,''):'',_0x133b51=_0x19d1f7['split']('\x20')[0x0]||'';_0x133b51['length']>0x2&&!_0x133b51['includes']('Instagram')?_0x16bd3c=_0x16bd3c['replaceAll'](/{NAME}|{name}/g,_0x133b51):_0x16bd3c=_0x16bd3c['replaceAll'](/ ?({NAME}|{name})/g,'');}console['log']('Nachricht\x20vor\x20dem\x20Senden:\x20'+_0x16bd3c);const _0xaa06a8=_0x16bd3c['split']('\x0a');await _0x2912cc['type'](_0xaa06a8[0x0],{'delay':getRnd(0x50,0x78)});for(let _0x22513d=0x1;_0x22513d<_0xaa06a8['length'];_0x22513d++){await _0x576189['keyboard']['down']('Shift'),await _0x576189['keyboard']['press']('Enter'),await _0x576189['keyboard']['up']('Shift'),await delay(0x64,0xc8),_0xaa06a8[_0x22513d]['length']>0x0&&await _0x2912cc['type'](_0xaa06a8[_0x22513d],{'delay':getRnd(0x50,0x78)});}console['log']('Nachricht\x20mit\x20Zeilenumbrüchen\x20gesendet'),await delay(0x320,0x3e8);try{const _0x2caa4a=await waitForSelectorWithFallbacks(_0x576189,K_SEND_MSG_BUTTON);await _0x2caa4a['click']();}catch(_0x20151d){console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x20151d),_0x430cb3({'status':0x195,'message':'Send\x20nicht\x20gefunden.\x20Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x2a4daa+'\x20überspringen.','error':_0x20151d['message']});}await delay(0x320,0x3e8),_0x430cb3({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x288978,'extracted_clearname':_0x276fd3});}catch(_0x5e521c){let _0x40604f=_0x5e521c;console['log']('Fehler\x20beim\x20Senden\x20der\x20Nachricht:\x20'+_0x40604f),_0x430cb3({'status':0x1f4,'message':'Error\x20500:\x20'+_0x40604f});}});}function handle_fail(_0x306d9c){if(isStopping)return new Promise(_0x563719=>{_0x563719('Scraper\x20gestoppt.');});else{let _0xd341ff='';switch(_0x306d9c){case 0x0:_0xd341ff='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0xd341ff='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0xd341ff='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0xd341ff='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x2eceb7,_0x1693c0)=>{_0x1693c0(_0xd341ff);});}}async function fetch_account_details(_0x4a09c7,_0x283ab9,_0x142349,_0x454772){try{await setCookiesForUser(_0x4a09c7,_0x142349['username']);}catch(_0x2a8fe3){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2a8fe3);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2a8fe3);return handle_fail(0x0);}_0x4a09c7['setDefaultNavigationTimeout'](0x7530),await _0x4a09c7['goto']('https://www.instagram.com/'+_0x283ab9+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x4a09c7);const _0x3343c5=await _0x4a09c7['evaluate'](()=>{const _0x249b2b=document['querySelector']('meta[property=\x22og:image\x22]');return _0x249b2b?_0x249b2b['getAttribute']('content'):null;});await _0x4a09c7['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x4ba8cf=await _0x4a09c7['evaluate'](()=>{const _0xd7d97c=document['querySelector']('meta[name=\x22description\x22]');if(!_0xd7d97c)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x978850=_0xd7d97c['getAttribute']('content');if(!_0x978850)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x978850);const _0x2376a5=/\s*[–-]\s*/,_0x17bce9=_0x978850['split'](_0x2376a5);if(_0x17bce9['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x58e719=_0x17bce9[0x0],_0x1988df=_0x17bce9[0x1],_0x32fd65=_0x58e719['split'](',\x20');if(_0x32fd65['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x105bba=_0x32fd65[0x0]['split']('\x20')[0x0],_0x510ca9=_0x32fd65[0x1]['split']('\x20')[0x0],_0x336ce5=_0x32fd65[0x2]['split']('\x20')[0x0];let _0x30feb4='',_0x33514b='';const _0x170d87='\x20on\x20Instagram:\x20',_0x1f7620=_0x1988df['split'](_0x170d87);return _0x30feb4=_0x1f7620[0x0]['trim'](),_0x30feb4=_0x30feb4['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x1f7620['length']>0x1&&(_0x33514b=_0x1f7620[0x1]['trim'](),_0x33514b['startsWith']('\x22')&&_0x33514b['endsWith']('\x22')&&(_0x33514b=_0x33514b['substring'](0x1,_0x33514b['length']-0x1)['trim']()),_0x33514b=_0x33514b['replace'](/&quot;/g,'')['trim']()),{'followers':_0x105bba,'following':_0x510ca9,'posts':_0x336ce5,'nameText':_0x30feb4,'bio':_0x33514b};});console['log']('Extracted\x20profile\x20data:',_0x4ba8cf);const _0x2d5ed1=_0x4ba8cf['nameText'],_0x2890c2=_0x3343c5,_0x403e3f=_0x4ba8cf['bio'],_0x51c782=_0x4ba8cf['followers'],_0x1b16ab=_0x4ba8cf['following'],_0x324d52=_0x4ba8cf['posts'],_0x55a473=![],_0x300a62=![],_0x399722=![],_0x4740fc='\x0a\x20\x20INSERT\x20INTO\x20'+quoteIdent(_0x454772)+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x4740fc,[_0x283ab9,_0x2d5ed1,_0x2890c2,_0x403e3f,_0x51c782,_0x1b16ab,_0x324d52,_0x55a473,_0x300a62,_0x399722],function(_0x105dc6){_0x105dc6?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x105dc6['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x33e45e,_0xc9c1ee,_0x53016e,_0x22b87f,_0x21f394,_0x36dcc8,_0x2ba582,_0x407a18){let _0x2dffa2=0x4,_0x14fee7=0x0,_0x5c8ffd=0x0;try{await setCookiesForUser(_0xc9c1ee,_0x36dcc8['username']);}catch(_0x2dc777){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x2dc777);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2dc777);return handle_fail(0x0);}let _0x210bad=0x0;try{await _0xc9c1ee['goto']('https://www.instagram.com/'+_0x53016e+'/'),await notificationClear(_0xc9c1ee);try{await checkLoginStatus(_0xc9c1ee);}catch(_0x33f271){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x33f271);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0xc9c1ee);}catch(_0x1c2e05){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x1c2e05);throw new Error('Username\x20nicht\x20gefunden.\x20Existiert\x20der\x20Account?');}try{if(_0x22b87f<=0x0){const _0x2310e7=await _0xc9c1ee['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x31c7cf=await _0xc9c1ee['evaluate'](_0x4852d2=>_0x4852d2['innerHTML'],_0x2310e7);_0x210bad=Math['ceil'](_0x31c7cf/0x4);}else _0x210bad=Math['ceil'](_0x22b87f/0x4);_0x2dffa2+=_0x210bad,_0x5c8ffd=Math['round'](++_0x14fee7/_0x2dffa2*0x64),_0x33e45e['sender']['send']('fetch-progress',_0x5c8ffd,!![]);let _0x14dcfa=await _0xc9c1ee['waitForSelector']('a[href=\x22/'+_0x53016e+'/followers/\x22]');await delay(0xbb8,0x1388),await _0xc9c1ee['evaluate'](_0x18427d=>{_0x18427d['click']();},_0x14dcfa),console['log']('Follower\x20Liste\x20von\x20'+_0x53016e+'\x20gesichtet'),_0x5c8ffd=Math['round'](++_0x14fee7/_0x2dffa2*0x64),_0x33e45e['sender']['send']('fetch-progress',_0x5c8ffd,!![]);}catch(_0x4758a7){console['log']('Follower\x20Liste\x20von\x20'+_0x53016e+'\x20nicht\x20gefunden:'+_0x4758a7);throw new Error('Follower\x20Liste\x20von\x20'+_0x53016e+'\x20nicht\x20gefunden:'+_0x4758a7);return handle_fail(0x0);}}catch(_0x1c17c5){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x1c17c5);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x1c17c5);return handle_fail(0x0);}try{await delay(0x12c0,0x1388),console['log']('Auto-scrolls:\x20'+_0x210bad);try{await scroll(_0xc9c1ee,FOLLOWER_FENSTER,_0x210bad,_0x54b2b0=>{_0x5c8ffd=Math['round'](++_0x14fee7/_0x2dffa2*0x64),_0x33e45e['sender']['send']('fetch-progress',_0x5c8ffd,!![]);});}catch{console['log']('Fallback\x20div:has\x20ausgelöst'),await scroll(_0xc9c1ee,'div.x6nl9eh.x1a5l9x9.x7vuprf.x1mg3h75.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',_0x210bad,_0x4e52a3=>{});}_0x5c8ffd=Math['round'](++_0x14fee7/_0x2dffa2*0x64),_0x33e45e['sender']['send']('fetch-progress',_0x5c8ffd,!![]),await _0xc9c1ee['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x4c66f1=await _0xc9c1ee['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x54440c=await _0xc9c1ee['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x5c8ffd=Math['round'](++_0x14fee7/_0x2dffa2*0x64),_0x33e45e['sender']['send']('fetch-progress',_0x5c8ffd,!![]);_0x22b87f<=0x0&&(_0x22b87f=_0x4c66f1['length']);let _0xc06190=[];for(let _0x1639af=0x0;_0x1639af<_0x4c66f1['length']&&_0x1639af<_0x22b87f;_0x1639af++){const _0x120003=await _0x4c66f1[_0x1639af]['evaluate'](_0x49c618=>_0x49c618['textContent']),_0x52ddc4=await _0x54440c[_0x1639af]['evaluate'](_0x45de53=>_0x45de53['textContent']);if(_0x407a18){const _0xf75912=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x36dcc8['username'],_0x120003]);if(_0xf75912){console['log']('Skipping\x20already\x20contacted\x20follower:\x20'+_0x120003);continue;}}_0xc06190['push'](_0x120003);const _0x225dae='INSERT\x20INTO\x20'+quoteIdent(_0x21f394)+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x225dae,[_0x120003,_0x52ddc4],function(_0x388d4a){_0x388d4a?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x21f394+'\x27:',_0x388d4a['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x5c8ffd=Math['round'](++_0x14fee7/_0x2dffa2*0x64),_0x33e45e['sender']['send']('fetch-progress',_0x5c8ffd,!![]),_0x2ba582&&(_0x33e45e['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x33e45e,_0xc9c1ee,_0x36dcc8,_0x21f394,_0xc06190)),new Promise(_0x521445=>{_0x521445('Scraping\x20finished!');});}catch(_0x10f9af){if(_0x2ba582)throw new Error(_0x10f9af);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x53016e+'\x20nicht\x20gefunden:\x20'+_0x10f9af);return handle_fail(0x0);}}async function fetch_details_from_list(_0x5ba73b,_0x44f23a,_0x4280a0,_0x554a6f,_0x304e10){let _0x170f74=0x0,_0x2e6c63=0x0;for(let _0x42fd0b=0x0;_0x42fd0b<_0x304e10['length'];_0x42fd0b++){console['log']('Processing\x20profile:',_0x304e10[_0x42fd0b]);try{await fetch_account_details(_0x44f23a,_0x304e10[_0x42fd0b],_0x4280a0,_0x554a6f);}catch(_0x2b842a){console['error']('Detailed\x20Scraping\x20von:\x20',_0x304e10[_0x42fd0b],_0x2b842a);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x304e10[_0x42fd0b]+'\x20'+_0x2b842a);}_0x2e6c63=Math['round'](++_0x170f74/_0x304e10['length']*0x64),_0x5ba73b['sender']['send']('fetch-progress',_0x2e6c63,!![],!![]);}}async function fetch_likers_from_post(_0x8b6d68,_0x160da8,_0x984bdc,_0x2be31a,_0xb4bae3,_0x182c33,_0x34234f,_0x3bb8ba){let _0x166f23=0x4,_0x2808e5=0x0,_0xb733f8=0x0;try{await setCookiesForUser(_0x160da8,_0x182c33['username']);}catch(_0x36f23e){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x36f23e);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x36f23e);return handle_fail(0x1);}_0xb733f8=Math['round'](++_0x2808e5/_0x166f23*0x64),_0x8b6d68['sender']['send']('fetch-progress',_0xb733f8,!![]);try{let _0x2c09c1=_0x984bdc['substring'](0x0,_0x984bdc['lastIndexOf']('/'));_0x2c09c1['includes']('/reel/')&&(_0x2c09c1=_0x2c09c1['replace']('/reel/','/p/'));let _0x4e4c16=_0x2c09c1+'/liked_by';console['log'](_0x4e4c16),await _0x160da8['goto'](_0x4e4c16),await delay(0x7d0,0xfa0),await notificationClear(_0x160da8),await delay(0xc8,0x1f4);try{await checkLoginStatus(_0x160da8);}catch(_0x1fb09a){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x1fb09a);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x160da8);}catch(_0x19a807){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x19a807);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}_0xb733f8=Math['round'](++_0x2808e5/_0x166f23*0x64),_0x8b6d68['sender']['send']('fetch-progress',_0xb733f8,!![]),await _0x160da8['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x5dd067=await _0x160da8['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0xf94fa9=await _0x160da8['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x5dd067['length']);let _0xc82dae=path['join'](__dirname,'/likers.csv');_0xb733f8=Math['round'](++_0x2808e5/_0x166f23*0x64),_0x8b6d68['sender']['send']('fetch-progress',_0xb733f8,!![]);_0x2be31a<=0x0&&(_0x2be31a=_0x5dd067['length']);try{let _0xfa0b94=[];for(let _0x547843=0x0;_0x547843<_0x5dd067['length']&&_0x547843<_0x2be31a;_0x547843++){const _0x58ce54=await _0x5dd067[_0x547843]['evaluate'](_0x1b52c8=>_0x1b52c8['textContent']),_0x3d1309=await _0xf94fa9[_0x547843]['evaluate'](_0x15df9a=>_0x15df9a['textContent']);if(_0x3bb8ba){const _0x95336d=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x182c33['username'],_0x58ce54]);if(_0x95336d){console['log']('Skipping\x20already\x20contacted\x20liker:\x20'+_0x58ce54);continue;}}_0xfa0b94['push'](_0x58ce54);const _0x1843f8='INSERT\x20INTO\x20'+quoteIdent(_0xb4bae3)+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x1843f8,[_0x58ce54,_0x3d1309],function(_0x248740){_0x248740?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0xb4bae3+'\x27:',_0x248740['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0xb733f8=Math['round'](++_0x2808e5/_0x166f23*0x64),_0x8b6d68['sender']['send']('fetch-progress',_0xb733f8,!![]),_0x34234f&&(_0x8b6d68['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x8b6d68,_0x160da8,_0x182c33,_0xb4bae3,_0xfa0b94)),new Promise(_0xbde176=>{_0xbde176('Scraping\x20finished!');});}catch(_0x27f9f0){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x27f9f0);return handle_fail(0x1);}}catch(_0x289641){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x289641);throw new Error('Like-Seite\x20nicht\x20geöffnet:\x20'+_0x289641);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x2fe64d,_0x4c4b57,_0x73afad,_0x282fb4,_0x346cf3,_0x41903a,_0x432c8b,_0x44b3dc){let _0x21952b=0x3,_0x49e262=0x0,_0x3eec0d=0x0;try{await setCookiesForUser(_0x4c4b57,_0x41903a['username']);}catch(_0x3daaf3){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x3daaf3);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x3daaf3);return handle_fail(0x2);}try{console['log'](_0x73afad),await _0x4c4b57['goto'](_0x73afad),await delay(0x7d0,0xfa0),await notificationClear(_0x4c4b57),await delay(0xc8,0x1f4);const _0x76f396=COM_COMMENTS_BOX_BODY_DIV;try{await checkLoginStatus(_0x4c4b57);}catch(_0x38f1a4){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x38f1a4);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x4c4b57);}catch(_0x1e1e2c){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x1e1e2c);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}let _0x324788;const _0x2302e8=await _0x4c4b57['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x3e6832=await _0x4c4b57['evaluate'](_0x4f28eb=>_0x4f28eb['innerHTML'],_0x2302e8),_0x428198=String(_0x3e6832)['replace'](/[^0-9]/g,''),_0x1fdf91=Number(_0x428198)/0x14;_0x282fb4<=0x0?_0x324788=Math['ceil'](_0x1fdf91/0x3):_0x324788=Math['ceil'](_0x282fb4/0x3);_0x21952b+=_0x324788,_0x3eec0d=Math['round'](++_0x49e262/_0x21952b*0x64),_0x2fe64d['sender']['send']('fetch-progress',_0x3eec0d,!![]),console['log']('Auto-scrolls:\x20'+_0x324788),await scroll(_0x4c4b57,_0x76f396,_0x324788,_0x2d5e8a=>{_0x3eec0d=Math['round'](++_0x49e262/_0x21952b*0x64),_0x2fe64d['sender']['send']('fetch-progress',_0x3eec0d,!![]);});try{const _0x56574b=COM_REPLY_BUTTON_SPAN,_0xf3efea=await waitForXPathAll(_0x4c4b57,_0x56574b);console['log']('Reply-Buttons\x20gefunden:\x20ANZAHL:\x20'+_0xf3efea['size']),await delay(0x1f4,0x320);let _0x1be433=_0xf3efea['size'],_0x493543=[];for(const [_0x5dde73,_0x187319]of _0xf3efea){_0x493543['push'](_0x187319);}console['log']('Alle\x20Reply-Buttons:',_0x493543['length']);try{for(let _0x15802d=0x0;_0x15802d<_0x1be433;_0x15802d++){await _0x493543[_0x15802d]['click'](),await delay(0x320,0x5dc);}}catch(_0x2df346){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x2df346);throw new Error('Nicht\x20auf\x20Replies\x20geklickt:\x20'+_0x2df346);return handle_fail(0x2);}}catch(_0x15b8fa){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x121ead=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x4c4b57['waitForSelector'](_0x121ead),await delay(0x1f4,0x320),_0x3eec0d=Math['round'](++_0x49e262/_0x21952b*0x64),_0x2fe64d['sender']['send']('fetch-progress',_0x3eec0d,!![]);const _0x2bbd1d=await _0x4c4b57['$$'](_0x121ead);let _0x4fe3e5=path['join'](__dirname,'/comments.csv');_0x282fb4<=0x0&&(_0x282fb4=_0x2bbd1d['length']);console['log']('fetch_limit:\x20'+_0x282fb4),console['log']('comments_len:\x20'+_0x2bbd1d['length']),_0x282fb4++;try{let _0x5786ac=[];for(let _0x49e44f=0x1;_0x49e44f<_0x2bbd1d['length']&&_0x49e44f<_0x282fb4;_0x49e44f++){const _0x30b32b=await _0x2bbd1d[_0x49e44f]['evaluate'](_0x5a544f=>_0x5a544f['textContent']);if(_0x44b3dc){const _0x28c0ef=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x41903a['username'],_0x30b32b]);if(_0x28c0ef){console['log']('Skipping\x20already\x20contacted\x20commenter:\x20'+_0x30b32b);continue;}}try{_0x5786ac['push'](_0x30b32b);const _0x450736='INSERT\x20INTO\x20'+quoteIdent(_0x346cf3)+'\x20(username)\x20VALUES\x20(?)';db['run'](_0x450736,[_0x30b32b],function(_0x1435fb){_0x1435fb&&console['log']('error\x20in\x20add-user:'+_0x1435fb);});}catch(_0x5c33c3){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x49e44f+'\x20:\x20'+_0x5c33c3);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x49e44f+'\x20:\x20'+_0x5c33c3);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x3eec0d=Math['round'](++_0x49e262/_0x21952b*0x64),_0x2fe64d['sender']['send']('fetch-progress',_0x3eec0d,!![]),_0x2fe64d['sender']['send']('fetch-progress',0x64,!![]),_0x432c8b&&(_0x2fe64d['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x2fe64d,_0x4c4b57,_0x41903a,_0x346cf3,_0x5786ac)),_0x2fe64d['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x23d3b4=>{_0x23d3b4('Scraping\x20finished!');});}catch(_0x179278){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x179278);return handle_fail(0x2);}}catch(_0x1b2748){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x1b2748);throw new Error('Comments-Seite\x20nicht\x20geöffnet:\x20'+_0x1b2748);return handle_fail(0x2);}}async function set_clearname_from_username(_0x55503a,_0x44adf0,_0x1c36b3=null){try{let _0x3a4812,_0x2bec72;const _0x50e757='SELECT\x20username\x20FROM\x20'+quoteIdent(_0x44adf0)+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x50e757,[],(_0x46580c,_0x1716ab)=>{_0x46580c&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x46580c['message']),_0x1716ab['length']===0x0&&(_0x2bec72=_0x1716ab['length']),_0x3a4812=_0x1716ab['map'](_0x5a5c04=>_0x5a5c04['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x2bec72);if(_0x2bec72===0x0){console['log']('Leave');return;}const _0x56c6a7=await _0x55503a['waitForSelector'](IG_SEARCH_BUTTON);await _0x56c6a7['click'](),await delay(0x4b0,0x7d0);for(let _0xc9fee2 of _0x3a4812){const _0xeb0074=await _0x55503a['waitForSelector'](IG_SEARCH_INPUT);await _0xeb0074['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x55503a['type'](IG_SEARCH_INPUT,_0xc9fee2,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x107cd6=0x1;while(_0x107cd6!=0x14){console['log']('Schleife');try{let _0x463ded=IG_NAME_SPAN_PART1+_0x107cd6+IG_USERNAME_SPAN_PART2;const _0x55cec0=await _0x55503a['waitForSelector'](_0x463ded),_0x29534e=await _0x55503a['evaluate'](_0x5e8a83=>_0x5e8a83['innerHTML'],_0x55cec0);await delay(0xc8,0x1f4);if(_0x29534e==_0xc9fee2){let _0x160e85=IG_NAME_SPAN_PART1+_0x107cd6+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x4171de=await _0x55503a['waitForSelector'](_0x160e85);let _0x54c8ef=await _0x55503a['evaluate'](_0x4b18e2=>_0x4b18e2['innerHTML'],_0x4171de);const _0x135adf=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x29b815=_0x54c8ef['match'](_0x135adf);_0x29b815?_0x54c8ef=_0x29b815[0x1]['trim']():_0x54c8ef=_0x54c8ef['trim']();_0x54c8ef['includes']('•')&&(_0x54c8ef=_0x54c8ef['substring'](0x0,_0x54c8ef['indexOf']('•')-0x1));const _0x5a7b3b='UPDATE\x20'+quoteIdent(_0x44adf0)+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x5a7b3b,[_0x54c8ef,_0x29534e],function(_0x18722b){_0x18722b&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x18722b['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x107cd6++;}catch(_0x5a40d5){const _0x583cbd='UPDATE\x20'+quoteIdent(_0x44adf0)+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x583cbd,['',_0xc9fee2],function(_0xe152c4){_0xe152c4&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0xe152c4['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x5a40d5);break;}}_0x1c36b3&&_0x1c36b3();}await _0x56c6a7['click']();}catch(_0x4cb151){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x4cb151);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likePost\x20\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likeStory\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likePost\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likeStory\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x2964dd,_0x2e1e45)=>{const _0x29a5bc='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x29a5bc,[],(_0x3603e6,_0x5a2736)=>{_0x3603e6?_0x2e1e45(_0x3603e6):_0x2964dd(_0x5a2736);});});});const sqlGet=(_0x1e67df,_0x13d48b,_0x544388=[])=>new Promise((_0x44834c,_0x2eed28)=>_0x1e67df['get'](_0x13d48b,_0x544388,(_0x448462,_0x232c7e)=>_0x448462?_0x2eed28(_0x448462):_0x44834c(_0x232c7e))),sqlAll=(_0x523cca,_0x4e4461,_0xbbd00e=[])=>new Promise((_0xf0067e,_0x1a0281)=>_0x523cca['all'](_0x4e4461,_0xbbd00e,(_0x4a3028,_0x588c00)=>_0x4a3028?_0x1a0281(_0x4a3028):_0xf0067e(_0x588c00)));ipcMain['handle']('get-campaign-details',async()=>{try{const _0x50d79e=await sqlAll(campaignDB,'SELECT\x20campaign_name,\x20list_id,\x20zeitabstand,\x20account\x20FROM\x20campaign'),_0x10e858=await Promise['all'](_0x50d79e['map'](async _0x5cb0df=>{const _0xd8f200=[];if(!_0x5cb0df['list_id'])_0xd8f200['push']('Liste');if(!_0x5cb0df['zeitabstand'])_0xd8f200['push']('Zeitabstand');if(!_0x5cb0df['account'])_0xd8f200['push']('Instagram\x20Account');if(_0x5cb0df['account'])try{const _0x540d07=await sqlGet(igaccountsDB,'SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x5cb0df['account']]);if(!_0x540d07)_0xd8f200['push']('Instagram\x20Login\x20nicht\x20möglich');else{const _0xf68034=_0x540d07['cookie']&&_0x540d07['cookie']['trim']()!==''&&_0x540d07['cookie']['trim']()!=='[]';if(!_0xf68034)_0xd8f200['push']('Instagram\x20Login');}}catch(_0x42a4d6){console['error']('Account-Prüfung\x20SQL-Fehler:',_0x42a4d6['message']),_0xd8f200['push']('Instagram\x20Account');}let _0x219806='N/A',_0x47afc3='N/A';if(!_0xd8f200['includes']('Liste')){try{const _0x671080=await sqlGet(db,'SELECT\x20COUNT(*)\x20AS\x20lead_count\x20FROM\x20'+quoteIdent(_0x5cb0df['list_id']));_0x219806=_0x671080?.['lead_count']??0x0;}catch(_0xe2e5fe){if(/no such table/i['test'](_0xe2e5fe['message']))_0xd8f200['push']('Liste\x20nicht\x20vorhanden');}try{const _0x5abab1=await sqlGet(campaignDB,'SELECT\x20COUNT(*)\x20AS\x20contacted_count\x20FROM\x20dm\x20WHERE\x20list_id\x20=\x20?',[_0x5cb0df['list_id']]);_0x47afc3=_0x5abab1?.['contacted_count']??0x0;}catch(_0x21a71e){}}return{'campaign_name':_0x5cb0df['campaign_name'],'lead_count':_0x219806,'contacted_count':_0x47afc3,'status':_0xd8f200['length']===0x0?'Positiv':'Fehler:\x20'+_0xd8f200['join'](',\x20')};}));return{'status':'success','campaigns':_0x10e858};}catch(_0x41054f){return console['error']('get-campaign-details\x20fehlgeschlagen:',_0x41054f['message']),{'status':'error','message':_0x41054f['message']};}}),ipcMain['handle']('get-campaign-writer-information',async(_0x442505,_0x46a8cf)=>{return new Promise((_0x26be00,_0x74328a)=>{const _0x3fd26c='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted,\x20likePost,\x20likeStory\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x3fd26c,[_0x46a8cf],(_0x35a916,_0x3169ef)=>{_0x35a916?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x35a916),_0x74328a(_0x35a916)):(console['log']('ROWS'),console['log'](_0x3169ef),debugDatabaseContents(),_0x26be00(_0x3169ef));});});});const showTableContents=_0x434bbe=>{return new Promise((_0x779bda,_0xad9f93)=>{const _0x1911d3='SELECT\x20*\x20FROM\x20'+quoteIdent(_0x434bbe)+';';campaignDB['all'](_0x1911d3,(_0x28060f,_0xe2156b)=>{_0x28060f?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x434bbe+':',_0x28060f),_0xad9f93(_0x28060f)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x434bbe+':',_0xe2156b),_0x779bda({'status':'success','message':_0xe2156b}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x4f7d82){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x4f7d82);}}ipcMain['handle']('create-campaign',async(_0x3600fd,_0x3aa6d5)=>{return new Promise((_0x54705f,_0x7959b)=>{const _0x40be9a='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x40be9a,[String(_0x3aa6d5)],function(_0x5845b4){_0x5845b4?_0x7959b(_0x5845b4):_0x54705f({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x4a1618,_0x84fa92)=>{return new Promise((_0x4529c1,_0x5cf8a3)=>{const _0x5b78cf='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x5b78cf,[_0x84fa92],function(_0x4c3924){_0x4c3924?_0x5cf8a3(_0x4c3924):_0x4529c1({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x4285a9,_0x5e5e1e,_0x541212,_0x519a37,_0x168f69,_0x17f7a1,_0x46bc0b,_0x2c7676,_0x4056c6,_0x9b7754)=>{const _0x5b32fc=await createMessageID(_0x168f69);return new Promise((_0x534def,_0xcf2d45)=>{console['log']('ZEITABSTAND:\x20'+_0x519a37);if(!_0x5e5e1e||!_0x541212||_0x519a37===undefined||_0x519a37===null||_0x519a37===''||!_0x5b32fc||!_0x17f7a1)return _0xcf2d45({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x5b32fc);const _0x793585='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?,\x20likePost\x20=\x20?,\x20likeStory\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x793585,[_0x541212,_0x519a37,_0x5b32fc,_0x17f7a1,_0x46bc0b,_0x2c7676,_0x4056c6,_0x9b7754,_0x5e5e1e],function(_0x3817b9){if(_0x3817b9)_0xcf2d45({'status':'error','message':_0x3817b9['message']});else this['changes']===0x0?_0xcf2d45({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x534def({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x465303,_0x5aabe5,_0x1857e7,_0x121036,_0xaa5f1a)=>{return new Promise((_0x2171f0,_0x13e58d)=>{const _0x11bd12='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x11bd12,[_0x5aabe5,_0x1857e7,_0x121036,_0xaa5f1a],function(_0x4e17b7){return _0x4e17b7?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x4e17b7['message']),_0x13e58d('insert-dm-response',{'success':![],'message':_0x4e17b7['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x2171f0('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x63e711=>{return new Promise((_0x46cd0d,_0x3ee353)=>{const _0x5b4588='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x5b4588,[_0x63e711],(_0x4353aa,_0x5416e4)=>{if(_0x4353aa)_0x3ee353({'status':'error','message':_0x4353aa['message']});else{if(_0x5416e4)_0x46cd0d(_0x5416e4['message_id']);else{const _0x15d4c0='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x15d4c0,[_0x63e711],function(_0x18206f){_0x18206f?_0x3ee353({'status':'error','message':_0x18206f['message']}):_0x46cd0d(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x19b835,_0x43c308)=>{return new Promise((_0x3bbd4f,_0x339631)=>{const _0x5348b1='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+quoteIdent(_0x43c308);db['get'](_0x5348b1,(_0x56e84d,_0x1b6dee)=>{_0x56e84d?_0x339631({'status':'error','message':_0x56e84d['message']}):_0x3bbd4f({'status':'success','count':_0x1b6dee['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0xb225f9,_0x2bc762){try{const _0x39a854=await new Promise((_0x17a47c,_0x16cae4)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x2bc762],(_0x259185,_0x14393a)=>{if(_0x259185)_0x16cae4(_0x259185);else{if(_0x14393a['length']>0x0){let _0x3c85a8=JSON['parse'](_0x14393a[0x0]['cookie']);console['log'](_0x3c85a8),_0x17a47c(_0x3c85a8);}else _0x16cae4(new Error('User\x20with\x20username\x20'+_0x2bc762+'\x20does\x20not\x20exist.'));}});});await _0xb225f9['setCookie'](..._0x39a854),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0xe8a3de){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0xe8a3de);}}async function saveCookiesForUser(_0x194048,_0x5e8007){try{const _0x48dfc2=await _0x194048['cookies']();if(!_0x48dfc2||_0x48dfc2['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x5e8007);const _0x18369d=JSON['stringify'](_0x48dfc2);if(_0x18369d['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x5e8007);return new Promise((_0x3491b,_0x27b642)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x5e8007],(_0x162526,_0xcd5208)=>{if(_0x162526)return console['error']('Error\x20checking\x20user\x20existence:',_0x162526),_0x27b642(_0x162526);if(_0xcd5208){const _0x51d03f=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x51d03f['run'](_0x18369d,_0x5e8007,function(_0x23d161){return _0x23d161?(console['error']('Error\x20updating\x20cookies:',_0x23d161),_0x27b642(_0x23d161)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x5e8007),_0x3491b());});}else{const _0x4d3232=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x4d3232['run'](_0x5e8007,_0x18369d,function(_0x46b1fe){return _0x46b1fe?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x46b1fe),_0x27b642(_0x46b1fe)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x5e8007),_0x3491b());});}});});}catch(_0x58f5cf){console['error']('Error\x20fetching\x20cookies:',_0x58f5cf);throw _0x58f5cf;}}async function createUserIfNotExists(_0x3c9efd){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x3c9efd],(_0x3aa203,_0x36ff8a)=>{if(_0x3aa203){console['error']('Error\x20checking\x20user\x20existence:',_0x3aa203);throw _0x3aa203;}else{if(!_0x36ff8a){const _0x5baceb=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x5baceb['run'](_0x3c9efd,function(_0x48fd66){_0x48fd66?console['error']('Error\x20inserting\x20new\x20user:',_0x48fd66):console['log']('New\x20user\x20created:',_0x3c9efd);});}else console['log']('User\x20already\x20exists:',_0x3c9efd);}});}catch(_0xf67d5e){console['error']('Error\x20creating\x20user:',_0xf67d5e);throw _0xf67d5e;}}ipcMain['handle']('create-relation',async(_0x31516c,_0x292ce8)=>{return new Promise((_0x349fb2,_0x386718)=>{const _0x1663e9='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+quoteIdent(_0x292ce8)+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x1663e9,function(_0x3d2757){_0x3d2757?_0x386718(_0x3d2757):_0x349fb2({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x6d3018,_0x5099fa)=>{return console['log']('droping\x20table'+_0x5099fa),new Promise((_0x113945,_0xc3cea7)=>{const _0x3f8cbf='DROP\x20TABLE\x20IF\x20EXISTS\x20'+quoteIdent(_0x5099fa);console['log']('droping\x20table'+_0x5099fa),db['run'](_0x3f8cbf,function(_0x37e56b){_0x37e56b?_0xc3cea7(_0x37e56b):_0x113945({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x1d5af5=>{return new Promise((_0x20fe7f,_0x2c30db)=>{const _0x504fd4='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x504fd4,[],(_0x334108,_0x1e8971)=>{_0x334108?_0x2c30db(_0x334108):_0x20fe7f(_0x1e8971['map'](_0x476c69=>_0x476c69['name']));});});}),ipcMain['handle']('add-user',async(_0x1cde1d,_0x491ece,_0x317b4b)=>{return new Promise(_0x4b31da=>{const _0x18faf9=db['prepare']('INSERT\x20INTO\x20'+quoteIdent(_0x317b4b)+'\x20(username)\x20VALUES\x20(?)');_0x18faf9['run'](_0x491ece,function(_0x2e68ee){_0x2e68ee?console['log']('error\x20in\x20add-user:'+_0x2e68ee):_0x4b31da({'status':'success','id':this['lastID']});}),_0x18faf9['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x14b4f3,_0x483c7e)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x4af126,_0x1f180c)=>{if(_0x4af126)_0x483c7e(_0x4af126);else{_0x14b4f3({'status':'success','users':_0x1f180c});for(_0x1f180c of _0x1f180c){console['log'](_0x1f180c['username']);}}});});}),ipcMain['handle']('get-data',async(_0x1deab4,_0x16d55e)=>{return new Promise((_0x1ec16b,_0x31912f)=>{const _0x14dd1f='SELECT\x20*\x20FROM\x20'+quoteIdent(_0x16d55e);console['log'](_0x14dd1f),db['all'](_0x14dd1f,[],(_0xbb5726,_0x38e8b2)=>{_0xbb5726?_0x31912f(_0xbb5726):_0x1ec16b(_0x38e8b2);});});}),ipcMain['handle']('get-accounts',async _0x2abd9f=>{return new Promise((_0x3291f0,_0x2a42a7)=>{const _0x3a3fd7='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x3a3fd7),igaccountsDB['all'](_0x3a3fd7,[],(_0x370bfe,_0x3aed2e)=>{_0x370bfe?_0x2a42a7(_0x370bfe):_0x3291f0(_0x3aed2e);});});}),ipcMain['handle']('get-targets',async(_0x5991c3,_0x2a36f5)=>{return getTargetProfiles(_0x2a36f5);}),ipcMain['handle']('delete-user',async(_0x4ec616,_0x55407c,_0x5819c7)=>{return new Promise((_0x5805a0,_0x4ce348)=>{const _0x70b2b8=db['prepare']('DELETE\x20FROM\x20'+quoteIdent(_0x5819c7)+'\x20WHERE\x20username\x20=\x20?');_0x70b2b8['run'](_0x55407c,function(_0x17f372){_0x17f372?_0x4ce348(_0x17f372):_0x5805a0({'status':'success','changes':this['changes']});}),_0x70b2b8['finalize']();});}),ipcMain['handle']('delete-account',async(_0x5a5993,_0x36627e)=>{const _0x1c6264=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x1c6264['run'](_0x36627e,function(_0x219266){_0x219266&&console['log'](_0x219266);}),_0x1c6264['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x349e4d,_0x7de982)=>{const _0x3d30b2='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x3d30b2,[],(_0x23aca7,_0x2413f4)=>{_0x23aca7?_0x7de982({'status':'error','message':_0x23aca7['message']}):_0x349e4d({'status':'success','contactedCount':_0x2413f4['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x539182,_0xf6bd46)=>{const _0x4167f2='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x4167f2,[],(_0x3eae92,_0x1c6383)=>{_0x3eae92?_0xf6bd46({'status':'error','message':_0x3eae92['message']}):_0x539182({'status':'success','contactedCount':_0x1c6383['contactedCount']});});});});function exportDatabase(_0x1ffc4b){return new Promise((_0x440da6,_0x4d6f32)=>{const _0x1f75fe='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+quoteIdent(_0x1ffc4b)+'\x0a\x20\x20\x20\x20';db['all'](_0x1f75fe,[],async(_0x4135d1,_0x24fb18)=>{if(_0x4135d1){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x4135d1['message']),_0x4d6f32(_0x4135d1);return;}if(!_0x24fb18||_0x24fb18['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x440da6();return;}const _0x1490f9=XLSX['utils']['json_to_sheet'](_0x24fb18),_0x1a8b61=XLSX['utils']['sheet_to_csv'](_0x1490f9);try{const {canceled:_0x22efd3,filePath:_0x368b96}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x1ffc4b+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x22efd3||!_0x368b96){console['log']('Speichern\x20abgebrochen.'),_0x440da6();return;}fs['writeFile'](_0x368b96,_0x1a8b61,'utf8',_0x52233f=>{_0x52233f?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x52233f['message']),_0x4d6f32(_0x52233f)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x368b96),_0x440da6());});}catch(_0x44e42d){console['error']('Fehler\x20im\x20Speicherdialog:',_0x44e42d),_0x4d6f32(_0x44e42d);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x4814e9,_0x4003f8)=>{shell['openExternal'](_0x4003f8);});