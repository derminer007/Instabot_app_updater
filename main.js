const {app,BrowserWindow,ipcMain,dialog}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_NEW_MSG_BUTTON='div.x1i10hfl.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.x6s0dn4.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x1ypdohk.x78zum5.xl56j7k.x1y1aw1k.x1sxyh0.xwib8y2.xurb0ha.xcdnw81',K_SEARCH_BAR_INPUT='body\x20>\x20div.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x1k90msu.x6o7n8i.x1qfuztq.x10l6tqk.x17qophe.x13vifvy.x1hc1fzr.x71s49j.xh8yej3\x20>\x20div\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.x1q0g3np.x1a02dak.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20input',K_USERNAME_SPALTE_PART1='div:nth-child(',K_CLEARNAME_SPALTE_PART2=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1pi30zi.x1swvt13.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span\x20>\x20span',K_CHAT_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.x972fbf.xcfux6l.x1qhh985.xm0m39n.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.xexx8yu.x18d9i69.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1lq5wgf.xgqcy7u.x30kzoy.x9jhf4c.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x9bdzbf.x1ypdohk.x78zum5.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x1n2onr6.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xn3w4p2.x5ib6vp.xc73u3c.x1tu34mt.xzloghq',K_NACHRICHT_SCHREIBEN_INPUT_DIV='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1i64zmx.xw3qccf.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f.notranslate',K_SENDEN_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x5500ad=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x5500ad['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x5500ad['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x4587b5){var _0x430af7=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x122d8f){console['log']('window\x20id:'+_0x122d8f['id']),_0x122d8f['id']>0x1&&(_0x430af7=!![]);}),console['log']('child\x20opened\x20='+_0x430af7);if(!_0x430af7){const _0x9d040d=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x9d040d['loadFile'](_0x4587b5['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0);});const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x279451='',_0x3a4631=null;if(process['platform']==='darwin')_0x279451=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x279451=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x279451}),_0x3a4631=await browser_login['newPage'](),_0x3a4631['setDefaultNavigationTimeout'](0x1d4c),_0x3a4631['setDefaultTimeout'](0x1d4c),_0x3a4631;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x512102=0x1,_0x3696b4=0x0){let _0x33950a='',_0x4ff435=null;if(process['platform']==='darwin')_0x33950a=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x33950a=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x512102===0x0&&!pageStack[_0x3696b4])return browser=await puppeteer['launch']({'headless':!![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x33950a}),_0x4ff435=await browser['newPage'](),_0x4ff435['setDefaultNavigationTimeout'](0x1d4c),_0x4ff435['setDefaultTimeout'](0x1d4c),pageStack[_0x3696b4]=_0x4ff435,_0x4ff435;return(browser===null||pageStack[_0x3696b4]===null||pageStack[_0x3696b4]['isClosed']())&&(browser=await puppeteer['launch']({'headless':!![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x33950a})),(pageStack[_0x3696b4]===null||pageStack[_0x3696b4]['isClosed']())&&(_0x4ff435=await browser['newPage'](),_0x4ff435['setDefaultNavigationTimeout'](0x1d4c),_0x4ff435['setDefaultTimeout'](0x1d4c),pageStack[_0x3696b4]=_0x4ff435),pageStack[_0x3696b4];}ipcMain['on']('login',async(_0x5ee22b,_0x3b09de)=>{const _0x29ce98=await getBrowserPageLogin();await _0x29ce98['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x29ce98,_0x3b09de),ipcMain['on']('setLoginCookies',async(_0x396778,_0x3c03df)=>{try{await set_login_cookies(_0x29ce98,_0x3c03df);}catch(_0x5447e4){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x5447e4);}});}),ipcMain['on']('export-relation',async(_0xd50db2,_0x34b968)=>{try{await exportDatabase(_0x34b968),_0xd50db2['reply']('export-relation-response',{'success':!![]});}catch(_0x2964ff){console['error'](_0x2964ff),_0xd50db2['reply']('export-relation-response',{'success':![],'message':_0x2964ff['message']});}}),ipcMain['handle']('sendMessage',async(_0x446c85,_0x422275,_0x483ccc,_0x58594e,_0x5f1528,_0x2a8c77,_0xcd4989,_0x522c75)=>{isStopping=![];let _0x1f0a1d=null;return _0xcd4989?_0x1f0a1d=await getBrowserPage(_0x5f1528,_0x522c75):_0x1f0a1d=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x422275),new Promise((_0x2581e5,_0x394ac6)=>{send_message(_0x1f0a1d,_0x422275,_0x483ccc,_0x58594e,_0x5f1528,_0x2a8c77)['then'](_0x22c3ab=>_0x2581e5(_0x22c3ab))['catch'](_0x4966e9=>_0x394ac6(_0x4966e9));});}),ipcMain['handle']('stop-action',async(_0x277f19,_0x4bef4f)=>{isStopping=!![];const _0x17cb24=await getBrowserPage(0x1,_0x4bef4f);await _0x17cb24['close']();}),ipcMain['handle']('fetch_followers',async(_0x42163d,_0x4a347f,_0x43b707,_0x4036ad,_0x15c0c9,_0x39489d)=>{isStopping=![];const _0x1ac6c9=await getBrowserPage();return fetch_followers_from_account(_0x42163d,_0x1ac6c9,_0x4a347f,_0x43b707,_0x4036ad,_0x15c0c9,_0x39489d);}),ipcMain['handle']('get-account-details',async(_0x1a806b,_0x9a521b,_0x409d5b,_0x5c2e83)=>{isStopping=![];const _0x4f1424=await getBrowserPage();return fetch_account_details(_0x4f1424,_0x9a521b,_0x409d5b,_0x5c2e83);}),ipcMain['handle']('fetch_likes',async(_0x52a9f1,_0x552306,_0x246941,_0x369b76,_0x3adaf7,_0x15f3f1)=>{isStopping=![];const _0x357a98=await getBrowserPage();return fetch_likers_from_post(_0x52a9f1,_0x357a98,_0x552306,_0x246941,_0x369b76,_0x3adaf7,_0x15f3f1);}),ipcMain['handle']('fetch_comments',async(_0x573630,_0x4abef7,_0xbbc83a,_0x38a50d,_0xcb86f5,_0x295839)=>{isStopping=![];const _0x267624=await getBrowserPage();return fetch_comments_from_post(_0x573630,_0x267624,_0x4abef7,_0xbbc83a,_0x38a50d,_0xcb86f5,_0x295839);}),ipcMain['handle']('update-app',async _0x1254ce=>{const {spawn:_0x23cea6}=require('child_process'),_0x199213=require('path');return new Promise((_0x1f1edf,_0x5a5e09)=>{(process['env']['NODE_ENV']==='development'||process['env']['SKIP_UPDATES']==='true')&&(console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x1f1edf('Update\x20übersprungen'));if(process['platform']==='darwin'){const _0x352fe6=_0x199213['join'](__dirname,'mac-updater-intern.sh'),_0x323258=_0x23cea6('/bin/bash',[_0x352fe6]);_0x323258['stdout']['on']('data',_0x369e2a=>{console['log']('stdout:\x20'+_0x369e2a);}),_0x323258['stderr']['on']('data',_0x49eb4c=>{console['error']('stderr:\x20'+_0x49eb4c);}),_0x323258['on']('close',_0x58bbf2=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x58bbf2),_0x58bbf2===0x0?_0x1f1edf('Update\x20erfolgreich\x20abgeschlossen.'):_0x5a5e09(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x58bbf2));});}else{if(process['platform']==='win32'){const _0x2c7fca=_0x199213['join'](__dirname,'../','../','../');process['chdir'](_0x2c7fca),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x79ba51='soft-ui-updater-windows.ps1',_0x22b620=_0x23cea6('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x79ba51]);_0x22b620['stdout']['on']('data',_0x1459bc=>{console['log']('stdout:\x20'+_0x1459bc);}),_0x22b620['stderr']['on']('data',_0x485d88=>{console['error']('stderr:\x20'+_0x485d88);}),_0x22b620['on']('close',_0x2cea63=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x2cea63),_0x2cea63===0x0?_0x1f1edf('Update\x20erfolgreich\x20abgeschlossen.'):_0x5a5e09(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x2cea63));});}else _0x5a5e09(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}});});function getRnd(_0xdf3b26,_0xfd047d){return Math['random']()*(_0xfd047d-_0xdf3b26+0x1)+_0xdf3b26;}function delay(_0x38f76c,_0x9c1b3a){let _0x260412=getRnd(_0x38f76c,_0x9c1b3a);return new Promise(function(_0x6cbd49){setTimeout(_0x6cbd49,_0x260412);});}async function scroll(_0x2e2d86,_0x14bdca,_0x26abf5=0x2,_0x12bda3){const _0x39dda2=await _0x2e2d86['waitForSelector'](_0x14bdca);for(let _0x1b3742=0x0;_0x1b3742<_0x26abf5;_0x1b3742++){console['log']('Scrolling\x20'+_0x1b3742),await _0x2e2d86['evaluate'](_0x24754b=>{const _0x1132e0=document['querySelector'](_0x24754b);_0x1132e0&&_0x1132e0['scrollBy'](0x0,0x190);},_0x14bdca),await delay(0x320,0x5dc),_0x12bda3();}}async function saveCookies(_0x10dd48){let _0x4ab1d2=await _0x10dd48['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x4ab1d2,null,0x2));}async function notificationClear(_0x199fc9){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x199fc9['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x199fc9['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x5e3e67){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x5e3e67);}}async function getTargetProfiles(_0x248786){return new Promise((_0x2c6563,_0x3025d0)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x248786,(_0x1adf7c,_0x4f7bc2)=>{_0x1adf7c?_0x3025d0(_0x1adf7c):_0x2c6563(_0x4f7bc2);});});}async function login_legacy(_0x1623d9,_0xdf5fdb,_0x5744f2){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x1623d9,_0xdf5fdb),await createUserIfNotExists(_0xdf5fdb,_0x5744f2);}catch(_0x34263d){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x34263d);}try{await _0x1623d9['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x1623d9['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x1623d9['click']('button._a9--._ap36._a9_0');}catch(_0x3f3bd1){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x1623d9['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x1623d9['type']('input[name=\x27username\x27]',_0xdf5fdb,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x1623d9['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x1623d9['type']('input[name=\x27password\x27]',_0x5744f2,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x1623d9['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x1623d9['click']('button[type=\x27submit\x27]');}catch(_0x5428cf){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x1623d9),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x1623d9,_0xdf5fdb);}catch(_0x57a239){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x57a239);}}catch(_0x4550e2){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x4550e2);}}async function login(_0x1e8e14,_0x15ac54){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x1e8e14,_0x15ac54),await createUserIfNotExists(_0x15ac54);}catch(_0x2fab7c){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x2fab7c);}try{await _0x1e8e14['goto']('https://www.instagram.com/accounts/login/');}catch(_0x40e16f){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x40e16f);}}async function set_login_cookies(_0x24602f,_0xbc5040){try{await saveCookiesForUser(_0x24602f,_0xbc5040);}catch(_0x277225){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x277225);}}async function send_message(_0x302453,_0x53b565,_0x15eb7e,_0x893338,_0x2376e7,_0x2e82c8){_0x2e82c8=_0x2e82c8['split'](';'),console['log'](_0x2e82c8[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x2376e7);if(_0x2376e7==0x0){try{await setCookiesForUser(_0x302453,_0x2e82c8[0x0]);}catch(_0x3445e3){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x3445e3);return;}await _0x302453['goto']('https://www.instagram.com/direct/inbox/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x302453);}let _0x42a8e1;await set_clearname_from_username(_0x302453,_0x15eb7e);const _0x38678c='SELECT\x20clearname\x20FROM\x20'+_0x15eb7e+'\x20WHERE\x20username\x20IS\x20?';db['all'](_0x38678c,[_0x53b565],(_0x3ac2b4,_0x2625c5)=>{_0x3ac2b4&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x3ac2b4['message']);if(_0x2625c5['length']===0x0)return;_0x42a8e1=_0x2625c5['map'](_0x4b726b=>_0x4b726b['clearname'])[0x0];});try{try{const _0x59e6d5=K_NEW_MSG_BUTTON;await delay(0xfa0,0x1d4c),await _0x302453['waitForSelector'](_0x59e6d5),await _0x302453['click'](_0x59e6d5),console['log']('Message-Button\x20geklickt'),console['log'](_0x53b565+'\x20'+_0x893338),await delay(0xfa0,0x1d4c);try{const _0x3ff03e='input[name=\x22queryBox\x22]',_0x3aea6a=K_SEARCH_BAR_INPUT;await _0x302453['waitForSelector'](_0x3aea6a),await _0x302453['click'](_0x3aea6a),await delay(0xfa0,0x1d4c),await _0x302453['waitForSelector'](_0x3ff03e),await _0x302453['click'](_0x3ff03e),await delay(0xfa0,0x1d4c),await _0x302453['type'](_0x3ff03e,_0x53b565,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),console['log']('Account\x20Name\x20eingefügt');const _0x5d3959=K_USERNAME_SPALTE_PART1,_0x58d394=K_CLEARNAME_SPALTE_PART2;let _0x373807=0x1;try{while(_0x373807!=0x14){console['log']('Schleife');let _0x374dfa=_0x5d3959+_0x373807+_0x58d394;const _0x1c44ea=await _0x302453['waitForSelector'](_0x374dfa),_0x7e180b=await _0x302453['evaluate'](_0x3940fc=>_0x3940fc['innerHTML'],_0x1c44ea);console['log'](_0x7e180b+';'+_0x42a8e1+';'+_0x53b565),delay(0x3e8,0xbb8);if(_0x7e180b['includes'](_0x42a8e1)){console['log']('Account\x20gefunden'),await _0x302453['click'](_0x374dfa);break;}else{if(_0x7e180b==_0x53b565){console['log']('Account\x20gefunden'),await _0x302453['click'](_0x374dfa);break;}}_0x373807++;}try{await delay(0xbb8,0x1388);const _0x148c91=await _0x302453['waitForSelector'](K_CHAT_BUTTON_DIV);console['log'](_0x148c91),await delay(0xbb8,0x1388),await _0x148c91['click']();try{await delay(0xbb8,0x1388);const _0x1e248a=await _0x302453['waitForSelector'](K_NACHRICHT_SCHREIBEN_INPUT_DIV);_0x893338=_0x893338['replace']('{USERNAME}',_0x53b565);let _0x4b80bd=_0x42a8e1['split']('\x20')[0x0];_0x893338=_0x893338['replace']('{NAME}',_0x4b80bd),_0x893338=_0x893338['replace']('{name}',_0x4b80bd),await _0x1e248a['type'](_0x893338,{'delay':getRnd(0x50,0x78)}),await delay(0xbb8,0x1388);try{const _0x1a0887=await _0x302453['waitForSelector'](K_SENDEN_BUTTON_DIV);return await _0x1a0887['click'](),await delay(0xbb8,0x1388),new Promise(_0x5a5c47=>{_0x5a5c47('Nachricht\x20erfolgreich\x20verschickt!');});}catch(_0x4ef005){console['log']('Message-Button\x20nicht\x20geklickt:\x20'+_0x4ef005);}}catch(_0x9f747a){console['log']('Chat-Fenster\x20nicht\x20gefunden:\x20'+_0x9f747a);}}catch(_0x320365){console['log']('error:\x20'+_0x320365);}}catch(_0x1a2bac){return console['log']('User\x20nicht\x20gefunden:'+_0x1a2bac),await _0x302453['goto']('https://www.instagram.com/direct/inbox/'),new Promise((_0x3198c6,_0x57a6fb)=>{_0x57a6fb('user_not_found');});}}catch(_0x2b61d3){console['log']('DM-Fenster\x20nicht\x20gefunden:'+_0x2b61d3);}}catch(_0x55f3bd){console['log']('Message-Button\x20nicht\x20geklickt:'+_0x55f3bd);}}catch(_0x3e52cb){console['log']('Nachricht\x20senden\x20fehlgeschlagen:\x20'+_0x3e52cb);}return console['log']('Ende'),await _0x302453['goto']('https://www.instagram.com/direct/inbox/'),new Promise((_0x2cd6b9,_0x2c43d6)=>{_0x2c43d6('ig_update');});}function handle_fail(_0x5296ee){if(isStopping)return new Promise(_0x174b5a=>{_0x174b5a('Scraper\x20gestoppt.');});else{let _0x57dfae='';switch(_0x5296ee){case 0x0:_0x57dfae='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x57dfae='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x57dfae='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x57dfae='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x276d95,_0xf3c6cb)=>{_0xf3c6cb(_0x57dfae);});}}async function fetch_account_details(_0x4bd934,_0x2ae0eb,_0x583162,_0xc1a74b){try{await setCookiesForUser(_0x4bd934,_0x583162['username']);}catch(_0xf49bcc){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0xf49bcc);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0xf49bcc);return handle_fail(0x0);}_0x4bd934['setDefaultNavigationTimeout'](0x7530),await _0x4bd934['goto']('https://www.instagram.com/'+_0x2ae0eb+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x4bd934);const _0x13a1b1=await _0x4bd934['evaluate'](()=>{const _0xd8b469=document['querySelector']('meta[property=\x22og:image\x22]');return _0xd8b469?_0xd8b469['getAttribute']('content'):null;});await _0x4bd934['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x312b85=await _0x4bd934['evaluate'](()=>{const _0x541586=document['querySelector']('meta[name=\x22description\x22]');if(!_0x541586)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0xfc7fc7=_0x541586['getAttribute']('content');if(!_0xfc7fc7)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0xfc7fc7);const _0x12b96b=/\s*[–-]\s*/,_0x5438c0=_0xfc7fc7['split'](_0x12b96b);if(_0x5438c0['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x4c883c=_0x5438c0[0x0],_0x4eea0f=_0x5438c0[0x1],_0x321dff=_0x4c883c['split'](',\x20');if(_0x321dff['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x35847e=_0x321dff[0x0]['split']('\x20')[0x0],_0x8dcf2e=_0x321dff[0x1]['split']('\x20')[0x0],_0x581e1f=_0x321dff[0x2]['split']('\x20')[0x0];let _0x496aec='',_0xd7bcc7='';const _0x503e81='\x20on\x20Instagram:\x20',_0x450999=_0x4eea0f['split'](_0x503e81);return _0x496aec=_0x450999[0x0]['trim'](),_0x496aec=_0x496aec['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x450999['length']>0x1&&(_0xd7bcc7=_0x450999[0x1]['trim'](),_0xd7bcc7['startsWith']('\x22')&&_0xd7bcc7['endsWith']('\x22')&&(_0xd7bcc7=_0xd7bcc7['substring'](0x1,_0xd7bcc7['length']-0x1)['trim']()),_0xd7bcc7=_0xd7bcc7['replace'](/&quot;/g,'')['trim']()),{'followers':_0x35847e,'following':_0x8dcf2e,'posts':_0x581e1f,'nameText':_0x496aec,'bio':_0xd7bcc7};});console['log']('Extracted\x20profile\x20data:',_0x312b85);const _0x4e6b18=_0x312b85['nameText'],_0x5da2d9=_0x13a1b1,_0x1498b7=_0x312b85['bio'],_0x355251=_0x312b85['followers'],_0x5e6823=_0x312b85['following'],_0x35c3b2=_0x312b85['posts'],_0x1e7e5c=![],_0x40061b=![],_0x8de137=![],_0x1aff5f='\x0a\x20\x20INSERT\x20INTO\x20'+_0xc1a74b+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x1aff5f,[_0x2ae0eb,_0x4e6b18,_0x5da2d9,_0x1498b7,_0x355251,_0x5e6823,_0x35c3b2,_0x1e7e5c,_0x40061b,_0x8de137],function(_0x401a92){_0x401a92?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x401a92['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x121b98,_0x3f88aa,_0x2a6dbc,_0xeb0303,_0x554034,_0x1def41,_0x57f5f5){let _0x4141a4=0x4,_0x46781d=0x0,_0x89ec84=0x0;try{await setCookiesForUser(_0x3f88aa,_0x1def41['username']);}catch(_0x1eca2a){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x1eca2a);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x1eca2a);return handle_fail(0x0);}let _0x1492e4=0x0;try{await _0x3f88aa['goto']('https://www.instagram.com/'+_0x2a6dbc+'/'),await notificationClear(_0x3f88aa);try{if(_0xeb0303<=0x0){const _0x4564e2=await _0x3f88aa['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x34775c=await _0x3f88aa['evaluate'](_0x5c81d6=>_0x5c81d6['innerHTML'],_0x4564e2);_0x1492e4=Math['ceil'](_0x34775c/0x4);}else _0x1492e4=Math['ceil'](_0xeb0303/0x4);_0x4141a4+=_0x1492e4,_0x89ec84=Math['round'](++_0x46781d/_0x4141a4*0x64),_0x121b98['sender']['send']('fetch-progress',_0x89ec84,!![]);let _0x227ef1=await _0x3f88aa['waitForSelector']('a[href=\x22/'+_0x2a6dbc+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x227ef1['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x2a6dbc+'\x20gesichtet'),_0x89ec84=Math['round'](++_0x46781d/_0x4141a4*0x64),_0x121b98['sender']['send']('fetch-progress',_0x89ec84,!![]);}catch(_0x1e17df){console['log']('Follower\x20Liste\x20von\x20'+_0x2a6dbc+'\x20nicht\x20gefunden:'+_0x1e17df);throw new Error('Follower\x20Liste\x20von\x20'+_0x2a6dbc+'\x20nicht\x20gefunden:'+_0x1e17df);return handle_fail(0x0);}}catch(_0x543619){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x543619);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x543619);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x1492e4),await scroll(_0x3f88aa,FOLLOWER_FENSTER,_0x1492e4,_0x3f2ffe=>{_0x89ec84=Math['round'](++_0x46781d/_0x4141a4*0x64),_0x121b98['sender']['send']('fetch-progress',_0x89ec84,!![]);}),await _0x3f88aa['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x4f713c=await _0x3f88aa['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x326f6d=await _0x3f88aa['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x89ec84=Math['round'](++_0x46781d/_0x4141a4*0x64),_0x121b98['sender']['send']('fetch-progress',_0x89ec84,!![]);_0xeb0303<=0x0&&(_0xeb0303=_0x4f713c['length']);let _0x4f1b50=[];for(let _0x44cfd6=0x0;_0x44cfd6<_0x4f713c['length']&&_0x44cfd6<_0xeb0303;_0x44cfd6++){_0x4f1b50['push'](await _0x4f713c[_0x44cfd6]['evaluate'](_0x4a3422=>_0x4a3422['textContent']));const _0x37da31='INSERT\x20INTO\x20'+_0x554034+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x37da31,[await _0x4f713c[_0x44cfd6]['evaluate'](_0x887882=>_0x887882['textContent']),await _0x326f6d[_0x44cfd6]['evaluate'](_0x55492c=>_0x55492c['textContent'])],function(_0x4e51db){_0x4e51db?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x554034+'\x27:',_0x4e51db['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x89ec84=Math['round'](++_0x46781d/_0x4141a4*0x64),_0x121b98['sender']['send']('fetch-progress',_0x89ec84,!![]),_0x57f5f5&&(_0x121b98['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x121b98,_0x3f88aa,_0x1def41,_0x554034,_0x4f1b50)),new Promise(_0x1ea549=>{_0x1ea549('Scraping\x20finished!');});}catch(_0x26137c){if(_0x57f5f5)throw new Error(_0x26137c);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x2a6dbc+'\x20nicht\x20gefunden:\x20'+_0x26137c);return handle_fail(0x0);}}async function fetch_details_from_list(_0x3e90a8,_0xf16f9f,_0x264013,_0x8ff37e,_0x1fa11d){let _0x4b19c3=0x0,_0x1b0a4c=0x0;for(let _0x4bedc1=0x0;_0x4bedc1<_0x1fa11d['length'];_0x4bedc1++){console['log']('Processing\x20profile:',_0x1fa11d[_0x4bedc1]);try{await fetch_account_details(_0xf16f9f,_0x1fa11d[_0x4bedc1],_0x264013,_0x8ff37e);}catch(_0x2346a7){console['error']('Detailed\x20Scraping\x20von:\x20',_0x1fa11d[_0x4bedc1],_0x2346a7);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x1fa11d[_0x4bedc1]+'\x20'+_0x2346a7);}_0x1b0a4c=Math['round'](++_0x4b19c3/_0x1fa11d['length']*0x64),_0x3e90a8['sender']['send']('fetch-progress',_0x1b0a4c,!![],!![]);}}async function fetch_likers_from_post(_0x17e3f5,_0x4593a3,_0x316216,_0x138617,_0x491d07,_0x40be63,_0x264382){let _0x2021b7=0x4,_0x4b4839=0x0,_0x68b32d=0x0;try{await setCookiesForUser(_0x4593a3,_0x40be63['username']);}catch(_0x49ba83){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x49ba83);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x49ba83);return handle_fail(0x1);return;}_0x68b32d=Math['round'](++_0x4b4839/_0x2021b7*0x64),_0x17e3f5['sender']['send']('fetch-progress',_0x68b32d,!![]);try{let _0x5371e7=_0x316216['substring'](0x0,_0x316216['lastIndexOf']('/')),_0x10397b=_0x5371e7+'/liked_by';console['log'](_0x10397b),await _0x4593a3['goto'](_0x10397b),await delay(0x7d0,0xfa0),await notificationClear(_0x4593a3),await delay(0xc8,0x1f4),_0x68b32d=Math['round'](++_0x4b4839/_0x2021b7*0x64),_0x17e3f5['sender']['send']('fetch-progress',_0x68b32d,!![]),await _0x4593a3['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x52d2bd=await _0x4593a3['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x388748=await _0x4593a3['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x52d2bd['length']);let _0x34d786=path['join'](__dirname,'/likers.csv');_0x68b32d=Math['round'](++_0x4b4839/_0x2021b7*0x64),_0x17e3f5['sender']['send']('fetch-progress',_0x68b32d,!![]);_0x138617<=0x0&&(_0x138617=_0x52d2bd['length']);try{let _0x171fae=[];for(let _0x64d0d3=0x0;_0x64d0d3<_0x52d2bd['length']&&_0x64d0d3<_0x138617;_0x64d0d3++){_0x171fae['push'](await _0x52d2bd[_0x64d0d3]['evaluate'](_0x3e8d14=>_0x3e8d14['textContent']));try{const _0x438366='INSERT\x20INTO\x20'+_0x491d07+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x438366,[await _0x52d2bd[_0x64d0d3]['evaluate'](_0x3bd722=>_0x3bd722['textContent']),await _0x388748[_0x64d0d3]['evaluate'](_0x24a440=>_0x24a440['textContent'])],function(_0xfefac4){_0xfefac4?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x491d07+'\x27:',_0xfefac4['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x6f5957){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x64d0d3+'\x20:\x20'+_0x6f5957);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x64d0d3+'\x20:\x20'+_0x6f5957);return handle_fail(0x1);}}return _0x68b32d=Math['round'](++_0x4b4839/_0x2021b7*0x64),_0x17e3f5['sender']['send']('fetch-progress',_0x68b32d,!![]),_0x264382&&(_0x17e3f5['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x17e3f5,_0x4593a3,_0x40be63,_0x491d07,_0x171fae)),new Promise(_0x250886=>{_0x250886('Scraping\x20finished!');});}catch(_0x3196df){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x3196df);return handle_fail(0x1);}}catch(_0x19ef2f){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x19ef2f);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x19ef2f);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x485648,_0x50c208,_0x33effb,_0x6849bc,_0x132e3e,_0x599dd1,_0x53403b){let _0x3b2fe1=0x3,_0x59166c=0x0,_0xfd528d=0x0;try{await setCookiesForUser(_0x50c208,_0x599dd1['username']);}catch(_0x4a6037){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4a6037);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4a6037);return handle_fail(0x2);}try{console['log'](_0x33effb),await _0x50c208['goto'](_0x33effb),await delay(0x7d0,0xfa0),await notificationClear(_0x50c208),await delay(0xc8,0x1f4);const _0x495aea=COM_COMMENTS_BOX_BODY_DIV;let _0x3cf339;const _0x38d542=await _0x50c208['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x52b53a=await _0x50c208['evaluate'](_0x27d98c=>_0x27d98c['innerHTML'],_0x38d542),_0x5d57a8=String(_0x52b53a)['replace'](/[^0-9]/g,''),_0x40dc24=Number(_0x5d57a8)/0x14;_0x6849bc<=0x0?_0x3cf339=Math['ceil'](_0x40dc24/0x3):_0x3cf339=Math['ceil'](_0x6849bc/0x3);_0x3b2fe1+=_0x3cf339+_0x40dc24,_0xfd528d=Math['round'](++_0x59166c/_0x3b2fe1*0x64),_0x485648['sender']['send']('fetch-progress',_0xfd528d,!![]),console['log']('Auto-scrolls:\x20'+_0x3cf339),await scroll(_0x50c208,_0x495aea,_0x3cf339,_0x1189df=>{_0xfd528d=Math['round'](++_0x59166c/_0x3b2fe1*0x64),_0x485648['sender']['send']('fetch-progress',_0xfd528d,!![]);});try{const _0x3eede4=COM_REPLY_BUTTON_SPAN;await _0x50c208['waitForSelector'](_0x3eede4),await delay(0x1f4,0x320);const _0x2580bf=await _0x50c208['$$'](_0x3eede4);console['log'](_0x2580bf);let _0x3e7040=_0x2580bf['length'];await delay(0xc8,0x1f4);try{for(let _0x3d68fb=0x0;_0x3d68fb<_0x3e7040;_0x3d68fb++){_0x2580bf[_0x3d68fb]['click'](),await delay(0x320,0x5dc);}}catch(_0x3a89d3){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x3a89d3);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x3a89d3);return handle_fail(0x2);}}catch(_0x61f968){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x18c6a2=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x50c208['waitForSelector'](_0x18c6a2),await delay(0x1f4,0x320),_0xfd528d=Math['round'](++_0x59166c/_0x3b2fe1*0x64),_0x485648['sender']['send']('fetch-progress',_0xfd528d,!![]);const _0x5acf06=await _0x50c208['$$'](_0x18c6a2);let _0x276d56=path['join'](__dirname,'/comments.csv');_0x6849bc<=0x0&&(_0x6849bc=_0x5acf06['length']);console['log']('fetch_limit:\x20'+_0x6849bc),console['log']('comments_len:\x20'+_0x5acf06['length']),_0x6849bc++;try{let _0x1e03fc=[];for(let _0x2d526a=0x1;_0x2d526a<_0x5acf06['length']&&_0x2d526a<_0x6849bc;_0x2d526a++){try{_0x1e03fc['push'](await _0x5acf06[_0x2d526a]['evaluate'](_0x1ebb2d=>_0x1ebb2d['textContent']));const _0x433a1c=await db['prepare']('INSERT\x20INTO\x20'+_0x132e3e+'\x20(username)\x20VALUES\x20(?)');await _0x433a1c['run'](await _0x5acf06[_0x2d526a]['evaluate'](_0x22edd8=>_0x22edd8['textContent']),function(_0x458780){_0x458780&&console['log']('error\x20in\x20add-user:'+_0x458780);}),await _0x433a1c['finalize']();}catch(_0x18845a){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x2d526a+'\x20:\x20'+_0x18845a);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x2d526a+'\x20:\x20'+_0x18845a);return handle_fail(0x2);}}await delay(0x4b0,0x7d0),_0xfd528d=Math['round'](++_0x59166c/_0x3b2fe1*0x64),_0x485648['sender']['send']('fetch-progress',_0xfd528d,!![]);try{await set_clearname_from_username(_0x50c208,_0x132e3e,()=>{++_0x59166c<_0x3b2fe1&&(_0xfd528d=Math['round'](_0x59166c/_0x3b2fe1*0x64),_0x485648['sender']['send']('fetch-progress',_0xfd528d,!![]));});}catch(_0x1d1dfa){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x1d1dfa);}return _0x485648['sender']['send']('fetch-progress',0x64,!![]),_0x53403b&&(_0x485648['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x485648,_0x50c208,_0x599dd1,_0x132e3e,_0x1e03fc)),new Promise(_0x48b38a=>{_0x48b38a('Scraping\x20finished!');});}catch(_0xa8216f){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0xa8216f);return handle_fail(0x2);}}catch(_0xb947a6){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0xb947a6);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0xb947a6);return handle_fail(0x2);}}async function set_clearname_from_username(_0x1a5682,_0x19eeaf,_0x2306a2=null){try{let _0x589cb2,_0x1da74c;const _0x19891e='SELECT\x20username\x20FROM\x20'+_0x19eeaf+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x19891e,[],(_0x59f1f9,_0x4f3c78)=>{_0x59f1f9&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x59f1f9['message']),_0x4f3c78['length']===0x0&&(_0x1da74c=_0x4f3c78['length']),_0x589cb2=_0x4f3c78['map'](_0x55fdfb=>_0x55fdfb['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x1da74c);if(_0x1da74c===0x0){console['log']('Leave');return;}const _0x4cb972=await _0x1a5682['waitForSelector'](IG_SEARCH_BUTTON);await _0x4cb972['click'](),await delay(0x4b0,0x7d0);for(let _0x1f1436 of _0x589cb2){const _0xf9172f=await _0x1a5682['waitForSelector'](IG_SEARCH_INPUT);await _0xf9172f['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x1a5682['type'](IG_SEARCH_INPUT,_0x1f1436,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x117b89=0x1;while(_0x117b89!=0x14){console['log']('Schleife');try{let _0x3e81ed=IG_NAME_SPAN_PART1+_0x117b89+IG_USERNAME_SPAN_PART2;const _0x3b4f26=await _0x1a5682['waitForSelector'](_0x3e81ed),_0x2f84e1=await _0x1a5682['evaluate'](_0x4dca6a=>_0x4dca6a['innerHTML'],_0x3b4f26);await delay(0xc8,0x1f4);if(_0x2f84e1==_0x1f1436){let _0x23b683=IG_NAME_SPAN_PART1+_0x117b89+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x519bb0=await _0x1a5682['waitForSelector'](_0x23b683);let _0x17545f=await _0x1a5682['evaluate'](_0x3af036=>_0x3af036['innerHTML'],_0x519bb0);const _0x4db7c8=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x4a6fec=_0x17545f['match'](_0x4db7c8);_0x4a6fec?_0x17545f=_0x4a6fec[0x1]['trim']():_0x17545f=_0x17545f['trim']();_0x17545f['includes']('•')&&(_0x17545f=_0x17545f['substring'](0x0,_0x17545f['indexOf']('•')-0x1));const _0x4f2a26='UPDATE\x20'+_0x19eeaf+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x4f2a26,[_0x17545f,_0x2f84e1],function(_0x6c0888){_0x6c0888&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x6c0888['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x117b89++;}catch(_0x1b325d){const _0x1625f9='UPDATE\x20'+_0x19eeaf+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x1625f9,['',_0x1f1436],function(_0x4a6a96){_0x4a6a96&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x4a6a96['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x1b325d);break;}}_0x2306a2&&_0x2306a2();}await _0x4cb972['click']();}catch(_0x236b04){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x236b04);}}const campaignPath=path['resolve'](__dirname,'data/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(campaign_name\x20TEXT\x20PRIMARY\x20KEY,\x20list_id\x20TEXT,\x20zeitabstand\x20REAL,\x20message_id\x20TEXT,\x20account\x20TEXT,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x26c877,_0x153c97)=>{const _0xb71715='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0xb71715,[],(_0x4fca8e,_0x2aa6b0)=>{_0x4fca8e?_0x153c97(_0x4fca8e):_0x26c877(_0x2aa6b0);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x341505,_0x4320d9)=>{const _0x12b51d='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x12b51d,[],async(_0x3981d1,_0x308624)=>{if(_0x3981d1)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x3981d1['message']),_0x4320d9({'status':'error','message':_0x3981d1['message']});else try{const _0x4e5ea4=await Promise['all'](_0x308624['map'](_0x299e5c=>{return new Promise(_0x56cccc=>{if(!_0x299e5c['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x299e5c['campaign_name']),_0x56cccc({'campaign_name':_0x299e5c['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x3f5f54='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x299e5c['list_id'],_0x23e003='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x299e5c['list_id']+'\x22';console['log']('campaing\x20listid:\x20'+_0x299e5c['list_id']),db['get'](_0x3f5f54,[],(_0x501274,_0x1147e6)=>{_0x501274?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x299e5c['campaign_name']+':',_0x501274['message']),_0x56cccc({'campaign_name':_0x299e5c['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x23e003,[],(_0x538468,_0x431e4f)=>{_0x538468?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x299e5c['campaign_name']+':',_0x538468['message']),_0x56cccc({'campaign_name':_0x299e5c['campaign_name'],'lead_count':_0x1147e6?_0x1147e6['lead_count']:0x0,'contacted_count':'N/A'})):_0x56cccc({'campaign_name':_0x299e5c['campaign_name'],'lead_count':_0x1147e6?_0x1147e6['lead_count']:0x0,'contacted_count':_0x431e4f?_0x431e4f['contacted_count']:0x0});});});});}));_0x341505({'status':'success','campaigns':_0x4e5ea4});}catch(_0x49aafa){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x49aafa),_0x4320d9({'status':'error','message':_0x49aafa['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x4ec45c,_0x597073)=>{return new Promise((_0x277969,_0x159884)=>{const _0x39411c='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x39411c,[_0x597073],(_0x5da07c,_0x2778b7)=>{_0x5da07c?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x5da07c),_0x159884(_0x5da07c)):(console['log']('ROWS'),console['log'](_0x2778b7),debugDatabaseContents(),_0x277969(_0x2778b7));});});});const showTableContents=_0x2f05b3=>{return new Promise((_0x61afba,_0x2e986c)=>{const _0x285029='SELECT\x20*\x20FROM\x20'+_0x2f05b3+';';campaignDB['all'](_0x285029,(_0x33c724,_0x44ab62)=>{_0x33c724?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x2f05b3+':',_0x33c724),_0x2e986c(_0x33c724)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x2f05b3+':',_0x44ab62),_0x61afba({'status':'success','message':_0x44ab62}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x51c040){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x51c040);}}ipcMain['handle']('create-campaign',async(_0x18870a,_0xd95c78)=>{return new Promise((_0xff980d,_0x56464e)=>{const _0x2df648='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x2df648,[String(_0xd95c78)],function(_0x21c834){_0x21c834?_0x56464e(_0x21c834):_0xff980d({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x9cb70b,_0x455295)=>{return new Promise((_0x15ab1f,_0x25c241)=>{const _0x4a39e2='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x4a39e2,[_0x455295],function(_0x2332c7){_0x2332c7?_0x25c241(_0x2332c7):_0x15ab1f({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x41727c,_0x308a24,_0x2a1bc1,_0x249fce,_0x303c9e,_0x4d2ec0)=>{const _0x4fe780=await createMessageID(_0x303c9e);return new Promise((_0x339c36,_0x157e27)=>{if(!_0x308a24||!_0x2a1bc1||!_0x249fce||!_0x4fe780||!_0x4d2ec0)return _0x157e27({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x4fe780);const _0x6c898f='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x6c898f,[_0x2a1bc1,_0x249fce,_0x4fe780,_0x4d2ec0,_0x308a24],function(_0x46097b){if(_0x46097b)_0x157e27({'status':'error','message':_0x46097b['message']});else this['changes']===0x0?_0x157e27({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x339c36({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x17bfbf,_0x19adb7,_0x266a9b,_0x3d2b11,_0x38c9de)=>{return new Promise((_0x28b33e,_0x1134b7)=>{const _0x164bc5='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x164bc5,[_0x19adb7,_0x266a9b,_0x3d2b11,_0x38c9de],function(_0x5352a6){return _0x5352a6?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x5352a6['message']),_0x1134b7('insert-dm-response',{'success':![],'message':_0x5352a6['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x28b33e('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x438fad=>{return new Promise((_0x188be1,_0x202cba)=>{const _0xea4577='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0xea4577,[_0x438fad],(_0x31feb6,_0x480299)=>{if(_0x31feb6)_0x202cba({'status':'error','message':_0x31feb6['message']});else{if(_0x480299)_0x188be1(_0x480299['message_id']);else{const _0x3618bd='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x3618bd,[_0x438fad],function(_0x5a73cd){_0x5a73cd?_0x202cba({'status':'error','message':_0x5a73cd['message']}):_0x188be1(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x56a7ec,_0x4256c0)=>{return new Promise((_0x1118b8,_0x12db4f)=>{const _0x54d64='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x4256c0;db['get'](_0x54d64,(_0xdf33c1,_0xd3cdec)=>{_0xdf33c1?_0x12db4f({'status':'error','message':_0xdf33c1['message']}):_0x1118b8({'status':'success','count':_0xd3cdec['count']});});});});const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x1dfceb,_0x310274){try{const _0x2683a8=await new Promise((_0x54ba7b,_0x33f106)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x310274],(_0x26ce72,_0x4a43e7)=>{if(_0x26ce72)_0x33f106(_0x26ce72);else{if(_0x4a43e7['length']>0x0){let _0x211157=JSON['parse'](_0x4a43e7[0x0]['cookie']);console['log'](_0x211157),_0x54ba7b(_0x211157);}else _0x33f106(new Error('User\x20with\x20username\x20'+_0x310274+'\x20does\x20not\x20exist.'));}});});await _0x1dfceb['setCookie'](..._0x2683a8),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x230035){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x230035);}}async function saveCookiesForUser(_0x19ab78,_0x5dc9b8){try{const _0x8c0582=await _0x19ab78['cookies']();if(!_0x8c0582||_0x8c0582['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x5dc9b8);const _0xba14e5=JSON['stringify'](_0x8c0582);if(_0xba14e5['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x5dc9b8);return new Promise((_0x1832b9,_0x37633c)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x5dc9b8],(_0x336877,_0x1aa073)=>{if(_0x336877)return console['error']('Error\x20checking\x20user\x20existence:',_0x336877),_0x37633c(_0x336877);if(_0x1aa073){const _0xac0cb7=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0xac0cb7['run'](_0xba14e5,_0x5dc9b8,function(_0x30bd6f){return _0x30bd6f?(console['error']('Error\x20updating\x20cookies:',_0x30bd6f),_0x37633c(_0x30bd6f)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x5dc9b8),_0x1832b9());});}else{const _0x19ec3c=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x19ec3c['run'](_0x5dc9b8,_0xba14e5,function(_0x3f70c7){return _0x3f70c7?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x3f70c7),_0x37633c(_0x3f70c7)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x5dc9b8),_0x1832b9());});}});});}catch(_0x19ca2c){console['error']('Error\x20fetching\x20cookies:',_0x19ca2c);throw _0x19ca2c;}}async function createUserIfNotExists(_0x47d924){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x47d924],(_0x58c777,_0x3388bf)=>{if(_0x58c777){console['error']('Error\x20checking\x20user\x20existence:',_0x58c777);throw _0x58c777;}else{if(!_0x3388bf){const _0x499b54=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x499b54['run'](_0x47d924,function(_0x2ea063){_0x2ea063?console['error']('Error\x20inserting\x20new\x20user:',_0x2ea063):console['log']('New\x20user\x20created:',_0x47d924);});}else console['log']('User\x20already\x20exists:',_0x47d924);}});}catch(_0x3faf3e){console['error']('Error\x20creating\x20user:',_0x3faf3e);throw _0x3faf3e;}}ipcMain['handle']('create-relation',async(_0x361c5c,_0x5ded08)=>{return new Promise((_0xf63b50,_0x1855a8)=>{const _0xca487d='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x5ded08+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0xca487d,function(_0x691f64){_0x691f64?_0x1855a8(_0x691f64):_0xf63b50({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x21793f,_0x44a911)=>{return console['log']('droping\x20table'+_0x44a911),new Promise((_0x5832b9,_0x25e2b7)=>{const _0x31bd03='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x44a911;console['log']('droping\x20table'+_0x44a911),db['run'](_0x31bd03,function(_0x16b273){_0x16b273?_0x25e2b7(_0x16b273):_0x5832b9({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x1ef4da=>{return new Promise((_0x2729a2,_0x24def5)=>{const _0x31cd78='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x31cd78,[],(_0x1bab14,_0x2eaeec)=>{_0x1bab14?_0x24def5(_0x1bab14):_0x2729a2(_0x2eaeec['map'](_0xfb1140=>_0xfb1140['name']));});});}),ipcMain['handle']('add-user',async(_0x36019b,_0xf9735f,_0x523025)=>{return new Promise(_0x215900=>{const _0x29c542=db['prepare']('INSERT\x20INTO\x20'+_0x523025+'\x20(username)\x20VALUES\x20(?)');_0x29c542['run'](_0xf9735f,function(_0x57dda0){_0x57dda0?console['log']('error\x20in\x20add-user:'+_0x57dda0):_0x215900({'status':'success','id':this['lastID']});}),_0x29c542['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x1e98be,_0x58809e)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x132a3e,_0xdb2944)=>{if(_0x132a3e)_0x58809e(_0x132a3e);else{_0x1e98be({'status':'success','users':_0xdb2944});for(_0xdb2944 of _0xdb2944){console['log'](_0xdb2944['username']);}}});});}),ipcMain['handle']('get-data',async(_0xfe8899,_0x211556)=>{return new Promise((_0x32859a,_0x2647e7)=>{const _0x15101b='SELECT\x20*\x20FROM\x20'+_0x211556;console['log'](_0x15101b),db['all'](_0x15101b,[],(_0x1d405d,_0x37c5cb)=>{_0x1d405d?_0x2647e7(_0x1d405d):_0x32859a(_0x37c5cb);});});}),ipcMain['handle']('get-accounts',async _0x21c408=>{return new Promise((_0x14d905,_0x3590fe)=>{const _0x542d04='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x542d04),igaccountsDB['all'](_0x542d04,[],(_0xc0333d,_0x39e2df)=>{_0xc0333d?_0x3590fe(_0xc0333d):_0x14d905(_0x39e2df);});});}),ipcMain['handle']('get-targets',async(_0x43a359,_0x885cc)=>{return getTargetProfiles(_0x885cc);}),ipcMain['handle']('delete-user',async(_0x38c332,_0x5566ef,_0x396616)=>{return new Promise((_0x4d18dd,_0x2ffe64)=>{const _0x403d7c=db['prepare']('DELETE\x20FROM\x20'+_0x396616+'\x20WHERE\x20username\x20=\x20?');_0x403d7c['run'](_0x5566ef,function(_0x4a69ad){_0x4a69ad?_0x2ffe64(_0x4a69ad):_0x4d18dd({'status':'success','changes':this['changes']});}),_0x403d7c['finalize']();});}),ipcMain['handle']('delete-account',async(_0x2c7618,_0x3ddc7a)=>{const _0x276f52=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x276f52['run'](_0x3ddc7a,function(_0x17c81c){_0x17c81c&&console['log'](_0x17c81c);}),_0x276f52['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x5bb03a,_0x1bc514)=>{const _0x486030='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x486030,[],(_0x3b6a67,_0x22a37f)=>{_0x3b6a67?_0x1bc514({'status':'error','message':_0x3b6a67['message']}):_0x5bb03a({'status':'success','contactedCount':_0x22a37f['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x1b52fa,_0x3af831)=>{const _0xad33ef='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0xad33ef,[],(_0x1af40c,_0x476532)=>{_0x1af40c?_0x3af831({'status':'error','message':_0x1af40c['message']}):_0x1b52fa({'status':'success','contactedCount':_0x476532['contactedCount']});});});});function exportDatabase(_0x1152ed){return new Promise((_0xa51ac0,_0x433d63)=>{const _0xec7d0e='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x1152ed+'\x0a\x20\x20\x20\x20';db['all'](_0xec7d0e,[],async(_0x475aec,_0x39ef49)=>{if(_0x475aec){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x475aec['message']),_0x433d63(_0x475aec);return;}if(!_0x39ef49||_0x39ef49['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0xa51ac0();return;}const _0xef568b=XLSX['utils']['json_to_sheet'](_0x39ef49),_0x496132=XLSX['utils']['sheet_to_csv'](_0xef568b);try{const {canceled:_0x3b0ac7,filePath:_0x44a773}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x1152ed+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x3b0ac7||!_0x44a773){console['log']('Speichern\x20abgebrochen.'),_0xa51ac0();return;}fs['writeFile'](_0x44a773,_0x496132,'utf8',_0x366bcb=>{_0x366bcb?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x366bcb['message']),_0x433d63(_0x366bcb)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x44a773),_0xa51ac0());});}catch(_0x13e692){console['error']('Fehler\x20im\x20Speicherdialog:',_0x13e692),_0x433d63(_0x13e692);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x535964,_0x48b7ec)=>{const _0x3aee34=await getBrowserPageLogin();await _0x3aee34['goto'](_0x48b7ec),console['log']('Stripe\x20startet');});