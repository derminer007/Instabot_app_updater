const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');async function extractFirstName(_0x2448f0,_0x3f3ad5){try{const _0x316d85=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x3f3ad5},'body':JSON['stringify']({'clearname':_0x2448f0})});if(!_0x316d85['ok']){const _0x4f98e5=await _0x316d85['text']();throw new Error(_0x316d85['status']+':\x20'+_0x4f98e5);}const _0x35d0ef=await _0x316d85['json']();return _0x35d0ef;}catch(_0xb8580f){console['error']('Error\x20in\x20extractFirstName:',_0xb8580f);throw _0xb8580f;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div:has(>\x20div[style=\x22height:\x20auto;\x20overflow:\x20hidden\x20auto;\x22])',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='[style=\x22line-height:\x2018px;\x22]',COM_COMMENTS_BOX_BODY_DIV='div:has(>\x20ul\x20>\x20div[role=\x22button\x22])',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Message\x27]','div.x9f619.xjbqb8w.x78zum5.x15mokao.x1ga7v0g.x16uus16.xbiv7yw.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div','div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div'],K_OPTIONS_BUTTON=['[aria-label=\x22Options\x22]','section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.x1jfgfrl\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div'],K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD=['[aria-label=\x22Message\x22]','div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f'],K_SEND_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Send\x27]','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_ALREADY_CHATTED='[aria-label=\x22Double\x20tap\x20to\x20like\x22]',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x5131a6=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x5131a6['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x5131a6['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x16ac44){var _0x3eaa43=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x2a606c){console['log']('window\x20id:'+_0x2a606c['id']),_0x2a606c['id']>0x1&&(_0x3eaa43=!![]);}),console['log']('child\x20opened\x20='+_0x3eaa43);if(!_0x3eaa43){const _0x5f0ded=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x5f0ded['loadFile'](_0x16ac44['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x21aff6=require('fs'),_0x5be232=path['join'](app['getPath']('userData'),'data'),_0x342c0c=['campaign.db','crm.db','igaccounts.db'],_0x10dacf=[];try{_0x21aff6['mkdirSync'](_0x5be232,{'recursive':!![]});for(const _0xcb2696 of _0x342c0c){const _0x485d4b=path['join'](process['resourcesPath'],'app','build','data',_0xcb2696),_0x48f882=path['join'](_0x5be232,_0xcb2696);!_0x21aff6['existsSync'](_0x48f882)?(_0x21aff6['copyFileSync'](_0x485d4b,_0x48f882),console['log']('[InitDB]\x20Kopiert\x20'+_0xcb2696+'\x20nach:\x20'+_0x48f882)):console['log']('[InitDB]\x20'+_0xcb2696+'\x20existiert\x20bereits:\x20'+_0x48f882),_0x10dacf['push'](_0x48f882);}}catch(_0x334296){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x334296);}return _0x10dacf;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x571422,AppUpdate:_0xac7b08}=require('electron-updater');_0x571422['autoDownload']=![],_0x571422['autoInstallOnAppQuit']=!![],_0x571422['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x571422['on']('update-available',_0x25db61=>{console['log']('Update\x20verfügbar:',_0x25db61),_0x571422['downloadUpdate']();}),_0x571422['on']('update-downloaded',_0x37f402=>{console['log']('Update\x20heruntergeladen:',_0x37f402),_0x571422['quitAndInstall']();}),_0x571422['on']('error',_0x4d7888=>{console['error']('Fehler\x20beim\x20Updaten:',_0x4d7888);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x914fbb,AppUpdate:_0x1f0509}=require('electron-updater');_0x914fbb['autoDownload']=![],_0x914fbb['autoInstallOnAppQuit']=!![],_0x914fbb['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x914fbb['on']('update-available',_0x57a41d=>{console['log']('Update\x20verfügbar:',_0x57a41d),_0x914fbb['downloadUpdate']();}),_0x914fbb['on']('update-downloaded',_0x5920bc=>{console['log']('Update\x20heruntergeladen:',_0x5920bc),console['log']('Neustarten\x20zum\x20Updaten');}),_0x914fbb['on']('error',_0x3bbce3=>{console['error']('Fehler\x20beim\x20Updaten:',_0x3bbce3);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x798640='',_0x20a504=null;if(process['platform']==='darwin')_0x798640=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x798640=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x798640}),_0x20a504=await browser_login['newPage'](),_0x20a504['setDefaultNavigationTimeout'](0x1d4c),_0x20a504['setDefaultTimeout'](0x1d4c),await _0x20a504['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x20a504;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x3fe134=0x1,_0x2b8536=0x0){try{let _0x2a5748='',_0x2669e9=null;const _0x11354f=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x2a5748=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x2a5748=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x3fe134===0x0&&!pageStack[_0x2b8536])return browser=await puppeteer['launch']({'headless':_0x11354f,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x2a5748}),_0x2669e9=await browser['newPage'](),_0x2669e9['setDefaultNavigationTimeout'](0x1d4c),_0x2669e9['setDefaultTimeout'](0x1d4c),await _0x2669e9['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x2b8536]=_0x2669e9,_0x2669e9;return(browser===null||pageStack[_0x2b8536]===null||pageStack[_0x2b8536]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x11354f,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x2a5748})),(pageStack[_0x2b8536]===null||pageStack[_0x2b8536]['isClosed']())&&(_0x2669e9=await browser['newPage'](),_0x2669e9['setDefaultNavigationTimeout'](0x1d4c),_0x2669e9['setDefaultTimeout'](0x1d4c),await _0x2669e9['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x2b8536]=_0x2669e9),pageStack[_0x2b8536];}catch(_0x5bd5db){console['error']('Failed\x20to\x20launch\x20browser:',_0x5bd5db);const _0x314b7c=new Error('Browser\x20konnte\x20nicht\x20gestartet\x20werden.\x20Bitte\x20starte\x20die\x20App\x20neu.\x20:\x20'+_0x5bd5db);throw _0x314b7c;}}ipcMain['on']('login',async(_0x5cd1de,_0x58f8cc)=>{const _0x34427f=await getBrowserPageLogin();await _0x34427f['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x34427f,_0x58f8cc),ipcMain['on']('setLoginCookies',async(_0x31d77e,_0x17a67b)=>{try{await set_login_cookies(_0x34427f,_0x17a67b);}catch(_0x22eeef){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x22eeef);}});}),ipcMain['on']('export-relation',async(_0x45df95,_0xb01421)=>{try{await exportDatabase(_0xb01421),_0x45df95['reply']('export-relation-response',{'success':!![]});}catch(_0x5763a1){console['error'](_0x5763a1),_0x45df95['reply']('export-relation-response',{'success':![],'message':_0x5763a1['message']});}}),ipcMain['handle']('sendMessage',async(_0x399ec0,_0x3d1b19,_0x4b4490,_0x1a575b,_0x46b97c,_0x2f5fce,_0x5775d7,_0x39c440,_0xe92d3d,_0x4afca5,_0x42c805)=>{isStopping=![];let _0xa7e91f=null;return _0x5775d7?_0xa7e91f=await getBrowserPage(_0x46b97c,_0x39c440):_0xa7e91f=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x3d1b19),send_message(_0xa7e91f,_0x3d1b19,_0x4b4490,_0x1a575b,_0x46b97c,_0x2f5fce,_0xe92d3d,_0x4afca5,_0x42c805);}),ipcMain['handle']('stop-action',async(_0x344406,_0x41a4d3)=>{isStopping=!![];const _0x189963=await getBrowserPage(0x1,_0x41a4d3);await _0x189963['close']();}),ipcMain['handle']('fetch_followers',async(_0x1615ac,_0x244284,_0x16589c,_0x1adb21,_0x6096e7,_0x1e8676)=>{isStopping=![];const _0x567cdd=await getBrowserPage();return fetch_followers_from_account(_0x1615ac,_0x567cdd,_0x244284,_0x16589c,_0x1adb21,_0x6096e7,_0x1e8676);}),ipcMain['handle']('get-account-details',async(_0x4caeab,_0x1eccf5,_0x1221f4,_0x5be4f5)=>{isStopping=![];const _0x53fdd2=await getBrowserPage();return fetch_account_details(_0x53fdd2,_0x1eccf5,_0x1221f4,_0x5be4f5);}),ipcMain['handle']('fetch_likes',async(_0x492124,_0x4f11a8,_0x49bb15,_0x18434a,_0x53c1d3,_0x43ae9c)=>{isStopping=![];const _0x4353f7=await getBrowserPage();return fetch_likers_from_post(_0x492124,_0x4353f7,_0x4f11a8,_0x49bb15,_0x18434a,_0x53c1d3,_0x43ae9c);}),ipcMain['handle']('fetch_comments',async(_0x1ca384,_0x1c0225,_0x2429b4,_0x1fe0d1,_0x4cee69,_0x341686)=>{isStopping=![];const _0x449611=await getBrowserPage();return fetch_comments_from_post(_0x1ca384,_0x449611,_0x1c0225,_0x2429b4,_0x1fe0d1,_0x4cee69,_0x341686);});async function updateAppSilent(){const {spawn:_0x430552}=require('child_process'),_0x4f89fd=require('path'),_0x11aa25=require('electron-log');return _0x11aa25['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x4c7242,_0x256e6f)=>{const {updateElectronApp:_0x3237ff,UpdateSourceType:_0x47881f}=require('update-electron-app');_0x3237ff({'updateSource':{'type':_0x47881f['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x11aa25}),_0x4c7242('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x514514,_0x73d7e6)=>{doFullElectronUpdateSilent(),_0x514514('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x2dea4c}=require('child_process'),_0x45639c=require('path'),_0x30756f=require('electron-log');return _0x30756f['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x311d1a,_0x214381)=>{const {updateElectronApp:_0x11e5da,UpdateSourceType:_0x19379b}=require('update-electron-app');_0x11e5da({'updateSource':{'type':_0x19379b['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x30756f}),_0x311d1a('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x2f2b04,_0x50cc86)=>{doFullElectronUpdate(),_0x2f2b04('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0x31a1ce,_0x3efa85)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x31a1ce('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0xe27642=path['join'](__dirname,'mac-updater-intern.sh'),_0x31bf89=spawn('/bin/bash',[_0xe27642],{'detached':!![],'stdio':'ignore'});_0x31bf89['unref'](),setTimeout(()=>{_0x31a1ce('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0x3efa85(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0x3c7d17=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x140e5d,_0x1cfcd3)=>{console['log']('Update\x20Silent:\x20'+_0x1cfcd3);if(_0x1cfcd3){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0x5cceb9,_0x1a56a9){return Math['random']()*(_0x1a56a9-_0x5cceb9+0x1)+_0x5cceb9;}function delay(_0x46e0b0,_0x58640d){let _0xc75f23=getRnd(_0x46e0b0,_0x58640d);return new Promise(function(_0x1efafb){setTimeout(_0x1efafb,_0xc75f23);});}async function scroll(_0x49df5c,_0x471401,_0x2691c2=0x2,_0x2679cd){const _0x5147fe=await _0x49df5c['waitForSelector'](_0x471401);for(let _0x2eb1e1=0x0;_0x2eb1e1<_0x2691c2;_0x2eb1e1++){console['log']('Scrolling\x20'+_0x2eb1e1),await _0x49df5c['evaluate'](_0x21500e=>{const _0x2e9704=document['querySelector'](_0x21500e);_0x2e9704&&_0x2e9704['scrollBy'](0x0,0x190);},_0x471401),await delay(0x320,0x5dc),_0x2679cd();}}async function saveCookies(_0x104e6e){let _0x10aec1=await _0x104e6e['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x10aec1,null,0x2));}async function notificationClear(_0x4bc85f){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xfa0,0x1388),await _0x4bc85f['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x4bc85f['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x2ef70b){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x2ef70b);}}async function getTargetProfiles(_0x485047){return new Promise((_0x30db52,_0x1de3ee)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x485047,(_0x54200f,_0x1b8b05)=>{_0x54200f?_0x1de3ee(_0x54200f):_0x30db52(_0x1b8b05);});});}async function login_legacy(_0x28e9c1,_0x856c1d,_0x218502){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x28e9c1,_0x856c1d),await createUserIfNotExists(_0x856c1d,_0x218502);}catch(_0x40c3bf){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x40c3bf);}try{await _0x28e9c1['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x28e9c1['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x28e9c1['click']('button._a9--._ap36._a9_0');}catch(_0x19cb09){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x28e9c1['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x28e9c1['type']('input[name=\x27username\x27]',_0x856c1d,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x28e9c1['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x28e9c1['type']('input[name=\x27password\x27]',_0x218502,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x28e9c1['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x28e9c1['click']('button[type=\x27submit\x27]');}catch(_0x1496d0){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x28e9c1),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x28e9c1,_0x856c1d);}catch(_0x51496f){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x51496f);}}catch(_0x141dee){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x141dee);}}async function login(_0x1b4985,_0x536300){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x1b4985,_0x536300),await createUserIfNotExists(_0x536300);}catch(_0x4017c6){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4017c6);}try{await _0x1b4985['goto']('https://www.instagram.com/accounts/login/');}catch(_0x386570){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x386570);}}async function set_login_cookies(_0x54367d,_0x320c97){try{await saveCookiesForUser(_0x54367d,_0x320c97);}catch(_0x26ef44){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x26ef44);}}async function waitForXPath(_0x374b9a,_0x391640,_0x3fa419={}){return await _0x374b9a['waitForFunction'](_0x3aa606=>{return document['evaluate'](_0x3aa606,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x3fa419,_0x391640),_0x374b9a['evaluateHandle'](_0x4c5754=>document['evaluate'](_0x4c5754,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x391640);}async function waitForSelectorWithFallbacks(_0x4a6e92,_0x4e93a1,_0x5c689a={}){!Array['isArray'](_0x4e93a1)&&(_0x4e93a1=[_0x4e93a1]);for(let _0x497978=0x0;_0x497978<_0x4e93a1['length'];_0x497978++){const _0x142687=_0x4e93a1[_0x497978],_0x1b293f=_0x142687['startsWith']('//')||_0x142687['startsWith']('(//');try{console['log']('Versuche\x20'+(_0x1b293f?'XPath':'Selector')+'\x20'+(_0x497978+0x1)+'/'+_0x4e93a1['length']+':\x20'+_0x142687['substring'](0x0,0x32)+'...');const _0x3b8c28=_0x497978===0x0?_0x5c689a['timeout']||0x1388:0x7d0;let _0x3ee989;if(_0x1b293f){const _0x438a20=await waitForXPath(_0x4a6e92,_0x142687,{..._0x5c689a,'timeout':_0x3b8c28});if(!_0x438a20)throw new Error('XPath-Element\x20nicht\x20gefunden');_0x3ee989=_0x438a20;}else _0x3ee989=await _0x4a6e92['waitForSelector'](_0x142687,{..._0x5c689a,'timeout':_0x3b8c28});return console['log']((_0x1b293f?'XPath':'Selector')+'\x20'+(_0x497978+0x1)+'\x20gefunden!'),_0x3ee989;}catch(_0xa39b93){console['log']((_0x1b293f?'XPath':'Selector')+'\x20'+(_0x497978+0x1)+'\x20nicht\x20gefunden:\x20'+_0xa39b93['message']);if(_0x497978===_0x4e93a1['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x4e93a1['length']+'\x20Selektoren/XPath\x20konnte\x20gefunden\x20werden:\x20'+_0xa39b93['message']);}}throw new Error('Keine\x20Selektoren/XPath\x20angegeben');}async function checkLoginStatus(_0x25a674){const _0x25529e=['[type=\x22password\x22]','//a[normalize-space(text())=\x27Log\x20In\x27]','//div[@role=\x27button\x27\x20and\x20normalize-space(.)=\x27Log\x20in\x27]','//h3[normalize-space(text())=\x27Something\x20went\x20wrong\x27]'];let _0x4baa6b=null;try{_0x4baa6b=await waitForSelectorWithFallbacks(_0x25a674,_0x25529e,{'timeout':0x7d0});}catch(_0x1fcc49){return console['log']('Eingeloggt,\x20kein\x20Login\x20notwendig:\x20'+_0x1fcc49),!![];}if(_0x4baa6b){console['log']('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return![];}else return console['log']('Eingeloggt,\x20führe\x20keine\x20Login\x20durch'),!![];}async function send_message(_0x1d8a78,_0x1c6e66,_0xd7f2e4,_0xda70b3,_0x44c476,_0x387951,_0x59459a,_0x55339a,_0x1e9ca2){return new Promise(async(_0x198677,_0x309752)=>{_0x387951=_0x387951['split'](';'),console['log'](_0x387951[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x44c476);try{await setCookiesForUser(_0x1d8a78,_0x387951[0x0]);}catch(_0x311f30){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x311f30),_0x198677({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x311f30});return;}await delay(0x6a4,0x7d0);try{await _0x1d8a78['goto']('https://www.instagram.com/'+_0x1c6e66+'/'),await delay(0x1b58,0x1d4c),await notificationClear(_0x1d8a78);}catch(_0x17f5c6){_0x198677({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x17f5c6});return;}try{await checkLoginStatus(_0x1d8a78);}catch(_0x3bba60){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x3bba60),_0x309752('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return;}console['log']('UserSkip:\x20'+_0x59459a);if(_0x59459a==0x1)try{const _0x295eef=await _0x1d8a78['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x21f782=>_0x21f782['textContent']['trim']());console['log'](_0x295eef);if(_0x295eef==='Following'||_0x295eef==='Folge\x20ich')return _0x198677({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x4d6dfc){}try{const _0x1f9bef=await waitForSelectorWithFallbacks(_0x1d8a78,K_DIRECT_MSG_BUTTON);await _0x1f9bef['click']();}catch(_0x19def8){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x19def8);try{try{const _0x4c3691=await waitForSelectorWithFallbacks(_0x1d8a78,K_OPTIONS_BUTTON);await _0x4c3691['click']();}catch(_0x3e8b12){console['log']('Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x3e8b12),_0x198677({'status':0x1f4,'message':'Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x3e8b12});return;}await delay(0x1f4,0x320);const _0x2fd12c=await waitForXPath(_0x1d8a78,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x2fd12c['click']();}catch(_0x4bccb5){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x4bccb5),_0x198677({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x1d8a78);}catch(_0x3b5cfa){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x3b5cfa);}try{const _0x4be98a=await waitForSelectorWithFallbacks(_0x1d8a78,K_CHAT_INPUT_FIELD);if(_0x55339a){const _0xc50c6e=await _0x1d8a78['$'](K_ALREADY_CHATTED);if(_0xc50c6e)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x1c6e66),_0x198677({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x18718d=await _0x1d8a78['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x18718d),_0xda70b3=_0xda70b3['replace']('{USERNAME}',_0x1c6e66);let _0x3895f6;if(_0xda70b3['includes']('{NAME}')||_0xda70b3['includes']('{name}'))try{const _0x1f6b90=await extractFirstName(_0x18718d,_0x1e9ca2);console['log']('Response\x20Clearname\x20valid:\x20'+_0x1f6b90['valid']),_0x1f6b90['valid']?(_0xda70b3=_0xda70b3['replaceAll'](/{NAME}|{name}/g,_0x1f6b90['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x1f6b90['name']),_0x3895f6=_0x1f6b90['name']):(_0xda70b3=_0xda70b3['replaceAll'](/ ?({NAME}|{name})/g,''),_0x3895f6='UNKNOWN_NAME');}catch(_0x380384){console['log'](_0x380384['message']),_0x3895f6=_0x380384['message'];let _0x5cf77d=_0x18718d['replace'](/[^\p{L}\s]/gu,''),_0x27a0c6=_0x5cf77d['split']('\x20')[0x0];_0x27a0c6['length']>0x2&&!_0x27a0c6['includes']('Instagram')?_0xda70b3=_0xda70b3['replaceAll'](/{NAME}|{name}/g,_0x27a0c6):_0xda70b3=_0xda70b3['replaceAll'](/ ?({NAME}|{name})/g,'');}console['log']('Nachricht\x20vor\x20dem\x20Senden:\x20'+_0xda70b3);const _0x2bcf61=_0xda70b3['split']('\x0a');await _0x4be98a['type'](_0x2bcf61[0x0],{'delay':getRnd(0x50,0x78)});for(let _0x3776dd=0x1;_0x3776dd<_0x2bcf61['length'];_0x3776dd++){await _0x1d8a78['keyboard']['down']('Shift'),await _0x1d8a78['keyboard']['press']('Enter'),await _0x1d8a78['keyboard']['up']('Shift'),await delay(0x64,0xc8),_0x2bcf61[_0x3776dd]['length']>0x0&&await _0x4be98a['type'](_0x2bcf61[_0x3776dd],{'delay':getRnd(0x50,0x78)});}console['log']('Nachricht\x20mit\x20Zeilenumbrüchen\x20gesendet'),await delay(0x320,0x3e8);const _0x4cb9a0=await waitForSelectorWithFallbacks(_0x1d8a78,K_SEND_MSG_BUTTON);await _0x4cb9a0['click'](),await delay(0x320,0x3e8),_0x198677({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x18718d,'extracted_clearname':_0x3895f6});}catch(_0x33e4ab){let _0x146620=_0x33e4ab;console['log']('Fehler\x20beim\x20Senden\x20der\x20Nachricht:\x20'+_0x146620),_0x198677({'status':0x1f4,'message':'Error\x20500:\x20'+_0x146620});}});}function handle_fail(_0x1fd6ad){if(isStopping)return new Promise(_0x1268b1=>{_0x1268b1('Scraper\x20gestoppt.');});else{let _0x26c1de='';switch(_0x1fd6ad){case 0x0:_0x26c1de='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x26c1de='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x26c1de='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x26c1de='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x250813,_0xe42634)=>{_0xe42634(_0x26c1de);});}}async function fetch_account_details(_0x12ca56,_0xb6924,_0x50d1b2,_0x4eb775){try{await setCookiesForUser(_0x12ca56,_0x50d1b2['username']);}catch(_0x4d546d){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x4d546d);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x4d546d);return handle_fail(0x0);}_0x12ca56['setDefaultNavigationTimeout'](0x7530),await _0x12ca56['goto']('https://www.instagram.com/'+_0xb6924+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x12ca56);const _0x13079d=await _0x12ca56['evaluate'](()=>{const _0x1785a3=document['querySelector']('meta[property=\x22og:image\x22]');return _0x1785a3?_0x1785a3['getAttribute']('content'):null;});await _0x12ca56['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x212639=await _0x12ca56['evaluate'](()=>{const _0x5f1301=document['querySelector']('meta[name=\x22description\x22]');if(!_0x5f1301)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x1957b6=_0x5f1301['getAttribute']('content');if(!_0x1957b6)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x1957b6);const _0x54252e=/\s*[–-]\s*/,_0x1de2b4=_0x1957b6['split'](_0x54252e);if(_0x1de2b4['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x42e7be=_0x1de2b4[0x0],_0x3dab86=_0x1de2b4[0x1],_0xd14f6f=_0x42e7be['split'](',\x20');if(_0xd14f6f['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x12773c=_0xd14f6f[0x0]['split']('\x20')[0x0],_0x5f2403=_0xd14f6f[0x1]['split']('\x20')[0x0],_0xa9db74=_0xd14f6f[0x2]['split']('\x20')[0x0];let _0x16a9c5='',_0x32a7b7='';const _0x5a52f9='\x20on\x20Instagram:\x20',_0x14f45b=_0x3dab86['split'](_0x5a52f9);return _0x16a9c5=_0x14f45b[0x0]['trim'](),_0x16a9c5=_0x16a9c5['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x14f45b['length']>0x1&&(_0x32a7b7=_0x14f45b[0x1]['trim'](),_0x32a7b7['startsWith']('\x22')&&_0x32a7b7['endsWith']('\x22')&&(_0x32a7b7=_0x32a7b7['substring'](0x1,_0x32a7b7['length']-0x1)['trim']()),_0x32a7b7=_0x32a7b7['replace'](/&quot;/g,'')['trim']()),{'followers':_0x12773c,'following':_0x5f2403,'posts':_0xa9db74,'nameText':_0x16a9c5,'bio':_0x32a7b7};});console['log']('Extracted\x20profile\x20data:',_0x212639);const _0x1bdfce=_0x212639['nameText'],_0x43f995=_0x13079d,_0x6bf6bf=_0x212639['bio'],_0x28e2db=_0x212639['followers'],_0x2aa7a2=_0x212639['following'],_0x3c70e9=_0x212639['posts'],_0x40cf47=![],_0x485815=![],_0x449f77=![],_0x249538='\x0a\x20\x20INSERT\x20INTO\x20'+_0x4eb775+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x249538,[_0xb6924,_0x1bdfce,_0x43f995,_0x6bf6bf,_0x28e2db,_0x2aa7a2,_0x3c70e9,_0x40cf47,_0x485815,_0x449f77],function(_0xa616cf){_0xa616cf?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0xa616cf['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x13f1d8,_0x2c9a4d,_0x2dfb97,_0x421409,_0x1698fe,_0x59ed1d,_0x1ab8d4){let _0x4e228b=0x4,_0x335e06=0x0,_0x36f45e=0x0;try{await setCookiesForUser(_0x2c9a4d,_0x59ed1d['username']);}catch(_0x5c9ffe){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x5c9ffe);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x5c9ffe);return handle_fail(0x0);}let _0x29d692=0x0;try{await _0x2c9a4d['goto']('https://www.instagram.com/'+_0x2dfb97+'/'),await notificationClear(_0x2c9a4d);try{if(_0x421409<=0x0){const _0x579cce=await _0x2c9a4d['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x36469a=await _0x2c9a4d['evaluate'](_0x329ea4=>_0x329ea4['innerHTML'],_0x579cce);_0x29d692=Math['ceil'](_0x36469a/0x4);}else _0x29d692=Math['ceil'](_0x421409/0x4);_0x4e228b+=_0x29d692,_0x36f45e=Math['round'](++_0x335e06/_0x4e228b*0x64),_0x13f1d8['sender']['send']('fetch-progress',_0x36f45e,!![]);let _0x1815b2=await _0x2c9a4d['waitForSelector']('a[href=\x22/'+_0x2dfb97+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x1815b2['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x2dfb97+'\x20gesichtet'),_0x36f45e=Math['round'](++_0x335e06/_0x4e228b*0x64),_0x13f1d8['sender']['send']('fetch-progress',_0x36f45e,!![]);}catch(_0x58146e){console['log']('Follower\x20Liste\x20von\x20'+_0x2dfb97+'\x20nicht\x20gefunden:'+_0x58146e);throw new Error('Follower\x20Liste\x20von\x20'+_0x2dfb97+'\x20nicht\x20gefunden:'+_0x58146e);return handle_fail(0x0);}}catch(_0xe5a398){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0xe5a398);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0xe5a398);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x29d692),await scroll(_0x2c9a4d,FOLLOWER_FENSTER,_0x29d692,_0x4134f9=>{_0x36f45e=Math['round'](++_0x335e06/_0x4e228b*0x64),_0x13f1d8['sender']['send']('fetch-progress',_0x36f45e,!![]);}),await _0x2c9a4d['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0xaebf01=await _0x2c9a4d['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x4e3b8b=await _0x2c9a4d['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x36f45e=Math['round'](++_0x335e06/_0x4e228b*0x64),_0x13f1d8['sender']['send']('fetch-progress',_0x36f45e,!![]);_0x421409<=0x0&&(_0x421409=_0xaebf01['length']);let _0x42ce19=[];for(let _0x4548d0=0x0;_0x4548d0<_0xaebf01['length']&&_0x4548d0<_0x421409;_0x4548d0++){_0x42ce19['push'](await _0xaebf01[_0x4548d0]['evaluate'](_0x9ebb6a=>_0x9ebb6a['textContent']));const _0x374eea='INSERT\x20INTO\x20'+_0x1698fe+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x374eea,[await _0xaebf01[_0x4548d0]['evaluate'](_0x95042d=>_0x95042d['textContent']),await _0x4e3b8b[_0x4548d0]['evaluate'](_0x25b613=>_0x25b613['textContent'])],function(_0x5a670d){_0x5a670d?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x1698fe+'\x27:',_0x5a670d['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x36f45e=Math['round'](++_0x335e06/_0x4e228b*0x64),_0x13f1d8['sender']['send']('fetch-progress',_0x36f45e,!![]),_0x1ab8d4&&(_0x13f1d8['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x13f1d8,_0x2c9a4d,_0x59ed1d,_0x1698fe,_0x42ce19)),new Promise(_0x5d3bb8=>{_0x5d3bb8('Scraping\x20finished!');});}catch(_0x128f46){if(_0x1ab8d4)throw new Error(_0x128f46);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x2dfb97+'\x20nicht\x20gefunden:\x20'+_0x128f46);return handle_fail(0x0);}}async function fetch_details_from_list(_0x1f5d9d,_0x46d135,_0x426781,_0x564b49,_0x2712b3){let _0x531e28=0x0,_0x47ef0a=0x0;for(let _0x54b97f=0x0;_0x54b97f<_0x2712b3['length'];_0x54b97f++){console['log']('Processing\x20profile:',_0x2712b3[_0x54b97f]);try{await fetch_account_details(_0x46d135,_0x2712b3[_0x54b97f],_0x426781,_0x564b49);}catch(_0x134502){console['error']('Detailed\x20Scraping\x20von:\x20',_0x2712b3[_0x54b97f],_0x134502);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x2712b3[_0x54b97f]+'\x20'+_0x134502);}_0x47ef0a=Math['round'](++_0x531e28/_0x2712b3['length']*0x64),_0x1f5d9d['sender']['send']('fetch-progress',_0x47ef0a,!![],!![]);}}async function fetch_likers_from_post(_0x20b367,_0x2c1a55,_0x47efeb,_0x487070,_0x40f1f0,_0x4c5b14,_0x2b2eba){let _0x2051ef=0x4,_0x59105a=0x0,_0x3d18c0=0x0;try{await setCookiesForUser(_0x2c1a55,_0x4c5b14['username']);}catch(_0x3abf7d){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x3abf7d);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x3abf7d);return handle_fail(0x1);return;}_0x3d18c0=Math['round'](++_0x59105a/_0x2051ef*0x64),_0x20b367['sender']['send']('fetch-progress',_0x3d18c0,!![]);try{let _0x51f80d=_0x47efeb['substring'](0x0,_0x47efeb['lastIndexOf']('/'));_0x51f80d['includes']('/reel/')&&(_0x51f80d=_0x51f80d['replace']('/reel/','/p/'));let _0x39d273=_0x51f80d+'/liked_by';console['log'](_0x39d273),await _0x2c1a55['goto'](_0x39d273),await delay(0x7d0,0xfa0),await notificationClear(_0x2c1a55),await delay(0xc8,0x1f4),_0x3d18c0=Math['round'](++_0x59105a/_0x2051ef*0x64),_0x20b367['sender']['send']('fetch-progress',_0x3d18c0,!![]),await _0x2c1a55['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x53d684=await _0x2c1a55['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x5ccba9=await _0x2c1a55['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x53d684['length']);let _0x3166b6=path['join'](__dirname,'/likers.csv');_0x3d18c0=Math['round'](++_0x59105a/_0x2051ef*0x64),_0x20b367['sender']['send']('fetch-progress',_0x3d18c0,!![]);_0x487070<=0x0&&(_0x487070=_0x53d684['length']);try{let _0x1bd853=[];for(let _0xbccaf6=0x0;_0xbccaf6<_0x53d684['length']&&_0xbccaf6<_0x487070;_0xbccaf6++){_0x1bd853['push'](await _0x53d684[_0xbccaf6]['evaluate'](_0x18fb85=>_0x18fb85['textContent']));try{const _0x3f0b48='INSERT\x20INTO\x20'+_0x40f1f0+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x3f0b48,[await _0x53d684[_0xbccaf6]['evaluate'](_0x482f20=>_0x482f20['textContent']),await _0x5ccba9[_0xbccaf6]['evaluate'](_0x124f97=>_0x124f97['textContent'])],function(_0x2f580c){_0x2f580c?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x40f1f0+'\x27:',_0x2f580c['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x32067a){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0xbccaf6+'\x20:\x20'+_0x32067a);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0xbccaf6+'\x20:\x20'+_0x32067a);return handle_fail(0x1);}}return _0x3d18c0=Math['round'](++_0x59105a/_0x2051ef*0x64),_0x20b367['sender']['send']('fetch-progress',_0x3d18c0,!![]),_0x2b2eba&&(_0x20b367['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x20b367,_0x2c1a55,_0x4c5b14,_0x40f1f0,_0x1bd853)),new Promise(_0x3f0579=>{_0x3f0579('Scraping\x20finished!');});}catch(_0x4d7f79){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x4d7f79);return handle_fail(0x1);}}catch(_0x3625c4){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x3625c4);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x3625c4);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x4d7699,_0x2f8151,_0xb67a7,_0x183620,_0x162e9a,_0x489813,_0x54b329){let _0x4fab46=0x3,_0x32d1b3=0x0,_0x5d6c69=0x0;try{await setCookiesForUser(_0x2f8151,_0x489813['username']);}catch(_0x1671f0){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x1671f0);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x1671f0);return handle_fail(0x2);}try{console['log'](_0xb67a7),await _0x2f8151['goto'](_0xb67a7),await delay(0x7d0,0xfa0),await notificationClear(_0x2f8151),await delay(0xc8,0x1f4);const _0x1f7c43=COM_COMMENTS_BOX_BODY_DIV;let _0x9de9ec;const _0x5ec213=await _0x2f8151['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x442f10=await _0x2f8151['evaluate'](_0xd00375=>_0xd00375['innerHTML'],_0x5ec213),_0xfa9db7=String(_0x442f10)['replace'](/[^0-9]/g,''),_0x34908c=Number(_0xfa9db7)/0x14;_0x183620<=0x0?_0x9de9ec=Math['ceil'](_0x34908c/0x3):_0x9de9ec=Math['ceil'](_0x183620/0x3);_0x4fab46+=_0x9de9ec,_0x5d6c69=Math['round'](++_0x32d1b3/_0x4fab46*0x64),_0x4d7699['sender']['send']('fetch-progress',_0x5d6c69,!![]),console['log']('Auto-scrolls:\x20'+_0x9de9ec),await scroll(_0x2f8151,_0x1f7c43,_0x9de9ec,_0xd8c279=>{_0x5d6c69=Math['round'](++_0x32d1b3/_0x4fab46*0x64),_0x4d7699['sender']['send']('fetch-progress',_0x5d6c69,!![]);});try{const _0x3a0d91=COM_REPLY_BUTTON_SPAN;await _0x2f8151['waitForSelector'](_0x3a0d91),await delay(0x1f4,0x320);const _0x2d0fdd=await _0x2f8151['$$'](_0x3a0d91);console['log'](_0x2d0fdd);let _0x269d2a=_0x2d0fdd['length'];await delay(0xc8,0x1f4);try{for(let _0x470699=0x0;_0x470699<_0x269d2a;_0x470699++){_0x2d0fdd[_0x470699]['click'](),await delay(0x320,0x5dc);}}catch(_0x1edc17){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x1edc17);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x1edc17);return handle_fail(0x2);}}catch(_0x531d68){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x8711de=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x2f8151['waitForSelector'](_0x8711de),await delay(0x1f4,0x320),_0x5d6c69=Math['round'](++_0x32d1b3/_0x4fab46*0x64),_0x4d7699['sender']['send']('fetch-progress',_0x5d6c69,!![]);const _0x45e95e=await _0x2f8151['$$'](_0x8711de);let _0x11fc55=path['join'](__dirname,'/comments.csv');_0x183620<=0x0&&(_0x183620=_0x45e95e['length']);console['log']('fetch_limit:\x20'+_0x183620),console['log']('comments_len:\x20'+_0x45e95e['length']),_0x183620++;try{let _0x4a1711=[];for(let _0x379d49=0x1;_0x379d49<_0x45e95e['length']&&_0x379d49<_0x183620;_0x379d49++){try{_0x4a1711['push'](await _0x45e95e[_0x379d49]['evaluate'](_0x8feaf9=>_0x8feaf9['textContent']));const _0x4b4cb2=await db['prepare']('INSERT\x20INTO\x20'+_0x162e9a+'\x20(username)\x20VALUES\x20(?)');await _0x4b4cb2['run'](await _0x45e95e[_0x379d49]['evaluate'](_0xf5ee38=>_0xf5ee38['textContent']),function(_0xe13806){_0xe13806&&console['log']('error\x20in\x20add-user:'+_0xe13806);}),await _0x4b4cb2['finalize']();}catch(_0x29ab0a){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x379d49+'\x20:\x20'+_0x29ab0a);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x379d49+'\x20:\x20'+_0x29ab0a);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x5d6c69=Math['round'](++_0x32d1b3/_0x4fab46*0x64),_0x4d7699['sender']['send']('fetch-progress',_0x5d6c69,!![]),_0x4d7699['sender']['send']('fetch-progress',0x64,!![]),_0x54b329&&(_0x4d7699['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x4d7699,_0x2f8151,_0x489813,_0x162e9a,_0x4a1711)),_0x4d7699['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x2f6e5c=>{_0x2f6e5c('Scraping\x20finished!');});}catch(_0x4b7e7c){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x4b7e7c);return handle_fail(0x2);}}catch(_0x4597d0){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x4597d0);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x4597d0);return handle_fail(0x2);}}async function set_clearname_from_username(_0x4d8962,_0x31d992,_0x1dfa2b=null){try{let _0x53dd57,_0x59ff72;const _0x49efeb='SELECT\x20username\x20FROM\x20'+_0x31d992+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x49efeb,[],(_0x5f3ca7,_0x1ec894)=>{_0x5f3ca7&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x5f3ca7['message']),_0x1ec894['length']===0x0&&(_0x59ff72=_0x1ec894['length']),_0x53dd57=_0x1ec894['map'](_0x40041c=>_0x40041c['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x59ff72);if(_0x59ff72===0x0){console['log']('Leave');return;}const _0x4a0562=await _0x4d8962['waitForSelector'](IG_SEARCH_BUTTON);await _0x4a0562['click'](),await delay(0x4b0,0x7d0);for(let _0x75fc4e of _0x53dd57){const _0x33bdfb=await _0x4d8962['waitForSelector'](IG_SEARCH_INPUT);await _0x33bdfb['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x4d8962['type'](IG_SEARCH_INPUT,_0x75fc4e,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x1d5589=0x1;while(_0x1d5589!=0x14){console['log']('Schleife');try{let _0x566432=IG_NAME_SPAN_PART1+_0x1d5589+IG_USERNAME_SPAN_PART2;const _0x1acf71=await _0x4d8962['waitForSelector'](_0x566432),_0x4281b7=await _0x4d8962['evaluate'](_0x1d44bb=>_0x1d44bb['innerHTML'],_0x1acf71);await delay(0xc8,0x1f4);if(_0x4281b7==_0x75fc4e){let _0x56669e=IG_NAME_SPAN_PART1+_0x1d5589+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x220d65=await _0x4d8962['waitForSelector'](_0x56669e);let _0x165a23=await _0x4d8962['evaluate'](_0x5bc5c1=>_0x5bc5c1['innerHTML'],_0x220d65);const _0x4cb22b=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x3afd26=_0x165a23['match'](_0x4cb22b);_0x3afd26?_0x165a23=_0x3afd26[0x1]['trim']():_0x165a23=_0x165a23['trim']();_0x165a23['includes']('•')&&(_0x165a23=_0x165a23['substring'](0x0,_0x165a23['indexOf']('•')-0x1));const _0x229d7f='UPDATE\x20'+_0x31d992+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x229d7f,[_0x165a23,_0x4281b7],function(_0xaf383f){_0xaf383f&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0xaf383f['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x1d5589++;}catch(_0x375b1d){const _0x5a5f89='UPDATE\x20'+_0x31d992+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x5a5f89,['',_0x75fc4e],function(_0x5703f1){_0x5703f1&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x5703f1['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x375b1d);break;}}_0x1dfa2b&&_0x1dfa2b();}await _0x4a0562['click']();}catch(_0x352a97){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x352a97);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x30385f,_0x1a0235)=>{const _0xd644fc='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0xd644fc,[],(_0x238b14,_0x2620da)=>{_0x238b14?_0x1a0235(_0x238b14):_0x30385f(_0x2620da);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x1950e6,_0x41e767)=>{const _0x344672='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x344672,[],async(_0x5db00f,_0x2d314a)=>{if(_0x5db00f)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x5db00f['message']),_0x41e767({'status':'error','message':_0x5db00f['message']});else try{const _0x1fd989=await Promise['all'](_0x2d314a['map'](_0x6ced0c=>{return new Promise(_0x17f326=>{if(!_0x6ced0c['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x6ced0c['campaign_name']),_0x17f326({'campaign_name':_0x6ced0c['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x464b69='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x6ced0c['list_id'],_0x5807f3='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x6ced0c['list_id']+'\x22';db['get'](_0x464b69,[],(_0x38b825,_0xa90bf3)=>{_0x38b825?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x6ced0c['campaign_name']+':',_0x38b825['message']),_0x17f326({'campaign_name':_0x6ced0c['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x5807f3,[],(_0x3331cc,_0x1fcc8b)=>{_0x3331cc?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x6ced0c['campaign_name']+':',_0x3331cc['message']),_0x17f326({'campaign_name':_0x6ced0c['campaign_name'],'lead_count':_0xa90bf3?_0xa90bf3['lead_count']:0x0,'contacted_count':'N/A'})):_0x17f326({'campaign_name':_0x6ced0c['campaign_name'],'lead_count':_0xa90bf3?_0xa90bf3['lead_count']:0x0,'contacted_count':_0x1fcc8b?_0x1fcc8b['contacted_count']:0x0});});});});}));_0x1950e6({'status':'success','campaigns':_0x1fd989});}catch(_0x14b99d){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x14b99d),_0x41e767({'status':'error','message':_0x14b99d['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x4f4fad,_0x27201d)=>{return new Promise((_0x13194e,_0x4d916d)=>{const _0x55e2fa='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x55e2fa,[_0x27201d],(_0x5aa233,_0x2bcaa0)=>{_0x5aa233?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x5aa233),_0x4d916d(_0x5aa233)):(console['log']('ROWS'),console['log'](_0x2bcaa0),debugDatabaseContents(),_0x13194e(_0x2bcaa0));});});});const showTableContents=_0x5251a5=>{return new Promise((_0xc61289,_0x216255)=>{const _0x5ed106='SELECT\x20*\x20FROM\x20'+_0x5251a5+';';campaignDB['all'](_0x5ed106,(_0x4d5776,_0x35d1af)=>{_0x4d5776?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x5251a5+':',_0x4d5776),_0x216255(_0x4d5776)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x5251a5+':',_0x35d1af),_0xc61289({'status':'success','message':_0x35d1af}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x10016d){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x10016d);}}ipcMain['handle']('create-campaign',async(_0x44eb44,_0x2e783e)=>{return new Promise((_0x584de1,_0x4320ab)=>{const _0x5106df='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x5106df,[String(_0x2e783e)],function(_0x549e01){_0x549e01?_0x4320ab(_0x549e01):_0x584de1({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x57f92a,_0x20a8d7)=>{return new Promise((_0x2cd528,_0x3128ed)=>{const _0x587573='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x587573,[_0x20a8d7],function(_0x5d5a18){_0x5d5a18?_0x3128ed(_0x5d5a18):_0x2cd528({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x2c643b,_0x1d7550,_0x4ad4fe,_0x3b5a9b,_0x3f6984,_0x33d2de,_0x1e138f,_0x4818aa)=>{const _0x35c5d1=await createMessageID(_0x3f6984);return new Promise((_0x4c19ad,_0x47d693)=>{if(!_0x1d7550||!_0x4ad4fe||!_0x3b5a9b||!_0x35c5d1||!_0x33d2de)return _0x47d693({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x35c5d1);const _0x1f836a='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x1f836a,[_0x4ad4fe,_0x3b5a9b,_0x35c5d1,_0x33d2de,_0x1e138f,_0x4818aa,_0x1d7550],function(_0x2d9c8b){if(_0x2d9c8b)_0x47d693({'status':'error','message':_0x2d9c8b['message']});else this['changes']===0x0?_0x47d693({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x4c19ad({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x231fe6,_0x45bafc,_0x181a1a,_0x1f371d,_0x4466f6)=>{return new Promise((_0x22c621,_0x519a11)=>{const _0x31069d='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x31069d,[_0x45bafc,_0x181a1a,_0x1f371d,_0x4466f6],function(_0x56f6d5){return _0x56f6d5?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x56f6d5['message']),_0x519a11('insert-dm-response',{'success':![],'message':_0x56f6d5['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x22c621('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x475f61=>{return new Promise((_0x308ba9,_0x166138)=>{const _0x4c3410='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x4c3410,[_0x475f61],(_0x5e958e,_0x47c52c)=>{if(_0x5e958e)_0x166138({'status':'error','message':_0x5e958e['message']});else{if(_0x47c52c)_0x308ba9(_0x47c52c['message_id']);else{const _0x5ebcaa='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x5ebcaa,[_0x475f61],function(_0x3b6392){_0x3b6392?_0x166138({'status':'error','message':_0x3b6392['message']}):_0x308ba9(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x5063bd,_0x4b9fbb)=>{return new Promise((_0x347058,_0xac6ba7)=>{const _0x1d3dae='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x4b9fbb;db['get'](_0x1d3dae,(_0x4b7cef,_0xdf95d8)=>{_0x4b7cef?_0xac6ba7({'status':'error','message':_0x4b7cef['message']}):_0x347058({'status':'success','count':_0xdf95d8['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x9cacf4,_0x3a6250){try{const _0x16e4c5=await new Promise((_0x4e3543,_0x534cf1)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x3a6250],(_0x10b4b2,_0x1ee0a3)=>{if(_0x10b4b2)_0x534cf1(_0x10b4b2);else{if(_0x1ee0a3['length']>0x0){let _0x450e8c=JSON['parse'](_0x1ee0a3[0x0]['cookie']);console['log'](_0x450e8c),_0x4e3543(_0x450e8c);}else _0x534cf1(new Error('User\x20with\x20username\x20'+_0x3a6250+'\x20does\x20not\x20exist.'));}});});await _0x9cacf4['setCookie'](..._0x16e4c5),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x158651){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x158651);}}async function saveCookiesForUser(_0x1b49de,_0x166eb5){try{const _0x2fa906=await _0x1b49de['cookies']();if(!_0x2fa906||_0x2fa906['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x166eb5);const _0x193ea5=JSON['stringify'](_0x2fa906);if(_0x193ea5['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x166eb5);return new Promise((_0xd4f2ad,_0x47c8fd)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x166eb5],(_0x26ca19,_0x46eb89)=>{if(_0x26ca19)return console['error']('Error\x20checking\x20user\x20existence:',_0x26ca19),_0x47c8fd(_0x26ca19);if(_0x46eb89){const _0x519bde=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x519bde['run'](_0x193ea5,_0x166eb5,function(_0x1f7368){return _0x1f7368?(console['error']('Error\x20updating\x20cookies:',_0x1f7368),_0x47c8fd(_0x1f7368)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x166eb5),_0xd4f2ad());});}else{const _0x2aa63b=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x2aa63b['run'](_0x166eb5,_0x193ea5,function(_0x38fa47){return _0x38fa47?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x38fa47),_0x47c8fd(_0x38fa47)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x166eb5),_0xd4f2ad());});}});});}catch(_0x3d58fc){console['error']('Error\x20fetching\x20cookies:',_0x3d58fc);throw _0x3d58fc;}}async function createUserIfNotExists(_0x8c5a41){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x8c5a41],(_0xea50d4,_0x240b5d)=>{if(_0xea50d4){console['error']('Error\x20checking\x20user\x20existence:',_0xea50d4);throw _0xea50d4;}else{if(!_0x240b5d){const _0x28f41f=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x28f41f['run'](_0x8c5a41,function(_0x220961){_0x220961?console['error']('Error\x20inserting\x20new\x20user:',_0x220961):console['log']('New\x20user\x20created:',_0x8c5a41);});}else console['log']('User\x20already\x20exists:',_0x8c5a41);}});}catch(_0x44cfd2){console['error']('Error\x20creating\x20user:',_0x44cfd2);throw _0x44cfd2;}}ipcMain['handle']('create-relation',async(_0x13076b,_0xf1ca86)=>{return new Promise((_0x4f944b,_0x26ea70)=>{const _0x28cbd9='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0xf1ca86+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x28cbd9,function(_0x421419){_0x421419?_0x26ea70(_0x421419):_0x4f944b({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x1cf4db,_0x444284)=>{return console['log']('droping\x20table'+_0x444284),new Promise((_0x2a8f18,_0x32bf0e)=>{const _0x28e66b='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x444284;console['log']('droping\x20table'+_0x444284),db['run'](_0x28e66b,function(_0x567aa7){_0x567aa7?_0x32bf0e(_0x567aa7):_0x2a8f18({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x316744=>{return new Promise((_0x379d55,_0x5a65f6)=>{const _0x35c78c='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x35c78c,[],(_0x34dda1,_0x16a0fd)=>{_0x34dda1?_0x5a65f6(_0x34dda1):_0x379d55(_0x16a0fd['map'](_0x467579=>_0x467579['name']));});});}),ipcMain['handle']('add-user',async(_0x5956d2,_0x379c13,_0x24abe5)=>{return new Promise(_0x296253=>{const _0x62ad46=db['prepare']('INSERT\x20INTO\x20'+_0x24abe5+'\x20(username)\x20VALUES\x20(?)');_0x62ad46['run'](_0x379c13,function(_0x51c8bd){_0x51c8bd?console['log']('error\x20in\x20add-user:'+_0x51c8bd):_0x296253({'status':'success','id':this['lastID']});}),_0x62ad46['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x5d469a,_0x54777d)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x3c8611,_0x27b760)=>{if(_0x3c8611)_0x54777d(_0x3c8611);else{_0x5d469a({'status':'success','users':_0x27b760});for(_0x27b760 of _0x27b760){console['log'](_0x27b760['username']);}}});});}),ipcMain['handle']('get-data',async(_0x15d7cf,_0x4d3f0c)=>{return new Promise((_0x1c906c,_0x4929a4)=>{const _0x4f0159='SELECT\x20*\x20FROM\x20'+_0x4d3f0c;console['log'](_0x4f0159),db['all'](_0x4f0159,[],(_0x39d18c,_0x22446c)=>{_0x39d18c?_0x4929a4(_0x39d18c):_0x1c906c(_0x22446c);});});}),ipcMain['handle']('get-accounts',async _0x1b4ba7=>{return new Promise((_0x2ddac9,_0x26708e)=>{const _0x31df9a='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x31df9a),igaccountsDB['all'](_0x31df9a,[],(_0x5cfb3c,_0x3ee711)=>{_0x5cfb3c?_0x26708e(_0x5cfb3c):_0x2ddac9(_0x3ee711);});});}),ipcMain['handle']('get-targets',async(_0x103f77,_0x3c005c)=>{return getTargetProfiles(_0x3c005c);}),ipcMain['handle']('delete-user',async(_0x5d1e8a,_0x1870b6,_0x50a142)=>{return new Promise((_0x5e022a,_0x4ae5da)=>{const _0x5a66f0=db['prepare']('DELETE\x20FROM\x20'+_0x50a142+'\x20WHERE\x20username\x20=\x20?');_0x5a66f0['run'](_0x1870b6,function(_0x19ba58){_0x19ba58?_0x4ae5da(_0x19ba58):_0x5e022a({'status':'success','changes':this['changes']});}),_0x5a66f0['finalize']();});}),ipcMain['handle']('delete-account',async(_0x385065,_0x15e9ef)=>{const _0x16df93=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x16df93['run'](_0x15e9ef,function(_0x16ccdd){_0x16ccdd&&console['log'](_0x16ccdd);}),_0x16df93['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x51cea5,_0x5a20f9)=>{const _0x99581e='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x99581e,[],(_0x59634e,_0x18ddff)=>{_0x59634e?_0x5a20f9({'status':'error','message':_0x59634e['message']}):_0x51cea5({'status':'success','contactedCount':_0x18ddff['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x2d8993,_0x529c49)=>{const _0x2ecfd1='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x2ecfd1,[],(_0x48add7,_0x2e3ab7)=>{_0x48add7?_0x529c49({'status':'error','message':_0x48add7['message']}):_0x2d8993({'status':'success','contactedCount':_0x2e3ab7['contactedCount']});});});});function exportDatabase(_0xc5e480){return new Promise((_0x499d03,_0x13b81d)=>{const _0x26e5dd='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0xc5e480+'\x0a\x20\x20\x20\x20';db['all'](_0x26e5dd,[],async(_0x5c0673,_0x45bce0)=>{if(_0x5c0673){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x5c0673['message']),_0x13b81d(_0x5c0673);return;}if(!_0x45bce0||_0x45bce0['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x499d03();return;}const _0x41df9b=XLSX['utils']['json_to_sheet'](_0x45bce0),_0x392448=XLSX['utils']['sheet_to_csv'](_0x41df9b);try{const {canceled:_0x137656,filePath:_0x59bf4b}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0xc5e480+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x137656||!_0x59bf4b){console['log']('Speichern\x20abgebrochen.'),_0x499d03();return;}fs['writeFile'](_0x59bf4b,_0x392448,'utf8',_0x19ca97=>{_0x19ca97?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x19ca97['message']),_0x13b81d(_0x19ca97)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x59bf4b),_0x499d03());});}catch(_0x5146ea){console['error']('Fehler\x20im\x20Speicherdialog:',_0x5146ea),_0x13b81d(_0x5146ea);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x45942e,_0x35d044)=>{shell['openExternal'](_0x35d044);});