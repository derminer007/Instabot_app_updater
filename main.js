const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');function quoteIdent(_0x3c2319){if(_0x3c2319===undefined||_0x3c2319===null)throw new Error('Invalid\x20identifier');const _0x437944=String(_0x3c2319),_0x154f09=_0x437944['replace'](/"/g,'\x22\x22');return'\x22'+_0x154f09+'\x22';}async function extractFirstName(_0x5ac47a,_0x4b5ebb){try{const _0x39a67b=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x4b5ebb},'body':JSON['stringify']({'clearname':_0x5ac47a})});if(!_0x39a67b['ok']){const _0x1c1ff5=await _0x39a67b['text']();throw new Error(_0x39a67b['status']+':\x20'+_0x1c1ff5);}const _0x376229=await _0x39a67b['json']();return _0x376229;}catch(_0x35ed79){console['error']('Error\x20in\x20extractFirstName:',_0x35ed79);throw _0x35ed79;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div:has(>\x20div[style=\x22height:\x20auto;\x20overflow:\x20hidden\x20auto;\x22])',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='[style=\x22line-height:\x2018px;\x22]',COM_COMMENTS_BOX_BODY_DIV='div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='//span[contains(.,\x20\x27View\x20all\x27)\x20and\x20contains(.,\x20\x27replies\x27)]',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Message\x27]','div.x9f619.xjbqb8w.x78zum5.x15mokao.x1ga7v0g.x16uus16.xbiv7yw.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div','div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div'],K_OPTIONS_BUTTON=['[aria-label=\x22Options\x22]','section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.x1jfgfrl\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div'],K_EXPAND_MSG_BUTTON='[aria-label=\x22Expand\x22]',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD=['[aria-label=\x22Message\x22]','div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f'],K_SEND_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Send\x27]','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_ALREADY_CHATTED='[aria-label=\x22Like\x22]',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',K_BEITRAG_ARRAY_SELECTOR='._aagv',K_BEITRAG_LIKE_BUTTON='section\x20>\x20span\x20>\x20div\x20>\x20div',K_STORY_ARRAY_SELECTOR='._acaz',K_STORY_LIKE_BUTTON='div.x6s0dn4.x78zum5.x67bb7w\x20>\x20div.x78zum5.xvc5jky\x20>\x20span\x20>\x20div\x20>\x20div',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x38d100=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x38d100['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x38d100['webContents']['openDevTools']();}app['whenReady']()['then'](async()=>{try{await initOptionsDb(),console['log']('[OptionsDB]\x20initialisiert:',path['join'](SqlDataDirectory,'options.db'));}catch(_0x5bb123){console['error']('[OptionsDB]\x20Initialisierung\x20fehlgeschlagen:',_0x5bb123);}})['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x48ad63){var _0x2a98d6=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x2039a2){console['log']('window\x20id:'+_0x2039a2['id']),_0x2039a2['id']>0x1&&(_0x2a98d6=!![]);}),console['log']('child\x20opened\x20='+_0x2a98d6);if(!_0x2a98d6){const _0x5789de=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x5789de['loadFile'](_0x48ad63['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));try{optionsDb&&(optionsDb['close'](),optionsDb=null,console['log']('[OptionsDB]\x20geschlossen.'));}catch(_0x484269){console['warn']('[OptionsDB]\x20Fehler\x20beim\x20Schließen:',_0x484269?.['message']||_0x484269);}if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x3a292f=require('fs'),_0x175dd1=path['join'](app['getPath']('userData'),'data'),_0x5259ae=['campaign.db','crm.db','igaccounts.db'],_0x4b9f3d=[];try{_0x3a292f['mkdirSync'](_0x175dd1,{'recursive':!![]});for(const _0x124ee6 of _0x5259ae){const _0xf6f0e3=path['join'](process['resourcesPath'],'app','build','data',_0x124ee6),_0x17f816=path['join'](_0x175dd1,_0x124ee6);!_0x3a292f['existsSync'](_0x17f816)?(_0x3a292f['copyFileSync'](_0xf6f0e3,_0x17f816),console['log']('[InitDB]\x20Kopiert\x20'+_0x124ee6+'\x20nach:\x20'+_0x17f816)):console['log']('[InitDB]\x20'+_0x124ee6+'\x20existiert\x20bereits:\x20'+_0x17f816),_0x4b9f3d['push'](_0x17f816);}}catch(_0x4d821e){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x4d821e);}return _0x4b9f3d;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x41b90e,AppUpdate:_0x1b1cfb}=require('electron-updater');_0x41b90e['autoDownload']=![],_0x41b90e['autoInstallOnAppQuit']=!![],_0x41b90e['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x41b90e['on']('update-available',_0x35161b=>{console['log']('Update\x20verfügbar:',_0x35161b),_0x41b90e['downloadUpdate']();}),_0x41b90e['on']('update-downloaded',_0x3d2203=>{console['log']('Update\x20heruntergeladen:',_0x3d2203),_0x41b90e['quitAndInstall']();}),_0x41b90e['on']('error',_0x45274d=>{console['error']('Fehler\x20beim\x20Updaten:',_0x45274d);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x51fb16,AppUpdate:_0x3359f2}=require('electron-updater');_0x51fb16['autoDownload']=![],_0x51fb16['autoInstallOnAppQuit']=!![],_0x51fb16['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x51fb16['on']('update-available',_0x379ae1=>{console['log']('Update\x20verfügbar:',_0x379ae1),_0x51fb16['downloadUpdate']();}),_0x51fb16['on']('update-downloaded',_0x5dcd22=>{console['log']('Update\x20heruntergeladen:',_0x5dcd22),console['log']('Neustarten\x20zum\x20Updaten');}),_0x51fb16['on']('error',_0x3cef46=>{console['error']('Fehler\x20beim\x20Updaten:',_0x3cef46);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let optionsDb,optionsDbPath;function ensureDirSync(_0x503b6e){try{fs_no_promise['mkdirSync'](_0x503b6e,{'recursive':!![]});}catch(_0x36ae87){}}function initOptionsDb(){return new Promise((_0x5446f0,_0xae6199)=>{try{ensureDirSync(SqlDataDirectory),optionsDbPath=path['join'](SqlDataDirectory,'options.db'),optionsDb=new sqlite3['Database'](optionsDbPath,_0x37aedd=>{if(_0x37aedd)return _0xae6199(_0x37aedd);optionsDb['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20options\x20(key\x20TEXT\x20PRIMARY\x20KEY,\x20value\x20TEXT\x20NOT\x20NULL)',_0x5a7788=>{if(_0x5a7788)return _0xae6199(_0x5a7788);optionsDb['run']('INSERT\x20OR\x20IGNORE\x20INTO\x20options\x20(key,\x20value)\x20VALUES\x20(?,\x20?)',['isHeadless','1'],_0x3c9383=>{if(_0x3c9383)return _0xae6199(_0x3c9383);_0x5446f0();});});});}catch(_0x1e0bec){_0xae6199(_0x1e0bec);}});}function setOption(_0x24c115,_0x1f050e){return new Promise((_0x56598a,_0x40fc31)=>{if(!optionsDb)return _0x40fc31(new Error('Options-DB\x20nicht\x20initialisiert'));optionsDb['run']('INSERT\x20INTO\x20options\x20(key,\x20value)\x20VALUES\x20(?,\x20?)\x20ON\x20CONFLICT(key)\x20DO\x20UPDATE\x20SET\x20value\x20=\x20excluded.value',[_0x24c115,String(_0x1f050e)],_0x57d1f0=>{if(_0x57d1f0)return _0x40fc31(_0x57d1f0);_0x56598a();});});}function getOption(_0x3bf3c1){return new Promise((_0x4865b1,_0x90c52b)=>{if(!optionsDb)return _0x90c52b(new Error('Options-DB\x20nicht\x20initialisiert'));optionsDb['get']('SELECT\x20value\x20FROM\x20options\x20WHERE\x20key\x20=\x20?',[_0x3bf3c1],(_0x14c920,_0x5a72a3)=>{if(_0x14c920)return _0x90c52b(_0x14c920);_0x4865b1(_0x5a72a3?_0x5a72a3['value']:null);});});}async function getIsHeadless(){try{const _0x303571=await getOption('isHeadless');if(_0x303571===null||_0x303571===undefined)return!![];if(_0x303571==='1'||_0x303571==='true'||_0x303571===!![])return!![];if(_0x303571==='0'||_0x303571==='false'||_0x303571===![])return![];return console['log']('[OptionsDB]\x20getIsHeadless\x20unerwarteter\x20Wert:',_0x303571),Boolean(_0x303571);}catch(_0x284c20){return console['warn']('[OptionsDB]\x20getIsHeadless\x20Fehler,\x20fallback=true:',_0x284c20?.['message']||_0x284c20),!![];}}let browser_login=null;async function getBrowserPageLogin(){let _0x1172bc='',_0x1259ea=null;if(process['platform']==='darwin')_0x1172bc=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x1172bc=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x1172bc}),_0x1259ea=await browser_login['newPage'](),_0x1259ea['setDefaultNavigationTimeout'](0x3a98),_0x1259ea['setDefaultTimeout'](0x3a98),await _0x1259ea['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x1259ea;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x10c328=0x1,_0x114129=0x0){try{let _0xc706a9='',_0x765e11=null;const _0x5cd61b=await getIsHeadless();if(process['platform']==='darwin')_0xc706a9=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0xc706a9=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}_0x10c328===0x0&&!pageStack[_0x114129]&&(browser=await puppeteer['launch']({'headless':_0x5cd61b,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0xc706a9}),_0x765e11=await browser['newPage'](),_0x765e11['setDefaultNavigationTimeout'](0x3a98),_0x765e11['setDefaultTimeout'](0x3a98),await _0x765e11['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x114129]=_0x765e11);(browser===null||pageStack[_0x114129]===null||pageStack[_0x114129]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x5cd61b,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0xc706a9}));(pageStack[_0x114129]===null||pageStack[_0x114129]['isClosed']())&&(_0x765e11=await browser['newPage'](),_0x765e11['setDefaultNavigationTimeout'](0x3a98),_0x765e11['setDefaultTimeout'](0x3a98),await _0x765e11['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x114129]=_0x765e11);try{await pageStack[_0x114129]['evaluate'](()=>!![]);}catch(_0x989142){const _0x8f6a34=String(_0x989142&&_0x989142['message']?_0x989142['message']:_0x989142),_0x110acc=/(detached\s*frame|Session closed|Target closed|Execution context was destroyed|Cannot find context)/i['test'](_0x8f6a34);if(_0x110acc){try{if(pageStack[_0x114129])await pageStack[_0x114129]['close']()['catch'](()=>{});}catch(_0x1bcf90){}try{if(browser)await browser['close']()['catch'](()=>{});}catch(_0x5a322f){}browser=await puppeteer['launch']({'headless':_0x5cd61b,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0xc706a9});const _0x3254c7=await browser['newPage']();_0x3254c7['setDefaultNavigationTimeout'](0x3a98),_0x3254c7['setDefaultTimeout'](0x3a98),await _0x3254c7['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x114129]=_0x3254c7;}else{try{if(pageStack[_0x114129])await pageStack[_0x114129]['close']()['catch'](()=>{});}catch(_0x38a029){}try{if(browser)await browser['close']()['catch'](()=>{});}catch(_0x59d9e0){}browser=await puppeteer['launch']({'headless':_0x5cd61b,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0xc706a9});const _0x4c955a=await browser['newPage']();_0x4c955a['setDefaultNavigationTimeout'](0x3a98),_0x4c955a['setDefaultTimeout'](0x3a98),await _0x4c955a['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x114129]=_0x4c955a;}}return pageStack[_0x114129];}catch(_0x13275d){console['error']('Failed\x20to\x20launch\x20browser:',_0x13275d);const _0x43cb98=new Error('Browser\x20konnte\x20nicht\x20gestartet\x20werden.\x20Bitte\x20starte\x20die\x20App\x20neu.\x20:\x20'+_0x13275d);throw _0x43cb98;}}ipcMain['on']('login',async(_0x26661c,_0x43341f)=>{const _0x280ed9=await getBrowserPageLogin();await _0x280ed9['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x280ed9,_0x43341f),ipcMain['on']('setLoginCookies',async(_0x3ca9e6,_0x5e03fc)=>{try{await set_login_cookies(_0x280ed9,_0x5e03fc);}catch(_0x1a90a2){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x1a90a2);}});}),ipcMain['handle']('set-headless',async(_0xd228a9,_0x10071c)=>{const _0x5a8d2c=!!_0x10071c;if(!optionsDb)try{await initOptionsDb();}catch(_0x3a1d4d){console['error']('[OptionsDB]\x20Init\x20on\x20set-headless\x20fehlgeschlagen:',_0x3a1d4d);}return await setOption('isHeadless',_0x5a8d2c?'1':'0'),console['log']('[MAIN]\x20isHeadless\x20gesetzt\x20(DB)\x20auf:',_0x5a8d2c),{'ok':!![],'headless':_0x5a8d2c};}),ipcMain['handle']('get-headless',async()=>{const _0x3bf5d0=await getIsHeadless();return{'headless':_0x3bf5d0};}),ipcMain['on']('export-relation',async(_0x5a42fb,_0x58b094)=>{try{await exportDatabase(_0x58b094),_0x5a42fb['reply']('export-relation-response',{'success':!![]});}catch(_0x187ead){console['error'](_0x187ead),_0x5a42fb['reply']('export-relation-response',{'success':![],'message':_0x187ead['message']});}}),ipcMain['handle']('sendMessage',async(_0x580bbf,_0x1c8590,_0x7bdb3,_0x155daa,_0x792373,_0x53ed9d,_0x5550cd,_0x317693,_0x42baae,_0x5df959,_0x39aba7,_0x48d470,_0x12753a)=>{isStopping=![];let _0x23016d=null;return _0x5550cd?_0x23016d=await getBrowserPage(_0x792373,_0x317693):_0x23016d=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x1c8590),send_message(_0x23016d,_0x1c8590,_0x7bdb3,_0x155daa,_0x792373,_0x53ed9d,_0x42baae,_0x5df959,_0x39aba7,_0x48d470,_0x12753a);}),ipcMain['handle']('stop-action',async(_0xb9b111,_0x1684de)=>{isStopping=!![];const _0x4b27cb=await getBrowserPage(0x1,_0x1684de);await _0x4b27cb['close']();}),ipcMain['handle']('fetch_followers',async(_0x4a3a31,_0x23a892,_0x2530b3,_0x32736c,_0x11289a,_0x502a6b,_0x44d97f)=>{isStopping=![];const _0x2f7ae4=await getBrowserPage();return fetch_followers_from_account(_0x4a3a31,_0x2f7ae4,_0x23a892,_0x2530b3,_0x32736c,_0x11289a,_0x502a6b,_0x44d97f);}),ipcMain['handle']('get-account-details',async(_0x534a47,_0x42e3c6,_0x5ddafc,_0x1d5b24)=>{isStopping=![];const _0x5974e9=await getBrowserPage();return fetch_account_details(_0x5974e9,_0x42e3c6,_0x5ddafc,_0x1d5b24);}),ipcMain['handle']('fetch_likes',async(_0x5b92e1,_0x7d289f,_0x4f30e6,_0x35ee59,_0x4c22dd,_0xdd4cdc,_0x5a67b4)=>{isStopping=![];const _0x40522d=await getBrowserPage();return fetch_likers_from_post(_0x5b92e1,_0x40522d,_0x7d289f,_0x4f30e6,_0x35ee59,_0x4c22dd,_0xdd4cdc,_0x5a67b4);}),ipcMain['handle']('fetch_comments',async(_0x5cc787,_0x43db93,_0x6543da,_0x4991b8,_0x125ad5,_0xb92dbc,_0x35d1a5)=>{isStopping=![];const _0x1fab53=await getBrowserPage();return fetch_comments_from_post(_0x5cc787,_0x1fab53,_0x43db93,_0x6543da,_0x4991b8,_0x125ad5,_0xb92dbc,_0x35d1a5);});async function updateAppSilent(){const {spawn:_0x23c111}=require('child_process'),_0x8366ba=require('path'),_0x3a3053=require('electron-log');return _0x3a3053['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x1cd9f8,_0x26b091)=>{const {updateElectronApp:_0x3d2e30,UpdateSourceType:_0x16e08d}=require('update-electron-app');_0x3d2e30({'updateSource':{'type':_0x16e08d['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x3a3053}),_0x1cd9f8('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x1a9dcc,_0x46039a)=>{doFullElectronUpdateSilent(),_0x1a9dcc('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x387e6e}=require('child_process'),_0x23031d=require('path'),_0x230ad3=require('electron-log');return _0x230ad3['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x4a460d,_0x11786b)=>{const {updateElectronApp:_0xca2ab1,UpdateSourceType:_0x23c960}=require('update-electron-app');_0xca2ab1({'updateSource':{'type':_0x23c960['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x230ad3}),_0x4a460d('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x275c93,_0x27ab98)=>{doFullElectronUpdate(),_0x275c93('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0x547afe,_0x282d6a)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x547afe('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x10fcbc=path['join'](__dirname,'mac-updater-intern.sh'),_0xd12d54=spawn('/bin/bash',[_0x10fcbc],{'detached':!![],'stdio':'ignore'});_0xd12d54['unref'](),setTimeout(()=>{_0x547afe('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0x282d6a(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0x409751=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x6be9e6,_0x59fc47)=>{console['log']('Update\x20Silent:\x20'+_0x59fc47);if(_0x59fc47){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0x5c3142,_0x8865f9){return Math['random']()*(_0x8865f9-_0x5c3142+0x1)+_0x5c3142;}function delay(_0xe6a87e,_0x2c03e2){let _0xd9a3d6=getRnd(_0xe6a87e,_0x2c03e2);return new Promise(function(_0x87e027){setTimeout(_0x87e027,_0xd9a3d6);});}async function scroll(_0x49f169,_0x475876,_0xb38bdd=0x2,_0x3c81e9){const _0x4e1051=await _0x49f169['waitForSelector'](_0x475876);for(let _0x47d58a=0x0;_0x47d58a<_0xb38bdd;_0x47d58a++){console['log']('Scrolling\x20'+_0x47d58a),await _0x49f169['evaluate'](_0x3f88d3=>{const _0x203140=document['querySelector'](_0x3f88d3);_0x203140&&_0x203140['scrollBy'](0x0,0x190);},_0x475876),await delay(0x320,0x5dc),_0x3c81e9();}}async function saveCookies(_0x535b00){let _0x1a660e=await _0x535b00['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x1a660e,null,0x2));}async function notificationClear(_0x4dc859){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xfa0,0x1388),await _0x4dc859['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x4dc859['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x5e3f42){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x5e3f42);}}async function getTargetProfiles(_0x3df35b){return new Promise((_0x2de440,_0x439c28)=>{const _0x18320d=quoteIdent(_0x3df35b);db['all']('SELECT\x20*\x20FROM\x20'+_0x18320d,(_0x329044,_0x5968c4)=>{_0x329044?_0x439c28(_0x329044):_0x2de440(_0x5968c4);});});}async function login_legacy(_0x3fd853,_0x524985,_0x4fcb68){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x3fd853,_0x524985),await createUserIfNotExists(_0x524985,_0x4fcb68);}catch(_0x237105){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x237105);}try{await _0x3fd853['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x3fd853['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x3fd853['click']('button._a9--._ap36._a9_0');}catch(_0x3f60b8){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x3fd853['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x3fd853['type']('input[name=\x27username\x27]',_0x524985,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x3fd853['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x3fd853['type']('input[name=\x27password\x27]',_0x4fcb68,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x3fd853['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x3fd853['click']('button[type=\x27submit\x27]');}catch(_0x3f614c){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x3fd853),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x3fd853,_0x524985);}catch(_0xdff8dd){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0xdff8dd);}}catch(_0x271fd4){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x271fd4);}}async function login(_0x151337,_0x8787e5){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x151337,_0x8787e5),await createUserIfNotExists(_0x8787e5);}catch(_0x20c458){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x20c458);}try{await _0x151337['goto']('https://www.instagram.com/accounts/login/');}catch(_0x53b0d1){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x53b0d1);}}async function set_login_cookies(_0x5e2f0c,_0x2317a2){try{await saveCookiesForUser(_0x5e2f0c,_0x2317a2);}catch(_0x39318d){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x39318d);}}async function waitForXPath(_0x2efb8f,_0x39e34a,_0xae974e={}){return await _0x2efb8f['waitForFunction'](_0x577e44=>{return document['evaluate'](_0x577e44,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0xae974e,_0x39e34a),_0x2efb8f['evaluateHandle'](_0x180858=>document['evaluate'](_0x180858,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x39e34a);}async function waitForSelectorWithFallbacks(_0x55e574,_0x4fa587,_0x39ab4e={}){!Array['isArray'](_0x4fa587)&&(_0x4fa587=[_0x4fa587]);for(let _0x245c22=0x0;_0x245c22<_0x4fa587['length'];_0x245c22++){const _0x110ca4=_0x4fa587[_0x245c22],_0x1abfd3=_0x110ca4['startsWith']('//')||_0x110ca4['startsWith']('(//');try{console['log']('Versuche\x20'+(_0x1abfd3?'XPath':'Selector')+'\x20'+(_0x245c22+0x1)+'/'+_0x4fa587['length']+':\x20'+_0x110ca4['substring'](0x0,0x32)+'...');const _0x22f005=_0x245c22===0x0?_0x39ab4e['timeout']||0x1388:0x7d0;let _0x4277e7;if(_0x1abfd3){const _0x258b02=await waitForXPath(_0x55e574,_0x110ca4,{..._0x39ab4e,'timeout':_0x22f005});if(!_0x258b02)throw new Error('XPath-Element\x20nicht\x20gefunden');_0x4277e7=_0x258b02;}else _0x4277e7=await _0x55e574['waitForSelector'](_0x110ca4,{..._0x39ab4e,'timeout':_0x22f005});return console['log']((_0x1abfd3?'XPath':'Selector')+'\x20'+(_0x245c22+0x1)+'\x20gefunden!'),_0x4277e7;}catch(_0x411ae4){console['log']((_0x1abfd3?'XPath':'Selector')+'\x20'+(_0x245c22+0x1)+'\x20nicht\x20gefunden:\x20'+_0x411ae4['message']);if(_0x245c22===_0x4fa587['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x4fa587['length']+'\x20Selektoren/XPath\x20konnte\x20gefunden\x20werden:\x20'+_0x411ae4['message']);}}throw new Error('Keine\x20Selektoren/XPath\x20angegeben');}async function waitForXPathAll(_0x24038d,_0x20e627,_0xc7d88d={}){return await _0x24038d['waitForFunction'](_0x14dad7=>{return document['evaluate'](_0x14dad7,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null)['snapshotLength']>0x0;},_0xc7d88d,_0x20e627),_0x24038d['evaluateHandle'](_0x4bc4e6=>{const _0x5c7d72=document['evaluate'](_0x4bc4e6,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null),_0x2c2212=[];for(let _0x45f669=0x0;_0x45f669<_0x5c7d72['snapshotLength'];_0x45f669++){_0x2c2212['push'](_0x5c7d72['snapshotItem'](_0x45f669));}return _0x2c2212;},_0x20e627)['then'](_0x4fa3f9=>_0x4fa3f9['getProperties']());}ipcMain['handle']('check-login',async(_0xdd33ee,_0x41b50a)=>{if(pageStack[0x0]){try{await pageStack[0x0]['close']();}catch(_0x3562c4){}pageStack[0x0]=null;}if(browser){try{await browser['close']();}catch(_0x3be75f){}browser=null;}const _0xd09b02=await getBrowserPage(0x0,0x0),_0x27195f=await checkCookiesSession(_0xd09b02,_0x41b50a);return _0x27195f;});async function checkCookiesSession(_0x5028ef,_0x179042){try{await setCookiesForUser(_0x5028ef,_0x179042),console['log']('Cookies\x20für\x20'+_0x179042+'\x20erfolgreich\x20geladen');}catch(_0x353024){return console['error']('Fehler\x20beim\x20Laden\x20der\x20Cookies\x20für\x20'+_0x179042+':',_0x353024),![];}try{await _0x5028ef['goto']('https://www.instagram.com/',{'timeout':0x3a98});}catch(_0x5d7fa5){console['error']('Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x5d7fa5);}await delay(0x6a4,0x7d0);try{const _0x26b263=await checkLoginStatus(_0x5028ef);return console['log']('Login-Status\x20für\x20'+_0x179042+':\x20'+_0x26b263),_0x26b263;}catch(_0x1518a1){return console['warn']('Login-Prüfung\x20fehlgeschlagen\x20für\x20'+_0x179042+':',_0x1518a1['message']),![];}}async function checkLoginStatus(_0xfd8a5b){const _0x10eedb=['[type=\x22password\x22]','//a[normalize-space(text())=\x27Log\x20In\x27]','//div[@role=\x27button\x27\x20and\x20normalize-space(.)=\x27Log\x20in\x27]','//a[@role=\x27link\x27\x20and\x20normalize-space(.)=\x27Log\x20in\x27]','//h3[normalize-space(text())=\x27Something\x20went\x20wrong\x27]'];let _0x7bcb29=null;try{_0x7bcb29=await waitForSelectorWithFallbacks(_0xfd8a5b,_0x10eedb,{'timeout':0x7d0});}catch(_0x5b1c37){return console['log']('Eingeloggt,\x20kein\x20Login\x20notwendig:\x20'+_0x5b1c37),!![];}if(_0x7bcb29){console['log']('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return![];}else return console['log']('Eingeloggt,\x20führe\x20keine\x20Login\x20durch'),!![];}async function checkPageExists(_0x16b4f8){const _0x40f499=['//span[contains(normalize-space(.),\x22Sorry,\x20this\x20page\x20isn\x27t\x20available\x22)]'];let _0xab8789=null;try{_0xab8789=await waitForSelectorWithFallbacks(_0x16b4f8,_0x40f499,{'timeout':0x7d0});}catch(_0x2d81d0){return console['log']('Seite\x20existiert:\x20'+_0x2d81d0),!![];}if(_0xab8789){console['log']('Angegbene\x20Seite\x20existiert\x20nicht');throw new Error('Angegbene\x20Seite\x20existiert\x20nicht');return![];}else return console['log']('Seite\x20existiert'),!![];}async function likeFirstPost(_0x5b3bdf){try{const _0x192395=await _0x5b3bdf['$$'](K_BEITRAG_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Posts\x20gefunden:\x20'+_0x192395['length']);if(_0x192395&&_0x192395['length']>0x0){const _0x27c5c1=_0x192395[0x0];await _0x27c5c1['click'](),await delay(0xaf0,0xbb8);const _0x53a6e4=await _0x5b3bdf['evaluate'](()=>{const _0x16ce7b=document['querySelector']('section\x20>\x20span\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20svg[aria-label=\x22Like\x22]');return!!_0x16ce7b;});if(_0x53a6e4){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus');const _0x2bf6b0=await _0x5b3bdf['$$'](K_BEITRAG_LIKE_BUTTON),_0x5ccad4=_0x2bf6b0[0x0];await delay(0x514,0x5dc),await _0x5b3bdf['evaluate'](_0x592120=>{_0x592120['click']();},_0x5ccad4);}else console['log']('Beitrag\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x5b3bdf['goBack'](),await delay(0x7d0,0x898);}}catch(_0xa908fb){console['log']('Fehler\x20beim\x20Liken\x20des\x20ersten\x20Posts:',_0xa908fb);throw new Error('Like_Posts:\x20'+_0xa908fb);}}async function likeFirstStory(_0x990fd2){try{const _0x3d97f3=await _0x990fd2['$$'](K_STORY_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Stories\x20gefunden:\x20'+_0x3d97f3['length']);if(_0x3d97f3&&_0x3d97f3['length']>0x0){const _0x141014=_0x3d97f3[0x0];await _0x141014['click'](),await delay(0xaf0,0xbb8);const _0x351908=await _0x990fd2['evaluate'](()=>{const _0x5d7bd3=document['querySelector']('[aria-label=\x22Like\x22]');return!!_0x5d7bd3;});if(_0x351908){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus'),await delay(0x514,0x5dc);try{const _0x4e1fd2=await _0x990fd2['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0x990fd2['click'](_0x4e1fd2);}catch(_0x33e01d){console['log']('Direkter\x20Klick\x20fehlgeschlagen,\x20versuche\x20alternative\x20Methoden:',_0x33e01d);try{const _0x400978=await _0x990fd2['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0x990fd2['evaluateHandle'](_0x1b6538=>{_0x1b6538['click']();},_0x400978);}catch(_0x30b00a){console['log']('Evaluatehandle\x20fehlgeschlagen,\x20versuche\x20JS-Click:',_0x30b00a),await _0x990fd2['evaluate'](()=>{const _0x1d9f3e=document['querySelector']('[aria-label=\x22Like\x22]');if(_0x1d9f3e)_0x1d9f3e['click']();else throw new Error('Element\x20nicht\x20gefunden');});}}}else console['log']('Story\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x990fd2['goBack'](),await delay(0x7d0,0x898);}}catch(_0x3fae4d){console['log']('Fehler\x20beim\x20Liken\x20der\x20ersten\x20Story:',_0x3fae4d);throw new Error('Like_Storys:\x20'+_0x3fae4d);}}async function send_message(_0x251ba0,_0x44df53,_0x56b0c2,_0x8a005f,_0x5b2e72,_0x5d185a,_0x2d9043,_0x3b79dc,_0xc355fd,_0x4099de,_0x413c01){return new Promise(async(_0x58080e,_0x3aef8a)=>{_0x5d185a=_0x5d185a['split'](';'),console['log'](_0x5d185a[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x5b2e72);if(_0x8a005f===null||_0x8a005f===undefined){console['log']('Nachricht\x20ist\x20null\x20oder\x20undefined'),_0x3aef8a('Nachricht\x20darf\x20nicht\x20leer\x20sein');return;}try{await setCookiesForUser(_0x251ba0,_0x5d185a[0x0]);}catch(_0x22e5a4){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x22e5a4),_0x58080e({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x22e5a4});return;}await delay(0x6a4,0x7d0);try{await _0x251ba0['goto']('https://www.instagram.com/'+_0x44df53+'/'),await delay(0x1b58,0x1d4c),await notificationClear(_0x251ba0);}catch(_0x5a7d4e){_0x58080e({'status':0x1f5,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x5a7d4e});return;}try{await checkLoginStatus(_0x251ba0);}catch(_0x240b42){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x240b42),_0x3aef8a('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return;}if(_0xc355fd==0x1)try{await likeFirstPost(_0x251ba0);}catch(_0x17e039){_0x3aef8a(_0x17e039);}if(_0x4099de==0x1)try{await likeFirstStory(_0x251ba0);}catch(_0x441e6e){_0x3aef8a(_0x441e6e);}console['log']('UserSkip:\x20'+_0x2d9043);if(_0x2d9043==0x1)try{const _0x10cd24=await _0x251ba0['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x2beeb2=>_0x2beeb2['textContent']['trim']());console['log'](_0x10cd24);if(_0x10cd24==='Following'||_0x10cd24==='Folge\x20ich')return _0x58080e({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x38faa0){}await delay(0x6a4,0x7d0);try{const _0xd92c52=await waitForSelectorWithFallbacks(_0x251ba0,K_DIRECT_MSG_BUTTON);await _0xd92c52['click'](),await delay(0xa8c,0xdac);try{const _0x3ddf3c=await waitForSelectorWithFallbacks(_0x251ba0,K_EXPAND_MSG_BUTTON);await _0x3ddf3c['click']();}catch(_0x22d906){console['log']('Expand-Button\x20nicht\x20gefunden.\x20Überspringen:\x20'+_0x22d906);}}catch(_0x282be9){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x282be9);try{await delay(0xa8c,0xbb8);try{const _0x2d9518=await waitForSelectorWithFallbacks(_0x251ba0,K_OPTIONS_BUTTON);await _0x2d9518['click']();}catch(_0x4609a5){console['log']('Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x4609a5),_0x58080e({'status':0x1f6,'message':'Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x4609a5});return;}await delay(0xa8c,0xbb8);const _0x5cf3df=await waitForXPath(_0x251ba0,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x5cf3df['click']();}catch(_0x4a826d){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x4a826d),_0x58080e({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x708,0x7d0),await notificationClear(_0x251ba0);}catch(_0x382c65){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x382c65);}try{await delay(0xaf0,0xdac);const _0x1dc1c8=await waitForSelectorWithFallbacks(_0x251ba0,K_CHAT_INPUT_FIELD,{'timeout':0x3a98});if(_0x3b79dc){const _0x1fae5f=await _0x251ba0['$'](K_ALREADY_CHATTED);if(_0x1fae5f)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x44df53),_0x58080e({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x45bf73=await _0x251ba0['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x45bf73),_0x8a005f=_0x8a005f['replace']('{USERNAME}',_0x44df53);let _0x4cd559;if(_0x8a005f['includes']('{NAME}')||_0x8a005f['includes']('{name}'))try{const _0x9e8b81=await extractFirstName(_0x45bf73,_0x413c01);console['log']('Response\x20Clearname\x20valid:\x20'+_0x9e8b81['valid']),_0x9e8b81['valid']?(_0x8a005f=_0x8a005f['replaceAll'](/{NAME}|{name}/g,_0x9e8b81['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x9e8b81['name']),_0x4cd559=_0x9e8b81['name']):(_0x8a005f=_0x8a005f['replaceAll'](/ ?({NAME}|{name})/g,''),_0x4cd559='UNKNOWN_NAME');}catch(_0x5161a2){console['log'](_0x5161a2['message']),_0x4cd559=_0x5161a2['message'];const _0x240ba9=_0x45bf73?_0x45bf73['replace'](/[^\p{L}\s]/gu,''):'',_0x20d7b6=_0x240ba9['split']('\x20')[0x0]||'';_0x20d7b6['length']>0x2&&!_0x20d7b6['includes']('Instagram')?_0x8a005f=_0x8a005f['replaceAll'](/{NAME}|{name}/g,_0x20d7b6):_0x8a005f=_0x8a005f['replaceAll'](/ ?({NAME}|{name})/g,'');}console['log']('Nachricht\x20vor\x20dem\x20Senden:\x20'+_0x8a005f);const _0x2ffb42=_0x8a005f['split']('\x0a');await _0x1dc1c8['type'](_0x2ffb42[0x0],{'delay':getRnd(0x50,0x78)});for(let _0x236108=0x1;_0x236108<_0x2ffb42['length'];_0x236108++){await _0x251ba0['keyboard']['down']('Shift'),await _0x251ba0['keyboard']['press']('Enter'),await _0x251ba0['keyboard']['up']('Shift'),await delay(0x64,0xc8),_0x2ffb42[_0x236108]['length']>0x0&&await _0x1dc1c8['type'](_0x2ffb42[_0x236108],{'delay':getRnd(0x50,0x78)});}console['log']('Nachricht\x20mit\x20Zeilenumbrüchen\x20gesendet'),await delay(0x320,0x3e8);try{const _0x402c3f=await waitForSelectorWithFallbacks(_0x251ba0,K_SEND_MSG_BUTTON);await _0x402c3f['click']();}catch(_0x17715d){console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x17715d),_0x58080e({'status':0x195,'message':'Send\x20nicht\x20gefunden.\x20Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x44df53+'\x20überspringen.','error':_0x17715d['message']});}await delay(0x320,0x3e8),_0x58080e({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x45bf73,'extracted_clearname':_0x4cd559});}catch(_0x53d742){let _0x386624=_0x53d742;console['log']('Fehler\x20beim\x20Senden\x20der\x20Nachricht:\x20'+_0x386624),_0x58080e({'status':0x1f4,'message':'Error\x20500:\x20'+_0x386624});}});}function handle_fail(_0x4a8c14){if(isStopping)return new Promise(_0x379e83=>{_0x379e83('Scraper\x20gestoppt.');});else{let _0x139d8c='';switch(_0x4a8c14){case 0x0:_0x139d8c='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x139d8c='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x139d8c='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x139d8c='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x5c1464,_0xdaca02)=>{_0xdaca02(_0x139d8c);});}}async function fetch_account_details(_0x3d4171,_0x57cffc,_0x4ccd8a,_0x1ac93a){try{await setCookiesForUser(_0x3d4171,_0x4ccd8a['username']);}catch(_0x37c552){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x37c552);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x37c552);return handle_fail(0x0);}_0x3d4171['setDefaultNavigationTimeout'](0x7530),await _0x3d4171['goto']('https://www.instagram.com/'+_0x57cffc+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x3d4171);const _0x772658=await _0x3d4171['evaluate'](()=>{const _0x435b7c=document['querySelector']('meta[property=\x22og:image\x22]');return _0x435b7c?_0x435b7c['getAttribute']('content'):null;});await _0x3d4171['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x1c2098=await _0x3d4171['evaluate'](()=>{const _0xa6ecf2=document['querySelector']('meta[name=\x22description\x22]');if(!_0xa6ecf2)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x500b10=_0xa6ecf2['getAttribute']('content');if(!_0x500b10)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x500b10);const _0x37f063=/\s*[–-]\s*/,_0x4aabb7=_0x500b10['split'](_0x37f063);if(_0x4aabb7['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x5e99cb=_0x4aabb7[0x0],_0x14ff80=_0x4aabb7[0x1],_0x176eb9=_0x5e99cb['split'](',\x20');if(_0x176eb9['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x5adb94=_0x176eb9[0x0]['split']('\x20')[0x0],_0x34059b=_0x176eb9[0x1]['split']('\x20')[0x0],_0x5ebf99=_0x176eb9[0x2]['split']('\x20')[0x0];let _0x559c8c='',_0x46da25='';const _0x23fe14='\x20on\x20Instagram:\x20',_0x49dc88=_0x14ff80['split'](_0x23fe14);return _0x559c8c=_0x49dc88[0x0]['trim'](),_0x559c8c=_0x559c8c['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x49dc88['length']>0x1&&(_0x46da25=_0x49dc88[0x1]['trim'](),_0x46da25['startsWith']('\x22')&&_0x46da25['endsWith']('\x22')&&(_0x46da25=_0x46da25['substring'](0x1,_0x46da25['length']-0x1)['trim']()),_0x46da25=_0x46da25['replace'](/&quot;/g,'')['trim']()),{'followers':_0x5adb94,'following':_0x34059b,'posts':_0x5ebf99,'nameText':_0x559c8c,'bio':_0x46da25};});console['log']('Extracted\x20profile\x20data:',_0x1c2098);const _0x3ca1b8=_0x1c2098['nameText'],_0x2f5d73=_0x772658,_0x189adb=_0x1c2098['bio'],_0xb601d1=_0x1c2098['followers'],_0x12b246=_0x1c2098['following'],_0x2f117d=_0x1c2098['posts'],_0x4559ad=![],_0x4a32af=![],_0x9bcf5d=![],_0x390425='\x0a\x20\x20INSERT\x20INTO\x20'+quoteIdent(_0x1ac93a)+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x390425,[_0x57cffc,_0x3ca1b8,_0x2f5d73,_0x189adb,_0xb601d1,_0x12b246,_0x2f117d,_0x4559ad,_0x4a32af,_0x9bcf5d],function(_0x50f1c0){_0x50f1c0?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x50f1c0['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x4ae4f3,_0x3b3a5c,_0x359305,_0x4dbcc3,_0x15a1ff,_0xee92de,_0x2e70e1,_0x2b8723){let _0x33eb59=0x4,_0x30ecbd=0x0,_0x36a126=0x0;try{await setCookiesForUser(_0x3b3a5c,_0xee92de['username']);}catch(_0x4d9931){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x4d9931);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x4d9931);return handle_fail(0x0);}let _0x4596f1=0x0;try{await _0x3b3a5c['goto']('https://www.instagram.com/'+_0x359305+'/'),await notificationClear(_0x3b3a5c);try{await checkLoginStatus(_0x3b3a5c);}catch(_0x54494d){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x54494d);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x3b3a5c);}catch(_0x228c25){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x228c25);throw new Error('Username\x20nicht\x20gefunden.\x20Existiert\x20der\x20Account?');}try{if(_0x4dbcc3<=0x0){const _0x463efc=await _0x3b3a5c['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x44d70e=await _0x3b3a5c['evaluate'](_0x45b4c8=>_0x45b4c8['innerHTML'],_0x463efc);_0x4596f1=Math['ceil'](_0x44d70e/0x4);}else _0x4596f1=Math['ceil'](_0x4dbcc3/0x4);_0x33eb59+=_0x4596f1,_0x36a126=Math['round'](++_0x30ecbd/_0x33eb59*0x64),_0x4ae4f3['sender']['send']('fetch-progress',_0x36a126,!![]);let _0x4ba146=await _0x3b3a5c['waitForSelector']('a[href=\x22/'+_0x359305+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x3b3a5c['evaluate'](_0x98420f=>{_0x98420f['click']();},_0x4ba146),console['log']('Follower\x20Liste\x20von\x20'+_0x359305+'\x20gesichtet'),_0x36a126=Math['round'](++_0x30ecbd/_0x33eb59*0x64),_0x4ae4f3['sender']['send']('fetch-progress',_0x36a126,!![]);}catch(_0x4f7316){console['log']('Follower\x20Liste\x20von\x20'+_0x359305+'\x20nicht\x20gefunden:'+_0x4f7316);throw new Error('Follower\x20Liste\x20von\x20'+_0x359305+'\x20nicht\x20gefunden:'+_0x4f7316);return handle_fail(0x0);}}catch(_0x26e0ca){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x26e0ca);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x26e0ca);return handle_fail(0x0);}try{await delay(0x12c0,0x1388),console['log']('Auto-scrolls:\x20'+_0x4596f1);try{await scroll(_0x3b3a5c,FOLLOWER_FENSTER,_0x4596f1,_0xc59793=>{_0x36a126=Math['round'](++_0x30ecbd/_0x33eb59*0x64),_0x4ae4f3['sender']['send']('fetch-progress',_0x36a126,!![]);});}catch{console['log']('Fallback\x20div:has\x20ausgelöst'),await scroll(_0x3b3a5c,'div.x6nl9eh.x1a5l9x9.x7vuprf.x1mg3h75.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',_0x4596f1,_0x1072aa=>{});}_0x36a126=Math['round'](++_0x30ecbd/_0x33eb59*0x64),_0x4ae4f3['sender']['send']('fetch-progress',_0x36a126,!![]),await _0x3b3a5c['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x25fa23=await _0x3b3a5c['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x425bad=await _0x3b3a5c['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x36a126=Math['round'](++_0x30ecbd/_0x33eb59*0x64),_0x4ae4f3['sender']['send']('fetch-progress',_0x36a126,!![]);_0x4dbcc3<=0x0&&(_0x4dbcc3=_0x25fa23['length']);let _0x15f238=[];for(let _0x43d6b7=0x0;_0x43d6b7<_0x25fa23['length']&&_0x43d6b7<_0x4dbcc3;_0x43d6b7++){const _0x57a495=await _0x25fa23[_0x43d6b7]['evaluate'](_0x2be78a=>_0x2be78a['textContent']),_0x407c07=await _0x425bad[_0x43d6b7]['evaluate'](_0x40382=>_0x40382['textContent']);if(_0x2b8723){const _0x2cd0f7=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0xee92de['username'],_0x57a495]);if(_0x2cd0f7){console['log']('Skipping\x20already\x20contacted\x20follower:\x20'+_0x57a495);continue;}}_0x15f238['push'](_0x57a495);const _0x212f2e='INSERT\x20INTO\x20'+quoteIdent(_0x15a1ff)+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x212f2e,[_0x57a495,_0x407c07],function(_0x23b60a){_0x23b60a?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x15a1ff+'\x27:',_0x23b60a['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x36a126=Math['round'](++_0x30ecbd/_0x33eb59*0x64),_0x4ae4f3['sender']['send']('fetch-progress',_0x36a126,!![]),_0x2e70e1&&(_0x4ae4f3['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x4ae4f3,_0x3b3a5c,_0xee92de,_0x15a1ff,_0x15f238)),new Promise(_0x418c14=>{_0x418c14('Scraping\x20finished!');});}catch(_0x42bf38){if(_0x2e70e1)throw new Error(_0x42bf38);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x359305+'\x20nicht\x20gefunden:\x20'+_0x42bf38);return handle_fail(0x0);}}async function fetch_details_from_list(_0x2899b3,_0x4d3b8e,_0x39c967,_0x46e193,_0x2c8137){let _0xa15966=0x0,_0x548a43=0x0;for(let _0x3878d9=0x0;_0x3878d9<_0x2c8137['length'];_0x3878d9++){console['log']('Processing\x20profile:',_0x2c8137[_0x3878d9]);try{await fetch_account_details(_0x4d3b8e,_0x2c8137[_0x3878d9],_0x39c967,_0x46e193);}catch(_0x1112ad){console['error']('Detailed\x20Scraping\x20von:\x20',_0x2c8137[_0x3878d9],_0x1112ad);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x2c8137[_0x3878d9]+'\x20'+_0x1112ad);}_0x548a43=Math['round'](++_0xa15966/_0x2c8137['length']*0x64),_0x2899b3['sender']['send']('fetch-progress',_0x548a43,!![],!![]);}}async function fetch_likers_from_post(_0x157a26,_0x4b88b7,_0x85e974,_0x61ac01,_0x596eba,_0x482367,_0x2fe944,_0x3807c4){let _0xf73fbc=0x4,_0x195d94=0x0,_0x274291=0x0;try{await setCookiesForUser(_0x4b88b7,_0x482367['username']);}catch(_0x170df0){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x170df0);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x170df0);return handle_fail(0x1);}_0x274291=Math['round'](++_0x195d94/_0xf73fbc*0x64),_0x157a26['sender']['send']('fetch-progress',_0x274291,!![]);try{let _0x1cd85f=_0x85e974['substring'](0x0,_0x85e974['lastIndexOf']('/'));_0x1cd85f['includes']('/reel/')&&(_0x1cd85f=_0x1cd85f['replace']('/reel/','/p/'));let _0x4279b3=_0x1cd85f+'/liked_by';console['log'](_0x4279b3),await _0x4b88b7['goto'](_0x4279b3),await delay(0x7d0,0xfa0),await notificationClear(_0x4b88b7),await delay(0xc8,0x1f4);try{await checkLoginStatus(_0x4b88b7);}catch(_0x6258d8){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x6258d8);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x4b88b7);}catch(_0x3dcc83){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x3dcc83);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}_0x274291=Math['round'](++_0x195d94/_0xf73fbc*0x64),_0x157a26['sender']['send']('fetch-progress',_0x274291,!![]),await _0x4b88b7['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x497fc2=await _0x4b88b7['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x29be36=await _0x4b88b7['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x497fc2['length']);let _0x3849cd=path['join'](__dirname,'/likers.csv');_0x274291=Math['round'](++_0x195d94/_0xf73fbc*0x64),_0x157a26['sender']['send']('fetch-progress',_0x274291,!![]);_0x61ac01<=0x0&&(_0x61ac01=_0x497fc2['length']);try{let _0x174142=[];for(let _0x3964be=0x0;_0x3964be<_0x497fc2['length']&&_0x3964be<_0x61ac01;_0x3964be++){const _0x56fe1f=await _0x497fc2[_0x3964be]['evaluate'](_0x332a21=>_0x332a21['textContent']),_0x1a1a83=await _0x29be36[_0x3964be]['evaluate'](_0x169562=>_0x169562['textContent']);if(_0x3807c4){const _0x58e5ba=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x482367['username'],_0x56fe1f]);if(_0x58e5ba){console['log']('Skipping\x20already\x20contacted\x20liker:\x20'+_0x56fe1f);continue;}}_0x174142['push'](_0x56fe1f);const _0x2a9b6e='INSERT\x20INTO\x20'+quoteIdent(_0x596eba)+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x2a9b6e,[_0x56fe1f,_0x1a1a83],function(_0x4be2f5){_0x4be2f5?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x596eba+'\x27:',_0x4be2f5['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x274291=Math['round'](++_0x195d94/_0xf73fbc*0x64),_0x157a26['sender']['send']('fetch-progress',_0x274291,!![]),_0x2fe944&&(_0x157a26['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x157a26,_0x4b88b7,_0x482367,_0x596eba,_0x174142)),new Promise(_0x20c8cb=>{_0x20c8cb('Scraping\x20finished!');});}catch(_0x199915){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x199915);return handle_fail(0x1);}}catch(_0x3e1cdf){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x3e1cdf);throw new Error('Like-Seite\x20nicht\x20geöffnet:\x20'+_0x3e1cdf);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x30cf99,_0x29e623,_0x39b26b,_0x279bfd,_0x5b5a4c,_0x1f5627,_0x5a02ca,_0x4f2dc0){let _0x2cf947=0x3,_0x2b86af=0x0,_0x4d5383=0x0;try{await setCookiesForUser(_0x29e623,_0x1f5627['username']);}catch(_0x34cb4b){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x34cb4b);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x34cb4b);return handle_fail(0x2);}try{console['log'](_0x39b26b),await _0x29e623['goto'](_0x39b26b),await delay(0x7d0,0xfa0),await notificationClear(_0x29e623),await delay(0xc8,0x1f4);const _0x48572=COM_COMMENTS_BOX_BODY_DIV;try{await checkLoginStatus(_0x29e623);}catch(_0x5e0716){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x5e0716);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x29e623);}catch(_0x42644d){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x42644d);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}let _0x5d5249;const _0x5bef61=await _0x29e623['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x3168ef=await _0x29e623['evaluate'](_0x4a2e4a=>_0x4a2e4a['innerHTML'],_0x5bef61),_0x13d7c0=String(_0x3168ef)['replace'](/[^0-9]/g,''),_0xf8997a=Number(_0x13d7c0)/0x14;_0x279bfd<=0x0?_0x5d5249=Math['ceil'](_0xf8997a/0x3):_0x5d5249=Math['ceil'](_0x279bfd/0x3);_0x2cf947+=_0x5d5249,_0x4d5383=Math['round'](++_0x2b86af/_0x2cf947*0x64),_0x30cf99['sender']['send']('fetch-progress',_0x4d5383,!![]),console['log']('Auto-scrolls:\x20'+_0x5d5249),await scroll(_0x29e623,_0x48572,_0x5d5249,_0xfb089=>{_0x4d5383=Math['round'](++_0x2b86af/_0x2cf947*0x64),_0x30cf99['sender']['send']('fetch-progress',_0x4d5383,!![]);});try{const _0x154b9b=COM_REPLY_BUTTON_SPAN,_0x264cce=await waitForXPathAll(_0x29e623,_0x154b9b);console['log']('Reply-Buttons\x20gefunden:\x20ANZAHL:\x20'+_0x264cce['size']),await delay(0x1f4,0x320);let _0xf43e42=_0x264cce['size'],_0x38f51=[];for(const [_0x3087d5,_0x561e89]of _0x264cce){_0x38f51['push'](_0x561e89);}console['log']('Alle\x20Reply-Buttons:',_0x38f51['length']);try{for(let _0x5c5d45=0x0;_0x5c5d45<_0xf43e42;_0x5c5d45++){await _0x38f51[_0x5c5d45]['click'](),await delay(0x320,0x5dc);}}catch(_0x478ae3){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x478ae3);throw new Error('Nicht\x20auf\x20Replies\x20geklickt:\x20'+_0x478ae3);return handle_fail(0x2);}}catch(_0xc80ddf){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x181d1=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x29e623['waitForSelector'](_0x181d1),await delay(0x1f4,0x320),_0x4d5383=Math['round'](++_0x2b86af/_0x2cf947*0x64),_0x30cf99['sender']['send']('fetch-progress',_0x4d5383,!![]);const _0x2c30ee=await _0x29e623['$$'](_0x181d1);let _0x2add17=path['join'](__dirname,'/comments.csv');_0x279bfd<=0x0&&(_0x279bfd=_0x2c30ee['length']);console['log']('fetch_limit:\x20'+_0x279bfd),console['log']('comments_len:\x20'+_0x2c30ee['length']),_0x279bfd++;try{let _0x8c387=[];for(let _0x393242=0x1;_0x393242<_0x2c30ee['length']&&_0x393242<_0x279bfd;_0x393242++){const _0x48efae=await _0x2c30ee[_0x393242]['evaluate'](_0x5e518e=>_0x5e518e['textContent']);if(_0x4f2dc0){const _0x3f6149=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x1f5627['username'],_0x48efae]);if(_0x3f6149){console['log']('Skipping\x20already\x20contacted\x20commenter:\x20'+_0x48efae);continue;}}try{_0x8c387['push'](_0x48efae);const _0x546e1a='INSERT\x20INTO\x20'+quoteIdent(_0x5b5a4c)+'\x20(username)\x20VALUES\x20(?)';db['run'](_0x546e1a,[_0x48efae],function(_0x5371f3){_0x5371f3&&console['log']('error\x20in\x20add-user:'+_0x5371f3);});}catch(_0x2d31fa){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x393242+'\x20:\x20'+_0x2d31fa);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x393242+'\x20:\x20'+_0x2d31fa);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x4d5383=Math['round'](++_0x2b86af/_0x2cf947*0x64),_0x30cf99['sender']['send']('fetch-progress',_0x4d5383,!![]),_0x30cf99['sender']['send']('fetch-progress',0x64,!![]),_0x5a02ca&&(_0x30cf99['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x30cf99,_0x29e623,_0x1f5627,_0x5b5a4c,_0x8c387)),_0x30cf99['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x5a7840=>{_0x5a7840('Scraping\x20finished!');});}catch(_0x57a8b2){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x57a8b2);return handle_fail(0x2);}}catch(_0xd27f3f){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0xd27f3f);throw new Error('Comments-Seite\x20nicht\x20geöffnet:\x20'+_0xd27f3f);return handle_fail(0x2);}}async function set_clearname_from_username(_0x1fceaa,_0x11d5af,_0x13fc1f=null){try{let _0x230b69,_0xc2bd72;const _0x3790b3='SELECT\x20username\x20FROM\x20'+quoteIdent(_0x11d5af)+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x3790b3,[],(_0x4552c3,_0x268f19)=>{_0x4552c3&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x4552c3['message']),_0x268f19['length']===0x0&&(_0xc2bd72=_0x268f19['length']),_0x230b69=_0x268f19['map'](_0xef5fb6=>_0xef5fb6['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0xc2bd72);if(_0xc2bd72===0x0){console['log']('Leave');return;}const _0x3e2525=await _0x1fceaa['waitForSelector'](IG_SEARCH_BUTTON);await _0x3e2525['click'](),await delay(0x4b0,0x7d0);for(let _0x21cfaa of _0x230b69){const _0x1a57de=await _0x1fceaa['waitForSelector'](IG_SEARCH_INPUT);await _0x1a57de['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x1fceaa['type'](IG_SEARCH_INPUT,_0x21cfaa,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x9ffc46=0x1;while(_0x9ffc46!=0x14){console['log']('Schleife');try{let _0x402fcd=IG_NAME_SPAN_PART1+_0x9ffc46+IG_USERNAME_SPAN_PART2;const _0x16866d=await _0x1fceaa['waitForSelector'](_0x402fcd),_0x382fa8=await _0x1fceaa['evaluate'](_0x3affc3=>_0x3affc3['innerHTML'],_0x16866d);await delay(0xc8,0x1f4);if(_0x382fa8==_0x21cfaa){let _0x57a6ec=IG_NAME_SPAN_PART1+_0x9ffc46+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x2d26ef=await _0x1fceaa['waitForSelector'](_0x57a6ec);let _0x1b21a1=await _0x1fceaa['evaluate'](_0x9b10d9=>_0x9b10d9['innerHTML'],_0x2d26ef);const _0x5d0d78=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x5ef034=_0x1b21a1['match'](_0x5d0d78);_0x5ef034?_0x1b21a1=_0x5ef034[0x1]['trim']():_0x1b21a1=_0x1b21a1['trim']();_0x1b21a1['includes']('•')&&(_0x1b21a1=_0x1b21a1['substring'](0x0,_0x1b21a1['indexOf']('•')-0x1));const _0x43ef54='UPDATE\x20'+quoteIdent(_0x11d5af)+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x43ef54,[_0x1b21a1,_0x382fa8],function(_0x5e5096){_0x5e5096&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x5e5096['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x9ffc46++;}catch(_0x470792){const _0x375e79='UPDATE\x20'+quoteIdent(_0x11d5af)+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x375e79,['',_0x21cfaa],function(_0xf0a8d8){_0xf0a8d8&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0xf0a8d8['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x470792);break;}}_0x13fc1f&&_0x13fc1f();}await _0x3e2525['click']();}catch(_0x27a478){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x27a478);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likePost\x20\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likeStory\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likePost\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likeStory\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x41f644,_0x39641c)=>{const _0x222797='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x222797,[],(_0xa669c4,_0x5c2635)=>{_0xa669c4?_0x39641c(_0xa669c4):_0x41f644(_0x5c2635);});});});const sqlGet=(_0x4db3c0,_0x1a9676,_0x181a67=[])=>new Promise((_0x4eb790,_0x136208)=>_0x4db3c0['get'](_0x1a9676,_0x181a67,(_0x49f1ae,_0xa0f43a)=>_0x49f1ae?_0x136208(_0x49f1ae):_0x4eb790(_0xa0f43a))),sqlAll=(_0x44e3f1,_0x2eda97,_0x3478d0=[])=>new Promise((_0x28d840,_0x5cfadd)=>_0x44e3f1['all'](_0x2eda97,_0x3478d0,(_0x506619,_0x10cf12)=>_0x506619?_0x5cfadd(_0x506619):_0x28d840(_0x10cf12)));ipcMain['handle']('get-campaign-details',async()=>{try{const _0x463ddc=await sqlAll(campaignDB,'SELECT\x20campaign_name,\x20list_id,\x20zeitabstand,\x20account\x20FROM\x20campaign'),_0x2f4ba9=await Promise['all'](_0x463ddc['map'](async _0x125a8c=>{const _0x1cdc7e=[];if(!_0x125a8c['list_id'])_0x1cdc7e['push']('Liste');if(!_0x125a8c['zeitabstand'])_0x1cdc7e['push']('Zeitabstand');if(!_0x125a8c['account'])_0x1cdc7e['push']('Instagram\x20Account');if(_0x125a8c['account'])try{const _0x1051d6=await sqlGet(igaccountsDB,'SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x125a8c['account']]);if(!_0x1051d6)_0x1cdc7e['push']('Instagram\x20Login\x20nicht\x20möglich');else{const _0xf1d272=_0x1051d6['cookie']&&_0x1051d6['cookie']['trim']()!==''&&_0x1051d6['cookie']['trim']()!=='[]';if(!_0xf1d272)_0x1cdc7e['push']('Instagram\x20Login');}}catch(_0x4d3841){console['error']('Account-Prüfung\x20SQL-Fehler:',_0x4d3841['message']),_0x1cdc7e['push']('Instagram\x20Account');}let _0x6d6529='N/A',_0x3d540a='N/A';if(!_0x1cdc7e['includes']('Liste')){try{const _0x5b0fb7=await sqlGet(db,'SELECT\x20COUNT(*)\x20AS\x20lead_count\x20FROM\x20'+quoteIdent(_0x125a8c['list_id']));_0x6d6529=_0x5b0fb7?.['lead_count']??0x0;}catch(_0x238e7a){if(/no such table/i['test'](_0x238e7a['message']))_0x1cdc7e['push']('Liste\x20nicht\x20vorhanden');}try{const _0x3bc41d=await sqlGet(campaignDB,'SELECT\x20COUNT(*)\x20AS\x20contacted_count\x20FROM\x20dm\x20WHERE\x20list_id\x20=\x20?',[_0x125a8c['list_id']]);_0x3d540a=_0x3bc41d?.['contacted_count']??0x0;}catch(_0x1063fd){}}return{'campaign_name':_0x125a8c['campaign_name'],'lead_count':_0x6d6529,'contacted_count':_0x3d540a,'status':_0x1cdc7e['length']===0x0?'Positiv':'Fehler:\x20'+_0x1cdc7e['join'](',\x20')};}));return{'status':'success','campaigns':_0x2f4ba9};}catch(_0x2a030e){return console['error']('get-campaign-details\x20fehlgeschlagen:',_0x2a030e['message']),{'status':'error','message':_0x2a030e['message']};}}),ipcMain['handle']('get-campaign-writer-information',async(_0x374d73,_0x2cd548)=>{return new Promise((_0x52a8f7,_0x2b7c53)=>{const _0x5b221e='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted,\x20likePost,\x20likeStory\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x5b221e,[_0x2cd548],(_0x5756c9,_0x531f68)=>{_0x5756c9?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x5756c9),_0x2b7c53(_0x5756c9)):(console['log']('ROWS'),console['log'](_0x531f68),debugDatabaseContents(),_0x52a8f7(_0x531f68));});});});const showTableContents=_0x7ba46c=>{return new Promise((_0x14e37c,_0x3128c8)=>{const _0x31a2d5='SELECT\x20*\x20FROM\x20'+quoteIdent(_0x7ba46c)+';';campaignDB['all'](_0x31a2d5,(_0x25e891,_0x554e88)=>{_0x25e891?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x7ba46c+':',_0x25e891),_0x3128c8(_0x25e891)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x7ba46c+':',_0x554e88),_0x14e37c({'status':'success','message':_0x554e88}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x150ef6){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x150ef6);}}ipcMain['handle']('create-campaign',async(_0x1a8dd7,_0x5ed243)=>{return new Promise((_0x5792b9,_0x319dbc)=>{const _0xe602c8='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0xe602c8,[String(_0x5ed243)],function(_0x7eda27){_0x7eda27?_0x319dbc(_0x7eda27):_0x5792b9({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x9ae81,_0x41aaa0)=>{return new Promise((_0x43cfef,_0x9ec390)=>{const _0x4cfd8e='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x4cfd8e,[_0x41aaa0],function(_0x53c3c5){_0x53c3c5?_0x9ec390(_0x53c3c5):_0x43cfef({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x5b53a5,_0x14e54a,_0x33e654,_0x1d3f64,_0x46a6ce,_0x31135e,_0x2bcc23,_0x597880,_0x587e03,_0x50b5bf)=>{const _0x381246=await createMessageID(_0x46a6ce);return new Promise((_0x4f75a0,_0x54c7c3)=>{console['log']('ZEITABSTAND:\x20'+_0x1d3f64);if(!_0x14e54a||!_0x33e654||_0x1d3f64===undefined||_0x1d3f64===null||_0x1d3f64===''||!_0x381246||!_0x31135e)return _0x54c7c3({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x381246);const _0x112406='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?,\x20likePost\x20=\x20?,\x20likeStory\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x112406,[_0x33e654,_0x1d3f64,_0x381246,_0x31135e,_0x2bcc23,_0x597880,_0x587e03,_0x50b5bf,_0x14e54a],function(_0x4e5aed){if(_0x4e5aed)_0x54c7c3({'status':'error','message':_0x4e5aed['message']});else this['changes']===0x0?_0x54c7c3({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x4f75a0({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x1d6731,_0x4e1b14,_0x50dba0,_0x4bbc4e,_0x4f58f3)=>{return new Promise((_0x1883c7,_0x2c1d96)=>{const _0x13f720='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x13f720,[_0x4e1b14,_0x50dba0,_0x4bbc4e,_0x4f58f3],function(_0x54513e){return _0x54513e?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x54513e['message']),_0x2c1d96('insert-dm-response',{'success':![],'message':_0x54513e['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x1883c7('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x1d9837=>{return new Promise((_0x4c9e03,_0x5e41ea)=>{const _0x2efb47='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x2efb47,[_0x1d9837],(_0x5de98b,_0x3da411)=>{if(_0x5de98b)_0x5e41ea({'status':'error','message':_0x5de98b['message']});else{if(_0x3da411)_0x4c9e03(_0x3da411['message_id']);else{const _0x3fe381='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x3fe381,[_0x1d9837],function(_0x2b2154){_0x2b2154?_0x5e41ea({'status':'error','message':_0x2b2154['message']}):_0x4c9e03(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x36917a,_0x12acc8)=>{return new Promise((_0x139fc5,_0x198e52)=>{const _0x35c8e6='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+quoteIdent(_0x12acc8);db['get'](_0x35c8e6,(_0x3662b4,_0x3f079d)=>{_0x3662b4?_0x198e52({'status':'error','message':_0x3662b4['message']}):_0x139fc5({'status':'success','count':_0x3f079d['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x1242fb,_0x4ac3f){try{const _0x341890=await new Promise((_0x5c6543,_0x498560)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x4ac3f],(_0x1efe29,_0x2a2344)=>{if(_0x1efe29)_0x498560(_0x1efe29);else{if(_0x2a2344['length']>0x0){let _0x52c6c6=JSON['parse'](_0x2a2344[0x0]['cookie']);console['log'](_0x52c6c6),_0x5c6543(_0x52c6c6);}else _0x498560(new Error('User\x20with\x20username\x20'+_0x4ac3f+'\x20does\x20not\x20exist.'));}});});await _0x1242fb['setCookie'](..._0x341890),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x38e6cd){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x38e6cd);}}async function saveCookiesForUser(_0x2fbd8e,_0x416891){try{const _0x1a18c4=await _0x2fbd8e['cookies']();if(!_0x1a18c4||_0x1a18c4['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x416891);const _0x52916a=JSON['stringify'](_0x1a18c4);if(_0x52916a['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x416891);return new Promise((_0x14498a,_0x314585)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x416891],(_0xce78e4,_0x1ddc77)=>{if(_0xce78e4)return console['error']('Error\x20checking\x20user\x20existence:',_0xce78e4),_0x314585(_0xce78e4);if(_0x1ddc77){const _0x38a1c0=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x38a1c0['run'](_0x52916a,_0x416891,function(_0x460f97){return _0x460f97?(console['error']('Error\x20updating\x20cookies:',_0x460f97),_0x314585(_0x460f97)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x416891),_0x14498a());});}else{const _0x26432d=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x26432d['run'](_0x416891,_0x52916a,function(_0x26117a){return _0x26117a?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x26117a),_0x314585(_0x26117a)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x416891),_0x14498a());});}});});}catch(_0x1ef98f){console['error']('Error\x20fetching\x20cookies:',_0x1ef98f);throw _0x1ef98f;}}async function createUserIfNotExists(_0x5551d7){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x5551d7],(_0x2e7531,_0x3a3919)=>{if(_0x2e7531){console['error']('Error\x20checking\x20user\x20existence:',_0x2e7531);throw _0x2e7531;}else{if(!_0x3a3919){const _0xe8d776=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0xe8d776['run'](_0x5551d7,function(_0x4ac903){_0x4ac903?console['error']('Error\x20inserting\x20new\x20user:',_0x4ac903):console['log']('New\x20user\x20created:',_0x5551d7);});}else console['log']('User\x20already\x20exists:',_0x5551d7);}});}catch(_0x562578){console['error']('Error\x20creating\x20user:',_0x562578);throw _0x562578;}}ipcMain['handle']('create-relation',async(_0x2805b4,_0x1ad57b)=>{return new Promise((_0x23f8cd,_0x85ea6a)=>{const _0x14c88e='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+quoteIdent(_0x1ad57b)+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x14c88e,function(_0x5e4484){_0x5e4484?_0x85ea6a(_0x5e4484):_0x23f8cd({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x1f04a2,_0x5e5fd3)=>{return console['log']('droping\x20table'+_0x5e5fd3),new Promise((_0x1e4ee1,_0x395892)=>{const _0x28671e='DROP\x20TABLE\x20IF\x20EXISTS\x20'+quoteIdent(_0x5e5fd3);console['log']('droping\x20table'+_0x5e5fd3),db['run'](_0x28671e,function(_0x4f548e){_0x4f548e?_0x395892(_0x4f548e):_0x1e4ee1({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x3189d8=>{return new Promise((_0xa904a4,_0x2d34ca)=>{const _0x1f567b='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x1f567b,[],(_0x561635,_0x3e19f3)=>{_0x561635?_0x2d34ca(_0x561635):_0xa904a4(_0x3e19f3['map'](_0x1b2087=>_0x1b2087['name']));});});}),ipcMain['handle']('add-user',async(_0xe9034d,_0x2d9cec,_0x14d064)=>{return new Promise(_0x5d226d=>{const _0x427eb1=db['prepare']('INSERT\x20INTO\x20'+quoteIdent(_0x14d064)+'\x20(username)\x20VALUES\x20(?)');_0x427eb1['run'](_0x2d9cec,function(_0x4e6a68){_0x4e6a68?console['log']('error\x20in\x20add-user:'+_0x4e6a68):_0x5d226d({'status':'success','id':this['lastID']});}),_0x427eb1['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x59f526,_0x5e6abd)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x1c81dc,_0x1c305c)=>{if(_0x1c81dc)_0x5e6abd(_0x1c81dc);else{_0x59f526({'status':'success','users':_0x1c305c});for(_0x1c305c of _0x1c305c){console['log'](_0x1c305c['username']);}}});});}),ipcMain['handle']('get-data',async(_0x220fec,_0x3e4a02)=>{return new Promise((_0x2d66a0,_0x2c0e5e)=>{const _0x1d11a5='SELECT\x20*\x20FROM\x20'+quoteIdent(_0x3e4a02);console['log'](_0x1d11a5),db['all'](_0x1d11a5,[],(_0x1b9498,_0x4ce8a4)=>{_0x1b9498?_0x2c0e5e(_0x1b9498):_0x2d66a0(_0x4ce8a4);});});}),ipcMain['handle']('get-accounts',async _0x4b9a7a=>{return new Promise((_0x20c07f,_0x2417f1)=>{const _0x32a77c='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x32a77c),igaccountsDB['all'](_0x32a77c,[],(_0x2b00b6,_0x564780)=>{_0x2b00b6?_0x2417f1(_0x2b00b6):_0x20c07f(_0x564780);});});}),ipcMain['handle']('get-targets',async(_0x12b356,_0x4f93c7)=>{return getTargetProfiles(_0x4f93c7);}),ipcMain['handle']('delete-user',async(_0x1a717e,_0x46508a,_0x7cfaba)=>{return new Promise((_0x48caea,_0x2f5000)=>{const _0xa2413c=db['prepare']('DELETE\x20FROM\x20'+quoteIdent(_0x7cfaba)+'\x20WHERE\x20username\x20=\x20?');_0xa2413c['run'](_0x46508a,function(_0x148c1c){_0x148c1c?_0x2f5000(_0x148c1c):_0x48caea({'status':'success','changes':this['changes']});}),_0xa2413c['finalize']();});}),ipcMain['handle']('delete-account',async(_0x19c9b3,_0x5b8f51)=>{const _0x48cfa0=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x48cfa0['run'](_0x5b8f51,function(_0x72a538){_0x72a538&&console['log'](_0x72a538);}),_0x48cfa0['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x5f21a6,_0x24c0c8)=>{const _0x55b781='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x55b781,[],(_0x4fcb88,_0x56b4b3)=>{_0x4fcb88?_0x24c0c8({'status':'error','message':_0x4fcb88['message']}):_0x5f21a6({'status':'success','contactedCount':_0x56b4b3['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x2ff7ce,_0x5cc643)=>{const _0x4235d7='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x4235d7,[],(_0x213a4e,_0xbde13d)=>{_0x213a4e?_0x5cc643({'status':'error','message':_0x213a4e['message']}):_0x2ff7ce({'status':'success','contactedCount':_0xbde13d['contactedCount']});});});});function exportDatabase(_0x34e458){return new Promise((_0x5b4f9e,_0x55943d)=>{const _0x427208='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+quoteIdent(_0x34e458)+'\x0a\x20\x20\x20\x20';db['all'](_0x427208,[],async(_0x563aba,_0x3413ac)=>{if(_0x563aba){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x563aba['message']),_0x55943d(_0x563aba);return;}if(!_0x3413ac||_0x3413ac['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x5b4f9e();return;}const _0x265c06=XLSX['utils']['json_to_sheet'](_0x3413ac),_0x4dbcb0=XLSX['utils']['sheet_to_csv'](_0x265c06);try{const {canceled:_0x206fe4,filePath:_0x1e25a4}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x34e458+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x206fe4||!_0x1e25a4){console['log']('Speichern\x20abgebrochen.'),_0x5b4f9e();return;}fs['writeFile'](_0x1e25a4,_0x4dbcb0,'utf8',_0x32e5c6=>{_0x32e5c6?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x32e5c6['message']),_0x55943d(_0x32e5c6)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x1e25a4),_0x5b4f9e());});}catch(_0x36cc17){console['error']('Fehler\x20im\x20Speicherdialog:',_0x36cc17),_0x55943d(_0x36cc17);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x140498,_0x50786c)=>{shell['openExternal'](_0x50786c);});