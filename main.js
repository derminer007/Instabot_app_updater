const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs'),ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div',K_OPTIONS_BUTTON='section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.xs5motx\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD='div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f',K_SEND_MSG_BUTTON='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0xe8f664=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0xe8f664['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0xe8f664['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x38f67d){var _0xac9a56=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x4177cc){console['log']('window\x20id:'+_0x4177cc['id']),_0x4177cc['id']>0x1&&(_0xac9a56=!![]);}),console['log']('child\x20opened\x20='+_0xac9a56);if(!_0xac9a56){const _0xe07f1=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0xe07f1['loadFile'](_0x38f67d['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));});function initializeDatabase(){const _0x1a0e05=require('fs'),_0x4888cb=path['join'](app['getPath']('userData'),'data'),_0x130e1b=['campaign.db','crm.db','igaccounts.db'],_0x211488=[];try{_0x1a0e05['mkdirSync'](_0x4888cb,{'recursive':!![]});for(const _0x362aa7 of _0x130e1b){const _0xbf75e1=path['join'](process['resourcesPath'],'app','build','data',_0x362aa7),_0x3e2fae=path['join'](_0x4888cb,_0x362aa7);!_0x1a0e05['existsSync'](_0x3e2fae)?(_0x1a0e05['copyFileSync'](_0xbf75e1,_0x3e2fae),console['log']('[InitDB]\x20Kopiert\x20'+_0x362aa7+'\x20nach:\x20'+_0x3e2fae)):console['log']('[InitDB]\x20'+_0x362aa7+'\x20existiert\x20bereits:\x20'+_0x3e2fae),_0x211488['push'](_0x3e2fae);}}catch(_0x56a3b7){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x56a3b7);}return _0x211488;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x43e771,AppUpdate:_0x5ab5a3}=require('electron-updater');_0x43e771['autoDownload']=![],_0x43e771['autoInstallOnAppQuit']=!![],_0x43e771['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x43e771['on']('update-available',_0x534102=>{console['log']('Update\x20verfügbar:',_0x534102),_0x43e771['downloadUpdate']();}),_0x43e771['on']('update-downloaded',_0x4ddcc2=>{console['log']('Update\x20heruntergeladen:',_0x4ddcc2),_0x43e771['quitAndInstall']();}),_0x43e771['on']('error',_0x4b75bf=>{console['error']('Fehler\x20beim\x20Updaten:',_0x4b75bf);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x369e35,AppUpdate:_0x53427a}=require('electron-updater');_0x369e35['autoDownload']=![],_0x369e35['autoInstallOnAppQuit']=!![],_0x369e35['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x369e35['on']('update-available',_0x244f1e=>{console['log']('Update\x20verfügbar:',_0x244f1e),_0x369e35['downloadUpdate']();}),_0x369e35['on']('update-downloaded',_0xdbb7e5=>{console['log']('Update\x20heruntergeladen:',_0xdbb7e5),console['log']('Neustarten\x20zum\x20Updaten');}),_0x369e35['on']('error',_0x593349=>{console['error']('Fehler\x20beim\x20Updaten:',_0x593349);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x324eb9='',_0x461f24=null;if(process['platform']==='darwin')_0x324eb9=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x324eb9=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x324eb9}),_0x461f24=await browser_login['newPage'](),_0x461f24['setDefaultNavigationTimeout'](0x1d4c),_0x461f24['setDefaultTimeout'](0x1d4c),await _0x461f24['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x461f24;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x35d0b0=0x1,_0x3effed=0x0){let _0x528fa8='',_0x394fa9=null;const _0x420689=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x528fa8=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x528fa8=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x35d0b0===0x0&&!pageStack[_0x3effed])return browser=await puppeteer['launch']({'headless':_0x420689,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x528fa8}),_0x394fa9=await browser['newPage'](),_0x394fa9['setDefaultNavigationTimeout'](0x1d4c),_0x394fa9['setDefaultTimeout'](0x1d4c),await _0x394fa9['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x3effed]=_0x394fa9,_0x394fa9;return(browser===null||pageStack[_0x3effed]===null||pageStack[_0x3effed]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x420689,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x528fa8})),(pageStack[_0x3effed]===null||pageStack[_0x3effed]['isClosed']())&&(_0x394fa9=await browser['newPage'](),_0x394fa9['setDefaultNavigationTimeout'](0x1d4c),_0x394fa9['setDefaultTimeout'](0x1d4c),await _0x394fa9['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x3effed]=_0x394fa9),pageStack[_0x3effed];}ipcMain['on']('login',async(_0x9c14b3,_0x151402)=>{const _0x4c7465=await getBrowserPageLogin();await _0x4c7465['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x4c7465,_0x151402),ipcMain['on']('setLoginCookies',async(_0x5bc4dc,_0x5c42b3)=>{try{await set_login_cookies(_0x4c7465,_0x5c42b3);}catch(_0x1b5a97){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x1b5a97);}});}),ipcMain['on']('export-relation',async(_0x56bc3a,_0x1fd9a7)=>{try{await exportDatabase(_0x1fd9a7),_0x56bc3a['reply']('export-relation-response',{'success':!![]});}catch(_0x22672f){console['error'](_0x22672f),_0x56bc3a['reply']('export-relation-response',{'success':![],'message':_0x22672f['message']});}}),ipcMain['handle']('sendMessage',async(_0x34f051,_0x3c2dd2,_0x471e77,_0x4053b9,_0x378cce,_0x43035f,_0x1969a8,_0x1479fc,_0x359b4d,_0x26f2ba)=>{isStopping=![];let _0x347d7b=null;return _0x1969a8?_0x347d7b=await getBrowserPage(_0x378cce,_0x1479fc):_0x347d7b=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x3c2dd2),send_message(_0x347d7b,_0x3c2dd2,_0x471e77,_0x4053b9,_0x378cce,_0x43035f,_0x359b4d,_0x26f2ba);}),ipcMain['handle']('stop-action',async(_0x5ee82a,_0x4d620d)=>{isStopping=!![];const _0x54d20b=await getBrowserPage(0x1,_0x4d620d);await _0x54d20b['close']();}),ipcMain['handle']('fetch_followers',async(_0x5e63a5,_0x4f0a48,_0x139cf2,_0x762083,_0x47a442,_0x58fdff)=>{isStopping=![];const _0x305db4=await getBrowserPage();return fetch_followers_from_account(_0x5e63a5,_0x305db4,_0x4f0a48,_0x139cf2,_0x762083,_0x47a442,_0x58fdff);}),ipcMain['handle']('get-account-details',async(_0x5a6ed0,_0x3bbf8d,_0x19de0a,_0x5b98b5)=>{isStopping=![];const _0x4c98b6=await getBrowserPage();return fetch_account_details(_0x4c98b6,_0x3bbf8d,_0x19de0a,_0x5b98b5);}),ipcMain['handle']('fetch_likes',async(_0x55bd3c,_0x27c882,_0x29dd03,_0x11650e,_0x3191f5,_0x54a1eb)=>{isStopping=![];const _0x620e14=await getBrowserPage();return fetch_likers_from_post(_0x55bd3c,_0x620e14,_0x27c882,_0x29dd03,_0x11650e,_0x3191f5,_0x54a1eb);}),ipcMain['handle']('fetch_comments',async(_0x5bf5c3,_0x3e8f03,_0x40c8ad,_0x5603ca,_0x19cd61,_0x4c8371)=>{isStopping=![];const _0xd65064=await getBrowserPage();return fetch_comments_from_post(_0x5bf5c3,_0xd65064,_0x3e8f03,_0x40c8ad,_0x5603ca,_0x19cd61,_0x4c8371);});async function updateAppSilent(){const {spawn:_0xa4459}=require('child_process'),_0x47d3e2=require('path'),_0x4720c1=require('electron-log');return _0x4720c1['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x50f265,_0x50af1d)=>{const {updateElectronApp:_0x3e70cd,UpdateSourceType:_0x2ebf59}=require('update-electron-app');_0x3e70cd({'updateSource':{'type':_0x2ebf59['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x4720c1}),_0x50f265('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x3b4244,_0x1a5595)=>{doFullElectronUpdateSilent(),_0x3b4244('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x46c136}=require('child_process'),_0x48b1ff=require('path'),_0x39fbd9=require('electron-log');return _0x39fbd9['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x337be6,_0x161633)=>{const {updateElectronApp:_0x446f1c,UpdateSourceType:_0x44c87b}=require('update-electron-app');_0x446f1c({'updateSource':{'type':_0x44c87b['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x39fbd9}),_0x337be6('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x4c06b0,_0x1b7af1)=>{doFullElectronUpdate(),_0x4c06b0('Update\x20erfolgreich\x20abgeschlossen.');});}ipcMain['handle']('update-app',async(_0x40b161,_0x20bd3e)=>{console['log']('Update\x20Silent:\x20'+_0x20bd3e);if(_0x20bd3e)!(process['platform']==='darwin')&&(await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet'));else{if(!(process['platform']==='darwin'))await updateApp();else return new Promise((_0xcb6176,_0x1887d1)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0xcb6176('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x36efaa=path['join'](__dirname,'mac-updater-intern.sh'),_0xc461bf=spawn('/bin/bash',[_0x36efaa]);_0xc461bf['stdout']['on']('data',_0x32d926=>{console['log']('stdout:\x20'+_0x32d926);}),_0xc461bf['stderr']['on']('data',_0x229984=>{console['error']('stderr:\x20'+_0x229984);}),_0xc461bf['on']('close',_0x3791e0=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x3791e0),_0x3791e0===0x0?_0xcb6176('Update\x20erfolgreich\x20abgeschlossen.'):_0x1887d1(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x3791e0));});}else{if(process['platform']==='win32'){const _0x2180f0=path['join'](__dirname,'../','../','../');process['chdir'](_0x2180f0),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x13f083='soft-ui-updater-windows.ps1',_0x2a90c7=spawn('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x13f083]);_0x2a90c7['stdout']['on']('data',_0x3539e5=>{console['log']('stdout:\x20'+_0x3539e5);}),_0x2a90c7['stderr']['on']('data',_0x4c5482=>{console['error']('stderr:\x20'+_0x4c5482);}),_0x2a90c7['on']('close',_0x4dac24=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x4dac24),_0x4dac24===0x0?_0xcb6176('Update\x20erfolgreich\x20abgeschlossen.'):_0x1887d1(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x4dac24));});}else _0x1887d1(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}});function getRnd(_0x13e421,_0x1c69f0){return Math['random']()*(_0x1c69f0-_0x13e421+0x1)+_0x13e421;}function delay(_0x396519,_0x2180d6){let _0xe5b952=getRnd(_0x396519,_0x2180d6);return new Promise(function(_0x1ec091){setTimeout(_0x1ec091,_0xe5b952);});}async function scroll(_0x14af44,_0x1be0a3,_0x7f1191=0x2,_0x26ef69){const _0x46a055=await _0x14af44['waitForSelector'](_0x1be0a3);for(let _0x587fd2=0x0;_0x587fd2<_0x7f1191;_0x587fd2++){console['log']('Scrolling\x20'+_0x587fd2),await _0x14af44['evaluate'](_0x469926=>{const _0x1292cb=document['querySelector'](_0x469926);_0x1292cb&&_0x1292cb['scrollBy'](0x0,0x190);},_0x1be0a3),await delay(0x320,0x5dc),_0x26ef69();}}async function saveCookies(_0x55405c){let _0x3db1ed=await _0x55405c['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x3db1ed,null,0x2));}async function notificationClear(_0x2faea4){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x2faea4['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x2faea4['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x5df3a5){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x5df3a5);}}async function getTargetProfiles(_0xe529ec){return new Promise((_0x42f878,_0xe2bc87)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0xe529ec,(_0x112b0c,_0x5031a5)=>{_0x112b0c?_0xe2bc87(_0x112b0c):_0x42f878(_0x5031a5);});});}async function login_legacy(_0x537d60,_0x21332d,_0x17a34e){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x537d60,_0x21332d),await createUserIfNotExists(_0x21332d,_0x17a34e);}catch(_0x3901ec){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x3901ec);}try{await _0x537d60['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x537d60['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x537d60['click']('button._a9--._ap36._a9_0');}catch(_0x2ced8e){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x537d60['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x537d60['type']('input[name=\x27username\x27]',_0x21332d,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x537d60['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x537d60['type']('input[name=\x27password\x27]',_0x17a34e,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x537d60['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x537d60['click']('button[type=\x27submit\x27]');}catch(_0xbf7478){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x537d60),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x537d60,_0x21332d);}catch(_0x93ad6){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x93ad6);}}catch(_0x20d19b){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x20d19b);}}async function login(_0x4c15a0,_0x46e24e){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x4c15a0,_0x46e24e),await createUserIfNotExists(_0x46e24e);}catch(_0x313c8c){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x313c8c);}try{await _0x4c15a0['goto']('https://www.instagram.com/accounts/login/');}catch(_0x451c69){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x451c69);}}async function set_login_cookies(_0x4f07ca,_0x38057d){try{await saveCookiesForUser(_0x4f07ca,_0x38057d);}catch(_0x5579da){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x5579da);}}async function waitForXPath(_0x2773b1,_0x845708,_0x36a423={}){return await _0x2773b1['waitForFunction'](_0x37716e=>{return document['evaluate'](_0x37716e,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x36a423,_0x845708),_0x2773b1['evaluateHandle'](_0x14ab66=>document['evaluate'](_0x14ab66,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x845708);}async function send_message(_0x5e5fba,_0x4bfe86,_0x3f3069,_0x2e8e7f,_0x25c569,_0x3902d3,_0x245881,_0x4166ff){return new Promise(async(_0x94c799,_0x1f46a1)=>{_0x3902d3=_0x3902d3['split'](';'),console['log'](_0x3902d3[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x25c569);try{await setCookiesForUser(_0x5e5fba,_0x3902d3[0x0]);}catch(_0x195e3e){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x195e3e),_0x1f46a1({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x195e3e});return;}try{await _0x5e5fba['goto']('https://www.instagram.com/'+_0x4bfe86+'/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x5e5fba);}catch(_0x283d8c){_0x1f46a1({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x283d8c});return;}console['log']('UserSkip:\x20'+_0x245881);if(_0x245881==0x1)try{const _0x100c35=await _0x5e5fba['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x2bf5dc=>_0x2bf5dc['textContent']['trim']());console['log'](_0x100c35);if(_0x100c35==='Following'||_0x100c35==='Folge\x20ich')return _0x94c799({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x187138){}try{await _0x5e5fba['waitForSelector'](K_DIRECT_MSG_BUTTON),await _0x5e5fba['click'](K_DIRECT_MSG_BUTTON);}catch(_0x2ecb04){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x2ecb04);try{await _0x5e5fba['waitForSelector'](K_OPTIONS_BUTTON),await _0x5e5fba['click'](K_OPTIONS_BUTTON),await delay(0x1f4,0x320);const _0x40f200=await waitForXPath(_0x5e5fba,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x40f200['click']();}catch(_0x4fc785){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x4fc785),_0x94c799({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x5e5fba);}catch(_0x173060){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x173060);}try{const _0x1ccbe9=await _0x5e5fba['waitForSelector'](K_CHAT_INPUT_FIELD);if(_0x4166ff){const _0x242a29=await _0x5e5fba['$']('div.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x6ikm8r.x10wlt62');if(_0x242a29)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x4bfe86),_0x94c799({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x1cc811=await _0x5e5fba['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x1cc811),_0x2e8e7f=_0x2e8e7f['replace']('{USERNAME}',_0x4bfe86);let _0x431e1a=_0x1cc811['replace'](/[^\p{L}\s]/gu,''),_0x567401=_0x431e1a['split']('\x20')[0x0];console['log']('Extrahierter\x20Clearname\x20mit\x20Len:\x20'+_0x567401['length']+'nach\x20Split:\x20'+_0x567401);_0x567401['length']>0x2&&!_0x567401['includes']('Instagram')?(_0x2e8e7f=_0x2e8e7f['replaceAll']('{NAME}',_0x567401),_0x2e8e7f=_0x2e8e7f['replaceAll']('{name}',_0x567401)):(_0x2e8e7f=_0x2e8e7f['replaceAll']('\x20{NAME}',''),_0x2e8e7f=_0x2e8e7f['replaceAll']('\x20{name}',''),_0x2e8e7f=_0x2e8e7f['replaceAll']('{NAME}',''),_0x2e8e7f=_0x2e8e7f['replaceAll']('{name}',''));await _0x1ccbe9['type'](_0x2e8e7f,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0xf27b02=await _0x5e5fba['waitForSelector'](K_SEND_MSG_BUTTON);await _0xf27b02['click'](),await delay(0x320,0x3e8),_0x94c799({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!'});}catch(_0xc80b42){try{await _0x5e5fba['waitForSelector'](K_MSG_DISABLED_LABEL);const _0x1a5ee4=await _0x5e5fba['evaluate'](_0x255eb1=>{return document['querySelector'](_0x255eb1)['textContent'];},K_MSG_DISABLED_LABEL);console['log']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20gefunden:\x20'+_0x1a5ee4),console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0xc80b42),_0x94c799({'status':0x195,'message':'Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x4bfe86+'\x20überspringen.'});}catch(_0x54aeab){console['error']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20nicht\x20gefunden:\x20'+_0x54aeab),console['error']('Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x4bfe86+'\x20:\x20'+_0x54aeab),_0x94c799({'status':0x196,'message':'Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x4bfe86+'\x20:\x20'+_0x54aeab});}}});}function handle_fail(_0x59be47){if(isStopping)return new Promise(_0x2c8216=>{_0x2c8216('Scraper\x20gestoppt.');});else{let _0x5210fe='';switch(_0x59be47){case 0x0:_0x5210fe='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x5210fe='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x5210fe='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x5210fe='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x53f879,_0x40e22a)=>{_0x40e22a(_0x5210fe);});}}async function fetch_account_details(_0x1f1583,_0x57399a,_0x37927,_0x32a6f8){try{await setCookiesForUser(_0x1f1583,_0x37927['username']);}catch(_0x281b1f){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x281b1f);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x281b1f);return handle_fail(0x0);}_0x1f1583['setDefaultNavigationTimeout'](0x7530),await _0x1f1583['goto']('https://www.instagram.com/'+_0x57399a+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x1f1583);const _0x15d68b=await _0x1f1583['evaluate'](()=>{const _0xe0ac7e=document['querySelector']('meta[property=\x22og:image\x22]');return _0xe0ac7e?_0xe0ac7e['getAttribute']('content'):null;});await _0x1f1583['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x4e74db=await _0x1f1583['evaluate'](()=>{const _0x458160=document['querySelector']('meta[name=\x22description\x22]');if(!_0x458160)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0xa2a4ce=_0x458160['getAttribute']('content');if(!_0xa2a4ce)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0xa2a4ce);const _0x592a5c=/\s*[–-]\s*/,_0x19e378=_0xa2a4ce['split'](_0x592a5c);if(_0x19e378['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x4abca9=_0x19e378[0x0],_0x437e01=_0x19e378[0x1],_0x2871af=_0x4abca9['split'](',\x20');if(_0x2871af['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x222426=_0x2871af[0x0]['split']('\x20')[0x0],_0x178520=_0x2871af[0x1]['split']('\x20')[0x0],_0x49464e=_0x2871af[0x2]['split']('\x20')[0x0];let _0x5e592e='',_0x34dd5d='';const _0x5cc4eb='\x20on\x20Instagram:\x20',_0x3901cc=_0x437e01['split'](_0x5cc4eb);return _0x5e592e=_0x3901cc[0x0]['trim'](),_0x5e592e=_0x5e592e['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x3901cc['length']>0x1&&(_0x34dd5d=_0x3901cc[0x1]['trim'](),_0x34dd5d['startsWith']('\x22')&&_0x34dd5d['endsWith']('\x22')&&(_0x34dd5d=_0x34dd5d['substring'](0x1,_0x34dd5d['length']-0x1)['trim']()),_0x34dd5d=_0x34dd5d['replace'](/&quot;/g,'')['trim']()),{'followers':_0x222426,'following':_0x178520,'posts':_0x49464e,'nameText':_0x5e592e,'bio':_0x34dd5d};});console['log']('Extracted\x20profile\x20data:',_0x4e74db);const _0x1b54cb=_0x4e74db['nameText'],_0x50ef74=_0x15d68b,_0x31127d=_0x4e74db['bio'],_0x2d5607=_0x4e74db['followers'],_0x2045ce=_0x4e74db['following'],_0x4d6208=_0x4e74db['posts'],_0x39177d=![],_0x537a07=![],_0x207bd5=![],_0x50b0d9='\x0a\x20\x20INSERT\x20INTO\x20'+_0x32a6f8+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x50b0d9,[_0x57399a,_0x1b54cb,_0x50ef74,_0x31127d,_0x2d5607,_0x2045ce,_0x4d6208,_0x39177d,_0x537a07,_0x207bd5],function(_0x4eba7b){_0x4eba7b?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x4eba7b['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0xd348c8,_0xfb5d49,_0xcea2d8,_0x2cbe9e,_0xaefbc8,_0xa8ca5a,_0x5c8558){let _0x4d82a1=0x4,_0x2a155c=0x0,_0x38e418=0x0;try{await setCookiesForUser(_0xfb5d49,_0xa8ca5a['username']);}catch(_0x27f3c1){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x27f3c1);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x27f3c1);return handle_fail(0x0);}let _0x59e4c6=0x0;try{await _0xfb5d49['goto']('https://www.instagram.com/'+_0xcea2d8+'/'),await notificationClear(_0xfb5d49);try{if(_0x2cbe9e<=0x0){const _0x16079e=await _0xfb5d49['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x476964=await _0xfb5d49['evaluate'](_0x3f3362=>_0x3f3362['innerHTML'],_0x16079e);_0x59e4c6=Math['ceil'](_0x476964/0x4);}else _0x59e4c6=Math['ceil'](_0x2cbe9e/0x4);_0x4d82a1+=_0x59e4c6,_0x38e418=Math['round'](++_0x2a155c/_0x4d82a1*0x64),_0xd348c8['sender']['send']('fetch-progress',_0x38e418,!![]);let _0xecc733=await _0xfb5d49['waitForSelector']('a[href=\x22/'+_0xcea2d8+'/followers/\x22]');await delay(0xbb8,0x1388),await _0xecc733['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0xcea2d8+'\x20gesichtet'),_0x38e418=Math['round'](++_0x2a155c/_0x4d82a1*0x64),_0xd348c8['sender']['send']('fetch-progress',_0x38e418,!![]);}catch(_0x56d72d){console['log']('Follower\x20Liste\x20von\x20'+_0xcea2d8+'\x20nicht\x20gefunden:'+_0x56d72d);throw new Error('Follower\x20Liste\x20von\x20'+_0xcea2d8+'\x20nicht\x20gefunden:'+_0x56d72d);return handle_fail(0x0);}}catch(_0x4fd6cb){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x4fd6cb);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x4fd6cb);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x59e4c6),await scroll(_0xfb5d49,FOLLOWER_FENSTER,_0x59e4c6,_0x53ce8d=>{_0x38e418=Math['round'](++_0x2a155c/_0x4d82a1*0x64),_0xd348c8['sender']['send']('fetch-progress',_0x38e418,!![]);}),await _0xfb5d49['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x42f024=await _0xfb5d49['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x36bb08=await _0xfb5d49['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x38e418=Math['round'](++_0x2a155c/_0x4d82a1*0x64),_0xd348c8['sender']['send']('fetch-progress',_0x38e418,!![]);_0x2cbe9e<=0x0&&(_0x2cbe9e=_0x42f024['length']);let _0x5417ca=[];for(let _0x53711a=0x0;_0x53711a<_0x42f024['length']&&_0x53711a<_0x2cbe9e;_0x53711a++){_0x5417ca['push'](await _0x42f024[_0x53711a]['evaluate'](_0x57d0bd=>_0x57d0bd['textContent']));const _0x47a47d='INSERT\x20INTO\x20'+_0xaefbc8+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x47a47d,[await _0x42f024[_0x53711a]['evaluate'](_0x116fb2=>_0x116fb2['textContent']),await _0x36bb08[_0x53711a]['evaluate'](_0x53587b=>_0x53587b['textContent'])],function(_0x12aaae){_0x12aaae?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0xaefbc8+'\x27:',_0x12aaae['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x38e418=Math['round'](++_0x2a155c/_0x4d82a1*0x64),_0xd348c8['sender']['send']('fetch-progress',_0x38e418,!![]),_0x5c8558&&(_0xd348c8['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0xd348c8,_0xfb5d49,_0xa8ca5a,_0xaefbc8,_0x5417ca)),new Promise(_0x66903d=>{_0x66903d('Scraping\x20finished!');});}catch(_0x3ee972){if(_0x5c8558)throw new Error(_0x3ee972);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0xcea2d8+'\x20nicht\x20gefunden:\x20'+_0x3ee972);return handle_fail(0x0);}}async function fetch_details_from_list(_0x1a0399,_0x42eea4,_0x5f1b71,_0x5b6546,_0x324627){let _0x2b90db=0x0,_0x628674=0x0;for(let _0x3a6401=0x0;_0x3a6401<_0x324627['length'];_0x3a6401++){console['log']('Processing\x20profile:',_0x324627[_0x3a6401]);try{await fetch_account_details(_0x42eea4,_0x324627[_0x3a6401],_0x5f1b71,_0x5b6546);}catch(_0x34529c){console['error']('Detailed\x20Scraping\x20von:\x20',_0x324627[_0x3a6401],_0x34529c);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x324627[_0x3a6401]+'\x20'+_0x34529c);}_0x628674=Math['round'](++_0x2b90db/_0x324627['length']*0x64),_0x1a0399['sender']['send']('fetch-progress',_0x628674,!![],!![]);}}async function fetch_likers_from_post(_0xa25d00,_0xba7531,_0x4ab963,_0x13086f,_0x36ada7,_0x27c71b,_0x19aeff){let _0x4a5d78=0x4,_0x2cfe22=0x0,_0x5f182d=0x0;try{await setCookiesForUser(_0xba7531,_0x27c71b['username']);}catch(_0x4712d0){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4712d0);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4712d0);return handle_fail(0x1);return;}_0x5f182d=Math['round'](++_0x2cfe22/_0x4a5d78*0x64),_0xa25d00['sender']['send']('fetch-progress',_0x5f182d,!![]);try{let _0x30cb78=_0x4ab963['substring'](0x0,_0x4ab963['lastIndexOf']('/')),_0x319cdd=_0x30cb78+'/liked_by';console['log'](_0x319cdd),await _0xba7531['goto'](_0x319cdd),await delay(0x7d0,0xfa0),await notificationClear(_0xba7531),await delay(0xc8,0x1f4),_0x5f182d=Math['round'](++_0x2cfe22/_0x4a5d78*0x64),_0xa25d00['sender']['send']('fetch-progress',_0x5f182d,!![]),await _0xba7531['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x2e6d5f=await _0xba7531['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0xb3943=await _0xba7531['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x2e6d5f['length']);let _0x31d19d=path['join'](__dirname,'/likers.csv');_0x5f182d=Math['round'](++_0x2cfe22/_0x4a5d78*0x64),_0xa25d00['sender']['send']('fetch-progress',_0x5f182d,!![]);_0x13086f<=0x0&&(_0x13086f=_0x2e6d5f['length']);try{let _0xc425e6=[];for(let _0x15e6cc=0x0;_0x15e6cc<_0x2e6d5f['length']&&_0x15e6cc<_0x13086f;_0x15e6cc++){_0xc425e6['push'](await _0x2e6d5f[_0x15e6cc]['evaluate'](_0x598b4a=>_0x598b4a['textContent']));try{const _0x1d46b8='INSERT\x20INTO\x20'+_0x36ada7+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x1d46b8,[await _0x2e6d5f[_0x15e6cc]['evaluate'](_0x32af37=>_0x32af37['textContent']),await _0xb3943[_0x15e6cc]['evaluate'](_0x20d77f=>_0x20d77f['textContent'])],function(_0x198ae0){_0x198ae0?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x36ada7+'\x27:',_0x198ae0['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x4edd1e){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x15e6cc+'\x20:\x20'+_0x4edd1e);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x15e6cc+'\x20:\x20'+_0x4edd1e);return handle_fail(0x1);}}return _0x5f182d=Math['round'](++_0x2cfe22/_0x4a5d78*0x64),_0xa25d00['sender']['send']('fetch-progress',_0x5f182d,!![]),_0x19aeff&&(_0xa25d00['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0xa25d00,_0xba7531,_0x27c71b,_0x36ada7,_0xc425e6)),new Promise(_0x4680be=>{_0x4680be('Scraping\x20finished!');});}catch(_0x2bb8fe){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x2bb8fe);return handle_fail(0x1);}}catch(_0x37a544){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x37a544);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x37a544);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x16880d,_0x3a8c89,_0x2795cf,_0x208226,_0x518631,_0x71ea19,_0x4776c0){let _0x2f9dbb=0x3,_0x5625d3=0x0,_0x2a0fe5=0x0;try{await setCookiesForUser(_0x3a8c89,_0x71ea19['username']);}catch(_0x4f0d){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4f0d);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4f0d);return handle_fail(0x2);}try{console['log'](_0x2795cf),await _0x3a8c89['goto'](_0x2795cf),await delay(0x7d0,0xfa0),await notificationClear(_0x3a8c89),await delay(0xc8,0x1f4);const _0xd9566d=COM_COMMENTS_BOX_BODY_DIV;let _0x55bef7;const _0x570438=await _0x3a8c89['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x331a78=await _0x3a8c89['evaluate'](_0x2cc269=>_0x2cc269['innerHTML'],_0x570438),_0x489861=String(_0x331a78)['replace'](/[^0-9]/g,''),_0x3a3da6=Number(_0x489861)/0x14;_0x208226<=0x0?_0x55bef7=Math['ceil'](_0x3a3da6/0x3):_0x55bef7=Math['ceil'](_0x208226/0x3);_0x2f9dbb+=_0x55bef7,_0x2a0fe5=Math['round'](++_0x5625d3/_0x2f9dbb*0x64),_0x16880d['sender']['send']('fetch-progress',_0x2a0fe5,!![]),console['log']('Auto-scrolls:\x20'+_0x55bef7),await scroll(_0x3a8c89,_0xd9566d,_0x55bef7,_0x332bb6=>{_0x2a0fe5=Math['round'](++_0x5625d3/_0x2f9dbb*0x64),_0x16880d['sender']['send']('fetch-progress',_0x2a0fe5,!![]);});try{const _0xd06acc=COM_REPLY_BUTTON_SPAN;await _0x3a8c89['waitForSelector'](_0xd06acc),await delay(0x1f4,0x320);const _0x450509=await _0x3a8c89['$$'](_0xd06acc);console['log'](_0x450509);let _0x831086=_0x450509['length'];await delay(0xc8,0x1f4);try{for(let _0x5a399d=0x0;_0x5a399d<_0x831086;_0x5a399d++){_0x450509[_0x5a399d]['click'](),await delay(0x320,0x5dc);}}catch(_0x15ef5a){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x15ef5a);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x15ef5a);return handle_fail(0x2);}}catch(_0x8ef18e){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x5c7b52=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x3a8c89['waitForSelector'](_0x5c7b52),await delay(0x1f4,0x320),_0x2a0fe5=Math['round'](++_0x5625d3/_0x2f9dbb*0x64),_0x16880d['sender']['send']('fetch-progress',_0x2a0fe5,!![]);const _0x27217=await _0x3a8c89['$$'](_0x5c7b52);let _0x38dec7=path['join'](__dirname,'/comments.csv');_0x208226<=0x0&&(_0x208226=_0x27217['length']);console['log']('fetch_limit:\x20'+_0x208226),console['log']('comments_len:\x20'+_0x27217['length']),_0x208226++;try{let _0x782e4b=[];for(let _0x314638=0x1;_0x314638<_0x27217['length']&&_0x314638<_0x208226;_0x314638++){try{_0x782e4b['push'](await _0x27217[_0x314638]['evaluate'](_0x3fcdda=>_0x3fcdda['textContent']));const _0x329417=await db['prepare']('INSERT\x20INTO\x20'+_0x518631+'\x20(username)\x20VALUES\x20(?)');await _0x329417['run'](await _0x27217[_0x314638]['evaluate'](_0x3ba321=>_0x3ba321['textContent']),function(_0x17585b){_0x17585b&&console['log']('error\x20in\x20add-user:'+_0x17585b);}),await _0x329417['finalize']();}catch(_0x350fe4){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x314638+'\x20:\x20'+_0x350fe4);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x314638+'\x20:\x20'+_0x350fe4);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x2a0fe5=Math['round'](++_0x5625d3/_0x2f9dbb*0x64),_0x16880d['sender']['send']('fetch-progress',_0x2a0fe5,!![]),_0x16880d['sender']['send']('fetch-progress',0x64,!![]),_0x4776c0&&(_0x16880d['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x16880d,_0x3a8c89,_0x71ea19,_0x518631,_0x782e4b)),_0x16880d['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x5d729c=>{_0x5d729c('Scraping\x20finished!');});}catch(_0x5bb427){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x5bb427);return handle_fail(0x2);}}catch(_0x267848){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x267848);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x267848);return handle_fail(0x2);}}async function set_clearname_from_username(_0x1c58be,_0x15c5d5,_0x3e514f=null){try{let _0x3f4ac1,_0xb6d13b;const _0x4bcd39='SELECT\x20username\x20FROM\x20'+_0x15c5d5+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x4bcd39,[],(_0xadb1e9,_0x193629)=>{_0xadb1e9&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0xadb1e9['message']),_0x193629['length']===0x0&&(_0xb6d13b=_0x193629['length']),_0x3f4ac1=_0x193629['map'](_0x48254e=>_0x48254e['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0xb6d13b);if(_0xb6d13b===0x0){console['log']('Leave');return;}const _0x24392d=await _0x1c58be['waitForSelector'](IG_SEARCH_BUTTON);await _0x24392d['click'](),await delay(0x4b0,0x7d0);for(let _0x2819fb of _0x3f4ac1){const _0x1d6a70=await _0x1c58be['waitForSelector'](IG_SEARCH_INPUT);await _0x1d6a70['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x1c58be['type'](IG_SEARCH_INPUT,_0x2819fb,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x5f5cfe=0x1;while(_0x5f5cfe!=0x14){console['log']('Schleife');try{let _0x245af9=IG_NAME_SPAN_PART1+_0x5f5cfe+IG_USERNAME_SPAN_PART2;const _0x579810=await _0x1c58be['waitForSelector'](_0x245af9),_0x5e117e=await _0x1c58be['evaluate'](_0x27ea54=>_0x27ea54['innerHTML'],_0x579810);await delay(0xc8,0x1f4);if(_0x5e117e==_0x2819fb){let _0x10c91c=IG_NAME_SPAN_PART1+_0x5f5cfe+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x151c82=await _0x1c58be['waitForSelector'](_0x10c91c);let _0x90a00e=await _0x1c58be['evaluate'](_0x22fcd3=>_0x22fcd3['innerHTML'],_0x151c82);const _0x2e2d5a=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x1e9be6=_0x90a00e['match'](_0x2e2d5a);_0x1e9be6?_0x90a00e=_0x1e9be6[0x1]['trim']():_0x90a00e=_0x90a00e['trim']();_0x90a00e['includes']('•')&&(_0x90a00e=_0x90a00e['substring'](0x0,_0x90a00e['indexOf']('•')-0x1));const _0xea29ec='UPDATE\x20'+_0x15c5d5+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0xea29ec,[_0x90a00e,_0x5e117e],function(_0x36341f){_0x36341f&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x36341f['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x5f5cfe++;}catch(_0x43f0aa){const _0xae8f10='UPDATE\x20'+_0x15c5d5+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0xae8f10,['',_0x2819fb],function(_0x1e47a7){_0x1e47a7&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x1e47a7['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x43f0aa);break;}}_0x3e514f&&_0x3e514f();}await _0x24392d['click']();}catch(_0x3c7f5d){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x3c7f5d);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x5a7952,_0x58cf08)=>{const _0x4593ca='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x4593ca,[],(_0x358727,_0x2129c1)=>{_0x358727?_0x58cf08(_0x358727):_0x5a7952(_0x2129c1);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x503c8d,_0x2d7513)=>{const _0x53fca5='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x53fca5,[],async(_0x425463,_0x1e3428)=>{if(_0x425463)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x425463['message']),_0x2d7513({'status':'error','message':_0x425463['message']});else try{const _0x5bf267=await Promise['all'](_0x1e3428['map'](_0x2bd4bd=>{return new Promise(_0x3c7f48=>{if(!_0x2bd4bd['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x2bd4bd['campaign_name']),_0x3c7f48({'campaign_name':_0x2bd4bd['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0xf988f6='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x2bd4bd['list_id'],_0x37ba28='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x2bd4bd['list_id']+'\x22';db['get'](_0xf988f6,[],(_0x42608d,_0x2690f9)=>{_0x42608d?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x2bd4bd['campaign_name']+':',_0x42608d['message']),_0x3c7f48({'campaign_name':_0x2bd4bd['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x37ba28,[],(_0x1ef96a,_0x1ff89b)=>{_0x1ef96a?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x2bd4bd['campaign_name']+':',_0x1ef96a['message']),_0x3c7f48({'campaign_name':_0x2bd4bd['campaign_name'],'lead_count':_0x2690f9?_0x2690f9['lead_count']:0x0,'contacted_count':'N/A'})):_0x3c7f48({'campaign_name':_0x2bd4bd['campaign_name'],'lead_count':_0x2690f9?_0x2690f9['lead_count']:0x0,'contacted_count':_0x1ff89b?_0x1ff89b['contacted_count']:0x0});});});});}));_0x503c8d({'status':'success','campaigns':_0x5bf267});}catch(_0x102257){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x102257),_0x2d7513({'status':'error','message':_0x102257['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x5b56a4,_0x3a06ed)=>{return new Promise((_0x572478,_0x3040d0)=>{const _0x80ac6='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x80ac6,[_0x3a06ed],(_0x457992,_0x514107)=>{_0x457992?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x457992),_0x3040d0(_0x457992)):(console['log']('ROWS'),console['log'](_0x514107),debugDatabaseContents(),_0x572478(_0x514107));});});});const showTableContents=_0x155281=>{return new Promise((_0x341bbd,_0x2d94ac)=>{const _0x3719d5='SELECT\x20*\x20FROM\x20'+_0x155281+';';campaignDB['all'](_0x3719d5,(_0x803db1,_0x2938c4)=>{_0x803db1?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x155281+':',_0x803db1),_0x2d94ac(_0x803db1)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x155281+':',_0x2938c4),_0x341bbd({'status':'success','message':_0x2938c4}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x24a48d){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x24a48d);}}ipcMain['handle']('create-campaign',async(_0x4bbecb,_0x1981b2)=>{return new Promise((_0x4b94a1,_0x2fd28d)=>{const _0x33cd13='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x33cd13,[String(_0x1981b2)],function(_0x38f392){_0x38f392?_0x2fd28d(_0x38f392):_0x4b94a1({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x3f0d42,_0x124303)=>{return new Promise((_0x4c3bdc,_0x724b2c)=>{const _0x5be2e5='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x5be2e5,[_0x124303],function(_0x415d6a){_0x415d6a?_0x724b2c(_0x415d6a):_0x4c3bdc({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x188feb,_0x456737,_0x46643f,_0x4c12a2,_0x273189,_0x4ddd80,_0xda5120,_0x1f23ed)=>{const _0x3b662c=await createMessageID(_0x273189);return new Promise((_0x5d2f8f,_0x1f1175)=>{if(!_0x456737||!_0x46643f||!_0x4c12a2||!_0x3b662c||!_0x4ddd80)return _0x1f1175({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x3b662c);const _0x455e02='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x455e02,[_0x46643f,_0x4c12a2,_0x3b662c,_0x4ddd80,_0xda5120,_0x1f23ed,_0x456737],function(_0x417241){if(_0x417241)_0x1f1175({'status':'error','message':_0x417241['message']});else this['changes']===0x0?_0x1f1175({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x5d2f8f({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x538d30,_0x45b248,_0x5cf5ec,_0x39fd1c,_0x45d32e)=>{return new Promise((_0x256348,_0x2ca83d)=>{const _0x190995='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x190995,[_0x45b248,_0x5cf5ec,_0x39fd1c,_0x45d32e],function(_0x5eddd7){return _0x5eddd7?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x5eddd7['message']),_0x2ca83d('insert-dm-response',{'success':![],'message':_0x5eddd7['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x256348('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x5ecfa1=>{return new Promise((_0x268cce,_0x148252)=>{const _0x2b6c72='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x2b6c72,[_0x5ecfa1],(_0x3fbf6f,_0x572a5f)=>{if(_0x3fbf6f)_0x148252({'status':'error','message':_0x3fbf6f['message']});else{if(_0x572a5f)_0x268cce(_0x572a5f['message_id']);else{const _0x4ba0df='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x4ba0df,[_0x5ecfa1],function(_0x15375d){_0x15375d?_0x148252({'status':'error','message':_0x15375d['message']}):_0x268cce(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x36ec13,_0x4a87ef)=>{return new Promise((_0x28c14f,_0x7f13a2)=>{const _0x262a1f='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x4a87ef;db['get'](_0x262a1f,(_0xdee4ff,_0x1bf4f5)=>{_0xdee4ff?_0x7f13a2({'status':'error','message':_0xdee4ff['message']}):_0x28c14f({'status':'success','count':_0x1bf4f5['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0xfe802f,_0x15ced1){try{const _0x45bf61=await new Promise((_0x24fb6e,_0x59fca9)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x15ced1],(_0x48578d,_0x38f7aa)=>{if(_0x48578d)_0x59fca9(_0x48578d);else{if(_0x38f7aa['length']>0x0){let _0x38e8c1=JSON['parse'](_0x38f7aa[0x0]['cookie']);console['log'](_0x38e8c1),_0x24fb6e(_0x38e8c1);}else _0x59fca9(new Error('User\x20with\x20username\x20'+_0x15ced1+'\x20does\x20not\x20exist.'));}});});await _0xfe802f['setCookie'](..._0x45bf61),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0xbbc594){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0xbbc594);}}async function saveCookiesForUser(_0x1774c8,_0x31239){try{const _0x534dc6=await _0x1774c8['cookies']();if(!_0x534dc6||_0x534dc6['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x31239);const _0x31efb8=JSON['stringify'](_0x534dc6);if(_0x31efb8['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x31239);return new Promise((_0x835d90,_0x17b623)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x31239],(_0xc42fd9,_0x3eb5c2)=>{if(_0xc42fd9)return console['error']('Error\x20checking\x20user\x20existence:',_0xc42fd9),_0x17b623(_0xc42fd9);if(_0x3eb5c2){const _0x1e89ed=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x1e89ed['run'](_0x31efb8,_0x31239,function(_0x52c6e1){return _0x52c6e1?(console['error']('Error\x20updating\x20cookies:',_0x52c6e1),_0x17b623(_0x52c6e1)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x31239),_0x835d90());});}else{const _0x194539=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x194539['run'](_0x31239,_0x31efb8,function(_0x2b3cd4){return _0x2b3cd4?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x2b3cd4),_0x17b623(_0x2b3cd4)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x31239),_0x835d90());});}});});}catch(_0x59eb3b){console['error']('Error\x20fetching\x20cookies:',_0x59eb3b);throw _0x59eb3b;}}async function createUserIfNotExists(_0x1f22e4){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x1f22e4],(_0x1a0b5c,_0x22eeae)=>{if(_0x1a0b5c){console['error']('Error\x20checking\x20user\x20existence:',_0x1a0b5c);throw _0x1a0b5c;}else{if(!_0x22eeae){const _0x34b844=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x34b844['run'](_0x1f22e4,function(_0x4822fc){_0x4822fc?console['error']('Error\x20inserting\x20new\x20user:',_0x4822fc):console['log']('New\x20user\x20created:',_0x1f22e4);});}else console['log']('User\x20already\x20exists:',_0x1f22e4);}});}catch(_0x510581){console['error']('Error\x20creating\x20user:',_0x510581);throw _0x510581;}}ipcMain['handle']('create-relation',async(_0x524128,_0x1c7ff3)=>{return new Promise((_0x3b5642,_0xdbb285)=>{const _0x33a659='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x1c7ff3+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x33a659,function(_0x250f5e){_0x250f5e?_0xdbb285(_0x250f5e):_0x3b5642({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x152aff,_0x47c0e9)=>{return console['log']('droping\x20table'+_0x47c0e9),new Promise((_0x4c1c5f,_0x2768ca)=>{const _0x26f876='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x47c0e9;console['log']('droping\x20table'+_0x47c0e9),db['run'](_0x26f876,function(_0x3f8178){_0x3f8178?_0x2768ca(_0x3f8178):_0x4c1c5f({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x552f83=>{return new Promise((_0x1c1da7,_0x527d27)=>{const _0x33a87e='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x33a87e,[],(_0x57adc9,_0x5a3a11)=>{_0x57adc9?_0x527d27(_0x57adc9):_0x1c1da7(_0x5a3a11['map'](_0x52bb22=>_0x52bb22['name']));});});}),ipcMain['handle']('add-user',async(_0x375d86,_0x3e844b,_0x567e52)=>{return new Promise(_0x101c68=>{const _0x115be9=db['prepare']('INSERT\x20INTO\x20'+_0x567e52+'\x20(username)\x20VALUES\x20(?)');_0x115be9['run'](_0x3e844b,function(_0x49303a){_0x49303a?console['log']('error\x20in\x20add-user:'+_0x49303a):_0x101c68({'status':'success','id':this['lastID']});}),_0x115be9['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x2e3161,_0x1adf86)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x5951a0,_0x5535a8)=>{if(_0x5951a0)_0x1adf86(_0x5951a0);else{_0x2e3161({'status':'success','users':_0x5535a8});for(_0x5535a8 of _0x5535a8){console['log'](_0x5535a8['username']);}}});});}),ipcMain['handle']('get-data',async(_0x5af9dc,_0x12ce4e)=>{return new Promise((_0x546f98,_0x52b3bf)=>{const _0x1f7cd6='SELECT\x20*\x20FROM\x20'+_0x12ce4e;console['log'](_0x1f7cd6),db['all'](_0x1f7cd6,[],(_0x4a2007,_0x5c9ec0)=>{_0x4a2007?_0x52b3bf(_0x4a2007):_0x546f98(_0x5c9ec0);});});}),ipcMain['handle']('get-accounts',async _0x47224b=>{return new Promise((_0x126cce,_0x5dcd07)=>{const _0x1039ea='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x1039ea),igaccountsDB['all'](_0x1039ea,[],(_0x25247e,_0xe3350c)=>{_0x25247e?_0x5dcd07(_0x25247e):_0x126cce(_0xe3350c);});});}),ipcMain['handle']('get-targets',async(_0x21f247,_0x116dc3)=>{return getTargetProfiles(_0x116dc3);}),ipcMain['handle']('delete-user',async(_0x4deecc,_0xbfa825,_0x50e5f1)=>{return new Promise((_0x1ff816,_0x9e6b35)=>{const _0x1d0c03=db['prepare']('DELETE\x20FROM\x20'+_0x50e5f1+'\x20WHERE\x20username\x20=\x20?');_0x1d0c03['run'](_0xbfa825,function(_0x20e890){_0x20e890?_0x9e6b35(_0x20e890):_0x1ff816({'status':'success','changes':this['changes']});}),_0x1d0c03['finalize']();});}),ipcMain['handle']('delete-account',async(_0x38c8fb,_0x5df3f5)=>{const _0x27d8c7=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x27d8c7['run'](_0x5df3f5,function(_0x28d725){_0x28d725&&console['log'](_0x28d725);}),_0x27d8c7['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x496966,_0x509bbf)=>{const _0x188595='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x188595,[],(_0x4a28ec,_0x390cb3)=>{_0x4a28ec?_0x509bbf({'status':'error','message':_0x4a28ec['message']}):_0x496966({'status':'success','contactedCount':_0x390cb3['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x5875f6,_0x1dd427)=>{const _0x219a84='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x219a84,[],(_0x543929,_0x800f18)=>{_0x543929?_0x1dd427({'status':'error','message':_0x543929['message']}):_0x5875f6({'status':'success','contactedCount':_0x800f18['contactedCount']});});});});function exportDatabase(_0x12137a){return new Promise((_0x89c8a7,_0x36c220)=>{const _0x13c2d4='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x12137a+'\x0a\x20\x20\x20\x20';db['all'](_0x13c2d4,[],async(_0x18ce6e,_0x2ba046)=>{if(_0x18ce6e){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x18ce6e['message']),_0x36c220(_0x18ce6e);return;}if(!_0x2ba046||_0x2ba046['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x89c8a7();return;}const _0xe2f44=XLSX['utils']['json_to_sheet'](_0x2ba046),_0x2553a6=XLSX['utils']['sheet_to_csv'](_0xe2f44);try{const {canceled:_0x5637f8,filePath:_0x115e8a}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x12137a+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x5637f8||!_0x115e8a){console['log']('Speichern\x20abgebrochen.'),_0x89c8a7();return;}fs['writeFile'](_0x115e8a,_0x2553a6,'utf8',_0x4f53fd=>{_0x4f53fd?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x4f53fd['message']),_0x36c220(_0x4f53fd)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x115e8a),_0x89c8a7());});}catch(_0x54b147){console['error']('Fehler\x20im\x20Speicherdialog:',_0x54b147),_0x36c220(_0x54b147);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x5d4509,_0x2b558e)=>{shell['openExternal'](_0x2b558e);});