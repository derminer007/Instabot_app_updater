const {app,BrowserWindow,ipcMain,dialog}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),ANZAHL_FOLLOWER_BUTTON='div.x9f619.x1n2onr6\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_NEW_MSG_BUTTON='div.x1i10hfl.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.x6s0dn4.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x1ypdohk.x78zum5.xl56j7k.x1y1aw1k.x1sxyh0.xwib8y2.xurb0ha.xcdnw81',K_SEARCH_BAR_INPUT='body\x20>\x20div.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x1k90msu.x6o7n8i.x1qfuztq.x10l6tqk.x17qophe.x13vifvy.x1hc1fzr.x71s49j.xh8yej3\x20>\x20div\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.x1q0g3np.x1a02dak.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20input',K_USERNAME_SPALTE_PART1='div:nth-child(',K_CLEARNAME_SPALTE_PART2=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1pi30zi.x1swvt13.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span\x20>\x20span',K_CHAT_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.x972fbf.xcfux6l.x1qhh985.xm0m39n.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.xexx8yu.x18d9i69.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1lq5wgf.xgqcy7u.x30kzoy.x9jhf4c.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x9bdzbf.x1ypdohk.x78zum5.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x1n2onr6.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xn3w4p2.x5ib6vp.xc73u3c.x1tu34mt.xzloghq',K_NACHRICHT_SCHREIBEN_INPUT_DIV='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1i64zmx.xw3qccf.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f.notranslate',K_SENDEN_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.xfs2ol5[role=\x22button\x22][tabindex=\x220\x22]',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x4ee929=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x4ee929['loadFile'](path['join'](__dirname,'index.html'));}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x1f10cd){var _0x1a384e=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x1f45a1){console['log']('window\x20id:'+_0x1f45a1['id']),_0x1f45a1['id']>0x1&&(_0x1a384e=!![]);}),console['log']('child\x20opened\x20='+_0x1a384e);if(!_0x1a384e){const _0x1de82b=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x1de82b['loadFile'](_0x1f10cd['url']);}else console['log']('child\x20window\x20opened\x20already');}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x3c19f0=0x1,_0x150874=0x0){let _0x14e27a='',_0xc04c23=null;if(process['platform']==='darwin')_0x14e27a='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome';else{if(process['platform']==='win32')_0x14e27a='chromium_local/chrome-win/chrome.exe';else{if(process['platform']==='linux'){}}}if(_0x3c19f0===0x0&&!pageStack[_0x150874])return browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0x14e27a}),_0xc04c23=await browser['newPage'](),_0xc04c23['setDefaultNavigationTimeout'](0x1d4c),_0xc04c23['setDefaultTimeout'](0x1d4c),pageStack[_0x150874]=_0xc04c23,_0xc04c23;return(browser===null||pageStack[_0x150874]['isClosed']())&&(browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0x14e27a})),(pageStack[_0x150874]===null||pageStack[_0x150874]['isClosed']())&&(_0xc04c23=await browser['newPage'](),_0xc04c23['setDefaultNavigationTimeout'](0x1d4c),_0xc04c23['setDefaultTimeout'](0x1d4c),pageStack[_0x150874]=_0xc04c23),pageStack[_0x150874];}ipcMain['on']('login',async(_0x15183f,_0x1a8e94,_0x522480)=>{const _0x2baaef=await getBrowserPage();await _0x2baaef['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x2baaef,_0x1a8e94,_0x522480);}),ipcMain['handle']('sendMessage',async(_0x2c2225,_0x53f955,_0x4430ce,_0x4a2c1a,_0x474b6b,_0x469826,_0x35c3bd,_0x183dff)=>{isStopping=![];let _0x47d583=null;return _0x35c3bd?_0x47d583=await getBrowserPage(_0x474b6b,_0x183dff):_0x47d583=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x53f955),new Promise((_0x20fa76,_0x3e1d31)=>{send_message(_0x47d583,_0x53f955,_0x4430ce,_0x4a2c1a,_0x474b6b,_0x469826)['then'](_0x574e26=>_0x20fa76(_0x574e26))['catch'](_0x18bda8=>_0x3e1d31(_0x18bda8));});}),ipcMain['handle']('stop-action',async(_0x3ffe1e,_0x550210)=>{isStopping=!![];const _0x71c552=await getBrowserPage(0x1,_0x550210);await _0x71c552['close']();}),ipcMain['handle']('fetch_followers',async(_0x23b552,_0x13ed8b,_0x5cb41d,_0x5a38ee,_0x46b135)=>{isStopping=![];const _0x5d3379=await getBrowserPage();return fetch_followers_from_account(_0x5d3379,_0x13ed8b,_0x5cb41d,_0x5a38ee,_0x46b135);}),ipcMain['handle']('fetch_likes',async(_0x49d5ea,_0x581130,_0x15ac25,_0x11ff9b,_0x2dc14d)=>{isStopping=![];const _0x477515=await getBrowserPage();return fetch_likers_from_post(_0x477515,_0x581130,_0x15ac25,_0x11ff9b,_0x2dc14d);}),ipcMain['handle']('fetch_comments',async(_0x2d45a1,_0x200e3e,_0x40b05f,_0x3e8c44,_0x584e8c)=>{isStopping=![];const _0x5f2471=await getBrowserPage();return fetch_comments_from_post(_0x5f2471,_0x200e3e,_0x40b05f,_0x3e8c44,_0x584e8c);}),ipcMain['handle']('update-app',async _0x103b30=>{const {spawn:_0x4adbdf}=require('child_process'),_0x2924fb=require('path');if(process['platform']==='darwin'){const _0x2daabe=_0x2924fb['join'](__dirname,'mac-updater-intern.sh'),_0x395450=_0x4adbdf('/bin/bash',[_0x2daabe]);_0x395450['stdout']['on']('data',_0x2b763e=>{console['log']('stdout:\x20'+_0x2b763e);}),_0x395450['stderr']['on']('data',_0x2211ca=>{console['error']('stderr:\x20'+_0x2211ca);}),_0x395450['on']('close',_0x12535c=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x12535c);});}else{if(process['platform']==='win32'){const _0x1dc944=_0x2924fb['join'](__dirname,'../','../','../');process['chdir'](_0x1dc944),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x23ea5d='soft-ui-updater-windows.ps1',_0x36500f='soft-ui-updater-windows.exe',_0x4e2422=_0x4adbdf('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x23ea5d]);console['log']('Windows\x20Pfad:\x20'+_0x1dc944),_0x4e2422['stdout']['on']('data',_0x1296b5=>{console['log']('stdout:\x20'+_0x1296b5);}),_0x4e2422['stderr']['on']('data',_0x28dd77=>{console['error']('stderr:\x20'+_0x28dd77);}),_0x4e2422['on']('close',_0x4fb149=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x4fb149);});}}});function getRnd(_0x2c5325,_0x1d0ca0){return Math['random']()*(_0x1d0ca0-_0x2c5325+0x1)+_0x2c5325;}function delay(_0x589768,_0x551976){let _0x4de0d1=getRnd(_0x589768,_0x551976);return new Promise(function(_0x1034d9){setTimeout(_0x1034d9,_0x4de0d1);});}async function scroll(_0x1755ea,_0x4d15ae,_0x1c28be=0x2){const _0x2869ef=await _0x1755ea['waitForSelector'](_0x4d15ae);for(let _0x22ed6c=0x0;_0x22ed6c<_0x1c28be;_0x22ed6c++){console['log']('Scrolling\x20'+_0x22ed6c),await _0x1755ea['evaluate'](_0x5f41ea=>{const _0x31c136=document['querySelector'](_0x5f41ea);_0x31c136&&_0x31c136['scrollBy'](0x0,0x190);},_0x4d15ae),await delay(0x320,0x5dc);}}async function saveCookies(_0x7140f7){let _0x2e7fcb=await _0x7140f7['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x2e7fcb,null,0x2));}async function notificationClear(_0x89ef93){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x89ef93['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x89ef93['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x10e91b){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x10e91b);}}async function getTargetProfiles(_0x20eba7){return new Promise((_0x2d5039,_0x234ce3)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x20eba7,(_0x17b418,_0x1c72c3)=>{_0x17b418?_0x234ce3(_0x17b418):_0x2d5039(_0x1c72c3);});});}async function login(_0x2aca2a,_0x544737,_0x394213){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x2aca2a,_0x544737),await createUserIfNotExists(_0x544737,_0x394213);}catch(_0x319cfc){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x319cfc);}try{await _0x2aca2a['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x2aca2a['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x2aca2a['click']('button._a9--._ap36._a9_0');}catch(_0x2eedcd){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x2aca2a['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x2aca2a['type']('input[name=\x27username\x27]',_0x544737,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x2aca2a['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x2aca2a['type']('input[name=\x27password\x27]',_0x394213,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x2aca2a['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x2aca2a['click']('button[type=\x27submit\x27]');}catch(_0x501a77){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x2aca2a),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x2aca2a,_0x544737);}catch(_0xa6e13f){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0xa6e13f);}}catch(_0x237ac3){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x237ac3);}}async function send_message(_0x2107f6,_0x125c93,_0x1a9b31,_0x5e5e7a,_0x29d188,_0x55195a){_0x55195a=_0x55195a['split'](';'),console['log'](_0x55195a[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x29d188);if(_0x29d188==0x0){try{await login(_0x2107f6,_0x55195a[0x0],_0x55195a[0x1]);}catch(_0x35e132){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x35e132);return;}await _0x2107f6['goto']('https://www.instagram.com/direct/inbox/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x2107f6);}let _0x322bd0;await set_clearname_from_username(_0x2107f6,_0x1a9b31);const _0x34e289='SELECT\x20clearname\x20FROM\x20'+_0x1a9b31+'\x20WHERE\x20username\x20IS\x20?';db['all'](_0x34e289,[_0x125c93],(_0x44f76a,_0x51696d)=>{_0x44f76a&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x44f76a['message']);if(_0x51696d['length']===0x0)return;_0x322bd0=_0x51696d['map'](_0x1bdd8b=>_0x1bdd8b['clearname']);});try{try{const _0x28d047=K_NEW_MSG_BUTTON;await delay(0xfa0,0x1d4c),await _0x2107f6['waitForSelector'](_0x28d047),await _0x2107f6['click'](_0x28d047),console['log']('Message-Button\x20geklickt'),console['log'](_0x125c93+'\x20'+_0x5e5e7a),await delay(0xfa0,0x1d4c);try{const _0x53349f='input[name=\x22queryBox\x22]',_0x1a4e7c=K_SEARCH_BAR_INPUT;await _0x2107f6['waitForSelector'](_0x1a4e7c),await _0x2107f6['click'](_0x1a4e7c),await delay(0xfa0,0x1d4c),await _0x2107f6['waitForSelector'](_0x53349f),await _0x2107f6['click'](_0x53349f),await delay(0xfa0,0x1d4c),await _0x2107f6['type'](_0x53349f,_0x125c93,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),console['log']('Account\x20Name\x20eingefügt');const _0x307663=K_USERNAME_SPALTE_PART1,_0x518e25=K_CLEARNAME_SPALTE_PART2;let _0x4aff9=0x1;try{while(_0x4aff9!=0x14){console['log']('Schleife');let _0x127e81=_0x307663+_0x4aff9+_0x518e25;const _0x5833e3=await _0x2107f6['waitForSelector'](_0x127e81),_0x4cef92=await _0x2107f6['evaluate'](_0x51d470=>_0x51d470['innerHTML'],_0x5833e3);console['log'](_0x4cef92+';'+_0x322bd0+';'+_0x125c93),delay(0x3e8,0xbb8);if(_0x4cef92==_0x322bd0){console['log']('Account\x20gefunden'),await _0x2107f6['click'](_0x127e81);break;}else{if(_0x4cef92==_0x125c93){console['log']('Account\x20gefunden'),await _0x2107f6['click'](_0x127e81);break;}}_0x4aff9++;}try{await delay(0xbb8,0x1388);const _0x25e34e=await _0x2107f6['waitForSelector'](K_CHAT_BUTTON_DIV);console['log'](_0x25e34e),await delay(0xbb8,0x1388),await _0x25e34e['click']();try{await delay(0xbb8,0x1388);const _0x1c1700=await _0x2107f6['waitForSelector'](K_NACHRICHT_SCHREIBEN_INPUT_DIV);await _0x1c1700['type'](_0x5e5e7a,{'delay':getRnd(0x50,0x78)}),await delay(0xbb8,0x1388);try{const _0x350e2b=await _0x2107f6['waitForSelector'](K_SENDEN_BUTTON_DIV);return await _0x350e2b['click'](),await delay(0xbb8,0x1388),new Promise(_0x2e1fa1=>{_0x2e1fa1('Nachricht\x20erfolgreich\x20verschickt!');});}catch(_0x481adc){console['log']('Message-Button\x20nicht\x20geklickt:\x20'+_0x481adc);}}catch(_0x2cbf86){console['log']('Chat-Fenster\x20nicht\x20gefunden:\x20'+_0x2cbf86);}}catch(_0x288b76){console['log']('error:\x20'+_0x288b76);}}catch(_0x135cc5){return console['log']('User\x20nicht\x20gefunden:'+_0x135cc5),await _0x2107f6['goto']('https://www.instagram.com/direct/inbox/'),new Promise((_0x46e4db,_0x17852a)=>{_0x17852a('user_not_found');});}}catch(_0x21aaf5){console['log']('DM-Fenster\x20nicht\x20gefunden:'+_0x21aaf5);}}catch(_0x113234){console['log']('Message-Button\x20nicht\x20geklickt:'+_0x113234);}}catch(_0x5087be){console['log']('Nachricht\x20senden\x20fehlgeschlagen:\x20'+_0x5087be);}return console['log']('Ende'),await _0x2107f6['goto']('https://www.instagram.com/direct/inbox/'),new Promise((_0x2bd020,_0x4142c8)=>{_0x4142c8('ig_update');});}function handle_fail(_0x472f43){if(isStopping)return new Promise(_0x4931ee=>{_0x4931ee('Scraper\x20gestoppt.');});else{let _0x30faa1='';switch(_0x472f43){case 0x0:_0x30faa1='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x30faa1='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x30faa1='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x30faa1='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x18a65d,_0x3c0ec8)=>{_0x3c0ec8(_0x30faa1);});}}async function fetch_followers_from_account(_0x196e1d,_0x37b533,_0x2a01f3,_0xa928ef,_0x55b648){try{await login(_0x196e1d,_0x55b648['username'],_0x55b648['password']);}catch(_0x5a75b0){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5a75b0),handle_fail(0x0);}let _0xd8c2b4=0x0;try{await _0x196e1d['goto']('https://www.instagram.com/'+_0x37b533+'/'),await notificationClear(_0x196e1d);try{if(_0x2a01f3<=0x0){const _0x2c992f=await _0x196e1d['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x30b868=await _0x196e1d['evaluate'](_0xeb9704=>_0xeb9704['innerHTML'],_0x2c992f);_0xd8c2b4=Math['ceil'](_0x30b868/0x4);}else _0xd8c2b4=Math['ceil'](_0x2a01f3/0x4);let _0x382037=await _0x196e1d['waitForSelector'](FOLLOWER_BUTTON);await delay(0xbb8,0x1388),await _0x382037['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x37b533+'\x20gesichtet');}catch(_0x35061c){return console['log']('Follower\x20Liste\x20von\x20'+_0x37b533+'\x20nicht\x20gefunden:'+_0x35061c),handle_fail(0x0);}}catch(_0x1582aa){return console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x1582aa),handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0xd8c2b4),await scroll(_0x196e1d,FOLLOWER_FENSTER,_0xd8c2b4),await _0x196e1d['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0xe79b17=await _0x196e1d['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x35a73b=await _0x196e1d['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x2a01f3<=0x0&&(_0x2a01f3=_0xe79b17['length']);for(let _0x1fc460=0x0;_0x1fc460<_0xe79b17['length']&&_0x1fc460<_0x2a01f3;_0x1fc460++){console['log'](await _0xe79b17[_0x1fc460]['evaluate'](_0xe3a0aa=>_0xe3a0aa['textContent']));const _0x25fdbe='INSERT\x20INTO\x20'+_0xa928ef+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x25fdbe,[await _0xe79b17[_0x1fc460]['evaluate'](_0x2f1656=>_0x2f1656['textContent']),await _0x35a73b[_0x1fc460]['evaluate'](_0x3cd2f0=>_0x3cd2f0['textContent'])],function(_0x2e31c7){_0x2e31c7?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0xa928ef+'\x27:',_0x2e31c7['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return new Promise(_0x2b255e=>{_0x2b255e('Scraping\x20finished!');});}catch(_0x6f5b83){return console['log']('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x37b533+'\x20nicht\x20gefunden:'+_0x6f5b83),handle_fail(0x0);}}async function fetch_likers_from_post(_0x14d6ee,_0x3a149e,_0x8a0cbf,_0x15922b,_0x3db1a9){try{await login(_0x14d6ee,_0x3db1a9['username'],_0x3db1a9['password']);}catch(_0x3b68ac){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x3b68ac);return handle_fail(0x1);return;}try{let _0xe36d4c=_0x3a149e['substring'](0x0,_0x3a149e['lastIndexOf']('/')),_0x48a7ef=_0xe36d4c+'/liked_by';console['log'](_0x48a7ef),await _0x14d6ee['goto'](_0x48a7ef),await delay(0x7d0,0xfa0),await notificationClear(_0x14d6ee),await delay(0xc8,0x1f4),await _0x14d6ee['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x21eed6=await _0x14d6ee['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x49e7f7=await _0x14d6ee['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x21eed6['length']);let _0x54ad4d=path['join'](__dirname,'/likers.csv');_0x8a0cbf<=0x0&&(_0x8a0cbf=_0x21eed6['length']);try{for(let _0x5d3d04=0x0;_0x5d3d04<_0x21eed6['length']&&_0x5d3d04<_0x8a0cbf;_0x5d3d04++){console['log'](await _0x21eed6[_0x5d3d04]['evaluate'](_0x1cf137=>_0x1cf137['textContent']));try{const _0x20e941='INSERT\x20INTO\x20'+_0x15922b+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x20e941,[await _0x21eed6[_0x5d3d04]['evaluate'](_0x8c01f=>_0x8c01f['textContent']),await _0x49e7f7[_0x5d3d04]['evaluate'](_0x467cc3=>_0x467cc3['textContent'])],function(_0x237ed1){_0x237ed1?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x15922b+'\x27:',_0x237ed1['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x1f34e9){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x5d3d04+'\x20:\x20'+_0x1f34e9),handle_fail(0x1);}}return new Promise(_0x13924a=>{_0x13924a('Scraping\x20finished!');});}catch(_0x86dc76){return console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben'),handle_fail(0x1);}}catch(_0x50166f){return console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x50166f),handle_fail(0x1);}}async function fetch_comments_from_post(_0x4fd257,_0x1d701c,_0x2504c5,_0x251dc2,_0x48f910){try{await login(_0x4fd257,_0x48f910['username'],_0x48f910['password']);}catch(_0x2d9235){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x2d9235),handle_fail(0x2);}try{console['log'](_0x1d701c),await _0x4fd257['goto'](_0x1d701c),await delay(0x7d0,0xfa0),await notificationClear(_0x4fd257),await delay(0xc8,0x1f4);const _0x4c5a50=COM_COMMENTS_BOX_BODY_DIV;let _0x70e561;if(_0x2504c5<=0x0){const _0x48c918=await _0x4fd257['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x2af03a=await _0x4fd257['evaluate'](_0x52b7d5=>_0x52b7d5['innerHTML'],_0x48c918),_0x5e0fe1=String(_0x2af03a)['replace'](/[^0-9]/g,''),_0xdf5da1=Number(_0x5e0fe1)/0x14;_0x70e561=Math['ceil'](_0xdf5da1/0x3);}else _0x70e561=Math['ceil'](_0x2504c5/0x3);console['log']('Auto-scrolls:\x20'+_0x70e561),await scroll(_0x4fd257,_0x4c5a50,_0x70e561);try{const _0x2bbb98=COM_REPLY_BUTTON_SPAN;await _0x4fd257['waitForSelector'](_0x2bbb98),await delay(0x1f4,0x320);const _0x1f70b5=await _0x4fd257['$$'](_0x2bbb98);console['log'](_0x1f70b5),await delay(0xc8,0x1f4);try{for(let _0x31c432=0x0;_0x31c432<_0x1f70b5['length'];_0x31c432++){_0x1f70b5[_0x31c432]['click'](),await delay(0x320,0x5dc);}}catch(_0x131a55){return console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x131a55),handle_fail(0x2);}}catch(_0x9b3c78){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x42d86b=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x4fd257['waitForSelector'](_0x42d86b),await delay(0x1f4,0x320);const _0x465f0c=await _0x4fd257['$$'](_0x42d86b);let _0x3fb672=path['join'](__dirname,'/comments.csv');_0x2504c5<=0x0&&(_0x2504c5=_0x465f0c['length']);console['log']('fetch_limit:\x20'+_0x2504c5),console['log']('comments_len:\x20'+_0x465f0c['length']),_0x2504c5++;try{for(let _0x1742bb=0x1;_0x1742bb<_0x465f0c['length']&&_0x1742bb<_0x2504c5;_0x1742bb++){try{console['log'](await _0x465f0c[_0x1742bb]['evaluate'](_0x92f588=>_0x92f588['textContent']));const _0x2aaa65=await db['prepare']('INSERT\x20INTO\x20'+_0x251dc2+'\x20(username)\x20VALUES\x20(?)');await _0x2aaa65['run'](await _0x465f0c[_0x1742bb]['evaluate'](_0x9d0f8f=>_0x9d0f8f['textContent']),function(_0x53475b){_0x53475b&&console['log']('error\x20in\x20add-user:'+_0x53475b);}),await _0x2aaa65['finalize']();}catch(_0x117aed){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x1742bb+'\x20:\x20'+_0x117aed),handle_fail(0x2);}}await delay(0x4b0,0x7d0);try{await set_clearname_from_username(_0x4fd257,_0x251dc2);}catch(_0x36aa90){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x36aa90);}return new Promise(_0x254e90=>{_0x254e90('Scraping\x20finished!');});}catch(_0x23dcbf){return console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben'),handle_fail(0x2);}}catch(_0x4d761f){return console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x4d761f),handle_fail(0x2);}}async function set_clearname_from_username(_0x56e85c,_0x37f54d){try{let _0x542564,_0x1bade7;const _0x46720d='SELECT\x20username\x20FROM\x20'+_0x37f54d+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x46720d,[],(_0x5d8b12,_0x59e8e0)=>{_0x5d8b12&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x5d8b12['message']),_0x59e8e0['length']===0x0&&(_0x1bade7=_0x59e8e0['length']),_0x542564=_0x59e8e0['map'](_0x3420ed=>_0x3420ed['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x1bade7);if(_0x1bade7===0x0){console['log']('Leave');return;}const _0x422df3=await _0x56e85c['waitForSelector'](IG_SEARCH_BUTTON);await _0x422df3['click'](),await delay(0x4b0,0x7d0);for(let _0x368b43 of _0x542564){const _0x4ca445=await _0x56e85c['waitForSelector'](IG_SEARCH_INPUT);await _0x4ca445['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x56e85c['type'](IG_SEARCH_INPUT,_0x368b43,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x5b0208=0x1;while(_0x5b0208!=0x14){console['log']('Schleife');try{let _0x5d62c3=IG_NAME_SPAN_PART1+_0x5b0208+IG_USERNAME_SPAN_PART2;const _0x126d83=await _0x56e85c['waitForSelector'](_0x5d62c3),_0xde1308=await _0x56e85c['evaluate'](_0xa27583=>_0xa27583['innerHTML'],_0x126d83);await delay(0xc8,0x1f4);if(_0xde1308==_0x368b43){let _0x218596=IG_NAME_SPAN_PART1+_0x5b0208+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0xd32b75=await _0x56e85c['waitForSelector'](_0x218596);let _0x48d7f7=await _0x56e85c['evaluate'](_0x6b264e=>_0x6b264e['innerHTML'],_0xd32b75);const _0x4d0e25=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x134f8d=_0x48d7f7['match'](_0x4d0e25);_0x134f8d?_0x48d7f7=_0x134f8d[0x1]['trim']():_0x48d7f7=_0x48d7f7['trim']();const _0x31d9ca='UPDATE\x20'+_0x37f54d+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x31d9ca,[_0x48d7f7,_0xde1308],function(_0x505c06){_0x505c06&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x505c06['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x5b0208++;}catch(_0x4f3941){const _0x4b0a63='UPDATE\x20'+_0x37f54d+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x4b0a63,['',_0x368b43],function(_0x4ddf04){_0x4ddf04&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x4ddf04['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x4f3941);break;}}}await _0x422df3['click']();}catch(_0x43a625){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x43a625);}}const campaignPath=path['resolve'](__dirname,'data/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(campaign_name\x20TEXT\x20PRIMARY\x20KEY,\x20list_id\x20TEXT,\x20zeitabstand\x20REAL,\x20message_id\x20TEXT,\x20account\x20TEXT,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x28fd43,_0x2c84d7)=>{const _0x404cf5='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x404cf5,[],(_0x4f37cd,_0x1c5388)=>{_0x4f37cd?_0x2c84d7(_0x4f37cd):_0x28fd43(_0x1c5388);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x1e419c,_0x466da0)=>{const _0x47d1e1='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x47d1e1,[],async(_0x5cfadf,_0x3e1d30)=>{if(_0x5cfadf)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x5cfadf['message']),_0x466da0({'status':'error','message':_0x5cfadf['message']});else try{const _0x3f6dde=await Promise['all'](_0x3e1d30['map'](_0x57ebf5=>{return new Promise(_0x548c0e=>{if(!_0x57ebf5['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x57ebf5['campaign_name']),_0x548c0e({'campaign_name':_0x57ebf5['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x2f2304='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x57ebf5['list_id'],_0x2cde97='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20'+_0x57ebf5['list_id']+'\x20WHERE\x20contacted\x20=\x201';db['get'](_0x2f2304,[],(_0x26983a,_0x2cdad8)=>{_0x26983a?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x57ebf5['campaign_name']+':',_0x26983a['message']),_0x548c0e({'campaign_name':_0x57ebf5['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):db['get'](_0x2cde97,[],(_0x171f38,_0x3f9961)=>{_0x171f38?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x57ebf5['campaign_name']+':',_0x171f38['message']),_0x548c0e({'campaign_name':_0x57ebf5['campaign_name'],'lead_count':_0x2cdad8?_0x2cdad8['lead_count']:0x0,'contacted_count':'N/A'})):_0x548c0e({'campaign_name':_0x57ebf5['campaign_name'],'lead_count':_0x2cdad8?_0x2cdad8['lead_count']:0x0,'contacted_count':_0x3f9961?_0x3f9961['contacted_count']:0x0});});});});}));_0x1e419c({'status':'success','campaigns':_0x3f6dde});}catch(_0x377861){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x377861),_0x466da0({'status':'error','message':_0x377861['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x2bc30a,_0x2db93b)=>{return new Promise((_0x136c22,_0x46a44e)=>{const _0x5f553c='SELECT\x20campaign.list_id,\x20message.message_text,\x20campaign.zeitabstand,\x20campaign.account\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x5f553c,[_0x2db93b],(_0x105a3d,_0x284979)=>{_0x105a3d?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x105a3d),_0x46a44e(_0x105a3d)):(console['log']('ROWS'),console['log'](_0x284979),debugDatabaseContents(),_0x136c22(_0x284979));});});});const showTableContents=_0x437a23=>{return new Promise((_0x70dc94,_0x16abbd)=>{const _0x56ce81='SELECT\x20*\x20FROM\x20'+_0x437a23+';';campaignDB['all'](_0x56ce81,(_0x378571,_0x3d63cd)=>{_0x378571?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x437a23+':',_0x378571),_0x16abbd(_0x378571)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x437a23+':',_0x3d63cd),_0x70dc94({'status':'success','message':_0x3d63cd}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x2bf142){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x2bf142);}}ipcMain['handle']('create-campaign',async(_0x5f515e,_0x377f11)=>{return new Promise((_0x103e86,_0x2c9a64)=>{const _0x1b6393='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x1b6393,[String(_0x377f11)],function(_0x43f2f1){_0x43f2f1?_0x2c9a64(_0x43f2f1):_0x103e86({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x3d9180,_0x329111)=>{return new Promise((_0x5e8eb2,_0x2e14fd)=>{const _0x5d9a2a='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x5d9a2a,[_0x329111],function(_0x311fd6){_0x311fd6?_0x2e14fd(_0x311fd6):_0x5e8eb2({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x29bf51,_0x345ee2,_0x5de9be,_0x4a8dfb,_0x495642,_0xf4d2ac)=>{const _0x2c9094=await createMessageID(_0x495642);return new Promise((_0x4a3ce9,_0x380787)=>{if(!_0x345ee2||!_0x5de9be||!_0x4a8dfb||!_0x2c9094||!_0xf4d2ac)return _0x380787({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x2c9094);const _0x1f8ad6='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x1f8ad6,[_0x5de9be,_0x4a8dfb,_0x2c9094,_0xf4d2ac,_0x345ee2],function(_0x462c0b){if(_0x462c0b)_0x380787({'status':'error','message':_0x462c0b['message']});else this['changes']===0x0?_0x380787({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x4a3ce9({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x55fce1,_0x383e75,_0x39ff22,_0x15f8b6)=>{return new Promise((_0x441abf,_0x5c98a5)=>{const _0x29c7e9='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username)\x20VALUES\x20(?,\x20?,\x20?)';campaignDB['run'](_0x29c7e9,[_0x383e75,_0x39ff22,_0x15f8b6],function(_0x5f2a90){return _0x5f2a90?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x5f2a90['message']),_0x5c98a5('insert-dm-response',{'success':![],'message':_0x5f2a90['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x441abf('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x12fc50=>{return new Promise((_0x36476,_0x480eca)=>{const _0x3c8a5d='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x3c8a5d,[_0x12fc50],(_0x4a3152,_0x2bba6a)=>{if(_0x4a3152)_0x480eca({'status':'error','message':_0x4a3152['message']});else{if(_0x2bba6a)_0x36476(_0x2bba6a['message_id']);else{const _0x241366='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x241366,[_0x12fc50],function(_0x3f38e5){_0x3f38e5?_0x480eca({'status':'error','message':_0x3f38e5['message']}):_0x36476(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0xb66bac,_0x6b9d4a)=>{return new Promise((_0x305d6e,_0x3b37eb)=>{const _0x29a930='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x6b9d4a;db['get'](_0x29a930,(_0x1aea46,_0x1a37fb)=>{_0x1aea46?_0x3b37eb({'status':'error','message':_0x1aea46['message']}):_0x305d6e({'status':'success','count':_0x1a37fb['count']});});});});const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20password\x20TEXT,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x3101ba,_0x34634d){try{const _0x14be56=await new Promise((_0x202cdb,_0x5c2e74)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x34634d],(_0x4ac032,_0x3bb0ba)=>{if(_0x4ac032)_0x5c2e74(_0x4ac032);else{if(_0x3bb0ba['length']>0x0){let _0x5b3957=JSON['parse'](_0x3bb0ba[0x0]['cookie']);console['log'](_0x5b3957),_0x202cdb(_0x5b3957);}else _0x5c2e74(new Error('User\x20with\x20username\x20'+_0x34634d+'\x20does\x20not\x20exist.'));}});});await _0x3101ba['setCookie'](..._0x14be56),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x205160){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x205160);}}async function saveCookiesForUser(_0x4c7618,_0x4437d7){try{let _0x5f3631=await _0x4c7618['cookies']();_0x5f3631=JSON['stringify'](_0x5f3631),igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x4437d7],(_0x53c3ba,_0x39537c)=>{if(_0x53c3ba){console['error']('Error\x20checking\x20user\x20existence:',_0x53c3ba);throw _0x53c3ba;}else{if(_0x39537c){const _0x4d0da6=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x4d0da6['run'](_0x5f3631,_0x4437d7,function(_0x1cf442){_0x1cf442?console['error']('Error\x20updating\x20cookies:',_0x1cf442):console['log']('Cookies\x20updated\x20for\x20user:',_0x4437d7);});}else{const _0x1130a6=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x1130a6['run'](_0x4437d7,_0x5f3631,function(_0x1546bb){_0x1546bb?console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x1546bb):console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x4437d7);});}}});}catch(_0x5d5b59){console['error']('Error\x20fetching\x20cookies:',_0x5d5b59);throw _0x5d5b59;}}async function createUserIfNotExists(_0x482b08,_0x10529c){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x482b08],(_0x5b231a,_0x488480)=>{if(_0x5b231a){console['error']('Error\x20checking\x20user\x20existence:',_0x5b231a);throw _0x5b231a;}else{if(!_0x488480){const _0x24f055=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20password)\x20VALUES\x20(?,\x20?)');_0x24f055['run'](_0x482b08,_0x10529c,function(_0xf4cc45){_0xf4cc45?console['error']('Error\x20inserting\x20new\x20user:',_0xf4cc45):console['log']('New\x20user\x20created:',_0x482b08);});}else console['log']('User\x20already\x20exists:',_0x482b08);}});}catch(_0x4ab6ff){console['error']('Error\x20creating\x20user:',_0x4ab6ff);throw _0x4ab6ff;}}ipcMain['handle']('create-relation',async(_0x179623,_0x529e85)=>{return new Promise((_0x4f352c,_0x38949c)=>{const _0x627a41='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x529e85+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT)';db['run'](_0x627a41,function(_0x568225){_0x568225?_0x38949c(_0x568225):_0x4f352c({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x5b2dec,_0x2dc3ae)=>{return console['log']('droping\x20table'+_0x2dc3ae),new Promise((_0x24e639,_0x44b56c)=>{const _0x25c250='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x2dc3ae;console['log']('droping\x20table'+_0x2dc3ae),db['run'](_0x25c250,function(_0x21a42e){_0x21a42e?_0x44b56c(_0x21a42e):_0x24e639({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x54518e=>{return new Promise((_0x4fc140,_0x4e6dcf)=>{const _0x2f65af='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x2f65af,[],(_0x2d5260,_0x5baf1c)=>{_0x2d5260?_0x4e6dcf(_0x2d5260):_0x4fc140(_0x5baf1c['map'](_0xf34b0d=>_0xf34b0d['name']));});});}),ipcMain['handle']('add-user',async(_0x3a8c1c,_0x5b0481,_0x458c7c)=>{return new Promise(_0x4f2c0f=>{const _0x2ffae1=db['prepare']('INSERT\x20INTO\x20'+_0x458c7c+'\x20(username)\x20VALUES\x20(?)');_0x2ffae1['run'](_0x5b0481,function(_0xe5da25){_0xe5da25?console['log']('error\x20in\x20add-user:'+_0xe5da25):_0x4f2c0f({'status':'success','id':this['lastID']});}),_0x2ffae1['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x40c073,_0x5b379c)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x574042,_0x54458d)=>{if(_0x574042)_0x5b379c(_0x574042);else{_0x40c073({'status':'success','users':_0x54458d});for(_0x54458d of _0x54458d){console['log'](_0x54458d['username']);}}});});}),ipcMain['handle']('get-data',async(_0x48cc88,_0xbd4a39)=>{return new Promise((_0x45aa06,_0x2cc18f)=>{const _0xd75277='SELECT\x20*\x20FROM\x20'+_0xbd4a39;console['log'](_0xd75277),db['all'](_0xd75277,[],(_0x4a903f,_0x4d0019)=>{_0x4a903f?_0x2cc18f(_0x4a903f):_0x45aa06(_0x4d0019);});});}),ipcMain['handle']('get-accounts',async _0x300903=>{return new Promise((_0x4f044c,_0x845b3c)=>{const _0x4c3821='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x4c3821),igaccountsDB['all'](_0x4c3821,[],(_0xa425bf,_0x1a3ddd)=>{_0xa425bf?_0x845b3c(_0xa425bf):_0x4f044c(_0x1a3ddd);});});}),ipcMain['handle']('get-targets',async(_0x12afd0,_0x4eb4d2)=>{return getTargetProfiles(_0x4eb4d2);}),ipcMain['handle']('delete-user',async(_0x5890ad,_0x8cf045,_0x22c44d)=>{return new Promise((_0x511353,_0x5a02ab)=>{const _0x17eefb=db['prepare']('DELETE\x20FROM\x20'+_0x22c44d+'\x20WHERE\x20username\x20=\x20?');_0x17eefb['run'](_0x8cf045,function(_0x2c432e){_0x2c432e?_0x5a02ab(_0x2c432e):_0x511353({'status':'success','changes':this['changes']});}),_0x17eefb['finalize']();});}),ipcMain['handle']('delete-account',async(_0x47c7c9,_0x23a535)=>{const _0x12b2d3=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x12b2d3['run'](_0x23a535,function(_0x5d6532){_0x5d6532&&console['log'](_0x5d6532);}),_0x12b2d3['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x351b56,_0x2efd02)=>{const _0x49a107='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x49a107,[],(_0x17f5cc,_0x404f1d)=>{_0x17f5cc?_0x2efd02({'status':'error','message':_0x17f5cc['message']}):_0x351b56({'status':'success','contactedCount':_0x404f1d['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x3c7b40,_0x57ad91)=>{const _0x4af00a='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x4af00a,[],(_0x22a06a,_0x35ff40)=>{_0x22a06a?_0x57ad91({'status':'error','message':_0x22a06a['message']}):_0x3c7b40({'status':'success','contactedCount':_0x35ff40['contactedCount']});});});});