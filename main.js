const {app,BrowserWindow,ipcMain,dialog}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),ANZAHL_FOLLOWER_BUTTON='div.x9f619.x1n2onr6\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_NEW_MSG_BUTTON='div.x1i10hfl.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.x6s0dn4.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x1ypdohk.x78zum5.xl56j7k.x1y1aw1k.x1sxyh0.xwib8y2.xurb0ha.xcdnw81',K_SEARCH_BAR_INPUT='body\x20>\x20div.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x1k90msu.x6o7n8i.x1qfuztq.x10l6tqk.x17qophe.x13vifvy.x1hc1fzr.x71s49j.xh8yej3\x20>\x20div\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.x1q0g3np.x1a02dak.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20input',K_USERNAME_SPALTE_PART1='div:nth-child(',K_CLEARNAME_SPALTE_PART2=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1pi30zi.x1swvt13.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span\x20>\x20span',K_CHAT_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.x972fbf.xcfux6l.x1qhh985.xm0m39n.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.xexx8yu.x18d9i69.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1lq5wgf.xgqcy7u.x30kzoy.x9jhf4c.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x9bdzbf.x1ypdohk.x78zum5.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x1n2onr6.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xn3w4p2.x5ib6vp.xc73u3c.x1tu34mt.xzloghq',K_NACHRICHT_SCHREIBEN_INPUT_DIV='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1i64zmx.xw3qccf.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f.notranslate',K_SENDEN_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.xfs2ol5[role=\x22button\x22][tabindex=\x220\x22]',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x5eb55f=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x5eb55f['loadFile'](path['join'](__dirname,'index.html'));}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x3c26e1){var _0x2ee5b0=![];BrowserWindow['getAllWindows']()['forEach'](function(_0xb92c14){console['log']('window\x20id:'+_0xb92c14['id']),_0xb92c14['id']>0x1&&(_0x2ee5b0=!![]);}),console['log']('child\x20opened\x20='+_0x2ee5b0);if(!_0x2ee5b0){const _0x46c128=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x46c128['loadFile'](_0x3c26e1['url']);}else console['log']('child\x20window\x20opened\x20already');}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x2e6075=0x1,_0x42732c=0x0){let _0x302b3a='',_0x4a354e=null;if(process['platform']==='darwin')_0x302b3a='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome';else{if(process['platform']==='win32')_0x302b3a='chromium_local/chrome-win/chrome.exe';else{if(process['platform']==='linux'){}}}if(_0x2e6075===0x0&&!pageStack[_0x42732c])return browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0x302b3a}),_0x4a354e=await browser['newPage'](),_0x4a354e['setDefaultNavigationTimeout'](0x1d4c),_0x4a354e['setDefaultTimeout'](0x1d4c),pageStack[_0x42732c]=_0x4a354e,_0x4a354e;return(browser===null||pageStack[_0x42732c]['isClosed']())&&(browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0x302b3a})),(pageStack[_0x42732c]===null||pageStack[_0x42732c]['isClosed']())&&(_0x4a354e=await browser['newPage'](),_0x4a354e['setDefaultNavigationTimeout'](0x1d4c),_0x4a354e['setDefaultTimeout'](0x1d4c),pageStack[_0x42732c]=_0x4a354e),pageStack[_0x42732c];}ipcMain['on']('login',async(_0x851d2f,_0x1df5fd,_0xf5da12)=>{const _0x57ce1b=await getBrowserPage();await _0x57ce1b['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x57ce1b,_0x1df5fd,_0xf5da12);}),ipcMain['handle']('sendMessage',async(_0x1fbeb9,_0x1ca0fa,_0x26a666,_0x504a38,_0x4b7973,_0x3652f7,_0x5203bd,_0x322c06)=>{isStopping=![];let _0x52ccdc=null;return _0x5203bd?_0x52ccdc=await getBrowserPage(_0x4b7973,_0x322c06):_0x52ccdc=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x1ca0fa),new Promise((_0x4d3254,_0x3a64ea)=>{send_message(_0x52ccdc,_0x1ca0fa,_0x26a666,_0x504a38,_0x4b7973,_0x3652f7)['then'](_0x3dfcd7=>_0x4d3254(_0x3dfcd7))['catch'](_0x1c85f3=>_0x3a64ea(_0x1c85f3));});}),ipcMain['handle']('stop-action',async(_0x2f5029,_0x1b8649)=>{isStopping=!![];const _0x53c2b7=await getBrowserPage(0x1,_0x1b8649);await _0x53c2b7['close']();}),ipcMain['handle']('fetch_followers',async(_0x1cb92e,_0x2c873b,_0x4647f3,_0x4c2017,_0x68eecd)=>{isStopping=![];const _0x40e8fb=await getBrowserPage();return fetch_followers_from_account(_0x40e8fb,_0x2c873b,_0x4647f3,_0x4c2017,_0x68eecd);}),ipcMain['handle']('fetch_likes',async(_0x1c9b4c,_0x4442c9,_0x4a806c,_0x466a86,_0x5160c9)=>{isStopping=![];const _0xafc902=await getBrowserPage();return fetch_likers_from_post(_0xafc902,_0x4442c9,_0x4a806c,_0x466a86,_0x5160c9);}),ipcMain['handle']('fetch_comments',async(_0x829ead,_0xb0a0f7,_0x3c086e,_0x384186,_0x2c134a)=>{isStopping=![];const _0x22da36=await getBrowserPage();return fetch_comments_from_post(_0x22da36,_0xb0a0f7,_0x3c086e,_0x384186,_0x2c134a);}),ipcMain['handle']('update-app',async _0x94d959=>{const {spawn:_0x34469d}=require('child_process'),_0x40e85e=require('path');if(process['platform']==='darwin'){const _0x5324ee=_0x40e85e['join'](__dirname,'mac-updater-intern.sh'),_0x4c9fdb=_0x34469d('/bin/bash',[_0x5324ee]);_0x4c9fdb['stdout']['on']('data',_0x12991b=>{console['log']('stdout:\x20'+_0x12991b);}),_0x4c9fdb['stderr']['on']('data',_0x4ef0d5=>{console['error']('stderr:\x20'+_0x4ef0d5);}),_0x4c9fdb['on']('close',_0x582e76=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x582e76);});}else{if(process['platform']==='win32'){const _0x45e57b=_0x40e85e['join'](__dirname,'../','../','../');process['chdir'](_0x45e57b),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x38510e='soft-ui-updater-windows.ps1',_0x2666e7='soft-ui-updater-windows.exe',_0x1c864f=_0x34469d('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x38510e]);console['log']('Windows\x20Pfad:\x20'+_0x45e57b),_0x1c864f['stdout']['on']('data',_0x33c5df=>{console['log']('stdout:\x20'+_0x33c5df);}),_0x1c864f['stderr']['on']('data',_0x17f719=>{console['error']('stderr:\x20'+_0x17f719);}),_0x1c864f['on']('close',_0x40642f=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x40642f);});}}});function getRnd(_0x5ad624,_0x4d7ca6){return Math['random']()*(_0x4d7ca6-_0x5ad624+0x1)+_0x5ad624;}function delay(_0x349ad1,_0x5e08f8){let _0x2f0c1b=getRnd(_0x349ad1,_0x5e08f8);return new Promise(function(_0x4d3ca0){setTimeout(_0x4d3ca0,_0x2f0c1b);});}async function scroll(_0x59ea92,_0x45bc26,_0x144f06=0x2){const _0x5243f6=await _0x59ea92['waitForSelector'](_0x45bc26);for(let _0x4fdcfa=0x0;_0x4fdcfa<_0x144f06;_0x4fdcfa++){console['log']('Scrolling\x20'+_0x4fdcfa),await _0x59ea92['evaluate'](_0x1fa2ed=>{const _0x5585d7=document['querySelector'](_0x1fa2ed);_0x5585d7&&_0x5585d7['scrollBy'](0x0,0x190);},_0x45bc26),await delay(0x320,0x5dc);}}async function saveCookies(_0x338df2){let _0x3f633e=await _0x338df2['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x3f633e,null,0x2));}async function notificationClear(_0x211b8d){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x211b8d['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x211b8d['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x4c0070){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x4c0070);}}async function getTargetProfiles(_0x2d9a2c){return new Promise((_0x128ca9,_0x213356)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x2d9a2c,(_0x5856e8,_0x100f53)=>{_0x5856e8?_0x213356(_0x5856e8):_0x128ca9(_0x100f53);});});}async function login(_0x3084ec,_0xe814b2,_0x7d2fd3){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x3084ec,_0xe814b2),await createUserIfNotExists(_0xe814b2,_0x7d2fd3);}catch(_0x553edb){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x553edb);}try{await _0x3084ec['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x3084ec['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x3084ec['click']('button._a9--._ap36._a9_0');}catch(_0x94f03d){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x3084ec['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x3084ec['type']('input[name=\x27username\x27]',_0xe814b2,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x3084ec['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x3084ec['type']('input[name=\x27password\x27]',_0x7d2fd3,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x3084ec['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x3084ec['click']('button[type=\x27submit\x27]');}catch(_0x132517){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x3084ec),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x3084ec,_0xe814b2);}catch(_0x6a9b6f){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x6a9b6f);}}catch(_0x300015){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x300015);}}async function send_message(_0x15a2be,_0x24a8f0,_0x4990a7,_0x4c84fc,_0x61f3cc,_0x2edad6){_0x2edad6=_0x2edad6['split'](';'),console['log'](_0x2edad6[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x61f3cc);if(_0x61f3cc==0x0){try{await login(_0x15a2be,_0x2edad6[0x0],_0x2edad6[0x1]);}catch(_0x404e5b){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x404e5b);return;}await _0x15a2be['goto']('https://www.instagram.com/direct/inbox/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x15a2be);}let _0x1f4b79;await set_clearname_from_username(_0x15a2be,_0x4990a7);const _0x21b606='SELECT\x20clearname\x20FROM\x20'+_0x4990a7+'\x20WHERE\x20username\x20IS\x20?';db['all'](_0x21b606,[_0x24a8f0],(_0x3bd23b,_0x3b6194)=>{_0x3bd23b&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x3bd23b['message']);if(_0x3b6194['length']===0x0)return;_0x1f4b79=_0x3b6194['map'](_0x555087=>_0x555087['clearname']);});try{try{const _0x4b377e=K_NEW_MSG_BUTTON;await delay(0xfa0,0x1d4c),await _0x15a2be['waitForSelector'](_0x4b377e),await _0x15a2be['click'](_0x4b377e),console['log']('Message-Button\x20geklickt'),console['log'](_0x24a8f0+'\x20'+_0x4c84fc),await delay(0xfa0,0x1d4c);try{const _0x394326='input[name=\x22queryBox\x22]',_0x1ff868=K_SEARCH_BAR_INPUT;await _0x15a2be['waitForSelector'](_0x1ff868),await _0x15a2be['click'](_0x1ff868),await delay(0xfa0,0x1d4c),await _0x15a2be['waitForSelector'](_0x394326),await _0x15a2be['click'](_0x394326),await delay(0xfa0,0x1d4c),await _0x15a2be['type'](_0x394326,_0x24a8f0,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),console['log']('Account\x20Name\x20eingefügt');const _0x3424b6=K_USERNAME_SPALTE_PART1,_0x99f486=K_CLEARNAME_SPALTE_PART2;let _0x44a89d=0x1;try{while(_0x44a89d!=0x14){console['log']('Schleife');let _0x27871e=_0x3424b6+_0x44a89d+_0x99f486;const _0x188e3a=await _0x15a2be['waitForSelector'](_0x27871e),_0x2b03a8=await _0x15a2be['evaluate'](_0x44d8a9=>_0x44d8a9['innerHTML'],_0x188e3a);console['log'](_0x2b03a8+';'+_0x1f4b79+';'+_0x24a8f0),delay(0x3e8,0xbb8);if(_0x2b03a8==_0x1f4b79){console['log']('Account\x20gefunden'),await _0x15a2be['click'](_0x27871e);break;}else{if(_0x2b03a8==_0x24a8f0){console['log']('Account\x20gefunden'),await _0x15a2be['click'](_0x27871e);break;}}_0x44a89d++;}try{await delay(0xbb8,0x1388);const _0x578274=await _0x15a2be['waitForSelector'](K_CHAT_BUTTON_DIV);console['log'](_0x578274),await delay(0xbb8,0x1388),await _0x578274['click']();try{await delay(0xbb8,0x1388);const _0x2c0ed1=await _0x15a2be['waitForSelector'](K_NACHRICHT_SCHREIBEN_INPUT_DIV);await _0x2c0ed1['type'](_0x4c84fc,{'delay':getRnd(0x50,0x78)}),await delay(0xbb8,0x1388);try{const _0x1bd18a=await _0x15a2be['waitForSelector'](K_SENDEN_BUTTON_DIV);return await _0x1bd18a['click'](),await delay(0xbb8,0x1388),new Promise(_0x55f860=>{_0x55f860('Nachricht\x20erfolgreich\x20verschickt!');});}catch(_0x5501be){console['log']('Message-Button\x20nicht\x20geklickt:\x20'+_0x5501be);}}catch(_0x462225){console['log']('Chat-Fenster\x20nicht\x20gefunden:\x20'+_0x462225);}}catch(_0x29fb3e){console['log']('error:\x20'+_0x29fb3e);}}catch(_0x325e51){return console['log']('User\x20nicht\x20gefunden:'+_0x325e51),await _0x15a2be['goto']('https://www.instagram.com/direct/inbox/'),new Promise((_0xec93c1,_0x90f44c)=>{_0x90f44c('user_not_found');});}}catch(_0x572d2c){console['log']('DM-Fenster\x20nicht\x20gefunden:'+_0x572d2c);}}catch(_0x4cc0bc){console['log']('Message-Button\x20nicht\x20geklickt:'+_0x4cc0bc);}}catch(_0x64d9f2){console['log']('Nachricht\x20senden\x20fehlgeschlagen:\x20'+_0x64d9f2);}return console['log']('Ende'),await _0x15a2be['goto']('https://www.instagram.com/direct/inbox/'),new Promise((_0x4aebf7,_0x28f75a)=>{_0x28f75a('ig_update');});}function handle_fail(_0x23d2d4){if(isStopping)return new Promise(_0x3e47f3=>{_0x3e47f3('Scraper\x20gestoppt.');});else{let _0x435e8f='';switch(_0x23d2d4){case 0x0:_0x435e8f='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x435e8f='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x435e8f='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x435e8f='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x23f4df,_0x22b5a7)=>{_0x22b5a7(_0x435e8f);});}}async function fetch_followers_from_account(_0xa1d62e,_0x5cb6dd,_0xd58e6d,_0x3f97bc,_0x3baf56){try{await login(_0xa1d62e,_0x3baf56['username'],_0x3baf56['password']);}catch(_0x4357c0){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4357c0),handle_fail(0x0);}let _0x2d8708=0x0;try{await _0xa1d62e['goto']('https://www.instagram.com/'+_0x5cb6dd+'/'),await notificationClear(_0xa1d62e);try{if(_0xd58e6d<=0x0){const _0x66cf75=await _0xa1d62e['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x4b595f=await _0xa1d62e['evaluate'](_0x3b3ca5=>_0x3b3ca5['innerHTML'],_0x66cf75);_0x2d8708=Math['ceil'](_0x4b595f/0x4);}else _0x2d8708=Math['ceil'](_0xd58e6d/0x4);let _0x212d95=await _0xa1d62e['waitForSelector']('a[href=\x22/'+_0x5cb6dd+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x212d95['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x5cb6dd+'\x20gesichtet');}catch(_0x407ae7){return console['log']('Follower\x20Liste\x20von\x20'+_0x5cb6dd+'\x20nicht\x20gefunden:'+_0x407ae7),handle_fail(0x0);}}catch(_0x21b5b1){return console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x21b5b1),handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x2d8708),await scroll(_0xa1d62e,FOLLOWER_FENSTER,_0x2d8708),await _0xa1d62e['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x5be82b=await _0xa1d62e['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x365638=await _0xa1d62e['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0xd58e6d<=0x0&&(_0xd58e6d=_0x5be82b['length']);for(let _0x20c439=0x0;_0x20c439<_0x5be82b['length']&&_0x20c439<_0xd58e6d;_0x20c439++){console['log'](await _0x5be82b[_0x20c439]['evaluate'](_0xf0c715=>_0xf0c715['textContent']));const _0x1da34c='INSERT\x20INTO\x20'+_0x3f97bc+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x1da34c,[await _0x5be82b[_0x20c439]['evaluate'](_0x5c5484=>_0x5c5484['textContent']),await _0x365638[_0x20c439]['evaluate'](_0x105f40=>_0x105f40['textContent'])],function(_0x5020ce){_0x5020ce?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x3f97bc+'\x27:',_0x5020ce['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return new Promise(_0x4cbe58=>{_0x4cbe58('Scraping\x20finished!');});}catch(_0x1c3a27){return console['log']('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x5cb6dd+'\x20nicht\x20gefunden:'+_0x1c3a27),handle_fail(0x0);}}async function fetch_likers_from_post(_0x42fb8b,_0x5ea28b,_0x4307e2,_0x8dcf99,_0x457e07){try{await login(_0x42fb8b,_0x457e07['username'],_0x457e07['password']);}catch(_0xa4d13f){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0xa4d13f);return handle_fail(0x1);return;}try{let _0x1e1f53=_0x5ea28b['substring'](0x0,_0x5ea28b['lastIndexOf']('/')),_0x12b8e9=_0x1e1f53+'/liked_by';console['log'](_0x12b8e9),await _0x42fb8b['goto'](_0x12b8e9),await delay(0x7d0,0xfa0),await notificationClear(_0x42fb8b),await delay(0xc8,0x1f4),await _0x42fb8b['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x24098e=await _0x42fb8b['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x775ab4=await _0x42fb8b['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x24098e['length']);let _0x4caafb=path['join'](__dirname,'/likers.csv');_0x4307e2<=0x0&&(_0x4307e2=_0x24098e['length']);try{for(let _0x5f2fed=0x0;_0x5f2fed<_0x24098e['length']&&_0x5f2fed<_0x4307e2;_0x5f2fed++){console['log'](await _0x24098e[_0x5f2fed]['evaluate'](_0x53382f=>_0x53382f['textContent']));try{const _0x464782='INSERT\x20INTO\x20'+_0x8dcf99+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x464782,[await _0x24098e[_0x5f2fed]['evaluate'](_0x401021=>_0x401021['textContent']),await _0x775ab4[_0x5f2fed]['evaluate'](_0x1d4b00=>_0x1d4b00['textContent'])],function(_0x5a0cfa){_0x5a0cfa?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x8dcf99+'\x27:',_0x5a0cfa['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x46db22){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x5f2fed+'\x20:\x20'+_0x46db22),handle_fail(0x1);}}return new Promise(_0x2ff234=>{_0x2ff234('Scraping\x20finished!');});}catch(_0x274a8b){return console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben'),handle_fail(0x1);}}catch(_0x5c2ac6){return console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x5c2ac6),handle_fail(0x1);}}async function fetch_comments_from_post(_0x1f5565,_0x3af8e1,_0x211398,_0x1648ac,_0x8105a4){try{await login(_0x1f5565,_0x8105a4['username'],_0x8105a4['password']);}catch(_0x29bf00){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x29bf00),handle_fail(0x2);}try{console['log'](_0x3af8e1),await _0x1f5565['goto'](_0x3af8e1),await delay(0x7d0,0xfa0),await notificationClear(_0x1f5565),await delay(0xc8,0x1f4);const _0x4f7134=COM_COMMENTS_BOX_BODY_DIV;let _0x161640;if(_0x211398<=0x0){const _0x384bb4=await _0x1f5565['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x3f6393=await _0x1f5565['evaluate'](_0xc2ba88=>_0xc2ba88['innerHTML'],_0x384bb4),_0x21e8b4=String(_0x3f6393)['replace'](/[^0-9]/g,''),_0x365cc6=Number(_0x21e8b4)/0x14;_0x161640=Math['ceil'](_0x365cc6/0x3);}else _0x161640=Math['ceil'](_0x211398/0x3);console['log']('Auto-scrolls:\x20'+_0x161640),await scroll(_0x1f5565,_0x4f7134,_0x161640);try{const _0x42849a=COM_REPLY_BUTTON_SPAN;await _0x1f5565['waitForSelector'](_0x42849a),await delay(0x1f4,0x320);const _0x4baff3=await _0x1f5565['$$'](_0x42849a);console['log'](_0x4baff3),await delay(0xc8,0x1f4);try{for(let _0x49e338=0x0;_0x49e338<_0x4baff3['length'];_0x49e338++){_0x4baff3[_0x49e338]['click'](),await delay(0x320,0x5dc);}}catch(_0x544117){return console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x544117),handle_fail(0x2);}}catch(_0x272508){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x13d187=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x1f5565['waitForSelector'](_0x13d187),await delay(0x1f4,0x320);const _0x55ebe8=await _0x1f5565['$$'](_0x13d187);let _0x1b2c50=path['join'](__dirname,'/comments.csv');_0x211398<=0x0&&(_0x211398=_0x55ebe8['length']);console['log']('fetch_limit:\x20'+_0x211398),console['log']('comments_len:\x20'+_0x55ebe8['length']),_0x211398++;try{for(let _0x488d2e=0x1;_0x488d2e<_0x55ebe8['length']&&_0x488d2e<_0x211398;_0x488d2e++){try{console['log'](await _0x55ebe8[_0x488d2e]['evaluate'](_0x292fc5=>_0x292fc5['textContent']));const _0x5e3954=await db['prepare']('INSERT\x20INTO\x20'+_0x1648ac+'\x20(username)\x20VALUES\x20(?)');await _0x5e3954['run'](await _0x55ebe8[_0x488d2e]['evaluate'](_0x4698f6=>_0x4698f6['textContent']),function(_0x30da5d){_0x30da5d&&console['log']('error\x20in\x20add-user:'+_0x30da5d);}),await _0x5e3954['finalize']();}catch(_0x5b548d){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x488d2e+'\x20:\x20'+_0x5b548d),handle_fail(0x2);}}await delay(0x4b0,0x7d0);try{await set_clearname_from_username(_0x1f5565,_0x1648ac);}catch(_0x51e1c9){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x51e1c9);}return new Promise(_0x45d14d=>{_0x45d14d('Scraping\x20finished!');});}catch(_0x596729){return console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben'),handle_fail(0x2);}}catch(_0x51516b){return console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x51516b),handle_fail(0x2);}}async function set_clearname_from_username(_0x1e654f,_0x2d0361){try{let _0x2a920f,_0x458c64;const _0x5d7696='SELECT\x20username\x20FROM\x20'+_0x2d0361+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x5d7696,[],(_0x31558e,_0x5aa972)=>{_0x31558e&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x31558e['message']),_0x5aa972['length']===0x0&&(_0x458c64=_0x5aa972['length']),_0x2a920f=_0x5aa972['map'](_0x354633=>_0x354633['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x458c64);if(_0x458c64===0x0){console['log']('Leave');return;}const _0x3235ff=await _0x1e654f['waitForSelector'](IG_SEARCH_BUTTON);await _0x3235ff['click'](),await delay(0x4b0,0x7d0);for(let _0x3ce863 of _0x2a920f){const _0x2207ac=await _0x1e654f['waitForSelector'](IG_SEARCH_INPUT);await _0x2207ac['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x1e654f['type'](IG_SEARCH_INPUT,_0x3ce863,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x4630bb=0x1;while(_0x4630bb!=0x14){console['log']('Schleife');try{let _0x1b3732=IG_NAME_SPAN_PART1+_0x4630bb+IG_USERNAME_SPAN_PART2;const _0xd41f3f=await _0x1e654f['waitForSelector'](_0x1b3732),_0x248608=await _0x1e654f['evaluate'](_0x3f2fbb=>_0x3f2fbb['innerHTML'],_0xd41f3f);await delay(0xc8,0x1f4);if(_0x248608==_0x3ce863){let _0x2ba1bd=IG_NAME_SPAN_PART1+_0x4630bb+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x8670b8=await _0x1e654f['waitForSelector'](_0x2ba1bd);let _0x1836ac=await _0x1e654f['evaluate'](_0x1f896b=>_0x1f896b['innerHTML'],_0x8670b8);const _0x15fd6f=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x59a102=_0x1836ac['match'](_0x15fd6f);_0x59a102?_0x1836ac=_0x59a102[0x1]['trim']():_0x1836ac=_0x1836ac['trim']();const _0x4b1315='UPDATE\x20'+_0x2d0361+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x4b1315,[_0x1836ac,_0x248608],function(_0x184f24){_0x184f24&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x184f24['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x4630bb++;}catch(_0x36e672){const _0x4160c5='UPDATE\x20'+_0x2d0361+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x4160c5,['',_0x3ce863],function(_0x11438){_0x11438&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x11438['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x36e672);break;}}}await _0x3235ff['click']();}catch(_0x1287af){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x1287af);}}const campaignPath=path['resolve'](__dirname,'data/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(campaign_name\x20TEXT\x20PRIMARY\x20KEY,\x20list_id\x20TEXT,\x20zeitabstand\x20REAL,\x20message_id\x20TEXT,\x20account\x20TEXT,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x350f2f,_0x5658f9)=>{const _0x3d1c1f='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x3d1c1f,[],(_0x5d6c02,_0x3e8ada)=>{_0x5d6c02?_0x5658f9(_0x5d6c02):_0x350f2f(_0x3e8ada);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x5532e2,_0x4b088a)=>{const _0x322441='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x322441,[],async(_0x4556f7,_0x569d7f)=>{if(_0x4556f7)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x4556f7['message']),_0x4b088a({'status':'error','message':_0x4556f7['message']});else try{const _0x56d4db=await Promise['all'](_0x569d7f['map'](_0x1f5e9f=>{return new Promise(_0x1de4ce=>{if(!_0x1f5e9f['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x1f5e9f['campaign_name']),_0x1de4ce({'campaign_name':_0x1f5e9f['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x4e3e9='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x1f5e9f['list_id'],_0x421cbd='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20'+_0x1f5e9f['list_id']+'\x20WHERE\x20contacted\x20=\x201';db['get'](_0x4e3e9,[],(_0x47af6b,_0x5a96c1)=>{_0x47af6b?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x1f5e9f['campaign_name']+':',_0x47af6b['message']),_0x1de4ce({'campaign_name':_0x1f5e9f['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):db['get'](_0x421cbd,[],(_0x1f8911,_0x3b2081)=>{_0x1f8911?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x1f5e9f['campaign_name']+':',_0x1f8911['message']),_0x1de4ce({'campaign_name':_0x1f5e9f['campaign_name'],'lead_count':_0x5a96c1?_0x5a96c1['lead_count']:0x0,'contacted_count':'N/A'})):_0x1de4ce({'campaign_name':_0x1f5e9f['campaign_name'],'lead_count':_0x5a96c1?_0x5a96c1['lead_count']:0x0,'contacted_count':_0x3b2081?_0x3b2081['contacted_count']:0x0});});});});}));_0x5532e2({'status':'success','campaigns':_0x56d4db});}catch(_0x4de797){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x4de797),_0x4b088a({'status':'error','message':_0x4de797['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0xa2c26,_0x35d4e7)=>{return new Promise((_0x1f508a,_0x13cb54)=>{const _0x3e6e28='SELECT\x20campaign.list_id,\x20message.message_text,\x20campaign.zeitabstand,\x20campaign.account\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x3e6e28,[_0x35d4e7],(_0x2d7086,_0xfc89bc)=>{_0x2d7086?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x2d7086),_0x13cb54(_0x2d7086)):(console['log']('ROWS'),console['log'](_0xfc89bc),debugDatabaseContents(),_0x1f508a(_0xfc89bc));});});});const showTableContents=_0xb7f225=>{return new Promise((_0x5e42b6,_0x2a7d38)=>{const _0x2a0f2a='SELECT\x20*\x20FROM\x20'+_0xb7f225+';';campaignDB['all'](_0x2a0f2a,(_0x3620da,_0x32174e)=>{_0x3620da?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0xb7f225+':',_0x3620da),_0x2a7d38(_0x3620da)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0xb7f225+':',_0x32174e),_0x5e42b6({'status':'success','message':_0x32174e}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x3dd439){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x3dd439);}}ipcMain['handle']('create-campaign',async(_0x428780,_0xdbf934)=>{return new Promise((_0x38e4fe,_0x237d45)=>{const _0x13839d='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x13839d,[String(_0xdbf934)],function(_0x1f61c4){_0x1f61c4?_0x237d45(_0x1f61c4):_0x38e4fe({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x464724,_0xc8d470)=>{return new Promise((_0xfb6e53,_0x58afea)=>{const _0x5d680f='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x5d680f,[_0xc8d470],function(_0x311f66){_0x311f66?_0x58afea(_0x311f66):_0xfb6e53({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x4bdddd,_0x3d4099,_0x1c2e5c,_0x308bc6,_0x561785,_0xe4b0a9)=>{const _0x44fd87=await createMessageID(_0x561785);return new Promise((_0x298b54,_0x1f02e3)=>{if(!_0x3d4099||!_0x1c2e5c||!_0x308bc6||!_0x44fd87||!_0xe4b0a9)return _0x1f02e3({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x44fd87);const _0x351953='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x351953,[_0x1c2e5c,_0x308bc6,_0x44fd87,_0xe4b0a9,_0x3d4099],function(_0x2adfc2){if(_0x2adfc2)_0x1f02e3({'status':'error','message':_0x2adfc2['message']});else this['changes']===0x0?_0x1f02e3({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x298b54({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x378f30,_0x29cdd5,_0x28547d,_0x2a99f0)=>{return new Promise((_0x3cdc7f,_0x2e55fb)=>{const _0x28b3c0='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username)\x20VALUES\x20(?,\x20?,\x20?)';campaignDB['run'](_0x28b3c0,[_0x29cdd5,_0x28547d,_0x2a99f0],function(_0x1c9ee6){return _0x1c9ee6?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x1c9ee6['message']),_0x2e55fb('insert-dm-response',{'success':![],'message':_0x1c9ee6['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x3cdc7f('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x2d2d3f=>{return new Promise((_0x19804a,_0x54e7e8)=>{const _0x213866='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x213866,[_0x2d2d3f],(_0x279234,_0x414d4d)=>{if(_0x279234)_0x54e7e8({'status':'error','message':_0x279234['message']});else{if(_0x414d4d)_0x19804a(_0x414d4d['message_id']);else{const _0x49ec08='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x49ec08,[_0x2d2d3f],function(_0x1f1541){_0x1f1541?_0x54e7e8({'status':'error','message':_0x1f1541['message']}):_0x19804a(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x482b5e,_0x35006d)=>{return new Promise((_0x41d150,_0x30e119)=>{const _0x2b6938='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x35006d;db['get'](_0x2b6938,(_0x5cd12b,_0x4f5c7e)=>{_0x5cd12b?_0x30e119({'status':'error','message':_0x5cd12b['message']}):_0x41d150({'status':'success','count':_0x4f5c7e['count']});});});});const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20password\x20TEXT,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x225fb8,_0x2668bc){try{const _0x5ceaf5=await new Promise((_0x57d10b,_0xaafd07)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x2668bc],(_0xcb5df,_0x1d8609)=>{if(_0xcb5df)_0xaafd07(_0xcb5df);else{if(_0x1d8609['length']>0x0){let _0x20c314=JSON['parse'](_0x1d8609[0x0]['cookie']);console['log'](_0x20c314),_0x57d10b(_0x20c314);}else _0xaafd07(new Error('User\x20with\x20username\x20'+_0x2668bc+'\x20does\x20not\x20exist.'));}});});await _0x225fb8['setCookie'](..._0x5ceaf5),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x361a34){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x361a34);}}async function saveCookiesForUser(_0x29d2c5,_0x3bd224){try{let _0x429b8f=await _0x29d2c5['cookies']();_0x429b8f=JSON['stringify'](_0x429b8f),igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x3bd224],(_0x4cf0cd,_0x1b202d)=>{if(_0x4cf0cd){console['error']('Error\x20checking\x20user\x20existence:',_0x4cf0cd);throw _0x4cf0cd;}else{if(_0x1b202d){const _0x1aabdf=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x1aabdf['run'](_0x429b8f,_0x3bd224,function(_0x25723d){_0x25723d?console['error']('Error\x20updating\x20cookies:',_0x25723d):console['log']('Cookies\x20updated\x20for\x20user:',_0x3bd224);});}else{const _0x2bfe75=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x2bfe75['run'](_0x3bd224,_0x429b8f,function(_0x4db1fd){_0x4db1fd?console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x4db1fd):console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x3bd224);});}}});}catch(_0x21d8f4){console['error']('Error\x20fetching\x20cookies:',_0x21d8f4);throw _0x21d8f4;}}async function createUserIfNotExists(_0x42c54f,_0x5e7bf6){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x42c54f],(_0x5c5edd,_0x37231f)=>{if(_0x5c5edd){console['error']('Error\x20checking\x20user\x20existence:',_0x5c5edd);throw _0x5c5edd;}else{if(!_0x37231f){const _0x30b9c1=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20password)\x20VALUES\x20(?,\x20?)');_0x30b9c1['run'](_0x42c54f,_0x5e7bf6,function(_0x4fd60e){_0x4fd60e?console['error']('Error\x20inserting\x20new\x20user:',_0x4fd60e):console['log']('New\x20user\x20created:',_0x42c54f);});}else console['log']('User\x20already\x20exists:',_0x42c54f);}});}catch(_0x2f6b6d){console['error']('Error\x20creating\x20user:',_0x2f6b6d);throw _0x2f6b6d;}}ipcMain['handle']('create-relation',async(_0x29cd0b,_0x4e5aac)=>{return new Promise((_0x26d70d,_0x6f4d46)=>{const _0x373904='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x4e5aac+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT)';db['run'](_0x373904,function(_0x57a643){_0x57a643?_0x6f4d46(_0x57a643):_0x26d70d({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x1a2f68,_0x8630d5)=>{return console['log']('droping\x20table'+_0x8630d5),new Promise((_0xe7e4d8,_0x5b7cbc)=>{const _0x2cda3a='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x8630d5;console['log']('droping\x20table'+_0x8630d5),db['run'](_0x2cda3a,function(_0x51a50c){_0x51a50c?_0x5b7cbc(_0x51a50c):_0xe7e4d8({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x24acfb=>{return new Promise((_0x119945,_0x1378c2)=>{const _0x400273='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x400273,[],(_0xf93caa,_0x306d4f)=>{_0xf93caa?_0x1378c2(_0xf93caa):_0x119945(_0x306d4f['map'](_0xe8803c=>_0xe8803c['name']));});});}),ipcMain['handle']('add-user',async(_0x4a31dc,_0x153964,_0x12a8ba)=>{return new Promise(_0x460387=>{const _0x38260d=db['prepare']('INSERT\x20INTO\x20'+_0x12a8ba+'\x20(username)\x20VALUES\x20(?)');_0x38260d['run'](_0x153964,function(_0x63addf){_0x63addf?console['log']('error\x20in\x20add-user:'+_0x63addf):_0x460387({'status':'success','id':this['lastID']});}),_0x38260d['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x12ef4e,_0x48215b)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x437c73,_0x469fff)=>{if(_0x437c73)_0x48215b(_0x437c73);else{_0x12ef4e({'status':'success','users':_0x469fff});for(_0x469fff of _0x469fff){console['log'](_0x469fff['username']);}}});});}),ipcMain['handle']('get-data',async(_0x1142ec,_0x18b033)=>{return new Promise((_0x249a1,_0x2b7c22)=>{const _0x54aacf='SELECT\x20*\x20FROM\x20'+_0x18b033;console['log'](_0x54aacf),db['all'](_0x54aacf,[],(_0x5f3379,_0x4c07e4)=>{_0x5f3379?_0x2b7c22(_0x5f3379):_0x249a1(_0x4c07e4);});});}),ipcMain['handle']('get-accounts',async _0x187bf3=>{return new Promise((_0x2120c8,_0x2af9e9)=>{const _0x59b9b7='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x59b9b7),igaccountsDB['all'](_0x59b9b7,[],(_0x382eac,_0xd66a3a)=>{_0x382eac?_0x2af9e9(_0x382eac):_0x2120c8(_0xd66a3a);});});}),ipcMain['handle']('get-targets',async(_0x2431a9,_0x22b22e)=>{return getTargetProfiles(_0x22b22e);}),ipcMain['handle']('delete-user',async(_0x13d69a,_0x313547,_0x12ddc5)=>{return new Promise((_0x5943d1,_0x86c3d2)=>{const _0x238ea6=db['prepare']('DELETE\x20FROM\x20'+_0x12ddc5+'\x20WHERE\x20username\x20=\x20?');_0x238ea6['run'](_0x313547,function(_0x31ba8d){_0x31ba8d?_0x86c3d2(_0x31ba8d):_0x5943d1({'status':'success','changes':this['changes']});}),_0x238ea6['finalize']();});}),ipcMain['handle']('delete-account',async(_0x43baad,_0x5d0b7c)=>{const _0x2cb685=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x2cb685['run'](_0x5d0b7c,function(_0x468ada){_0x468ada&&console['log'](_0x468ada);}),_0x2cb685['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x35776f,_0x540a1e)=>{const _0x12060b='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x12060b,[],(_0x1bf833,_0x4ff9b5)=>{_0x1bf833?_0x540a1e({'status':'error','message':_0x1bf833['message']}):_0x35776f({'status':'success','contactedCount':_0x4ff9b5['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x20761f,_0x233623)=>{const _0x4751d1='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x4751d1,[],(_0x3b3874,_0x3f69e9)=>{_0x3b3874?_0x233623({'status':'error','message':_0x3b3874['message']}):_0x20761f({'status':'success','contactedCount':_0x3f69e9['contactedCount']});});});});