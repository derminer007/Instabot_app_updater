const {app,BrowserWindow,ipcMain,dialog}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),ANZAHL_FOLLOWER_BUTTON='div.x9f619.x1n2onr6\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_NEW_MSG_BUTTON='div.x1i10hfl.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.x6s0dn4.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x1ypdohk.x78zum5.xl56j7k.x1y1aw1k.x1sxyh0.xwib8y2.xurb0ha.xcdnw81',K_SEARCH_BAR_INPUT='body\x20>\x20div.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x1k90msu.x6o7n8i.x1qfuztq.x10l6tqk.x17qophe.x13vifvy.x1hc1fzr.x71s49j.xh8yej3\x20>\x20div\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.x1q0g3np.x1a02dak.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20input',K_USERNAME_SPALTE_PART1='div:nth-child(',K_CLEARNAME_SPALTE_PART2=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1pi30zi.x1swvt13.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span\x20>\x20span',K_CHAT_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.x972fbf.xcfux6l.x1qhh985.xm0m39n.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.xexx8yu.x18d9i69.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1lq5wgf.xgqcy7u.x30kzoy.x9jhf4c.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x9bdzbf.x1ypdohk.x78zum5.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x1n2onr6.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xn3w4p2.x5ib6vp.xc73u3c.x1tu34mt.xzloghq',K_NACHRICHT_SCHREIBEN_INPUT_DIV='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1i64zmx.xw3qccf.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f.notranslate',K_SENDEN_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.xfs2ol5[role=\x22button\x22][tabindex=\x220\x22]',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x44822e=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x44822e['loadFile'](path['join'](__dirname,'index.html'));}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x3d2698){var _0x395666=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x58fc0f){console['log']('window\x20id:'+_0x58fc0f['id']),_0x58fc0f['id']>0x1&&(_0x395666=!![]);}),console['log']('child\x20opened\x20='+_0x395666);if(!_0x395666){const _0x47b68f=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x47b68f['loadFile'](_0x3d2698['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0);});let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0xb9e4b3=0x1,_0x56866e=0x0){let _0x1afe35='',_0x1b97a5=null;if(process['platform']==='darwin')_0x1afe35='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome';else{if(process['platform']==='win32')_0x1afe35='chromium_local/chrome-win/chrome.exe';else{if(process['platform']==='linux'){}}}if(_0xb9e4b3===0x0&&!pageStack[_0x56866e])return browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0x1afe35}),_0x1b97a5=await browser['newPage'](),_0x1b97a5['setDefaultNavigationTimeout'](0x1d4c),_0x1b97a5['setDefaultTimeout'](0x1d4c),pageStack[_0x56866e]=_0x1b97a5,_0x1b97a5;return(browser===null||pageStack[_0x56866e]['isClosed']())&&(browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0x1afe35})),(pageStack[_0x56866e]===null||pageStack[_0x56866e]['isClosed']())&&(_0x1b97a5=await browser['newPage'](),_0x1b97a5['setDefaultNavigationTimeout'](0x1d4c),_0x1b97a5['setDefaultTimeout'](0x1d4c),pageStack[_0x56866e]=_0x1b97a5),pageStack[_0x56866e];}ipcMain['on']('login',async(_0x4871a6,_0x360613,_0x21e865)=>{const _0x4011f9=await getBrowserPage();await _0x4011f9['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x4011f9,_0x360613);}),ipcMain['on']('setLoginCookies',async(_0x159212,_0x3c019a)=>{const _0x1d07bc=await getBrowserPage();await set_login_cookies(_0x1d07bc,_0x3c019a);}),ipcMain['handle']('sendMessage',async(_0x227a0f,_0x58a7fd,_0x4d86fa,_0x29a849,_0x1cd6cf,_0x2afc26,_0x4548d4,_0x3d1f10)=>{isStopping=![];let _0x35811b=null;return _0x4548d4?_0x35811b=await getBrowserPage(_0x1cd6cf,_0x3d1f10):_0x35811b=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x58a7fd),new Promise((_0x5e783c,_0x214e3c)=>{send_message(_0x35811b,_0x58a7fd,_0x4d86fa,_0x29a849,_0x1cd6cf,_0x2afc26)['then'](_0x502109=>_0x5e783c(_0x502109))['catch'](_0x50582e=>_0x214e3c(_0x50582e));});}),ipcMain['handle']('stop-action',async(_0x2c599c,_0x360180)=>{isStopping=!![];const _0x26397b=await getBrowserPage(0x1,_0x360180);await _0x26397b['close']();}),ipcMain['handle']('fetch_followers',async(_0xf121ea,_0x45bfc4,_0x59bed3,_0x5c16a9,_0xa1cd15)=>{isStopping=![];const _0x13814b=await getBrowserPage();return fetch_followers_from_account(_0x13814b,_0x45bfc4,_0x59bed3,_0x5c16a9,_0xa1cd15);}),ipcMain['handle']('fetch_likes',async(_0x3053f3,_0x3ec951,_0xd6d4d4,_0x3e9605,_0x592d7d)=>{isStopping=![];const _0x72ed13=await getBrowserPage();return fetch_likers_from_post(_0x72ed13,_0x3ec951,_0xd6d4d4,_0x3e9605,_0x592d7d);}),ipcMain['handle']('fetch_comments',async(_0x23e14b,_0xd337dc,_0x17d645,_0x249b4a,_0x25f3df)=>{isStopping=![];const _0x468daf=await getBrowserPage();return fetch_comments_from_post(_0x468daf,_0xd337dc,_0x17d645,_0x249b4a,_0x25f3df);}),ipcMain['handle']('update-app',async _0x4905e9=>{const {spawn:_0xe6c0ec}=require('child_process'),_0x5823a4=require('path');if(process['platform']==='darwin'){const _0x272c57=_0x5823a4['join'](__dirname,'mac-updater-intern.sh'),_0x39e134=_0xe6c0ec('/bin/bash',[_0x272c57]);_0x39e134['stdout']['on']('data',_0x4ced58=>{console['log']('stdout:\x20'+_0x4ced58);}),_0x39e134['stderr']['on']('data',_0x15dade=>{console['error']('stderr:\x20'+_0x15dade);}),_0x39e134['on']('close',_0x948916=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x948916);});}else{if(process['platform']==='win32'){const _0x3dd8c0=_0x5823a4['join'](__dirname,'../','../','../');process['chdir'](_0x3dd8c0),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x59333f='soft-ui-updater-windows.ps1',_0x49690e='soft-ui-updater-windows.exe',_0x4aa962=_0xe6c0ec('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x59333f]);console['log']('Windows\x20Pfad:\x20'+_0x3dd8c0),_0x4aa962['stdout']['on']('data',_0x2cd34c=>{console['log']('stdout:\x20'+_0x2cd34c);}),_0x4aa962['stderr']['on']('data',_0x2e89f2=>{console['error']('stderr:\x20'+_0x2e89f2);}),_0x4aa962['on']('close',_0x240595=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x240595);});}}});function getRnd(_0x38f39a,_0x591974){return Math['random']()*(_0x591974-_0x38f39a+0x1)+_0x38f39a;}function delay(_0x556f75,_0x458eda){let _0x20a682=getRnd(_0x556f75,_0x458eda);return new Promise(function(_0x2924bd){setTimeout(_0x2924bd,_0x20a682);});}async function scroll(_0x564db3,_0x4dbb49,_0x2de31a=0x2){const _0x493b31=await _0x564db3['waitForSelector'](_0x4dbb49);for(let _0x5b0d22=0x0;_0x5b0d22<_0x2de31a;_0x5b0d22++){console['log']('Scrolling\x20'+_0x5b0d22),await _0x564db3['evaluate'](_0x156015=>{const _0x14256e=document['querySelector'](_0x156015);_0x14256e&&_0x14256e['scrollBy'](0x0,0x190);},_0x4dbb49),await delay(0x320,0x5dc);}}async function saveCookies(_0x496310){let _0x131557=await _0x496310['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x131557,null,0x2));}async function notificationClear(_0x531bf3){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x531bf3['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x531bf3['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x40aaa2){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x40aaa2);}}async function getTargetProfiles(_0x1d4c83){return new Promise((_0x3260d3,_0x371d90)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x1d4c83,(_0x4d0bc6,_0x1cb970)=>{_0x4d0bc6?_0x371d90(_0x4d0bc6):_0x3260d3(_0x1cb970);});});}async function login_legacy(_0x915ec5,_0x3acae2,_0x4e59d3){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x915ec5,_0x3acae2),await createUserIfNotExists(_0x3acae2,_0x4e59d3);}catch(_0x55c219){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x55c219);}try{await _0x915ec5['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x915ec5['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x915ec5['click']('button._a9--._ap36._a9_0');}catch(_0x1789fb){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x915ec5['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x915ec5['type']('input[name=\x27username\x27]',_0x3acae2,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x915ec5['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x915ec5['type']('input[name=\x27password\x27]',_0x4e59d3,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x915ec5['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x915ec5['click']('button[type=\x27submit\x27]');}catch(_0x3f9d16){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x915ec5),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x915ec5,_0x3acae2);}catch(_0x52669f){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x52669f);}}catch(_0x2297e1){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x2297e1);}}async function login(_0x310382,_0x422d42){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x310382,_0x422d42),await createUserIfNotExists(_0x422d42);}catch(_0x4c39ab){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4c39ab);}try{await _0x310382['goto']('https://www.instagram.com/accounts/login/');}catch(_0x57b089){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x57b089);}}async function set_login_cookies(_0x2f47c7,_0x1f9425){try{await saveCookiesForUser(_0x2f47c7,_0x1f9425);}catch(_0x567822){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x567822);}}async function send_message(_0x1ca033,_0x3f088e,_0x5a3877,_0x3958d3,_0x444931,_0x3e12ee){_0x3e12ee=_0x3e12ee['split'](';'),console['log'](_0x3e12ee[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x444931);if(_0x444931==0x0){try{await login(_0x1ca033,_0x3e12ee[0x0]);}catch(_0x3358e7){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x3358e7);return;}await _0x1ca033['goto']('https://www.instagram.com/direct/inbox/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x1ca033);}let _0x2a9943;await set_clearname_from_username(_0x1ca033,_0x5a3877);const _0x1199dd='SELECT\x20clearname\x20FROM\x20'+_0x5a3877+'\x20WHERE\x20username\x20IS\x20?';db['all'](_0x1199dd,[_0x3f088e],(_0x335165,_0x3010d8)=>{_0x335165&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x335165['message']);if(_0x3010d8['length']===0x0)return;_0x2a9943=_0x3010d8['map'](_0x378b1c=>_0x378b1c['clearname']);});try{try{const _0x577b9b=K_NEW_MSG_BUTTON;await delay(0xfa0,0x1d4c),await _0x1ca033['waitForSelector'](_0x577b9b),await _0x1ca033['click'](_0x577b9b),console['log']('Message-Button\x20geklickt'),console['log'](_0x3f088e+'\x20'+_0x3958d3),await delay(0xfa0,0x1d4c);try{const _0x398aac='input[name=\x22queryBox\x22]',_0x116c09=K_SEARCH_BAR_INPUT;await _0x1ca033['waitForSelector'](_0x116c09),await _0x1ca033['click'](_0x116c09),await delay(0xfa0,0x1d4c),await _0x1ca033['waitForSelector'](_0x398aac),await _0x1ca033['click'](_0x398aac),await delay(0xfa0,0x1d4c),await _0x1ca033['type'](_0x398aac,_0x3f088e,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),console['log']('Account\x20Name\x20eingefügt');const _0x38b399=K_USERNAME_SPALTE_PART1,_0xda18f0=K_CLEARNAME_SPALTE_PART2;let _0x5ac9c6=0x1;try{while(_0x5ac9c6!=0x14){console['log']('Schleife');let _0x16ea8f=_0x38b399+_0x5ac9c6+_0xda18f0;const _0x24ce18=await _0x1ca033['waitForSelector'](_0x16ea8f),_0x32899d=await _0x1ca033['evaluate'](_0x453975=>_0x453975['innerHTML'],_0x24ce18);console['log'](_0x32899d+';'+_0x2a9943+';'+_0x3f088e),delay(0x3e8,0xbb8);if(_0x32899d==_0x2a9943){console['log']('Account\x20gefunden'),await _0x1ca033['click'](_0x16ea8f);break;}else{if(_0x32899d==_0x3f088e){console['log']('Account\x20gefunden'),await _0x1ca033['click'](_0x16ea8f);break;}}_0x5ac9c6++;}try{await delay(0xbb8,0x1388);const _0x25f89d=await _0x1ca033['waitForSelector'](K_CHAT_BUTTON_DIV);console['log'](_0x25f89d),await delay(0xbb8,0x1388),await _0x25f89d['click']();try{await delay(0xbb8,0x1388);const _0xf15ff=await _0x1ca033['waitForSelector'](K_NACHRICHT_SCHREIBEN_INPUT_DIV);_0x3958d3=_0x3958d3['replace']('{USERNAME}',_0x3f088e),_0x3958d3=_0x3958d3['replace']('{username}',_0x2a9943),await _0xf15ff['type'](_0x3958d3,{'delay':getRnd(0x50,0x78)}),await delay(0xbb8,0x1388);try{const _0x1d3a0a=await _0x1ca033['waitForSelector'](K_SENDEN_BUTTON_DIV);return await _0x1d3a0a['click'](),await delay(0xbb8,0x1388),new Promise(_0x476dab=>{_0x476dab('Nachricht\x20erfolgreich\x20verschickt!');});}catch(_0x45cf8d){console['log']('Message-Button\x20nicht\x20geklickt:\x20'+_0x45cf8d);}}catch(_0x112a16){console['log']('Chat-Fenster\x20nicht\x20gefunden:\x20'+_0x112a16);}}catch(_0x49a155){console['log']('error:\x20'+_0x49a155);}}catch(_0x4614f4){return console['log']('User\x20nicht\x20gefunden:'+_0x4614f4),await _0x1ca033['goto']('https://www.instagram.com/direct/inbox/'),new Promise((_0x1f8393,_0x3f6c78)=>{_0x3f6c78('user_not_found');});}}catch(_0x1d836c){console['log']('DM-Fenster\x20nicht\x20gefunden:'+_0x1d836c);}}catch(_0x3f3385){console['log']('Message-Button\x20nicht\x20geklickt:'+_0x3f3385);}}catch(_0x428444){console['log']('Nachricht\x20senden\x20fehlgeschlagen:\x20'+_0x428444);}return console['log']('Ende'),await _0x1ca033['goto']('https://www.instagram.com/direct/inbox/'),new Promise((_0x55e117,_0x3fa48f)=>{_0x3fa48f('ig_update');});}function handle_fail(_0x429c59){if(isStopping)return new Promise(_0x5a9e79=>{_0x5a9e79('Scraper\x20gestoppt.');});else{let _0x2d8014='';switch(_0x429c59){case 0x0:_0x2d8014='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x2d8014='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x2d8014='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x2d8014='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x10969a,_0x4e4ed0)=>{_0x4e4ed0(_0x2d8014);});}}async function fetch_followers_from_account(_0x54e0ee,_0x364ba9,_0x3a5512,_0x4801bc,_0xaae689){try{await login(_0x54e0ee,_0xaae689['username']);}catch(_0x3c4805){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x3c4805),handle_fail(0x0);}let _0xa91d40=0x0;try{await _0x54e0ee['goto']('https://www.instagram.com/'+_0x364ba9+'/'),await notificationClear(_0x54e0ee);try{if(_0x3a5512<=0x0){const _0x4f7cc1=await _0x54e0ee['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x565ff9=await _0x54e0ee['evaluate'](_0x41dedb=>_0x41dedb['innerHTML'],_0x4f7cc1);_0xa91d40=Math['ceil'](_0x565ff9/0x4);}else _0xa91d40=Math['ceil'](_0x3a5512/0x4);let _0x522e6a=await _0x54e0ee['waitForSelector']('a[href=\x22/'+_0x364ba9+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x522e6a['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x364ba9+'\x20gesichtet');}catch(_0x30639c){return console['log']('Follower\x20Liste\x20von\x20'+_0x364ba9+'\x20nicht\x20gefunden:'+_0x30639c),handle_fail(0x0);}}catch(_0x5025fc){return console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x5025fc),handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0xa91d40),await scroll(_0x54e0ee,FOLLOWER_FENSTER,_0xa91d40),await _0x54e0ee['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x490e52=await _0x54e0ee['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x5c769f=await _0x54e0ee['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x3a5512<=0x0&&(_0x3a5512=_0x490e52['length']);for(let _0x2bcd24=0x0;_0x2bcd24<_0x490e52['length']&&_0x2bcd24<_0x3a5512;_0x2bcd24++){console['log'](await _0x490e52[_0x2bcd24]['evaluate'](_0x1078d4=>_0x1078d4['textContent']));const _0x42be61='INSERT\x20INTO\x20'+_0x4801bc+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x42be61,[await _0x490e52[_0x2bcd24]['evaluate'](_0x10566b=>_0x10566b['textContent']),await _0x5c769f[_0x2bcd24]['evaluate'](_0x55e2c1=>_0x55e2c1['textContent'])],function(_0x5910bf){_0x5910bf?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x4801bc+'\x27:',_0x5910bf['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return new Promise(_0x30dad2=>{_0x30dad2('Scraping\x20finished!');});}catch(_0xae183a){return console['log']('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x364ba9+'\x20nicht\x20gefunden:'+_0xae183a),handle_fail(0x0);}}async function fetch_likers_from_post(_0xf7d6c,_0x347c55,_0xf2ccd7,_0x1a64d8,_0x560075){try{await login(_0xf7d6c,_0x560075['username']);}catch(_0x437ef0){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x437ef0);return handle_fail(0x1);return;}try{let _0x20da41=_0x347c55['substring'](0x0,_0x347c55['lastIndexOf']('/')),_0x5d731e=_0x20da41+'/liked_by';console['log'](_0x5d731e),await _0xf7d6c['goto'](_0x5d731e),await delay(0x7d0,0xfa0),await notificationClear(_0xf7d6c),await delay(0xc8,0x1f4),await _0xf7d6c['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x37d632=await _0xf7d6c['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x7b815=await _0xf7d6c['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x37d632['length']);let _0x1055aa=path['join'](__dirname,'/likers.csv');_0xf2ccd7<=0x0&&(_0xf2ccd7=_0x37d632['length']);try{for(let _0x28cc2d=0x0;_0x28cc2d<_0x37d632['length']&&_0x28cc2d<_0xf2ccd7;_0x28cc2d++){console['log'](await _0x37d632[_0x28cc2d]['evaluate'](_0x4b00c1=>_0x4b00c1['textContent']));try{const _0x33e7e4='INSERT\x20INTO\x20'+_0x1a64d8+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x33e7e4,[await _0x37d632[_0x28cc2d]['evaluate'](_0x14d8b5=>_0x14d8b5['textContent']),await _0x7b815[_0x28cc2d]['evaluate'](_0x23ca8c=>_0x23ca8c['textContent'])],function(_0x245020){_0x245020?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x1a64d8+'\x27:',_0x245020['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x5a1e1c){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x28cc2d+'\x20:\x20'+_0x5a1e1c),handle_fail(0x1);}}return new Promise(_0x14f77c=>{_0x14f77c('Scraping\x20finished!');});}catch(_0x2f64bb){return console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben'),handle_fail(0x1);}}catch(_0x4167a6){return console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x4167a6),handle_fail(0x1);}}async function fetch_comments_from_post(_0x3df2b8,_0x36443f,_0x18f9ec,_0x552db6,_0x3cae25){try{await login(_0x3df2b8,_0x3cae25['username']);}catch(_0x5eac66){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5eac66),handle_fail(0x2);}try{console['log'](_0x36443f),await _0x3df2b8['goto'](_0x36443f),await delay(0x7d0,0xfa0),await notificationClear(_0x3df2b8),await delay(0xc8,0x1f4);const _0x5b1d6b=COM_COMMENTS_BOX_BODY_DIV;let _0xa38443;if(_0x18f9ec<=0x0){const _0x2d9e96=await _0x3df2b8['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x4246de=await _0x3df2b8['evaluate'](_0xf75d6=>_0xf75d6['innerHTML'],_0x2d9e96),_0x5d3466=String(_0x4246de)['replace'](/[^0-9]/g,''),_0x4e27d0=Number(_0x5d3466)/0x14;_0xa38443=Math['ceil'](_0x4e27d0/0x3);}else _0xa38443=Math['ceil'](_0x18f9ec/0x3);console['log']('Auto-scrolls:\x20'+_0xa38443),await scroll(_0x3df2b8,_0x5b1d6b,_0xa38443);try{const _0x55b0ef=COM_REPLY_BUTTON_SPAN;await _0x3df2b8['waitForSelector'](_0x55b0ef),await delay(0x1f4,0x320);const _0x17e1d7=await _0x3df2b8['$$'](_0x55b0ef);console['log'](_0x17e1d7),await delay(0xc8,0x1f4);try{for(let _0x6b4d7=0x0;_0x6b4d7<_0x17e1d7['length'];_0x6b4d7++){_0x17e1d7[_0x6b4d7]['click'](),await delay(0x320,0x5dc);}}catch(_0x5b9e1e){return console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x5b9e1e),handle_fail(0x2);}}catch(_0x51dea7){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x1b7587=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x3df2b8['waitForSelector'](_0x1b7587),await delay(0x1f4,0x320);const _0x22be40=await _0x3df2b8['$$'](_0x1b7587);let _0x566733=path['join'](__dirname,'/comments.csv');_0x18f9ec<=0x0&&(_0x18f9ec=_0x22be40['length']);console['log']('fetch_limit:\x20'+_0x18f9ec),console['log']('comments_len:\x20'+_0x22be40['length']),_0x18f9ec++;try{for(let _0x46e006=0x1;_0x46e006<_0x22be40['length']&&_0x46e006<_0x18f9ec;_0x46e006++){try{console['log'](await _0x22be40[_0x46e006]['evaluate'](_0x21308e=>_0x21308e['textContent']));const _0x35fae1=await db['prepare']('INSERT\x20INTO\x20'+_0x552db6+'\x20(username)\x20VALUES\x20(?)');await _0x35fae1['run'](await _0x22be40[_0x46e006]['evaluate'](_0x26bb2d=>_0x26bb2d['textContent']),function(_0x34a67e){_0x34a67e&&console['log']('error\x20in\x20add-user:'+_0x34a67e);}),await _0x35fae1['finalize']();}catch(_0x31e19b){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x46e006+'\x20:\x20'+_0x31e19b),handle_fail(0x2);}}await delay(0x4b0,0x7d0);try{await set_clearname_from_username(_0x3df2b8,_0x552db6);}catch(_0x37bc6a){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x37bc6a);}return new Promise(_0x2a478a=>{_0x2a478a('Scraping\x20finished!');});}catch(_0x4a3d95){return console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben'),handle_fail(0x2);}}catch(_0x1aaf1f){return console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x1aaf1f),handle_fail(0x2);}}async function set_clearname_from_username(_0x3087fa,_0x5a6ec6){try{let _0x3341e8,_0x21b665;const _0x1c1630='SELECT\x20username\x20FROM\x20'+_0x5a6ec6+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x1c1630,[],(_0x35590d,_0x58b49f)=>{_0x35590d&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x35590d['message']),_0x58b49f['length']===0x0&&(_0x21b665=_0x58b49f['length']),_0x3341e8=_0x58b49f['map'](_0x294457=>_0x294457['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x21b665);if(_0x21b665===0x0){console['log']('Leave');return;}const _0x348c7d=await _0x3087fa['waitForSelector'](IG_SEARCH_BUTTON);await _0x348c7d['click'](),await delay(0x4b0,0x7d0);for(let _0x467297 of _0x3341e8){const _0x32bfe6=await _0x3087fa['waitForSelector'](IG_SEARCH_INPUT);await _0x32bfe6['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x3087fa['type'](IG_SEARCH_INPUT,_0x467297,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x43709d=0x1;while(_0x43709d!=0x14){console['log']('Schleife');try{let _0x182662=IG_NAME_SPAN_PART1+_0x43709d+IG_USERNAME_SPAN_PART2;const _0x3cd314=await _0x3087fa['waitForSelector'](_0x182662),_0x26da73=await _0x3087fa['evaluate'](_0x3a2a2c=>_0x3a2a2c['innerHTML'],_0x3cd314);await delay(0xc8,0x1f4);if(_0x26da73==_0x467297){let _0x151756=IG_NAME_SPAN_PART1+_0x43709d+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x40b888=await _0x3087fa['waitForSelector'](_0x151756);let _0xf6d739=await _0x3087fa['evaluate'](_0x3e0f41=>_0x3e0f41['innerHTML'],_0x40b888);const _0xdf9f23=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x4a5dc6=_0xf6d739['match'](_0xdf9f23);_0x4a5dc6?_0xf6d739=_0x4a5dc6[0x1]['trim']():_0xf6d739=_0xf6d739['trim']();const _0x2ce2d4='UPDATE\x20'+_0x5a6ec6+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x2ce2d4,[_0xf6d739,_0x26da73],function(_0x2125cb){_0x2125cb&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x2125cb['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x43709d++;}catch(_0x435a8b){const _0x349854='UPDATE\x20'+_0x5a6ec6+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x349854,['',_0x467297],function(_0x28a761){_0x28a761&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x28a761['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x435a8b);break;}}}await _0x348c7d['click']();}catch(_0x549f19){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x549f19);}}const campaignPath=path['resolve'](__dirname,'data/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(campaign_name\x20TEXT\x20PRIMARY\x20KEY,\x20list_id\x20TEXT,\x20zeitabstand\x20REAL,\x20message_id\x20TEXT,\x20account\x20TEXT,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x2b5b2d,_0x42c656)=>{const _0x457961='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x457961,[],(_0x406c91,_0x123ea3)=>{_0x406c91?_0x42c656(_0x406c91):_0x2b5b2d(_0x123ea3);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x4021d0,_0x43de59)=>{const _0x491c62='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x491c62,[],async(_0x12babe,_0x126286)=>{if(_0x12babe)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x12babe['message']),_0x43de59({'status':'error','message':_0x12babe['message']});else try{const _0x65080e=await Promise['all'](_0x126286['map'](_0x58ec31=>{return new Promise(_0x7dcfee=>{if(!_0x58ec31['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x58ec31['campaign_name']),_0x7dcfee({'campaign_name':_0x58ec31['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x419bba='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x58ec31['list_id'],_0x1f4258='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20'+_0x58ec31['list_id']+'\x20WHERE\x20contacted\x20=\x201';db['get'](_0x419bba,[],(_0x1f0d9c,_0x1f01c2)=>{_0x1f0d9c?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x58ec31['campaign_name']+':',_0x1f0d9c['message']),_0x7dcfee({'campaign_name':_0x58ec31['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):db['get'](_0x1f4258,[],(_0x25198b,_0x1b73ac)=>{_0x25198b?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x58ec31['campaign_name']+':',_0x25198b['message']),_0x7dcfee({'campaign_name':_0x58ec31['campaign_name'],'lead_count':_0x1f01c2?_0x1f01c2['lead_count']:0x0,'contacted_count':'N/A'})):_0x7dcfee({'campaign_name':_0x58ec31['campaign_name'],'lead_count':_0x1f01c2?_0x1f01c2['lead_count']:0x0,'contacted_count':_0x1b73ac?_0x1b73ac['contacted_count']:0x0});});});});}));_0x4021d0({'status':'success','campaigns':_0x65080e});}catch(_0x137eea){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x137eea),_0x43de59({'status':'error','message':_0x137eea['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x2742ff,_0x2966a3)=>{return new Promise((_0x37105a,_0x11b32f)=>{const _0x1ee07c='SELECT\x20campaign.list_id,\x20message.message_text,\x20campaign.zeitabstand,\x20campaign.account\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x1ee07c,[_0x2966a3],(_0x40f9cc,_0x56bf47)=>{_0x40f9cc?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x40f9cc),_0x11b32f(_0x40f9cc)):(console['log']('ROWS'),console['log'](_0x56bf47),debugDatabaseContents(),_0x37105a(_0x56bf47));});});});const showTableContents=_0x166d3b=>{return new Promise((_0x4e72d9,_0x355ab2)=>{const _0x5c50a2='SELECT\x20*\x20FROM\x20'+_0x166d3b+';';campaignDB['all'](_0x5c50a2,(_0x1f45a8,_0x33a2a5)=>{_0x1f45a8?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x166d3b+':',_0x1f45a8),_0x355ab2(_0x1f45a8)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x166d3b+':',_0x33a2a5),_0x4e72d9({'status':'success','message':_0x33a2a5}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x7180eb){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x7180eb);}}ipcMain['handle']('create-campaign',async(_0x1f867a,_0x12d3ad)=>{return new Promise((_0x3c429c,_0x1ba02d)=>{const _0x240c74='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x240c74,[String(_0x12d3ad)],function(_0x5f158a){_0x5f158a?_0x1ba02d(_0x5f158a):_0x3c429c({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x17acae,_0x145e37)=>{return new Promise((_0x4d6254,_0x2119b7)=>{const _0x4bd41f='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x4bd41f,[_0x145e37],function(_0x3e9a1b){_0x3e9a1b?_0x2119b7(_0x3e9a1b):_0x4d6254({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x676d16,_0x31d945,_0x271c7d,_0x4cd4d2,_0x521fb2,_0x159479)=>{const _0x258b26=await createMessageID(_0x521fb2);return new Promise((_0x134ba2,_0x412cf9)=>{if(!_0x31d945||!_0x271c7d||!_0x4cd4d2||!_0x258b26||!_0x159479)return _0x412cf9({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x258b26);const _0xf80564='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0xf80564,[_0x271c7d,_0x4cd4d2,_0x258b26,_0x159479,_0x31d945],function(_0x5df4aa){if(_0x5df4aa)_0x412cf9({'status':'error','message':_0x5df4aa['message']});else this['changes']===0x0?_0x412cf9({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x134ba2({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x5736ed,_0x4f53a0,_0x20c36a,_0x4208c2)=>{return new Promise((_0x313bba,_0x17b872)=>{const _0x25d72f='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username)\x20VALUES\x20(?,\x20?,\x20?)';campaignDB['run'](_0x25d72f,[_0x4f53a0,_0x20c36a,_0x4208c2],function(_0xa5893a){return _0xa5893a?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0xa5893a['message']),_0x17b872('insert-dm-response',{'success':![],'message':_0xa5893a['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x313bba('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x51b6d1=>{return new Promise((_0x2b3359,_0x219d6a)=>{const _0x13b94f='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x13b94f,[_0x51b6d1],(_0x4d7c59,_0xf00d28)=>{if(_0x4d7c59)_0x219d6a({'status':'error','message':_0x4d7c59['message']});else{if(_0xf00d28)_0x2b3359(_0xf00d28['message_id']);else{const _0x393298='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x393298,[_0x51b6d1],function(_0x51dcb6){_0x51dcb6?_0x219d6a({'status':'error','message':_0x51dcb6['message']}):_0x2b3359(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x3f6468,_0x2ac99e)=>{return new Promise((_0x284d84,_0x54d2ea)=>{const _0x4229a7='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x2ac99e;db['get'](_0x4229a7,(_0x5c8e81,_0x9c7f6b)=>{_0x5c8e81?_0x54d2ea({'status':'error','message':_0x5c8e81['message']}):_0x284d84({'status':'success','count':_0x9c7f6b['count']});});});});const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20password\x20TEXT,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x2e2dd9,_0x2abaa3){try{const _0x3a7572=await new Promise((_0x19f581,_0xae5f1e)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x2abaa3],(_0x23ef0d,_0x2287ff)=>{if(_0x23ef0d)_0xae5f1e(_0x23ef0d);else{if(_0x2287ff['length']>0x0){let _0x45aa4d=JSON['parse'](_0x2287ff[0x0]['cookie']);console['log'](_0x45aa4d),_0x19f581(_0x45aa4d);}else _0xae5f1e(new Error('User\x20with\x20username\x20'+_0x2abaa3+'\x20does\x20not\x20exist.'));}});});await _0x2e2dd9['setCookie'](..._0x3a7572),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x49d9fc){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x49d9fc);}}async function saveCookiesForUser(_0x580725,_0x13c7e8){try{let _0x1bd157=await _0x580725['cookies']();_0x1bd157=JSON['stringify'](_0x1bd157),igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x13c7e8],(_0x47ca8d,_0x1e6018)=>{if(_0x47ca8d){console['error']('Error\x20checking\x20user\x20existence:',_0x47ca8d);throw _0x47ca8d;}else{if(_0x1e6018){const _0x5603d5=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x5603d5['run'](_0x1bd157,_0x13c7e8,function(_0x5b6687){_0x5b6687?console['error']('Error\x20updating\x20cookies:',_0x5b6687):console['log']('Cookies\x20updated\x20for\x20user:',_0x13c7e8);});}else{const _0x4a098c=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x4a098c['run'](_0x13c7e8,_0x1bd157,function(_0x510baa){_0x510baa?console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x510baa):console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x13c7e8);});}}});}catch(_0x440761){console['error']('Error\x20fetching\x20cookies:',_0x440761);throw _0x440761;}}async function createUserIfNotExists(_0x1c0c8f){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x1c0c8f],(_0x2327b5,_0x1a5124)=>{if(_0x2327b5){console['error']('Error\x20checking\x20user\x20existence:',_0x2327b5);throw _0x2327b5;}else{if(!_0x1a5124){const _0x39a81d=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x39a81d['run'](_0x1c0c8f,function(_0x3520fb){_0x3520fb?console['error']('Error\x20inserting\x20new\x20user:',_0x3520fb):console['log']('New\x20user\x20created:',_0x1c0c8f);});}else console['log']('User\x20already\x20exists:',_0x1c0c8f);}});}catch(_0x2a49f9){console['error']('Error\x20creating\x20user:',_0x2a49f9);throw _0x2a49f9;}}ipcMain['handle']('create-relation',async(_0x1d2634,_0x1dbd43)=>{return new Promise((_0x3653f4,_0x2e6a05)=>{const _0x57b563='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x1dbd43+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT)';db['run'](_0x57b563,function(_0x4ab6ea){_0x4ab6ea?_0x2e6a05(_0x4ab6ea):_0x3653f4({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x428c51,_0x353c91)=>{return console['log']('droping\x20table'+_0x353c91),new Promise((_0x37c965,_0x166451)=>{const _0x5f00a5='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x353c91;console['log']('droping\x20table'+_0x353c91),db['run'](_0x5f00a5,function(_0x173686){_0x173686?_0x166451(_0x173686):_0x37c965({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x57f3ef=>{return new Promise((_0x478716,_0xfebc74)=>{const _0x26b335='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x26b335,[],(_0x239b67,_0x461a79)=>{_0x239b67?_0xfebc74(_0x239b67):_0x478716(_0x461a79['map'](_0x4172ae=>_0x4172ae['name']));});});}),ipcMain['handle']('add-user',async(_0x1cfc70,_0x20ed0b,_0x582636)=>{return new Promise(_0x483427=>{const _0x333348=db['prepare']('INSERT\x20INTO\x20'+_0x582636+'\x20(username)\x20VALUES\x20(?)');_0x333348['run'](_0x20ed0b,function(_0x3e9fd6){_0x3e9fd6?console['log']('error\x20in\x20add-user:'+_0x3e9fd6):_0x483427({'status':'success','id':this['lastID']});}),_0x333348['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x30cad0,_0x5386bc)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x32dae8,_0x14c8df)=>{if(_0x32dae8)_0x5386bc(_0x32dae8);else{_0x30cad0({'status':'success','users':_0x14c8df});for(_0x14c8df of _0x14c8df){console['log'](_0x14c8df['username']);}}});});}),ipcMain['handle']('get-data',async(_0x14bd3f,_0x467251)=>{return new Promise((_0x54065c,_0x51988e)=>{const _0x457cfb='SELECT\x20*\x20FROM\x20'+_0x467251;console['log'](_0x457cfb),db['all'](_0x457cfb,[],(_0x4b7fa3,_0x52d8aa)=>{_0x4b7fa3?_0x51988e(_0x4b7fa3):_0x54065c(_0x52d8aa);});});}),ipcMain['handle']('get-accounts',async _0x6d9b6=>{return new Promise((_0x20f567,_0x2ff270)=>{const _0x2e29a1='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x2e29a1),igaccountsDB['all'](_0x2e29a1,[],(_0x5e01dd,_0x542ea5)=>{_0x5e01dd?_0x2ff270(_0x5e01dd):_0x20f567(_0x542ea5);});});}),ipcMain['handle']('get-targets',async(_0x4e4642,_0x5d9697)=>{return getTargetProfiles(_0x5d9697);}),ipcMain['handle']('delete-user',async(_0x4b9f13,_0x1eae14,_0x4c3501)=>{return new Promise((_0x4ef042,_0x5a07d5)=>{const _0x3e4d29=db['prepare']('DELETE\x20FROM\x20'+_0x4c3501+'\x20WHERE\x20username\x20=\x20?');_0x3e4d29['run'](_0x1eae14,function(_0x4e451a){_0x4e451a?_0x5a07d5(_0x4e451a):_0x4ef042({'status':'success','changes':this['changes']});}),_0x3e4d29['finalize']();});}),ipcMain['handle']('delete-account',async(_0x280dbd,_0x4dc90d)=>{const _0x2b72be=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x2b72be['run'](_0x4dc90d,function(_0x9131b5){_0x9131b5&&console['log'](_0x9131b5);}),_0x2b72be['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x2c75f8,_0x2151b3)=>{const _0x236d5e='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x236d5e,[],(_0x1b30d6,_0x238e3b)=>{_0x1b30d6?_0x2151b3({'status':'error','message':_0x1b30d6['message']}):_0x2c75f8({'status':'success','contactedCount':_0x238e3b['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0xfd3742,_0x536bfc)=>{const _0x378c0e='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x378c0e,[],(_0x257c5c,_0x32cf1f)=>{_0x257c5c?_0x536bfc({'status':'error','message':_0x257c5c['message']}):_0xfd3742({'status':'success','contactedCount':_0x32cf1f['contactedCount']});});});});