const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs'),ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div',K_OPTIONS_BUTTON='section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.xs5motx\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD='div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f',K_SEND_MSG_BUTTON='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x4af8b8=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x4af8b8['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x4af8b8['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x37045c){var _0x3b19bf=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x48d70c){console['log']('window\x20id:'+_0x48d70c['id']),_0x48d70c['id']>0x1&&(_0x3b19bf=!![]);}),console['log']('child\x20opened\x20='+_0x3b19bf);if(!_0x3b19bf){const _0x5c1156=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x5c1156['loadFile'](_0x37045c['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));});function initializeDatabase(){const _0x2ac4e2=require('fs'),_0x4d5cc2=path['join'](app['getPath']('userData'),'data'),_0x2e8a2b=['campaign.db','crm.db','igaccounts.db'],_0x300731=[];try{_0x2ac4e2['mkdirSync'](_0x4d5cc2,{'recursive':!![]});for(const _0x33ac53 of _0x2e8a2b){const _0xb53918=path['join'](process['resourcesPath'],'app','build','data',_0x33ac53),_0x920b6=path['join'](_0x4d5cc2,_0x33ac53);!_0x2ac4e2['existsSync'](_0x920b6)?(_0x2ac4e2['copyFileSync'](_0xb53918,_0x920b6),console['log']('[InitDB]\x20Kopiert\x20'+_0x33ac53+'\x20nach:\x20'+_0x920b6)):console['log']('[InitDB]\x20'+_0x33ac53+'\x20existiert\x20bereits:\x20'+_0x920b6),_0x300731['push'](_0x920b6);}}catch(_0x3b85f6){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x3b85f6);}return _0x300731;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x404eec,AppUpdate:_0x2f6241}=require('electron-updater');_0x404eec['autoDownload']=![],_0x404eec['autoInstallOnAppQuit']=!![],_0x404eec['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x404eec['on']('update-available',_0x53eddb=>{console['log']('Update\x20verfügbar:',_0x53eddb),_0x404eec['downloadUpdate']();}),_0x404eec['on']('update-downloaded',_0x8aa115=>{console['log']('Update\x20heruntergeladen:',_0x8aa115),_0x404eec['quitAndInstall']();}),_0x404eec['on']('error',_0x4b5608=>{console['error']('Fehler\x20beim\x20Updaten:',_0x4b5608);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x4cc9e5,AppUpdate:_0x17c84b}=require('electron-updater');_0x4cc9e5['autoDownload']=![],_0x4cc9e5['autoInstallOnAppQuit']=!![],_0x4cc9e5['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x4cc9e5['on']('update-available',_0x4910a3=>{console['log']('Update\x20verfügbar:',_0x4910a3),_0x4cc9e5['downloadUpdate']();}),_0x4cc9e5['on']('update-downloaded',_0x853a24=>{console['log']('Update\x20heruntergeladen:',_0x853a24),console['log']('Neustarten\x20zum\x20Updaten');}),_0x4cc9e5['on']('error',_0x6d025b=>{console['error']('Fehler\x20beim\x20Updaten:',_0x6d025b);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x21905d='',_0x4a2bd2=null;if(process['platform']==='darwin')_0x21905d=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x21905d=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x21905d}),_0x4a2bd2=await browser_login['newPage'](),_0x4a2bd2['setDefaultNavigationTimeout'](0x1d4c),_0x4a2bd2['setDefaultTimeout'](0x1d4c),await _0x4a2bd2['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x4a2bd2;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x55f416=0x1,_0x33b4f9=0x0){let _0x467e5a='',_0x59d4dc=null;const _0x43860b=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x467e5a=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x467e5a=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x55f416===0x0&&!pageStack[_0x33b4f9])return browser=await puppeteer['launch']({'headless':_0x43860b,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x467e5a}),_0x59d4dc=await browser['newPage'](),_0x59d4dc['setDefaultNavigationTimeout'](0x1d4c),_0x59d4dc['setDefaultTimeout'](0x1d4c),await _0x59d4dc['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x33b4f9]=_0x59d4dc,_0x59d4dc;return(browser===null||pageStack[_0x33b4f9]===null||pageStack[_0x33b4f9]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x43860b,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x467e5a})),(pageStack[_0x33b4f9]===null||pageStack[_0x33b4f9]['isClosed']())&&(_0x59d4dc=await browser['newPage'](),_0x59d4dc['setDefaultNavigationTimeout'](0x1d4c),_0x59d4dc['setDefaultTimeout'](0x1d4c),await _0x59d4dc['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x33b4f9]=_0x59d4dc),pageStack[_0x33b4f9];}ipcMain['on']('login',async(_0x4783dc,_0x5359b2)=>{const _0x311118=await getBrowserPageLogin();await _0x311118['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x311118,_0x5359b2),ipcMain['on']('setLoginCookies',async(_0x28bae4,_0x4a7e00)=>{try{await set_login_cookies(_0x311118,_0x4a7e00);}catch(_0x23a990){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x23a990);}});}),ipcMain['on']('export-relation',async(_0xf1c226,_0x43df50)=>{try{await exportDatabase(_0x43df50),_0xf1c226['reply']('export-relation-response',{'success':!![]});}catch(_0x28f3d3){console['error'](_0x28f3d3),_0xf1c226['reply']('export-relation-response',{'success':![],'message':_0x28f3d3['message']});}}),ipcMain['handle']('sendMessage',async(_0x231242,_0x180094,_0x36619b,_0x4c778d,_0x49e023,_0x28b975,_0x16fa59,_0x2f179c,_0x5bdee8,_0x232593)=>{isStopping=![];let _0x53b93b=null;return _0x16fa59?_0x53b93b=await getBrowserPage(_0x49e023,_0x2f179c):_0x53b93b=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x180094),send_message(_0x53b93b,_0x180094,_0x36619b,_0x4c778d,_0x49e023,_0x28b975,_0x5bdee8,_0x232593);}),ipcMain['handle']('stop-action',async(_0x5c11a1,_0x3de2fe)=>{isStopping=!![];const _0x4ae415=await getBrowserPage(0x1,_0x3de2fe);await _0x4ae415['close']();}),ipcMain['handle']('fetch_followers',async(_0x1fae47,_0x7f1246,_0x356991,_0x192eec,_0x2926e8,_0x4f3df6)=>{isStopping=![];const _0x33f67=await getBrowserPage();return fetch_followers_from_account(_0x1fae47,_0x33f67,_0x7f1246,_0x356991,_0x192eec,_0x2926e8,_0x4f3df6);}),ipcMain['handle']('get-account-details',async(_0xb22a6e,_0x3b7d3e,_0xe8e0b9,_0x173869)=>{isStopping=![];const _0x462d60=await getBrowserPage();return fetch_account_details(_0x462d60,_0x3b7d3e,_0xe8e0b9,_0x173869);}),ipcMain['handle']('fetch_likes',async(_0x15af33,_0x1f22ab,_0x47d96f,_0x224919,_0x6eb057,_0x475c42)=>{isStopping=![];const _0x4dc9f9=await getBrowserPage();return fetch_likers_from_post(_0x15af33,_0x4dc9f9,_0x1f22ab,_0x47d96f,_0x224919,_0x6eb057,_0x475c42);}),ipcMain['handle']('fetch_comments',async(_0x43f457,_0x2c4ee2,_0x205e05,_0x202cb0,_0x149a11,_0x5d4b0d)=>{isStopping=![];const _0x3463a6=await getBrowserPage();return fetch_comments_from_post(_0x43f457,_0x3463a6,_0x2c4ee2,_0x205e05,_0x202cb0,_0x149a11,_0x5d4b0d);});async function updateAppSilent(){const {spawn:_0x4d8f8d}=require('child_process'),_0xb28390=require('path'),_0xb625b0=require('electron-log');return _0xb625b0['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x299dce,_0xd7fd9d)=>{const {updateElectronApp:_0x943866,UpdateSourceType:_0x23a90d}=require('update-electron-app');_0x943866({'updateSource':{'type':_0x23a90d['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0xb625b0}),_0x299dce('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x16890d,_0x4df728)=>{doFullElectronUpdateSilent(),_0x16890d('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x17872a}=require('child_process'),_0x3f09b7=require('path'),_0x36f105=require('electron-log');return _0x36f105['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x4c9a3d,_0x21b717)=>{const {updateElectronApp:_0x24e0a0,UpdateSourceType:_0x26a218}=require('update-electron-app');_0x24e0a0({'updateSource':{'type':_0x26a218['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x36f105}),_0x4c9a3d('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x1141fd,_0x57057f)=>{doFullElectronUpdate(),_0x1141fd('Update\x20erfolgreich\x20abgeschlossen.');});}ipcMain['handle']('update-app',async(_0xceed3a,_0x220b0b)=>{console['log']('Update\x20Silent:\x20'+_0x220b0b);if(_0x220b0b)!(process['platform']==='darwin')&&(await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet'));else{if(!(process['platform']==='darwin'))await updateApp();else return new Promise((_0x1b7811,_0x44804e)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x1b7811('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x39f87b=path['join'](__dirname,'mac-updater-intern.sh'),_0x16aed4=spawn('/bin/bash',[_0x39f87b]);_0x16aed4['stdout']['on']('data',_0x3f6155=>{console['log']('stdout:\x20'+_0x3f6155);}),_0x16aed4['stderr']['on']('data',_0x4e5711=>{console['error']('stderr:\x20'+_0x4e5711);}),_0x16aed4['on']('close',_0x2119b2=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x2119b2),_0x2119b2===0x0?_0x1b7811('Update\x20erfolgreich\x20abgeschlossen.'):_0x44804e(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x2119b2));});}else{if(process['platform']==='win32'){const _0x39a22b=path['join'](__dirname,'../','../','../');process['chdir'](_0x39a22b),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x295799='soft-ui-updater-windows.ps1',_0x26e45f=spawn('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x295799]);_0x26e45f['stdout']['on']('data',_0x25f8fa=>{console['log']('stdout:\x20'+_0x25f8fa);}),_0x26e45f['stderr']['on']('data',_0x4c14a6=>{console['error']('stderr:\x20'+_0x4c14a6);}),_0x26e45f['on']('close',_0x3e1c79=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x3e1c79),_0x3e1c79===0x0?_0x1b7811('Update\x20erfolgreich\x20abgeschlossen.'):_0x44804e(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x3e1c79));});}else _0x44804e(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}});function getRnd(_0x482c8f,_0x19153f){return Math['random']()*(_0x19153f-_0x482c8f+0x1)+_0x482c8f;}function delay(_0x9d22ba,_0x3f3db2){let _0x34acbe=getRnd(_0x9d22ba,_0x3f3db2);return new Promise(function(_0x47f0b7){setTimeout(_0x47f0b7,_0x34acbe);});}async function scroll(_0x252f25,_0x1c5d56,_0x28cada=0x2,_0x251a4c){const _0x5e255f=await _0x252f25['waitForSelector'](_0x1c5d56);for(let _0x7c43ba=0x0;_0x7c43ba<_0x28cada;_0x7c43ba++){console['log']('Scrolling\x20'+_0x7c43ba),await _0x252f25['evaluate'](_0x5c77d1=>{const _0x1a9985=document['querySelector'](_0x5c77d1);_0x1a9985&&_0x1a9985['scrollBy'](0x0,0x190);},_0x1c5d56),await delay(0x320,0x5dc),_0x251a4c();}}async function saveCookies(_0x246777){let _0x23bfd7=await _0x246777['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x23bfd7,null,0x2));}async function notificationClear(_0x45dbcd){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x45dbcd['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x45dbcd['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x25928c){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x25928c);}}async function getTargetProfiles(_0x453dc1){return new Promise((_0x9ee1ac,_0x301ced)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x453dc1,(_0x1d9fb2,_0x572714)=>{_0x1d9fb2?_0x301ced(_0x1d9fb2):_0x9ee1ac(_0x572714);});});}async function login_legacy(_0x551b05,_0x272bc5,_0x313de3){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x551b05,_0x272bc5),await createUserIfNotExists(_0x272bc5,_0x313de3);}catch(_0x42304f){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x42304f);}try{await _0x551b05['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x551b05['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x551b05['click']('button._a9--._ap36._a9_0');}catch(_0x192de1){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x551b05['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x551b05['type']('input[name=\x27username\x27]',_0x272bc5,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x551b05['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x551b05['type']('input[name=\x27password\x27]',_0x313de3,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x551b05['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x551b05['click']('button[type=\x27submit\x27]');}catch(_0x2127ab){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x551b05),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x551b05,_0x272bc5);}catch(_0x3ddd28){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x3ddd28);}}catch(_0xce6b71){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0xce6b71);}}async function login(_0x298bd5,_0x48ec7e){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x298bd5,_0x48ec7e),await createUserIfNotExists(_0x48ec7e);}catch(_0x55d333){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x55d333);}try{await _0x298bd5['goto']('https://www.instagram.com/accounts/login/');}catch(_0x2df925){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x2df925);}}async function set_login_cookies(_0x381684,_0x40abe0){try{await saveCookiesForUser(_0x381684,_0x40abe0);}catch(_0x249157){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x249157);}}async function waitForXPath(_0x42754e,_0x2a3d81,_0x1b7728={}){return await _0x42754e['waitForFunction'](_0x195f19=>{return document['evaluate'](_0x195f19,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x1b7728,_0x2a3d81),_0x42754e['evaluateHandle'](_0x303393=>document['evaluate'](_0x303393,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x2a3d81);}async function send_message(_0x5b4ba3,_0x439414,_0x3798be,_0x5ae132,_0xc55892,_0x43495d,_0x5917ca,_0x154ea2){return new Promise(async(_0x5c244f,_0x2dd5a7)=>{_0x43495d=_0x43495d['split'](';'),console['log'](_0x43495d[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0xc55892);try{await setCookiesForUser(_0x5b4ba3,_0x43495d[0x0]);}catch(_0x3875e9){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x3875e9),_0x2dd5a7({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x3875e9});return;}try{await _0x5b4ba3['goto']('https://www.instagram.com/'+_0x439414+'/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x5b4ba3);}catch(_0xc095ac){_0x2dd5a7({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0xc095ac});return;}console['log']('UserSkip:\x20'+_0x5917ca);if(_0x5917ca==0x1)try{const _0x50483d=await _0x5b4ba3['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x3e07be=>_0x3e07be['textContent']['trim']());console['log'](_0x50483d);if(_0x50483d==='Following'||_0x50483d==='Folge\x20ich')return _0x5c244f({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x5284ff){}try{await _0x5b4ba3['waitForSelector'](K_DIRECT_MSG_BUTTON),await _0x5b4ba3['click'](K_DIRECT_MSG_BUTTON);}catch(_0x4fa20f){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x4fa20f);try{await _0x5b4ba3['waitForSelector'](K_OPTIONS_BUTTON),await _0x5b4ba3['click'](K_OPTIONS_BUTTON),await delay(0x1f4,0x320);const _0x25be02=await waitForXPath(_0x5b4ba3,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x25be02['click']();}catch(_0x3955d9){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x3955d9),_0x5c244f({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x5b4ba3);}catch(_0x922a2a){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x922a2a);}try{const _0x56bbc3=await _0x5b4ba3['waitForSelector'](K_CHAT_INPUT_FIELD);if(_0x154ea2){const _0x23db5e=await _0x5b4ba3['$']('div.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x6ikm8r.x10wlt62');if(_0x23db5e)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x439414),_0x5c244f({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x14334f=await _0x5b4ba3['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x14334f),_0x5ae132=_0x5ae132['replace']('{USERNAME}',_0x439414);let _0x20ba4d=_0x14334f['replace'](/[^\p{L}\s]/gu,''),_0x1538bd=_0x20ba4d['split']('\x20')[0x0];console['log']('Extrahierter\x20Clearname\x20mit\x20Len:\x20'+_0x1538bd['length']+'nach\x20Split:\x20'+_0x1538bd);_0x1538bd['length']>0x2&&!_0x1538bd['includes']('Instagram')?(_0x5ae132=_0x5ae132['replaceAll']('{NAME}',_0x1538bd),_0x5ae132=_0x5ae132['replaceAll']('{name}',_0x1538bd)):(_0x5ae132=_0x5ae132['replaceAll']('\x20{NAME}',''),_0x5ae132=_0x5ae132['replaceAll']('\x20{name}',''),_0x5ae132=_0x5ae132['replaceAll']('{NAME}',''),_0x5ae132=_0x5ae132['replaceAll']('{name}',''));await _0x56bbc3['type'](_0x5ae132,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0x35d899=await _0x5b4ba3['waitForSelector'](K_SEND_MSG_BUTTON);await _0x35d899['click'](),await delay(0x320,0x3e8),_0x5c244f({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!'});}catch(_0x1ff0f0){try{await _0x5b4ba3['waitForSelector'](K_MSG_DISABLED_LABEL);const _0x1cbcfc=await _0x5b4ba3['evaluate'](_0x1056d4=>{return document['querySelector'](_0x1056d4)['textContent'];},K_MSG_DISABLED_LABEL);console['log']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20gefunden:\x20'+_0x1cbcfc),console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x1ff0f0),_0x5c244f({'status':0x195,'message':'Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x439414+'\x20überspringen.'});}catch(_0x418118){console['error']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20nicht\x20gefunden:\x20'+_0x418118),console['error']('Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x439414+'\x20:\x20'+_0x418118),_0x5c244f({'status':0x196,'message':'Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x439414+'\x20:\x20'+_0x418118});}}});}function handle_fail(_0x3601c8){if(isStopping)return new Promise(_0x4ce300=>{_0x4ce300('Scraper\x20gestoppt.');});else{let _0x46b305='';switch(_0x3601c8){case 0x0:_0x46b305='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x46b305='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x46b305='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x46b305='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x10cc95,_0xe79077)=>{_0xe79077(_0x46b305);});}}async function fetch_account_details(_0x1d5056,_0x115c2a,_0x1cfe7f,_0x2a006f){try{await setCookiesForUser(_0x1d5056,_0x1cfe7f['username']);}catch(_0x543bd9){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x543bd9);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x543bd9);return handle_fail(0x0);}_0x1d5056['setDefaultNavigationTimeout'](0x7530),await _0x1d5056['goto']('https://www.instagram.com/'+_0x115c2a+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x1d5056);const _0x1298aa=await _0x1d5056['evaluate'](()=>{const _0x37137a=document['querySelector']('meta[property=\x22og:image\x22]');return _0x37137a?_0x37137a['getAttribute']('content'):null;});await _0x1d5056['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x3f19a0=await _0x1d5056['evaluate'](()=>{const _0x231b09=document['querySelector']('meta[name=\x22description\x22]');if(!_0x231b09)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x5a9927=_0x231b09['getAttribute']('content');if(!_0x5a9927)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x5a9927);const _0x36582b=/\s*[–-]\s*/,_0x5722b8=_0x5a9927['split'](_0x36582b);if(_0x5722b8['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x33a6ba=_0x5722b8[0x0],_0x20a39e=_0x5722b8[0x1],_0x38fdb6=_0x33a6ba['split'](',\x20');if(_0x38fdb6['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x234b35=_0x38fdb6[0x0]['split']('\x20')[0x0],_0xd417f5=_0x38fdb6[0x1]['split']('\x20')[0x0],_0x8c7b40=_0x38fdb6[0x2]['split']('\x20')[0x0];let _0x3831e2='',_0x38b9eb='';const _0x3a6ebd='\x20on\x20Instagram:\x20',_0x1e2d53=_0x20a39e['split'](_0x3a6ebd);return _0x3831e2=_0x1e2d53[0x0]['trim'](),_0x3831e2=_0x3831e2['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x1e2d53['length']>0x1&&(_0x38b9eb=_0x1e2d53[0x1]['trim'](),_0x38b9eb['startsWith']('\x22')&&_0x38b9eb['endsWith']('\x22')&&(_0x38b9eb=_0x38b9eb['substring'](0x1,_0x38b9eb['length']-0x1)['trim']()),_0x38b9eb=_0x38b9eb['replace'](/&quot;/g,'')['trim']()),{'followers':_0x234b35,'following':_0xd417f5,'posts':_0x8c7b40,'nameText':_0x3831e2,'bio':_0x38b9eb};});console['log']('Extracted\x20profile\x20data:',_0x3f19a0);const _0x5dd55a=_0x3f19a0['nameText'],_0x457b93=_0x1298aa,_0x3453ab=_0x3f19a0['bio'],_0xa809cd=_0x3f19a0['followers'],_0x4eaef3=_0x3f19a0['following'],_0x35da6f=_0x3f19a0['posts'],_0x51d6c2=![],_0x3f43d8=![],_0x121d09=![],_0x45152e='\x0a\x20\x20INSERT\x20INTO\x20'+_0x2a006f+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x45152e,[_0x115c2a,_0x5dd55a,_0x457b93,_0x3453ab,_0xa809cd,_0x4eaef3,_0x35da6f,_0x51d6c2,_0x3f43d8,_0x121d09],function(_0x1af491){_0x1af491?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x1af491['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x1e4657,_0x360da3,_0x17d84f,_0x40e16f,_0x58c929,_0x3d142a,_0x42efb0){let _0xa1f20b=0x4,_0x5171cb=0x0,_0x3d130e=0x0;try{await setCookiesForUser(_0x360da3,_0x3d142a['username']);}catch(_0xd225d5){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0xd225d5);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0xd225d5);return handle_fail(0x0);}let _0x1e4d54=0x0;try{await _0x360da3['goto']('https://www.instagram.com/'+_0x17d84f+'/'),await notificationClear(_0x360da3);try{if(_0x40e16f<=0x0){const _0x48cf61=await _0x360da3['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x499725=await _0x360da3['evaluate'](_0x34668c=>_0x34668c['innerHTML'],_0x48cf61);_0x1e4d54=Math['ceil'](_0x499725/0x4);}else _0x1e4d54=Math['ceil'](_0x40e16f/0x4);_0xa1f20b+=_0x1e4d54,_0x3d130e=Math['round'](++_0x5171cb/_0xa1f20b*0x64),_0x1e4657['sender']['send']('fetch-progress',_0x3d130e,!![]);let _0x1f02bd=await _0x360da3['waitForSelector']('a[href=\x22/'+_0x17d84f+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x1f02bd['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x17d84f+'\x20gesichtet'),_0x3d130e=Math['round'](++_0x5171cb/_0xa1f20b*0x64),_0x1e4657['sender']['send']('fetch-progress',_0x3d130e,!![]);}catch(_0x55bd98){console['log']('Follower\x20Liste\x20von\x20'+_0x17d84f+'\x20nicht\x20gefunden:'+_0x55bd98);throw new Error('Follower\x20Liste\x20von\x20'+_0x17d84f+'\x20nicht\x20gefunden:'+_0x55bd98);return handle_fail(0x0);}}catch(_0x355644){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x355644);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x355644);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x1e4d54),await scroll(_0x360da3,FOLLOWER_FENSTER,_0x1e4d54,_0x1a193e=>{_0x3d130e=Math['round'](++_0x5171cb/_0xa1f20b*0x64),_0x1e4657['sender']['send']('fetch-progress',_0x3d130e,!![]);}),await _0x360da3['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x693331=await _0x360da3['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x14f1ef=await _0x360da3['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x3d130e=Math['round'](++_0x5171cb/_0xa1f20b*0x64),_0x1e4657['sender']['send']('fetch-progress',_0x3d130e,!![]);_0x40e16f<=0x0&&(_0x40e16f=_0x693331['length']);let _0x1e0956=[];for(let _0x396e2d=0x0;_0x396e2d<_0x693331['length']&&_0x396e2d<_0x40e16f;_0x396e2d++){_0x1e0956['push'](await _0x693331[_0x396e2d]['evaluate'](_0x373e8c=>_0x373e8c['textContent']));const _0x3a9d36='INSERT\x20INTO\x20'+_0x58c929+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x3a9d36,[await _0x693331[_0x396e2d]['evaluate'](_0xc1edb9=>_0xc1edb9['textContent']),await _0x14f1ef[_0x396e2d]['evaluate'](_0x400626=>_0x400626['textContent'])],function(_0x36a38e){_0x36a38e?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x58c929+'\x27:',_0x36a38e['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x3d130e=Math['round'](++_0x5171cb/_0xa1f20b*0x64),_0x1e4657['sender']['send']('fetch-progress',_0x3d130e,!![]),_0x42efb0&&(_0x1e4657['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x1e4657,_0x360da3,_0x3d142a,_0x58c929,_0x1e0956)),new Promise(_0x7901c7=>{_0x7901c7('Scraping\x20finished!');});}catch(_0x281d13){if(_0x42efb0)throw new Error(_0x281d13);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x17d84f+'\x20nicht\x20gefunden:\x20'+_0x281d13);return handle_fail(0x0);}}async function fetch_details_from_list(_0x2d5757,_0x565b8e,_0x506569,_0x4206c0,_0x14e772){let _0x4578d6=0x0,_0x43449c=0x0;for(let _0x56c430=0x0;_0x56c430<_0x14e772['length'];_0x56c430++){console['log']('Processing\x20profile:',_0x14e772[_0x56c430]);try{await fetch_account_details(_0x565b8e,_0x14e772[_0x56c430],_0x506569,_0x4206c0);}catch(_0x10134e){console['error']('Detailed\x20Scraping\x20von:\x20',_0x14e772[_0x56c430],_0x10134e);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x14e772[_0x56c430]+'\x20'+_0x10134e);}_0x43449c=Math['round'](++_0x4578d6/_0x14e772['length']*0x64),_0x2d5757['sender']['send']('fetch-progress',_0x43449c,!![],!![]);}}async function fetch_likers_from_post(_0x3b8061,_0x551062,_0x177dcc,_0xee2ed4,_0x46693b,_0x1b82ae,_0x26c69f){let _0x3e348b=0x4,_0x1262b5=0x0,_0x2c5f28=0x0;try{await setCookiesForUser(_0x551062,_0x1b82ae['username']);}catch(_0x168136){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x168136);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x168136);return handle_fail(0x1);return;}_0x2c5f28=Math['round'](++_0x1262b5/_0x3e348b*0x64),_0x3b8061['sender']['send']('fetch-progress',_0x2c5f28,!![]);try{let _0x598954=_0x177dcc['substring'](0x0,_0x177dcc['lastIndexOf']('/')),_0x5af2fc=_0x598954+'/liked_by';console['log'](_0x5af2fc),await _0x551062['goto'](_0x5af2fc),await delay(0x7d0,0xfa0),await notificationClear(_0x551062),await delay(0xc8,0x1f4),_0x2c5f28=Math['round'](++_0x1262b5/_0x3e348b*0x64),_0x3b8061['sender']['send']('fetch-progress',_0x2c5f28,!![]),await _0x551062['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x42eee4=await _0x551062['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0xf7c846=await _0x551062['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x42eee4['length']);let _0x33d181=path['join'](__dirname,'/likers.csv');_0x2c5f28=Math['round'](++_0x1262b5/_0x3e348b*0x64),_0x3b8061['sender']['send']('fetch-progress',_0x2c5f28,!![]);_0xee2ed4<=0x0&&(_0xee2ed4=_0x42eee4['length']);try{let _0x44b1db=[];for(let _0x3ad572=0x0;_0x3ad572<_0x42eee4['length']&&_0x3ad572<_0xee2ed4;_0x3ad572++){_0x44b1db['push'](await _0x42eee4[_0x3ad572]['evaluate'](_0x228e34=>_0x228e34['textContent']));try{const _0x274afb='INSERT\x20INTO\x20'+_0x46693b+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x274afb,[await _0x42eee4[_0x3ad572]['evaluate'](_0x4efe51=>_0x4efe51['textContent']),await _0xf7c846[_0x3ad572]['evaluate'](_0x11317e=>_0x11317e['textContent'])],function(_0x5d7d9e){_0x5d7d9e?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x46693b+'\x27:',_0x5d7d9e['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x215071){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x3ad572+'\x20:\x20'+_0x215071);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x3ad572+'\x20:\x20'+_0x215071);return handle_fail(0x1);}}return _0x2c5f28=Math['round'](++_0x1262b5/_0x3e348b*0x64),_0x3b8061['sender']['send']('fetch-progress',_0x2c5f28,!![]),_0x26c69f&&(_0x3b8061['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x3b8061,_0x551062,_0x1b82ae,_0x46693b,_0x44b1db)),new Promise(_0x9e6056=>{_0x9e6056('Scraping\x20finished!');});}catch(_0x59018a){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x59018a);return handle_fail(0x1);}}catch(_0x364d51){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x364d51);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x364d51);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x497098,_0x2256fd,_0x31ff8d,_0x206793,_0x25cc95,_0x42e6e8,_0x5ef1bb){let _0x25fe01=0x3,_0x563b8c=0x0,_0x570841=0x0;try{await setCookiesForUser(_0x2256fd,_0x42e6e8['username']);}catch(_0x15395f){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x15395f);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x15395f);return handle_fail(0x2);}try{console['log'](_0x31ff8d),await _0x2256fd['goto'](_0x31ff8d),await delay(0x7d0,0xfa0),await notificationClear(_0x2256fd),await delay(0xc8,0x1f4);const _0x100394=COM_COMMENTS_BOX_BODY_DIV;let _0x14ac4d;const _0x631c45=await _0x2256fd['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x2008f7=await _0x2256fd['evaluate'](_0x57e780=>_0x57e780['innerHTML'],_0x631c45),_0x30b630=String(_0x2008f7)['replace'](/[^0-9]/g,''),_0xb776a4=Number(_0x30b630)/0x14;_0x206793<=0x0?_0x14ac4d=Math['ceil'](_0xb776a4/0x3):_0x14ac4d=Math['ceil'](_0x206793/0x3);_0x25fe01+=_0x14ac4d,_0x570841=Math['round'](++_0x563b8c/_0x25fe01*0x64),_0x497098['sender']['send']('fetch-progress',_0x570841,!![]),console['log']('Auto-scrolls:\x20'+_0x14ac4d),await scroll(_0x2256fd,_0x100394,_0x14ac4d,_0x3e0c83=>{_0x570841=Math['round'](++_0x563b8c/_0x25fe01*0x64),_0x497098['sender']['send']('fetch-progress',_0x570841,!![]);});try{const _0x25cd26=COM_REPLY_BUTTON_SPAN;await _0x2256fd['waitForSelector'](_0x25cd26),await delay(0x1f4,0x320);const _0x181f9b=await _0x2256fd['$$'](_0x25cd26);console['log'](_0x181f9b);let _0x2f8d2b=_0x181f9b['length'];await delay(0xc8,0x1f4);try{for(let _0x25d24a=0x0;_0x25d24a<_0x2f8d2b;_0x25d24a++){_0x181f9b[_0x25d24a]['click'](),await delay(0x320,0x5dc);}}catch(_0x5d9be5){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x5d9be5);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x5d9be5);return handle_fail(0x2);}}catch(_0x21cc2a){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x5824f2=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x2256fd['waitForSelector'](_0x5824f2),await delay(0x1f4,0x320),_0x570841=Math['round'](++_0x563b8c/_0x25fe01*0x64),_0x497098['sender']['send']('fetch-progress',_0x570841,!![]);const _0x5eb394=await _0x2256fd['$$'](_0x5824f2);let _0x1dcb67=path['join'](__dirname,'/comments.csv');_0x206793<=0x0&&(_0x206793=_0x5eb394['length']);console['log']('fetch_limit:\x20'+_0x206793),console['log']('comments_len:\x20'+_0x5eb394['length']),_0x206793++;try{let _0x2a673=[];for(let _0x532a26=0x1;_0x532a26<_0x5eb394['length']&&_0x532a26<_0x206793;_0x532a26++){try{_0x2a673['push'](await _0x5eb394[_0x532a26]['evaluate'](_0x23d469=>_0x23d469['textContent']));const _0x215c42=await db['prepare']('INSERT\x20INTO\x20'+_0x25cc95+'\x20(username)\x20VALUES\x20(?)');await _0x215c42['run'](await _0x5eb394[_0x532a26]['evaluate'](_0x1af920=>_0x1af920['textContent']),function(_0x534277){_0x534277&&console['log']('error\x20in\x20add-user:'+_0x534277);}),await _0x215c42['finalize']();}catch(_0x531532){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x532a26+'\x20:\x20'+_0x531532);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x532a26+'\x20:\x20'+_0x531532);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x570841=Math['round'](++_0x563b8c/_0x25fe01*0x64),_0x497098['sender']['send']('fetch-progress',_0x570841,!![]),_0x497098['sender']['send']('fetch-progress',0x64,!![]),_0x5ef1bb&&(_0x497098['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x497098,_0x2256fd,_0x42e6e8,_0x25cc95,_0x2a673)),_0x497098['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x65fa58=>{_0x65fa58('Scraping\x20finished!');});}catch(_0x34d322){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x34d322);return handle_fail(0x2);}}catch(_0x1bcc64){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x1bcc64);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x1bcc64);return handle_fail(0x2);}}async function set_clearname_from_username(_0x5107fb,_0x865aa0,_0x16724c=null){try{let _0x9cf41,_0x474cbd;const _0x3493d1='SELECT\x20username\x20FROM\x20'+_0x865aa0+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x3493d1,[],(_0x167705,_0x1b927a)=>{_0x167705&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x167705['message']),_0x1b927a['length']===0x0&&(_0x474cbd=_0x1b927a['length']),_0x9cf41=_0x1b927a['map'](_0x7d0c29=>_0x7d0c29['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x474cbd);if(_0x474cbd===0x0){console['log']('Leave');return;}const _0x24603b=await _0x5107fb['waitForSelector'](IG_SEARCH_BUTTON);await _0x24603b['click'](),await delay(0x4b0,0x7d0);for(let _0x206afe of _0x9cf41){const _0x3894c9=await _0x5107fb['waitForSelector'](IG_SEARCH_INPUT);await _0x3894c9['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x5107fb['type'](IG_SEARCH_INPUT,_0x206afe,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x5551f7=0x1;while(_0x5551f7!=0x14){console['log']('Schleife');try{let _0x4773f4=IG_NAME_SPAN_PART1+_0x5551f7+IG_USERNAME_SPAN_PART2;const _0x520843=await _0x5107fb['waitForSelector'](_0x4773f4),_0x5ef6ce=await _0x5107fb['evaluate'](_0x40e62d=>_0x40e62d['innerHTML'],_0x520843);await delay(0xc8,0x1f4);if(_0x5ef6ce==_0x206afe){let _0x5d5393=IG_NAME_SPAN_PART1+_0x5551f7+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x542272=await _0x5107fb['waitForSelector'](_0x5d5393);let _0x26afe3=await _0x5107fb['evaluate'](_0x33ba2e=>_0x33ba2e['innerHTML'],_0x542272);const _0x32ebae=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x138f65=_0x26afe3['match'](_0x32ebae);_0x138f65?_0x26afe3=_0x138f65[0x1]['trim']():_0x26afe3=_0x26afe3['trim']();_0x26afe3['includes']('•')&&(_0x26afe3=_0x26afe3['substring'](0x0,_0x26afe3['indexOf']('•')-0x1));const _0x37c5bb='UPDATE\x20'+_0x865aa0+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x37c5bb,[_0x26afe3,_0x5ef6ce],function(_0x2374b7){_0x2374b7&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x2374b7['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x5551f7++;}catch(_0x4f960b){const _0x448c9e='UPDATE\x20'+_0x865aa0+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x448c9e,['',_0x206afe],function(_0x459bc3){_0x459bc3&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x459bc3['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x4f960b);break;}}_0x16724c&&_0x16724c();}await _0x24603b['click']();}catch(_0x37f869){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x37f869);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x2ccc54,_0x596211)=>{const _0x280359='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x280359,[],(_0x2757b4,_0xf42d10)=>{_0x2757b4?_0x596211(_0x2757b4):_0x2ccc54(_0xf42d10);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x3c7af8,_0xdb5de)=>{const _0x425573='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x425573,[],async(_0x3401a6,_0x338474)=>{if(_0x3401a6)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x3401a6['message']),_0xdb5de({'status':'error','message':_0x3401a6['message']});else try{const _0x2fe87d=await Promise['all'](_0x338474['map'](_0x440a90=>{return new Promise(_0x1486e5=>{if(!_0x440a90['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x440a90['campaign_name']),_0x1486e5({'campaign_name':_0x440a90['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x4dc4b2='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x440a90['list_id'],_0x4b87e2='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x440a90['list_id']+'\x22';db['get'](_0x4dc4b2,[],(_0x5e1421,_0x1165eb)=>{_0x5e1421?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x440a90['campaign_name']+':',_0x5e1421['message']),_0x1486e5({'campaign_name':_0x440a90['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x4b87e2,[],(_0x23186d,_0x196f5c)=>{_0x23186d?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x440a90['campaign_name']+':',_0x23186d['message']),_0x1486e5({'campaign_name':_0x440a90['campaign_name'],'lead_count':_0x1165eb?_0x1165eb['lead_count']:0x0,'contacted_count':'N/A'})):_0x1486e5({'campaign_name':_0x440a90['campaign_name'],'lead_count':_0x1165eb?_0x1165eb['lead_count']:0x0,'contacted_count':_0x196f5c?_0x196f5c['contacted_count']:0x0});});});});}));_0x3c7af8({'status':'success','campaigns':_0x2fe87d});}catch(_0x7da3b4){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x7da3b4),_0xdb5de({'status':'error','message':_0x7da3b4['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x9ce0f5,_0x3b3481)=>{return new Promise((_0x47fc78,_0xde0382)=>{const _0x492f95='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x492f95,[_0x3b3481],(_0x3ba520,_0x534b7a)=>{_0x3ba520?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x3ba520),_0xde0382(_0x3ba520)):(console['log']('ROWS'),console['log'](_0x534b7a),debugDatabaseContents(),_0x47fc78(_0x534b7a));});});});const showTableContents=_0xbf7dd4=>{return new Promise((_0xb73361,_0x538266)=>{const _0x28bd76='SELECT\x20*\x20FROM\x20'+_0xbf7dd4+';';campaignDB['all'](_0x28bd76,(_0x4a0da1,_0x4bc877)=>{_0x4a0da1?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0xbf7dd4+':',_0x4a0da1),_0x538266(_0x4a0da1)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0xbf7dd4+':',_0x4bc877),_0xb73361({'status':'success','message':_0x4bc877}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x86f1b2){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x86f1b2);}}ipcMain['handle']('create-campaign',async(_0x268d7e,_0x217cca)=>{return new Promise((_0x44a3c2,_0xaaed9d)=>{const _0x53f20c='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x53f20c,[String(_0x217cca)],function(_0x29fa2c){_0x29fa2c?_0xaaed9d(_0x29fa2c):_0x44a3c2({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x4102de,_0x39d3ae)=>{return new Promise((_0x3240c7,_0x794835)=>{const _0x1f53f0='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x1f53f0,[_0x39d3ae],function(_0x26f306){_0x26f306?_0x794835(_0x26f306):_0x3240c7({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x28c23d,_0x14e955,_0x2bccc2,_0x33a483,_0x5acdc8,_0x3f25d3,_0x1fb403,_0x3e8102)=>{const _0x3a91d2=await createMessageID(_0x5acdc8);return new Promise((_0x2fa749,_0x137dcf)=>{if(!_0x14e955||!_0x2bccc2||!_0x33a483||!_0x3a91d2||!_0x3f25d3)return _0x137dcf({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x3a91d2);const _0xee1af1='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0xee1af1,[_0x2bccc2,_0x33a483,_0x3a91d2,_0x3f25d3,_0x1fb403,_0x3e8102,_0x14e955],function(_0x364621){if(_0x364621)_0x137dcf({'status':'error','message':_0x364621['message']});else this['changes']===0x0?_0x137dcf({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x2fa749({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x10158b,_0x3859ca,_0x3fb4d2,_0x29c6a2,_0x28bf76)=>{return new Promise((_0x1ce544,_0x3aed18)=>{const _0x1bf649='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x1bf649,[_0x3859ca,_0x3fb4d2,_0x29c6a2,_0x28bf76],function(_0x114303){return _0x114303?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x114303['message']),_0x3aed18('insert-dm-response',{'success':![],'message':_0x114303['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x1ce544('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x2c4fc0=>{return new Promise((_0x5f5de7,_0x1d5297)=>{const _0x3eac86='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x3eac86,[_0x2c4fc0],(_0x4fa96c,_0x349808)=>{if(_0x4fa96c)_0x1d5297({'status':'error','message':_0x4fa96c['message']});else{if(_0x349808)_0x5f5de7(_0x349808['message_id']);else{const _0xfac03c='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0xfac03c,[_0x2c4fc0],function(_0xcc6730){_0xcc6730?_0x1d5297({'status':'error','message':_0xcc6730['message']}):_0x5f5de7(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x5d484d,_0x2d7a77)=>{return new Promise((_0x57f640,_0x5042b0)=>{const _0x1f1a35='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x2d7a77;db['get'](_0x1f1a35,(_0x35d69a,_0x1caab0)=>{_0x35d69a?_0x5042b0({'status':'error','message':_0x35d69a['message']}):_0x57f640({'status':'success','count':_0x1caab0['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x1df78b,_0xbf4b3f){try{const _0x3ffee4=await new Promise((_0x4548a0,_0x1e1c7f)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0xbf4b3f],(_0x2816cd,_0x5e67cd)=>{if(_0x2816cd)_0x1e1c7f(_0x2816cd);else{if(_0x5e67cd['length']>0x0){let _0x5abe07=JSON['parse'](_0x5e67cd[0x0]['cookie']);console['log'](_0x5abe07),_0x4548a0(_0x5abe07);}else _0x1e1c7f(new Error('User\x20with\x20username\x20'+_0xbf4b3f+'\x20does\x20not\x20exist.'));}});});await _0x1df78b['setCookie'](..._0x3ffee4),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x2a85b8){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2a85b8);}}async function saveCookiesForUser(_0x4cdeb2,_0x4f0bd4){try{const _0x42b379=await _0x4cdeb2['cookies']();if(!_0x42b379||_0x42b379['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x4f0bd4);const _0x3c061a=JSON['stringify'](_0x42b379);if(_0x3c061a['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x4f0bd4);return new Promise((_0x5221b3,_0x1e362e)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x4f0bd4],(_0x59d01b,_0x444659)=>{if(_0x59d01b)return console['error']('Error\x20checking\x20user\x20existence:',_0x59d01b),_0x1e362e(_0x59d01b);if(_0x444659){const _0x36a6fe=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x36a6fe['run'](_0x3c061a,_0x4f0bd4,function(_0x4defbd){return _0x4defbd?(console['error']('Error\x20updating\x20cookies:',_0x4defbd),_0x1e362e(_0x4defbd)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x4f0bd4),_0x5221b3());});}else{const _0x4fb05f=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x4fb05f['run'](_0x4f0bd4,_0x3c061a,function(_0x5ea7be){return _0x5ea7be?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x5ea7be),_0x1e362e(_0x5ea7be)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x4f0bd4),_0x5221b3());});}});});}catch(_0x213817){console['error']('Error\x20fetching\x20cookies:',_0x213817);throw _0x213817;}}async function createUserIfNotExists(_0x958553){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x958553],(_0x459aeb,_0x5d94fe)=>{if(_0x459aeb){console['error']('Error\x20checking\x20user\x20existence:',_0x459aeb);throw _0x459aeb;}else{if(!_0x5d94fe){const _0x4c550d=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x4c550d['run'](_0x958553,function(_0x6ba17e){_0x6ba17e?console['error']('Error\x20inserting\x20new\x20user:',_0x6ba17e):console['log']('New\x20user\x20created:',_0x958553);});}else console['log']('User\x20already\x20exists:',_0x958553);}});}catch(_0x4e2184){console['error']('Error\x20creating\x20user:',_0x4e2184);throw _0x4e2184;}}ipcMain['handle']('create-relation',async(_0x2c46cb,_0x142a7a)=>{return new Promise((_0x4b86d8,_0x331c4e)=>{const _0x5a6dab='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x142a7a+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x5a6dab,function(_0x101b88){_0x101b88?_0x331c4e(_0x101b88):_0x4b86d8({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x3f7f0f,_0x215f2a)=>{return console['log']('droping\x20table'+_0x215f2a),new Promise((_0x1d554f,_0x318e1b)=>{const _0x4a4fb6='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x215f2a;console['log']('droping\x20table'+_0x215f2a),db['run'](_0x4a4fb6,function(_0x5eee31){_0x5eee31?_0x318e1b(_0x5eee31):_0x1d554f({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x4f666b=>{return new Promise((_0x5b3158,_0x3f7f28)=>{const _0x59e01a='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x59e01a,[],(_0x1bf0df,_0x16a6bc)=>{_0x1bf0df?_0x3f7f28(_0x1bf0df):_0x5b3158(_0x16a6bc['map'](_0xa9c172=>_0xa9c172['name']));});});}),ipcMain['handle']('add-user',async(_0xad8b83,_0xc757ee,_0x25f01a)=>{return new Promise(_0x5bc6f4=>{const _0x23d717=db['prepare']('INSERT\x20INTO\x20'+_0x25f01a+'\x20(username)\x20VALUES\x20(?)');_0x23d717['run'](_0xc757ee,function(_0x58b53d){_0x58b53d?console['log']('error\x20in\x20add-user:'+_0x58b53d):_0x5bc6f4({'status':'success','id':this['lastID']});}),_0x23d717['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x2dea31,_0x144f68)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x14a9b6,_0xd596e3)=>{if(_0x14a9b6)_0x144f68(_0x14a9b6);else{_0x2dea31({'status':'success','users':_0xd596e3});for(_0xd596e3 of _0xd596e3){console['log'](_0xd596e3['username']);}}});});}),ipcMain['handle']('get-data',async(_0x1bdcc1,_0x94d5bc)=>{return new Promise((_0x8d6d4b,_0x112849)=>{const _0x3a4def='SELECT\x20*\x20FROM\x20'+_0x94d5bc;console['log'](_0x3a4def),db['all'](_0x3a4def,[],(_0x44a2aa,_0x5d31c3)=>{_0x44a2aa?_0x112849(_0x44a2aa):_0x8d6d4b(_0x5d31c3);});});}),ipcMain['handle']('get-accounts',async _0x26c6be=>{return new Promise((_0x164be9,_0x2996c3)=>{const _0x4dbd41='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x4dbd41),igaccountsDB['all'](_0x4dbd41,[],(_0x3542ef,_0x211e32)=>{_0x3542ef?_0x2996c3(_0x3542ef):_0x164be9(_0x211e32);});});}),ipcMain['handle']('get-targets',async(_0x4431dc,_0x3e7cfb)=>{return getTargetProfiles(_0x3e7cfb);}),ipcMain['handle']('delete-user',async(_0x29f2cb,_0x2bd53a,_0x2432ce)=>{return new Promise((_0x453302,_0x20d66f)=>{const _0x130fd2=db['prepare']('DELETE\x20FROM\x20'+_0x2432ce+'\x20WHERE\x20username\x20=\x20?');_0x130fd2['run'](_0x2bd53a,function(_0x1e3c02){_0x1e3c02?_0x20d66f(_0x1e3c02):_0x453302({'status':'success','changes':this['changes']});}),_0x130fd2['finalize']();});}),ipcMain['handle']('delete-account',async(_0x14ebeb,_0x53143f)=>{const _0x360b48=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x360b48['run'](_0x53143f,function(_0x3a35c5){_0x3a35c5&&console['log'](_0x3a35c5);}),_0x360b48['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x5a502c,_0x2cc908)=>{const _0xd3c317='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0xd3c317,[],(_0xdd5d78,_0x2ed4ac)=>{_0xdd5d78?_0x2cc908({'status':'error','message':_0xdd5d78['message']}):_0x5a502c({'status':'success','contactedCount':_0x2ed4ac['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x3c6218,_0x4be7a2)=>{const _0x562f17='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x562f17,[],(_0x360ca9,_0x269b36)=>{_0x360ca9?_0x4be7a2({'status':'error','message':_0x360ca9['message']}):_0x3c6218({'status':'success','contactedCount':_0x269b36['contactedCount']});});});});function exportDatabase(_0x29635e){return new Promise((_0x526a17,_0x21875d)=>{const _0x72fcb7='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x29635e+'\x0a\x20\x20\x20\x20';db['all'](_0x72fcb7,[],async(_0x17834a,_0x54757c)=>{if(_0x17834a){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x17834a['message']),_0x21875d(_0x17834a);return;}if(!_0x54757c||_0x54757c['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x526a17();return;}const _0x26f342=XLSX['utils']['json_to_sheet'](_0x54757c),_0x54716f=XLSX['utils']['sheet_to_csv'](_0x26f342);try{const {canceled:_0x30ce10,filePath:_0x4b0e17}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x29635e+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x30ce10||!_0x4b0e17){console['log']('Speichern\x20abgebrochen.'),_0x526a17();return;}fs['writeFile'](_0x4b0e17,_0x54716f,'utf8',_0x342454=>{_0x342454?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x342454['message']),_0x21875d(_0x342454)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x4b0e17),_0x526a17());});}catch(_0x4f6c70){console['error']('Fehler\x20im\x20Speicherdialog:',_0x4f6c70),_0x21875d(_0x4f6c70);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x48025a,_0x58f03e)=>{shell['openExternal'](_0x58f03e);});