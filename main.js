const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');function quoteIdent(_0x16641a){if(_0x16641a===undefined||_0x16641a===null)throw new Error('Invalid\x20identifier');const _0x29868e=String(_0x16641a),_0x5fa263=_0x29868e['replace'](/"/g,'\x22\x22');return'\x22'+_0x5fa263+'\x22';}async function extractFirstName(_0x5edd22,_0x379305){try{const _0x89e405=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x379305},'body':JSON['stringify']({'clearname':_0x5edd22})});if(!_0x89e405['ok']){const _0x2a88ba=await _0x89e405['text']();throw new Error(_0x89e405['status']+':\x20'+_0x2a88ba);}const _0x1cdf8f=await _0x89e405['json']();return _0x1cdf8f;}catch(_0x48827e){console['error']('Error\x20in\x20extractFirstName:',_0x48827e);throw _0x48827e;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_ACCOUNT_PRIVAT_LABEL='//span[contains(.,\x20\x27private\x27)]',FOLLOWER_FENSTER='div:has(>\x20div[style=\x22height:\x20auto;\x20overflow:\x20hidden\x20auto;\x22])',FOLLOWER_SEE_ALL_FOLLOWERS_TEXT='//span[contains(.,\x20\x27Only\x27)\x20and\x20contains(.,\x20\x27all\x20followers.\x27)]',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='[style=\x22line-height:\x2018px;\x22]',COM_COMMENTS_BOX_BODY_DIV='div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='//span[contains(.,\x20\x27View\x20all\x27)\x20and\x20contains(.,\x20\x27replies\x27)]',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Message\x27]','div.x9f619.xjbqb8w.x78zum5.x15mokao.x1ga7v0g.x16uus16.xbiv7yw.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div','div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div'],K_OPTIONS_BUTTON=['[aria-label=\x22Options\x22]','section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.x1jfgfrl\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div'],K_EXPAND_MSG_BUTTON='[aria-label=\x22Expand\x22]',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD=['[aria-label=\x22Message\x22]','div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f'],K_SEND_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Send\x27]','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_ALREADY_CHATTED='[aria-label=\x22Like\x22]',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',K_BEITRAG_ARRAY_SELECTOR='._aagv',K_BEITRAG_LIKE_BUTTON='section\x20>\x20span\x20>\x20div\x20>\x20div',K_STORY_ARRAY_SELECTOR='._acaz',K_STORY_LIKE_BUTTON='div.x6s0dn4.x78zum5.x67bb7w\x20>\x20div.x78zum5.xvc5jky\x20>\x20span\x20>\x20div\x20>\x20div',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x117841=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x117841['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x117841['webContents']['openDevTools']();}app['whenReady']()['then'](async()=>{try{await initOptionsDb(),console['log']('[OptionsDB]\x20initialisiert:',path['join'](SqlDataDirectory,'options.db'));}catch(_0x63f47a){console['error']('[OptionsDB]\x20Initialisierung\x20fehlgeschlagen:',_0x63f47a);}})['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x3181cf){var _0x299bfc=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x5eb3bc){console['log']('window\x20id:'+_0x5eb3bc['id']),_0x5eb3bc['id']>0x1&&(_0x299bfc=!![]);}),console['log']('child\x20opened\x20='+_0x299bfc);if(!_0x299bfc){const _0x3ffdb4=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x3ffdb4['loadFile'](_0x3181cf['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));try{optionsDb&&(optionsDb['close'](),optionsDb=null,console['log']('[OptionsDB]\x20geschlossen.'));}catch(_0x5115c2){console['warn']('[OptionsDB]\x20Fehler\x20beim\x20Schließen:',_0x5115c2?.['message']||_0x5115c2);}if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x5a2d54=require('fs'),_0x1e031d=path['join'](app['getPath']('userData'),'data'),_0x1fac88=['campaign.db','crm.db','igaccounts.db'],_0x573785=[];try{_0x5a2d54['mkdirSync'](_0x1e031d,{'recursive':!![]});for(const _0x2d2970 of _0x1fac88){const _0x4b7978=path['join'](process['resourcesPath'],'app','build','data',_0x2d2970),_0x18958b=path['join'](_0x1e031d,_0x2d2970);!_0x5a2d54['existsSync'](_0x18958b)?(_0x5a2d54['copyFileSync'](_0x4b7978,_0x18958b),console['log']('[InitDB]\x20Kopiert\x20'+_0x2d2970+'\x20nach:\x20'+_0x18958b)):console['log']('[InitDB]\x20'+_0x2d2970+'\x20existiert\x20bereits:\x20'+_0x18958b),_0x573785['push'](_0x18958b);}}catch(_0xa7c59b){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0xa7c59b);}return _0x573785;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x26ebe4,AppUpdate:_0x3732a9}=require('electron-updater');_0x26ebe4['autoDownload']=![],_0x26ebe4['autoInstallOnAppQuit']=!![],_0x26ebe4['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x26ebe4['on']('update-available',_0x400fb4=>{console['log']('Update\x20verfügbar:',_0x400fb4),_0x26ebe4['downloadUpdate']();}),_0x26ebe4['on']('update-downloaded',_0x42a5d1=>{console['log']('Update\x20heruntergeladen:',_0x42a5d1),_0x26ebe4['quitAndInstall']();}),_0x26ebe4['on']('error',_0x41ee81=>{console['error']('Fehler\x20beim\x20Updaten:',_0x41ee81);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x1c5b42,AppUpdate:_0x4d1aea}=require('electron-updater');_0x1c5b42['autoDownload']=![],_0x1c5b42['autoInstallOnAppQuit']=!![],_0x1c5b42['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x1c5b42['on']('update-available',_0x4921d8=>{console['log']('Update\x20verfügbar:',_0x4921d8),_0x1c5b42['downloadUpdate']();}),_0x1c5b42['on']('update-downloaded',_0x2f6084=>{console['log']('Update\x20heruntergeladen:',_0x2f6084),console['log']('Neustarten\x20zum\x20Updaten');}),_0x1c5b42['on']('error',_0x17ae05=>{console['error']('Fehler\x20beim\x20Updaten:',_0x17ae05);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let optionsDb,optionsDbPath;function ensureDirSync(_0x3132e1){try{fs_no_promise['mkdirSync'](_0x3132e1,{'recursive':!![]});}catch(_0x1f0957){}}function initOptionsDb(){return new Promise((_0x1623e0,_0x225672)=>{try{ensureDirSync(SqlDataDirectory),optionsDbPath=path['join'](SqlDataDirectory,'options.db'),optionsDb=new sqlite3['Database'](optionsDbPath,_0x55ed09=>{if(_0x55ed09)return _0x225672(_0x55ed09);optionsDb['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20options\x20(key\x20TEXT\x20PRIMARY\x20KEY,\x20value\x20TEXT\x20NOT\x20NULL)',_0x4479ff=>{if(_0x4479ff)return _0x225672(_0x4479ff);optionsDb['run']('INSERT\x20OR\x20IGNORE\x20INTO\x20options\x20(key,\x20value)\x20VALUES\x20(?,\x20?)',['isHeadless','1'],_0x42f6cb=>{if(_0x42f6cb)return _0x225672(_0x42f6cb);_0x1623e0();});});});}catch(_0x17e192){_0x225672(_0x17e192);}});}function setOption(_0x52fb50,_0x33487){return new Promise((_0x30512b,_0x31bfea)=>{if(!optionsDb)return _0x31bfea(new Error('Options-DB\x20nicht\x20initialisiert'));optionsDb['run']('INSERT\x20INTO\x20options\x20(key,\x20value)\x20VALUES\x20(?,\x20?)\x20ON\x20CONFLICT(key)\x20DO\x20UPDATE\x20SET\x20value\x20=\x20excluded.value',[_0x52fb50,String(_0x33487)],_0x24ae38=>{if(_0x24ae38)return _0x31bfea(_0x24ae38);_0x30512b();});});}function getOption(_0x4b0467){return new Promise((_0x3f8790,_0x2a7232)=>{if(!optionsDb)return _0x2a7232(new Error('Options-DB\x20nicht\x20initialisiert'));optionsDb['get']('SELECT\x20value\x20FROM\x20options\x20WHERE\x20key\x20=\x20?',[_0x4b0467],(_0x6a6dbe,_0x516549)=>{if(_0x6a6dbe)return _0x2a7232(_0x6a6dbe);_0x3f8790(_0x516549?_0x516549['value']:null);});});}async function getIsHeadless(){try{const _0x524213=await getOption('isHeadless');if(_0x524213===null||_0x524213===undefined)return!![];if(_0x524213==='1'||_0x524213==='true'||_0x524213===!![])return!![];if(_0x524213==='0'||_0x524213==='false'||_0x524213===![])return![];return console['log']('[OptionsDB]\x20getIsHeadless\x20unerwarteter\x20Wert:',_0x524213),Boolean(_0x524213);}catch(_0x3de6f3){return console['warn']('[OptionsDB]\x20getIsHeadless\x20Fehler,\x20fallback=true:',_0x3de6f3?.['message']||_0x3de6f3),!![];}}function setGlobalDelay(_0x7d3120){return new Promise(async(_0x4daba6,_0x39d91a)=>{try{if(!optionsDb)return _0x39d91a(new Error('Options-DB\x20nicht\x20initialisiert'));const _0x31be00=_0x7d3120===null||_0x7d3120===undefined||_0x7d3120===''?'':String(Number(_0x7d3120));await setOption('zeitabstand_global',_0x31be00),_0x4daba6();}catch(_0x12436a){_0x39d91a(_0x12436a);}});}function getGlobalDelay(){return new Promise(async(_0x2609c7,_0x469ec5)=>{try{if(!optionsDb)return _0x469ec5(new Error('Options-DB\x20nicht\x20initialisiert'));const _0x546c69=await getOption('zeitabstand_global');if(_0x546c69===null||_0x546c69===undefined||_0x546c69==='')return _0x2609c7(null);const _0x5a3b0e=Number(_0x546c69);if(Number['isFinite'](_0x5a3b0e))return _0x2609c7(_0x5a3b0e);optionsDb['get']('SELECT\x20zeitabstand_global\x20FROM\x20options\x20WHERE\x20key\x20=\x20?\x20LIMIT\x201',['__global__'],(_0x2bb0bb,_0x71e756)=>{if(_0x2bb0bb)return _0x469ec5(_0x2bb0bb);if(_0x71e756&&(_0x71e756['zeitabstand_global']||_0x71e756['zeitabstand_global']===0x0)){const _0x543ff5=Number(_0x71e756['zeitabstand_global']);return _0x2609c7(Number['isFinite'](_0x543ff5)?_0x543ff5:null);}return _0x2609c7(null);});}catch(_0x1c9652){_0x469ec5(_0x1c9652);}});}let browser_login=null;async function getBrowserPageLogin(){let _0x3e1bf2='',_0x2ed743=null;if(process['platform']==='darwin')_0x3e1bf2=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x3e1bf2=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x3e1bf2}),_0x2ed743=await browser_login['newPage'](),_0x2ed743['setDefaultNavigationTimeout'](0x3a98),_0x2ed743['setDefaultTimeout'](0x3a98),await _0x2ed743['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x2ed743;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x1a719f=0x1,_0x54bcfb=0x0){try{let _0x581996='',_0x4f80c7=null;const _0x31a00e=await getIsHeadless();if(process['platform']==='darwin')_0x581996=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x581996=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}_0x1a719f===0x0&&!pageStack[_0x54bcfb]&&(browser=await puppeteer['launch']({'headless':_0x31a00e,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x581996}),_0x4f80c7=await browser['newPage'](),_0x4f80c7['setDefaultNavigationTimeout'](0x3a98),_0x4f80c7['setDefaultTimeout'](0x3a98),await _0x4f80c7['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x54bcfb]=_0x4f80c7);(browser===null||pageStack[_0x54bcfb]===null||pageStack[_0x54bcfb]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x31a00e,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x581996}));(pageStack[_0x54bcfb]===null||pageStack[_0x54bcfb]['isClosed']())&&(_0x4f80c7=await browser['newPage'](),_0x4f80c7['setDefaultNavigationTimeout'](0x3a98),_0x4f80c7['setDefaultTimeout'](0x3a98),await _0x4f80c7['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x54bcfb]=_0x4f80c7);try{await pageStack[_0x54bcfb]['evaluate'](()=>!![]);}catch(_0x4f62a5){const _0x2439be=String(_0x4f62a5&&_0x4f62a5['message']?_0x4f62a5['message']:_0x4f62a5),_0x4e77e6=/(detached\s*frame|Session closed|Target closed|Execution context was destroyed|Cannot find context)/i['test'](_0x2439be);if(_0x4e77e6){try{if(pageStack[_0x54bcfb])await pageStack[_0x54bcfb]['close']()['catch'](()=>{});}catch(_0x31112f){}try{if(browser)await browser['close']()['catch'](()=>{});}catch(_0x2cd248){}browser=await puppeteer['launch']({'headless':_0x31a00e,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x581996});const _0x243d05=await browser['newPage']();_0x243d05['setDefaultNavigationTimeout'](0x3a98),_0x243d05['setDefaultTimeout'](0x3a98),await _0x243d05['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x54bcfb]=_0x243d05;}else{try{if(pageStack[_0x54bcfb])await pageStack[_0x54bcfb]['close']()['catch'](()=>{});}catch(_0x404b70){}try{if(browser)await browser['close']()['catch'](()=>{});}catch(_0x5e0ab8){}browser=await puppeteer['launch']({'headless':_0x31a00e,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x581996});const _0x55223f=await browser['newPage']();_0x55223f['setDefaultNavigationTimeout'](0x3a98),_0x55223f['setDefaultTimeout'](0x3a98),await _0x55223f['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x54bcfb]=_0x55223f;}}return pageStack[_0x54bcfb];}catch(_0x563dd4){console['error']('Failed\x20to\x20launch\x20browser:',_0x563dd4);const _0x490633=new Error('Browser\x20konnte\x20nicht\x20gestartet\x20werden.\x20Bitte\x20starte\x20die\x20App\x20neu.\x20:\x20'+_0x563dd4);throw _0x490633;}}ipcMain['on']('login',async(_0x2b4c4c,_0x30c71e)=>{const _0x36aeac=await getBrowserPageLogin();await _0x36aeac['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x36aeac,_0x30c71e),ipcMain['on']('setLoginCookies',async(_0x566642,_0x2505fe)=>{try{await set_login_cookies(_0x36aeac,_0x2505fe);}catch(_0x28dcd1){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x28dcd1);}});}),ipcMain['handle']('set-headless',async(_0x3b06a3,_0x5cee4f)=>{const _0xf21db0=!!_0x5cee4f;if(!optionsDb)try{await initOptionsDb();}catch(_0x2c8dcb){console['error']('[OptionsDB]\x20Init\x20on\x20set-headless\x20fehlgeschlagen:',_0x2c8dcb);}return await setOption('isHeadless',_0xf21db0?'1':'0'),console['log']('[MAIN]\x20isHeadless\x20gesetzt\x20(DB)\x20auf:',_0xf21db0),{'ok':!![],'headless':_0xf21db0};}),ipcMain['handle']('get-headless',async()=>{const _0x4418f9=await getIsHeadless();return{'headless':_0x4418f9};}),ipcMain['handle']('set-global-delay',async(_0x22a8c8,_0x10308)=>{if(!optionsDb)try{await initOptionsDb();}catch(_0x5a7359){console['error']('[OptionsDB]\x20Init\x20on\x20set-global-delay\x20fehlgeschlagen:',_0x5a7359);}return await setGlobalDelay(_0x10308),{'ok':!![]};}),ipcMain['handle']('get-global-delay',async()=>{if(!optionsDb)try{await initOptionsDb();}catch(_0x2ea3ec){console['error']('[OptionsDB]\x20Init\x20on\x20get-global-delay\x20fehlgeschlagen:',_0x2ea3ec);}const _0x17f44b=await getGlobalDelay();return{'value':_0x17f44b};}),ipcMain['on']('export-relation',async(_0x9aba9f,_0x2ebdbc)=>{try{await exportDatabase(_0x2ebdbc),_0x9aba9f['reply']('export-relation-response',{'success':!![]});}catch(_0x154fed){console['error'](_0x154fed),_0x9aba9f['reply']('export-relation-response',{'success':![],'message':_0x154fed['message']});}}),ipcMain['handle']('sendMessage',async(_0x4989d8,_0x4ec571,_0x4b0a57,_0x2dae0c,_0x962b3f,_0x4cb336,_0x1462ce,_0x4f72da,_0x267e08,_0x52fd00,_0x56ef54,_0x5d2bb9,_0x1dd60f)=>{isStopping=![];let _0x3a8489=null;return _0x1462ce?_0x3a8489=await getBrowserPage(_0x962b3f,_0x4f72da):_0x3a8489=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x4ec571),send_message(_0x3a8489,_0x4ec571,_0x4b0a57,_0x2dae0c,_0x962b3f,_0x4cb336,_0x267e08,_0x52fd00,_0x56ef54,_0x5d2bb9,_0x1dd60f);}),ipcMain['handle']('stop-action',async(_0x2cfc16,_0x42a3f7)=>{isStopping=!![];const _0x5be257=await getBrowserPage(0x1,_0x42a3f7);await _0x5be257['close']();}),ipcMain['handle']('fetch_followers',async(_0x3fb6dc,_0x1a66e2,_0x5a4834,_0x23619d,_0x318761,_0x1fbf9e,_0x42873c)=>{isStopping=![];const _0xbc79cd=await getBrowserPage();return fetch_followers_from_account(_0x3fb6dc,_0xbc79cd,_0x1a66e2,_0x5a4834,_0x23619d,_0x318761,_0x1fbf9e,_0x42873c);}),ipcMain['handle']('get-account-details',async(_0x18d4b0,_0x5aa2f9,_0x377285,_0x2c54a5)=>{isStopping=![];const _0x4c0654=await getBrowserPage();return fetch_account_details(_0x4c0654,_0x5aa2f9,_0x377285,_0x2c54a5);}),ipcMain['handle']('fetch_likes',async(_0x4294e1,_0x1de269,_0x3c4f49,_0xc129,_0x53e688,_0x390742,_0x52e3d5)=>{isStopping=![];const _0x2569aa=await getBrowserPage();return fetch_likers_from_post(_0x4294e1,_0x2569aa,_0x1de269,_0x3c4f49,_0xc129,_0x53e688,_0x390742,_0x52e3d5);}),ipcMain['handle']('fetch_comments',async(_0x52a5f1,_0x546be9,_0x23a8e3,_0x3d83f9,_0x5aae18,_0x1abad1,_0x1ede84)=>{isStopping=![];const _0x3ff402=await getBrowserPage();return fetch_comments_from_post(_0x52a5f1,_0x3ff402,_0x546be9,_0x23a8e3,_0x3d83f9,_0x5aae18,_0x1abad1,_0x1ede84);});async function updateAppSilent(){const {spawn:_0x326e24}=require('child_process'),_0x59c4e3=require('path'),_0x17ca92=require('electron-log');return _0x17ca92['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x341e73,_0x12781a)=>{const {updateElectronApp:_0x1a2133,UpdateSourceType:_0x5bb843}=require('update-electron-app');_0x1a2133({'updateSource':{'type':_0x5bb843['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x17ca92}),_0x341e73('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x1f8ec2,_0x21cbf9)=>{doFullElectronUpdateSilent(),_0x1f8ec2('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x5d306b}=require('child_process'),_0x311ece=require('path'),_0x59cc02=require('electron-log');return _0x59cc02['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x465138,_0x479bfd)=>{const {updateElectronApp:_0x550559,UpdateSourceType:_0x4ccfda}=require('update-electron-app');_0x550559({'updateSource':{'type':_0x4ccfda['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x59cc02}),_0x465138('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x5b8cca,_0x17c389)=>{doFullElectronUpdate(),_0x5b8cca('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0x424f8e,_0x20cc5c)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x424f8e('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x5c6e80=path['join'](__dirname,'mac-updater-intern.sh'),_0x4976f3=spawn('/bin/bash',[_0x5c6e80],{'detached':!![],'stdio':'ignore'});_0x4976f3['unref'](),setTimeout(()=>{_0x424f8e('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0x20cc5c(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0x16763b=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x114e29,_0x3ff7ed)=>{console['log']('Update\x20Silent:\x20'+_0x3ff7ed);if(_0x3ff7ed){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0x5b1d66,_0x567b38){return Math['random']()*(_0x567b38-_0x5b1d66+0x1)+_0x5b1d66;}function delay(_0x902ab7,_0x32f727){let _0x52a337=getRnd(_0x902ab7,_0x32f727);return new Promise(function(_0x38012e){setTimeout(_0x38012e,_0x52a337);});}async function scroll(_0x581a9b,_0x3872f6,_0x5e0050=0x2,_0xf3a26f){const _0x2a9992=await _0x581a9b['waitForSelector'](_0x3872f6);for(let _0x501ca6=0x0;_0x501ca6<_0x5e0050;_0x501ca6++){console['log']('Scrolling\x20'+_0x501ca6),await _0x581a9b['evaluate'](_0x3e662c=>{const _0x587adb=document['querySelector'](_0x3e662c);_0x587adb&&_0x587adb['scrollBy'](0x0,0x190);},_0x3872f6),await delay(0x320,0x5dc),_0xf3a26f();}}async function saveCookies(_0x822e02){let _0x3f5ee1=await _0x822e02['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x3f5ee1,null,0x2));}async function notificationClear(_0x4aa8bd){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xfa0,0x1388),await _0x4aa8bd['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x4aa8bd['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x4597cb){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x4597cb);}}async function getTargetProfiles(_0xa9fb51){return new Promise((_0x3143e0,_0x461119)=>{const _0x2ff0a5=quoteIdent(_0xa9fb51);db['all']('SELECT\x20*\x20FROM\x20'+_0x2ff0a5,(_0x436e1d,_0x2bb56d)=>{_0x436e1d?_0x461119(_0x436e1d):_0x3143e0(_0x2bb56d);});});}async function login_legacy(_0x3762fd,_0x1d82a4,_0x2655d9){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x3762fd,_0x1d82a4),await createUserIfNotExists(_0x1d82a4,_0x2655d9);}catch(_0x51c1ef){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x51c1ef);}try{await _0x3762fd['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x3762fd['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x3762fd['click']('button._a9--._ap36._a9_0');}catch(_0x4b5cb7){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x3762fd['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x3762fd['type']('input[name=\x27username\x27]',_0x1d82a4,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x3762fd['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x3762fd['type']('input[name=\x27password\x27]',_0x2655d9,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x3762fd['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x3762fd['click']('button[type=\x27submit\x27]');}catch(_0x46205e){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x3762fd),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x3762fd,_0x1d82a4);}catch(_0x1a6424){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x1a6424);}}catch(_0x290db9){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x290db9);}}async function login(_0x2d0eb8,_0x395069){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x2d0eb8,_0x395069),await createUserIfNotExists(_0x395069);}catch(_0x13baff){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x13baff);}try{await _0x2d0eb8['goto']('https://www.instagram.com/accounts/login/');}catch(_0x30f35a){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x30f35a);}}async function set_login_cookies(_0xbf8f41,_0x1dc523){try{await saveCookiesForUser(_0xbf8f41,_0x1dc523);}catch(_0xbe79f2){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0xbe79f2);}}async function waitForXPath(_0x3d5788,_0x1bbb51,_0x58110f={}){return await _0x3d5788['waitForFunction'](_0x1a3189=>{return document['evaluate'](_0x1a3189,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x58110f,_0x1bbb51),_0x3d5788['evaluateHandle'](_0x4c1915=>document['evaluate'](_0x4c1915,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x1bbb51);}async function waitForSelectorWithFallbacks(_0x4c8f0d,_0x3be085,_0x4a8064={}){!Array['isArray'](_0x3be085)&&(_0x3be085=[_0x3be085]);for(let _0x2283c0=0x0;_0x2283c0<_0x3be085['length'];_0x2283c0++){const _0x1dbd06=_0x3be085[_0x2283c0],_0x32e32b=_0x1dbd06['startsWith']('//')||_0x1dbd06['startsWith']('(//');try{console['log']('Versuche\x20'+(_0x32e32b?'XPath':'Selector')+'\x20'+(_0x2283c0+0x1)+'/'+_0x3be085['length']+':\x20'+_0x1dbd06['substring'](0x0,0x32)+'...');const _0x574ab7=_0x2283c0===0x0?_0x4a8064['timeout']||0x1388:0x7d0;let _0xa66275;if(_0x32e32b){const _0x3ce5c4=await waitForXPath(_0x4c8f0d,_0x1dbd06,{..._0x4a8064,'timeout':_0x574ab7});if(!_0x3ce5c4)throw new Error('XPath-Element\x20nicht\x20gefunden');_0xa66275=_0x3ce5c4;}else _0xa66275=await _0x4c8f0d['waitForSelector'](_0x1dbd06,{..._0x4a8064,'timeout':_0x574ab7});return console['log']((_0x32e32b?'XPath':'Selector')+'\x20'+(_0x2283c0+0x1)+'\x20gefunden!'),_0xa66275;}catch(_0x331bbd){console['log']((_0x32e32b?'XPath':'Selector')+'\x20'+(_0x2283c0+0x1)+'\x20nicht\x20gefunden:\x20'+_0x331bbd['message']);if(_0x2283c0===_0x3be085['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x3be085['length']+'\x20Selektoren/XPath\x20konnte\x20gefunden\x20werden:\x20'+_0x331bbd['message']);}}throw new Error('Keine\x20Selektoren/XPath\x20angegeben');}async function waitForXPathAll(_0x89d4c7,_0x33c04e,_0x4d8957={}){return await _0x89d4c7['waitForFunction'](_0x58a9fa=>{return document['evaluate'](_0x58a9fa,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null)['snapshotLength']>0x0;},_0x4d8957,_0x33c04e),_0x89d4c7['evaluateHandle'](_0x2b9e81=>{const _0x5abea5=document['evaluate'](_0x2b9e81,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null),_0x49fbcd=[];for(let _0x50b159=0x0;_0x50b159<_0x5abea5['snapshotLength'];_0x50b159++){_0x49fbcd['push'](_0x5abea5['snapshotItem'](_0x50b159));}return _0x49fbcd;},_0x33c04e)['then'](_0x5c84e0=>_0x5c84e0['getProperties']());}ipcMain['handle']('check-login',async(_0x531c6f,_0x3de2af)=>{if(pageStack[0x0]){try{await pageStack[0x0]['close']();}catch(_0x521e25){}pageStack[0x0]=null;}if(browser){try{await browser['close']();}catch(_0x497623){}browser=null;}const _0x4e3e43=await getBrowserPage(0x0,0x0),_0x4c99cd=await checkCookiesSession(_0x4e3e43,_0x3de2af);return _0x4c99cd;});async function checkCookiesSession(_0x29df22,_0x5742ba){try{await setCookiesForUser(_0x29df22,_0x5742ba),console['log']('Cookies\x20für\x20'+_0x5742ba+'\x20erfolgreich\x20geladen');}catch(_0x347cb8){return console['error']('Fehler\x20beim\x20Laden\x20der\x20Cookies\x20für\x20'+_0x5742ba+':',_0x347cb8),![];}try{await _0x29df22['goto']('https://www.instagram.com/',{'timeout':0x3a98});}catch(_0x391287){console['error']('Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x391287);}await delay(0x6a4,0x7d0);try{const _0x51962d=await checkLoginStatus(_0x29df22);return console['log']('Login-Status\x20für\x20'+_0x5742ba+':\x20'+_0x51962d),_0x51962d;}catch(_0x1c183b){return console['warn']('Login-Prüfung\x20fehlgeschlagen\x20für\x20'+_0x5742ba+':',_0x1c183b['message']),![];}}async function checkLoginStatus(_0x20b960){const _0x2f373a=['[type=\x22password\x22]','//a[normalize-space(text())=\x27Log\x20In\x27]','//div[@role=\x27button\x27\x20and\x20normalize-space(.)=\x27Log\x20in\x27]','//a[@role=\x27link\x27\x20and\x20normalize-space(.)=\x27Log\x20in\x27]','//h3[normalize-space(text())=\x27Something\x20went\x20wrong\x27]'];let _0xd943a5=null;try{_0xd943a5=await waitForSelectorWithFallbacks(_0x20b960,_0x2f373a,{'timeout':0x7d0});}catch(_0x383a86){return console['log']('Eingeloggt,\x20kein\x20Login\x20notwendig:\x20'+_0x383a86),!![];}if(_0xd943a5){console['log']('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return![];}else return console['log']('Eingeloggt,\x20führe\x20keine\x20Login\x20durch'),!![];}async function checkPageExists(_0x9456d1){const _0x2ffaa9=['//span[contains(normalize-space(.),\x22Sorry,\x20this\x20page\x20isn\x27t\x20available\x22)]'];let _0x544532=null;try{_0x544532=await waitForSelectorWithFallbacks(_0x9456d1,_0x2ffaa9,{'timeout':0x7d0});}catch(_0x266031){return console['log']('Seite\x20existiert:\x20'+_0x266031),!![];}if(_0x544532){console['log']('Angegbene\x20Seite\x20existiert\x20nicht');throw new Error('Angegbene\x20Seite\x20existiert\x20nicht');return![];}else return console['log']('Seite\x20existiert'),!![];}async function likeFirstPost(_0x1b9377){try{const _0x34bbed=await _0x1b9377['$$'](K_BEITRAG_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Posts\x20gefunden:\x20'+_0x34bbed['length']);if(_0x34bbed&&_0x34bbed['length']>0x0){const _0x2a6980=_0x34bbed[0x0];await _0x2a6980['click'](),await delay(0xaf0,0xbb8);const _0x43dffb=await _0x1b9377['evaluate'](()=>{const _0xc83d14=document['querySelector']('section\x20>\x20span\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20svg[aria-label=\x22Like\x22]');return!!_0xc83d14;});if(_0x43dffb){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus');const _0x443398=await _0x1b9377['$$'](K_BEITRAG_LIKE_BUTTON),_0x5d56f7=_0x443398[0x0];await delay(0x514,0x5dc),await _0x1b9377['evaluate'](_0x129765=>{_0x129765['click']();},_0x5d56f7);}else console['log']('Beitrag\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x1b9377['goBack'](),await delay(0x7d0,0x898);}}catch(_0x60a814){console['log']('Fehler\x20beim\x20Liken\x20des\x20ersten\x20Posts:',_0x60a814);throw new Error('Like_Posts:\x20'+_0x60a814);}}async function likeFirstStory(_0xd7a63a){try{const _0xc3204=await _0xd7a63a['$$'](K_STORY_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Stories\x20gefunden:\x20'+_0xc3204['length']);if(_0xc3204&&_0xc3204['length']>0x0){const _0x5cc397=_0xc3204[0x0];await _0x5cc397['click'](),await delay(0xaf0,0xbb8);const _0x4b6cb6=await _0xd7a63a['evaluate'](()=>{const _0x42c8db=document['querySelector']('[aria-label=\x22Like\x22]');return!!_0x42c8db;});if(_0x4b6cb6){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus'),await delay(0x514,0x5dc);try{const _0x54571b=await _0xd7a63a['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0xd7a63a['click'](_0x54571b);}catch(_0x21e781){console['log']('Direkter\x20Klick\x20fehlgeschlagen,\x20versuche\x20alternative\x20Methoden:',_0x21e781);try{const _0x364a19=await _0xd7a63a['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0xd7a63a['evaluateHandle'](_0x283795=>{_0x283795['click']();},_0x364a19);}catch(_0x33de25){console['log']('Evaluatehandle\x20fehlgeschlagen,\x20versuche\x20JS-Click:',_0x33de25),await _0xd7a63a['evaluate'](()=>{const _0x30e355=document['querySelector']('[aria-label=\x22Like\x22]');if(_0x30e355)_0x30e355['click']();else throw new Error('Element\x20nicht\x20gefunden');});}}}else console['log']('Story\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0xd7a63a['goBack'](),await delay(0x7d0,0x898);}}catch(_0x4c49bf){console['log']('Fehler\x20beim\x20Liken\x20der\x20ersten\x20Story:',_0x4c49bf);throw new Error('Like_Storys:\x20'+_0x4c49bf);}}async function send_message(_0x383e95,_0x41498b,_0x4f4022,_0x24f229,_0x1f44f6,_0x422eae,_0x36df96,_0x86399e,_0x473b9f,_0xf0999d,_0x331543){return new Promise(async(_0x3e605f,_0x467159)=>{_0x422eae=_0x422eae['split'](';'),console['log'](_0x422eae[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x1f44f6);if(_0x24f229===null||_0x24f229===undefined){console['log']('Nachricht\x20ist\x20null\x20oder\x20undefined'),_0x467159('Nachricht\x20darf\x20nicht\x20leer\x20sein');return;}try{await setCookiesForUser(_0x383e95,_0x422eae[0x0]);}catch(_0xa8a97c){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0xa8a97c),_0x3e605f({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0xa8a97c});return;}await delay(0x6a4,0x7d0);try{await _0x383e95['goto']('https://www.instagram.com/'+_0x41498b+'/'),await delay(0x1b58,0x1d4c),await notificationClear(_0x383e95);}catch(_0x36f763){_0x3e605f({'status':0x1f5,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x36f763});return;}try{await checkLoginStatus(_0x383e95);}catch(_0x47079a){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x47079a),_0x467159('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return;}if(_0x473b9f==0x1)try{await likeFirstPost(_0x383e95);}catch(_0x3c04be){_0x467159(_0x3c04be);}if(_0xf0999d==0x1)try{await likeFirstStory(_0x383e95);}catch(_0x43d439){_0x467159(_0x43d439);}console['log']('UserSkip:\x20'+_0x36df96);if(_0x36df96==0x1)try{const _0x557245=await _0x383e95['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x221035=>_0x221035['textContent']['trim']());console['log'](_0x557245);if(_0x557245==='Following'||_0x557245==='Folge\x20ich')return _0x3e605f({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x20702b){}await delay(0x6a4,0x7d0);try{const _0x550164=await waitForSelectorWithFallbacks(_0x383e95,K_DIRECT_MSG_BUTTON);await _0x550164['click'](),await delay(0xa8c,0xdac);try{const _0x206cea=await waitForSelectorWithFallbacks(_0x383e95,K_EXPAND_MSG_BUTTON);await _0x206cea['click']();}catch(_0xa7910e){console['log']('Expand-Button\x20nicht\x20gefunden.\x20Überspringen:\x20'+_0xa7910e);}}catch(_0x2e0c1a){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x2e0c1a);try{await delay(0xa8c,0xbb8);try{const _0x2f69d6=await waitForSelectorWithFallbacks(_0x383e95,K_OPTIONS_BUTTON);await _0x2f69d6['click']();}catch(_0x4c7f11){console['log']('Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x4c7f11),_0x3e605f({'status':0x1f6,'message':'Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x4c7f11});return;}await delay(0xa8c,0xbb8);const _0x4b8b50=await waitForXPath(_0x383e95,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x4b8b50['click']();}catch(_0x4e81cf){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x4e81cf),_0x3e605f({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x708,0x7d0),await notificationClear(_0x383e95);}catch(_0x3f0f36){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x3f0f36);}try{await delay(0xaf0,0xdac);const _0x2bc3ff=await waitForSelectorWithFallbacks(_0x383e95,K_CHAT_INPUT_FIELD,{'timeout':0x3a98});if(_0x86399e){const _0x4ceb2e=await _0x383e95['$'](K_ALREADY_CHATTED);if(_0x4ceb2e)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x41498b),_0x3e605f({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x3c737d=await _0x383e95['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x3c737d),_0x24f229=_0x24f229['replace']('{USERNAME}',_0x41498b);let _0x3e7b8a;if(_0x24f229['includes']('{NAME}')||_0x24f229['includes']('{name}'))try{const _0x387ae0=await extractFirstName(_0x3c737d,_0x331543);console['log']('Response\x20Clearname\x20valid:\x20'+_0x387ae0['valid']),_0x387ae0['valid']?(_0x24f229=_0x24f229['replaceAll'](/{NAME}|{name}/g,_0x387ae0['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x387ae0['name']),_0x3e7b8a=_0x387ae0['name']):(_0x24f229=_0x24f229['replaceAll'](/ ?({NAME}|{name})/g,''),_0x3e7b8a='UNKNOWN_NAME');}catch(_0x4f4281){console['log'](_0x4f4281['message']),_0x3e7b8a=_0x4f4281['message'];const _0x12ba12=_0x3c737d?_0x3c737d['replace'](/[^\p{L}\s]/gu,''):'',_0x2d0110=_0x12ba12['split']('\x20')[0x0]||'';_0x2d0110['length']>0x2&&!_0x2d0110['includes']('Instagram')?_0x24f229=_0x24f229['replaceAll'](/{NAME}|{name}/g,_0x2d0110):_0x24f229=_0x24f229['replaceAll'](/ ?({NAME}|{name})/g,'');}console['log']('Nachricht\x20vor\x20dem\x20Senden:\x20'+_0x24f229);const _0x429e2b=_0x24f229['split']('\x0a');await _0x2bc3ff['type'](_0x429e2b[0x0],{'delay':getRnd(0x50,0x78)});for(let _0x529c2c=0x1;_0x529c2c<_0x429e2b['length'];_0x529c2c++){await _0x383e95['keyboard']['down']('Shift'),await _0x383e95['keyboard']['press']('Enter'),await _0x383e95['keyboard']['up']('Shift'),await delay(0x64,0xc8),_0x429e2b[_0x529c2c]['length']>0x0&&await _0x2bc3ff['type'](_0x429e2b[_0x529c2c],{'delay':getRnd(0x50,0x78)});}console['log']('Nachricht\x20mit\x20Zeilenumbrüchen\x20gesendet'),await delay(0x320,0x3e8);try{const _0x5566bb=await waitForSelectorWithFallbacks(_0x383e95,K_SEND_MSG_BUTTON);await _0x5566bb['click']();}catch(_0x22bf37){console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x22bf37),_0x3e605f({'status':0x195,'message':'Send\x20nicht\x20gefunden.\x20Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x41498b+'\x20überspringen.','error':_0x22bf37['message']});}await delay(0x320,0x3e8),_0x3e605f({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x3c737d,'extracted_clearname':_0x3e7b8a});}catch(_0x1ec0ff){let _0x355646=_0x1ec0ff;console['log']('Fehler\x20beim\x20Senden\x20der\x20Nachricht:\x20'+_0x355646),_0x3e605f({'status':0x1f4,'message':'Error\x20500:\x20'+_0x355646});}});}function handle_fail(_0x47a08f){if(isStopping)return new Promise(_0x42b727=>{_0x42b727('Scraper\x20gestoppt.');});else{let _0x50d1d5='';switch(_0x47a08f){case 0x0:_0x50d1d5='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x50d1d5='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x50d1d5='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x50d1d5='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x38b847,_0x124fdd)=>{_0x124fdd(_0x50d1d5);});}}async function fetch_account_details(_0x231d63,_0x1be025,_0x51a0b3,_0x44afb4){try{await setCookiesForUser(_0x231d63,_0x51a0b3['username']);}catch(_0x242f98){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x242f98);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x242f98);return handle_fail(0x0);}_0x231d63['setDefaultNavigationTimeout'](0x7530),await _0x231d63['goto']('https://www.instagram.com/'+_0x1be025+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x231d63);const _0x1e93ed=await _0x231d63['evaluate'](()=>{const _0x2a3046=document['querySelector']('meta[property=\x22og:image\x22]');return _0x2a3046?_0x2a3046['getAttribute']('content'):null;});await _0x231d63['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x427c78=await _0x231d63['evaluate'](()=>{const _0x21fa5f=document['querySelector']('meta[name=\x22description\x22]');if(!_0x21fa5f)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x27d908=_0x21fa5f['getAttribute']('content');if(!_0x27d908)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x27d908);const _0x42bbe3=/\s*[–-]\s*/,_0x654bb6=_0x27d908['split'](_0x42bbe3);if(_0x654bb6['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x31a2bb=_0x654bb6[0x0],_0x22f394=_0x654bb6[0x1],_0x46b509=_0x31a2bb['split'](',\x20');if(_0x46b509['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x28c0d0=_0x46b509[0x0]['split']('\x20')[0x0],_0x302de3=_0x46b509[0x1]['split']('\x20')[0x0],_0x40794c=_0x46b509[0x2]['split']('\x20')[0x0];let _0x46a294='',_0x1e2cb9='';const _0x5e1ac6='\x20on\x20Instagram:\x20',_0x5622c5=_0x22f394['split'](_0x5e1ac6);return _0x46a294=_0x5622c5[0x0]['trim'](),_0x46a294=_0x46a294['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x5622c5['length']>0x1&&(_0x1e2cb9=_0x5622c5[0x1]['trim'](),_0x1e2cb9['startsWith']('\x22')&&_0x1e2cb9['endsWith']('\x22')&&(_0x1e2cb9=_0x1e2cb9['substring'](0x1,_0x1e2cb9['length']-0x1)['trim']()),_0x1e2cb9=_0x1e2cb9['replace'](/&quot;/g,'')['trim']()),{'followers':_0x28c0d0,'following':_0x302de3,'posts':_0x40794c,'nameText':_0x46a294,'bio':_0x1e2cb9};});console['log']('Extracted\x20profile\x20data:',_0x427c78);const _0x1e8318=_0x427c78['nameText'],_0x1fd3cc=_0x1e93ed,_0x3307a5=_0x427c78['bio'],_0x17c161=_0x427c78['followers'],_0x41cf8c=_0x427c78['following'],_0x3b01dc=_0x427c78['posts'],_0x50f8b1=![],_0x11e1ee=![],_0x4ce8a7=![],_0x23a011='\x0a\x20\x20INSERT\x20INTO\x20'+quoteIdent(_0x44afb4)+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x23a011,[_0x1be025,_0x1e8318,_0x1fd3cc,_0x3307a5,_0x17c161,_0x41cf8c,_0x3b01dc,_0x50f8b1,_0x11e1ee,_0x4ce8a7],function(_0x2053d3){_0x2053d3?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x2053d3['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x4335b1,_0x38486d,_0x36a74e,_0x4a3725,_0x2acdd2,_0x2e784e,_0x1179dc,_0x341595){let _0x194474=0x4,_0x2b54fb=0x0,_0xd29413=0x0;try{await setCookiesForUser(_0x38486d,_0x2e784e['username']);}catch(_0x5816bd){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x5816bd);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x5816bd);return handle_fail(0x0);}let _0x513dcf=0x0;try{await _0x38486d['goto']('https://www.instagram.com/'+_0x36a74e+'/'),await notificationClear(_0x38486d);try{await checkLoginStatus(_0x38486d);}catch(_0x1798a1){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x1798a1);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x38486d);}catch(_0x4b744b){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x4b744b);throw new Error('Username\x20nicht\x20gefunden.\x20Existiert\x20der\x20Account?');}let _0x39523f=null;try{_0x39523f=await waitForSelectorWithFallbacks(_0x38486d,FOLLOWER_ACCOUNT_PRIVAT_LABEL,{'timeout':0x1388});if(_0x39523f)throw new Error('Angegebener\x20Account\x20ist\x20privat');}catch(_0x131b29){if(_0x39523f)throw new Error('Angegebener\x20Account\x20ist\x20privat');console['log']('Privat-Label\x20nicht\x20gefunden\x20(fortfahren):\x20'+(_0x131b29?.['message']||_0x131b29));}try{if(_0x4a3725<=0x0){const _0x3b8e40=await _0x38486d['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x588bc4=await _0x38486d['evaluate'](_0x2226ab=>_0x2226ab['innerHTML'],_0x3b8e40);_0x513dcf=Math['ceil'](_0x588bc4/0x4);}else _0x513dcf=Math['ceil'](_0x4a3725/0x4);_0x194474+=_0x513dcf,_0xd29413=Math['round'](++_0x2b54fb/_0x194474*0x64),_0x4335b1['sender']['send']('fetch-progress',_0xd29413,!![]);let _0x3253f0=await _0x38486d['waitForSelector']('a[href=\x22/'+_0x36a74e+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x38486d['evaluate'](_0x1a2a09=>{_0x1a2a09['click']();},_0x3253f0),console['log']('Follower\x20Liste\x20von\x20'+_0x36a74e+'\x20gesichtet'),_0xd29413=Math['round'](++_0x2b54fb/_0x194474*0x64),_0x4335b1['sender']['send']('fetch-progress',_0xd29413,!![]);}catch(_0x4b839a){console['log']('Follower\x20Liste\x20von\x20'+_0x36a74e+'\x20nicht\x20gefunden:'+_0x4b839a);throw new Error('Follower\x20Liste\x20von\x20'+_0x36a74e+'\x20nicht\x20gefunden:'+_0x4b839a);return handle_fail(0x0);}}catch(_0x38086b){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x38086b);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x38086b);return handle_fail(0x0);}let _0x33d637=null;try{_0x33d637=await waitForSelectorWithFallbacks(_0x38486d,FOLLOWER_SEE_ALL_FOLLOWERS_TEXT,{'timeout':0x1388});}catch(_0x14dba3){console['log']('Hinweis-Label\x20(Only\x20see\x20all\x20followers)\x20nicht\x20gefunden:\x20'+_0x14dba3);}try{await delay(0x12c0,0x1388),_0x33d637&&(_0x4335b1['sender']['send']('show-snackbar',{'open':!![],'severity':'info','message':'Nicht\x20alle\x20Follower\x20können\x20bei\x20diesem\x20Account\x20eingesehen\x20werden'}),_0x513dcf>0xa&&(_0x513dcf=0xa));}catch(_0x3ecdf6){console['warn']('Snackbar\x20Sendeversuch\x20fehlgeschlagen:',_0x3ecdf6?.['message']||_0x3ecdf6);}try{await delay(0x12c,0x1f4),console['log']('Auto-scrolls:\x20'+_0x513dcf);try{await scroll(_0x38486d,FOLLOWER_FENSTER,_0x513dcf,_0x1f72de=>{_0xd29413=Math['round'](++_0x2b54fb/_0x194474*0x64),_0x4335b1['sender']['send']('fetch-progress',_0xd29413,!![]);});}catch{console['log']('Fallback\x20div:has\x20ausgelöst'),await scroll(_0x38486d,'div.x6nl9eh.x1a5l9x9.x7vuprf.x1mg3h75.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',_0x513dcf,_0x4801c8=>{});}_0xd29413=Math['round'](++_0x2b54fb/_0x194474*0x64),_0x4335b1['sender']['send']('fetch-progress',_0xd29413,!![]),await _0x38486d['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0xf81e3c=await _0x38486d['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0xbe93c8=await _0x38486d['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0xd29413=Math['round'](++_0x2b54fb/_0x194474*0x64),_0x4335b1['sender']['send']('fetch-progress',_0xd29413,!![]);_0x4a3725<=0x0&&(_0x4a3725=_0xf81e3c['length']);let _0x143ac8=[];for(let _0x19a5ac=0x0;_0x19a5ac<_0xf81e3c['length']&&_0x19a5ac<_0x4a3725;_0x19a5ac++){const _0x4a3ff6=await _0xf81e3c[_0x19a5ac]['evaluate'](_0x41b3f1=>_0x41b3f1['textContent']),_0x41a0ae=await _0xbe93c8[_0x19a5ac]['evaluate'](_0x13a1fa=>_0x13a1fa['textContent']);if(_0x341595){const _0x21989b=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x2e784e['username'],_0x4a3ff6]);if(_0x21989b){console['log']('Skipping\x20already\x20contacted\x20follower:\x20'+_0x4a3ff6);continue;}}_0x143ac8['push'](_0x4a3ff6);const _0x408404='INSERT\x20INTO\x20'+quoteIdent(_0x2acdd2)+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x408404,[_0x4a3ff6,_0x41a0ae],function(_0xe607dd){_0xe607dd?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x2acdd2+'\x27:',_0xe607dd['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0xd29413=Math['round'](++_0x2b54fb/_0x194474*0x64),_0x4335b1['sender']['send']('fetch-progress',_0xd29413,!![]),_0x1179dc&&(_0x4335b1['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x4335b1,_0x38486d,_0x2e784e,_0x2acdd2,_0x143ac8)),_0x33d637&&_0x4335b1['sender']['send']('show-snackbar',{'open':!![],'severity':'info','message':'Nicht\x20alle\x20Follower\x20konnten\x20bei\x20diesem\x20Account\x20eingesehen\x20werden:\x20Es\x20wurden\x20'+_0xf81e3c['length']+'\x20Follower\x20gesammelt'}),new Promise(_0x2a571a=>{_0x2a571a('Scraping\x20finished!');});}catch(_0x40ee13){if(_0x1179dc)throw new Error(_0x40ee13);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x36a74e+'\x20nicht\x20gefunden:\x20'+_0x40ee13);return handle_fail(0x0);}}async function fetch_details_from_list(_0xd79c05,_0xfedaf2,_0x45a884,_0x124e2a,_0x551a07){let _0x2e6ac6=0x0,_0x3b2980=0x0;for(let _0x341877=0x0;_0x341877<_0x551a07['length'];_0x341877++){console['log']('Processing\x20profile:',_0x551a07[_0x341877]);try{await fetch_account_details(_0xfedaf2,_0x551a07[_0x341877],_0x45a884,_0x124e2a);}catch(_0x30505c){console['error']('Detailed\x20Scraping\x20von:\x20',_0x551a07[_0x341877],_0x30505c);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x551a07[_0x341877]+'\x20'+_0x30505c);}_0x3b2980=Math['round'](++_0x2e6ac6/_0x551a07['length']*0x64),_0xd79c05['sender']['send']('fetch-progress',_0x3b2980,!![],!![]);}}async function fetch_likers_from_post(_0x49c48f,_0x26acd5,_0x1a0c77,_0x3298bf,_0x263f1f,_0x2f42b0,_0x3b3b9d,_0x455c09){let _0x980cf1=0x4,_0x4adc3c=0x0,_0x511c76=0x0;try{await setCookiesForUser(_0x26acd5,_0x2f42b0['username']);}catch(_0x54bec9){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x54bec9);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x54bec9);return handle_fail(0x1);}_0x511c76=Math['round'](++_0x4adc3c/_0x980cf1*0x64),_0x49c48f['sender']['send']('fetch-progress',_0x511c76,!![]);try{let _0xcaaf58=_0x1a0c77['substring'](0x0,_0x1a0c77['lastIndexOf']('/'));_0xcaaf58['includes']('/reel/')&&(_0xcaaf58=_0xcaaf58['replace']('/reel/','/p/'));let _0x1b24b0=_0xcaaf58+'/liked_by';console['log'](_0x1b24b0),await _0x26acd5['goto'](_0x1b24b0),await delay(0x7d0,0xfa0),await notificationClear(_0x26acd5),await delay(0xc8,0x1f4);try{await checkLoginStatus(_0x26acd5);}catch(_0x49da70){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x49da70);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x26acd5);}catch(_0x299d2b){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x299d2b);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}_0x511c76=Math['round'](++_0x4adc3c/_0x980cf1*0x64),_0x49c48f['sender']['send']('fetch-progress',_0x511c76,!![]),await _0x26acd5['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0xe62498=await _0x26acd5['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x1375f7=await _0x26acd5['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0xe62498['length']);let _0x37e00c=path['join'](__dirname,'/likers.csv');_0x511c76=Math['round'](++_0x4adc3c/_0x980cf1*0x64),_0x49c48f['sender']['send']('fetch-progress',_0x511c76,!![]);_0x3298bf<=0x0&&(_0x3298bf=_0xe62498['length']);try{let _0x1fec4a=[];for(let _0x4ce191=0x0;_0x4ce191<_0xe62498['length']&&_0x4ce191<_0x3298bf;_0x4ce191++){const _0x37f549=await _0xe62498[_0x4ce191]['evaluate'](_0x1ebcef=>_0x1ebcef['textContent']),_0x53cf49=await _0x1375f7[_0x4ce191]['evaluate'](_0x49175c=>_0x49175c['textContent']);if(_0x455c09){const _0x1ac1ef=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x2f42b0['username'],_0x37f549]);if(_0x1ac1ef){console['log']('Skipping\x20already\x20contacted\x20liker:\x20'+_0x37f549);continue;}}_0x1fec4a['push'](_0x37f549);const _0x455ae0='INSERT\x20INTO\x20'+quoteIdent(_0x263f1f)+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x455ae0,[_0x37f549,_0x53cf49],function(_0x5eceaf){_0x5eceaf?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x263f1f+'\x27:',_0x5eceaf['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x511c76=Math['round'](++_0x4adc3c/_0x980cf1*0x64),_0x49c48f['sender']['send']('fetch-progress',_0x511c76,!![]),_0x3b3b9d&&(_0x49c48f['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x49c48f,_0x26acd5,_0x2f42b0,_0x263f1f,_0x1fec4a)),new Promise(_0x483983=>{_0x483983('Scraping\x20finished!');});}catch(_0x2f6316){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x2f6316);return handle_fail(0x1);}}catch(_0x497cd1){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x497cd1);throw new Error('Like-Seite\x20nicht\x20geöffnet:\x20'+_0x497cd1);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x1935d3,_0x32d4f9,_0x23bcc3,_0x4a6305,_0x15d041,_0x219634,_0xe7c54f,_0x3e5407){let _0x11e7e6=0x3,_0x53ee31=0x0,_0x458b82=0x0;try{await setCookiesForUser(_0x32d4f9,_0x219634['username']);}catch(_0x5a21ef){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x5a21ef);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x5a21ef);return handle_fail(0x2);}try{console['log'](_0x23bcc3),await _0x32d4f9['goto'](_0x23bcc3),await delay(0x7d0,0xfa0),await notificationClear(_0x32d4f9),await delay(0xc8,0x1f4);const _0xf2bf7e=COM_COMMENTS_BOX_BODY_DIV;try{await checkLoginStatus(_0x32d4f9);}catch(_0x5a52f1){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x5a52f1);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x32d4f9);}catch(_0x14415e){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x14415e);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}let _0x50005e;const _0x65ca6e=await _0x32d4f9['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x10f203=await _0x32d4f9['evaluate'](_0x49603c=>_0x49603c['innerHTML'],_0x65ca6e),_0x1bc1c2=String(_0x10f203)['replace'](/[^0-9]/g,''),_0x3d695f=Number(_0x1bc1c2)/0x14;_0x4a6305<=0x0?_0x50005e=Math['ceil'](_0x3d695f/0x3):_0x50005e=Math['ceil'](_0x4a6305/0x3);_0x11e7e6+=_0x50005e,_0x458b82=Math['round'](++_0x53ee31/_0x11e7e6*0x64),_0x1935d3['sender']['send']('fetch-progress',_0x458b82,!![]),console['log']('Auto-scrolls:\x20'+_0x50005e),await scroll(_0x32d4f9,_0xf2bf7e,_0x50005e,_0x56e81c=>{_0x458b82=Math['round'](++_0x53ee31/_0x11e7e6*0x64),_0x1935d3['sender']['send']('fetch-progress',_0x458b82,!![]);});try{const _0x5001f5=COM_REPLY_BUTTON_SPAN,_0x191180=await waitForXPathAll(_0x32d4f9,_0x5001f5);console['log']('Reply-Buttons\x20gefunden:\x20ANZAHL:\x20'+_0x191180['size']),await delay(0x1f4,0x320);let _0x49db7d=_0x191180['size'],_0x39efbd=[];for(const [_0xf12ff7,_0xdc65b8]of _0x191180){_0x39efbd['push'](_0xdc65b8);}console['log']('Alle\x20Reply-Buttons:',_0x39efbd['length']);try{for(let _0x33d34e=0x0;_0x33d34e<_0x49db7d;_0x33d34e++){await _0x39efbd[_0x33d34e]['click'](),await delay(0x320,0x5dc);}}catch(_0x33fd4f){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x33fd4f);throw new Error('Nicht\x20auf\x20Replies\x20geklickt:\x20'+_0x33fd4f);return handle_fail(0x2);}}catch(_0x42ffce){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x2be5e8=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x32d4f9['waitForSelector'](_0x2be5e8),await delay(0x1f4,0x320),_0x458b82=Math['round'](++_0x53ee31/_0x11e7e6*0x64),_0x1935d3['sender']['send']('fetch-progress',_0x458b82,!![]);const _0x4a0b66=await _0x32d4f9['$$'](_0x2be5e8);let _0x3801ec=path['join'](__dirname,'/comments.csv');_0x4a6305<=0x0&&(_0x4a6305=_0x4a0b66['length']);console['log']('fetch_limit:\x20'+_0x4a6305),console['log']('comments_len:\x20'+_0x4a0b66['length']),_0x4a6305++;try{let _0x480dc1=[];for(let _0x41631f=0x1;_0x41631f<_0x4a0b66['length']&&_0x41631f<_0x4a6305;_0x41631f++){const _0x530599=await _0x4a0b66[_0x41631f]['evaluate'](_0x17328a=>_0x17328a['textContent']);if(_0x3e5407){const _0x457323=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x219634['username'],_0x530599]);if(_0x457323){console['log']('Skipping\x20already\x20contacted\x20commenter:\x20'+_0x530599);continue;}}try{_0x480dc1['push'](_0x530599);const _0x287b6a='INSERT\x20INTO\x20'+quoteIdent(_0x15d041)+'\x20(username)\x20VALUES\x20(?)';db['run'](_0x287b6a,[_0x530599],function(_0x215ec8){_0x215ec8&&console['log']('error\x20in\x20add-user:'+_0x215ec8);});}catch(_0x47db79){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x41631f+'\x20:\x20'+_0x47db79);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x41631f+'\x20:\x20'+_0x47db79);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x458b82=Math['round'](++_0x53ee31/_0x11e7e6*0x64),_0x1935d3['sender']['send']('fetch-progress',_0x458b82,!![]),_0x1935d3['sender']['send']('fetch-progress',0x64,!![]),_0xe7c54f&&(_0x1935d3['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x1935d3,_0x32d4f9,_0x219634,_0x15d041,_0x480dc1)),_0x1935d3['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x4fadd3=>{_0x4fadd3('Scraping\x20finished!');});}catch(_0x28e5cd){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x28e5cd);return handle_fail(0x2);}}catch(_0x123a13){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x123a13);throw new Error('Comments-Seite\x20nicht\x20geöffnet:\x20'+_0x123a13);return handle_fail(0x2);}}async function set_clearname_from_username(_0x50756c,_0x445270,_0x2af606=null){try{let _0x4c8792,_0x1ce505;const _0x14af60='SELECT\x20username\x20FROM\x20'+quoteIdent(_0x445270)+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x14af60,[],(_0x4d4f22,_0x4680b7)=>{_0x4d4f22&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x4d4f22['message']),_0x4680b7['length']===0x0&&(_0x1ce505=_0x4680b7['length']),_0x4c8792=_0x4680b7['map'](_0x352584=>_0x352584['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x1ce505);if(_0x1ce505===0x0){console['log']('Leave');return;}const _0x12f9e8=await _0x50756c['waitForSelector'](IG_SEARCH_BUTTON);await _0x12f9e8['click'](),await delay(0x4b0,0x7d0);for(let _0x27bc51 of _0x4c8792){const _0x2f49c0=await _0x50756c['waitForSelector'](IG_SEARCH_INPUT);await _0x2f49c0['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x50756c['type'](IG_SEARCH_INPUT,_0x27bc51,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x405e8a=0x1;while(_0x405e8a!=0x14){console['log']('Schleife');try{let _0xc3a195=IG_NAME_SPAN_PART1+_0x405e8a+IG_USERNAME_SPAN_PART2;const _0x172d20=await _0x50756c['waitForSelector'](_0xc3a195),_0x37e0d8=await _0x50756c['evaluate'](_0x24ce81=>_0x24ce81['innerHTML'],_0x172d20);await delay(0xc8,0x1f4);if(_0x37e0d8==_0x27bc51){let _0x32de01=IG_NAME_SPAN_PART1+_0x405e8a+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0xb49470=await _0x50756c['waitForSelector'](_0x32de01);let _0x2c007f=await _0x50756c['evaluate'](_0x1b1d55=>_0x1b1d55['innerHTML'],_0xb49470);const _0x469407=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x3614b5=_0x2c007f['match'](_0x469407);_0x3614b5?_0x2c007f=_0x3614b5[0x1]['trim']():_0x2c007f=_0x2c007f['trim']();_0x2c007f['includes']('•')&&(_0x2c007f=_0x2c007f['substring'](0x0,_0x2c007f['indexOf']('•')-0x1));const _0x4b31d4='UPDATE\x20'+quoteIdent(_0x445270)+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x4b31d4,[_0x2c007f,_0x37e0d8],function(_0x58b65c){_0x58b65c&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x58b65c['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x405e8a++;}catch(_0xd766f3){const _0x2345bb='UPDATE\x20'+quoteIdent(_0x445270)+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x2345bb,['',_0x27bc51],function(_0x3dbfb7){_0x3dbfb7&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x3dbfb7['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0xd766f3);break;}}_0x2af606&&_0x2af606();}await _0x12f9e8['click']();}catch(_0x7d0157){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x7d0157);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likePost\x20\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likeStory\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likePost\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likeStory\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x1d8d7,_0x2b32e5)=>{const _0xa9927e='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0xa9927e,[],(_0x266e2e,_0x422e0d)=>{_0x266e2e?_0x2b32e5(_0x266e2e):_0x1d8d7(_0x422e0d);});});});const sqlGet=(_0x1782b6,_0x2d5012,_0x29437b=[])=>new Promise((_0x2ddfea,_0x4b444d)=>_0x1782b6['get'](_0x2d5012,_0x29437b,(_0x4f647c,_0x342ebf)=>_0x4f647c?_0x4b444d(_0x4f647c):_0x2ddfea(_0x342ebf))),sqlAll=(_0x4c7272,_0x3f0405,_0x1f02ed=[])=>new Promise((_0x58d261,_0x2d017f)=>_0x4c7272['all'](_0x3f0405,_0x1f02ed,(_0x43a84d,_0x2c092c)=>_0x43a84d?_0x2d017f(_0x43a84d):_0x58d261(_0x2c092c)));ipcMain['handle']('get-campaign-details',async()=>{try{const _0x3fecf5=await sqlAll(campaignDB,'SELECT\x20campaign_name,\x20list_id,\x20zeitabstand,\x20account\x20FROM\x20campaign'),_0x1a0094=await Promise['all'](_0x3fecf5['map'](async _0x42e982=>{const _0x9f744a=[];if(!_0x42e982['list_id'])_0x9f744a['push']('Liste');if(!_0x42e982['zeitabstand'])_0x9f744a['push']('Zeitabstand');if(!_0x42e982['account'])_0x9f744a['push']('Instagram\x20Account');if(_0x42e982['account'])try{const _0x53381b=await sqlGet(igaccountsDB,'SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x42e982['account']]);if(!_0x53381b)_0x9f744a['push']('Instagram\x20Login\x20nicht\x20möglich');else{const _0x1cebfd=_0x53381b['cookie']&&_0x53381b['cookie']['trim']()!==''&&_0x53381b['cookie']['trim']()!=='[]';if(!_0x1cebfd)_0x9f744a['push']('Instagram\x20Login');}}catch(_0x40b4fe){console['error']('Account-Prüfung\x20SQL-Fehler:',_0x40b4fe['message']),_0x9f744a['push']('Instagram\x20Account');}let _0x1ba2ca='N/A',_0x3b93e2='N/A';if(!_0x9f744a['includes']('Liste')){try{const _0x4b2ab9=await sqlGet(db,'SELECT\x20COUNT(*)\x20AS\x20lead_count\x20FROM\x20'+quoteIdent(_0x42e982['list_id']));_0x1ba2ca=_0x4b2ab9?.['lead_count']??0x0;}catch(_0x46d4ef){if(/no such table/i['test'](_0x46d4ef['message']))_0x9f744a['push']('Liste\x20nicht\x20vorhanden');}try{const _0x78a1d4=await sqlGet(campaignDB,'SELECT\x20COUNT(*)\x20AS\x20contacted_count\x20FROM\x20dm\x20WHERE\x20list_id\x20=\x20?',[_0x42e982['list_id']]);_0x3b93e2=_0x78a1d4?.['contacted_count']??0x0;}catch(_0x33e669){}}return{'campaign_name':_0x42e982['campaign_name'],'lead_count':_0x1ba2ca,'contacted_count':_0x3b93e2,'status':_0x9f744a['length']===0x0?'Positiv':'Fehler:\x20'+_0x9f744a['join'](',\x20')};}));return{'status':'success','campaigns':_0x1a0094};}catch(_0x28433f){return console['error']('get-campaign-details\x20fehlgeschlagen:',_0x28433f['message']),{'status':'error','message':_0x28433f['message']};}}),ipcMain['handle']('get-campaign-writer-information',async(_0x2c7a11,_0x36230f)=>{return new Promise((_0x5554b5,_0x2e73c0)=>{const _0x1542ea='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted,\x20likePost,\x20likeStory\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x1542ea,[_0x36230f],(_0x4de2d0,_0x35d531)=>{_0x4de2d0?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x4de2d0),_0x2e73c0(_0x4de2d0)):(console['log']('ROWS'),console['log'](_0x35d531),debugDatabaseContents(),_0x5554b5(_0x35d531));});});});const showTableContents=_0x456559=>{return new Promise((_0x39a18d,_0x3a7f5a)=>{const _0x48649e='SELECT\x20*\x20FROM\x20'+quoteIdent(_0x456559)+';';campaignDB['all'](_0x48649e,(_0x58d84b,_0x8eb2c1)=>{_0x58d84b?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x456559+':',_0x58d84b),_0x3a7f5a(_0x58d84b)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x456559+':',_0x8eb2c1),_0x39a18d({'status':'success','message':_0x8eb2c1}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x92d3db){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x92d3db);}}ipcMain['handle']('create-campaign',async(_0x56dd52,_0x4333bb)=>{return new Promise((_0x20baa3,_0x4e03b7)=>{const _0x1dcdff='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x1dcdff,[String(_0x4333bb)],function(_0x5335fc){_0x5335fc?_0x4e03b7(_0x5335fc):_0x20baa3({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x2321a5,_0x5aaec7)=>{return new Promise((_0x56714a,_0x526d56)=>{const _0x4d9d6c='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x4d9d6c,[_0x5aaec7],function(_0x581001){_0x581001?_0x526d56(_0x581001):_0x56714a({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x443f7a,_0x35de6e,_0x4d3262,_0x4133b6,_0x5d4291,_0x3f0dd7,_0x1f86d3,_0x16c8cf,_0x43b7c2,_0x5e5f4f)=>{const _0x36aaff=await createMessageID(_0x5d4291);return new Promise((_0x2f9007,_0x3bc824)=>{console['log']('ZEITABSTAND:\x20'+_0x4133b6);if(!_0x35de6e||!_0x4d3262||_0x4133b6===undefined||_0x4133b6===null||_0x4133b6===''||!_0x36aaff||!_0x3f0dd7)return _0x3bc824({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x36aaff);const _0x24abbd='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?,\x20likePost\x20=\x20?,\x20likeStory\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x24abbd,[_0x4d3262,_0x4133b6,_0x36aaff,_0x3f0dd7,_0x1f86d3,_0x16c8cf,_0x43b7c2,_0x5e5f4f,_0x35de6e],function(_0x136edc){if(_0x136edc)_0x3bc824({'status':'error','message':_0x136edc['message']});else this['changes']===0x0?_0x3bc824({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x2f9007({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x10cb2a,_0x7153a0,_0xd19a8,_0x369757,_0x4473db)=>{return new Promise((_0x4ab295,_0x3eccb0)=>{const _0x12a6d2='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x12a6d2,[_0x7153a0,_0xd19a8,_0x369757,_0x4473db],function(_0x1e1f57){return _0x1e1f57?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x1e1f57['message']),_0x3eccb0('insert-dm-response',{'success':![],'message':_0x1e1f57['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x4ab295('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x21ffbd=>{return new Promise((_0x3cf9e3,_0x6b4445)=>{const _0xfae693='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0xfae693,[_0x21ffbd],(_0x297952,_0x19a571)=>{if(_0x297952)_0x6b4445({'status':'error','message':_0x297952['message']});else{if(_0x19a571)_0x3cf9e3(_0x19a571['message_id']);else{const _0x172164='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x172164,[_0x21ffbd],function(_0x356f6e){_0x356f6e?_0x6b4445({'status':'error','message':_0x356f6e['message']}):_0x3cf9e3(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x3b5603,_0x2e4bc9)=>{return new Promise((_0x250be8,_0xb10007)=>{const _0x38ce86='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+quoteIdent(_0x2e4bc9);db['get'](_0x38ce86,(_0x4e7fba,_0x112a77)=>{_0x4e7fba?_0xb10007({'status':'error','message':_0x4e7fba['message']}):_0x250be8({'status':'success','count':_0x112a77['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0xb726f7,_0x21f482){try{const _0x25075d=await new Promise((_0x399701,_0x263108)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x21f482],(_0x4a911a,_0x175b41)=>{if(_0x4a911a)_0x263108(_0x4a911a);else{if(_0x175b41['length']>0x0){let _0x12a8e4=JSON['parse'](_0x175b41[0x0]['cookie']);console['log'](_0x12a8e4),_0x399701(_0x12a8e4);}else _0x263108(new Error('User\x20with\x20username\x20'+_0x21f482+'\x20does\x20not\x20exist.'));}});});await _0xb726f7['setCookie'](..._0x25075d),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x30778f){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x30778f);}}async function saveCookiesForUser(_0x31e4cf,_0x4e72f0){try{const _0x5b6176=await _0x31e4cf['cookies']();if(!_0x5b6176||_0x5b6176['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x4e72f0);const _0x37a81a=JSON['stringify'](_0x5b6176);if(_0x37a81a['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x4e72f0);return new Promise((_0x22517f,_0x351082)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x4e72f0],(_0x4ff907,_0x505316)=>{if(_0x4ff907)return console['error']('Error\x20checking\x20user\x20existence:',_0x4ff907),_0x351082(_0x4ff907);if(_0x505316){const _0x353345=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x353345['run'](_0x37a81a,_0x4e72f0,function(_0x5d53ff){return _0x5d53ff?(console['error']('Error\x20updating\x20cookies:',_0x5d53ff),_0x351082(_0x5d53ff)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x4e72f0),_0x22517f());});}else{const _0x5e3ed8=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x5e3ed8['run'](_0x4e72f0,_0x37a81a,function(_0x325dda){return _0x325dda?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x325dda),_0x351082(_0x325dda)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x4e72f0),_0x22517f());});}});});}catch(_0x5a6a53){console['error']('Error\x20fetching\x20cookies:',_0x5a6a53);throw _0x5a6a53;}}async function createUserIfNotExists(_0x44a4b4){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x44a4b4],(_0x2384fc,_0x497a11)=>{if(_0x2384fc){console['error']('Error\x20checking\x20user\x20existence:',_0x2384fc);throw _0x2384fc;}else{if(!_0x497a11){const _0x5f0201=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x5f0201['run'](_0x44a4b4,function(_0x56b8ec){_0x56b8ec?console['error']('Error\x20inserting\x20new\x20user:',_0x56b8ec):console['log']('New\x20user\x20created:',_0x44a4b4);});}else console['log']('User\x20already\x20exists:',_0x44a4b4);}});}catch(_0x17f95a){console['error']('Error\x20creating\x20user:',_0x17f95a);throw _0x17f95a;}}ipcMain['handle']('create-relation',async(_0x400707,_0x23d71a)=>{return new Promise((_0x48bf3b,_0x5b60fc)=>{const _0x4509a0='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+quoteIdent(_0x23d71a)+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x4509a0,function(_0x22cba2){_0x22cba2?_0x5b60fc(_0x22cba2):_0x48bf3b({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x539143,_0x13e499)=>{return console['log']('droping\x20table'+_0x13e499),new Promise((_0x19da8b,_0x352f60)=>{const _0x26ebcd='DROP\x20TABLE\x20IF\x20EXISTS\x20'+quoteIdent(_0x13e499);console['log']('droping\x20table'+_0x13e499),db['run'](_0x26ebcd,function(_0x16cf9a){_0x16cf9a?_0x352f60(_0x16cf9a):_0x19da8b({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x2827f3=>{return new Promise((_0x1221e7,_0x113091)=>{const _0x429027='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x429027,[],(_0x3047d8,_0x51fa16)=>{_0x3047d8?_0x113091(_0x3047d8):_0x1221e7(_0x51fa16['map'](_0xa47d23=>_0xa47d23['name']));});});}),ipcMain['handle']('add-user',async(_0x14407e,_0x46f108,_0x116691)=>{return new Promise(_0x45afa4=>{const _0x3c1f97=db['prepare']('INSERT\x20INTO\x20'+quoteIdent(_0x116691)+'\x20(username)\x20VALUES\x20(?)');_0x3c1f97['run'](_0x46f108,function(_0x21e9b5){_0x21e9b5?console['log']('error\x20in\x20add-user:'+_0x21e9b5):_0x45afa4({'status':'success','id':this['lastID']});}),_0x3c1f97['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x4ce1af,_0x22c5c4)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x375cb9,_0x381e82)=>{if(_0x375cb9)_0x22c5c4(_0x375cb9);else{_0x4ce1af({'status':'success','users':_0x381e82});for(_0x381e82 of _0x381e82){console['log'](_0x381e82['username']);}}});});}),ipcMain['handle']('get-data',async(_0xb74b97,_0x2073bd)=>{return new Promise((_0x10c081,_0x4e0cae)=>{const _0x1fc968='SELECT\x20*\x20FROM\x20'+quoteIdent(_0x2073bd);console['log'](_0x1fc968),db['all'](_0x1fc968,[],(_0x7f01f0,_0x4e2b4a)=>{_0x7f01f0?_0x4e0cae(_0x7f01f0):_0x10c081(_0x4e2b4a);});});}),ipcMain['handle']('get-accounts',async _0x4606e2=>{return new Promise((_0x242f5a,_0x45a792)=>{const _0x564082='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x564082),igaccountsDB['all'](_0x564082,[],(_0x5f52ff,_0x576bc4)=>{_0x5f52ff?_0x45a792(_0x5f52ff):_0x242f5a(_0x576bc4);});});}),ipcMain['handle']('get-targets',async(_0x103677,_0x202812)=>{return getTargetProfiles(_0x202812);}),ipcMain['handle']('delete-user',async(_0x1433f7,_0x1242d7,_0x5864c0)=>{return new Promise((_0x3b552f,_0x3e0407)=>{const _0x513aa3=db['prepare']('DELETE\x20FROM\x20'+quoteIdent(_0x5864c0)+'\x20WHERE\x20username\x20=\x20?');_0x513aa3['run'](_0x1242d7,function(_0x2db1bf){_0x2db1bf?_0x3e0407(_0x2db1bf):_0x3b552f({'status':'success','changes':this['changes']});}),_0x513aa3['finalize']();});}),ipcMain['handle']('delete-account',async(_0x864c41,_0x44e55d)=>{const _0x923d6c=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x923d6c['run'](_0x44e55d,function(_0x1d3549){_0x1d3549&&console['log'](_0x1d3549);}),_0x923d6c['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x4a6082,_0x2cfcb1)=>{const _0x5ae387='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x5ae387,[],(_0x9b36e7,_0x37bdb1)=>{_0x9b36e7?_0x2cfcb1({'status':'error','message':_0x9b36e7['message']}):_0x4a6082({'status':'success','contactedCount':_0x37bdb1['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x2c035e,_0x2eb971)=>{const _0x2c67fb='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x2c67fb,[],(_0x42050a,_0x107197)=>{_0x42050a?_0x2eb971({'status':'error','message':_0x42050a['message']}):_0x2c035e({'status':'success','contactedCount':_0x107197['contactedCount']});});});});function exportDatabase(_0x5e6308){return new Promise((_0x1e3159,_0x5b1a52)=>{const _0x5bab96='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+quoteIdent(_0x5e6308)+'\x0a\x20\x20\x20\x20';db['all'](_0x5bab96,[],async(_0x4dbc76,_0x3cece7)=>{if(_0x4dbc76){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x4dbc76['message']),_0x5b1a52(_0x4dbc76);return;}if(!_0x3cece7||_0x3cece7['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x1e3159();return;}const _0x433e81=XLSX['utils']['json_to_sheet'](_0x3cece7),_0x47e65c=XLSX['utils']['sheet_to_csv'](_0x433e81);try{const {canceled:_0x23bc8,filePath:_0x4c5b29}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x5e6308+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x23bc8||!_0x4c5b29){console['log']('Speichern\x20abgebrochen.'),_0x1e3159();return;}fs['writeFile'](_0x4c5b29,_0x47e65c,'utf8',_0x348dc5=>{_0x348dc5?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x348dc5['message']),_0x5b1a52(_0x348dc5)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x4c5b29),_0x1e3159());});}catch(_0x40e03c){console['error']('Fehler\x20im\x20Speicherdialog:',_0x40e03c),_0x5b1a52(_0x40e03c);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x434b5f,_0x568be4)=>{shell['openExternal'](_0x568be4);});