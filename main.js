const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');function quoteIdent(_0x51ce91){if(_0x51ce91===undefined||_0x51ce91===null)throw new Error('Invalid\x20identifier');const _0x171485=String(_0x51ce91),_0x25568a=_0x171485['replace'](/"/g,'\x22\x22');return'\x22'+_0x25568a+'\x22';}async function extractFirstName(_0x486611,_0x37dfb7){try{const _0x1553f7=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x37dfb7},'body':JSON['stringify']({'clearname':_0x486611})});if(!_0x1553f7['ok']){const _0x134298=await _0x1553f7['text']();throw new Error(_0x1553f7['status']+':\x20'+_0x134298);}const _0x4ced3c=await _0x1553f7['json']();return _0x4ced3c;}catch(_0x5b571d){console['error']('Error\x20in\x20extractFirstName:',_0x5b571d);throw _0x5b571d;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div:has(>\x20div[style=\x22height:\x20auto;\x20overflow:\x20hidden\x20auto;\x22])',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='[style=\x22line-height:\x2018px;\x22]',COM_COMMENTS_BOX_BODY_DIV='div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='//span[contains(.,\x20\x27View\x20all\x27)\x20and\x20contains(.,\x20\x27replies\x27)]',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Message\x27]','div.x9f619.xjbqb8w.x78zum5.x15mokao.x1ga7v0g.x16uus16.xbiv7yw.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div','div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div'],K_OPTIONS_BUTTON=['[aria-label=\x22Options\x22]','section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.x1jfgfrl\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div'],K_EXPAND_MSG_BUTTON='[aria-label=\x22Expand\x22]',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD=['[aria-label=\x22Message\x22]','div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f'],K_SEND_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Send\x27]','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_ALREADY_CHATTED='[aria-label=\x22Like\x22]',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',K_BEITRAG_ARRAY_SELECTOR='._aagv',K_BEITRAG_LIKE_BUTTON='section\x20>\x20span\x20>\x20div\x20>\x20div',K_STORY_ARRAY_SELECTOR='._acaz',K_STORY_LIKE_BUTTON='div.x6s0dn4.x78zum5.x67bb7w\x20>\x20div.x78zum5.xvc5jky\x20>\x20span\x20>\x20div\x20>\x20div',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x28b354=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x28b354['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x28b354['webContents']['openDevTools']();}app['whenReady']()['then'](async()=>{try{await initOptionsDb(),console['log']('[OptionsDB]\x20initialisiert:',path['join'](SqlDataDirectory,'options.db'));}catch(_0x773c93){console['error']('[OptionsDB]\x20Initialisierung\x20fehlgeschlagen:',_0x773c93);}})['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x11e50c){var _0x218dc9=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x3b4eae){console['log']('window\x20id:'+_0x3b4eae['id']),_0x3b4eae['id']>0x1&&(_0x218dc9=!![]);}),console['log']('child\x20opened\x20='+_0x218dc9);if(!_0x218dc9){const _0xd3ea1b=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0xd3ea1b['loadFile'](_0x11e50c['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));try{optionsDb&&(optionsDb['close'](),optionsDb=null,console['log']('[OptionsDB]\x20geschlossen.'));}catch(_0x5e270f){console['warn']('[OptionsDB]\x20Fehler\x20beim\x20Schließen:',_0x5e270f?.['message']||_0x5e270f);}if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x2ace7d=require('fs'),_0x5dd9ce=path['join'](app['getPath']('userData'),'data'),_0x424a00=['campaign.db','crm.db','igaccounts.db'],_0x3a9043=[];try{_0x2ace7d['mkdirSync'](_0x5dd9ce,{'recursive':!![]});for(const _0xefbcb7 of _0x424a00){const _0x5a0f17=path['join'](process['resourcesPath'],'app','build','data',_0xefbcb7),_0x128484=path['join'](_0x5dd9ce,_0xefbcb7);!_0x2ace7d['existsSync'](_0x128484)?(_0x2ace7d['copyFileSync'](_0x5a0f17,_0x128484),console['log']('[InitDB]\x20Kopiert\x20'+_0xefbcb7+'\x20nach:\x20'+_0x128484)):console['log']('[InitDB]\x20'+_0xefbcb7+'\x20existiert\x20bereits:\x20'+_0x128484),_0x3a9043['push'](_0x128484);}}catch(_0x36228e){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x36228e);}return _0x3a9043;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x4f39c0,AppUpdate:_0x556bb8}=require('electron-updater');_0x4f39c0['autoDownload']=![],_0x4f39c0['autoInstallOnAppQuit']=!![],_0x4f39c0['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x4f39c0['on']('update-available',_0x3252f9=>{console['log']('Update\x20verfügbar:',_0x3252f9),_0x4f39c0['downloadUpdate']();}),_0x4f39c0['on']('update-downloaded',_0x5433c2=>{console['log']('Update\x20heruntergeladen:',_0x5433c2),_0x4f39c0['quitAndInstall']();}),_0x4f39c0['on']('error',_0x551645=>{console['error']('Fehler\x20beim\x20Updaten:',_0x551645);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x261ec7,AppUpdate:_0x422b50}=require('electron-updater');_0x261ec7['autoDownload']=![],_0x261ec7['autoInstallOnAppQuit']=!![],_0x261ec7['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x261ec7['on']('update-available',_0x445b8b=>{console['log']('Update\x20verfügbar:',_0x445b8b),_0x261ec7['downloadUpdate']();}),_0x261ec7['on']('update-downloaded',_0x466824=>{console['log']('Update\x20heruntergeladen:',_0x466824),console['log']('Neustarten\x20zum\x20Updaten');}),_0x261ec7['on']('error',_0x27a78f=>{console['error']('Fehler\x20beim\x20Updaten:',_0x27a78f);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let optionsDb,optionsDbPath;function ensureDirSync(_0x146a32){try{fs_no_promise['mkdirSync'](_0x146a32,{'recursive':!![]});}catch(_0x30f31b){}}function initOptionsDb(){return new Promise((_0x34efdb,_0xd4f761)=>{try{ensureDirSync(SqlDataDirectory),optionsDbPath=path['join'](SqlDataDirectory,'options.db'),optionsDb=new sqlite3['Database'](optionsDbPath,_0x7a97e9=>{if(_0x7a97e9)return _0xd4f761(_0x7a97e9);optionsDb['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20options\x20(key\x20TEXT\x20PRIMARY\x20KEY,\x20value\x20TEXT\x20NOT\x20NULL)',_0x23f8f5=>{if(_0x23f8f5)return _0xd4f761(_0x23f8f5);optionsDb['run']('INSERT\x20OR\x20IGNORE\x20INTO\x20options\x20(key,\x20value)\x20VALUES\x20(?,\x20?)',['isHeadless','1'],_0x1b2eaa=>{if(_0x1b2eaa)return _0xd4f761(_0x1b2eaa);_0x34efdb();});});});}catch(_0x46f559){_0xd4f761(_0x46f559);}});}function setOption(_0x9085a8,_0x116fcc){return new Promise((_0x2b24ca,_0x72e81d)=>{if(!optionsDb)return _0x72e81d(new Error('Options-DB\x20nicht\x20initialisiert'));optionsDb['run']('INSERT\x20INTO\x20options\x20(key,\x20value)\x20VALUES\x20(?,\x20?)\x20ON\x20CONFLICT(key)\x20DO\x20UPDATE\x20SET\x20value\x20=\x20excluded.value',[_0x9085a8,String(_0x116fcc)],_0x2d7760=>{if(_0x2d7760)return _0x72e81d(_0x2d7760);_0x2b24ca();});});}function getOption(_0x56c412){return new Promise((_0x2b5726,_0x5d46e7)=>{if(!optionsDb)return _0x5d46e7(new Error('Options-DB\x20nicht\x20initialisiert'));optionsDb['get']('SELECT\x20value\x20FROM\x20options\x20WHERE\x20key\x20=\x20?',[_0x56c412],(_0x174b95,_0x539b7b)=>{if(_0x174b95)return _0x5d46e7(_0x174b95);_0x2b5726(_0x539b7b?_0x539b7b['value']:null);});});}async function getIsHeadless(){try{const _0x370133=await getOption('isHeadless');if(_0x370133===null||_0x370133===undefined)return!![];if(_0x370133==='1'||_0x370133==='true'||_0x370133===!![])return!![];if(_0x370133==='0'||_0x370133==='false'||_0x370133===![])return![];return console['log']('[OptionsDB]\x20getIsHeadless\x20unerwarteter\x20Wert:',_0x370133),Boolean(_0x370133);}catch(_0x4c7c1a){return console['warn']('[OptionsDB]\x20getIsHeadless\x20Fehler,\x20fallback=true:',_0x4c7c1a?.['message']||_0x4c7c1a),!![];}}let browser_login=null;async function getBrowserPageLogin(){let _0x44ae7e='',_0x524bb6=null;if(process['platform']==='darwin')_0x44ae7e=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x44ae7e=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':await getIsHeadless(),'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x44ae7e}),_0x524bb6=await browser_login['newPage'](),_0x524bb6['setDefaultNavigationTimeout'](0x3a98),_0x524bb6['setDefaultTimeout'](0x3a98),await _0x524bb6['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x524bb6;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x34a181=0x1,_0x226714=0x0){try{let _0x537fc3='',_0x5f415a=null;const _0xe5404b=await getIsHeadless();if(process['platform']==='darwin')_0x537fc3=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x537fc3=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x34a181===0x0&&!pageStack[_0x226714])return browser=await puppeteer['launch']({'headless':_0xe5404b,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x537fc3}),_0x5f415a=await browser['newPage'](),_0x5f415a['setDefaultNavigationTimeout'](0x3a98),_0x5f415a['setDefaultTimeout'](0x3a98),await _0x5f415a['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x226714]=_0x5f415a,_0x5f415a;return(browser===null||pageStack[_0x226714]===null||pageStack[_0x226714]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0xe5404b,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x537fc3})),(pageStack[_0x226714]===null||pageStack[_0x226714]['isClosed']())&&(_0x5f415a=await browser['newPage'](),_0x5f415a['setDefaultNavigationTimeout'](0x3a98),_0x5f415a['setDefaultTimeout'](0x3a98),await _0x5f415a['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x226714]=_0x5f415a),pageStack[_0x226714];}catch(_0x5a59db){console['error']('Failed\x20to\x20launch\x20browser:',_0x5a59db);const _0x11bea4=new Error('Browser\x20konnte\x20nicht\x20gestartet\x20werden.\x20Bitte\x20starte\x20die\x20App\x20neu.\x20:\x20'+_0x5a59db);throw _0x11bea4;}}ipcMain['on']('login',async(_0x7af657,_0x488875)=>{const _0x3f6839=await getBrowserPageLogin();await _0x3f6839['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x3f6839,_0x488875),ipcMain['on']('setLoginCookies',async(_0x20089e,_0x1a4719)=>{try{await set_login_cookies(_0x3f6839,_0x1a4719);}catch(_0x5d8021){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x5d8021);}});}),ipcMain['handle']('set-headless',async(_0x192980,_0x1a6c73)=>{const _0x56e84a=!!_0x1a6c73;if(!optionsDb)try{await initOptionsDb();}catch(_0x53f829){console['error']('[OptionsDB]\x20Init\x20on\x20set-headless\x20fehlgeschlagen:',_0x53f829);}return await setOption('isHeadless',_0x56e84a?'1':'0'),console['log']('[MAIN]\x20isHeadless\x20gesetzt\x20(DB)\x20auf:',_0x56e84a),{'ok':!![],'headless':_0x56e84a};}),ipcMain['handle']('get-headless',async()=>{const _0x47a857=await getIsHeadless();return{'headless':_0x47a857};}),ipcMain['on']('export-relation',async(_0x3e6d3d,_0x289ca4)=>{try{await exportDatabase(_0x289ca4),_0x3e6d3d['reply']('export-relation-response',{'success':!![]});}catch(_0x318c02){console['error'](_0x318c02),_0x3e6d3d['reply']('export-relation-response',{'success':![],'message':_0x318c02['message']});}}),ipcMain['handle']('sendMessage',async(_0x15819e,_0x4f870c,_0x4ef253,_0x2eb5d6,_0x5244f1,_0x598bb7,_0x592577,_0x1d8460,_0x9b96f1,_0x16b14d,_0x25475e,_0x2b17ae,_0x15c318)=>{isStopping=![];let _0x25ece0=null;return _0x592577?_0x25ece0=await getBrowserPage(_0x5244f1,_0x1d8460):_0x25ece0=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x4f870c),send_message(_0x25ece0,_0x4f870c,_0x4ef253,_0x2eb5d6,_0x5244f1,_0x598bb7,_0x9b96f1,_0x16b14d,_0x25475e,_0x2b17ae,_0x15c318);}),ipcMain['handle']('stop-action',async(_0x225265,_0x2d589d)=>{isStopping=!![];const _0x151709=await getBrowserPage(0x1,_0x2d589d);await _0x151709['close']();}),ipcMain['handle']('fetch_followers',async(_0x11cf32,_0x503c2c,_0x5d4025,_0x428c65,_0x4d5288,_0xd9ec40,_0x4ebc77)=>{isStopping=![];const _0x15c379=await getBrowserPage();return fetch_followers_from_account(_0x11cf32,_0x15c379,_0x503c2c,_0x5d4025,_0x428c65,_0x4d5288,_0xd9ec40,_0x4ebc77);}),ipcMain['handle']('get-account-details',async(_0xff0443,_0xaac2aa,_0x563fb9,_0xdac701)=>{isStopping=![];const _0x104f8d=await getBrowserPage();return fetch_account_details(_0x104f8d,_0xaac2aa,_0x563fb9,_0xdac701);}),ipcMain['handle']('fetch_likes',async(_0x27f1a9,_0x31e405,_0x52eb42,_0x431caf,_0x31bcee,_0x5ebda5,_0x1997d7)=>{isStopping=![];const _0x1a1636=await getBrowserPage();return fetch_likers_from_post(_0x27f1a9,_0x1a1636,_0x31e405,_0x52eb42,_0x431caf,_0x31bcee,_0x5ebda5,_0x1997d7);}),ipcMain['handle']('fetch_comments',async(_0x4f06eb,_0x522e41,_0x873129,_0x20d5c0,_0x4be4a6,_0x5154b8,_0xaf3384)=>{isStopping=![];const _0x411cc7=await getBrowserPage();return fetch_comments_from_post(_0x4f06eb,_0x411cc7,_0x522e41,_0x873129,_0x20d5c0,_0x4be4a6,_0x5154b8,_0xaf3384);});async function updateAppSilent(){const {spawn:_0x48adea}=require('child_process'),_0x4e1e87=require('path'),_0x583860=require('electron-log');return _0x583860['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x91d9d3,_0x2624bc)=>{const {updateElectronApp:_0x5cc67a,UpdateSourceType:_0xa81dfd}=require('update-electron-app');_0x5cc67a({'updateSource':{'type':_0xa81dfd['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x583860}),_0x91d9d3('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x3240f3,_0x2488a0)=>{doFullElectronUpdateSilent(),_0x3240f3('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x3a6f5b}=require('child_process'),_0x3261aa=require('path'),_0x25fa05=require('electron-log');return _0x25fa05['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x309255,_0x5b10e8)=>{const {updateElectronApp:_0x390e0f,UpdateSourceType:_0x26fe0c}=require('update-electron-app');_0x390e0f({'updateSource':{'type':_0x26fe0c['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x25fa05}),_0x309255('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0xebcd4b,_0xd130ce)=>{doFullElectronUpdate(),_0xebcd4b('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0x188c02,_0x366665)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x188c02('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x3fe180=path['join'](__dirname,'mac-updater-intern.sh'),_0x2dff0a=spawn('/bin/bash',[_0x3fe180],{'detached':!![],'stdio':'ignore'});_0x2dff0a['unref'](),setTimeout(()=>{_0x188c02('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0x366665(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0x6562b6=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x4d2302,_0x5d3337)=>{console['log']('Update\x20Silent:\x20'+_0x5d3337);if(_0x5d3337){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0x1a00dd,_0x377e08){return Math['random']()*(_0x377e08-_0x1a00dd+0x1)+_0x1a00dd;}function delay(_0x49bda5,_0x5dab86){let _0x2964c2=getRnd(_0x49bda5,_0x5dab86);return new Promise(function(_0x3ee980){setTimeout(_0x3ee980,_0x2964c2);});}async function scroll(_0x24c2b3,_0x2db9c4,_0x4244aa=0x2,_0x1b2bdd){const _0x49bc64=await _0x24c2b3['waitForSelector'](_0x2db9c4);for(let _0x227840=0x0;_0x227840<_0x4244aa;_0x227840++){console['log']('Scrolling\x20'+_0x227840),await _0x24c2b3['evaluate'](_0x5a5d09=>{const _0x154b67=document['querySelector'](_0x5a5d09);_0x154b67&&_0x154b67['scrollBy'](0x0,0x190);},_0x2db9c4),await delay(0x320,0x5dc),_0x1b2bdd();}}async function saveCookies(_0x1b8c52){let _0x3771fd=await _0x1b8c52['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x3771fd,null,0x2));}async function notificationClear(_0x5f4569){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xfa0,0x1388),await _0x5f4569['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x5f4569['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x273ebc){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x273ebc);}}async function getTargetProfiles(_0xcba318){return new Promise((_0x289378,_0x1a9a43)=>{const _0x5d09d9=quoteIdent(_0xcba318);db['all']('SELECT\x20*\x20FROM\x20'+_0x5d09d9,(_0x44356f,_0x5b3d34)=>{_0x44356f?_0x1a9a43(_0x44356f):_0x289378(_0x5b3d34);});});}async function login_legacy(_0x46e8b5,_0x1d391e,_0x53d0a6){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x46e8b5,_0x1d391e),await createUserIfNotExists(_0x1d391e,_0x53d0a6);}catch(_0x1e9a5e){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x1e9a5e);}try{await _0x46e8b5['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x46e8b5['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x46e8b5['click']('button._a9--._ap36._a9_0');}catch(_0x15b04f){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x46e8b5['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x46e8b5['type']('input[name=\x27username\x27]',_0x1d391e,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x46e8b5['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x46e8b5['type']('input[name=\x27password\x27]',_0x53d0a6,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x46e8b5['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x46e8b5['click']('button[type=\x27submit\x27]');}catch(_0x37cd34){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x46e8b5),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x46e8b5,_0x1d391e);}catch(_0x3a55e3){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x3a55e3);}}catch(_0x4c161f){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x4c161f);}}async function login(_0x4b34e2,_0x4ce8b4){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x4b34e2,_0x4ce8b4),await createUserIfNotExists(_0x4ce8b4);}catch(_0x410025){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x410025);}try{await _0x4b34e2['goto']('https://www.instagram.com/accounts/login/');}catch(_0x40ae47){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x40ae47);}}async function set_login_cookies(_0x2e417b,_0x2240e0){try{await saveCookiesForUser(_0x2e417b,_0x2240e0);}catch(_0xa724b8){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0xa724b8);}}async function waitForXPath(_0x581783,_0x4cb769,_0x2d4c1a={}){return await _0x581783['waitForFunction'](_0x4f4c20=>{return document['evaluate'](_0x4f4c20,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x2d4c1a,_0x4cb769),_0x581783['evaluateHandle'](_0x12e131=>document['evaluate'](_0x12e131,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x4cb769);}async function waitForSelectorWithFallbacks(_0x53ad5c,_0x4857c3,_0x30709b={}){!Array['isArray'](_0x4857c3)&&(_0x4857c3=[_0x4857c3]);for(let _0x38dd2c=0x0;_0x38dd2c<_0x4857c3['length'];_0x38dd2c++){const _0x5c463b=_0x4857c3[_0x38dd2c],_0x1e4c77=_0x5c463b['startsWith']('//')||_0x5c463b['startsWith']('(//');try{console['log']('Versuche\x20'+(_0x1e4c77?'XPath':'Selector')+'\x20'+(_0x38dd2c+0x1)+'/'+_0x4857c3['length']+':\x20'+_0x5c463b['substring'](0x0,0x32)+'...');const _0x59fb0e=_0x38dd2c===0x0?_0x30709b['timeout']||0x1388:0x7d0;let _0x4672e3;if(_0x1e4c77){const _0x509ccb=await waitForXPath(_0x53ad5c,_0x5c463b,{..._0x30709b,'timeout':_0x59fb0e});if(!_0x509ccb)throw new Error('XPath-Element\x20nicht\x20gefunden');_0x4672e3=_0x509ccb;}else _0x4672e3=await _0x53ad5c['waitForSelector'](_0x5c463b,{..._0x30709b,'timeout':_0x59fb0e});return console['log']((_0x1e4c77?'XPath':'Selector')+'\x20'+(_0x38dd2c+0x1)+'\x20gefunden!'),_0x4672e3;}catch(_0x421159){console['log']((_0x1e4c77?'XPath':'Selector')+'\x20'+(_0x38dd2c+0x1)+'\x20nicht\x20gefunden:\x20'+_0x421159['message']);if(_0x38dd2c===_0x4857c3['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x4857c3['length']+'\x20Selektoren/XPath\x20konnte\x20gefunden\x20werden:\x20'+_0x421159['message']);}}throw new Error('Keine\x20Selektoren/XPath\x20angegeben');}async function waitForXPathAll(_0x511bfd,_0x520570,_0x546e6={}){return await _0x511bfd['waitForFunction'](_0x132e97=>{return document['evaluate'](_0x132e97,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null)['snapshotLength']>0x0;},_0x546e6,_0x520570),_0x511bfd['evaluateHandle'](_0x11ae4b=>{const _0x4af77e=document['evaluate'](_0x11ae4b,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null),_0x52b488=[];for(let _0x5cf72d=0x0;_0x5cf72d<_0x4af77e['snapshotLength'];_0x5cf72d++){_0x52b488['push'](_0x4af77e['snapshotItem'](_0x5cf72d));}return _0x52b488;},_0x520570)['then'](_0x2fe2a5=>_0x2fe2a5['getProperties']());}ipcMain['handle']('check-login',async(_0x43ae06,_0x2e9df7)=>{if(pageStack[0x0]){try{await pageStack[0x0]['close']();}catch(_0x239eb7){}pageStack[0x0]=null;}if(browser){try{await browser['close']();}catch(_0x5fac7c){}browser=null;}const _0x49af06=await getBrowserPage(0x0,0x0),_0x1ac78e=await checkCookiesSession(_0x49af06,_0x2e9df7);return _0x1ac78e;});async function checkCookiesSession(_0x38205c,_0x4365f2){try{await setCookiesForUser(_0x38205c,_0x4365f2),console['log']('Cookies\x20für\x20'+_0x4365f2+'\x20erfolgreich\x20geladen');}catch(_0x20cac5){return console['error']('Fehler\x20beim\x20Laden\x20der\x20Cookies\x20für\x20'+_0x4365f2+':',_0x20cac5),![];}try{await _0x38205c['goto']('https://www.instagram.com/',{'timeout':0x3a98});}catch(_0x25a068){console['error']('Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x25a068);}await delay(0x6a4,0x7d0);try{const _0x1da969=await checkLoginStatus(_0x38205c);return console['log']('Login-Status\x20für\x20'+_0x4365f2+':\x20'+_0x1da969),_0x1da969;}catch(_0x340785){return console['warn']('Login-Prüfung\x20fehlgeschlagen\x20für\x20'+_0x4365f2+':',_0x340785['message']),![];}}async function checkLoginStatus(_0x2a3dbc){const _0x3b6a13=['[type=\x22password\x22]','//a[normalize-space(text())=\x27Log\x20In\x27]','//div[@role=\x27button\x27\x20and\x20normalize-space(.)=\x27Log\x20in\x27]','//h3[normalize-space(text())=\x27Something\x20went\x20wrong\x27]'];let _0x2de5c1=null;try{_0x2de5c1=await waitForSelectorWithFallbacks(_0x2a3dbc,_0x3b6a13,{'timeout':0x7d0});}catch(_0x5b56a7){return console['log']('Eingeloggt,\x20kein\x20Login\x20notwendig:\x20'+_0x5b56a7),!![];}if(_0x2de5c1){console['log']('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return![];}else return console['log']('Eingeloggt,\x20führe\x20keine\x20Login\x20durch'),!![];}async function checkPageExists(_0x582161){const _0x357806=['//span[contains(normalize-space(.),\x22Sorry,\x20this\x20page\x20isn\x27t\x20available\x22)]'];let _0x3e30d9=null;try{_0x3e30d9=await waitForSelectorWithFallbacks(_0x582161,_0x357806,{'timeout':0x7d0});}catch(_0x4ea92e){return console['log']('Seite\x20existiert:\x20'+_0x4ea92e),!![];}if(_0x3e30d9){console['log']('Angegbene\x20Seite\x20existiert\x20nicht');throw new Error('Angegbene\x20Seite\x20existiert\x20nicht');return![];}else return console['log']('Seite\x20existiert'),!![];}async function likeFirstPost(_0x5a9ba3){try{const _0x5abbd2=await _0x5a9ba3['$$'](K_BEITRAG_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Posts\x20gefunden:\x20'+_0x5abbd2['length']);if(_0x5abbd2&&_0x5abbd2['length']>0x0){const _0x5486bb=_0x5abbd2[0x0];await _0x5486bb['click'](),await delay(0xaf0,0xbb8);const _0x87858b=await _0x5a9ba3['evaluate'](()=>{const _0x4e82c1=document['querySelector']('section\x20>\x20span\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20svg[aria-label=\x22Like\x22]');return!!_0x4e82c1;});if(_0x87858b){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus');const _0x2fffc6=await _0x5a9ba3['$$'](K_BEITRAG_LIKE_BUTTON),_0x22dd9d=_0x2fffc6[0x0];await delay(0x514,0x5dc),await _0x5a9ba3['evaluate'](_0x36820d=>{_0x36820d['click']();},_0x22dd9d);}else console['log']('Beitrag\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x5a9ba3['goBack'](),await delay(0x7d0,0x898);}}catch(_0x1a12de){console['log']('Fehler\x20beim\x20Liken\x20des\x20ersten\x20Posts:',_0x1a12de);throw new Error('Like_Posts:\x20'+_0x1a12de);}}async function likeFirstStory(_0x3e7dd0){try{const _0x286511=await _0x3e7dd0['$$'](K_STORY_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Stories\x20gefunden:\x20'+_0x286511['length']);if(_0x286511&&_0x286511['length']>0x0){const _0x1ce268=_0x286511[0x0];await _0x1ce268['click'](),await delay(0xaf0,0xbb8);const _0x4ef6c0=await _0x3e7dd0['evaluate'](()=>{const _0x26b1c4=document['querySelector']('[aria-label=\x22Like\x22]');return!!_0x26b1c4;});if(_0x4ef6c0){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus'),await delay(0x514,0x5dc);try{const _0x3fa1bd=await _0x3e7dd0['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0x3e7dd0['click'](_0x3fa1bd);}catch(_0x40d7d3){console['log']('Direkter\x20Klick\x20fehlgeschlagen,\x20versuche\x20alternative\x20Methoden:',_0x40d7d3);try{const _0x3116c2=await _0x3e7dd0['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0x3e7dd0['evaluateHandle'](_0x308ee4=>{_0x308ee4['click']();},_0x3116c2);}catch(_0x2c5e34){console['log']('Evaluatehandle\x20fehlgeschlagen,\x20versuche\x20JS-Click:',_0x2c5e34),await _0x3e7dd0['evaluate'](()=>{const _0x4ce63b=document['querySelector']('[aria-label=\x22Like\x22]');if(_0x4ce63b)_0x4ce63b['click']();else throw new Error('Element\x20nicht\x20gefunden');});}}}else console['log']('Story\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x3e7dd0['goBack'](),await delay(0x7d0,0x898);}}catch(_0xc047fd){console['log']('Fehler\x20beim\x20Liken\x20der\x20ersten\x20Story:',_0xc047fd);throw new Error('Like_Storys:\x20'+_0xc047fd);}}async function send_message(_0x5b4fc4,_0x5c1461,_0x31ab0a,_0x27b37c,_0x40e25d,_0x158826,_0x144c78,_0x193037,_0x4823d6,_0x2dfca4,_0x36e724){return new Promise(async(_0x3743dd,_0x43de0e)=>{_0x158826=_0x158826['split'](';'),console['log'](_0x158826[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x40e25d);if(_0x27b37c===null||_0x27b37c===undefined){console['log']('Nachricht\x20ist\x20null\x20oder\x20undefined'),_0x43de0e('Nachricht\x20darf\x20nicht\x20leer\x20sein');return;}try{await setCookiesForUser(_0x5b4fc4,_0x158826[0x0]);}catch(_0x4cae80){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x4cae80),_0x3743dd({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x4cae80});return;}await delay(0x6a4,0x7d0);try{await _0x5b4fc4['goto']('https://www.instagram.com/'+_0x5c1461+'/'),await delay(0x1b58,0x1d4c),await notificationClear(_0x5b4fc4);}catch(_0x2efe8){_0x3743dd({'status':0x1f5,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x2efe8});return;}try{await checkLoginStatus(_0x5b4fc4);}catch(_0x30aaa2){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x30aaa2),_0x43de0e('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return;}if(_0x4823d6==0x1)try{await likeFirstPost(_0x5b4fc4);}catch(_0x1c8351){_0x43de0e(_0x1c8351);}if(_0x2dfca4==0x1)try{await likeFirstStory(_0x5b4fc4);}catch(_0xc68978){_0x43de0e(_0xc68978);}console['log']('UserSkip:\x20'+_0x144c78);if(_0x144c78==0x1)try{const _0xb21668=await _0x5b4fc4['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x140e9e=>_0x140e9e['textContent']['trim']());console['log'](_0xb21668);if(_0xb21668==='Following'||_0xb21668==='Folge\x20ich')return _0x3743dd({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x16dac3){}await delay(0x6a4,0x7d0);try{const _0x491790=await waitForSelectorWithFallbacks(_0x5b4fc4,K_DIRECT_MSG_BUTTON);await _0x491790['click'](),await delay(0xa8c,0xdac);try{const _0x801e6d=await waitForSelectorWithFallbacks(_0x5b4fc4,K_EXPAND_MSG_BUTTON);await _0x801e6d['click']();}catch(_0x589b8c){console['log']('Expand-Button\x20nicht\x20gefunden.\x20Überspringen:\x20'+_0x589b8c);}}catch(_0x24a063){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x24a063);try{await delay(0xa8c,0xbb8);try{const _0x5a458c=await waitForSelectorWithFallbacks(_0x5b4fc4,K_OPTIONS_BUTTON);await _0x5a458c['click']();}catch(_0x2e854d){console['log']('Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x2e854d),_0x3743dd({'status':0x1f6,'message':'Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x2e854d});return;}await delay(0xa8c,0xbb8);const _0x4c877a=await waitForXPath(_0x5b4fc4,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x4c877a['click']();}catch(_0x1b78e9){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x1b78e9),_0x3743dd({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x708,0x7d0),await notificationClear(_0x5b4fc4);}catch(_0x47636a){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x47636a);}try{await delay(0xaf0,0xdac);const _0x4b5d36=await waitForSelectorWithFallbacks(_0x5b4fc4,K_CHAT_INPUT_FIELD,{'timeout':0x3a98});if(_0x193037){const _0x4772d8=await _0x5b4fc4['$'](K_ALREADY_CHATTED);if(_0x4772d8)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x5c1461),_0x3743dd({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x4900a5=await _0x5b4fc4['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x4900a5),_0x27b37c=_0x27b37c['replace']('{USERNAME}',_0x5c1461);let _0x11831e;if(_0x27b37c['includes']('{NAME}')||_0x27b37c['includes']('{name}'))try{const _0x3d9d84=await extractFirstName(_0x4900a5,_0x36e724);console['log']('Response\x20Clearname\x20valid:\x20'+_0x3d9d84['valid']),_0x3d9d84['valid']?(_0x27b37c=_0x27b37c['replaceAll'](/{NAME}|{name}/g,_0x3d9d84['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x3d9d84['name']),_0x11831e=_0x3d9d84['name']):(_0x27b37c=_0x27b37c['replaceAll'](/ ?({NAME}|{name})/g,''),_0x11831e='UNKNOWN_NAME');}catch(_0x228dce){console['log'](_0x228dce['message']),_0x11831e=_0x228dce['message'];const _0x277dd0=_0x4900a5?_0x4900a5['replace'](/[^\p{L}\s]/gu,''):'',_0xf8c56c=_0x277dd0['split']('\x20')[0x0]||'';_0xf8c56c['length']>0x2&&!_0xf8c56c['includes']('Instagram')?_0x27b37c=_0x27b37c['replaceAll'](/{NAME}|{name}/g,_0xf8c56c):_0x27b37c=_0x27b37c['replaceAll'](/ ?({NAME}|{name})/g,'');}console['log']('Nachricht\x20vor\x20dem\x20Senden:\x20'+_0x27b37c);const _0x88c13e=_0x27b37c['split']('\x0a');await _0x4b5d36['type'](_0x88c13e[0x0],{'delay':getRnd(0x50,0x78)});for(let _0x1d0166=0x1;_0x1d0166<_0x88c13e['length'];_0x1d0166++){await _0x5b4fc4['keyboard']['down']('Shift'),await _0x5b4fc4['keyboard']['press']('Enter'),await _0x5b4fc4['keyboard']['up']('Shift'),await delay(0x64,0xc8),_0x88c13e[_0x1d0166]['length']>0x0&&await _0x4b5d36['type'](_0x88c13e[_0x1d0166],{'delay':getRnd(0x50,0x78)});}console['log']('Nachricht\x20mit\x20Zeilenumbrüchen\x20gesendet'),await delay(0x320,0x3e8);try{const _0x4afe46=await waitForSelectorWithFallbacks(_0x5b4fc4,K_SEND_MSG_BUTTON);await _0x4afe46['click']();}catch(_0x2804fa){console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x2804fa),_0x3743dd({'status':0x195,'message':'Send\x20nicht\x20gefunden.\x20Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x5c1461+'\x20überspringen.','error':_0x2804fa['message']});}await delay(0x320,0x3e8),_0x3743dd({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x4900a5,'extracted_clearname':_0x11831e});}catch(_0x57d7b1){let _0x32f16e=_0x57d7b1;console['log']('Fehler\x20beim\x20Senden\x20der\x20Nachricht:\x20'+_0x32f16e),_0x3743dd({'status':0x1f4,'message':'Error\x20500:\x20'+_0x32f16e});}});}function handle_fail(_0x567435){if(isStopping)return new Promise(_0xdd680b=>{_0xdd680b('Scraper\x20gestoppt.');});else{let _0x2212d0='';switch(_0x567435){case 0x0:_0x2212d0='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x2212d0='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x2212d0='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x2212d0='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x205176,_0x430061)=>{_0x430061(_0x2212d0);});}}async function fetch_account_details(_0x589bc1,_0x159d8d,_0x20ab06,_0x4af16c){try{await setCookiesForUser(_0x589bc1,_0x20ab06['username']);}catch(_0xe3c301){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0xe3c301);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0xe3c301);return handle_fail(0x0);}_0x589bc1['setDefaultNavigationTimeout'](0x7530),await _0x589bc1['goto']('https://www.instagram.com/'+_0x159d8d+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x589bc1);const _0x2a64fd=await _0x589bc1['evaluate'](()=>{const _0x4d542c=document['querySelector']('meta[property=\x22og:image\x22]');return _0x4d542c?_0x4d542c['getAttribute']('content'):null;});await _0x589bc1['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x4694a0=await _0x589bc1['evaluate'](()=>{const _0x4e8b41=document['querySelector']('meta[name=\x22description\x22]');if(!_0x4e8b41)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x3b2559=_0x4e8b41['getAttribute']('content');if(!_0x3b2559)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x3b2559);const _0x1472af=/\s*[–-]\s*/,_0x53c4f7=_0x3b2559['split'](_0x1472af);if(_0x53c4f7['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x1085c3=_0x53c4f7[0x0],_0x262fc8=_0x53c4f7[0x1],_0x5c7881=_0x1085c3['split'](',\x20');if(_0x5c7881['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x2ea4b2=_0x5c7881[0x0]['split']('\x20')[0x0],_0x58ca6f=_0x5c7881[0x1]['split']('\x20')[0x0],_0x357757=_0x5c7881[0x2]['split']('\x20')[0x0];let _0xbc4321='',_0x4d616e='';const _0x478ddd='\x20on\x20Instagram:\x20',_0xd01b73=_0x262fc8['split'](_0x478ddd);return _0xbc4321=_0xd01b73[0x0]['trim'](),_0xbc4321=_0xbc4321['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0xd01b73['length']>0x1&&(_0x4d616e=_0xd01b73[0x1]['trim'](),_0x4d616e['startsWith']('\x22')&&_0x4d616e['endsWith']('\x22')&&(_0x4d616e=_0x4d616e['substring'](0x1,_0x4d616e['length']-0x1)['trim']()),_0x4d616e=_0x4d616e['replace'](/&quot;/g,'')['trim']()),{'followers':_0x2ea4b2,'following':_0x58ca6f,'posts':_0x357757,'nameText':_0xbc4321,'bio':_0x4d616e};});console['log']('Extracted\x20profile\x20data:',_0x4694a0);const _0x3b5e24=_0x4694a0['nameText'],_0x2fcd46=_0x2a64fd,_0x14029c=_0x4694a0['bio'],_0x273a38=_0x4694a0['followers'],_0xefb205=_0x4694a0['following'],_0x43db29=_0x4694a0['posts'],_0x47a6fd=![],_0x591cdb=![],_0x32429e=![],_0x2476b0='\x0a\x20\x20INSERT\x20INTO\x20'+quoteIdent(_0x4af16c)+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x2476b0,[_0x159d8d,_0x3b5e24,_0x2fcd46,_0x14029c,_0x273a38,_0xefb205,_0x43db29,_0x47a6fd,_0x591cdb,_0x32429e],function(_0x21f277){_0x21f277?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x21f277['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x552cf0,_0x3eeb22,_0x5800ca,_0x1f05fd,_0x4cd21e,_0x10aab4,_0x6f1aa2,_0x1f2b9e){let _0x5dd2cb=0x4,_0x220104=0x0,_0x7267d=0x0;try{await setCookiesForUser(_0x3eeb22,_0x10aab4['username']);}catch(_0x251b69){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x251b69);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x251b69);return handle_fail(0x0);}let _0x3b8ff4=0x0;try{await _0x3eeb22['goto']('https://www.instagram.com/'+_0x5800ca+'/'),await notificationClear(_0x3eeb22);try{await checkLoginStatus(_0x3eeb22);}catch(_0x219a4e){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x219a4e);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x3eeb22);}catch(_0x2caeb0){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x2caeb0);throw new Error('Username\x20nicht\x20gefunden.\x20Existiert\x20der\x20Account?');}try{if(_0x1f05fd<=0x0){const _0x4aa1ef=await _0x3eeb22['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x11347a=await _0x3eeb22['evaluate'](_0x513863=>_0x513863['innerHTML'],_0x4aa1ef);_0x3b8ff4=Math['ceil'](_0x11347a/0x4);}else _0x3b8ff4=Math['ceil'](_0x1f05fd/0x4);_0x5dd2cb+=_0x3b8ff4,_0x7267d=Math['round'](++_0x220104/_0x5dd2cb*0x64),_0x552cf0['sender']['send']('fetch-progress',_0x7267d,!![]);let _0x4e1aef=await _0x3eeb22['waitForSelector']('a[href=\x22/'+_0x5800ca+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x4e1aef['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x5800ca+'\x20gesichtet'),_0x7267d=Math['round'](++_0x220104/_0x5dd2cb*0x64),_0x552cf0['sender']['send']('fetch-progress',_0x7267d,!![]);}catch(_0x4666e2){console['log']('Follower\x20Liste\x20von\x20'+_0x5800ca+'\x20nicht\x20gefunden:'+_0x4666e2);throw new Error('Follower\x20Liste\x20von\x20'+_0x5800ca+'\x20nicht\x20gefunden:'+_0x4666e2);return handle_fail(0x0);}}catch(_0x504ad2){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x504ad2);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x504ad2);return handle_fail(0x0);}try{await delay(0x12c0,0x1388),console['log']('Auto-scrolls:\x20'+_0x3b8ff4);try{await scroll(_0x3eeb22,FOLLOWER_FENSTER,_0x3b8ff4,_0x69ddd6=>{});}catch{console['log']('Fallback\x20div:has\x20ausgelöst'),await scroll(_0x3eeb22,'div.x6nl9eh.x1a5l9x9.x7vuprf.x1mg3h75.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',_0x3b8ff4,_0x21d3ef=>{});}_0x7267d=Math['round'](++_0x220104/_0x5dd2cb*0x64),_0x552cf0['sender']['send']('fetch-progress',_0x7267d,!![]),await _0x3eeb22['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x290d2f=await _0x3eeb22['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x89c317=await _0x3eeb22['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x7267d=Math['round'](++_0x220104/_0x5dd2cb*0x64),_0x552cf0['sender']['send']('fetch-progress',_0x7267d,!![]);_0x1f05fd<=0x0&&(_0x1f05fd=_0x290d2f['length']);let _0x3b439d=[];for(let _0x5cac26=0x0;_0x5cac26<_0x290d2f['length']&&_0x5cac26<_0x1f05fd;_0x5cac26++){const _0x264ae9=await _0x290d2f[_0x5cac26]['evaluate'](_0x8577a7=>_0x8577a7['textContent']),_0x14fe73=await _0x89c317[_0x5cac26]['evaluate'](_0x377059=>_0x377059['textContent']);if(_0x1f2b9e){const _0x55a901=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x10aab4['username'],_0x264ae9]);if(_0x55a901){console['log']('Skipping\x20already\x20contacted\x20follower:\x20'+_0x264ae9);continue;}}_0x3b439d['push'](_0x264ae9);const _0x341fb9='INSERT\x20INTO\x20'+quoteIdent(_0x4cd21e)+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x341fb9,[_0x264ae9,_0x14fe73],function(_0x84fe4b){_0x84fe4b?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x4cd21e+'\x27:',_0x84fe4b['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x7267d=Math['round'](++_0x220104/_0x5dd2cb*0x64),_0x552cf0['sender']['send']('fetch-progress',_0x7267d,!![]),_0x6f1aa2&&(_0x552cf0['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x552cf0,_0x3eeb22,_0x10aab4,_0x4cd21e,_0x3b439d)),new Promise(_0x5724f3=>{_0x5724f3('Scraping\x20finished!');});}catch(_0x389f73){if(_0x6f1aa2)throw new Error(_0x389f73);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x5800ca+'\x20nicht\x20gefunden:\x20'+_0x389f73);return handle_fail(0x0);}}async function fetch_details_from_list(_0x2e4c3c,_0x315626,_0x11d710,_0x2001e0,_0x587cee){let _0x4de629=0x0,_0x44c549=0x0;for(let _0x2474e5=0x0;_0x2474e5<_0x587cee['length'];_0x2474e5++){console['log']('Processing\x20profile:',_0x587cee[_0x2474e5]);try{await fetch_account_details(_0x315626,_0x587cee[_0x2474e5],_0x11d710,_0x2001e0);}catch(_0x5bd7a8){console['error']('Detailed\x20Scraping\x20von:\x20',_0x587cee[_0x2474e5],_0x5bd7a8);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x587cee[_0x2474e5]+'\x20'+_0x5bd7a8);}_0x44c549=Math['round'](++_0x4de629/_0x587cee['length']*0x64),_0x2e4c3c['sender']['send']('fetch-progress',_0x44c549,!![],!![]);}}async function fetch_likers_from_post(_0xc150f0,_0x5a4a69,_0x9c4c51,_0xfbc02a,_0x1ed212,_0x1a0f9d,_0x8debfc,_0x3c0d4d){let _0x5cb084=0x4,_0x1bd930=0x0,_0x226736=0x0;try{await setCookiesForUser(_0x5a4a69,_0x1a0f9d['username']);}catch(_0x19fb4f){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x19fb4f);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x19fb4f);return handle_fail(0x1);}_0x226736=Math['round'](++_0x1bd930/_0x5cb084*0x64),_0xc150f0['sender']['send']('fetch-progress',_0x226736,!![]);try{let _0x354c21=_0x9c4c51['substring'](0x0,_0x9c4c51['lastIndexOf']('/'));_0x354c21['includes']('/reel/')&&(_0x354c21=_0x354c21['replace']('/reel/','/p/'));let _0x2788cc=_0x354c21+'/liked_by';console['log'](_0x2788cc),await _0x5a4a69['goto'](_0x2788cc),await delay(0x7d0,0xfa0),await notificationClear(_0x5a4a69),await delay(0xc8,0x1f4);try{await checkLoginStatus(_0x5a4a69);}catch(_0x442f2b){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x442f2b);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x5a4a69);}catch(_0x4baa6a){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x4baa6a);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}_0x226736=Math['round'](++_0x1bd930/_0x5cb084*0x64),_0xc150f0['sender']['send']('fetch-progress',_0x226736,!![]),await _0x5a4a69['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x41e507=await _0x5a4a69['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x255733=await _0x5a4a69['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x41e507['length']);let _0x1d2623=path['join'](__dirname,'/likers.csv');_0x226736=Math['round'](++_0x1bd930/_0x5cb084*0x64),_0xc150f0['sender']['send']('fetch-progress',_0x226736,!![]);_0xfbc02a<=0x0&&(_0xfbc02a=_0x41e507['length']);try{let _0x2c5023=[];for(let _0x210569=0x0;_0x210569<_0x41e507['length']&&_0x210569<_0xfbc02a;_0x210569++){const _0x5b24ae=await _0x41e507[_0x210569]['evaluate'](_0x4c12e7=>_0x4c12e7['textContent']),_0x557220=await _0x255733[_0x210569]['evaluate'](_0x57ba37=>_0x57ba37['textContent']);if(_0x3c0d4d){const _0x2bf880=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x1a0f9d['username'],_0x5b24ae]);if(_0x2bf880){console['log']('Skipping\x20already\x20contacted\x20liker:\x20'+_0x5b24ae);continue;}}_0x2c5023['push'](_0x5b24ae);const _0x5a6099='INSERT\x20INTO\x20'+quoteIdent(_0x1ed212)+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x5a6099,[_0x5b24ae,_0x557220],function(_0x366ccf){_0x366ccf?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x1ed212+'\x27:',_0x366ccf['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x226736=Math['round'](++_0x1bd930/_0x5cb084*0x64),_0xc150f0['sender']['send']('fetch-progress',_0x226736,!![]),_0x8debfc&&(_0xc150f0['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0xc150f0,_0x5a4a69,_0x1a0f9d,_0x1ed212,_0x2c5023)),new Promise(_0x1b8df2=>{_0x1b8df2('Scraping\x20finished!');});}catch(_0x5bee40){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x5bee40);return handle_fail(0x1);}}catch(_0x3b7915){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x3b7915);throw new Error('Like-Seite\x20nicht\x20geöffnet:\x20'+_0x3b7915);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x2ab9ea,_0x1e21b5,_0x9a317,_0x3c3528,_0x3db587,_0x553097,_0x3489b5,_0x597eb4){let _0x328088=0x3,_0x1726c9=0x0,_0x3312e3=0x0;try{await setCookiesForUser(_0x1e21b5,_0x553097['username']);}catch(_0x116a20){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x116a20);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x116a20);return handle_fail(0x2);}try{console['log'](_0x9a317),await _0x1e21b5['goto'](_0x9a317),await delay(0x7d0,0xfa0),await notificationClear(_0x1e21b5),await delay(0xc8,0x1f4);const _0x396b7b=COM_COMMENTS_BOX_BODY_DIV;try{await checkLoginStatus(_0x1e21b5);}catch(_0x12c740){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x12c740);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x1e21b5);}catch(_0x2ef685){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x2ef685);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}let _0x23a963;const _0x48bc1b=await _0x1e21b5['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x1cbb79=await _0x1e21b5['evaluate'](_0x3dec75=>_0x3dec75['innerHTML'],_0x48bc1b),_0x517dc6=String(_0x1cbb79)['replace'](/[^0-9]/g,''),_0x23df1f=Number(_0x517dc6)/0x14;_0x3c3528<=0x0?_0x23a963=Math['ceil'](_0x23df1f/0x3):_0x23a963=Math['ceil'](_0x3c3528/0x3);_0x328088+=_0x23a963,_0x3312e3=Math['round'](++_0x1726c9/_0x328088*0x64),_0x2ab9ea['sender']['send']('fetch-progress',_0x3312e3,!![]),console['log']('Auto-scrolls:\x20'+_0x23a963),await scroll(_0x1e21b5,_0x396b7b,_0x23a963,_0x36cc6a=>{_0x3312e3=Math['round'](++_0x1726c9/_0x328088*0x64),_0x2ab9ea['sender']['send']('fetch-progress',_0x3312e3,!![]);});try{const _0xb5e422=COM_REPLY_BUTTON_SPAN,_0x5a50a0=await waitForXPathAll(_0x1e21b5,_0xb5e422);console['log']('Reply-Buttons\x20gefunden:\x20ANZAHL:\x20'+_0x5a50a0['size']),await delay(0x1f4,0x320);let _0x5b075b=_0x5a50a0['size'],_0x4b209f=[];for(const [_0xf6292c,_0x289980]of _0x5a50a0){_0x4b209f['push'](_0x289980);}console['log']('Alle\x20Reply-Buttons:',_0x4b209f['length']);try{for(let _0x158ed5=0x0;_0x158ed5<_0x5b075b;_0x158ed5++){await _0x4b209f[_0x158ed5]['click'](),await delay(0x320,0x5dc);}}catch(_0x22435b){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x22435b);throw new Error('Nicht\x20auf\x20Replies\x20geklickt:\x20'+_0x22435b);return handle_fail(0x2);}}catch(_0xb32a88){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x4fa41d=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x1e21b5['waitForSelector'](_0x4fa41d),await delay(0x1f4,0x320),_0x3312e3=Math['round'](++_0x1726c9/_0x328088*0x64),_0x2ab9ea['sender']['send']('fetch-progress',_0x3312e3,!![]);const _0x21e4ed=await _0x1e21b5['$$'](_0x4fa41d);let _0x5809ee=path['join'](__dirname,'/comments.csv');_0x3c3528<=0x0&&(_0x3c3528=_0x21e4ed['length']);console['log']('fetch_limit:\x20'+_0x3c3528),console['log']('comments_len:\x20'+_0x21e4ed['length']),_0x3c3528++;try{let _0x3c7f4c=[];for(let _0x281d5c=0x1;_0x281d5c<_0x21e4ed['length']&&_0x281d5c<_0x3c3528;_0x281d5c++){const _0x145c8b=await _0x21e4ed[_0x281d5c]['evaluate'](_0x1e58f5=>_0x1e58f5['textContent']);if(_0x597eb4){const _0x23d1c9=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x553097['username'],_0x145c8b]);if(_0x23d1c9){console['log']('Skipping\x20already\x20contacted\x20commenter:\x20'+_0x145c8b);continue;}}try{_0x3c7f4c['push'](_0x145c8b);const _0x9bd110='INSERT\x20INTO\x20'+quoteIdent(_0x3db587)+'\x20(username)\x20VALUES\x20(?)';db['run'](_0x9bd110,[_0x145c8b],function(_0x3cbfa2){_0x3cbfa2&&console['log']('error\x20in\x20add-user:'+_0x3cbfa2);});}catch(_0x5172a9){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x281d5c+'\x20:\x20'+_0x5172a9);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x281d5c+'\x20:\x20'+_0x5172a9);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x3312e3=Math['round'](++_0x1726c9/_0x328088*0x64),_0x2ab9ea['sender']['send']('fetch-progress',_0x3312e3,!![]),_0x2ab9ea['sender']['send']('fetch-progress',0x64,!![]),_0x3489b5&&(_0x2ab9ea['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x2ab9ea,_0x1e21b5,_0x553097,_0x3db587,_0x3c7f4c)),_0x2ab9ea['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x1029a1=>{_0x1029a1('Scraping\x20finished!');});}catch(_0x1a3b59){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x1a3b59);return handle_fail(0x2);}}catch(_0x3296d5){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x3296d5);throw new Error('Comments-Seite\x20nicht\x20geöffnet:\x20'+_0x3296d5);return handle_fail(0x2);}}async function set_clearname_from_username(_0xf773b4,_0x41e398,_0x1503b4=null){try{let _0x460929,_0x5768d3;const _0x48f242='SELECT\x20username\x20FROM\x20'+quoteIdent(_0x41e398)+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x48f242,[],(_0x42e7f1,_0x563c47)=>{_0x42e7f1&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x42e7f1['message']),_0x563c47['length']===0x0&&(_0x5768d3=_0x563c47['length']),_0x460929=_0x563c47['map'](_0x5de3b0=>_0x5de3b0['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x5768d3);if(_0x5768d3===0x0){console['log']('Leave');return;}const _0xb9f79d=await _0xf773b4['waitForSelector'](IG_SEARCH_BUTTON);await _0xb9f79d['click'](),await delay(0x4b0,0x7d0);for(let _0x6a60b9 of _0x460929){const _0x3ac29f=await _0xf773b4['waitForSelector'](IG_SEARCH_INPUT);await _0x3ac29f['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0xf773b4['type'](IG_SEARCH_INPUT,_0x6a60b9,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x285db2=0x1;while(_0x285db2!=0x14){console['log']('Schleife');try{let _0x49f37b=IG_NAME_SPAN_PART1+_0x285db2+IG_USERNAME_SPAN_PART2;const _0x283672=await _0xf773b4['waitForSelector'](_0x49f37b),_0x5a8f83=await _0xf773b4['evaluate'](_0xcc2cca=>_0xcc2cca['innerHTML'],_0x283672);await delay(0xc8,0x1f4);if(_0x5a8f83==_0x6a60b9){let _0x30d83b=IG_NAME_SPAN_PART1+_0x285db2+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x548a1d=await _0xf773b4['waitForSelector'](_0x30d83b);let _0x297dee=await _0xf773b4['evaluate'](_0x5dc66a=>_0x5dc66a['innerHTML'],_0x548a1d);const _0x8e804d=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x2a1530=_0x297dee['match'](_0x8e804d);_0x2a1530?_0x297dee=_0x2a1530[0x1]['trim']():_0x297dee=_0x297dee['trim']();_0x297dee['includes']('•')&&(_0x297dee=_0x297dee['substring'](0x0,_0x297dee['indexOf']('•')-0x1));const _0x289c7d='UPDATE\x20'+quoteIdent(_0x41e398)+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x289c7d,[_0x297dee,_0x5a8f83],function(_0x39b644){_0x39b644&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x39b644['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x285db2++;}catch(_0x362329){const _0x10c963='UPDATE\x20'+quoteIdent(_0x41e398)+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x10c963,['',_0x6a60b9],function(_0x46c766){_0x46c766&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x46c766['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x362329);break;}}_0x1503b4&&_0x1503b4();}await _0xb9f79d['click']();}catch(_0x4b668f){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x4b668f);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likePost\x20\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likeStory\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likePost\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likeStory\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x389aa5,_0x5337ea)=>{const _0x10b3b2='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x10b3b2,[],(_0x591f23,_0x4982ef)=>{_0x591f23?_0x5337ea(_0x591f23):_0x389aa5(_0x4982ef);});});});const sqlGet=(_0x5dc6bd,_0x3a4052,_0x2079c4=[])=>new Promise((_0x26895e,_0x18a00f)=>_0x5dc6bd['get'](_0x3a4052,_0x2079c4,(_0x281c98,_0x2d2321)=>_0x281c98?_0x18a00f(_0x281c98):_0x26895e(_0x2d2321))),sqlAll=(_0x321f33,_0x49c156,_0x134017=[])=>new Promise((_0x52c5cf,_0x2ec44d)=>_0x321f33['all'](_0x49c156,_0x134017,(_0x29284a,_0x20ad8c)=>_0x29284a?_0x2ec44d(_0x29284a):_0x52c5cf(_0x20ad8c)));ipcMain['handle']('get-campaign-details',async()=>{try{const _0x21f48f=await sqlAll(campaignDB,'SELECT\x20campaign_name,\x20list_id,\x20zeitabstand,\x20account\x20FROM\x20campaign'),_0xb864c1=await Promise['all'](_0x21f48f['map'](async _0x52d2d4=>{const _0x192452=[];if(!_0x52d2d4['list_id'])_0x192452['push']('Liste');if(!_0x52d2d4['zeitabstand'])_0x192452['push']('Zeitabstand');if(!_0x52d2d4['account'])_0x192452['push']('Instagram\x20Account');if(_0x52d2d4['account'])try{const _0xcda52c=await sqlGet(igaccountsDB,'SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x52d2d4['account']]);if(!_0xcda52c)_0x192452['push']('Instagram\x20Login\x20nicht\x20möglich');else{const _0x364bbd=_0xcda52c['cookie']&&_0xcda52c['cookie']['trim']()!==''&&_0xcda52c['cookie']['trim']()!=='[]';if(!_0x364bbd)_0x192452['push']('Instagram\x20Login');}}catch(_0x23fd86){console['error']('Account-Prüfung\x20SQL-Fehler:',_0x23fd86['message']),_0x192452['push']('Instagram\x20Account');}let _0x5be5ed='N/A',_0x3562f2='N/A';if(!_0x192452['includes']('Liste')){try{const _0x137d2e=await sqlGet(db,'SELECT\x20COUNT(*)\x20AS\x20lead_count\x20FROM\x20'+quoteIdent(_0x52d2d4['list_id']));_0x5be5ed=_0x137d2e?.['lead_count']??0x0;}catch(_0x4bc6c1){if(/no such table/i['test'](_0x4bc6c1['message']))_0x192452['push']('Liste\x20nicht\x20vorhanden');}try{const _0x648328=await sqlGet(campaignDB,'SELECT\x20COUNT(*)\x20AS\x20contacted_count\x20FROM\x20dm\x20WHERE\x20list_id\x20=\x20?',[_0x52d2d4['list_id']]);_0x3562f2=_0x648328?.['contacted_count']??0x0;}catch(_0x1f9d95){}}return{'campaign_name':_0x52d2d4['campaign_name'],'lead_count':_0x5be5ed,'contacted_count':_0x3562f2,'status':_0x192452['length']===0x0?'Positiv':'Fehler:\x20'+_0x192452['join'](',\x20')};}));return{'status':'success','campaigns':_0xb864c1};}catch(_0xadd5e4){return console['error']('get-campaign-details\x20fehlgeschlagen:',_0xadd5e4['message']),{'status':'error','message':_0xadd5e4['message']};}}),ipcMain['handle']('get-campaign-writer-information',async(_0x480def,_0x32da56)=>{return new Promise((_0x476ba5,_0x3da418)=>{const _0x1239a5='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted,\x20likePost,\x20likeStory\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x1239a5,[_0x32da56],(_0x421976,_0x366bbf)=>{_0x421976?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x421976),_0x3da418(_0x421976)):(console['log']('ROWS'),console['log'](_0x366bbf),debugDatabaseContents(),_0x476ba5(_0x366bbf));});});});const showTableContents=_0x147bb5=>{return new Promise((_0x2069b1,_0x5db2ab)=>{const _0x478e50='SELECT\x20*\x20FROM\x20'+quoteIdent(_0x147bb5)+';';campaignDB['all'](_0x478e50,(_0x41e840,_0x5e74b4)=>{_0x41e840?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x147bb5+':',_0x41e840),_0x5db2ab(_0x41e840)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x147bb5+':',_0x5e74b4),_0x2069b1({'status':'success','message':_0x5e74b4}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x3b6d5c){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x3b6d5c);}}ipcMain['handle']('create-campaign',async(_0x1d609f,_0x21469d)=>{return new Promise((_0x2a3f51,_0x38c656)=>{const _0xaac77d='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0xaac77d,[String(_0x21469d)],function(_0xb635f3){_0xb635f3?_0x38c656(_0xb635f3):_0x2a3f51({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x3d3813,_0x168a3b)=>{return new Promise((_0x3694ef,_0x3b4b4c)=>{const _0x55cd45='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x55cd45,[_0x168a3b],function(_0x344406){_0x344406?_0x3b4b4c(_0x344406):_0x3694ef({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x101ea7,_0x1aaaed,_0x20fd6b,_0xfe65d6,_0x42c624,_0x19ecfe,_0x335a49,_0xde37d8,_0x8f2469,_0x1d94b3)=>{const _0x1d8ad7=await createMessageID(_0x42c624);return new Promise((_0x54e312,_0x199acf)=>{console['log']('ZEITABSTAND:\x20'+_0xfe65d6);if(!_0x1aaaed||!_0x20fd6b||_0xfe65d6===undefined||_0xfe65d6===null||_0xfe65d6===''||!_0x1d8ad7||!_0x19ecfe)return _0x199acf({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x1d8ad7);const _0x483b45='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?,\x20likePost\x20=\x20?,\x20likeStory\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x483b45,[_0x20fd6b,_0xfe65d6,_0x1d8ad7,_0x19ecfe,_0x335a49,_0xde37d8,_0x8f2469,_0x1d94b3,_0x1aaaed],function(_0x5df6cc){if(_0x5df6cc)_0x199acf({'status':'error','message':_0x5df6cc['message']});else this['changes']===0x0?_0x199acf({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x54e312({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x4a71c8,_0x2c51dc,_0xa63c44,_0x1acbc3,_0x383548)=>{return new Promise((_0x5c81c5,_0x4e66c3)=>{const _0x4356c1='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x4356c1,[_0x2c51dc,_0xa63c44,_0x1acbc3,_0x383548],function(_0x8e9006){return _0x8e9006?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x8e9006['message']),_0x4e66c3('insert-dm-response',{'success':![],'message':_0x8e9006['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x5c81c5('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x5e78aa=>{return new Promise((_0x411ad7,_0x143187)=>{const _0x3b20b5='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x3b20b5,[_0x5e78aa],(_0x28b5c3,_0x91d5c7)=>{if(_0x28b5c3)_0x143187({'status':'error','message':_0x28b5c3['message']});else{if(_0x91d5c7)_0x411ad7(_0x91d5c7['message_id']);else{const _0x27757a='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x27757a,[_0x5e78aa],function(_0x1f4267){_0x1f4267?_0x143187({'status':'error','message':_0x1f4267['message']}):_0x411ad7(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x4fc62b,_0x38d814)=>{return new Promise((_0x49370b,_0x25c296)=>{const _0x3a7635='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+quoteIdent(_0x38d814);db['get'](_0x3a7635,(_0x5ac9df,_0x3dda3e)=>{_0x5ac9df?_0x25c296({'status':'error','message':_0x5ac9df['message']}):_0x49370b({'status':'success','count':_0x3dda3e['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x1c2c49,_0x136f7a){try{const _0x5452c0=await new Promise((_0xd6dc64,_0xd14cc6)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x136f7a],(_0x37bd1e,_0x277fa2)=>{if(_0x37bd1e)_0xd14cc6(_0x37bd1e);else{if(_0x277fa2['length']>0x0){let _0x376a48=JSON['parse'](_0x277fa2[0x0]['cookie']);console['log'](_0x376a48),_0xd6dc64(_0x376a48);}else _0xd14cc6(new Error('User\x20with\x20username\x20'+_0x136f7a+'\x20does\x20not\x20exist.'));}});});await _0x1c2c49['setCookie'](..._0x5452c0),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x10521a){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x10521a);}}async function saveCookiesForUser(_0x21e0d2,_0x3c182e){try{const _0x358b6b=await _0x21e0d2['cookies']();if(!_0x358b6b||_0x358b6b['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x3c182e);const _0x32a5f7=JSON['stringify'](_0x358b6b);if(_0x32a5f7['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x3c182e);return new Promise((_0x408fa5,_0x4cd6f3)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x3c182e],(_0x3f1759,_0x37803c)=>{if(_0x3f1759)return console['error']('Error\x20checking\x20user\x20existence:',_0x3f1759),_0x4cd6f3(_0x3f1759);if(_0x37803c){const _0xeff6e5=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0xeff6e5['run'](_0x32a5f7,_0x3c182e,function(_0x26635f){return _0x26635f?(console['error']('Error\x20updating\x20cookies:',_0x26635f),_0x4cd6f3(_0x26635f)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x3c182e),_0x408fa5());});}else{const _0x2a7cf6=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x2a7cf6['run'](_0x3c182e,_0x32a5f7,function(_0x3157dd){return _0x3157dd?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x3157dd),_0x4cd6f3(_0x3157dd)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x3c182e),_0x408fa5());});}});});}catch(_0x4366b2){console['error']('Error\x20fetching\x20cookies:',_0x4366b2);throw _0x4366b2;}}async function createUserIfNotExists(_0x40e781){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x40e781],(_0x20b675,_0x56ed64)=>{if(_0x20b675){console['error']('Error\x20checking\x20user\x20existence:',_0x20b675);throw _0x20b675;}else{if(!_0x56ed64){const _0x4fb0bf=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x4fb0bf['run'](_0x40e781,function(_0x3b00e3){_0x3b00e3?console['error']('Error\x20inserting\x20new\x20user:',_0x3b00e3):console['log']('New\x20user\x20created:',_0x40e781);});}else console['log']('User\x20already\x20exists:',_0x40e781);}});}catch(_0x127963){console['error']('Error\x20creating\x20user:',_0x127963);throw _0x127963;}}ipcMain['handle']('create-relation',async(_0x3e05b7,_0x5b94b4)=>{return new Promise((_0x2d1cb9,_0xe37bd6)=>{const _0xf0b779='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+quoteIdent(_0x5b94b4)+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0xf0b779,function(_0x1af463){_0x1af463?_0xe37bd6(_0x1af463):_0x2d1cb9({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x1b6e10,_0x135430)=>{return console['log']('droping\x20table'+_0x135430),new Promise((_0x3ab5d5,_0x15c1f1)=>{const _0x1cd527='DROP\x20TABLE\x20IF\x20EXISTS\x20'+quoteIdent(_0x135430);console['log']('droping\x20table'+_0x135430),db['run'](_0x1cd527,function(_0x5d8c70){_0x5d8c70?_0x15c1f1(_0x5d8c70):_0x3ab5d5({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x87a845=>{return new Promise((_0x4acf85,_0x59635b)=>{const _0x523e7d='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x523e7d,[],(_0x40b2fe,_0x50d1cd)=>{_0x40b2fe?_0x59635b(_0x40b2fe):_0x4acf85(_0x50d1cd['map'](_0x150fb7=>_0x150fb7['name']));});});}),ipcMain['handle']('add-user',async(_0x3f707,_0x3bfc81,_0x2f04cd)=>{return new Promise(_0x328d1d=>{const _0xdde16f=db['prepare']('INSERT\x20INTO\x20'+quoteIdent(_0x2f04cd)+'\x20(username)\x20VALUES\x20(?)');_0xdde16f['run'](_0x3bfc81,function(_0x175134){_0x175134?console['log']('error\x20in\x20add-user:'+_0x175134):_0x328d1d({'status':'success','id':this['lastID']});}),_0xdde16f['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x25f66a,_0x5004ab)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x5823ec,_0x31bc9c)=>{if(_0x5823ec)_0x5004ab(_0x5823ec);else{_0x25f66a({'status':'success','users':_0x31bc9c});for(_0x31bc9c of _0x31bc9c){console['log'](_0x31bc9c['username']);}}});});}),ipcMain['handle']('get-data',async(_0x330bee,_0x2239c7)=>{return new Promise((_0xf8f573,_0x28bcc4)=>{const _0x566908='SELECT\x20*\x20FROM\x20'+quoteIdent(_0x2239c7);console['log'](_0x566908),db['all'](_0x566908,[],(_0x58ee3c,_0x311307)=>{_0x58ee3c?_0x28bcc4(_0x58ee3c):_0xf8f573(_0x311307);});});}),ipcMain['handle']('get-accounts',async _0x3af75e=>{return new Promise((_0x4592cd,_0x213fee)=>{const _0x24f509='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x24f509),igaccountsDB['all'](_0x24f509,[],(_0x4cbc46,_0x282349)=>{_0x4cbc46?_0x213fee(_0x4cbc46):_0x4592cd(_0x282349);});});}),ipcMain['handle']('get-targets',async(_0x4edead,_0x3bed4c)=>{return getTargetProfiles(_0x3bed4c);}),ipcMain['handle']('delete-user',async(_0x2bc0b4,_0x435f59,_0x261b5b)=>{return new Promise((_0x4401a1,_0x11011f)=>{const _0x1124d2=db['prepare']('DELETE\x20FROM\x20'+quoteIdent(_0x261b5b)+'\x20WHERE\x20username\x20=\x20?');_0x1124d2['run'](_0x435f59,function(_0x517c02){_0x517c02?_0x11011f(_0x517c02):_0x4401a1({'status':'success','changes':this['changes']});}),_0x1124d2['finalize']();});}),ipcMain['handle']('delete-account',async(_0x3b3656,_0x46e835)=>{const _0x5e017a=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x5e017a['run'](_0x46e835,function(_0x2f6f98){_0x2f6f98&&console['log'](_0x2f6f98);}),_0x5e017a['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x1ab2cc,_0x5cae25)=>{const _0x16a326='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x16a326,[],(_0x373ed7,_0x189103)=>{_0x373ed7?_0x5cae25({'status':'error','message':_0x373ed7['message']}):_0x1ab2cc({'status':'success','contactedCount':_0x189103['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x20ec36,_0x19d416)=>{const _0x1ce06c='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x1ce06c,[],(_0x2c133f,_0x1f0233)=>{_0x2c133f?_0x19d416({'status':'error','message':_0x2c133f['message']}):_0x20ec36({'status':'success','contactedCount':_0x1f0233['contactedCount']});});});});function exportDatabase(_0x2c8b43){return new Promise((_0x1c6b76,_0x48fcd9)=>{const _0x2b890b='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+quoteIdent(_0x2c8b43)+'\x0a\x20\x20\x20\x20';db['all'](_0x2b890b,[],async(_0x3540c2,_0x5f1dae)=>{if(_0x3540c2){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x3540c2['message']),_0x48fcd9(_0x3540c2);return;}if(!_0x5f1dae||_0x5f1dae['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x1c6b76();return;}const _0x427870=XLSX['utils']['json_to_sheet'](_0x5f1dae),_0x3c6445=XLSX['utils']['sheet_to_csv'](_0x427870);try{const {canceled:_0x378f26,filePath:_0x446dce}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x2c8b43+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x378f26||!_0x446dce){console['log']('Speichern\x20abgebrochen.'),_0x1c6b76();return;}fs['writeFile'](_0x446dce,_0x3c6445,'utf8',_0x5f2d50=>{_0x5f2d50?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x5f2d50['message']),_0x48fcd9(_0x5f2d50)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x446dce),_0x1c6b76());});}catch(_0x576671){console['error']('Fehler\x20im\x20Speicherdialog:',_0x576671),_0x48fcd9(_0x576671);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x329cb8,_0x4d2057)=>{shell['openExternal'](_0x4d2057);});