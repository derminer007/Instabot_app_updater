const {app,BrowserWindow,ipcMain,dialog,shell}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div',K_OPTIONS_BUTTON='section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.xs5motx\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD='div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f',K_SEND_MSG_BUTTON='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x4e8a74=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x4e8a74['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x4e8a74['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x3e3840){var _0x45bcce=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x586e89){console['log']('window\x20id:'+_0x586e89['id']),_0x586e89['id']>0x1&&(_0x45bcce=!![]);}),console['log']('child\x20opened\x20='+_0x45bcce);if(!_0x45bcce){const _0x4b0e40=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x4b0e40['loadFile'](_0x3e3840['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0);});const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x4207fa='',_0x434793=null;if(process['platform']==='darwin')_0x4207fa=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x4207fa=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x4207fa}),_0x434793=await browser_login['newPage'](),_0x434793['setDefaultNavigationTimeout'](0x1d4c),_0x434793['setDefaultTimeout'](0x1d4c),_0x434793;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x46753e=0x1,_0x4c5022=0x0){let _0x21b3ec='',_0x4b5343=null;const _0x46bf89=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x21b3ec=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x21b3ec=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x46753e===0x0&&!pageStack[_0x4c5022])return browser=await puppeteer['launch']({'headless':_0x46bf89,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x21b3ec}),_0x4b5343=await browser['newPage'](),_0x4b5343['setDefaultNavigationTimeout'](0x1d4c),_0x4b5343['setDefaultTimeout'](0x1d4c),pageStack[_0x4c5022]=_0x4b5343,_0x4b5343;return(browser===null||pageStack[_0x4c5022]===null||pageStack[_0x4c5022]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x46bf89,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x21b3ec})),(pageStack[_0x4c5022]===null||pageStack[_0x4c5022]['isClosed']())&&(_0x4b5343=await browser['newPage'](),_0x4b5343['setDefaultNavigationTimeout'](0x1d4c),_0x4b5343['setDefaultTimeout'](0x1d4c),pageStack[_0x4c5022]=_0x4b5343),pageStack[_0x4c5022];}ipcMain['on']('login',async(_0x3b62a8,_0x5b785d)=>{const _0x5cf1fd=await getBrowserPageLogin();await _0x5cf1fd['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x5cf1fd,_0x5b785d),ipcMain['on']('setLoginCookies',async(_0x4edb71,_0x236f64)=>{try{await set_login_cookies(_0x5cf1fd,_0x236f64);}catch(_0x3a7fdc){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x3a7fdc);}});}),ipcMain['on']('export-relation',async(_0x27565a,_0xfc0233)=>{try{await exportDatabase(_0xfc0233),_0x27565a['reply']('export-relation-response',{'success':!![]});}catch(_0x456018){console['error'](_0x456018),_0x27565a['reply']('export-relation-response',{'success':![],'message':_0x456018['message']});}}),ipcMain['handle']('sendMessage',async(_0xb2dfdd,_0x3e1084,_0x37e47e,_0x284628,_0x3198f1,_0x1834f6,_0x1f5b2a,_0x4b6931)=>{isStopping=![];let _0x2e6324=null;return _0x1f5b2a?_0x2e6324=await getBrowserPage(_0x3198f1,_0x4b6931):_0x2e6324=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x3e1084),send_message(_0x2e6324,_0x3e1084,_0x37e47e,_0x284628,_0x3198f1,_0x1834f6);}),ipcMain['handle']('stop-action',async(_0x4f8eb0,_0x3ff689)=>{isStopping=!![];const _0x555af6=await getBrowserPage(0x1,_0x3ff689);await _0x555af6['close']();}),ipcMain['handle']('fetch_followers',async(_0x3f7ed8,_0x24b4a0,_0x38e02f,_0x108590,_0x3f943a,_0xc141af)=>{isStopping=![];const _0x208fdd=await getBrowserPage();return fetch_followers_from_account(_0x3f7ed8,_0x208fdd,_0x24b4a0,_0x38e02f,_0x108590,_0x3f943a,_0xc141af);}),ipcMain['handle']('get-account-details',async(_0x33dd42,_0x5f3154,_0x1d7169,_0x416255)=>{isStopping=![];const _0x118080=await getBrowserPage();return fetch_account_details(_0x118080,_0x5f3154,_0x1d7169,_0x416255);}),ipcMain['handle']('fetch_likes',async(_0x57c65e,_0x5da7ec,_0x1e969e,_0x258e35,_0x27a254,_0x3935b0)=>{isStopping=![];const _0x3a6580=await getBrowserPage();return fetch_likers_from_post(_0x57c65e,_0x3a6580,_0x5da7ec,_0x1e969e,_0x258e35,_0x27a254,_0x3935b0);}),ipcMain['handle']('fetch_comments',async(_0x3bfc26,_0xe14df6,_0x3f66af,_0x2e0f64,_0x56aed0,_0x49b71d)=>{isStopping=![];const _0x2fe1fa=await getBrowserPage();return fetch_comments_from_post(_0x3bfc26,_0x2fe1fa,_0xe14df6,_0x3f66af,_0x2e0f64,_0x56aed0,_0x49b71d);}),ipcMain['handle']('update-app',async _0x2d4761=>{const {spawn:_0x452171}=require('child_process'),_0x2ed47d=require('path');return new Promise((_0x312f7d,_0x4f7391)=>{(process['env']['NODE_ENV']==='development'||process['env']['SKIP_UPDATES']==='true')&&(console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x312f7d('Update\x20übersprungen'));if(process['platform']==='darwin'){const _0x5ba6df=_0x2ed47d['join'](__dirname,'mac-updater-intern.sh'),_0x9b6b09=_0x452171('/bin/bash',[_0x5ba6df]);_0x9b6b09['stdout']['on']('data',_0x1d162e=>{console['log']('stdout:\x20'+_0x1d162e);}),_0x9b6b09['stderr']['on']('data',_0x242b75=>{console['error']('stderr:\x20'+_0x242b75);}),_0x9b6b09['on']('close',_0x4fa263=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x4fa263),_0x4fa263===0x0?_0x312f7d('Update\x20erfolgreich\x20abgeschlossen.'):_0x4f7391(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x4fa263));});}else{if(process['platform']==='win32'){const _0x333e88=_0x2ed47d['join'](__dirname,'../','../','../');process['chdir'](_0x333e88),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x3dd11e='soft-ui-updater-windows.ps1',_0x4b82bf=_0x452171('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x3dd11e]);_0x4b82bf['stdout']['on']('data',_0x18d2c2=>{console['log']('stdout:\x20'+_0x18d2c2);}),_0x4b82bf['stderr']['on']('data',_0xb2bb=>{console['error']('stderr:\x20'+_0xb2bb);}),_0x4b82bf['on']('close',_0x15a011=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x15a011),_0x15a011===0x0?_0x312f7d('Update\x20erfolgreich\x20abgeschlossen.'):_0x4f7391(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x15a011));});}else _0x4f7391(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}});});function getRnd(_0x594000,_0x5e5ee4){return Math['random']()*(_0x5e5ee4-_0x594000+0x1)+_0x594000;}function delay(_0x3f0e1b,_0x1f7703){let _0x152340=getRnd(_0x3f0e1b,_0x1f7703);return new Promise(function(_0x1002b0){setTimeout(_0x1002b0,_0x152340);});}async function scroll(_0x3137a6,_0x54be03,_0x8d3e8c=0x2,_0x4ffcb6){const _0x7e9c79=await _0x3137a6['waitForSelector'](_0x54be03);for(let _0x5b858d=0x0;_0x5b858d<_0x8d3e8c;_0x5b858d++){console['log']('Scrolling\x20'+_0x5b858d),await _0x3137a6['evaluate'](_0x31dd01=>{const _0x1c09b9=document['querySelector'](_0x31dd01);_0x1c09b9&&_0x1c09b9['scrollBy'](0x0,0x190);},_0x54be03),await delay(0x320,0x5dc),_0x4ffcb6();}}async function saveCookies(_0x4d3e8c){let _0x1647a1=await _0x4d3e8c['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x1647a1,null,0x2));}async function notificationClear(_0x531d85){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x531d85['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x531d85['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x103f10){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x103f10);}}async function getTargetProfiles(_0x1d4568){return new Promise((_0x4fdfed,_0x3c3d11)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x1d4568,(_0x49e03f,_0x5e5213)=>{_0x49e03f?_0x3c3d11(_0x49e03f):_0x4fdfed(_0x5e5213);});});}async function login_legacy(_0x403aa2,_0x161e49,_0x4ac480){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x403aa2,_0x161e49),await createUserIfNotExists(_0x161e49,_0x4ac480);}catch(_0x228862){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x228862);}try{await _0x403aa2['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x403aa2['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x403aa2['click']('button._a9--._ap36._a9_0');}catch(_0x5cef87){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x403aa2['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x403aa2['type']('input[name=\x27username\x27]',_0x161e49,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x403aa2['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x403aa2['type']('input[name=\x27password\x27]',_0x4ac480,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x403aa2['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x403aa2['click']('button[type=\x27submit\x27]');}catch(_0x5d1f95){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x403aa2),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x403aa2,_0x161e49);}catch(_0x11fd17){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x11fd17);}}catch(_0x21b097){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x21b097);}}async function login(_0x5d6cae,_0x4ae42b){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x5d6cae,_0x4ae42b),await createUserIfNotExists(_0x4ae42b);}catch(_0xccc197){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0xccc197);}try{await _0x5d6cae['goto']('https://www.instagram.com/accounts/login/');}catch(_0x420280){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x420280);}}async function set_login_cookies(_0x2fc7c2,_0x20a979){try{await saveCookiesForUser(_0x2fc7c2,_0x20a979);}catch(_0x55cf5d){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x55cf5d);}}async function waitForXPath(_0x21fb7c,_0x2746a3,_0x387e18={}){return await _0x21fb7c['waitForFunction'](_0x354b4e=>{return document['evaluate'](_0x354b4e,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x387e18,_0x2746a3),_0x21fb7c['evaluateHandle'](_0x1b48d2=>document['evaluate'](_0x1b48d2,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x2746a3);}async function send_message(_0x189825,_0x13a03f,_0x3069c8,_0x29361a,_0x40fa35,_0x3c2c32){return new Promise(async(_0xce6e86,_0x5da165)=>{_0x3c2c32=_0x3c2c32['split'](';'),console['log'](_0x3c2c32[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x40fa35);try{await setCookiesForUser(_0x189825,_0x3c2c32[0x0]);}catch(_0xe20fef){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0xe20fef),_0x5da165({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0xe20fef});return;}try{await _0x189825['goto']('https://www.instagram.com/'+_0x13a03f+'/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x189825);}catch(_0x3cd55b){_0x5da165({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x3cd55b});return;}try{await _0x189825['waitForSelector'](K_DIRECT_MSG_BUTTON),await _0x189825['click'](K_DIRECT_MSG_BUTTON);}catch(_0x3ccbc7){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x3ccbc7);try{await _0x189825['waitForSelector'](K_OPTIONS_BUTTON),await _0x189825['click'](K_OPTIONS_BUTTON),await delay(0x1f4,0x320);const _0x5e9e25=await waitForXPath(_0x189825,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x5e9e25['click']();}catch(_0x24948d){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x24948d),_0xce6e86({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x189825);}catch(_0x28beec){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x28beec);}try{const _0x5820de=await _0x189825['waitForSelector'](K_CHAT_INPUT_FIELD),_0x16ba4b=await _0x189825['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x16ba4b),_0x29361a=_0x29361a['replace']('{USERNAME}',_0x13a03f);let _0x11daf5=_0x16ba4b['replace'](/[^\p{L}\s]/gu,''),_0x193aeb=_0x11daf5['split']('\x20')[0x0];console['log']('Extrahierter\x20Clearname\x20mit\x20Len:\x20'+_0x193aeb['length']+'nach\x20Split:\x20'+_0x193aeb);_0x193aeb['length']>0x2&&!_0x193aeb['includes']('Instagram')?(_0x29361a=_0x29361a['replaceAll']('{NAME}',_0x193aeb),_0x29361a=_0x29361a['replaceAll']('{name}',_0x193aeb)):(_0x29361a=_0x29361a['replaceAll']('\x20{NAME}',''),_0x29361a=_0x29361a['replaceAll']('\x20{name}',''),_0x29361a=_0x29361a['replaceAll']('{NAME}',''),_0x29361a=_0x29361a['replaceAll']('{name}',''));await _0x5820de['type'](_0x29361a,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0x16c45a=await _0x189825['waitForSelector'](K_SEND_MSG_BUTTON);await _0x16c45a['click'](),await delay(0x320,0x3e8),_0xce6e86({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!'});}catch(_0x1ba4cb){try{await _0x189825['waitForSelector'](K_MSG_DISABLED_LABEL);const _0x5eeb4e=await _0x189825['evaluate'](_0x65c484=>{return document['querySelector'](_0x65c484)['textContent'];},K_MSG_DISABLED_LABEL);console['log']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20gefunden:\x20'+_0x5eeb4e),console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x1ba4cb),_0xce6e86({'status':0x195,'message':'Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x13a03f+'\x20überspringen.'});}catch(_0x304ec4){console['error']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20nicht\x20gefunden:\x20'+_0x304ec4),console['error']('Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x13a03f+'\x20:\x20'+_0x304ec4),_0xce6e86({'status':0x196,'message':'Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x13a03f+'\x20:\x20'+_0x304ec4});}}});}function handle_fail(_0x1e94d4){if(isStopping)return new Promise(_0x5c1a84=>{_0x5c1a84('Scraper\x20gestoppt.');});else{let _0x1f8204='';switch(_0x1e94d4){case 0x0:_0x1f8204='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x1f8204='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x1f8204='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x1f8204='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x41df06,_0x1cf329)=>{_0x1cf329(_0x1f8204);});}}async function fetch_account_details(_0x55c0ae,_0x932204,_0x412b82,_0x201402){try{await setCookiesForUser(_0x55c0ae,_0x412b82['username']);}catch(_0x289f5b){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x289f5b);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x289f5b);return handle_fail(0x0);}_0x55c0ae['setDefaultNavigationTimeout'](0x7530),await _0x55c0ae['goto']('https://www.instagram.com/'+_0x932204+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x55c0ae);const _0x303673=await _0x55c0ae['evaluate'](()=>{const _0x61dcad=document['querySelector']('meta[property=\x22og:image\x22]');return _0x61dcad?_0x61dcad['getAttribute']('content'):null;});await _0x55c0ae['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x1983b4=await _0x55c0ae['evaluate'](()=>{const _0xb76c0a=document['querySelector']('meta[name=\x22description\x22]');if(!_0xb76c0a)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x1abd0e=_0xb76c0a['getAttribute']('content');if(!_0x1abd0e)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x1abd0e);const _0x50cf06=/\s*[–-]\s*/,_0x415e7f=_0x1abd0e['split'](_0x50cf06);if(_0x415e7f['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x539a93=_0x415e7f[0x0],_0x5d2b77=_0x415e7f[0x1],_0x1d897c=_0x539a93['split'](',\x20');if(_0x1d897c['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x291d7e=_0x1d897c[0x0]['split']('\x20')[0x0],_0x4818d1=_0x1d897c[0x1]['split']('\x20')[0x0],_0x1ebb45=_0x1d897c[0x2]['split']('\x20')[0x0];let _0x270bc5='',_0x137b22='';const _0x1579ca='\x20on\x20Instagram:\x20',_0x5b2364=_0x5d2b77['split'](_0x1579ca);return _0x270bc5=_0x5b2364[0x0]['trim'](),_0x270bc5=_0x270bc5['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x5b2364['length']>0x1&&(_0x137b22=_0x5b2364[0x1]['trim'](),_0x137b22['startsWith']('\x22')&&_0x137b22['endsWith']('\x22')&&(_0x137b22=_0x137b22['substring'](0x1,_0x137b22['length']-0x1)['trim']()),_0x137b22=_0x137b22['replace'](/&quot;/g,'')['trim']()),{'followers':_0x291d7e,'following':_0x4818d1,'posts':_0x1ebb45,'nameText':_0x270bc5,'bio':_0x137b22};});console['log']('Extracted\x20profile\x20data:',_0x1983b4);const _0x22339f=_0x1983b4['nameText'],_0x33944f=_0x303673,_0x30005c=_0x1983b4['bio'],_0x892cbc=_0x1983b4['followers'],_0x214f60=_0x1983b4['following'],_0x539059=_0x1983b4['posts'],_0x5f3318=![],_0x5ccfed=![],_0x295780=![],_0x3a9842='\x0a\x20\x20INSERT\x20INTO\x20'+_0x201402+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x3a9842,[_0x932204,_0x22339f,_0x33944f,_0x30005c,_0x892cbc,_0x214f60,_0x539059,_0x5f3318,_0x5ccfed,_0x295780],function(_0x45781d){_0x45781d?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x45781d['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x5ac9fe,_0x2587e,_0x40e27a,_0x495d04,_0x207251,_0x17a49a,_0x1ec02d){let _0x5c781d=0x4,_0x3f6f5c=0x0,_0x29b182=0x0;try{await setCookiesForUser(_0x2587e,_0x17a49a['username']);}catch(_0x13f0b5){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x13f0b5);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x13f0b5);return handle_fail(0x0);}let _0xa9dc9b=0x0;try{await _0x2587e['goto']('https://www.instagram.com/'+_0x40e27a+'/'),await notificationClear(_0x2587e);try{if(_0x495d04<=0x0){const _0xcf4015=await _0x2587e['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x379ff1=await _0x2587e['evaluate'](_0x1bc292=>_0x1bc292['innerHTML'],_0xcf4015);_0xa9dc9b=Math['ceil'](_0x379ff1/0x4);}else _0xa9dc9b=Math['ceil'](_0x495d04/0x4);_0x5c781d+=_0xa9dc9b,_0x29b182=Math['round'](++_0x3f6f5c/_0x5c781d*0x64),_0x5ac9fe['sender']['send']('fetch-progress',_0x29b182,!![]);let _0x2064c8=await _0x2587e['waitForSelector']('a[href=\x22/'+_0x40e27a+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x2064c8['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x40e27a+'\x20gesichtet'),_0x29b182=Math['round'](++_0x3f6f5c/_0x5c781d*0x64),_0x5ac9fe['sender']['send']('fetch-progress',_0x29b182,!![]);}catch(_0x3bceaf){console['log']('Follower\x20Liste\x20von\x20'+_0x40e27a+'\x20nicht\x20gefunden:'+_0x3bceaf);throw new Error('Follower\x20Liste\x20von\x20'+_0x40e27a+'\x20nicht\x20gefunden:'+_0x3bceaf);return handle_fail(0x0);}}catch(_0x2fa2fc){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x2fa2fc);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x2fa2fc);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0xa9dc9b),await scroll(_0x2587e,FOLLOWER_FENSTER,_0xa9dc9b,_0x5534f8=>{_0x29b182=Math['round'](++_0x3f6f5c/_0x5c781d*0x64),_0x5ac9fe['sender']['send']('fetch-progress',_0x29b182,!![]);}),await _0x2587e['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x5b227a=await _0x2587e['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x3a5d5b=await _0x2587e['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x29b182=Math['round'](++_0x3f6f5c/_0x5c781d*0x64),_0x5ac9fe['sender']['send']('fetch-progress',_0x29b182,!![]);_0x495d04<=0x0&&(_0x495d04=_0x5b227a['length']);let _0x38adf9=[];for(let _0x7a189=0x0;_0x7a189<_0x5b227a['length']&&_0x7a189<_0x495d04;_0x7a189++){_0x38adf9['push'](await _0x5b227a[_0x7a189]['evaluate'](_0x4b1801=>_0x4b1801['textContent']));const _0x3a6965='INSERT\x20INTO\x20'+_0x207251+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x3a6965,[await _0x5b227a[_0x7a189]['evaluate'](_0x4086e4=>_0x4086e4['textContent']),await _0x3a5d5b[_0x7a189]['evaluate'](_0x5c37a0=>_0x5c37a0['textContent'])],function(_0x11b981){_0x11b981?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x207251+'\x27:',_0x11b981['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x29b182=Math['round'](++_0x3f6f5c/_0x5c781d*0x64),_0x5ac9fe['sender']['send']('fetch-progress',_0x29b182,!![]),_0x1ec02d&&(_0x5ac9fe['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x5ac9fe,_0x2587e,_0x17a49a,_0x207251,_0x38adf9)),new Promise(_0x4e98c6=>{_0x4e98c6('Scraping\x20finished!');});}catch(_0x273e92){if(_0x1ec02d)throw new Error(_0x273e92);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x40e27a+'\x20nicht\x20gefunden:\x20'+_0x273e92);return handle_fail(0x0);}}async function fetch_details_from_list(_0x1aadd7,_0x5e3e9d,_0x58279b,_0x4fff5c,_0xb7b77c){let _0x501b9d=0x0,_0x37c9f5=0x0;for(let _0x319faf=0x0;_0x319faf<_0xb7b77c['length'];_0x319faf++){console['log']('Processing\x20profile:',_0xb7b77c[_0x319faf]);try{await fetch_account_details(_0x5e3e9d,_0xb7b77c[_0x319faf],_0x58279b,_0x4fff5c);}catch(_0x1063e5){console['error']('Detailed\x20Scraping\x20von:\x20',_0xb7b77c[_0x319faf],_0x1063e5);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0xb7b77c[_0x319faf]+'\x20'+_0x1063e5);}_0x37c9f5=Math['round'](++_0x501b9d/_0xb7b77c['length']*0x64),_0x1aadd7['sender']['send']('fetch-progress',_0x37c9f5,!![],!![]);}}async function fetch_likers_from_post(_0x5d6e43,_0x1bea77,_0x370f56,_0x21fe25,_0x28f891,_0x2b9f62,_0x1b5444){let _0x8b98d3=0x4,_0x24a598=0x0,_0x348003=0x0;try{await setCookiesForUser(_0x1bea77,_0x2b9f62['username']);}catch(_0x7d57a7){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x7d57a7);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x7d57a7);return handle_fail(0x1);return;}_0x348003=Math['round'](++_0x24a598/_0x8b98d3*0x64),_0x5d6e43['sender']['send']('fetch-progress',_0x348003,!![]);try{let _0x33e2da=_0x370f56['substring'](0x0,_0x370f56['lastIndexOf']('/')),_0x677d4=_0x33e2da+'/liked_by';console['log'](_0x677d4),await _0x1bea77['goto'](_0x677d4),await delay(0x7d0,0xfa0),await notificationClear(_0x1bea77),await delay(0xc8,0x1f4),_0x348003=Math['round'](++_0x24a598/_0x8b98d3*0x64),_0x5d6e43['sender']['send']('fetch-progress',_0x348003,!![]),await _0x1bea77['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x348939=await _0x1bea77['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x2c1aa8=await _0x1bea77['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x348939['length']);let _0x13865b=path['join'](__dirname,'/likers.csv');_0x348003=Math['round'](++_0x24a598/_0x8b98d3*0x64),_0x5d6e43['sender']['send']('fetch-progress',_0x348003,!![]);_0x21fe25<=0x0&&(_0x21fe25=_0x348939['length']);try{let _0x50f2a5=[];for(let _0x30b4dc=0x0;_0x30b4dc<_0x348939['length']&&_0x30b4dc<_0x21fe25;_0x30b4dc++){_0x50f2a5['push'](await _0x348939[_0x30b4dc]['evaluate'](_0x5d080e=>_0x5d080e['textContent']));try{const _0x3f057d='INSERT\x20INTO\x20'+_0x28f891+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x3f057d,[await _0x348939[_0x30b4dc]['evaluate'](_0x12d2fc=>_0x12d2fc['textContent']),await _0x2c1aa8[_0x30b4dc]['evaluate'](_0x5cdbcf=>_0x5cdbcf['textContent'])],function(_0x337ff6){_0x337ff6?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x28f891+'\x27:',_0x337ff6['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x959a51){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x30b4dc+'\x20:\x20'+_0x959a51);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x30b4dc+'\x20:\x20'+_0x959a51);return handle_fail(0x1);}}return _0x348003=Math['round'](++_0x24a598/_0x8b98d3*0x64),_0x5d6e43['sender']['send']('fetch-progress',_0x348003,!![]),_0x1b5444&&(_0x5d6e43['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x5d6e43,_0x1bea77,_0x2b9f62,_0x28f891,_0x50f2a5)),new Promise(_0xb443b4=>{_0xb443b4('Scraping\x20finished!');});}catch(_0x5d9da2){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x5d9da2);return handle_fail(0x1);}}catch(_0x37d319){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x37d319);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x37d319);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x2ce3b6,_0x597f76,_0x412786,_0x1978f7,_0x101d78,_0x271b3c,_0x3faa34){let _0x2959f8=0x3,_0x1b49e1=0x0,_0x480421=0x0;try{await setCookiesForUser(_0x597f76,_0x271b3c['username']);}catch(_0xabfe5c){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0xabfe5c);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0xabfe5c);return handle_fail(0x2);}try{console['log'](_0x412786),await _0x597f76['goto'](_0x412786),await delay(0x7d0,0xfa0),await notificationClear(_0x597f76),await delay(0xc8,0x1f4);const _0x314a79=COM_COMMENTS_BOX_BODY_DIV;let _0x56d5de;const _0x3b1ff7=await _0x597f76['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x1fafd7=await _0x597f76['evaluate'](_0x3e3121=>_0x3e3121['innerHTML'],_0x3b1ff7),_0x466d60=String(_0x1fafd7)['replace'](/[^0-9]/g,''),_0x282199=Number(_0x466d60)/0x14;_0x1978f7<=0x0?_0x56d5de=Math['ceil'](_0x282199/0x3):_0x56d5de=Math['ceil'](_0x1978f7/0x3);_0x2959f8+=_0x56d5de,_0x480421=Math['round'](++_0x1b49e1/_0x2959f8*0x64),_0x2ce3b6['sender']['send']('fetch-progress',_0x480421,!![]),console['log']('Auto-scrolls:\x20'+_0x56d5de),await scroll(_0x597f76,_0x314a79,_0x56d5de,_0x3f3908=>{_0x480421=Math['round'](++_0x1b49e1/_0x2959f8*0x64),_0x2ce3b6['sender']['send']('fetch-progress',_0x480421,!![]);});try{const _0x3d6e26=COM_REPLY_BUTTON_SPAN;await _0x597f76['waitForSelector'](_0x3d6e26),await delay(0x1f4,0x320);const _0xefc47b=await _0x597f76['$$'](_0x3d6e26);console['log'](_0xefc47b);let _0x304fcc=_0xefc47b['length'];await delay(0xc8,0x1f4);try{for(let _0x27cf2e=0x0;_0x27cf2e<_0x304fcc;_0x27cf2e++){_0xefc47b[_0x27cf2e]['click'](),await delay(0x320,0x5dc);}}catch(_0x2f8939){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x2f8939);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x2f8939);return handle_fail(0x2);}}catch(_0x3bdc9f){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x1a94c7=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x597f76['waitForSelector'](_0x1a94c7),await delay(0x1f4,0x320),_0x480421=Math['round'](++_0x1b49e1/_0x2959f8*0x64),_0x2ce3b6['sender']['send']('fetch-progress',_0x480421,!![]);const _0x20c9da=await _0x597f76['$$'](_0x1a94c7);let _0x1488d0=path['join'](__dirname,'/comments.csv');_0x1978f7<=0x0&&(_0x1978f7=_0x20c9da['length']);console['log']('fetch_limit:\x20'+_0x1978f7),console['log']('comments_len:\x20'+_0x20c9da['length']),_0x1978f7++;try{let _0x57370a=[];for(let _0x47be17=0x1;_0x47be17<_0x20c9da['length']&&_0x47be17<_0x1978f7;_0x47be17++){try{_0x57370a['push'](await _0x20c9da[_0x47be17]['evaluate'](_0x12d81b=>_0x12d81b['textContent']));const _0x148890=await db['prepare']('INSERT\x20INTO\x20'+_0x101d78+'\x20(username)\x20VALUES\x20(?)');await _0x148890['run'](await _0x20c9da[_0x47be17]['evaluate'](_0x4cabfc=>_0x4cabfc['textContent']),function(_0x26e37f){_0x26e37f&&console['log']('error\x20in\x20add-user:'+_0x26e37f);}),await _0x148890['finalize']();}catch(_0x48be28){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x47be17+'\x20:\x20'+_0x48be28);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x47be17+'\x20:\x20'+_0x48be28);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x480421=Math['round'](++_0x1b49e1/_0x2959f8*0x64),_0x2ce3b6['sender']['send']('fetch-progress',_0x480421,!![]),_0x2ce3b6['sender']['send']('fetch-progress',0x64,!![]),_0x3faa34&&(_0x2ce3b6['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x2ce3b6,_0x597f76,_0x271b3c,_0x101d78,_0x57370a)),_0x2ce3b6['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x8520cb=>{_0x8520cb('Scraping\x20finished!');});}catch(_0x10f678){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x10f678);return handle_fail(0x2);}}catch(_0x427229){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x427229);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x427229);return handle_fail(0x2);}}async function set_clearname_from_username(_0x2136c8,_0x12d68c,_0x1f53d1=null){try{let _0xe6d080,_0x401e29;const _0x4f2d3a='SELECT\x20username\x20FROM\x20'+_0x12d68c+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x4f2d3a,[],(_0x33c9b5,_0x439ddf)=>{_0x33c9b5&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x33c9b5['message']),_0x439ddf['length']===0x0&&(_0x401e29=_0x439ddf['length']),_0xe6d080=_0x439ddf['map'](_0x3961cb=>_0x3961cb['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x401e29);if(_0x401e29===0x0){console['log']('Leave');return;}const _0x43d5c9=await _0x2136c8['waitForSelector'](IG_SEARCH_BUTTON);await _0x43d5c9['click'](),await delay(0x4b0,0x7d0);for(let _0x11f326 of _0xe6d080){const _0x1d7c55=await _0x2136c8['waitForSelector'](IG_SEARCH_INPUT);await _0x1d7c55['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x2136c8['type'](IG_SEARCH_INPUT,_0x11f326,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x5727f4=0x1;while(_0x5727f4!=0x14){console['log']('Schleife');try{let _0x5cf02e=IG_NAME_SPAN_PART1+_0x5727f4+IG_USERNAME_SPAN_PART2;const _0x2a3eb0=await _0x2136c8['waitForSelector'](_0x5cf02e),_0x5ab85f=await _0x2136c8['evaluate'](_0x510897=>_0x510897['innerHTML'],_0x2a3eb0);await delay(0xc8,0x1f4);if(_0x5ab85f==_0x11f326){let _0xc44e93=IG_NAME_SPAN_PART1+_0x5727f4+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x47cc68=await _0x2136c8['waitForSelector'](_0xc44e93);let _0x997c9d=await _0x2136c8['evaluate'](_0x1c3245=>_0x1c3245['innerHTML'],_0x47cc68);const _0x16e90e=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x57aee3=_0x997c9d['match'](_0x16e90e);_0x57aee3?_0x997c9d=_0x57aee3[0x1]['trim']():_0x997c9d=_0x997c9d['trim']();_0x997c9d['includes']('•')&&(_0x997c9d=_0x997c9d['substring'](0x0,_0x997c9d['indexOf']('•')-0x1));const _0x295f22='UPDATE\x20'+_0x12d68c+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x295f22,[_0x997c9d,_0x5ab85f],function(_0x5d9742){_0x5d9742&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x5d9742['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x5727f4++;}catch(_0x5e25bd){const _0x1466cf='UPDATE\x20'+_0x12d68c+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x1466cf,['',_0x11f326],function(_0x2c3823){_0x2c3823&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x2c3823['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x5e25bd);break;}}_0x1f53d1&&_0x1f53d1();}await _0x43d5c9['click']();}catch(_0x2eeb8a){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x2eeb8a);}}const campaignPath=path['resolve'](__dirname,'data/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(campaign_name\x20TEXT\x20PRIMARY\x20KEY,\x20list_id\x20TEXT,\x20zeitabstand\x20REAL,\x20message_id\x20TEXT,\x20account\x20TEXT,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x42527e,_0x43ee42)=>{const _0xfd68c2='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0xfd68c2,[],(_0x5b8cd1,_0x478335)=>{_0x5b8cd1?_0x43ee42(_0x5b8cd1):_0x42527e(_0x478335);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x1f93f2,_0x38b90a)=>{const _0x4499a6='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x4499a6,[],async(_0xe86fb6,_0x3bc2bd)=>{if(_0xe86fb6)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0xe86fb6['message']),_0x38b90a({'status':'error','message':_0xe86fb6['message']});else try{const _0x21db32=await Promise['all'](_0x3bc2bd['map'](_0x227588=>{return new Promise(_0x7e4694=>{if(!_0x227588['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x227588['campaign_name']),_0x7e4694({'campaign_name':_0x227588['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x41fc64='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x227588['list_id'],_0x502367='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x227588['list_id']+'\x22';db['get'](_0x41fc64,[],(_0x378921,_0x13a038)=>{_0x378921?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x227588['campaign_name']+':',_0x378921['message']),_0x7e4694({'campaign_name':_0x227588['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x502367,[],(_0x2804e5,_0x2ae8be)=>{_0x2804e5?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x227588['campaign_name']+':',_0x2804e5['message']),_0x7e4694({'campaign_name':_0x227588['campaign_name'],'lead_count':_0x13a038?_0x13a038['lead_count']:0x0,'contacted_count':'N/A'})):_0x7e4694({'campaign_name':_0x227588['campaign_name'],'lead_count':_0x13a038?_0x13a038['lead_count']:0x0,'contacted_count':_0x2ae8be?_0x2ae8be['contacted_count']:0x0});});});});}));_0x1f93f2({'status':'success','campaigns':_0x21db32});}catch(_0x17200d){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x17200d),_0x38b90a({'status':'error','message':_0x17200d['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x23042e,_0xdf5061)=>{return new Promise((_0x4a7adf,_0x2dbc3b)=>{const _0xe0fd15='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0xe0fd15,[_0xdf5061],(_0x53d3e2,_0x59efde)=>{_0x53d3e2?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x53d3e2),_0x2dbc3b(_0x53d3e2)):(console['log']('ROWS'),console['log'](_0x59efde),debugDatabaseContents(),_0x4a7adf(_0x59efde));});});});const showTableContents=_0x480238=>{return new Promise((_0x37c468,_0x4512ad)=>{const _0x43dbc7='SELECT\x20*\x20FROM\x20'+_0x480238+';';campaignDB['all'](_0x43dbc7,(_0x4a05a5,_0x51c54c)=>{_0x4a05a5?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x480238+':',_0x4a05a5),_0x4512ad(_0x4a05a5)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x480238+':',_0x51c54c),_0x37c468({'status':'success','message':_0x51c54c}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x3bd561){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x3bd561);}}ipcMain['handle']('create-campaign',async(_0x1ff75c,_0x17e3a4)=>{return new Promise((_0x3d368a,_0x93453e)=>{const _0x437af2='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x437af2,[String(_0x17e3a4)],function(_0x456765){_0x456765?_0x93453e(_0x456765):_0x3d368a({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x123e78,_0x252b94)=>{return new Promise((_0x5d66d7,_0x41efde)=>{const _0x5e949e='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x5e949e,[_0x252b94],function(_0x5788ab){_0x5788ab?_0x41efde(_0x5788ab):_0x5d66d7({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x2c8259,_0x35b253,_0x3e5d80,_0xc51d67,_0xf1512d,_0x632e3b)=>{const _0x1b695c=await createMessageID(_0xf1512d);return new Promise((_0x330b53,_0x404daa)=>{if(!_0x35b253||!_0x3e5d80||!_0xc51d67||!_0x1b695c||!_0x632e3b)return _0x404daa({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x1b695c);const _0x1dd620='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x1dd620,[_0x3e5d80,_0xc51d67,_0x1b695c,_0x632e3b,_0x35b253],function(_0x366bee){if(_0x366bee)_0x404daa({'status':'error','message':_0x366bee['message']});else this['changes']===0x0?_0x404daa({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x330b53({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x30f0a1,_0x3a770c,_0xbff646,_0xc4ef54,_0x29deba)=>{return new Promise((_0x349be3,_0x53f986)=>{const _0x461f47='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x461f47,[_0x3a770c,_0xbff646,_0xc4ef54,_0x29deba],function(_0x8ef478){return _0x8ef478?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x8ef478['message']),_0x53f986('insert-dm-response',{'success':![],'message':_0x8ef478['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x349be3('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x1f20f5=>{return new Promise((_0x2d8978,_0x5a74b9)=>{const _0x53047b='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x53047b,[_0x1f20f5],(_0x15309f,_0x1a13a1)=>{if(_0x15309f)_0x5a74b9({'status':'error','message':_0x15309f['message']});else{if(_0x1a13a1)_0x2d8978(_0x1a13a1['message_id']);else{const _0x485b24='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x485b24,[_0x1f20f5],function(_0x40259b){_0x40259b?_0x5a74b9({'status':'error','message':_0x40259b['message']}):_0x2d8978(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x3ede8c,_0x4e7a88)=>{return new Promise((_0x143c56,_0x1d901e)=>{const _0x2ce892='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x4e7a88;db['get'](_0x2ce892,(_0xacc0d6,_0x43d241)=>{_0xacc0d6?_0x1d901e({'status':'error','message':_0xacc0d6['message']}):_0x143c56({'status':'success','count':_0x43d241['count']});});});});const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x5d4f67,_0x130d86){try{const _0x2583a4=await new Promise((_0x18b76f,_0xd44077)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x130d86],(_0x145952,_0x475c3e)=>{if(_0x145952)_0xd44077(_0x145952);else{if(_0x475c3e['length']>0x0){let _0x3fac8f=JSON['parse'](_0x475c3e[0x0]['cookie']);console['log'](_0x3fac8f),_0x18b76f(_0x3fac8f);}else _0xd44077(new Error('User\x20with\x20username\x20'+_0x130d86+'\x20does\x20not\x20exist.'));}});});await _0x5d4f67['setCookie'](..._0x2583a4),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x5b3f52){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x5b3f52);}}async function saveCookiesForUser(_0x1f596e,_0x428f25){try{const _0x4b8d00=await _0x1f596e['cookies']();if(!_0x4b8d00||_0x4b8d00['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x428f25);const _0x1d5060=JSON['stringify'](_0x4b8d00);if(_0x1d5060['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x428f25);return new Promise((_0x328954,_0x4c815e)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x428f25],(_0x802b18,_0x26a357)=>{if(_0x802b18)return console['error']('Error\x20checking\x20user\x20existence:',_0x802b18),_0x4c815e(_0x802b18);if(_0x26a357){const _0x4b89f6=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x4b89f6['run'](_0x1d5060,_0x428f25,function(_0x328605){return _0x328605?(console['error']('Error\x20updating\x20cookies:',_0x328605),_0x4c815e(_0x328605)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x428f25),_0x328954());});}else{const _0x3db5f3=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x3db5f3['run'](_0x428f25,_0x1d5060,function(_0x4017a3){return _0x4017a3?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x4017a3),_0x4c815e(_0x4017a3)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x428f25),_0x328954());});}});});}catch(_0x61ffb4){console['error']('Error\x20fetching\x20cookies:',_0x61ffb4);throw _0x61ffb4;}}async function createUserIfNotExists(_0x36a386){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x36a386],(_0x24a49e,_0x3ee78b)=>{if(_0x24a49e){console['error']('Error\x20checking\x20user\x20existence:',_0x24a49e);throw _0x24a49e;}else{if(!_0x3ee78b){const _0x4dd234=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x4dd234['run'](_0x36a386,function(_0x114fce){_0x114fce?console['error']('Error\x20inserting\x20new\x20user:',_0x114fce):console['log']('New\x20user\x20created:',_0x36a386);});}else console['log']('User\x20already\x20exists:',_0x36a386);}});}catch(_0x68a92b){console['error']('Error\x20creating\x20user:',_0x68a92b);throw _0x68a92b;}}ipcMain['handle']('create-relation',async(_0x4721e1,_0x258fc2)=>{return new Promise((_0x56392f,_0x45940d)=>{const _0x41b85e='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x258fc2+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x41b85e,function(_0x2a4bc2){_0x2a4bc2?_0x45940d(_0x2a4bc2):_0x56392f({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x5256b0,_0x5e4e90)=>{return console['log']('droping\x20table'+_0x5e4e90),new Promise((_0x5d5607,_0x567b13)=>{const _0x3692d1='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x5e4e90;console['log']('droping\x20table'+_0x5e4e90),db['run'](_0x3692d1,function(_0x833cc4){_0x833cc4?_0x567b13(_0x833cc4):_0x5d5607({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x5440ee=>{return new Promise((_0x53c4ab,_0x20e7d0)=>{const _0x1a6486='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x1a6486,[],(_0x48ffc1,_0x379d42)=>{_0x48ffc1?_0x20e7d0(_0x48ffc1):_0x53c4ab(_0x379d42['map'](_0x39c7ce=>_0x39c7ce['name']));});});}),ipcMain['handle']('add-user',async(_0x374a8c,_0xbb865f,_0x169008)=>{return new Promise(_0x45d9bb=>{const _0x41552a=db['prepare']('INSERT\x20INTO\x20'+_0x169008+'\x20(username)\x20VALUES\x20(?)');_0x41552a['run'](_0xbb865f,function(_0x248929){_0x248929?console['log']('error\x20in\x20add-user:'+_0x248929):_0x45d9bb({'status':'success','id':this['lastID']});}),_0x41552a['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x73de4b,_0x554809)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x45bbde,_0x1a8bc5)=>{if(_0x45bbde)_0x554809(_0x45bbde);else{_0x73de4b({'status':'success','users':_0x1a8bc5});for(_0x1a8bc5 of _0x1a8bc5){console['log'](_0x1a8bc5['username']);}}});});}),ipcMain['handle']('get-data',async(_0x24f2e7,_0xbe5d09)=>{return new Promise((_0x597c78,_0x2e1e4b)=>{const _0x5e9f63='SELECT\x20*\x20FROM\x20'+_0xbe5d09;console['log'](_0x5e9f63),db['all'](_0x5e9f63,[],(_0xd9756c,_0x553ef9)=>{_0xd9756c?_0x2e1e4b(_0xd9756c):_0x597c78(_0x553ef9);});});}),ipcMain['handle']('get-accounts',async _0x1cd57a=>{return new Promise((_0x2c549f,_0x171d7d)=>{const _0x40a7b7='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x40a7b7),igaccountsDB['all'](_0x40a7b7,[],(_0xf0c7fb,_0x10ca96)=>{_0xf0c7fb?_0x171d7d(_0xf0c7fb):_0x2c549f(_0x10ca96);});});}),ipcMain['handle']('get-targets',async(_0x1ae8f5,_0x5daac2)=>{return getTargetProfiles(_0x5daac2);}),ipcMain['handle']('delete-user',async(_0x11751b,_0x4291df,_0x5a6cac)=>{return new Promise((_0x4d68ad,_0x376805)=>{const _0x20f32e=db['prepare']('DELETE\x20FROM\x20'+_0x5a6cac+'\x20WHERE\x20username\x20=\x20?');_0x20f32e['run'](_0x4291df,function(_0x3f2a9f){_0x3f2a9f?_0x376805(_0x3f2a9f):_0x4d68ad({'status':'success','changes':this['changes']});}),_0x20f32e['finalize']();});}),ipcMain['handle']('delete-account',async(_0x5da943,_0x485eff)=>{const _0x3acd8e=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x3acd8e['run'](_0x485eff,function(_0x460a43){_0x460a43&&console['log'](_0x460a43);}),_0x3acd8e['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x1825ab,_0x51f3b6)=>{const _0x1eb67c='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x1eb67c,[],(_0x20eecf,_0x9615c8)=>{_0x20eecf?_0x51f3b6({'status':'error','message':_0x20eecf['message']}):_0x1825ab({'status':'success','contactedCount':_0x9615c8['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x40fd04,_0x532a8e)=>{const _0x48d812='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x48d812,[],(_0x5bcfea,_0x17843a)=>{_0x5bcfea?_0x532a8e({'status':'error','message':_0x5bcfea['message']}):_0x40fd04({'status':'success','contactedCount':_0x17843a['contactedCount']});});});});function exportDatabase(_0x8cd27a){return new Promise((_0xd66653,_0x3c7908)=>{const _0x33d9a9='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x8cd27a+'\x0a\x20\x20\x20\x20';db['all'](_0x33d9a9,[],async(_0x52bf45,_0x76697c)=>{if(_0x52bf45){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x52bf45['message']),_0x3c7908(_0x52bf45);return;}if(!_0x76697c||_0x76697c['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0xd66653();return;}const _0x2cf61b=XLSX['utils']['json_to_sheet'](_0x76697c),_0x532bd8=XLSX['utils']['sheet_to_csv'](_0x2cf61b);try{const {canceled:_0x5016fc,filePath:_0x3d03f2}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x8cd27a+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x5016fc||!_0x3d03f2){console['log']('Speichern\x20abgebrochen.'),_0xd66653();return;}fs['writeFile'](_0x3d03f2,_0x532bd8,'utf8',_0x4a6de1=>{_0x4a6de1?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x4a6de1['message']),_0x3c7908(_0x4a6de1)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x3d03f2),_0xd66653());});}catch(_0x15163c){console['error']('Fehler\x20im\x20Speicherdialog:',_0x15163c),_0x3c7908(_0x15163c);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x50b43e,_0x37731c)=>{shell['openExternal'](_0x37731c);});