const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');async function extractFirstName(_0x7575bf,_0x1d97d1){try{const _0x4c1acd=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x1d97d1},'body':JSON['stringify']({'clearname':_0x7575bf})});if(!_0x4c1acd['ok']){const _0x2eaa06=await _0x4c1acd['text']();throw new Error(_0x4c1acd['status']+':\x20'+_0x2eaa06);}const _0x1188fd=await _0x4c1acd['json']();return _0x1188fd;}catch(_0x952835){console['error']('Error\x20in\x20extractFirstName:',_0x952835);throw _0x952835;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div',K_OPTIONS_BUTTON='section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.xs5motx\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD='div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f',K_SEND_MSG_BUTTON=['div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';async function waitForSelectorWithFallbacks(_0x2e4885,_0x1abbc1,_0x4895e0={}){for(let _0x5e90eb=0x0;_0x5e90eb<_0x1abbc1['length'];_0x5e90eb++){try{console['log']('Versuche\x20Selector\x20'+(_0x5e90eb+0x1)+'/'+_0x1abbc1['length']+':\x20'+_0x1abbc1[_0x5e90eb]['substring'](0x0,0x32)+'...');const _0xbee399=_0x5e90eb===0x0?_0x4895e0['timeout']||0x1388:0x7d0,_0x34a522=await _0x2e4885['waitForSelector'](_0x1abbc1[_0x5e90eb],{..._0x4895e0,'timeout':_0xbee399});return console['log']('Selector\x20'+(_0x5e90eb+0x1)+'\x20gefunden!'),_0x34a522;}catch(_0x5a3ad6){console['log']('Selector\x20'+(_0x5e90eb+0x1)+'\x20nicht\x20gefunden:\x20'+_0x5a3ad6['message']);if(_0x5e90eb===_0x1abbc1['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x1abbc1['length']+'\x20Selektoren\x20konnte\x20gefunden\x20werden:\x20'+_0x5a3ad6['message']);}}throw new Error('Keine\x20Selektoren\x20angegeben');}function createWindow(){const _0x5ed09e=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x5ed09e['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x5ed09e['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x1988c3){var _0x3aee7c=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x454079){console['log']('window\x20id:'+_0x454079['id']),_0x454079['id']>0x1&&(_0x3aee7c=!![]);}),console['log']('child\x20opened\x20='+_0x3aee7c);if(!_0x3aee7c){const _0x54f741=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x54f741['loadFile'](_0x1988c3['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x33f9cf=require('fs'),_0x11700e=path['join'](app['getPath']('userData'),'data'),_0x559a56=['campaign.db','crm.db','igaccounts.db'],_0x4898fa=[];try{_0x33f9cf['mkdirSync'](_0x11700e,{'recursive':!![]});for(const _0xd379bb of _0x559a56){const _0x146708=path['join'](process['resourcesPath'],'app','build','data',_0xd379bb),_0x38b7d5=path['join'](_0x11700e,_0xd379bb);!_0x33f9cf['existsSync'](_0x38b7d5)?(_0x33f9cf['copyFileSync'](_0x146708,_0x38b7d5),console['log']('[InitDB]\x20Kopiert\x20'+_0xd379bb+'\x20nach:\x20'+_0x38b7d5)):console['log']('[InitDB]\x20'+_0xd379bb+'\x20existiert\x20bereits:\x20'+_0x38b7d5),_0x4898fa['push'](_0x38b7d5);}}catch(_0x440f11){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x440f11);}return _0x4898fa;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x48d013,AppUpdate:_0x332da6}=require('electron-updater');_0x48d013['autoDownload']=![],_0x48d013['autoInstallOnAppQuit']=!![],_0x48d013['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x48d013['on']('update-available',_0x4cdc33=>{console['log']('Update\x20verfügbar:',_0x4cdc33),_0x48d013['downloadUpdate']();}),_0x48d013['on']('update-downloaded',_0x4cb556=>{console['log']('Update\x20heruntergeladen:',_0x4cb556),_0x48d013['quitAndInstall']();}),_0x48d013['on']('error',_0x36bc3f=>{console['error']('Fehler\x20beim\x20Updaten:',_0x36bc3f);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x41a2fb,AppUpdate:_0x477214}=require('electron-updater');_0x41a2fb['autoDownload']=![],_0x41a2fb['autoInstallOnAppQuit']=!![],_0x41a2fb['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x41a2fb['on']('update-available',_0x1c3357=>{console['log']('Update\x20verfügbar:',_0x1c3357),_0x41a2fb['downloadUpdate']();}),_0x41a2fb['on']('update-downloaded',_0x4c3d35=>{console['log']('Update\x20heruntergeladen:',_0x4c3d35),console['log']('Neustarten\x20zum\x20Updaten');}),_0x41a2fb['on']('error',_0x1c2718=>{console['error']('Fehler\x20beim\x20Updaten:',_0x1c2718);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x2a7eda='',_0x70b84d=null;if(process['platform']==='darwin')_0x2a7eda=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x2a7eda=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x2a7eda}),_0x70b84d=await browser_login['newPage'](),_0x70b84d['setDefaultNavigationTimeout'](0x1d4c),_0x70b84d['setDefaultTimeout'](0x1d4c),await _0x70b84d['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x70b84d;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x3c5fe2=0x1,_0x3b7211=0x0){let _0x48a8be='',_0xc0db59=null;const _0x3c4396=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x48a8be=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x48a8be=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x3c5fe2===0x0&&!pageStack[_0x3b7211])return browser=await puppeteer['launch']({'headless':_0x3c4396,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x48a8be}),_0xc0db59=await browser['newPage'](),_0xc0db59['setDefaultNavigationTimeout'](0x1d4c),_0xc0db59['setDefaultTimeout'](0x1d4c),await _0xc0db59['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x3b7211]=_0xc0db59,_0xc0db59;return(browser===null||pageStack[_0x3b7211]===null||pageStack[_0x3b7211]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x3c4396,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x48a8be})),(pageStack[_0x3b7211]===null||pageStack[_0x3b7211]['isClosed']())&&(_0xc0db59=await browser['newPage'](),_0xc0db59['setDefaultNavigationTimeout'](0x1d4c),_0xc0db59['setDefaultTimeout'](0x1d4c),await _0xc0db59['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x3b7211]=_0xc0db59),pageStack[_0x3b7211];}ipcMain['on']('login',async(_0x36de4d,_0x5a85d4)=>{const _0x3221a8=await getBrowserPageLogin();await _0x3221a8['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x3221a8,_0x5a85d4),ipcMain['on']('setLoginCookies',async(_0x27306b,_0x10b6ec)=>{try{await set_login_cookies(_0x3221a8,_0x10b6ec);}catch(_0x421328){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x421328);}});}),ipcMain['on']('export-relation',async(_0x523ff5,_0x1aa942)=>{try{await exportDatabase(_0x1aa942),_0x523ff5['reply']('export-relation-response',{'success':!![]});}catch(_0x17aac0){console['error'](_0x17aac0),_0x523ff5['reply']('export-relation-response',{'success':![],'message':_0x17aac0['message']});}}),ipcMain['handle']('sendMessage',async(_0x5b4175,_0x3baa0c,_0x32cc49,_0x5c75a3,_0x32767c,_0xeeb203,_0x4e13cf,_0x5013ce,_0x24fd27,_0x2556fe,_0x3b2efd)=>{isStopping=![];let _0x4ef0ec=null;return _0x4e13cf?_0x4ef0ec=await getBrowserPage(_0x32767c,_0x5013ce):_0x4ef0ec=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x3baa0c),send_message(_0x4ef0ec,_0x3baa0c,_0x32cc49,_0x5c75a3,_0x32767c,_0xeeb203,_0x24fd27,_0x2556fe,_0x3b2efd);}),ipcMain['handle']('stop-action',async(_0x5a9c34,_0x433f90)=>{isStopping=!![];const _0x152ff2=await getBrowserPage(0x1,_0x433f90);await _0x152ff2['close']();}),ipcMain['handle']('fetch_followers',async(_0x26a724,_0x20ce55,_0x3c36c6,_0x114222,_0x13f399,_0x14119b)=>{isStopping=![];const _0x5f297e=await getBrowserPage();return fetch_followers_from_account(_0x26a724,_0x5f297e,_0x20ce55,_0x3c36c6,_0x114222,_0x13f399,_0x14119b);}),ipcMain['handle']('get-account-details',async(_0x49b3f0,_0x41c1a5,_0x4cffec,_0x38d452)=>{isStopping=![];const _0x4e4849=await getBrowserPage();return fetch_account_details(_0x4e4849,_0x41c1a5,_0x4cffec,_0x38d452);}),ipcMain['handle']('fetch_likes',async(_0x12fdc1,_0x2821d3,_0x3981b6,_0x53766a,_0x2defbe,_0x114e48)=>{isStopping=![];const _0x4a8f2f=await getBrowserPage();return fetch_likers_from_post(_0x12fdc1,_0x4a8f2f,_0x2821d3,_0x3981b6,_0x53766a,_0x2defbe,_0x114e48);}),ipcMain['handle']('fetch_comments',async(_0x405865,_0x24e235,_0x2dde1f,_0x301e4a,_0x2f61fe,_0x523130)=>{isStopping=![];const _0x5df190=await getBrowserPage();return fetch_comments_from_post(_0x405865,_0x5df190,_0x24e235,_0x2dde1f,_0x301e4a,_0x2f61fe,_0x523130);});async function updateAppSilent(){const {spawn:_0x1daae7}=require('child_process'),_0x27b2d6=require('path'),_0x3347e9=require('electron-log');return _0x3347e9['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x577056,_0x3b21b8)=>{const {updateElectronApp:_0x387411,UpdateSourceType:_0x48df13}=require('update-electron-app');_0x387411({'updateSource':{'type':_0x48df13['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x3347e9}),_0x577056('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x4c9a0b,_0x469131)=>{doFullElectronUpdateSilent(),_0x4c9a0b('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x611a75}=require('child_process'),_0x522670=require('path'),_0x3647ba=require('electron-log');return _0x3647ba['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x3427f8,_0x3aae32)=>{const {updateElectronApp:_0x2d4d00,UpdateSourceType:_0x24f057}=require('update-electron-app');_0x2d4d00({'updateSource':{'type':_0x24f057['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x3647ba}),_0x3427f8('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x5d4bc2,_0x34c370)=>{doFullElectronUpdate(),_0x5d4bc2('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0x2e4733,_0x226843)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x2e4733('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0xbe36e3=path['join'](__dirname,'mac-updater-intern.sh'),_0x367851=spawn('/bin/bash',[_0xbe36e3],{'detached':!![],'stdio':'ignore'});_0x367851['unref'](),setTimeout(()=>{_0x2e4733('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0x226843(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0xa06eac=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x138973,_0x5e3b02)=>{console['log']('Update\x20Silent:\x20'+_0x5e3b02);if(_0x5e3b02){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0x4a56c0,_0x462284){return Math['random']()*(_0x462284-_0x4a56c0+0x1)+_0x4a56c0;}function delay(_0x2a586c,_0x1d2bff){let _0x20a623=getRnd(_0x2a586c,_0x1d2bff);return new Promise(function(_0x4a2e85){setTimeout(_0x4a2e85,_0x20a623);});}async function scroll(_0x1842c7,_0x7e5322,_0x13378b=0x2,_0x179879){const _0x1c21f3=await _0x1842c7['waitForSelector'](_0x7e5322);for(let _0x2d1588=0x0;_0x2d1588<_0x13378b;_0x2d1588++){console['log']('Scrolling\x20'+_0x2d1588),await _0x1842c7['evaluate'](_0x225b73=>{const _0x30f8b2=document['querySelector'](_0x225b73);_0x30f8b2&&_0x30f8b2['scrollBy'](0x0,0x190);},_0x7e5322),await delay(0x320,0x5dc),_0x179879();}}async function saveCookies(_0x488516){let _0x1390de=await _0x488516['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x1390de,null,0x2));}async function notificationClear(_0x1841dd){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x1841dd['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x1841dd['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x51a5ae){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x51a5ae);}}async function getTargetProfiles(_0x3d1f7f){return new Promise((_0x49d7af,_0x431ae3)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x3d1f7f,(_0x13a962,_0xafbc4c)=>{_0x13a962?_0x431ae3(_0x13a962):_0x49d7af(_0xafbc4c);});});}async function login_legacy(_0x2da1b3,_0x184118,_0x26c9ad){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x2da1b3,_0x184118),await createUserIfNotExists(_0x184118,_0x26c9ad);}catch(_0x4ac43d){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4ac43d);}try{await _0x2da1b3['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x2da1b3['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x2da1b3['click']('button._a9--._ap36._a9_0');}catch(_0x368233){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x2da1b3['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x2da1b3['type']('input[name=\x27username\x27]',_0x184118,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x2da1b3['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x2da1b3['type']('input[name=\x27password\x27]',_0x26c9ad,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x2da1b3['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x2da1b3['click']('button[type=\x27submit\x27]');}catch(_0x1fb21e){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x2da1b3),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x2da1b3,_0x184118);}catch(_0x2d6920){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x2d6920);}}catch(_0x28bf1c){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x28bf1c);}}async function login(_0x3349bd,_0x5cb142){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x3349bd,_0x5cb142),await createUserIfNotExists(_0x5cb142);}catch(_0x5b3934){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5b3934);}try{await _0x3349bd['goto']('https://www.instagram.com/accounts/login/');}catch(_0x17501e){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x17501e);}}async function set_login_cookies(_0x41b581,_0x1241ed){try{await saveCookiesForUser(_0x41b581,_0x1241ed);}catch(_0xb91eb8){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0xb91eb8);}}async function waitForXPath(_0x48d31b,_0x524036,_0x146416={}){return await _0x48d31b['waitForFunction'](_0x207b3f=>{return document['evaluate'](_0x207b3f,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x146416,_0x524036),_0x48d31b['evaluateHandle'](_0x18e252=>document['evaluate'](_0x18e252,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x524036);}async function send_message(_0x5b8f16,_0x400ff5,_0x50f579,_0x52bd67,_0x18a09b,_0x20d004,_0x576267,_0x382ba1,_0x208ab5){return new Promise(async(_0x4339e1,_0x5a8f2c)=>{_0x20d004=_0x20d004['split'](';'),console['log'](_0x20d004[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x18a09b);try{await setCookiesForUser(_0x5b8f16,_0x20d004[0x0]);}catch(_0x4c99b6){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x4c99b6),_0x5a8f2c({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x4c99b6});return;}try{await _0x5b8f16['goto']('https://www.instagram.com/'+_0x400ff5+'/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x5b8f16);}catch(_0x760c07){_0x5a8f2c({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x760c07});return;}console['log']('UserSkip:\x20'+_0x576267);if(_0x576267==0x1)try{const _0xed8506=await _0x5b8f16['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x3f7a62=>_0x3f7a62['textContent']['trim']());console['log'](_0xed8506);if(_0xed8506==='Following'||_0xed8506==='Folge\x20ich')return _0x4339e1({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x217b59){}try{await _0x5b8f16['waitForSelector'](K_DIRECT_MSG_BUTTON),await _0x5b8f16['click'](K_DIRECT_MSG_BUTTON);}catch(_0x222ac6){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x222ac6);try{await _0x5b8f16['waitForSelector'](K_OPTIONS_BUTTON),await _0x5b8f16['click'](K_OPTIONS_BUTTON),await delay(0x1f4,0x320);const _0x51479e=await waitForXPath(_0x5b8f16,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x51479e['click']();}catch(_0x1f2701){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x1f2701),_0x4339e1({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x5b8f16);}catch(_0x23f98d){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x23f98d);}try{const _0x3acfe9=await _0x5b8f16['waitForSelector'](K_CHAT_INPUT_FIELD);if(_0x382ba1){const _0x2e0ea1=await _0x5b8f16['$']('div.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x6ikm8r.x10wlt62');if(_0x2e0ea1)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x400ff5),_0x4339e1({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x229f25=await _0x5b8f16['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x229f25),_0x52bd67=_0x52bd67['replace']('{USERNAME}',_0x400ff5);let _0x239308;if(_0x52bd67['includes']('{NAME}')||_0x52bd67['includes']('{name}'))try{const _0x2afd32=await extractFirstName(_0x229f25,_0x208ab5);console['log']('Response\x20Clearname\x20valid:\x20'+_0x2afd32['valid']),_0x2afd32['valid']?(_0x52bd67=_0x52bd67['replaceAll'](/{NAME}|{name}/g,_0x2afd32['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x2afd32['name']),_0x239308=_0x2afd32['name']):(_0x52bd67=_0x52bd67['replaceAll'](/ ?({NAME}|{name})/g,''),_0x239308='UNKNOWN_NAME');}catch(_0x1a23ba){console['log'](_0x1a23ba['message']),_0x239308=_0x1a23ba['message'];let _0x143f79=_0x229f25['replace'](/[^\p{L}\s]/gu,''),_0x578fcd=_0x143f79['split']('\x20')[0x0];_0x578fcd['length']>0x2&&!_0x578fcd['includes']('Instagram')?_0x52bd67=_0x52bd67['replaceAll'](/{NAME}|{name}/g,_0x578fcd):_0x52bd67=_0x52bd67['replaceAll'](/ ?({NAME}|{name})/g,'');}await _0x3acfe9['type'](_0x52bd67,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0x229b80=await waitForSelectorWithFallbacks(_0x5b8f16,K_SEND_MSG_BUTTON);await _0x229b80['click'](),await delay(0x320,0x3e8),_0x4339e1({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x229f25,'extracted_clearname':_0x239308});}catch(_0x1a5578){try{await _0x5b8f16['waitForSelector'](K_MSG_DISABLED_LABEL);const _0x33cd09=await _0x5b8f16['evaluate'](_0x2c2130=>{return document['querySelector'](_0x2c2130)['textContent'];},K_MSG_DISABLED_LABEL);console['log']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20gefunden:\x20'+_0x33cd09),console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x1a5578),_0x4339e1({'status':0x195,'message':'Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x400ff5+'\x20überspringen.'});}catch(_0x2a5dca){console['error']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20nicht\x20gefunden:\x20'+_0x2a5dca),console['error']('Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x400ff5+'\x20:\x20'+_0x2a5dca),_0x4339e1({'status':0x196,'message':'Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x400ff5+'\x20:\x20'+_0x2a5dca});}}});}function handle_fail(_0x4fcf43){if(isStopping)return new Promise(_0x37f6d7=>{_0x37f6d7('Scraper\x20gestoppt.');});else{let _0xcbc8b0='';switch(_0x4fcf43){case 0x0:_0xcbc8b0='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0xcbc8b0='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0xcbc8b0='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0xcbc8b0='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x30f97c,_0x20769e)=>{_0x20769e(_0xcbc8b0);});}}async function fetch_account_details(_0x45346f,_0x4b5ca7,_0x221079,_0x4ee862){try{await setCookiesForUser(_0x45346f,_0x221079['username']);}catch(_0x491ff8){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x491ff8);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x491ff8);return handle_fail(0x0);}_0x45346f['setDefaultNavigationTimeout'](0x7530),await _0x45346f['goto']('https://www.instagram.com/'+_0x4b5ca7+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x45346f);const _0x3f4d27=await _0x45346f['evaluate'](()=>{const _0x416c36=document['querySelector']('meta[property=\x22og:image\x22]');return _0x416c36?_0x416c36['getAttribute']('content'):null;});await _0x45346f['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x14f089=await _0x45346f['evaluate'](()=>{const _0xe394a6=document['querySelector']('meta[name=\x22description\x22]');if(!_0xe394a6)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x592520=_0xe394a6['getAttribute']('content');if(!_0x592520)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x592520);const _0x420f64=/\s*[–-]\s*/,_0x2866b1=_0x592520['split'](_0x420f64);if(_0x2866b1['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x2f494=_0x2866b1[0x0],_0x5d7eba=_0x2866b1[0x1],_0x127830=_0x2f494['split'](',\x20');if(_0x127830['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x5613d9=_0x127830[0x0]['split']('\x20')[0x0],_0x454eea=_0x127830[0x1]['split']('\x20')[0x0],_0x597f35=_0x127830[0x2]['split']('\x20')[0x0];let _0x239c06='',_0x4851b5='';const _0x2d67a5='\x20on\x20Instagram:\x20',_0x21c28e=_0x5d7eba['split'](_0x2d67a5);return _0x239c06=_0x21c28e[0x0]['trim'](),_0x239c06=_0x239c06['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x21c28e['length']>0x1&&(_0x4851b5=_0x21c28e[0x1]['trim'](),_0x4851b5['startsWith']('\x22')&&_0x4851b5['endsWith']('\x22')&&(_0x4851b5=_0x4851b5['substring'](0x1,_0x4851b5['length']-0x1)['trim']()),_0x4851b5=_0x4851b5['replace'](/&quot;/g,'')['trim']()),{'followers':_0x5613d9,'following':_0x454eea,'posts':_0x597f35,'nameText':_0x239c06,'bio':_0x4851b5};});console['log']('Extracted\x20profile\x20data:',_0x14f089);const _0x1e29ca=_0x14f089['nameText'],_0x291981=_0x3f4d27,_0x2eac4d=_0x14f089['bio'],_0x3472ec=_0x14f089['followers'],_0x3c0d29=_0x14f089['following'],_0xd03b94=_0x14f089['posts'],_0x451065=![],_0x506dd5=![],_0x42d946=![],_0x5d0bb3='\x0a\x20\x20INSERT\x20INTO\x20'+_0x4ee862+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x5d0bb3,[_0x4b5ca7,_0x1e29ca,_0x291981,_0x2eac4d,_0x3472ec,_0x3c0d29,_0xd03b94,_0x451065,_0x506dd5,_0x42d946],function(_0x52d76c){_0x52d76c?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x52d76c['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x1e858b,_0x8466f3,_0xee2c3,_0x123d2d,_0x5dc743,_0x471200,_0x4abc9a){let _0x3c50cf=0x4,_0x1be3cf=0x0,_0x3700be=0x0;try{await setCookiesForUser(_0x8466f3,_0x471200['username']);}catch(_0x59f44d){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x59f44d);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x59f44d);return handle_fail(0x0);}let _0x22f12b=0x0;try{await _0x8466f3['goto']('https://www.instagram.com/'+_0xee2c3+'/'),await notificationClear(_0x8466f3);try{if(_0x123d2d<=0x0){const _0x4cca6f=await _0x8466f3['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x266779=await _0x8466f3['evaluate'](_0x1ec7de=>_0x1ec7de['innerHTML'],_0x4cca6f);_0x22f12b=Math['ceil'](_0x266779/0x4);}else _0x22f12b=Math['ceil'](_0x123d2d/0x4);_0x3c50cf+=_0x22f12b,_0x3700be=Math['round'](++_0x1be3cf/_0x3c50cf*0x64),_0x1e858b['sender']['send']('fetch-progress',_0x3700be,!![]);let _0x2ff08f=await _0x8466f3['waitForSelector']('a[href=\x22/'+_0xee2c3+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x2ff08f['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0xee2c3+'\x20gesichtet'),_0x3700be=Math['round'](++_0x1be3cf/_0x3c50cf*0x64),_0x1e858b['sender']['send']('fetch-progress',_0x3700be,!![]);}catch(_0x1b53ef){console['log']('Follower\x20Liste\x20von\x20'+_0xee2c3+'\x20nicht\x20gefunden:'+_0x1b53ef);throw new Error('Follower\x20Liste\x20von\x20'+_0xee2c3+'\x20nicht\x20gefunden:'+_0x1b53ef);return handle_fail(0x0);}}catch(_0x57b8cb){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x57b8cb);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x57b8cb);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x22f12b),await scroll(_0x8466f3,FOLLOWER_FENSTER,_0x22f12b,_0x34fe05=>{_0x3700be=Math['round'](++_0x1be3cf/_0x3c50cf*0x64),_0x1e858b['sender']['send']('fetch-progress',_0x3700be,!![]);}),await _0x8466f3['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0xce0590=await _0x8466f3['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x13832f=await _0x8466f3['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x3700be=Math['round'](++_0x1be3cf/_0x3c50cf*0x64),_0x1e858b['sender']['send']('fetch-progress',_0x3700be,!![]);_0x123d2d<=0x0&&(_0x123d2d=_0xce0590['length']);let _0x599a13=[];for(let _0x537e6c=0x0;_0x537e6c<_0xce0590['length']&&_0x537e6c<_0x123d2d;_0x537e6c++){_0x599a13['push'](await _0xce0590[_0x537e6c]['evaluate'](_0x1d5d64=>_0x1d5d64['textContent']));const _0xd88037='INSERT\x20INTO\x20'+_0x5dc743+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0xd88037,[await _0xce0590[_0x537e6c]['evaluate'](_0x4a8b3b=>_0x4a8b3b['textContent']),await _0x13832f[_0x537e6c]['evaluate'](_0x2d823c=>_0x2d823c['textContent'])],function(_0x29f8dc){_0x29f8dc?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x5dc743+'\x27:',_0x29f8dc['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x3700be=Math['round'](++_0x1be3cf/_0x3c50cf*0x64),_0x1e858b['sender']['send']('fetch-progress',_0x3700be,!![]),_0x4abc9a&&(_0x1e858b['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x1e858b,_0x8466f3,_0x471200,_0x5dc743,_0x599a13)),new Promise(_0x258703=>{_0x258703('Scraping\x20finished!');});}catch(_0x1533be){if(_0x4abc9a)throw new Error(_0x1533be);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0xee2c3+'\x20nicht\x20gefunden:\x20'+_0x1533be);return handle_fail(0x0);}}async function fetch_details_from_list(_0x269b65,_0x82b40a,_0x2fae25,_0x55c2fe,_0x49cfe1){let _0xee8f8e=0x0,_0x4f8852=0x0;for(let _0x46e417=0x0;_0x46e417<_0x49cfe1['length'];_0x46e417++){console['log']('Processing\x20profile:',_0x49cfe1[_0x46e417]);try{await fetch_account_details(_0x82b40a,_0x49cfe1[_0x46e417],_0x2fae25,_0x55c2fe);}catch(_0x3945ac){console['error']('Detailed\x20Scraping\x20von:\x20',_0x49cfe1[_0x46e417],_0x3945ac);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x49cfe1[_0x46e417]+'\x20'+_0x3945ac);}_0x4f8852=Math['round'](++_0xee8f8e/_0x49cfe1['length']*0x64),_0x269b65['sender']['send']('fetch-progress',_0x4f8852,!![],!![]);}}async function fetch_likers_from_post(_0x1df3d3,_0x48345a,_0x24dea0,_0x3b2061,_0x2b076c,_0x202c4c,_0x32923d){let _0x25b840=0x4,_0xdaea85=0x0,_0x3cc799=0x0;try{await setCookiesForUser(_0x48345a,_0x202c4c['username']);}catch(_0x5f9062){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x5f9062);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x5f9062);return handle_fail(0x1);return;}_0x3cc799=Math['round'](++_0xdaea85/_0x25b840*0x64),_0x1df3d3['sender']['send']('fetch-progress',_0x3cc799,!![]);try{let _0x47d657=_0x24dea0['substring'](0x0,_0x24dea0['lastIndexOf']('/')),_0x272fa1=_0x47d657+'/liked_by';console['log'](_0x272fa1),await _0x48345a['goto'](_0x272fa1),await delay(0x7d0,0xfa0),await notificationClear(_0x48345a),await delay(0xc8,0x1f4),_0x3cc799=Math['round'](++_0xdaea85/_0x25b840*0x64),_0x1df3d3['sender']['send']('fetch-progress',_0x3cc799,!![]),await _0x48345a['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x304851=await _0x48345a['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x12d3f0=await _0x48345a['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x304851['length']);let _0x458976=path['join'](__dirname,'/likers.csv');_0x3cc799=Math['round'](++_0xdaea85/_0x25b840*0x64),_0x1df3d3['sender']['send']('fetch-progress',_0x3cc799,!![]);_0x3b2061<=0x0&&(_0x3b2061=_0x304851['length']);try{let _0x437cc4=[];for(let _0x47d45e=0x0;_0x47d45e<_0x304851['length']&&_0x47d45e<_0x3b2061;_0x47d45e++){_0x437cc4['push'](await _0x304851[_0x47d45e]['evaluate'](_0x45a6e5=>_0x45a6e5['textContent']));try{const _0x1e9a5e='INSERT\x20INTO\x20'+_0x2b076c+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x1e9a5e,[await _0x304851[_0x47d45e]['evaluate'](_0xfaaa2b=>_0xfaaa2b['textContent']),await _0x12d3f0[_0x47d45e]['evaluate'](_0x27981a=>_0x27981a['textContent'])],function(_0x279959){_0x279959?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x2b076c+'\x27:',_0x279959['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x4b1813){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x47d45e+'\x20:\x20'+_0x4b1813);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x47d45e+'\x20:\x20'+_0x4b1813);return handle_fail(0x1);}}return _0x3cc799=Math['round'](++_0xdaea85/_0x25b840*0x64),_0x1df3d3['sender']['send']('fetch-progress',_0x3cc799,!![]),_0x32923d&&(_0x1df3d3['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x1df3d3,_0x48345a,_0x202c4c,_0x2b076c,_0x437cc4)),new Promise(_0x5d62=>{_0x5d62('Scraping\x20finished!');});}catch(_0x4fa9f2){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x4fa9f2);return handle_fail(0x1);}}catch(_0x3a07a0){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x3a07a0);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x3a07a0);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x24ea55,_0x1bc705,_0x4c08c8,_0x241c4f,_0x4ff7a9,_0x22bd21,_0x56b855){let _0x5703e6=0x3,_0x22cc89=0x0,_0x395e1b=0x0;try{await setCookiesForUser(_0x1bc705,_0x22bd21['username']);}catch(_0x9b4fd0){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x9b4fd0);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x9b4fd0);return handle_fail(0x2);}try{console['log'](_0x4c08c8),await _0x1bc705['goto'](_0x4c08c8),await delay(0x7d0,0xfa0),await notificationClear(_0x1bc705),await delay(0xc8,0x1f4);const _0x51a0c7=COM_COMMENTS_BOX_BODY_DIV;let _0x56102a;const _0x251948=await _0x1bc705['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x2faa4e=await _0x1bc705['evaluate'](_0x814c36=>_0x814c36['innerHTML'],_0x251948),_0x4fc3b1=String(_0x2faa4e)['replace'](/[^0-9]/g,''),_0x3410eb=Number(_0x4fc3b1)/0x14;_0x241c4f<=0x0?_0x56102a=Math['ceil'](_0x3410eb/0x3):_0x56102a=Math['ceil'](_0x241c4f/0x3);_0x5703e6+=_0x56102a,_0x395e1b=Math['round'](++_0x22cc89/_0x5703e6*0x64),_0x24ea55['sender']['send']('fetch-progress',_0x395e1b,!![]),console['log']('Auto-scrolls:\x20'+_0x56102a),await scroll(_0x1bc705,_0x51a0c7,_0x56102a,_0xf2b63c=>{_0x395e1b=Math['round'](++_0x22cc89/_0x5703e6*0x64),_0x24ea55['sender']['send']('fetch-progress',_0x395e1b,!![]);});try{const _0x48014d=COM_REPLY_BUTTON_SPAN;await _0x1bc705['waitForSelector'](_0x48014d),await delay(0x1f4,0x320);const _0x48e4fb=await _0x1bc705['$$'](_0x48014d);console['log'](_0x48e4fb);let _0x100e4f=_0x48e4fb['length'];await delay(0xc8,0x1f4);try{for(let _0x5dfdf3=0x0;_0x5dfdf3<_0x100e4f;_0x5dfdf3++){_0x48e4fb[_0x5dfdf3]['click'](),await delay(0x320,0x5dc);}}catch(_0x3fe2c0){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x3fe2c0);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x3fe2c0);return handle_fail(0x2);}}catch(_0x1a2023){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x19748f=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x1bc705['waitForSelector'](_0x19748f),await delay(0x1f4,0x320),_0x395e1b=Math['round'](++_0x22cc89/_0x5703e6*0x64),_0x24ea55['sender']['send']('fetch-progress',_0x395e1b,!![]);const _0x34f25e=await _0x1bc705['$$'](_0x19748f);let _0x2884f8=path['join'](__dirname,'/comments.csv');_0x241c4f<=0x0&&(_0x241c4f=_0x34f25e['length']);console['log']('fetch_limit:\x20'+_0x241c4f),console['log']('comments_len:\x20'+_0x34f25e['length']),_0x241c4f++;try{let _0x5d9ca1=[];for(let _0x4fd6e4=0x1;_0x4fd6e4<_0x34f25e['length']&&_0x4fd6e4<_0x241c4f;_0x4fd6e4++){try{_0x5d9ca1['push'](await _0x34f25e[_0x4fd6e4]['evaluate'](_0x597c14=>_0x597c14['textContent']));const _0x1d4227=await db['prepare']('INSERT\x20INTO\x20'+_0x4ff7a9+'\x20(username)\x20VALUES\x20(?)');await _0x1d4227['run'](await _0x34f25e[_0x4fd6e4]['evaluate'](_0xfd5664=>_0xfd5664['textContent']),function(_0x50bbd7){_0x50bbd7&&console['log']('error\x20in\x20add-user:'+_0x50bbd7);}),await _0x1d4227['finalize']();}catch(_0x53d0b7){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x4fd6e4+'\x20:\x20'+_0x53d0b7);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x4fd6e4+'\x20:\x20'+_0x53d0b7);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x395e1b=Math['round'](++_0x22cc89/_0x5703e6*0x64),_0x24ea55['sender']['send']('fetch-progress',_0x395e1b,!![]),_0x24ea55['sender']['send']('fetch-progress',0x64,!![]),_0x56b855&&(_0x24ea55['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x24ea55,_0x1bc705,_0x22bd21,_0x4ff7a9,_0x5d9ca1)),_0x24ea55['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x52660c=>{_0x52660c('Scraping\x20finished!');});}catch(_0x3669e4){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x3669e4);return handle_fail(0x2);}}catch(_0x4d747f){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x4d747f);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x4d747f);return handle_fail(0x2);}}async function set_clearname_from_username(_0x5da3f1,_0x85b66b,_0x1f0fe7=null){try{let _0x3d8e71,_0x273c11;const _0x4585d3='SELECT\x20username\x20FROM\x20'+_0x85b66b+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x4585d3,[],(_0x47c888,_0x464028)=>{_0x47c888&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x47c888['message']),_0x464028['length']===0x0&&(_0x273c11=_0x464028['length']),_0x3d8e71=_0x464028['map'](_0x1485da=>_0x1485da['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x273c11);if(_0x273c11===0x0){console['log']('Leave');return;}const _0x49aebd=await _0x5da3f1['waitForSelector'](IG_SEARCH_BUTTON);await _0x49aebd['click'](),await delay(0x4b0,0x7d0);for(let _0x48616f of _0x3d8e71){const _0x3e1f08=await _0x5da3f1['waitForSelector'](IG_SEARCH_INPUT);await _0x3e1f08['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x5da3f1['type'](IG_SEARCH_INPUT,_0x48616f,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x4fb66b=0x1;while(_0x4fb66b!=0x14){console['log']('Schleife');try{let _0x58dea5=IG_NAME_SPAN_PART1+_0x4fb66b+IG_USERNAME_SPAN_PART2;const _0x2104e5=await _0x5da3f1['waitForSelector'](_0x58dea5),_0x3a3449=await _0x5da3f1['evaluate'](_0x372198=>_0x372198['innerHTML'],_0x2104e5);await delay(0xc8,0x1f4);if(_0x3a3449==_0x48616f){let _0x5dbdcd=IG_NAME_SPAN_PART1+_0x4fb66b+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x23b6ef=await _0x5da3f1['waitForSelector'](_0x5dbdcd);let _0x6d14e2=await _0x5da3f1['evaluate'](_0x5b4db3=>_0x5b4db3['innerHTML'],_0x23b6ef);const _0xcb9197=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x449042=_0x6d14e2['match'](_0xcb9197);_0x449042?_0x6d14e2=_0x449042[0x1]['trim']():_0x6d14e2=_0x6d14e2['trim']();_0x6d14e2['includes']('•')&&(_0x6d14e2=_0x6d14e2['substring'](0x0,_0x6d14e2['indexOf']('•')-0x1));const _0x31bd06='UPDATE\x20'+_0x85b66b+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x31bd06,[_0x6d14e2,_0x3a3449],function(_0x173121){_0x173121&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x173121['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x4fb66b++;}catch(_0x1f89f9){const _0x12d21e='UPDATE\x20'+_0x85b66b+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x12d21e,['',_0x48616f],function(_0x38d4be){_0x38d4be&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x38d4be['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x1f89f9);break;}}_0x1f0fe7&&_0x1f0fe7();}await _0x49aebd['click']();}catch(_0x2330b7){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x2330b7);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x1dbc11,_0x33f5bc)=>{const _0x2e9f11='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x2e9f11,[],(_0x353b23,_0x2468f2)=>{_0x353b23?_0x33f5bc(_0x353b23):_0x1dbc11(_0x2468f2);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x28e1a6,_0x5883ed)=>{const _0x304b20='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x304b20,[],async(_0x23a03c,_0x5a3c95)=>{if(_0x23a03c)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x23a03c['message']),_0x5883ed({'status':'error','message':_0x23a03c['message']});else try{const _0x36835b=await Promise['all'](_0x5a3c95['map'](_0x36e5a5=>{return new Promise(_0x530849=>{if(!_0x36e5a5['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x36e5a5['campaign_name']),_0x530849({'campaign_name':_0x36e5a5['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x695a3='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x36e5a5['list_id'],_0x532878='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x36e5a5['list_id']+'\x22';db['get'](_0x695a3,[],(_0x13cb01,_0x3d140f)=>{_0x13cb01?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x36e5a5['campaign_name']+':',_0x13cb01['message']),_0x530849({'campaign_name':_0x36e5a5['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x532878,[],(_0x22a1ab,_0x5df8e7)=>{_0x22a1ab?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x36e5a5['campaign_name']+':',_0x22a1ab['message']),_0x530849({'campaign_name':_0x36e5a5['campaign_name'],'lead_count':_0x3d140f?_0x3d140f['lead_count']:0x0,'contacted_count':'N/A'})):_0x530849({'campaign_name':_0x36e5a5['campaign_name'],'lead_count':_0x3d140f?_0x3d140f['lead_count']:0x0,'contacted_count':_0x5df8e7?_0x5df8e7['contacted_count']:0x0});});});});}));_0x28e1a6({'status':'success','campaigns':_0x36835b});}catch(_0x3a6b44){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x3a6b44),_0x5883ed({'status':'error','message':_0x3a6b44['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x1a5637,_0x58803f)=>{return new Promise((_0x3335a0,_0x141daa)=>{const _0x4a5f51='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x4a5f51,[_0x58803f],(_0x1c185e,_0xe4a82)=>{_0x1c185e?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x1c185e),_0x141daa(_0x1c185e)):(console['log']('ROWS'),console['log'](_0xe4a82),debugDatabaseContents(),_0x3335a0(_0xe4a82));});});});const showTableContents=_0x1cc2fb=>{return new Promise((_0x3d80b9,_0x34d505)=>{const _0xfba82='SELECT\x20*\x20FROM\x20'+_0x1cc2fb+';';campaignDB['all'](_0xfba82,(_0x8340ec,_0x341e40)=>{_0x8340ec?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x1cc2fb+':',_0x8340ec),_0x34d505(_0x8340ec)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x1cc2fb+':',_0x341e40),_0x3d80b9({'status':'success','message':_0x341e40}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x5593ca){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x5593ca);}}ipcMain['handle']('create-campaign',async(_0x30b70a,_0x442789)=>{return new Promise((_0x2b8c26,_0x36888e)=>{const _0x3b5713='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x3b5713,[String(_0x442789)],function(_0x518f8a){_0x518f8a?_0x36888e(_0x518f8a):_0x2b8c26({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0xe4fd00,_0xd56bd3)=>{return new Promise((_0x43fc68,_0x371d73)=>{const _0x304a1f='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x304a1f,[_0xd56bd3],function(_0xdc7c92){_0xdc7c92?_0x371d73(_0xdc7c92):_0x43fc68({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x2f7ba0,_0x579e12,_0x1ad78e,_0x326cd7,_0x536731,_0x3a38ce,_0x3cf156,_0x303b49)=>{const _0x88841c=await createMessageID(_0x536731);return new Promise((_0x3a801c,_0x2af92c)=>{if(!_0x579e12||!_0x1ad78e||!_0x326cd7||!_0x88841c||!_0x3a38ce)return _0x2af92c({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x88841c);const _0x5606f4='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x5606f4,[_0x1ad78e,_0x326cd7,_0x88841c,_0x3a38ce,_0x3cf156,_0x303b49,_0x579e12],function(_0x2da087){if(_0x2da087)_0x2af92c({'status':'error','message':_0x2da087['message']});else this['changes']===0x0?_0x2af92c({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x3a801c({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x4430f7,_0x476464,_0x295aec,_0x2be9bb,_0x2d2d77)=>{return new Promise((_0x119fb8,_0xe3c38e)=>{const _0xa1107a='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0xa1107a,[_0x476464,_0x295aec,_0x2be9bb,_0x2d2d77],function(_0x4b22c8){return _0x4b22c8?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x4b22c8['message']),_0xe3c38e('insert-dm-response',{'success':![],'message':_0x4b22c8['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x119fb8('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x556ca5=>{return new Promise((_0x4c8e92,_0x4f7c22)=>{const _0x45a33a='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x45a33a,[_0x556ca5],(_0x190fb6,_0x2453c1)=>{if(_0x190fb6)_0x4f7c22({'status':'error','message':_0x190fb6['message']});else{if(_0x2453c1)_0x4c8e92(_0x2453c1['message_id']);else{const _0x127027='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x127027,[_0x556ca5],function(_0x263a5e){_0x263a5e?_0x4f7c22({'status':'error','message':_0x263a5e['message']}):_0x4c8e92(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x5f11fe,_0x4d0768)=>{return new Promise((_0x2ab350,_0x293d29)=>{const _0x198606='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x4d0768;db['get'](_0x198606,(_0x36c3cf,_0x4fe6a8)=>{_0x36c3cf?_0x293d29({'status':'error','message':_0x36c3cf['message']}):_0x2ab350({'status':'success','count':_0x4fe6a8['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x3b4642,_0x2e4778){try{const _0x351634=await new Promise((_0x40b6f1,_0x5b547f)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x2e4778],(_0x1111cc,_0x1b8d02)=>{if(_0x1111cc)_0x5b547f(_0x1111cc);else{if(_0x1b8d02['length']>0x0){let _0x4a7e93=JSON['parse'](_0x1b8d02[0x0]['cookie']);console['log'](_0x4a7e93),_0x40b6f1(_0x4a7e93);}else _0x5b547f(new Error('User\x20with\x20username\x20'+_0x2e4778+'\x20does\x20not\x20exist.'));}});});await _0x3b4642['setCookie'](..._0x351634),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x3b4f77){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x3b4f77);}}async function saveCookiesForUser(_0x255660,_0x23a7e5){try{const _0x424810=await _0x255660['cookies']();if(!_0x424810||_0x424810['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x23a7e5);const _0x36af13=JSON['stringify'](_0x424810);if(_0x36af13['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x23a7e5);return new Promise((_0xdd5065,_0x432d61)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x23a7e5],(_0x449778,_0x21b1e4)=>{if(_0x449778)return console['error']('Error\x20checking\x20user\x20existence:',_0x449778),_0x432d61(_0x449778);if(_0x21b1e4){const _0x980eaa=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x980eaa['run'](_0x36af13,_0x23a7e5,function(_0x741dd2){return _0x741dd2?(console['error']('Error\x20updating\x20cookies:',_0x741dd2),_0x432d61(_0x741dd2)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x23a7e5),_0xdd5065());});}else{const _0x5c5437=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x5c5437['run'](_0x23a7e5,_0x36af13,function(_0x2097e0){return _0x2097e0?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x2097e0),_0x432d61(_0x2097e0)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x23a7e5),_0xdd5065());});}});});}catch(_0x2880b4){console['error']('Error\x20fetching\x20cookies:',_0x2880b4);throw _0x2880b4;}}async function createUserIfNotExists(_0x8e1cf3){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x8e1cf3],(_0x2fdfd2,_0x5611e6)=>{if(_0x2fdfd2){console['error']('Error\x20checking\x20user\x20existence:',_0x2fdfd2);throw _0x2fdfd2;}else{if(!_0x5611e6){const _0x337e81=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x337e81['run'](_0x8e1cf3,function(_0x425290){_0x425290?console['error']('Error\x20inserting\x20new\x20user:',_0x425290):console['log']('New\x20user\x20created:',_0x8e1cf3);});}else console['log']('User\x20already\x20exists:',_0x8e1cf3);}});}catch(_0x21bf5a){console['error']('Error\x20creating\x20user:',_0x21bf5a);throw _0x21bf5a;}}ipcMain['handle']('create-relation',async(_0x49d881,_0x2ac5e9)=>{return new Promise((_0x5031f7,_0x2efce9)=>{const _0x19820e='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x2ac5e9+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x19820e,function(_0x323a07){_0x323a07?_0x2efce9(_0x323a07):_0x5031f7({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x15fc98,_0x3e8387)=>{return console['log']('droping\x20table'+_0x3e8387),new Promise((_0x2eb738,_0x39da39)=>{const _0x115777='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x3e8387;console['log']('droping\x20table'+_0x3e8387),db['run'](_0x115777,function(_0x273963){_0x273963?_0x39da39(_0x273963):_0x2eb738({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x34d653=>{return new Promise((_0x55a8c0,_0x4505bf)=>{const _0xa9bdad='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0xa9bdad,[],(_0x57c4b8,_0x2f8cae)=>{_0x57c4b8?_0x4505bf(_0x57c4b8):_0x55a8c0(_0x2f8cae['map'](_0x589130=>_0x589130['name']));});});}),ipcMain['handle']('add-user',async(_0x551406,_0x4626bb,_0x23a595)=>{return new Promise(_0x4c78d9=>{const _0x41b32a=db['prepare']('INSERT\x20INTO\x20'+_0x23a595+'\x20(username)\x20VALUES\x20(?)');_0x41b32a['run'](_0x4626bb,function(_0x1c225a){_0x1c225a?console['log']('error\x20in\x20add-user:'+_0x1c225a):_0x4c78d9({'status':'success','id':this['lastID']});}),_0x41b32a['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x3c3c97,_0x5150a5)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x1bcf21,_0x13022d)=>{if(_0x1bcf21)_0x5150a5(_0x1bcf21);else{_0x3c3c97({'status':'success','users':_0x13022d});for(_0x13022d of _0x13022d){console['log'](_0x13022d['username']);}}});});}),ipcMain['handle']('get-data',async(_0x38ca5f,_0x59514f)=>{return new Promise((_0xb72a86,_0x401aca)=>{const _0x4e511f='SELECT\x20*\x20FROM\x20'+_0x59514f;console['log'](_0x4e511f),db['all'](_0x4e511f,[],(_0x2e27a5,_0x99369f)=>{_0x2e27a5?_0x401aca(_0x2e27a5):_0xb72a86(_0x99369f);});});}),ipcMain['handle']('get-accounts',async _0x25f22b=>{return new Promise((_0x14bb85,_0x3e2682)=>{const _0x3402da='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x3402da),igaccountsDB['all'](_0x3402da,[],(_0x402d82,_0x2f5f79)=>{_0x402d82?_0x3e2682(_0x402d82):_0x14bb85(_0x2f5f79);});});}),ipcMain['handle']('get-targets',async(_0x2528e4,_0x101c91)=>{return getTargetProfiles(_0x101c91);}),ipcMain['handle']('delete-user',async(_0xcd8392,_0x3f5aa8,_0x3f8175)=>{return new Promise((_0x186580,_0x9ee151)=>{const _0x14fb07=db['prepare']('DELETE\x20FROM\x20'+_0x3f8175+'\x20WHERE\x20username\x20=\x20?');_0x14fb07['run'](_0x3f5aa8,function(_0xc7c1e3){_0xc7c1e3?_0x9ee151(_0xc7c1e3):_0x186580({'status':'success','changes':this['changes']});}),_0x14fb07['finalize']();});}),ipcMain['handle']('delete-account',async(_0xeb8b31,_0x13ce5d)=>{const _0x5d77de=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x5d77de['run'](_0x13ce5d,function(_0x3f449d){_0x3f449d&&console['log'](_0x3f449d);}),_0x5d77de['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x23f803,_0x5342b1)=>{const _0x256a82='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x256a82,[],(_0x2474d7,_0xb25bec)=>{_0x2474d7?_0x5342b1({'status':'error','message':_0x2474d7['message']}):_0x23f803({'status':'success','contactedCount':_0xb25bec['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x29fcd8,_0x4d52b6)=>{const _0x1222b7='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x1222b7,[],(_0x183f06,_0x2b2e9f)=>{_0x183f06?_0x4d52b6({'status':'error','message':_0x183f06['message']}):_0x29fcd8({'status':'success','contactedCount':_0x2b2e9f['contactedCount']});});});});function exportDatabase(_0x33530a){return new Promise((_0x50bdeb,_0x1406a7)=>{const _0x43d5db='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x33530a+'\x0a\x20\x20\x20\x20';db['all'](_0x43d5db,[],async(_0x3d0dd0,_0x11cb62)=>{if(_0x3d0dd0){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x3d0dd0['message']),_0x1406a7(_0x3d0dd0);return;}if(!_0x11cb62||_0x11cb62['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x50bdeb();return;}const _0x41ede5=XLSX['utils']['json_to_sheet'](_0x11cb62),_0x44cdd6=XLSX['utils']['sheet_to_csv'](_0x41ede5);try{const {canceled:_0x39a6fd,filePath:_0x2b01ba}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x33530a+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x39a6fd||!_0x2b01ba){console['log']('Speichern\x20abgebrochen.'),_0x50bdeb();return;}fs['writeFile'](_0x2b01ba,_0x44cdd6,'utf8',_0x2b77f8=>{_0x2b77f8?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x2b77f8['message']),_0x1406a7(_0x2b77f8)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x2b01ba),_0x50bdeb());});}catch(_0x353ec5){console['error']('Fehler\x20im\x20Speicherdialog:',_0x353ec5),_0x1406a7(_0x353ec5);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x355843,_0x49e543)=>{shell['openExternal'](_0x49e543);});