const {app,BrowserWindow,ipcMain,dialog}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose']();function createWindow(){const _0x59cf98=new BrowserWindow({'width':0x320,'height':0x258,'webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x59cf98['loadFile'](path['join'](__dirname,'index.html'));}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x5460b2){var _0x20f4bd=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x8b3d62){console['log']('window\x20id:'+_0x8b3d62['id']),_0x8b3d62['id']>0x1&&(_0x20f4bd=!![]);}),console['log']('child\x20opened\x20='+_0x20f4bd);if(!_0x20f4bd){const _0x549d6b=new BrowserWindow({'width':0x320,'height':0x258,'webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x549d6b['loadFile'](_0x5460b2['url']);}else console['log']('child\x20window\x20opened\x20already');}let browser=null,page=null,isStopping=![];async function getBrowserPage(){let _0x39aa13='';if(process['platform']==='darwin')_0x39aa13='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome';else{if(process['platform']==='win32')_0x39aa13='chromium_local/chrome-win/chrome.exe';else{if(process['platform']==='linux'){}}}return(browser===null||page['isClosed']())&&(browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0x39aa13})),(page===null||page['isClosed']())&&(page=await browser['newPage'](),page['setDefaultNavigationTimeout'](0x1d4c),page['setDefaultTimeout'](0x1d4c)),page;}ipcMain['on']('login',async(_0x1a6718,_0x5a0dda,_0x457d8f)=>{const _0x3d91a2=await getBrowserPage();await _0x3d91a2['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x3d91a2,_0x5a0dda,_0x457d8f),setTimeout(async()=>{await browser['close']();},0x1388);}),ipcMain['handle']('sendMessage',async(_0x19fcaf,_0x3702c0,_0x205001,_0x346905,_0x48f9a5)=>{isStopping=![];const _0xf7a1fa=await getBrowserPage();return console['log']('send\x20Message\x20gestartet'),console['log'](_0x3702c0),new Promise((_0x1185a2,_0x480a43)=>{send_message(_0xf7a1fa,_0x3702c0,_0x205001,_0x346905,_0x48f9a5)['then'](_0x2caaf4=>_0x1185a2(_0x2caaf4))['catch'](_0x288eef=>_0x480a43(_0x288eef));});}),ipcMain['handle']('stop-action',async _0x5867d6=>{isStopping=!![];const _0x4a4ec0=await getBrowserPage();await _0x4a4ec0['close']();}),ipcMain['handle']('fetch_followers',async(_0x529500,_0x1ff52c,_0x4ef14c,_0x1db945,_0x3f3b1a)=>{isStopping=![];const _0x3f570f=await getBrowserPage();return fetch_followers_from_account(_0x3f570f,_0x1ff52c,_0x4ef14c,_0x1db945,_0x3f3b1a);}),ipcMain['handle']('fetch_likes',async(_0x5f774f,_0x1ed5c6,_0xfe696a,_0xb6e3d,_0x26c29c)=>{isStopping=![];const _0x4d967a=await getBrowserPage();return fetch_likers_from_post(_0x4d967a,_0x1ed5c6,_0xfe696a,_0xb6e3d,_0x26c29c);}),ipcMain['handle']('fetch_comments',async(_0x334bda,_0x1f8aa1,_0x12a70d,_0x476338,_0x18fc6b)=>{isStopping=![];const _0x3e05ba=await getBrowserPage();return fetch_comments_from_post(_0x3e05ba,_0x1f8aa1,_0x12a70d,_0x476338,_0x18fc6b);}),ipcMain['handle']('update-app',async _0x18099a=>{const {spawn:_0x16cc6f}=require('child_process'),_0x3560d9=require('path');if(process['platform']==='darwin'){const _0x3a1fce=_0x3560d9['join'](__dirname,'mac-updater-intern.sh'),_0xc53144=_0x16cc6f('/bin/bash',[_0x3a1fce]);_0xc53144['stdout']['on']('data',_0x309312=>{console['log']('stdout:\x20'+_0x309312);}),_0xc53144['stderr']['on']('data',_0x23eedb=>{console['error']('stderr:\x20'+_0x23eedb);}),_0xc53144['on']('close',_0x3c971a=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x3c971a);});}else{if(process['platform']==='win32'){const _0x5d7bfd=_0x3560d9['join'](__dirname,'../','../','../');process['chdir'](_0x5d7bfd),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x227ad7='soft-ui-updater-windows.ps1',_0x2bb1b0='soft-ui-updater-windows.exe',_0x552609=_0x16cc6f('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x227ad7]);console['log']('Windows\x20Pfad:\x20'+_0x5d7bfd),_0x552609['stdout']['on']('data',_0x2f6a5b=>{console['log']('stdout:\x20'+_0x2f6a5b);}),_0x552609['stderr']['on']('data',_0x2c5d1c=>{console['error']('stderr:\x20'+_0x2c5d1c);}),_0x552609['on']('close',_0x133acb=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x133acb);});}}});function getRnd(_0x24208e,_0x1ef858){return Math['random']()*(_0x1ef858-_0x24208e+0x1)+_0x24208e;}function delay(_0x17eccf,_0x351d92){let _0x26df9c=getRnd(_0x17eccf,_0x351d92);return new Promise(function(_0x202173){setTimeout(_0x202173,_0x26df9c);});}async function scroll(_0x20de89,_0x598460,_0x5c7b79=0x2){const _0x51ac95=await _0x20de89['waitForSelector'](_0x598460);for(let _0x138260=0x0;_0x138260<_0x5c7b79;_0x138260++){console['log']('Scrolling\x20'+_0x138260),await _0x20de89['evaluate'](_0x260751=>{const _0x10b942=document['querySelector'](_0x260751);_0x10b942&&_0x10b942['scrollBy'](0x0,0x190);},_0x598460),await delay(0x320,0x5dc);}}async function saveCookies(_0x5c6212){let _0x471b70=await _0x5c6212['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x471b70,null,0x2));}async function notificationClear(_0x3d63fa){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x3d63fa['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x3d63fa['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x16173c){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x16173c);}}async function getTargetProfiles(_0x5becd4){return new Promise((_0x462be9,_0x2f555d)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x5becd4,(_0x1a452c,_0x592f86)=>{_0x1a452c?_0x2f555d(_0x1a452c):_0x462be9(_0x592f86);});});}async function login(_0x37dbf5,_0x3e188e,_0x271c4d){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x37dbf5,_0x3e188e),await createUserIfNotExists(_0x3e188e,_0x271c4d);}catch(_0x4f1b09){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4f1b09);}try{await _0x37dbf5['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x37dbf5['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x37dbf5['click']('button._a9--._ap36._a9_0');}catch(_0x3694a6){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x37dbf5['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x37dbf5['type']('input[name=\x27username\x27]',_0x3e188e,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x37dbf5['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x37dbf5['type']('input[name=\x27password\x27]',_0x271c4d,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x37dbf5['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x37dbf5['click']('button[type=\x27submit\x27]');}catch(_0x43935c){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x37dbf5),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x37dbf5,_0x3e188e);}catch(_0x5cea4a){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x5cea4a);}}catch(_0xc9db9f){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0xc9db9f);}}async function send_message(_0x2692e6,_0x50dc7a,_0x52cdb5,_0x33c0b0,_0x38308a){console['log'](_0x38308a),console['log']('Anfang'),console['log']('Counter:\x20'+_0x33c0b0);if(_0x33c0b0==0x0){try{console['log'](_0x38308a),await login(_0x2692e6,_0x38308a['username'],_0x38308a['password']);}catch(_0xd0a1bc){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0xd0a1bc);return;}await _0x2692e6['goto']('https://www.instagram.com/direct/inbox/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x2692e6);}try{try{const _0x2e2379='div.x1i10hfl.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.x6s0dn4.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x1ypdohk.x78zum5.xl56j7k.x1y1aw1k.x1sxyh0.xwib8y2.xurb0ha.xcdnw81';await delay(0xfa0,0x1d4c),await _0x2692e6['waitForSelector'](_0x2e2379),await _0x2692e6['click'](_0x2e2379),console['log']('Message-Button\x20geklickt'),console['log'](_0x50dc7a+'\x20'+_0x52cdb5),await delay(0xfa0,0x1d4c);try{const _0x5b57cb='input[name=\x22queryBox\x22]',_0x353f43='body\x20>\x20div.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x1k90msu.x6o7n8i.x1qfuztq.x10l6tqk.x17qophe.x13vifvy.x1hc1fzr.x71s49j.xh8yej3\x20>\x20div\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.x1q0g3np.x1a02dak.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20input';await _0x2692e6['waitForSelector'](_0x353f43),await _0x2692e6['click'](_0x353f43),await delay(0xfa0,0x1d4c),await _0x2692e6['waitForSelector'](_0x5b57cb),await _0x2692e6['click'](_0x5b57cb),await delay(0xfa0,0x1d4c),await _0x2692e6['type'](_0x5b57cb,_0x50dc7a,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),console['log']('Account\x20Name\x20eingefügt');const _0x1164b7='div.xnkg4db.x1xling4.x13ywhbb.x178cd7z.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x1k90msu.x6o7n8i.x1qfuztq.x17qophe.x10l6tqk.x13vifvy.x1hc1fzr.x71s49j.xh8yej3\x20>\x20div\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x6ikm8r.x1rife3k.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div:nth-child(',_0x4a581d=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1pi30zi.x1swvt13.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z.x78zum5.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span';let _0x26dfb2=0x1;try{while(_0x26dfb2!=0x14){console['log']('Schleife');let _0x522b5=_0x1164b7+_0x26dfb2+_0x4a581d;const _0x3c6aa5=await _0x2692e6['waitForSelector'](_0x522b5),_0x5ab7f2=await _0x2692e6['evaluate'](_0x2e51fc=>_0x2e51fc['innerHTML'],_0x3c6aa5);console['log'](_0x5ab7f2+'\x20'+_0x50dc7a),delay(0x3e8,0xbb8);if(_0x5ab7f2==_0x50dc7a){console['log']('Account\x20gefunden'),await _0x2692e6['click'](_0x522b5);break;}_0x26dfb2++;}try{await delay(0xbb8,0x1388);const _0x421c9f=await _0x2692e6['waitForSelector']('div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.x972fbf.xcfux6l.x1qhh985.xm0m39n.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.xexx8yu.x18d9i69.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1lq5wgf.xgqcy7u.x30kzoy.x9jhf4c.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x9bdzbf.x1ypdohk.x78zum5.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x1n2onr6.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xn3w4p2.x5ib6vp.xc73u3c.x1tu34mt.xzloghq');console['log'](_0x421c9f),await delay(0xbb8,0x1388),await _0x421c9f['click']();try{await delay(0xbb8,0x1388);const _0x2de171=await _0x2692e6['waitForSelector']('div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1i64zmx.xw3qccf.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f.notranslate');await _0x2de171['type'](_0x52cdb5,{'delay':getRnd(0x50,0x78)}),await delay(0xbb8,0x1388);try{const _0x8148e9=await _0x2692e6['waitForSelector']('div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.xfs2ol5[role=\x22button\x22][tabindex=\x220\x22]');return await _0x8148e9['click'](),await delay(0xbb8,0x1388),new Promise(_0x3528b2=>{_0x3528b2('Nachricht\x20erfolgreich\x20verschickt!');});}catch(_0x3f61cb){console['log']('Message-Button\x20nicht\x20geklickt:\x20'+_0x3f61cb);}}catch(_0x23c5b7){console['log']('Chat-Fenster\x20nicht\x20gefunden:\x20'+_0x23c5b7);}}catch(_0x4620c5){console['log']('error:\x20'+_0x4620c5);}}catch(_0x16839e){console['log']('User\x20nicht\x20gefunden:'+_0x16839e);}}catch(_0xc9736){console['log']('DM-Fenster\x20nicht\x20gefunden:'+_0xc9736);}}catch(_0x3f7352){console['log']('Message-Button\x20nicht\x20geklickt:'+_0x3f7352);}}catch(_0x358df9){console['log']('Nachricht\x20senden\x20fehlgeschlagen:\x20'+_0x358df9);}return console['log']('Ende'),new Promise((_0x21834b,_0x501a6d)=>{_0x501a6d('Fehler\x20beim\x20Anschreiben.\x20Lade\x20bitte\x20die\x20neuste\x20Version\x20herunter');});}function handle_fail(_0x3b3c45){if(isStopping)return new Promise(_0xc44529=>{_0xc44529('Scraper\x20gestoppt.');});else{let _0x5d32ca='';switch(_0x3b3c45){case 0x0:_0x5d32ca='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x5d32ca='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x5d32ca='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x5d32ca='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x16057d,_0x1ba64c)=>{_0x1ba64c(_0x5d32ca);});}}async function fetch_followers_from_account(_0x203798,_0xa882f2,_0x46d619,_0xaad61c,_0x875537){try{await login(_0x203798,_0x875537['username'],_0x875537['password']);}catch(_0x54dddb){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x54dddb),handle_fail(0x0);}let _0x3a24e9=0x0;try{await _0x203798['goto']('https://www.instagram.com/'+_0xa882f2+'/'),await notificationClear(_0x203798);try{if(_0x46d619<=0x0){const _0x5bcc92=await _0x203798['waitForSelector']('div.x9f619.x1n2onr6\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span');await delay(0x12c,0x320);const _0x2adc4a=await _0x203798['evaluate'](_0x411178=>_0x411178['innerHTML'],_0x5bcc92);_0x3a24e9=Math['ceil'](_0x2adc4a/0x4);}else _0x3a24e9=Math['ceil'](_0x46d619/0x4);let _0x3f8f43=await _0x203798['waitForSelector']('div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a');await delay(0xbb8,0x1388),await _0x3f8f43['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0xa882f2+'\x20gesichtet');}catch(_0x1bb298){return console['log']('Follower\x20Liste\x20von\x20'+_0xa882f2+'\x20nicht\x20gefunden:'+_0x1bb298),handle_fail(0x0);}}catch(_0x20e07f){return console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x20e07f),handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x3a24e9),await scroll(_0x203798,'div.xnkg4db.x1xling4\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x1h91t0o\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x7r02ix.xf1ldfh\x20>\x20div\x20>\x20div\x20>\x20div.xyi19xy.x1pc53ja.x1lliihq.x1iyjqo2',_0x3a24e9),await _0x203798['waitForSelector']('a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd');const _0x1d52ca=await _0x203798['$$']('a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd');_0x46d619<=0x0&&(_0x46d619=_0x1d52ca['length']);for(let _0x40187e=0x0;_0x40187e<_0x1d52ca['length']&&_0x40187e<_0x46d619;_0x40187e++){console['log'](await _0x1d52ca[_0x40187e]['evaluate'](_0x29bbce=>_0x29bbce['textContent']));const _0x29a99b=await db['prepare']('INSERT\x20INTO\x20'+_0xaad61c+'\x20(username)\x20VALUES\x20(?)');await _0x29a99b['run'](await _0x1d52ca[_0x40187e]['evaluate'](_0x50595c=>_0x50595c['textContent']),function(_0x58fe9b){_0x58fe9b&&console['log']('error\x20in\x20add-user:'+_0x58fe9b);}),await _0x29a99b['finalize']();}return new Promise(_0x4e5c80=>{_0x4e5c80('Scraping\x20finished!');});}catch(_0x56929f){return console['log']('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0xa882f2+'\x20nicht\x20gefunden:'+_0x56929f),handle_fail(0x0);}}async function fetch_likers_from_post(_0x4875f8,_0x229e15,_0x30835e,_0x26b98a,_0x4f3748){try{await login(_0x4875f8,_0x4f3748['username'],_0x4f3748['password']);}catch(_0x4c622d){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4c622d);return handle_fail(0x1);return;}try{let _0x24ac6a=_0x229e15['substring'](0x0,_0x229e15['lastIndexOf']('/')),_0x57697b=_0x24ac6a+'/liked_by';console['log'](_0x57697b),await _0x4875f8['goto'](_0x57697b),await delay(0x7d0,0xfa0),await notificationClear(_0x4875f8),await delay(0xc8,0x1f4);let _0x1b4153='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd';await _0x4875f8['waitForSelector'](_0x1b4153),await delay(0x1f4,0x320);const _0x5367aa=await _0x4875f8['$$'](_0x1b4153);await delay(0x1f4,0x320),console['log'](_0x5367aa['length']);let _0x4818bf=path['join'](__dirname,'/likers.csv');_0x30835e<=0x0&&(_0x30835e=_0x5367aa['length']);try{for(let _0x3b7bfd=0x0;_0x3b7bfd<_0x5367aa['length']&&_0x3b7bfd<_0x30835e;_0x3b7bfd++){console['log'](await _0x5367aa[_0x3b7bfd]['evaluate'](_0x464aca=>_0x464aca['textContent']));try{const _0x99574c=await db['prepare']('INSERT\x20INTO\x20'+_0x26b98a+'\x20(username)\x20VALUES\x20(?)');await _0x99574c['run'](await _0x5367aa[_0x3b7bfd]['evaluate'](_0x470485=>_0x470485['textContent']),function(_0x31dd5c){_0x31dd5c&&console['log']('error\x20in\x20add-user:'+_0x31dd5c);}),await _0x99574c['finalize']();}catch(_0x27e864){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x3b7bfd+'\x20:\x20'+_0x27e864),handle_fail(0x1);}}return new Promise(_0x3d9763=>{_0x3d9763('Scraping\x20finished!');});}catch(_0x22d4f8){return console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben'),handle_fail(0x1);}}catch(_0x100b24){return console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x100b24),handle_fail(0x1);}}async function fetch_comments_from_post(_0x3034e1,_0x3148ec,_0x2fd6b6,_0x623a7a,_0x2761b5){try{await login(_0x3034e1,_0x2761b5['username'],_0x2761b5['password']);}catch(_0x49d505){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x49d505),handle_fail(0x2);}try{console['log'](_0x3148ec),await _0x3034e1['goto'](_0x3148ec),await delay(0x7d0,0xfa0),await notificationClear(_0x3034e1),await delay(0xc8,0x1f4);const _0x21766a='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6';let _0x4bb133;if(_0x2fd6b6<=0x0){const _0x10bc24=await _0x3034e1['waitForSelector']('div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span');await delay(0x12c,0x320);let _0x2af369=await _0x3034e1['evaluate'](_0x92c4bd=>_0x92c4bd['innerHTML'],_0x10bc24),_0x29aadd=String(_0x2af369)['replace'](/[^0-9]/g,''),_0x3bc6ac=Number(_0x29aadd)/0x14;_0x4bb133=Math['ceil'](_0x3bc6ac/0x3);}else _0x4bb133=Math['ceil'](_0x2fd6b6/0x3);console['log']('Auto-scrolls:\x20'+_0x4bb133),await scroll(_0x3034e1,_0x21766a,_0x4bb133);try{const _0x548dcf='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span';await _0x3034e1['waitForSelector'](_0x548dcf),await delay(0x1f4,0x320);const _0x4fee74=await _0x3034e1['$$'](_0x548dcf);console['log'](_0x4fee74),await delay(0xc8,0x1f4);try{for(let _0x92b206=0x0;_0x92b206<_0x4fee74['length'];_0x92b206++){_0x4fee74[_0x92b206]['click'](),await delay(0x320,0x5dc);}}catch(_0x20040c){return console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x20040c),handle_fail(0x2);}}catch(_0xc83338){return console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt'),handle_fail(0x2);}const _0x44b585='span._ap3a._aaco._aacw._aacx._aad7._aade';await _0x3034e1['waitForSelector'](_0x44b585),await delay(0x1f4,0x320);const _0x239775=await _0x3034e1['$$'](_0x44b585);let _0x7ef717=path['join'](__dirname,'/comments.csv');_0x2fd6b6<=0x0&&(_0x2fd6b6=_0x239775['length']);console['log']('fetch_limit:\x20'+_0x2fd6b6),console['log']('comments_len:\x20'+_0x239775['length']),_0x2fd6b6++;try{for(let _0x2da84a=0x1;_0x2da84a<_0x239775['length']&&_0x2da84a<_0x2fd6b6;_0x2da84a++){try{console['log'](await _0x239775[_0x2da84a]['evaluate'](_0x456ffd=>_0x456ffd['textContent']));const _0x576268=await db['prepare']('INSERT\x20INTO\x20'+_0x623a7a+'\x20(username)\x20VALUES\x20(?)');await _0x576268['run'](await _0x239775[_0x2da84a]['evaluate'](_0x2f186a=>_0x2f186a['textContent']),function(_0x165f2f){_0x165f2f&&console['log']('error\x20in\x20add-user:'+_0x165f2f);}),await _0x576268['finalize']();}catch(_0x2cfe43){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x2da84a+'\x20:\x20'+_0x2cfe43),handle_fail(0x2);}}return new Promise(_0x1cd009=>{_0x1cd009('Scraping\x20finished!');});}catch(_0xb244c9){return console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben'),handle_fail(0x2);}}catch(_0x52fa10){return console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x52fa10),handle_fail(0x2);}}const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20password\x20TEXT,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x34e4ee,_0x2581bb){try{const _0x3d740c=await new Promise((_0x5ba9e6,_0x59d21e)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x2581bb],(_0x695032,_0x44add7)=>{if(_0x695032)_0x59d21e(_0x695032);else{if(_0x44add7['length']>0x0){let _0xe84fb0=JSON['parse'](_0x44add7[0x0]['cookie']);console['log'](_0xe84fb0),_0x5ba9e6(_0xe84fb0);}else _0x59d21e(new Error('User\x20with\x20username\x20'+_0x2581bb+'\x20does\x20not\x20exist.'));}});});await _0x34e4ee['setCookie'](..._0x3d740c),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x3e6374){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x3e6374);}}async function saveCookiesForUser(_0x28ff38,_0x50033b){try{let _0x423613=await _0x28ff38['cookies']();_0x423613=JSON['stringify'](_0x423613),igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x50033b],(_0x2b1b5b,_0x10adc9)=>{if(_0x2b1b5b){console['error']('Error\x20checking\x20user\x20existence:',_0x2b1b5b);throw _0x2b1b5b;}else{if(_0x10adc9){const _0x36cfab=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x36cfab['run'](_0x423613,_0x50033b,function(_0x166b94){_0x166b94?console['error']('Error\x20updating\x20cookies:',_0x166b94):console['log']('Cookies\x20updated\x20for\x20user:',_0x50033b);});}else{const _0xa7fe4=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0xa7fe4['run'](_0x50033b,_0x423613,function(_0x44e32e){_0x44e32e?console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x44e32e):console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x50033b);});}}});}catch(_0x4db1d5){console['error']('Error\x20fetching\x20cookies:',_0x4db1d5);throw _0x4db1d5;}}async function createUserIfNotExists(_0x1014e5,_0x1637e4){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x1014e5],(_0x238e5b,_0x276415)=>{if(_0x238e5b){console['error']('Error\x20checking\x20user\x20existence:',_0x238e5b);throw _0x238e5b;}else{if(!_0x276415){const _0x13fbd3=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20password)\x20VALUES\x20(?,\x20?)');_0x13fbd3['run'](_0x1014e5,_0x1637e4,function(_0x26ef24){_0x26ef24?console['error']('Error\x20inserting\x20new\x20user:',_0x26ef24):console['log']('New\x20user\x20created:',_0x1014e5);});}else console['log']('User\x20already\x20exists:',_0x1014e5);}});}catch(_0x3b0813){console['error']('Error\x20creating\x20user:',_0x3b0813);throw _0x3b0813;}}ipcMain['handle']('create-relation',async(_0xfbcdae,_0x35bf9b)=>{return new Promise((_0x16377c,_0x194427)=>{const _0x187545='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x35bf9b+'\x20(username\x20TEXT\x20PRIMARY\x20KEY)';db['run'](_0x187545,function(_0xca4d3e){_0xca4d3e?_0x194427(_0xca4d3e):_0x16377c({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x2269aa,_0x4793f9)=>{return console['log']('droping\x20table'+_0x4793f9),new Promise((_0x120317,_0x2c93fa)=>{const _0x3c1426='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x4793f9;console['log']('droping\x20table'+_0x4793f9),db['run'](_0x3c1426,function(_0xacde3f){_0xacde3f?_0x2c93fa(_0xacde3f):_0x120317({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x7fc8a9=>{return new Promise((_0x588af3,_0x401df3)=>{const _0x24038f='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x24038f,[],(_0xf7c833,_0x485256)=>{_0xf7c833?_0x401df3(_0xf7c833):_0x588af3(_0x485256['map'](_0x5adf0c=>_0x5adf0c['name']));});});}),ipcMain['handle']('add-user',async(_0x44cdd6,_0x436389,_0x193b74)=>{return new Promise(_0x55ffc3=>{const _0x11d419=db['prepare']('INSERT\x20INTO\x20'+_0x193b74+'\x20(username)\x20VALUES\x20(?)');_0x11d419['run'](_0x436389,function(_0x13f2b1){_0x13f2b1?console['log']('error\x20in\x20add-user:'+_0x13f2b1):_0x55ffc3({'status':'success','id':this['lastID']});}),_0x11d419['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x540f01,_0x3814a9)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x597574,_0x268328)=>{if(_0x597574)_0x3814a9(_0x597574);else{_0x540f01({'status':'success','users':_0x268328});for(_0x268328 of _0x268328){console['log'](_0x268328['username']);}}});});}),ipcMain['handle']('get-data',async(_0x4f3acc,_0x30ad1a)=>{return new Promise((_0x47dc26,_0x14f71e)=>{const _0x22c849='SELECT\x20*\x20FROM\x20'+_0x30ad1a;console['log'](_0x22c849),db['all'](_0x22c849,[],(_0x1d9a6d,_0x17c872)=>{_0x1d9a6d?_0x14f71e(_0x1d9a6d):_0x47dc26(_0x17c872);});});}),ipcMain['handle']('get-accounts',async _0x98d915=>{return new Promise((_0x41eae1,_0x3faf83)=>{const _0x4b0338='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x4b0338),igaccountsDB['all'](_0x4b0338,[],(_0xd9960a,_0x18665b)=>{_0xd9960a?_0x3faf83(_0xd9960a):_0x41eae1(_0x18665b);});});}),ipcMain['handle']('get-targets',async(_0x55fb41,_0x462b00)=>{return getTargetProfiles(_0x462b00);}),ipcMain['handle']('delete-user',async(_0x5c322e,_0x290e5f,_0x123cc1)=>{return new Promise((_0x1e0ba3,_0x147f5c)=>{const _0x567a7a=db['prepare']('DELETE\x20FROM\x20'+_0x123cc1+'\x20WHERE\x20username\x20=\x20?');_0x567a7a['run'](_0x290e5f,function(_0x375066){_0x375066?_0x147f5c(_0x375066):_0x1e0ba3({'status':'success','changes':this['changes']});}),_0x567a7a['finalize']();});}),ipcMain['handle']('delete-account',async(_0x2604d0,_0x5a6e6e)=>{const _0x30ba72=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x30ba72['run'](_0x5a6e6e,function(_0x5e5a3c){_0x5e5a3c&&console['log'](_0x5e5a3c);}),_0x30ba72['finalize']();});