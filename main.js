const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');async function extractFirstName(_0x417db3,_0x13eb1a){try{const _0x44c4f9=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x13eb1a},'body':JSON['stringify']({'clearname':_0x417db3})});if(!_0x44c4f9['ok']){const _0x4d5e1c=await _0x44c4f9['text']();throw new Error(_0x44c4f9['status']+':\x20'+_0x4d5e1c);}const _0x3aa6f7=await _0x44c4f9['json']();return _0x3aa6f7;}catch(_0x4f3393){console['error']('Error\x20in\x20extractFirstName:',_0x4f3393);throw _0x4f3393;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div:has(>\x20div[style=\x22height:\x20auto;\x20overflow:\x20hidden\x20auto;\x22])',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='[style=\x22line-height:\x2018px;\x22]',COM_COMMENTS_BOX_BODY_DIV='div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='//span[contains(.,\x20\x27View\x20all\x27)\x20and\x20contains(.,\x20\x27replies\x27)]',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Message\x27]','div.x9f619.xjbqb8w.x78zum5.x15mokao.x1ga7v0g.x16uus16.xbiv7yw.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div','div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div'],K_OPTIONS_BUTTON=['[aria-label=\x22Options\x22]','section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.x1jfgfrl\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div'],K_EXPAND_MSG_BUTTON='[aria-label=\x22Expand\x22]',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD=['[aria-label=\x22Message\x22]','div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f'],K_SEND_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Send\x27]','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_ALREADY_CHATTED='[aria-label=\x22Like\x22]',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',K_BEITRAG_ARRAY_SELECTOR='._aagv',K_BEITRAG_LIKE_BUTTON='section\x20>\x20span\x20>\x20div\x20>\x20div',K_STORY_ARRAY_SELECTOR='._acaz',K_STORY_LIKE_BUTTON='div.x6s0dn4.x78zum5.x67bb7w\x20>\x20div.x78zum5.xvc5jky\x20>\x20span\x20>\x20div\x20>\x20div',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x4f6d6e=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x4f6d6e['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x4f6d6e['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x476308){var _0xad460e=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x254b57){console['log']('window\x20id:'+_0x254b57['id']),_0x254b57['id']>0x1&&(_0xad460e=!![]);}),console['log']('child\x20opened\x20='+_0xad460e);if(!_0xad460e){const _0x38ceae=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x38ceae['loadFile'](_0x476308['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x436d1e=require('fs'),_0xbce9a0=path['join'](app['getPath']('userData'),'data'),_0x3becc4=['campaign.db','crm.db','igaccounts.db'],_0xda6dd6=[];try{_0x436d1e['mkdirSync'](_0xbce9a0,{'recursive':!![]});for(const _0x4f8204 of _0x3becc4){const _0x23481b=path['join'](process['resourcesPath'],'app','build','data',_0x4f8204),_0x3e5924=path['join'](_0xbce9a0,_0x4f8204);!_0x436d1e['existsSync'](_0x3e5924)?(_0x436d1e['copyFileSync'](_0x23481b,_0x3e5924),console['log']('[InitDB]\x20Kopiert\x20'+_0x4f8204+'\x20nach:\x20'+_0x3e5924)):console['log']('[InitDB]\x20'+_0x4f8204+'\x20existiert\x20bereits:\x20'+_0x3e5924),_0xda6dd6['push'](_0x3e5924);}}catch(_0x5975dc){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x5975dc);}return _0xda6dd6;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x50865b,AppUpdate:_0x409d51}=require('electron-updater');_0x50865b['autoDownload']=![],_0x50865b['autoInstallOnAppQuit']=!![],_0x50865b['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x50865b['on']('update-available',_0x2ac80e=>{console['log']('Update\x20verfügbar:',_0x2ac80e),_0x50865b['downloadUpdate']();}),_0x50865b['on']('update-downloaded',_0x2577b7=>{console['log']('Update\x20heruntergeladen:',_0x2577b7),_0x50865b['quitAndInstall']();}),_0x50865b['on']('error',_0x363233=>{console['error']('Fehler\x20beim\x20Updaten:',_0x363233);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x227f05,AppUpdate:_0x33099b}=require('electron-updater');_0x227f05['autoDownload']=![],_0x227f05['autoInstallOnAppQuit']=!![],_0x227f05['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x227f05['on']('update-available',_0x24f7a4=>{console['log']('Update\x20verfügbar:',_0x24f7a4),_0x227f05['downloadUpdate']();}),_0x227f05['on']('update-downloaded',_0x53cae9=>{console['log']('Update\x20heruntergeladen:',_0x53cae9),console['log']('Neustarten\x20zum\x20Updaten');}),_0x227f05['on']('error',_0x422ee1=>{console['error']('Fehler\x20beim\x20Updaten:',_0x422ee1);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let isHeadless=!![],browser_login=null;async function getBrowserPageLogin(){let _0x76b634='',_0x3cd8d1=null;if(process['platform']==='darwin')_0x76b634=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x76b634=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x76b634}),_0x3cd8d1=await browser_login['newPage'](),_0x3cd8d1['setDefaultNavigationTimeout'](0x3a98),_0x3cd8d1['setDefaultTimeout'](0x3a98),await _0x3cd8d1['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x3cd8d1;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x119553=0x1,_0x276922=0x0){try{let _0x107076='',_0x32c9ab=null;const _0x8f817e=isHeadless;if(process['platform']==='darwin')_0x107076=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x107076=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x119553===0x0&&!pageStack[_0x276922])return browser=await puppeteer['launch']({'headless':_0x8f817e,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x107076}),_0x32c9ab=await browser['newPage'](),_0x32c9ab['setDefaultNavigationTimeout'](0x1d4c),_0x32c9ab['setDefaultTimeout'](0x1d4c),await _0x32c9ab['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x276922]=_0x32c9ab,_0x32c9ab;return(browser===null||pageStack[_0x276922]===null||pageStack[_0x276922]['isClosed']())&&(browser=await puppeteer['launch']({'headless':isHeadless,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x107076})),(pageStack[_0x276922]===null||pageStack[_0x276922]['isClosed']())&&(_0x32c9ab=await browser['newPage'](),_0x32c9ab['setDefaultNavigationTimeout'](0x1d4c),_0x32c9ab['setDefaultTimeout'](0x1d4c),await _0x32c9ab['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x276922]=_0x32c9ab),pageStack[_0x276922];}catch(_0x436379){console['error']('Failed\x20to\x20launch\x20browser:',_0x436379);const _0x158f9e=new Error('Browser\x20konnte\x20nicht\x20gestartet\x20werden.\x20Bitte\x20starte\x20die\x20App\x20neu.\x20:\x20'+_0x436379);throw _0x158f9e;}}ipcMain['on']('login',async(_0x5d9f48,_0x1d1df6)=>{const _0x1a2c3d=await getBrowserPageLogin();await _0x1a2c3d['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x1a2c3d,_0x1d1df6),ipcMain['on']('setLoginCookies',async(_0x465ae4,_0x519876)=>{try{await set_login_cookies(_0x1a2c3d,_0x519876);}catch(_0x3cfb0f){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x3cfb0f);}});}),ipcMain['handle']('set-headless',async(_0xc07649,_0x338607)=>{return isHeadless=!!_0x338607,console['log']('[MAIN]\x20isHeadless\x20gesetzt\x20auf:',isHeadless),{'ok':!![],'headless':isHeadless};}),ipcMain['handle']('get-headless',async()=>{return{'headless':isHeadless};}),ipcMain['on']('export-relation',async(_0x4c12a9,_0x27b580)=>{try{await exportDatabase(_0x27b580),_0x4c12a9['reply']('export-relation-response',{'success':!![]});}catch(_0x10fca0){console['error'](_0x10fca0),_0x4c12a9['reply']('export-relation-response',{'success':![],'message':_0x10fca0['message']});}}),ipcMain['handle']('sendMessage',async(_0x12e5dc,_0x5c9359,_0x190b67,_0x1e6afa,_0x16d42c,_0x2f2c3a,_0x5a03cf,_0x4bff6c,_0x1809e9,_0x493975,_0x24b9d5,_0x5410e3,_0x4162c9)=>{isStopping=![];let _0x5df273=null;return _0x5a03cf?_0x5df273=await getBrowserPage(_0x16d42c,_0x4bff6c):_0x5df273=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x5c9359),send_message(_0x5df273,_0x5c9359,_0x190b67,_0x1e6afa,_0x16d42c,_0x2f2c3a,_0x1809e9,_0x493975,_0x24b9d5,_0x5410e3,_0x4162c9);}),ipcMain['handle']('stop-action',async(_0x332e00,_0x4fe2f5)=>{isStopping=!![];const _0x4d0af5=await getBrowserPage(0x1,_0x4fe2f5);await _0x4d0af5['close']();}),ipcMain['handle']('fetch_followers',async(_0x366742,_0x2d31a2,_0x40c14d,_0x3b8665,_0x1be010,_0x4ac2ad,_0x4abba9)=>{isStopping=![];const _0x5adb48=await getBrowserPage();return fetch_followers_from_account(_0x366742,_0x5adb48,_0x2d31a2,_0x40c14d,_0x3b8665,_0x1be010,_0x4ac2ad,_0x4abba9);}),ipcMain['handle']('get-account-details',async(_0x93670c,_0x521bbc,_0x657917,_0x31a5c1)=>{isStopping=![];const _0x57edb1=await getBrowserPage();return fetch_account_details(_0x57edb1,_0x521bbc,_0x657917,_0x31a5c1);}),ipcMain['handle']('fetch_likes',async(_0x2f9640,_0x5e8e6c,_0x196c9c,_0x3631a5,_0x122767,_0x2e16a1,_0x2b16a1)=>{isStopping=![];const _0x478ee6=await getBrowserPage();return fetch_likers_from_post(_0x2f9640,_0x478ee6,_0x5e8e6c,_0x196c9c,_0x3631a5,_0x122767,_0x2e16a1,_0x2b16a1);}),ipcMain['handle']('fetch_comments',async(_0x17ca12,_0x2b9c1d,_0x20e993,_0x26a99c,_0x470735,_0x391cbb,_0x24b5d2)=>{isStopping=![];const _0x3a4911=await getBrowserPage();return fetch_comments_from_post(_0x17ca12,_0x3a4911,_0x2b9c1d,_0x20e993,_0x26a99c,_0x470735,_0x391cbb,_0x24b5d2);});async function updateAppSilent(){const {spawn:_0x4968ab}=require('child_process'),_0x428b78=require('path'),_0x2b1d68=require('electron-log');return _0x2b1d68['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x463b3e,_0x460776)=>{const {updateElectronApp:_0x54963b,UpdateSourceType:_0x2ff31f}=require('update-electron-app');_0x54963b({'updateSource':{'type':_0x2ff31f['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x2b1d68}),_0x463b3e('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x31d27e,_0xa8c83c)=>{doFullElectronUpdateSilent(),_0x31d27e('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x2e28d6}=require('child_process'),_0x36456c=require('path'),_0x3e28db=require('electron-log');return _0x3e28db['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x1e7652,_0x158a5d)=>{const {updateElectronApp:_0x5c0816,UpdateSourceType:_0x2be920}=require('update-electron-app');_0x5c0816({'updateSource':{'type':_0x2be920['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x3e28db}),_0x1e7652('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x33337c,_0x26ea11)=>{doFullElectronUpdate(),_0x33337c('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0x1ac84d,_0x440cf3)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x1ac84d('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x3764f2=path['join'](__dirname,'mac-updater-intern.sh'),_0x47d58b=spawn('/bin/bash',[_0x3764f2],{'detached':!![],'stdio':'ignore'});_0x47d58b['unref'](),setTimeout(()=>{_0x1ac84d('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0x440cf3(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0x33a668=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x4dab84,_0x3d08fb)=>{console['log']('Update\x20Silent:\x20'+_0x3d08fb);if(_0x3d08fb){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0x56008b,_0x58c752){return Math['random']()*(_0x58c752-_0x56008b+0x1)+_0x56008b;}function delay(_0x9a1cbb,_0x103987){let _0x45e086=getRnd(_0x9a1cbb,_0x103987);return new Promise(function(_0x488293){setTimeout(_0x488293,_0x45e086);});}async function scroll(_0x3e4c1c,_0x556667,_0x4eea7c=0x2,_0x171a1a){const _0x1cd93e=await _0x3e4c1c['waitForSelector'](_0x556667);for(let _0x342b7c=0x0;_0x342b7c<_0x4eea7c;_0x342b7c++){console['log']('Scrolling\x20'+_0x342b7c),await _0x3e4c1c['evaluate'](_0x35091b=>{const _0x5a1052=document['querySelector'](_0x35091b);_0x5a1052&&_0x5a1052['scrollBy'](0x0,0x190);},_0x556667),await delay(0x320,0x5dc),_0x171a1a();}}async function saveCookies(_0x111e1f){let _0x57ff44=await _0x111e1f['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x57ff44,null,0x2));}async function notificationClear(_0x3ad4bd){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xfa0,0x1388),await _0x3ad4bd['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x3ad4bd['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x651dff){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x651dff);}}async function getTargetProfiles(_0x246370){return new Promise((_0x391ef1,_0xa2b7a0)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x246370,(_0x488207,_0x49c2df)=>{_0x488207?_0xa2b7a0(_0x488207):_0x391ef1(_0x49c2df);});});}async function login_legacy(_0x290882,_0x3b9e8f,_0x3e2c62){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x290882,_0x3b9e8f),await createUserIfNotExists(_0x3b9e8f,_0x3e2c62);}catch(_0xfe1d7e){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0xfe1d7e);}try{await _0x290882['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x290882['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x290882['click']('button._a9--._ap36._a9_0');}catch(_0x43a792){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x290882['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x290882['type']('input[name=\x27username\x27]',_0x3b9e8f,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x290882['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x290882['type']('input[name=\x27password\x27]',_0x3e2c62,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x290882['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x290882['click']('button[type=\x27submit\x27]');}catch(_0x243abf){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x290882),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x290882,_0x3b9e8f);}catch(_0x488d2a){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x488d2a);}}catch(_0x49014c){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x49014c);}}async function login(_0x3f6564,_0x52305e){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x3f6564,_0x52305e),await createUserIfNotExists(_0x52305e);}catch(_0x5cbf30){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5cbf30);}try{await _0x3f6564['goto']('https://www.instagram.com/accounts/login/');}catch(_0x5b007e){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x5b007e);}}async function set_login_cookies(_0x928af1,_0x12f168){try{await saveCookiesForUser(_0x928af1,_0x12f168);}catch(_0x53a773){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x53a773);}}async function waitForXPath(_0x148673,_0x380ccc,_0x2d6e34={}){return await _0x148673['waitForFunction'](_0x5c7078=>{return document['evaluate'](_0x5c7078,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x2d6e34,_0x380ccc),_0x148673['evaluateHandle'](_0xd6684=>document['evaluate'](_0xd6684,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x380ccc);}async function waitForSelectorWithFallbacks(_0xf42363,_0x1b1495,_0x11bedf={}){!Array['isArray'](_0x1b1495)&&(_0x1b1495=[_0x1b1495]);for(let _0x3ce032=0x0;_0x3ce032<_0x1b1495['length'];_0x3ce032++){const _0x4afb0b=_0x1b1495[_0x3ce032],_0x3cec11=_0x4afb0b['startsWith']('//')||_0x4afb0b['startsWith']('(//');try{console['log']('Versuche\x20'+(_0x3cec11?'XPath':'Selector')+'\x20'+(_0x3ce032+0x1)+'/'+_0x1b1495['length']+':\x20'+_0x4afb0b['substring'](0x0,0x32)+'...');const _0x3b7d7e=_0x3ce032===0x0?_0x11bedf['timeout']||0x1388:0x7d0;let _0x2093f0;if(_0x3cec11){const _0x206a0a=await waitForXPath(_0xf42363,_0x4afb0b,{..._0x11bedf,'timeout':_0x3b7d7e});if(!_0x206a0a)throw new Error('XPath-Element\x20nicht\x20gefunden');_0x2093f0=_0x206a0a;}else _0x2093f0=await _0xf42363['waitForSelector'](_0x4afb0b,{..._0x11bedf,'timeout':_0x3b7d7e});return console['log']((_0x3cec11?'XPath':'Selector')+'\x20'+(_0x3ce032+0x1)+'\x20gefunden!'),_0x2093f0;}catch(_0x495845){console['log']((_0x3cec11?'XPath':'Selector')+'\x20'+(_0x3ce032+0x1)+'\x20nicht\x20gefunden:\x20'+_0x495845['message']);if(_0x3ce032===_0x1b1495['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x1b1495['length']+'\x20Selektoren/XPath\x20konnte\x20gefunden\x20werden:\x20'+_0x495845['message']);}}throw new Error('Keine\x20Selektoren/XPath\x20angegeben');}async function waitForXPathAll(_0x43c237,_0x54fa1d,_0x4d4c8d={}){return await _0x43c237['waitForFunction'](_0x57d926=>{return document['evaluate'](_0x57d926,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null)['snapshotLength']>0x0;},_0x4d4c8d,_0x54fa1d),_0x43c237['evaluateHandle'](_0x24befa=>{const _0x48f46f=document['evaluate'](_0x24befa,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null),_0x231aa4=[];for(let _0x3bbc03=0x0;_0x3bbc03<_0x48f46f['snapshotLength'];_0x3bbc03++){_0x231aa4['push'](_0x48f46f['snapshotItem'](_0x3bbc03));}return _0x231aa4;},_0x54fa1d)['then'](_0x547032=>_0x547032['getProperties']());}ipcMain['handle']('check-login',async(_0x4400c2,_0x1e0e1a)=>{if(pageStack[0x0]){try{await pageStack[0x0]['close']();}catch(_0x7afebd){}pageStack[0x0]=null;}if(browser){try{await browser['close']();}catch(_0x243587){}browser=null;}const _0x1dfe4d=await getBrowserPage(0x0,0x0),_0x347caa=await checkCookiesSession(_0x1dfe4d,_0x1e0e1a);return _0x347caa;});async function checkCookiesSession(_0x4b0c98,_0x47aec0){try{await setCookiesForUser(_0x4b0c98,_0x47aec0),console['log']('Cookies\x20für\x20'+_0x47aec0+'\x20erfolgreich\x20geladen');}catch(_0x10bd8c){return console['error']('Fehler\x20beim\x20Laden\x20der\x20Cookies\x20für\x20'+_0x47aec0+':',_0x10bd8c),![];}try{await _0x4b0c98['goto']('https://www.instagram.com/',{'timeout':0x3a98});}catch(_0x3ae93d){console['error']('Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x3ae93d);}await delay(0x6a4,0x7d0);try{const _0x27c401=await checkLoginStatus(_0x4b0c98);return console['log']('Login-Status\x20für\x20'+_0x47aec0+':\x20'+_0x27c401),_0x27c401;}catch(_0x1c7f86){return console['warn']('Login-Prüfung\x20fehlgeschlagen\x20für\x20'+_0x47aec0+':',_0x1c7f86['message']),![];}}async function checkLoginStatus(_0x1514fc){const _0x44904d=['[type=\x22password\x22]','//a[normalize-space(text())=\x27Log\x20In\x27]','//div[@role=\x27button\x27\x20and\x20normalize-space(.)=\x27Log\x20in\x27]','//h3[normalize-space(text())=\x27Something\x20went\x20wrong\x27]'];let _0x24f56a=null;try{_0x24f56a=await waitForSelectorWithFallbacks(_0x1514fc,_0x44904d,{'timeout':0x7d0});}catch(_0x2d7ef1){return console['log']('Eingeloggt,\x20kein\x20Login\x20notwendig:\x20'+_0x2d7ef1),!![];}if(_0x24f56a){console['log']('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return![];}else return console['log']('Eingeloggt,\x20führe\x20keine\x20Login\x20durch'),!![];}async function checkPageExists(_0x3e6e7){const _0x1f3a7d=['//span[contains(normalize-space(.),\x22Sorry,\x20this\x20page\x20isn\x27t\x20available\x22)]'];let _0x30c853=null;try{_0x30c853=await waitForSelectorWithFallbacks(_0x3e6e7,_0x1f3a7d,{'timeout':0x7d0});}catch(_0x2bb011){return console['log']('Seite\x20existiert:\x20'+_0x2bb011),!![];}if(_0x30c853){console['log']('Angegbene\x20Seite\x20existiert\x20nicht');throw new Error('Angegbene\x20Seite\x20existiert\x20nicht');return![];}else return console['log']('Seite\x20existiert'),!![];}async function likeFirstPost(_0x292d08){try{const _0x194d06=await _0x292d08['$$'](K_BEITRAG_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Posts\x20gefunden:\x20'+_0x194d06['length']);if(_0x194d06&&_0x194d06['length']>0x0){const _0x571247=_0x194d06[0x0];await _0x571247['click'](),await delay(0xaf0,0xbb8);const _0x4d8d19=await _0x292d08['evaluate'](()=>{const _0x5a91ea=document['querySelector']('section\x20>\x20span\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20svg[aria-label=\x22Like\x22]');return!!_0x5a91ea;});if(_0x4d8d19){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus');const _0x5f219f=await _0x292d08['$$'](K_BEITRAG_LIKE_BUTTON),_0x533dec=_0x5f219f[0x0];await delay(0x514,0x5dc),await _0x292d08['evaluate'](_0x5b22f5=>{_0x5b22f5['click']();},_0x533dec);}else console['log']('Beitrag\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x292d08['goBack'](),await delay(0x7d0,0x898);}}catch(_0xee983){console['log']('Fehler\x20beim\x20Liken\x20des\x20ersten\x20Posts:',_0xee983);throw new Error('Like_Posts:\x20'+_0xee983);}}async function likeFirstStory(_0x591d6c){try{const _0x264674=await _0x591d6c['$$'](K_STORY_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Stories\x20gefunden:\x20'+_0x264674['length']);if(_0x264674&&_0x264674['length']>0x0){const _0x164d24=_0x264674[0x0];await _0x164d24['click'](),await delay(0xaf0,0xbb8);const _0x1e7cc3=await _0x591d6c['evaluate'](()=>{const _0x7b8ec0=document['querySelector']('[aria-label=\x22Like\x22]');return!!_0x7b8ec0;});if(_0x1e7cc3){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus'),await delay(0x514,0x5dc);try{const _0x232def=await _0x591d6c['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0x591d6c['click'](_0x232def);}catch(_0x1d78f2){console['log']('Direkter\x20Klick\x20fehlgeschlagen,\x20versuche\x20alternative\x20Methoden:',_0x1d78f2);try{const _0x202d56=await _0x591d6c['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0x591d6c['evaluateHandle'](_0x3f9ebe=>{_0x3f9ebe['click']();},_0x202d56);}catch(_0x5dbd7e){console['log']('Evaluatehandle\x20fehlgeschlagen,\x20versuche\x20JS-Click:',_0x5dbd7e),await _0x591d6c['evaluate'](()=>{const _0x3b7d3b=document['querySelector']('[aria-label=\x22Like\x22]');if(_0x3b7d3b)_0x3b7d3b['click']();else throw new Error('Element\x20nicht\x20gefunden');});}}}else console['log']('Story\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x591d6c['goBack'](),await delay(0x7d0,0x898);}}catch(_0x1391ff){console['log']('Fehler\x20beim\x20Liken\x20der\x20ersten\x20Story:',_0x1391ff);throw new Error('Like_Storys:\x20'+_0x1391ff);}}async function send_message(_0x40d87e,_0x15bbce,_0x21dc54,_0x1ff14b,_0x2e70b9,_0xac64c9,_0x4ef197,_0x1e16cf,_0x2b8e22,_0x58251f,_0x327453){return new Promise(async(_0x1789b1,_0x485f94)=>{_0xac64c9=_0xac64c9['split'](';'),console['log'](_0xac64c9[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x2e70b9);if(_0x1ff14b===null||_0x1ff14b===undefined){console['log']('Nachricht\x20ist\x20null\x20oder\x20undefined'),_0x485f94('Nachricht\x20darf\x20nicht\x20leer\x20sein');return;}try{await setCookiesForUser(_0x40d87e,_0xac64c9[0x0]);}catch(_0x52dcfb){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x52dcfb),_0x1789b1({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x52dcfb});return;}await delay(0x6a4,0x7d0);try{await _0x40d87e['goto']('https://www.instagram.com/'+_0x15bbce+'/'),await delay(0x1b58,0x1d4c),await notificationClear(_0x40d87e);}catch(_0x19b070){_0x1789b1({'status':0x1f5,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x19b070});return;}try{await checkLoginStatus(_0x40d87e);}catch(_0x471f62){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x471f62),_0x485f94('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return;}if(_0x2b8e22==0x1)try{await likeFirstPost(_0x40d87e);}catch(_0x46247b){_0x485f94(_0x46247b);}if(_0x58251f==0x1)try{await likeFirstStory(_0x40d87e);}catch(_0x5b4316){_0x485f94(_0x5b4316);}console['log']('UserSkip:\x20'+_0x4ef197);if(_0x4ef197==0x1)try{const _0x38445a=await _0x40d87e['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x28a9be=>_0x28a9be['textContent']['trim']());console['log'](_0x38445a);if(_0x38445a==='Following'||_0x38445a==='Folge\x20ich')return _0x1789b1({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x1734ec){}try{const _0x3de323=await waitForSelectorWithFallbacks(_0x40d87e,K_DIRECT_MSG_BUTTON);await _0x3de323['click'](),await delay(0x6a4,0x7d0);try{const _0x14412=await waitForSelectorWithFallbacks(_0x40d87e,K_EXPAND_MSG_BUTTON);await _0x14412['click']();}catch(_0x5e0f84){console['log']('Expand-Button\x20nicht\x20gefunden.\x20Überspringen:\x20'+_0x5e0f84);}}catch(_0x5c6b83){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x5c6b83);try{await delay(0x6a4,0x7d0);try{const _0x521566=await waitForSelectorWithFallbacks(_0x40d87e,K_OPTIONS_BUTTON);await _0x521566['click']();}catch(_0x11e366){console['log']('Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x11e366),_0x1789b1({'status':0x1f6,'message':'Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x11e366});return;}await delay(0x3e8,0x44c);const _0x55251c=await waitForXPath(_0x40d87e,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x55251c['click']();}catch(_0x469c4f){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x469c4f),_0x1789b1({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x40d87e);}catch(_0x580c2b){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x580c2b);}try{const _0x576601=await waitForSelectorWithFallbacks(_0x40d87e,K_CHAT_INPUT_FIELD,{'visible':!![],'timeout':0x3a98});if(_0x1e16cf){const _0x16d50c=await _0x40d87e['$'](K_ALREADY_CHATTED);if(_0x16d50c)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x15bbce),_0x1789b1({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x4e43e8=await _0x40d87e['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x4e43e8),_0x1ff14b=_0x1ff14b['replace']('{USERNAME}',_0x15bbce);let _0x395492;if(_0x1ff14b['includes']('{NAME}')||_0x1ff14b['includes']('{name}'))try{const _0x5f3356=await extractFirstName(_0x4e43e8,_0x327453);console['log']('Response\x20Clearname\x20valid:\x20'+_0x5f3356['valid']),_0x5f3356['valid']?(_0x1ff14b=_0x1ff14b['replaceAll'](/{NAME}|{name}/g,_0x5f3356['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x5f3356['name']),_0x395492=_0x5f3356['name']):(_0x1ff14b=_0x1ff14b['replaceAll'](/ ?({NAME}|{name})/g,''),_0x395492='UNKNOWN_NAME');}catch(_0x27d8c8){console['log'](_0x27d8c8['message']),_0x395492=_0x27d8c8['message'];const _0x99306e=_0x4e43e8?_0x4e43e8['replace'](/[^\p{L}\s]/gu,''):'',_0x4ec2b8=_0x99306e['split']('\x20')[0x0]||'';_0x4ec2b8['length']>0x2&&!_0x4ec2b8['includes']('Instagram')?_0x1ff14b=_0x1ff14b['replaceAll'](/{NAME}|{name}/g,_0x4ec2b8):_0x1ff14b=_0x1ff14b['replaceAll'](/ ?({NAME}|{name})/g,'');}console['log']('Nachricht\x20vor\x20dem\x20Senden:\x20'+_0x1ff14b);const _0x4e6d36=_0x1ff14b['split']('\x0a');await _0x576601['type'](_0x4e6d36[0x0],{'delay':getRnd(0x50,0x78)});for(let _0x46ca0c=0x1;_0x46ca0c<_0x4e6d36['length'];_0x46ca0c++){await _0x40d87e['keyboard']['down']('Shift'),await _0x40d87e['keyboard']['press']('Enter'),await _0x40d87e['keyboard']['up']('Shift'),await delay(0x64,0xc8),_0x4e6d36[_0x46ca0c]['length']>0x0&&await _0x576601['type'](_0x4e6d36[_0x46ca0c],{'delay':getRnd(0x50,0x78)});}console['log']('Nachricht\x20mit\x20Zeilenumbrüchen\x20gesendet'),await delay(0x320,0x3e8);try{const _0x4c50bc=await waitForSelectorWithFallbacks(_0x40d87e,K_SEND_MSG_BUTTON);await _0x4c50bc['click']();}catch(_0x70b8d1){console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x70b8d1),_0x1789b1({'status':0x195,'message':'Send\x20nicht\x20gefunden.\x20Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x15bbce+'\x20überspringen.','error':_0x70b8d1['message']});}await delay(0x320,0x3e8),_0x1789b1({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x4e43e8,'extracted_clearname':_0x395492});}catch(_0x410baa){let _0x5930b7=_0x410baa;console['log']('Fehler\x20beim\x20Senden\x20der\x20Nachricht:\x20'+_0x5930b7),_0x1789b1({'status':0x1f4,'message':'Error\x20500:\x20'+_0x5930b7});}});}function handle_fail(_0x46f470){if(isStopping)return new Promise(_0x359432=>{_0x359432('Scraper\x20gestoppt.');});else{let _0x4a2d44='';switch(_0x46f470){case 0x0:_0x4a2d44='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x4a2d44='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x4a2d44='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x4a2d44='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x7846ea,_0x535127)=>{_0x535127(_0x4a2d44);});}}async function fetch_account_details(_0x7812dc,_0x4d2ab3,_0x4b0701,_0x45aa53){try{await setCookiesForUser(_0x7812dc,_0x4b0701['username']);}catch(_0x98a2b8){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x98a2b8);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x98a2b8);return handle_fail(0x0);}_0x7812dc['setDefaultNavigationTimeout'](0x7530),await _0x7812dc['goto']('https://www.instagram.com/'+_0x4d2ab3+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x7812dc);const _0x569e5f=await _0x7812dc['evaluate'](()=>{const _0x31d512=document['querySelector']('meta[property=\x22og:image\x22]');return _0x31d512?_0x31d512['getAttribute']('content'):null;});await _0x7812dc['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0xfb3b38=await _0x7812dc['evaluate'](()=>{const _0x239be4=document['querySelector']('meta[name=\x22description\x22]');if(!_0x239be4)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x175aa3=_0x239be4['getAttribute']('content');if(!_0x175aa3)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x175aa3);const _0x2aa7db=/\s*[–-]\s*/,_0x4777df=_0x175aa3['split'](_0x2aa7db);if(_0x4777df['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x32d807=_0x4777df[0x0],_0x402c81=_0x4777df[0x1],_0xadf8fe=_0x32d807['split'](',\x20');if(_0xadf8fe['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x3e68f9=_0xadf8fe[0x0]['split']('\x20')[0x0],_0x29122e=_0xadf8fe[0x1]['split']('\x20')[0x0],_0x5cf3bb=_0xadf8fe[0x2]['split']('\x20')[0x0];let _0x2df3f3='',_0xaf0af2='';const _0x2d020c='\x20on\x20Instagram:\x20',_0x4ada4f=_0x402c81['split'](_0x2d020c);return _0x2df3f3=_0x4ada4f[0x0]['trim'](),_0x2df3f3=_0x2df3f3['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x4ada4f['length']>0x1&&(_0xaf0af2=_0x4ada4f[0x1]['trim'](),_0xaf0af2['startsWith']('\x22')&&_0xaf0af2['endsWith']('\x22')&&(_0xaf0af2=_0xaf0af2['substring'](0x1,_0xaf0af2['length']-0x1)['trim']()),_0xaf0af2=_0xaf0af2['replace'](/&quot;/g,'')['trim']()),{'followers':_0x3e68f9,'following':_0x29122e,'posts':_0x5cf3bb,'nameText':_0x2df3f3,'bio':_0xaf0af2};});console['log']('Extracted\x20profile\x20data:',_0xfb3b38);const _0xe70dbd=_0xfb3b38['nameText'],_0x374259=_0x569e5f,_0x329847=_0xfb3b38['bio'],_0x286a98=_0xfb3b38['followers'],_0x4f263c=_0xfb3b38['following'],_0x3ad641=_0xfb3b38['posts'],_0x6e7c5a=![],_0x548183=![],_0x470037=![],_0xc88af9='\x0a\x20\x20INSERT\x20INTO\x20'+_0x45aa53+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0xc88af9,[_0x4d2ab3,_0xe70dbd,_0x374259,_0x329847,_0x286a98,_0x4f263c,_0x3ad641,_0x6e7c5a,_0x548183,_0x470037],function(_0x2c5216){_0x2c5216?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x2c5216['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x1de186,_0x5d4d6c,_0x1eb696,_0x4a5f87,_0x1cf540,_0x2f36fb,_0x1594a6,_0x29548e){let _0x3317d7=0x4,_0x1dc2e0=0x0,_0x21f6e1=0x0;try{await setCookiesForUser(_0x5d4d6c,_0x2f36fb['username']);}catch(_0x3bf770){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x3bf770);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x3bf770);return handle_fail(0x0);}let _0x242945=0x0;try{await _0x5d4d6c['goto']('https://www.instagram.com/'+_0x1eb696+'/'),await notificationClear(_0x5d4d6c);try{await checkLoginStatus(_0x5d4d6c);}catch(_0x258922){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x258922);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x5d4d6c);}catch(_0x2639d6){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x2639d6);throw new Error('Username\x20nicht\x20gefunden.\x20Existiert\x20der\x20Account?');}try{if(_0x4a5f87<=0x0){const _0x30fd28=await _0x5d4d6c['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x2da323=await _0x5d4d6c['evaluate'](_0x1fae74=>_0x1fae74['innerHTML'],_0x30fd28);_0x242945=Math['ceil'](_0x2da323/0x4);}else _0x242945=Math['ceil'](_0x4a5f87/0x4);_0x3317d7+=_0x242945,_0x21f6e1=Math['round'](++_0x1dc2e0/_0x3317d7*0x64),_0x1de186['sender']['send']('fetch-progress',_0x21f6e1,!![]);let _0x148b72=await _0x5d4d6c['waitForSelector']('a[href=\x22/'+_0x1eb696+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x148b72['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x1eb696+'\x20gesichtet'),_0x21f6e1=Math['round'](++_0x1dc2e0/_0x3317d7*0x64),_0x1de186['sender']['send']('fetch-progress',_0x21f6e1,!![]);}catch(_0x3f3055){console['log']('Follower\x20Liste\x20von\x20'+_0x1eb696+'\x20nicht\x20gefunden:'+_0x3f3055);throw new Error('Follower\x20Liste\x20von\x20'+_0x1eb696+'\x20nicht\x20gefunden:'+_0x3f3055);return handle_fail(0x0);}}catch(_0x213f9e){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x213f9e);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x213f9e);return handle_fail(0x0);}try{await delay(0x12c0,0x1388),console['log']('Auto-scrolls:\x20'+_0x242945),await scroll(_0x5d4d6c,FOLLOWER_FENSTER,_0x242945,_0x280f7d=>{_0x21f6e1=Math['round'](++_0x1dc2e0/_0x3317d7*0x64),_0x1de186['sender']['send']('fetch-progress',_0x21f6e1,!![]);}),await _0x5d4d6c['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x17f82c=await _0x5d4d6c['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x3c6875=await _0x5d4d6c['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x21f6e1=Math['round'](++_0x1dc2e0/_0x3317d7*0x64),_0x1de186['sender']['send']('fetch-progress',_0x21f6e1,!![]);_0x4a5f87<=0x0&&(_0x4a5f87=_0x17f82c['length']);let _0x459dcb=[];for(let _0x3ab924=0x0;_0x3ab924<_0x17f82c['length']&&_0x3ab924<_0x4a5f87;_0x3ab924++){const _0xec2750=await _0x17f82c[_0x3ab924]['evaluate'](_0x2af111=>_0x2af111['textContent']),_0x20dfd2=await _0x3c6875[_0x3ab924]['evaluate'](_0x43e8df=>_0x43e8df['textContent']);if(_0x29548e){const _0x59c765=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x2f36fb['username'],_0xec2750]);if(_0x59c765){console['log']('Skipping\x20already\x20contacted\x20follower:\x20'+_0xec2750);continue;}}_0x459dcb['push'](_0xec2750);const _0x13a001='INSERT\x20INTO\x20'+_0x1cf540+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x13a001,[_0xec2750,_0x20dfd2],function(_0x37b104){_0x37b104?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x1cf540+'\x27:',_0x37b104['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x21f6e1=Math['round'](++_0x1dc2e0/_0x3317d7*0x64),_0x1de186['sender']['send']('fetch-progress',_0x21f6e1,!![]),_0x1594a6&&(_0x1de186['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x1de186,_0x5d4d6c,_0x2f36fb,_0x1cf540,_0x459dcb)),new Promise(_0xf5ea9=>{_0xf5ea9('Scraping\x20finished!');});}catch(_0xffa3e3){if(_0x1594a6)throw new Error(_0xffa3e3);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x1eb696+'\x20nicht\x20gefunden:\x20'+_0xffa3e3);return handle_fail(0x0);}}async function fetch_details_from_list(_0x389f94,_0x438db5,_0xb80870,_0x165576,_0x52ebd7){let _0x4b96a0=0x0,_0x33e5c7=0x0;for(let _0x28f67b=0x0;_0x28f67b<_0x52ebd7['length'];_0x28f67b++){console['log']('Processing\x20profile:',_0x52ebd7[_0x28f67b]);try{await fetch_account_details(_0x438db5,_0x52ebd7[_0x28f67b],_0xb80870,_0x165576);}catch(_0x5a5702){console['error']('Detailed\x20Scraping\x20von:\x20',_0x52ebd7[_0x28f67b],_0x5a5702);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x52ebd7[_0x28f67b]+'\x20'+_0x5a5702);}_0x33e5c7=Math['round'](++_0x4b96a0/_0x52ebd7['length']*0x64),_0x389f94['sender']['send']('fetch-progress',_0x33e5c7,!![],!![]);}}async function fetch_likers_from_post(_0x52f6b7,_0x5d7c00,_0x331286,_0x4bcc51,_0x3d58d9,_0x17cda3,_0x502755,_0x4d17bc){let _0xb280a4=0x4,_0xf82306=0x0,_0x312f91=0x0;try{await setCookiesForUser(_0x5d7c00,_0x17cda3['username']);}catch(_0x121f5a){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x121f5a);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x121f5a);return handle_fail(0x1);}_0x312f91=Math['round'](++_0xf82306/_0xb280a4*0x64),_0x52f6b7['sender']['send']('fetch-progress',_0x312f91,!![]);try{let _0xcf084e=_0x331286['substring'](0x0,_0x331286['lastIndexOf']('/'));_0xcf084e['includes']('/reel/')&&(_0xcf084e=_0xcf084e['replace']('/reel/','/p/'));let _0x5c5670=_0xcf084e+'/liked_by';console['log'](_0x5c5670),await _0x5d7c00['goto'](_0x5c5670),await delay(0x7d0,0xfa0),await notificationClear(_0x5d7c00),await delay(0xc8,0x1f4);try{await checkLoginStatus(_0x5d7c00);}catch(_0x5d6579){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x5d6579);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x5d7c00);}catch(_0x89782a){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x89782a);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}_0x312f91=Math['round'](++_0xf82306/_0xb280a4*0x64),_0x52f6b7['sender']['send']('fetch-progress',_0x312f91,!![]),await _0x5d7c00['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x1b64b6=await _0x5d7c00['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x41cf0a=await _0x5d7c00['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x1b64b6['length']);let _0x36d56e=path['join'](__dirname,'/likers.csv');_0x312f91=Math['round'](++_0xf82306/_0xb280a4*0x64),_0x52f6b7['sender']['send']('fetch-progress',_0x312f91,!![]);_0x4bcc51<=0x0&&(_0x4bcc51=_0x1b64b6['length']);try{let _0x225559=[];for(let _0x4de821=0x0;_0x4de821<_0x1b64b6['length']&&_0x4de821<_0x4bcc51;_0x4de821++){const _0x586e4f=await _0x1b64b6[_0x4de821]['evaluate'](_0x5f3d7a=>_0x5f3d7a['textContent']),_0x3155b0=await _0x41cf0a[_0x4de821]['evaluate'](_0x2e1552=>_0x2e1552['textContent']);if(_0x4d17bc){const _0x18ba71=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x17cda3['username'],_0x586e4f]);if(_0x18ba71){console['log']('Skipping\x20already\x20contacted\x20liker:\x20'+_0x586e4f);continue;}}_0x225559['push'](_0x586e4f);const _0x5a2b78='INSERT\x20INTO\x20'+_0x3d58d9+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x5a2b78,[_0x586e4f,_0x3155b0],function(_0x37e6){_0x37e6?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x3d58d9+'\x27:',_0x37e6['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x312f91=Math['round'](++_0xf82306/_0xb280a4*0x64),_0x52f6b7['sender']['send']('fetch-progress',_0x312f91,!![]),_0x502755&&(_0x52f6b7['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x52f6b7,_0x5d7c00,_0x17cda3,_0x3d58d9,_0x225559)),new Promise(_0x5e616f=>{_0x5e616f('Scraping\x20finished!');});}catch(_0x45ef5f){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x45ef5f);return handle_fail(0x1);}}catch(_0x4ea259){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x4ea259);throw new Error('Like-Seite\x20nicht\x20geöffnet:\x20'+_0x4ea259);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x112f79,_0x570652,_0x4048f8,_0x35fe85,_0xdd0ca0,_0x3563e2,_0x1f3b43,_0x346228){let _0xd5d613=0x3,_0x357604=0x0,_0x413182=0x0;try{await setCookiesForUser(_0x570652,_0x3563e2['username']);}catch(_0x5bbe85){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x5bbe85);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x5bbe85);return handle_fail(0x2);}try{console['log'](_0x4048f8),await _0x570652['goto'](_0x4048f8),await delay(0x7d0,0xfa0),await notificationClear(_0x570652),await delay(0xc8,0x1f4);const _0x1cfd86=COM_COMMENTS_BOX_BODY_DIV;try{await checkLoginStatus(_0x570652);}catch(_0xaafb85){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0xaafb85);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x570652);}catch(_0x5dc90f){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x5dc90f);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}let _0x1b554e;const _0x2b0575=await _0x570652['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x319110=await _0x570652['evaluate'](_0x3589a4=>_0x3589a4['innerHTML'],_0x2b0575),_0x1fb0cf=String(_0x319110)['replace'](/[^0-9]/g,''),_0x43407e=Number(_0x1fb0cf)/0x14;_0x35fe85<=0x0?_0x1b554e=Math['ceil'](_0x43407e/0x3):_0x1b554e=Math['ceil'](_0x35fe85/0x3);_0xd5d613+=_0x1b554e,_0x413182=Math['round'](++_0x357604/_0xd5d613*0x64),_0x112f79['sender']['send']('fetch-progress',_0x413182,!![]),console['log']('Auto-scrolls:\x20'+_0x1b554e),await scroll(_0x570652,_0x1cfd86,_0x1b554e,_0x28fd71=>{_0x413182=Math['round'](++_0x357604/_0xd5d613*0x64),_0x112f79['sender']['send']('fetch-progress',_0x413182,!![]);});try{const _0x30814f=COM_REPLY_BUTTON_SPAN,_0x5bcf9a=await waitForXPathAll(_0x570652,_0x30814f);console['log']('Reply-Buttons\x20gefunden:\x20ANZAHL:\x20'+_0x5bcf9a['size']),await delay(0x1f4,0x320);let _0x32a271=_0x5bcf9a['size'],_0x644d6c=[];for(const [_0x531405,_0x41a798]of _0x5bcf9a){_0x644d6c['push'](_0x41a798);}console['log']('Alle\x20Reply-Buttons:',_0x644d6c['length']);try{for(let _0x539c49=0x0;_0x539c49<_0x32a271;_0x539c49++){await _0x644d6c[_0x539c49]['click'](),await delay(0x320,0x5dc);}}catch(_0x484c14){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x484c14);throw new Error('Nicht\x20auf\x20Replies\x20geklickt:\x20'+_0x484c14);return handle_fail(0x2);}}catch(_0x309c31){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0xc9deb8=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x570652['waitForSelector'](_0xc9deb8),await delay(0x1f4,0x320),_0x413182=Math['round'](++_0x357604/_0xd5d613*0x64),_0x112f79['sender']['send']('fetch-progress',_0x413182,!![]);const _0x70d449=await _0x570652['$$'](_0xc9deb8);let _0xad2314=path['join'](__dirname,'/comments.csv');_0x35fe85<=0x0&&(_0x35fe85=_0x70d449['length']);console['log']('fetch_limit:\x20'+_0x35fe85),console['log']('comments_len:\x20'+_0x70d449['length']),_0x35fe85++;try{let _0x948cf8=[];for(let _0x1ee2db=0x1;_0x1ee2db<_0x70d449['length']&&_0x1ee2db<_0x35fe85;_0x1ee2db++){const _0x1013e0=await _0x70d449[_0x1ee2db]['evaluate'](_0x36b71f=>_0x36b71f['textContent']);if(_0x346228){const _0x2d73b3=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x3563e2['username'],_0x1013e0]);if(_0x2d73b3){console['log']('Skipping\x20already\x20contacted\x20commenter:\x20'+_0x1013e0);continue;}}try{_0x948cf8['push'](_0x1013e0);const _0x5a885b='INSERT\x20INTO\x20'+_0xdd0ca0+'\x20(username)\x20VALUES\x20(?)';db['run'](_0x5a885b,[_0x1013e0],function(_0xa7ebb9){_0xa7ebb9&&console['log']('error\x20in\x20add-user:'+_0xa7ebb9);});}catch(_0x1fdda5){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x1ee2db+'\x20:\x20'+_0x1fdda5);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x1ee2db+'\x20:\x20'+_0x1fdda5);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x413182=Math['round'](++_0x357604/_0xd5d613*0x64),_0x112f79['sender']['send']('fetch-progress',_0x413182,!![]),_0x112f79['sender']['send']('fetch-progress',0x64,!![]),_0x1f3b43&&(_0x112f79['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x112f79,_0x570652,_0x3563e2,_0xdd0ca0,_0x948cf8)),_0x112f79['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x452007=>{_0x452007('Scraping\x20finished!');});}catch(_0x6fa670){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x6fa670);return handle_fail(0x2);}}catch(_0x219c5b){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x219c5b);throw new Error('Comments-Seite\x20nicht\x20geöffnet:\x20'+_0x219c5b);return handle_fail(0x2);}}async function set_clearname_from_username(_0x18c64a,_0x117d0d,_0x343362=null){try{let _0x1ce1a6,_0x34ba75;const _0x2c1f59='SELECT\x20username\x20FROM\x20'+_0x117d0d+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x2c1f59,[],(_0x44692f,_0x5a1b39)=>{_0x44692f&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x44692f['message']),_0x5a1b39['length']===0x0&&(_0x34ba75=_0x5a1b39['length']),_0x1ce1a6=_0x5a1b39['map'](_0x151fc3=>_0x151fc3['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x34ba75);if(_0x34ba75===0x0){console['log']('Leave');return;}const _0x202814=await _0x18c64a['waitForSelector'](IG_SEARCH_BUTTON);await _0x202814['click'](),await delay(0x4b0,0x7d0);for(let _0x3a1e05 of _0x1ce1a6){const _0x263344=await _0x18c64a['waitForSelector'](IG_SEARCH_INPUT);await _0x263344['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x18c64a['type'](IG_SEARCH_INPUT,_0x3a1e05,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x382b82=0x1;while(_0x382b82!=0x14){console['log']('Schleife');try{let _0x21ef59=IG_NAME_SPAN_PART1+_0x382b82+IG_USERNAME_SPAN_PART2;const _0x22a059=await _0x18c64a['waitForSelector'](_0x21ef59),_0x408157=await _0x18c64a['evaluate'](_0xa5a74b=>_0xa5a74b['innerHTML'],_0x22a059);await delay(0xc8,0x1f4);if(_0x408157==_0x3a1e05){let _0x3aa075=IG_NAME_SPAN_PART1+_0x382b82+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x32642b=await _0x18c64a['waitForSelector'](_0x3aa075);let _0x5b8723=await _0x18c64a['evaluate'](_0x43b6f3=>_0x43b6f3['innerHTML'],_0x32642b);const _0x19902c=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x3389bc=_0x5b8723['match'](_0x19902c);_0x3389bc?_0x5b8723=_0x3389bc[0x1]['trim']():_0x5b8723=_0x5b8723['trim']();_0x5b8723['includes']('•')&&(_0x5b8723=_0x5b8723['substring'](0x0,_0x5b8723['indexOf']('•')-0x1));const _0x20a02e='UPDATE\x20'+_0x117d0d+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x20a02e,[_0x5b8723,_0x408157],function(_0x3267c6){_0x3267c6&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x3267c6['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x382b82++;}catch(_0x5c4ae9){const _0xa142bf='UPDATE\x20'+_0x117d0d+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0xa142bf,['',_0x3a1e05],function(_0x436792){_0x436792&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x436792['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x5c4ae9);break;}}_0x343362&&_0x343362();}await _0x202814['click']();}catch(_0x371b5f){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x371b5f);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likePost\x20\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likeStory\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likePost\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likeStory\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x48772d,_0x443783)=>{const _0xd50715='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0xd50715,[],(_0x421074,_0x3b8012)=>{_0x421074?_0x443783(_0x421074):_0x48772d(_0x3b8012);});});});const sqlGet=(_0x4a8d0e,_0x394955,_0x1b7c54=[])=>new Promise((_0x2492e9,_0xe8927a)=>_0x4a8d0e['get'](_0x394955,_0x1b7c54,(_0x1fb8dc,_0x1934c5)=>_0x1fb8dc?_0xe8927a(_0x1fb8dc):_0x2492e9(_0x1934c5))),sqlAll=(_0x2c6952,_0x638d11,_0x4e54a1=[])=>new Promise((_0x31339f,_0xaeb7)=>_0x2c6952['all'](_0x638d11,_0x4e54a1,(_0x2e9fb6,_0x54670d)=>_0x2e9fb6?_0xaeb7(_0x2e9fb6):_0x31339f(_0x54670d)));ipcMain['handle']('get-campaign-details',async()=>{try{const _0x1c282c=await sqlAll(campaignDB,'SELECT\x20campaign_name,\x20list_id,\x20zeitabstand,\x20account\x20FROM\x20campaign'),_0x40dcac=await Promise['all'](_0x1c282c['map'](async _0x55c64e=>{const _0x291031=[];if(!_0x55c64e['list_id'])_0x291031['push']('Liste');if(!_0x55c64e['zeitabstand'])_0x291031['push']('Zeitabstand');if(!_0x55c64e['account'])_0x291031['push']('Instagram\x20Account');if(_0x55c64e['account'])try{const _0x5d73d5=await sqlGet(igaccountsDB,'SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x55c64e['account']]);if(!_0x5d73d5)_0x291031['push']('Instagram\x20Login\x20nicht\x20möglich');else{const _0x5cdc94=_0x5d73d5['cookie']&&_0x5d73d5['cookie']['trim']()!==''&&_0x5d73d5['cookie']['trim']()!=='[]';if(!_0x5cdc94)_0x291031['push']('Instagram\x20Login');}}catch(_0x1985b8){console['error']('Account-Prüfung\x20SQL-Fehler:',_0x1985b8['message']),_0x291031['push']('Instagram\x20Account');}let _0xf92ea9='N/A',_0xce01b5='N/A';if(!_0x291031['includes']('Liste')){try{const _0x2e9dda=await sqlGet(db,'SELECT\x20COUNT(*)\x20AS\x20lead_count\x20FROM\x20'+_0x55c64e['list_id']);_0xf92ea9=_0x2e9dda?.['lead_count']??0x0;}catch(_0x4b8ba0){if(/no such table/i['test'](_0x4b8ba0['message']))_0x291031['push']('Liste\x20nicht\x20vorhanden');}try{const _0x270e6c=await sqlGet(campaignDB,'SELECT\x20COUNT(*)\x20AS\x20contacted_count\x20FROM\x20dm\x20WHERE\x20list_id\x20=\x20?',[_0x55c64e['list_id']]);_0xce01b5=_0x270e6c?.['contacted_count']??0x0;}catch(_0x3de1ca){}}return{'campaign_name':_0x55c64e['campaign_name'],'lead_count':_0xf92ea9,'contacted_count':_0xce01b5,'status':_0x291031['length']===0x0?'Positiv':'Fehler:\x20'+_0x291031['join'](',\x20')};}));return{'status':'success','campaigns':_0x40dcac};}catch(_0x3753a5){return console['error']('get-campaign-details\x20fehlgeschlagen:',_0x3753a5['message']),{'status':'error','message':_0x3753a5['message']};}}),ipcMain['handle']('get-campaign-writer-information',async(_0x776ebc,_0x2ab677)=>{return new Promise((_0x280939,_0x4d2a36)=>{const _0x460ea9='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted,\x20likePost,\x20likeStory\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x460ea9,[_0x2ab677],(_0x7ced70,_0x44861e)=>{_0x7ced70?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x7ced70),_0x4d2a36(_0x7ced70)):(console['log']('ROWS'),console['log'](_0x44861e),debugDatabaseContents(),_0x280939(_0x44861e));});});});const showTableContents=_0x58c365=>{return new Promise((_0x5569ad,_0x3e539c)=>{const _0x274668='SELECT\x20*\x20FROM\x20'+_0x58c365+';';campaignDB['all'](_0x274668,(_0x5e4cca,_0x3e07c5)=>{_0x5e4cca?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x58c365+':',_0x5e4cca),_0x3e539c(_0x5e4cca)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x58c365+':',_0x3e07c5),_0x5569ad({'status':'success','message':_0x3e07c5}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x33bae3){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x33bae3);}}ipcMain['handle']('create-campaign',async(_0x2c2491,_0x3b4c57)=>{return new Promise((_0x341355,_0x177b70)=>{const _0x3e7f63='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x3e7f63,[String(_0x3b4c57)],function(_0x35ba31){_0x35ba31?_0x177b70(_0x35ba31):_0x341355({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x4f6b22,_0x549910)=>{return new Promise((_0x47fa04,_0x1550bd)=>{const _0x27252e='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x27252e,[_0x549910],function(_0x5475d1){_0x5475d1?_0x1550bd(_0x5475d1):_0x47fa04({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0xf673d1,_0x1b3174,_0x5a9942,_0xf32711,_0x56428b,_0x2e13d9,_0x1255e1,_0x1f5304,_0x573c45,_0x4eea2a)=>{const _0x18a68e=await createMessageID(_0x56428b);return new Promise((_0x31c62e,_0x4f708d)=>{console['log']('ZEITABSTAND:\x20'+_0xf32711);if(!_0x1b3174||!_0x5a9942||_0xf32711===undefined||_0xf32711===null||_0xf32711===''||!_0x18a68e||!_0x2e13d9)return _0x4f708d({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x18a68e);const _0x4ee6d0='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?,\x20likePost\x20=\x20?,\x20likeStory\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x4ee6d0,[_0x5a9942,_0xf32711,_0x18a68e,_0x2e13d9,_0x1255e1,_0x1f5304,_0x573c45,_0x4eea2a,_0x1b3174],function(_0x1c3c4b){if(_0x1c3c4b)_0x4f708d({'status':'error','message':_0x1c3c4b['message']});else this['changes']===0x0?_0x4f708d({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x31c62e({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x4b774a,_0x420ed3,_0x283ac1,_0x162654,_0x352017)=>{return new Promise((_0x429bcc,_0x27b543)=>{const _0x153869='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x153869,[_0x420ed3,_0x283ac1,_0x162654,_0x352017],function(_0x194e87){return _0x194e87?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x194e87['message']),_0x27b543('insert-dm-response',{'success':![],'message':_0x194e87['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x429bcc('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x2dcd34=>{return new Promise((_0x31ba4e,_0x2dd384)=>{const _0x5df15f='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x5df15f,[_0x2dcd34],(_0x375145,_0x1b2d7e)=>{if(_0x375145)_0x2dd384({'status':'error','message':_0x375145['message']});else{if(_0x1b2d7e)_0x31ba4e(_0x1b2d7e['message_id']);else{const _0x2711a8='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x2711a8,[_0x2dcd34],function(_0x11c5ee){_0x11c5ee?_0x2dd384({'status':'error','message':_0x11c5ee['message']}):_0x31ba4e(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x1996f9,_0x804eb8)=>{return new Promise((_0x5d107d,_0x33adf1)=>{const _0x5bd801='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x804eb8;db['get'](_0x5bd801,(_0x7b444c,_0x2e6212)=>{_0x7b444c?_0x33adf1({'status':'error','message':_0x7b444c['message']}):_0x5d107d({'status':'success','count':_0x2e6212['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x24ccb0,_0x35a403){try{const _0x642f0c=await new Promise((_0x5b8112,_0xaecd9a)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x35a403],(_0x5c4ead,_0x289a8c)=>{if(_0x5c4ead)_0xaecd9a(_0x5c4ead);else{if(_0x289a8c['length']>0x0){let _0x4ec45e=JSON['parse'](_0x289a8c[0x0]['cookie']);console['log'](_0x4ec45e),_0x5b8112(_0x4ec45e);}else _0xaecd9a(new Error('User\x20with\x20username\x20'+_0x35a403+'\x20does\x20not\x20exist.'));}});});await _0x24ccb0['setCookie'](..._0x642f0c),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x573345){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x573345);}}async function saveCookiesForUser(_0xc75561,_0x380d34){try{const _0x324398=await _0xc75561['cookies']();if(!_0x324398||_0x324398['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x380d34);const _0x5c64d9=JSON['stringify'](_0x324398);if(_0x5c64d9['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x380d34);return new Promise((_0x2e2a11,_0x189259)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x380d34],(_0x34bba2,_0xa2f2a9)=>{if(_0x34bba2)return console['error']('Error\x20checking\x20user\x20existence:',_0x34bba2),_0x189259(_0x34bba2);if(_0xa2f2a9){const _0x3ba055=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x3ba055['run'](_0x5c64d9,_0x380d34,function(_0x84f51){return _0x84f51?(console['error']('Error\x20updating\x20cookies:',_0x84f51),_0x189259(_0x84f51)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x380d34),_0x2e2a11());});}else{const _0x4af0a8=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x4af0a8['run'](_0x380d34,_0x5c64d9,function(_0x49cdda){return _0x49cdda?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x49cdda),_0x189259(_0x49cdda)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x380d34),_0x2e2a11());});}});});}catch(_0x36d0a1){console['error']('Error\x20fetching\x20cookies:',_0x36d0a1);throw _0x36d0a1;}}async function createUserIfNotExists(_0x49178){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x49178],(_0x442bc4,_0x3db8de)=>{if(_0x442bc4){console['error']('Error\x20checking\x20user\x20existence:',_0x442bc4);throw _0x442bc4;}else{if(!_0x3db8de){const _0x39b0f1=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x39b0f1['run'](_0x49178,function(_0x31d30f){_0x31d30f?console['error']('Error\x20inserting\x20new\x20user:',_0x31d30f):console['log']('New\x20user\x20created:',_0x49178);});}else console['log']('User\x20already\x20exists:',_0x49178);}});}catch(_0x36bb20){console['error']('Error\x20creating\x20user:',_0x36bb20);throw _0x36bb20;}}ipcMain['handle']('create-relation',async(_0x2b45fd,_0x55d72d)=>{return new Promise((_0x49982,_0x2a5293)=>{const _0x60fa2f='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x55d72d+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x60fa2f,function(_0x149f36){_0x149f36?_0x2a5293(_0x149f36):_0x49982({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x59bd7c,_0x552fa9)=>{return console['log']('droping\x20table'+_0x552fa9),new Promise((_0x2f1d46,_0x16ae81)=>{const _0x11dfc4='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x552fa9;console['log']('droping\x20table'+_0x552fa9),db['run'](_0x11dfc4,function(_0x355f29){_0x355f29?_0x16ae81(_0x355f29):_0x2f1d46({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x5d36ea=>{return new Promise((_0x48b61c,_0x501adf)=>{const _0x354463='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x354463,[],(_0x294652,_0x5cee40)=>{_0x294652?_0x501adf(_0x294652):_0x48b61c(_0x5cee40['map'](_0x3aa21e=>_0x3aa21e['name']));});});}),ipcMain['handle']('add-user',async(_0x16b589,_0x5e4481,_0x81952a)=>{return new Promise(_0x7532cb=>{const _0x3c3a97=db['prepare']('INSERT\x20INTO\x20'+_0x81952a+'\x20(username)\x20VALUES\x20(?)');_0x3c3a97['run'](_0x5e4481,function(_0x4fb0cc){_0x4fb0cc?console['log']('error\x20in\x20add-user:'+_0x4fb0cc):_0x7532cb({'status':'success','id':this['lastID']});}),_0x3c3a97['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x21b8c1,_0x1faaab)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x45c7a8,_0x2ea50d)=>{if(_0x45c7a8)_0x1faaab(_0x45c7a8);else{_0x21b8c1({'status':'success','users':_0x2ea50d});for(_0x2ea50d of _0x2ea50d){console['log'](_0x2ea50d['username']);}}});});}),ipcMain['handle']('get-data',async(_0x3926e7,_0x4732ab)=>{return new Promise((_0x3c72aa,_0xe84956)=>{const _0x1c1304='SELECT\x20*\x20FROM\x20'+_0x4732ab;console['log'](_0x1c1304),db['all'](_0x1c1304,[],(_0x4eea37,_0x4f008f)=>{_0x4eea37?_0xe84956(_0x4eea37):_0x3c72aa(_0x4f008f);});});}),ipcMain['handle']('get-accounts',async _0x3a5b0f=>{return new Promise((_0xb5ff7c,_0x443809)=>{const _0x2fba82='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x2fba82),igaccountsDB['all'](_0x2fba82,[],(_0x415ee2,_0x5add76)=>{_0x415ee2?_0x443809(_0x415ee2):_0xb5ff7c(_0x5add76);});});}),ipcMain['handle']('get-targets',async(_0x5cd07f,_0xb229e6)=>{return getTargetProfiles(_0xb229e6);}),ipcMain['handle']('delete-user',async(_0x4a2882,_0x56742f,_0x3000ec)=>{return new Promise((_0xf1c244,_0x52eac4)=>{const _0x19a29a=db['prepare']('DELETE\x20FROM\x20'+_0x3000ec+'\x20WHERE\x20username\x20=\x20?');_0x19a29a['run'](_0x56742f,function(_0x226456){_0x226456?_0x52eac4(_0x226456):_0xf1c244({'status':'success','changes':this['changes']});}),_0x19a29a['finalize']();});}),ipcMain['handle']('delete-account',async(_0x168088,_0xa7aa0e)=>{const _0x3c694a=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x3c694a['run'](_0xa7aa0e,function(_0x4cfeec){_0x4cfeec&&console['log'](_0x4cfeec);}),_0x3c694a['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x1a6fad,_0x2cf694)=>{const _0x5bf750='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x5bf750,[],(_0x7bb3f6,_0xb2098f)=>{_0x7bb3f6?_0x2cf694({'status':'error','message':_0x7bb3f6['message']}):_0x1a6fad({'status':'success','contactedCount':_0xb2098f['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x45e06b,_0x6198d7)=>{const _0x2c0640='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x2c0640,[],(_0x17f99f,_0x269951)=>{_0x17f99f?_0x6198d7({'status':'error','message':_0x17f99f['message']}):_0x45e06b({'status':'success','contactedCount':_0x269951['contactedCount']});});});});function exportDatabase(_0x37349b){return new Promise((_0x1b8605,_0x4aa841)=>{const _0x2131ce='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x37349b+'\x0a\x20\x20\x20\x20';db['all'](_0x2131ce,[],async(_0x53e6ba,_0x5ecb17)=>{if(_0x53e6ba){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x53e6ba['message']),_0x4aa841(_0x53e6ba);return;}if(!_0x5ecb17||_0x5ecb17['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x1b8605();return;}const _0x4e522f=XLSX['utils']['json_to_sheet'](_0x5ecb17),_0x2d95ad=XLSX['utils']['sheet_to_csv'](_0x4e522f);try{const {canceled:_0x5e6ce6,filePath:_0x3d6e44}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x37349b+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x5e6ce6||!_0x3d6e44){console['log']('Speichern\x20abgebrochen.'),_0x1b8605();return;}fs['writeFile'](_0x3d6e44,_0x2d95ad,'utf8',_0xb0d576=>{_0xb0d576?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0xb0d576['message']),_0x4aa841(_0xb0d576)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x3d6e44),_0x1b8605());});}catch(_0x366789){console['error']('Fehler\x20im\x20Speicherdialog:',_0x366789),_0x4aa841(_0x366789);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x95976a,_0x3525e4)=>{shell['openExternal'](_0x3525e4);});