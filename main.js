const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');async function extractFirstName(_0x30cfb3,_0x266d52){try{const _0x5d1d4e=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x266d52},'body':JSON['stringify']({'clearname':_0x30cfb3})});if(!_0x5d1d4e['ok']){const _0x4e33e7=await _0x5d1d4e['text']();throw new Error(_0x5d1d4e['status']+':\x20'+_0x4e33e7);}const _0x4300df=await _0x5d1d4e['json']();return _0x4300df;}catch(_0xf36d6b){console['error']('Error\x20in\x20extractFirstName:',_0xf36d6b);throw _0xf36d6b;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div',K_OPTIONS_BUTTON='section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.xs5motx\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD='div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f',K_SEND_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Send\x27]','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x1a9233=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x1a9233['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x1a9233['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x56b274){var _0x45c2ac=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x2ffe4c){console['log']('window\x20id:'+_0x2ffe4c['id']),_0x2ffe4c['id']>0x1&&(_0x45c2ac=!![]);}),console['log']('child\x20opened\x20='+_0x45c2ac);if(!_0x45c2ac){const _0x892e4b=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x892e4b['loadFile'](_0x56b274['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x21b368=require('fs'),_0x5103e3=path['join'](app['getPath']('userData'),'data'),_0x4ef23a=['campaign.db','crm.db','igaccounts.db'],_0x2014f1=[];try{_0x21b368['mkdirSync'](_0x5103e3,{'recursive':!![]});for(const _0x659e7e of _0x4ef23a){const _0x20541d=path['join'](process['resourcesPath'],'app','build','data',_0x659e7e),_0x4abfec=path['join'](_0x5103e3,_0x659e7e);!_0x21b368['existsSync'](_0x4abfec)?(_0x21b368['copyFileSync'](_0x20541d,_0x4abfec),console['log']('[InitDB]\x20Kopiert\x20'+_0x659e7e+'\x20nach:\x20'+_0x4abfec)):console['log']('[InitDB]\x20'+_0x659e7e+'\x20existiert\x20bereits:\x20'+_0x4abfec),_0x2014f1['push'](_0x4abfec);}}catch(_0x3676be){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x3676be);}return _0x2014f1;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x21f023,AppUpdate:_0x2e6c72}=require('electron-updater');_0x21f023['autoDownload']=![],_0x21f023['autoInstallOnAppQuit']=!![],_0x21f023['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x21f023['on']('update-available',_0x55c661=>{console['log']('Update\x20verfügbar:',_0x55c661),_0x21f023['downloadUpdate']();}),_0x21f023['on']('update-downloaded',_0x9660b5=>{console['log']('Update\x20heruntergeladen:',_0x9660b5),_0x21f023['quitAndInstall']();}),_0x21f023['on']('error',_0x15625d=>{console['error']('Fehler\x20beim\x20Updaten:',_0x15625d);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x2f00e4,AppUpdate:_0x33b7eb}=require('electron-updater');_0x2f00e4['autoDownload']=![],_0x2f00e4['autoInstallOnAppQuit']=!![],_0x2f00e4['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x2f00e4['on']('update-available',_0x84019d=>{console['log']('Update\x20verfügbar:',_0x84019d),_0x2f00e4['downloadUpdate']();}),_0x2f00e4['on']('update-downloaded',_0x5f2fbf=>{console['log']('Update\x20heruntergeladen:',_0x5f2fbf),console['log']('Neustarten\x20zum\x20Updaten');}),_0x2f00e4['on']('error',_0x4ae93c=>{console['error']('Fehler\x20beim\x20Updaten:',_0x4ae93c);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x212dbc='',_0x2c4421=null;if(process['platform']==='darwin')_0x212dbc=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x212dbc=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x212dbc}),_0x2c4421=await browser_login['newPage'](),_0x2c4421['setDefaultNavigationTimeout'](0x1d4c),_0x2c4421['setDefaultTimeout'](0x1d4c),await _0x2c4421['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x2c4421;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x1fdb1=0x1,_0xaacfd3=0x0){let _0x282d69='',_0xec257e=null;const _0x113310=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x282d69=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x282d69=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x1fdb1===0x0&&!pageStack[_0xaacfd3])return browser=await puppeteer['launch']({'headless':_0x113310,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x282d69}),_0xec257e=await browser['newPage'](),_0xec257e['setDefaultNavigationTimeout'](0x1d4c),_0xec257e['setDefaultTimeout'](0x1d4c),await _0xec257e['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0xaacfd3]=_0xec257e,_0xec257e;return(browser===null||pageStack[_0xaacfd3]===null||pageStack[_0xaacfd3]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x113310,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x282d69})),(pageStack[_0xaacfd3]===null||pageStack[_0xaacfd3]['isClosed']())&&(_0xec257e=await browser['newPage'](),_0xec257e['setDefaultNavigationTimeout'](0x1d4c),_0xec257e['setDefaultTimeout'](0x1d4c),await _0xec257e['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0xaacfd3]=_0xec257e),pageStack[_0xaacfd3];}ipcMain['on']('login',async(_0x29171b,_0x3b86f2)=>{const _0x2d57eb=await getBrowserPageLogin();await _0x2d57eb['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x2d57eb,_0x3b86f2),ipcMain['on']('setLoginCookies',async(_0x5a4490,_0x587b73)=>{try{await set_login_cookies(_0x2d57eb,_0x587b73);}catch(_0x12df4e){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x12df4e);}});}),ipcMain['on']('export-relation',async(_0x45e31e,_0x4f7f03)=>{try{await exportDatabase(_0x4f7f03),_0x45e31e['reply']('export-relation-response',{'success':!![]});}catch(_0x155a0f){console['error'](_0x155a0f),_0x45e31e['reply']('export-relation-response',{'success':![],'message':_0x155a0f['message']});}}),ipcMain['handle']('sendMessage',async(_0x3f7062,_0x4f4ed6,_0x35fecd,_0x2f87eb,_0xcd1243,_0x1090c0,_0x3e8026,_0x6870e9,_0x9aaa5b,_0x4ce249,_0x22ece0)=>{isStopping=![];let _0x291d0e=null;return _0x3e8026?_0x291d0e=await getBrowserPage(_0xcd1243,_0x6870e9):_0x291d0e=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x4f4ed6),send_message(_0x291d0e,_0x4f4ed6,_0x35fecd,_0x2f87eb,_0xcd1243,_0x1090c0,_0x9aaa5b,_0x4ce249,_0x22ece0);}),ipcMain['handle']('stop-action',async(_0x44dd07,_0x136222)=>{isStopping=!![];const _0x2e74b9=await getBrowserPage(0x1,_0x136222);await _0x2e74b9['close']();}),ipcMain['handle']('fetch_followers',async(_0xa3d858,_0x2a8bc0,_0xdaa88f,_0x15e98f,_0x526b4b,_0x1bbc33)=>{isStopping=![];const _0xc66b1e=await getBrowserPage();return fetch_followers_from_account(_0xa3d858,_0xc66b1e,_0x2a8bc0,_0xdaa88f,_0x15e98f,_0x526b4b,_0x1bbc33);}),ipcMain['handle']('get-account-details',async(_0x2c51f2,_0x38339c,_0x3b476c,_0x6175a7)=>{isStopping=![];const _0x537ab9=await getBrowserPage();return fetch_account_details(_0x537ab9,_0x38339c,_0x3b476c,_0x6175a7);}),ipcMain['handle']('fetch_likes',async(_0x3c3dd1,_0x2e72f0,_0x1df68b,_0x7a16,_0x106575,_0x385652)=>{isStopping=![];const _0x5edfe1=await getBrowserPage();return fetch_likers_from_post(_0x3c3dd1,_0x5edfe1,_0x2e72f0,_0x1df68b,_0x7a16,_0x106575,_0x385652);}),ipcMain['handle']('fetch_comments',async(_0x553742,_0x1db2c5,_0x1a5236,_0x27770b,_0x578a73,_0x539591)=>{isStopping=![];const _0x4e812a=await getBrowserPage();return fetch_comments_from_post(_0x553742,_0x4e812a,_0x1db2c5,_0x1a5236,_0x27770b,_0x578a73,_0x539591);});async function updateAppSilent(){const {spawn:_0x29a237}=require('child_process'),_0x1582f2=require('path'),_0x1e501c=require('electron-log');return _0x1e501c['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x2d6029,_0x34b0c9)=>{const {updateElectronApp:_0x4b9137,UpdateSourceType:_0x4a1073}=require('update-electron-app');_0x4b9137({'updateSource':{'type':_0x4a1073['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x1e501c}),_0x2d6029('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x338b66,_0x1de5d6)=>{doFullElectronUpdateSilent(),_0x338b66('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x43f0ce}=require('child_process'),_0x18afa8=require('path'),_0x2fffb6=require('electron-log');return _0x2fffb6['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x6da100,_0x352dd7)=>{const {updateElectronApp:_0x3b27e8,UpdateSourceType:_0x25d13b}=require('update-electron-app');_0x3b27e8({'updateSource':{'type':_0x25d13b['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x2fffb6}),_0x6da100('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x1c9037,_0x2c9def)=>{doFullElectronUpdate(),_0x1c9037('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0x232eb9,_0x10a580)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x232eb9('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x51ac33=path['join'](__dirname,'mac-updater-intern.sh'),_0x10ad06=spawn('/bin/bash',[_0x51ac33],{'detached':!![],'stdio':'ignore'});_0x10ad06['unref'](),setTimeout(()=>{_0x232eb9('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0x10a580(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0x6bea66=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x5e4154,_0x1d22dd)=>{console['log']('Update\x20Silent:\x20'+_0x1d22dd);if(_0x1d22dd){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0x233ee5,_0x175524){return Math['random']()*(_0x175524-_0x233ee5+0x1)+_0x233ee5;}function delay(_0x4fa1f9,_0x521758){let _0x5db0b8=getRnd(_0x4fa1f9,_0x521758);return new Promise(function(_0x262dab){setTimeout(_0x262dab,_0x5db0b8);});}async function scroll(_0x339cf1,_0x21a191,_0x4e2ba9=0x2,_0x5c1a05){const _0x1abc0e=await _0x339cf1['waitForSelector'](_0x21a191);for(let _0x256bf7=0x0;_0x256bf7<_0x4e2ba9;_0x256bf7++){console['log']('Scrolling\x20'+_0x256bf7),await _0x339cf1['evaluate'](_0x5564b3=>{const _0x494cdf=document['querySelector'](_0x5564b3);_0x494cdf&&_0x494cdf['scrollBy'](0x0,0x190);},_0x21a191),await delay(0x320,0x5dc),_0x5c1a05();}}async function saveCookies(_0x40a3a3){let _0x287929=await _0x40a3a3['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x287929,null,0x2));}async function notificationClear(_0x1ac078){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x1ac078['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x1ac078['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x1f87fd){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x1f87fd);}}async function getTargetProfiles(_0x56912c){return new Promise((_0x23c87b,_0x36a1d5)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x56912c,(_0x5e7d80,_0x5e77fa)=>{_0x5e7d80?_0x36a1d5(_0x5e7d80):_0x23c87b(_0x5e77fa);});});}async function login_legacy(_0x2e7dca,_0x19fbb9,_0x3d4b52){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x2e7dca,_0x19fbb9),await createUserIfNotExists(_0x19fbb9,_0x3d4b52);}catch(_0x3cd314){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x3cd314);}try{await _0x2e7dca['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x2e7dca['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x2e7dca['click']('button._a9--._ap36._a9_0');}catch(_0x3bbb1e){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x2e7dca['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x2e7dca['type']('input[name=\x27username\x27]',_0x19fbb9,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x2e7dca['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x2e7dca['type']('input[name=\x27password\x27]',_0x3d4b52,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x2e7dca['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x2e7dca['click']('button[type=\x27submit\x27]');}catch(_0xf21021){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x2e7dca),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x2e7dca,_0x19fbb9);}catch(_0x431704){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x431704);}}catch(_0x49ee62){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x49ee62);}}async function login(_0x1d23e9,_0x49b8b7){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x1d23e9,_0x49b8b7),await createUserIfNotExists(_0x49b8b7);}catch(_0x1164cc){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x1164cc);}try{await _0x1d23e9['goto']('https://www.instagram.com/accounts/login/');}catch(_0x28ad04){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x28ad04);}}async function set_login_cookies(_0x3f3270,_0x215a46){try{await saveCookiesForUser(_0x3f3270,_0x215a46);}catch(_0x506ed5){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x506ed5);}}async function waitForXPath(_0x3e90c1,_0x3f425d,_0x680167={}){return await _0x3e90c1['waitForFunction'](_0x302ed9=>{return document['evaluate'](_0x302ed9,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x680167,_0x3f425d),_0x3e90c1['evaluateHandle'](_0xb0f0a1=>document['evaluate'](_0xb0f0a1,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x3f425d);}async function waitForSelectorWithFallbacks(_0x4d8975,_0x2d5900,_0x1119b1={}){!Array['isArray'](_0x2d5900)&&(_0x2d5900=[_0x2d5900]);for(let _0x4db10a=0x0;_0x4db10a<_0x2d5900['length'];_0x4db10a++){const _0x4f16f5=_0x2d5900[_0x4db10a],_0x1c5da4=_0x4f16f5['startsWith']('//')||_0x4f16f5['startsWith']('(//');try{console['log']('Versuche\x20'+(_0x1c5da4?'XPath':'Selector')+'\x20'+(_0x4db10a+0x1)+'/'+_0x2d5900['length']+':\x20'+_0x4f16f5['substring'](0x0,0x32)+'...');const _0x1f49c3=_0x4db10a===0x0?_0x1119b1['timeout']||0x1388:0x7d0;let _0x54cc53;if(_0x1c5da4){const _0x7eba26=await waitForXPath(_0x4d8975,_0x4f16f5,{..._0x1119b1,'timeout':_0x1f49c3});if(!_0x7eba26)throw new Error('XPath-Element\x20nicht\x20gefunden');_0x54cc53=_0x7eba26;}else _0x54cc53=await _0x4d8975['waitForSelector'](_0x4f16f5,{..._0x1119b1,'timeout':_0x1f49c3});return console['log']((_0x1c5da4?'XPath':'Selector')+'\x20'+(_0x4db10a+0x1)+'\x20gefunden!'),_0x54cc53;}catch(_0x2200fd){console['log']((_0x1c5da4?'XPath':'Selector')+'\x20'+(_0x4db10a+0x1)+'\x20nicht\x20gefunden:\x20'+_0x2200fd['message']);if(_0x4db10a===_0x2d5900['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x2d5900['length']+'\x20Selektoren/XPath\x20konnte\x20gefunden\x20werden:\x20'+_0x2200fd['message']);}}throw new Error('Keine\x20Selektoren/XPath\x20angegeben');}async function send_message(_0x3a7615,_0x191f62,_0x5ea681,_0x3a6a43,_0x4c8732,_0x18437e,_0x1d76d4,_0x4a9ba3,_0x2e9f68){return new Promise(async(_0x759cfa,_0x3d85ba)=>{_0x18437e=_0x18437e['split'](';'),console['log'](_0x18437e[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x4c8732);try{await setCookiesForUser(_0x3a7615,_0x18437e[0x0]);}catch(_0x8d10eb){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x8d10eb),_0x3d85ba({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x8d10eb});return;}try{await _0x3a7615['goto']('https://www.instagram.com/'+_0x191f62+'/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x3a7615);}catch(_0x325e1d){_0x3d85ba({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x325e1d});return;}console['log']('UserSkip:\x20'+_0x1d76d4);if(_0x1d76d4==0x1)try{const _0x131965=await _0x3a7615['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x353620=>_0x353620['textContent']['trim']());console['log'](_0x131965);if(_0x131965==='Following'||_0x131965==='Folge\x20ich')return _0x759cfa({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0xf2ba5c){}try{await _0x3a7615['waitForSelector'](K_DIRECT_MSG_BUTTON),await _0x3a7615['click'](K_DIRECT_MSG_BUTTON);}catch(_0x333a69){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x333a69);try{await _0x3a7615['waitForSelector'](K_OPTIONS_BUTTON),await _0x3a7615['click'](K_OPTIONS_BUTTON),await delay(0x1f4,0x320);const _0x315775=await waitForXPath(_0x3a7615,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x315775['click']();}catch(_0x12ed7c){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x12ed7c),_0x759cfa({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x3a7615);}catch(_0x3ee960){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x3ee960);}try{const _0x4e0456=await _0x3a7615['waitForSelector'](K_CHAT_INPUT_FIELD);if(_0x4a9ba3){const _0x1a7d1a=await _0x3a7615['$']('div.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x6ikm8r.x10wlt62');if(_0x1a7d1a)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x191f62),_0x759cfa({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x39744b=await _0x3a7615['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x39744b),_0x3a6a43=_0x3a6a43['replace']('{USERNAME}',_0x191f62);let _0x47ff64;if(_0x3a6a43['includes']('{NAME}')||_0x3a6a43['includes']('{name}'))try{const _0x1f4502=await extractFirstName(_0x39744b,_0x2e9f68);console['log']('Response\x20Clearname\x20valid:\x20'+_0x1f4502['valid']),_0x1f4502['valid']?(_0x3a6a43=_0x3a6a43['replaceAll'](/{NAME}|{name}/g,_0x1f4502['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x1f4502['name']),_0x47ff64=_0x1f4502['name']):(_0x3a6a43=_0x3a6a43['replaceAll'](/ ?({NAME}|{name})/g,''),_0x47ff64='UNKNOWN_NAME');}catch(_0x140fac){console['log'](_0x140fac['message']),_0x47ff64=_0x140fac['message'];let _0xf7eff4=_0x39744b['replace'](/[^\p{L}\s]/gu,''),_0x52fca9=_0xf7eff4['split']('\x20')[0x0];_0x52fca9['length']>0x2&&!_0x52fca9['includes']('Instagram')?_0x3a6a43=_0x3a6a43['replaceAll'](/{NAME}|{name}/g,_0x52fca9):_0x3a6a43=_0x3a6a43['replaceAll'](/ ?({NAME}|{name})/g,'');}await _0x4e0456['type'](_0x3a6a43,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0x55ec7e=await waitForSelectorWithFallbacks(_0x3a7615,K_SEND_MSG_BUTTON);await _0x55ec7e['click'](),await delay(0x320,0x3e8),_0x759cfa({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x39744b,'extracted_clearname':_0x47ff64});}catch(_0x372cb7){try{await _0x3a7615['waitForSelector'](K_MSG_DISABLED_LABEL);const _0x225cf4=await _0x3a7615['evaluate'](_0x51c6a4=>{return document['querySelector'](_0x51c6a4)['textContent'];},K_MSG_DISABLED_LABEL);console['log']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20gefunden:\x20'+_0x225cf4),console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x372cb7),_0x759cfa({'status':0x195,'message':'Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x191f62+'\x20überspringen.'});}catch(_0x128941){console['error']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20nicht\x20gefunden:\x20'+_0x128941),console['error']('Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x191f62+'\x20:\x20'+_0x128941),_0x759cfa({'status':0x196,'message':'Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x191f62+'\x20:\x20'+_0x128941});}}});}function handle_fail(_0x4afeab){if(isStopping)return new Promise(_0x1b4205=>{_0x1b4205('Scraper\x20gestoppt.');});else{let _0x1d5b5a='';switch(_0x4afeab){case 0x0:_0x1d5b5a='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x1d5b5a='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x1d5b5a='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x1d5b5a='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x4bf17b,_0x23d06e)=>{_0x23d06e(_0x1d5b5a);});}}async function fetch_account_details(_0x23b659,_0x1a6ae6,_0x9d8a31,_0x740870){try{await setCookiesForUser(_0x23b659,_0x9d8a31['username']);}catch(_0x2ea2f2){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2ea2f2);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2ea2f2);return handle_fail(0x0);}_0x23b659['setDefaultNavigationTimeout'](0x7530),await _0x23b659['goto']('https://www.instagram.com/'+_0x1a6ae6+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x23b659);const _0x3d0e8a=await _0x23b659['evaluate'](()=>{const _0x66c8b=document['querySelector']('meta[property=\x22og:image\x22]');return _0x66c8b?_0x66c8b['getAttribute']('content'):null;});await _0x23b659['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x20c592=await _0x23b659['evaluate'](()=>{const _0x14a5cc=document['querySelector']('meta[name=\x22description\x22]');if(!_0x14a5cc)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x23c302=_0x14a5cc['getAttribute']('content');if(!_0x23c302)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x23c302);const _0x45c75a=/\s*[–-]\s*/,_0x53c32b=_0x23c302['split'](_0x45c75a);if(_0x53c32b['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x6b794a=_0x53c32b[0x0],_0x644a17=_0x53c32b[0x1],_0x435b4a=_0x6b794a['split'](',\x20');if(_0x435b4a['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x38d68f=_0x435b4a[0x0]['split']('\x20')[0x0],_0x4f40b0=_0x435b4a[0x1]['split']('\x20')[0x0],_0x351be2=_0x435b4a[0x2]['split']('\x20')[0x0];let _0x41bc1e='',_0x33f236='';const _0x544b16='\x20on\x20Instagram:\x20',_0x254637=_0x644a17['split'](_0x544b16);return _0x41bc1e=_0x254637[0x0]['trim'](),_0x41bc1e=_0x41bc1e['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x254637['length']>0x1&&(_0x33f236=_0x254637[0x1]['trim'](),_0x33f236['startsWith']('\x22')&&_0x33f236['endsWith']('\x22')&&(_0x33f236=_0x33f236['substring'](0x1,_0x33f236['length']-0x1)['trim']()),_0x33f236=_0x33f236['replace'](/&quot;/g,'')['trim']()),{'followers':_0x38d68f,'following':_0x4f40b0,'posts':_0x351be2,'nameText':_0x41bc1e,'bio':_0x33f236};});console['log']('Extracted\x20profile\x20data:',_0x20c592);const _0xf854c2=_0x20c592['nameText'],_0x4b0925=_0x3d0e8a,_0x4a9f52=_0x20c592['bio'],_0x51c231=_0x20c592['followers'],_0x266969=_0x20c592['following'],_0x4a1a00=_0x20c592['posts'],_0x5b8d68=![],_0x79f48b=![],_0x2f4eb7=![],_0x2efc9b='\x0a\x20\x20INSERT\x20INTO\x20'+_0x740870+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x2efc9b,[_0x1a6ae6,_0xf854c2,_0x4b0925,_0x4a9f52,_0x51c231,_0x266969,_0x4a1a00,_0x5b8d68,_0x79f48b,_0x2f4eb7],function(_0x43aa47){_0x43aa47?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x43aa47['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x18366f,_0x4ac65b,_0x37db05,_0x2e738d,_0x185d31,_0x21e92c,_0x310f7b){let _0x5cfec0=0x4,_0x1164bb=0x0,_0x184b90=0x0;try{await setCookiesForUser(_0x4ac65b,_0x21e92c['username']);}catch(_0x563ec7){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x563ec7);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x563ec7);return handle_fail(0x0);}let _0x7a04b6=0x0;try{await _0x4ac65b['goto']('https://www.instagram.com/'+_0x37db05+'/'),await notificationClear(_0x4ac65b);try{if(_0x2e738d<=0x0){const _0x44839c=await _0x4ac65b['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x1d89cb=await _0x4ac65b['evaluate'](_0x39b7ce=>_0x39b7ce['innerHTML'],_0x44839c);_0x7a04b6=Math['ceil'](_0x1d89cb/0x4);}else _0x7a04b6=Math['ceil'](_0x2e738d/0x4);_0x5cfec0+=_0x7a04b6,_0x184b90=Math['round'](++_0x1164bb/_0x5cfec0*0x64),_0x18366f['sender']['send']('fetch-progress',_0x184b90,!![]);let _0x402062=await _0x4ac65b['waitForSelector']('a[href=\x22/'+_0x37db05+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x402062['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x37db05+'\x20gesichtet'),_0x184b90=Math['round'](++_0x1164bb/_0x5cfec0*0x64),_0x18366f['sender']['send']('fetch-progress',_0x184b90,!![]);}catch(_0x4d1724){console['log']('Follower\x20Liste\x20von\x20'+_0x37db05+'\x20nicht\x20gefunden:'+_0x4d1724);throw new Error('Follower\x20Liste\x20von\x20'+_0x37db05+'\x20nicht\x20gefunden:'+_0x4d1724);return handle_fail(0x0);}}catch(_0x158ae6){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x158ae6);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x158ae6);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x7a04b6),await scroll(_0x4ac65b,FOLLOWER_FENSTER,_0x7a04b6,_0x5e0816=>{_0x184b90=Math['round'](++_0x1164bb/_0x5cfec0*0x64),_0x18366f['sender']['send']('fetch-progress',_0x184b90,!![]);}),await _0x4ac65b['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x5c267f=await _0x4ac65b['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x59a06e=await _0x4ac65b['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x184b90=Math['round'](++_0x1164bb/_0x5cfec0*0x64),_0x18366f['sender']['send']('fetch-progress',_0x184b90,!![]);_0x2e738d<=0x0&&(_0x2e738d=_0x5c267f['length']);let _0x5629d5=[];for(let _0x55b603=0x0;_0x55b603<_0x5c267f['length']&&_0x55b603<_0x2e738d;_0x55b603++){_0x5629d5['push'](await _0x5c267f[_0x55b603]['evaluate'](_0x2ed6e5=>_0x2ed6e5['textContent']));const _0x51a7fb='INSERT\x20INTO\x20'+_0x185d31+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x51a7fb,[await _0x5c267f[_0x55b603]['evaluate'](_0x35caf1=>_0x35caf1['textContent']),await _0x59a06e[_0x55b603]['evaluate'](_0x571be9=>_0x571be9['textContent'])],function(_0x104c61){_0x104c61?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x185d31+'\x27:',_0x104c61['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x184b90=Math['round'](++_0x1164bb/_0x5cfec0*0x64),_0x18366f['sender']['send']('fetch-progress',_0x184b90,!![]),_0x310f7b&&(_0x18366f['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x18366f,_0x4ac65b,_0x21e92c,_0x185d31,_0x5629d5)),new Promise(_0x4eb166=>{_0x4eb166('Scraping\x20finished!');});}catch(_0x455cae){if(_0x310f7b)throw new Error(_0x455cae);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x37db05+'\x20nicht\x20gefunden:\x20'+_0x455cae);return handle_fail(0x0);}}async function fetch_details_from_list(_0x4cc4af,_0x4c25f1,_0x42070b,_0x1f90ce,_0x2da5b9){let _0x46670d=0x0,_0x3e315e=0x0;for(let _0x407994=0x0;_0x407994<_0x2da5b9['length'];_0x407994++){console['log']('Processing\x20profile:',_0x2da5b9[_0x407994]);try{await fetch_account_details(_0x4c25f1,_0x2da5b9[_0x407994],_0x42070b,_0x1f90ce);}catch(_0x488c23){console['error']('Detailed\x20Scraping\x20von:\x20',_0x2da5b9[_0x407994],_0x488c23);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x2da5b9[_0x407994]+'\x20'+_0x488c23);}_0x3e315e=Math['round'](++_0x46670d/_0x2da5b9['length']*0x64),_0x4cc4af['sender']['send']('fetch-progress',_0x3e315e,!![],!![]);}}async function fetch_likers_from_post(_0x439365,_0x1e46e8,_0x1374f1,_0x478e1e,_0x41aeaf,_0xcca8e3,_0x1bea6e){let _0x532607=0x4,_0x2d8c5a=0x0,_0x57adf7=0x0;try{await setCookiesForUser(_0x1e46e8,_0xcca8e3['username']);}catch(_0x4b235d){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x4b235d);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x4b235d);return handle_fail(0x1);return;}_0x57adf7=Math['round'](++_0x2d8c5a/_0x532607*0x64),_0x439365['sender']['send']('fetch-progress',_0x57adf7,!![]);try{let _0xd24cac=_0x1374f1['substring'](0x0,_0x1374f1['lastIndexOf']('/')),_0x36d051=_0xd24cac+'/liked_by';console['log'](_0x36d051),await _0x1e46e8['goto'](_0x36d051),await delay(0x7d0,0xfa0),await notificationClear(_0x1e46e8),await delay(0xc8,0x1f4),_0x57adf7=Math['round'](++_0x2d8c5a/_0x532607*0x64),_0x439365['sender']['send']('fetch-progress',_0x57adf7,!![]),await _0x1e46e8['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x3c0770=await _0x1e46e8['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x5a68dd=await _0x1e46e8['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x3c0770['length']);let _0x32fecd=path['join'](__dirname,'/likers.csv');_0x57adf7=Math['round'](++_0x2d8c5a/_0x532607*0x64),_0x439365['sender']['send']('fetch-progress',_0x57adf7,!![]);_0x478e1e<=0x0&&(_0x478e1e=_0x3c0770['length']);try{let _0x8c672c=[];for(let _0x4e7b2e=0x0;_0x4e7b2e<_0x3c0770['length']&&_0x4e7b2e<_0x478e1e;_0x4e7b2e++){_0x8c672c['push'](await _0x3c0770[_0x4e7b2e]['evaluate'](_0x4b97a4=>_0x4b97a4['textContent']));try{const _0x4ceaf3='INSERT\x20INTO\x20'+_0x41aeaf+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x4ceaf3,[await _0x3c0770[_0x4e7b2e]['evaluate'](_0x867fc9=>_0x867fc9['textContent']),await _0x5a68dd[_0x4e7b2e]['evaluate'](_0x417c21=>_0x417c21['textContent'])],function(_0xd152d1){_0xd152d1?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x41aeaf+'\x27:',_0xd152d1['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x3f0f85){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x4e7b2e+'\x20:\x20'+_0x3f0f85);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x4e7b2e+'\x20:\x20'+_0x3f0f85);return handle_fail(0x1);}}return _0x57adf7=Math['round'](++_0x2d8c5a/_0x532607*0x64),_0x439365['sender']['send']('fetch-progress',_0x57adf7,!![]),_0x1bea6e&&(_0x439365['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x439365,_0x1e46e8,_0xcca8e3,_0x41aeaf,_0x8c672c)),new Promise(_0x4aba60=>{_0x4aba60('Scraping\x20finished!');});}catch(_0x5eb35c){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x5eb35c);return handle_fail(0x1);}}catch(_0x4818c1){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x4818c1);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x4818c1);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x5a59a4,_0x50614d,_0x19705b,_0x28028e,_0xf27b05,_0x5d09ae,_0x4ed1b2){let _0x434876=0x3,_0x1fb536=0x0,_0x225f6b=0x0;try{await setCookiesForUser(_0x50614d,_0x5d09ae['username']);}catch(_0x395b9f){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x395b9f);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x395b9f);return handle_fail(0x2);}try{console['log'](_0x19705b),await _0x50614d['goto'](_0x19705b),await delay(0x7d0,0xfa0),await notificationClear(_0x50614d),await delay(0xc8,0x1f4);const _0x4a216e=COM_COMMENTS_BOX_BODY_DIV;let _0x4da66f;const _0xc42f08=await _0x50614d['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x3b7c70=await _0x50614d['evaluate'](_0x4c0c34=>_0x4c0c34['innerHTML'],_0xc42f08),_0x1169a7=String(_0x3b7c70)['replace'](/[^0-9]/g,''),_0x30f7a0=Number(_0x1169a7)/0x14;_0x28028e<=0x0?_0x4da66f=Math['ceil'](_0x30f7a0/0x3):_0x4da66f=Math['ceil'](_0x28028e/0x3);_0x434876+=_0x4da66f,_0x225f6b=Math['round'](++_0x1fb536/_0x434876*0x64),_0x5a59a4['sender']['send']('fetch-progress',_0x225f6b,!![]),console['log']('Auto-scrolls:\x20'+_0x4da66f),await scroll(_0x50614d,_0x4a216e,_0x4da66f,_0x44e832=>{_0x225f6b=Math['round'](++_0x1fb536/_0x434876*0x64),_0x5a59a4['sender']['send']('fetch-progress',_0x225f6b,!![]);});try{const _0x5b9952=COM_REPLY_BUTTON_SPAN;await _0x50614d['waitForSelector'](_0x5b9952),await delay(0x1f4,0x320);const _0x93338b=await _0x50614d['$$'](_0x5b9952);console['log'](_0x93338b);let _0x286137=_0x93338b['length'];await delay(0xc8,0x1f4);try{for(let _0xb0f9a2=0x0;_0xb0f9a2<_0x286137;_0xb0f9a2++){_0x93338b[_0xb0f9a2]['click'](),await delay(0x320,0x5dc);}}catch(_0x13288a){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x13288a);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x13288a);return handle_fail(0x2);}}catch(_0x3ae388){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x296f89=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x50614d['waitForSelector'](_0x296f89),await delay(0x1f4,0x320),_0x225f6b=Math['round'](++_0x1fb536/_0x434876*0x64),_0x5a59a4['sender']['send']('fetch-progress',_0x225f6b,!![]);const _0x49eb95=await _0x50614d['$$'](_0x296f89);let _0x154e1a=path['join'](__dirname,'/comments.csv');_0x28028e<=0x0&&(_0x28028e=_0x49eb95['length']);console['log']('fetch_limit:\x20'+_0x28028e),console['log']('comments_len:\x20'+_0x49eb95['length']),_0x28028e++;try{let _0x335f69=[];for(let _0x251462=0x1;_0x251462<_0x49eb95['length']&&_0x251462<_0x28028e;_0x251462++){try{_0x335f69['push'](await _0x49eb95[_0x251462]['evaluate'](_0x47bc50=>_0x47bc50['textContent']));const _0x34965e=await db['prepare']('INSERT\x20INTO\x20'+_0xf27b05+'\x20(username)\x20VALUES\x20(?)');await _0x34965e['run'](await _0x49eb95[_0x251462]['evaluate'](_0x342bc7=>_0x342bc7['textContent']),function(_0x3b3400){_0x3b3400&&console['log']('error\x20in\x20add-user:'+_0x3b3400);}),await _0x34965e['finalize']();}catch(_0x9714c){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x251462+'\x20:\x20'+_0x9714c);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x251462+'\x20:\x20'+_0x9714c);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x225f6b=Math['round'](++_0x1fb536/_0x434876*0x64),_0x5a59a4['sender']['send']('fetch-progress',_0x225f6b,!![]),_0x5a59a4['sender']['send']('fetch-progress',0x64,!![]),_0x4ed1b2&&(_0x5a59a4['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x5a59a4,_0x50614d,_0x5d09ae,_0xf27b05,_0x335f69)),_0x5a59a4['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x466c00=>{_0x466c00('Scraping\x20finished!');});}catch(_0x1b1e60){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x1b1e60);return handle_fail(0x2);}}catch(_0x164631){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x164631);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x164631);return handle_fail(0x2);}}async function set_clearname_from_username(_0x43d2a6,_0x4cfae5,_0x2eb7b3=null){try{let _0x21b6c1,_0x5de3be;const _0x1585f9='SELECT\x20username\x20FROM\x20'+_0x4cfae5+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x1585f9,[],(_0x28dfa0,_0x517b0a)=>{_0x28dfa0&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x28dfa0['message']),_0x517b0a['length']===0x0&&(_0x5de3be=_0x517b0a['length']),_0x21b6c1=_0x517b0a['map'](_0x2d62d5=>_0x2d62d5['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x5de3be);if(_0x5de3be===0x0){console['log']('Leave');return;}const _0x1ea55a=await _0x43d2a6['waitForSelector'](IG_SEARCH_BUTTON);await _0x1ea55a['click'](),await delay(0x4b0,0x7d0);for(let _0x21c4cc of _0x21b6c1){const _0x4f77db=await _0x43d2a6['waitForSelector'](IG_SEARCH_INPUT);await _0x4f77db['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x43d2a6['type'](IG_SEARCH_INPUT,_0x21c4cc,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x3c0af8=0x1;while(_0x3c0af8!=0x14){console['log']('Schleife');try{let _0x316f46=IG_NAME_SPAN_PART1+_0x3c0af8+IG_USERNAME_SPAN_PART2;const _0xb2893e=await _0x43d2a6['waitForSelector'](_0x316f46),_0x4b612e=await _0x43d2a6['evaluate'](_0x1b499f=>_0x1b499f['innerHTML'],_0xb2893e);await delay(0xc8,0x1f4);if(_0x4b612e==_0x21c4cc){let _0x4330e8=IG_NAME_SPAN_PART1+_0x3c0af8+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x4f1193=await _0x43d2a6['waitForSelector'](_0x4330e8);let _0x308f3a=await _0x43d2a6['evaluate'](_0x42430a=>_0x42430a['innerHTML'],_0x4f1193);const _0x32f8a6=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x489148=_0x308f3a['match'](_0x32f8a6);_0x489148?_0x308f3a=_0x489148[0x1]['trim']():_0x308f3a=_0x308f3a['trim']();_0x308f3a['includes']('•')&&(_0x308f3a=_0x308f3a['substring'](0x0,_0x308f3a['indexOf']('•')-0x1));const _0x4f831b='UPDATE\x20'+_0x4cfae5+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x4f831b,[_0x308f3a,_0x4b612e],function(_0x11b3a2){_0x11b3a2&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x11b3a2['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x3c0af8++;}catch(_0x28b196){const _0x349fcd='UPDATE\x20'+_0x4cfae5+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x349fcd,['',_0x21c4cc],function(_0x25cafe){_0x25cafe&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x25cafe['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x28b196);break;}}_0x2eb7b3&&_0x2eb7b3();}await _0x1ea55a['click']();}catch(_0x7c735d){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x7c735d);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x538eff,_0x5692bf)=>{const _0x39f6d4='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x39f6d4,[],(_0x9f5cfe,_0x43cce1)=>{_0x9f5cfe?_0x5692bf(_0x9f5cfe):_0x538eff(_0x43cce1);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x27bf6a,_0x45e2ae)=>{const _0x4b9665='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x4b9665,[],async(_0x52e74a,_0x1d4fdc)=>{if(_0x52e74a)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x52e74a['message']),_0x45e2ae({'status':'error','message':_0x52e74a['message']});else try{const _0x48785a=await Promise['all'](_0x1d4fdc['map'](_0x3c8b63=>{return new Promise(_0x15e5a8=>{if(!_0x3c8b63['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x3c8b63['campaign_name']),_0x15e5a8({'campaign_name':_0x3c8b63['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x5e7468='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x3c8b63['list_id'],_0x42b110='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x3c8b63['list_id']+'\x22';db['get'](_0x5e7468,[],(_0x45f5e0,_0x100767)=>{_0x45f5e0?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x3c8b63['campaign_name']+':',_0x45f5e0['message']),_0x15e5a8({'campaign_name':_0x3c8b63['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x42b110,[],(_0xe16355,_0x26ac04)=>{_0xe16355?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x3c8b63['campaign_name']+':',_0xe16355['message']),_0x15e5a8({'campaign_name':_0x3c8b63['campaign_name'],'lead_count':_0x100767?_0x100767['lead_count']:0x0,'contacted_count':'N/A'})):_0x15e5a8({'campaign_name':_0x3c8b63['campaign_name'],'lead_count':_0x100767?_0x100767['lead_count']:0x0,'contacted_count':_0x26ac04?_0x26ac04['contacted_count']:0x0});});});});}));_0x27bf6a({'status':'success','campaigns':_0x48785a});}catch(_0x386455){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x386455),_0x45e2ae({'status':'error','message':_0x386455['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x1d197d,_0x2882c2)=>{return new Promise((_0x4f06db,_0x297839)=>{const _0x55357c='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x55357c,[_0x2882c2],(_0xd9e05f,_0x3c7230)=>{_0xd9e05f?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0xd9e05f),_0x297839(_0xd9e05f)):(console['log']('ROWS'),console['log'](_0x3c7230),debugDatabaseContents(),_0x4f06db(_0x3c7230));});});});const showTableContents=_0x25c7fc=>{return new Promise((_0x221c13,_0x332b0f)=>{const _0x59bcff='SELECT\x20*\x20FROM\x20'+_0x25c7fc+';';campaignDB['all'](_0x59bcff,(_0xa7609d,_0x210314)=>{_0xa7609d?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x25c7fc+':',_0xa7609d),_0x332b0f(_0xa7609d)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x25c7fc+':',_0x210314),_0x221c13({'status':'success','message':_0x210314}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x4dd1fc){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x4dd1fc);}}ipcMain['handle']('create-campaign',async(_0x3ec625,_0x1e09f0)=>{return new Promise((_0x216716,_0x218242)=>{const _0x2d77a1='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x2d77a1,[String(_0x1e09f0)],function(_0x27b174){_0x27b174?_0x218242(_0x27b174):_0x216716({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x32e660,_0x50cfd9)=>{return new Promise((_0x530206,_0x1d4b35)=>{const _0x371d57='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x371d57,[_0x50cfd9],function(_0x2ff6aa){_0x2ff6aa?_0x1d4b35(_0x2ff6aa):_0x530206({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x4c0daf,_0x241171,_0x2b2d86,_0x209688,_0x1c46a5,_0x54e2a2,_0x3b2987,_0x1b338c)=>{const _0x448605=await createMessageID(_0x1c46a5);return new Promise((_0xac72d4,_0x3d081f)=>{if(!_0x241171||!_0x2b2d86||!_0x209688||!_0x448605||!_0x54e2a2)return _0x3d081f({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x448605);const _0x4d3d1e='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x4d3d1e,[_0x2b2d86,_0x209688,_0x448605,_0x54e2a2,_0x3b2987,_0x1b338c,_0x241171],function(_0x69ce85){if(_0x69ce85)_0x3d081f({'status':'error','message':_0x69ce85['message']});else this['changes']===0x0?_0x3d081f({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0xac72d4({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x507637,_0x393051,_0x146797,_0x3418d5,_0x34967a)=>{return new Promise((_0x2e3f5e,_0x10f302)=>{const _0x5b3a7d='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x5b3a7d,[_0x393051,_0x146797,_0x3418d5,_0x34967a],function(_0x5483e1){return _0x5483e1?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x5483e1['message']),_0x10f302('insert-dm-response',{'success':![],'message':_0x5483e1['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x2e3f5e('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x23ad3c=>{return new Promise((_0x184577,_0x250b3f)=>{const _0x383c19='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x383c19,[_0x23ad3c],(_0x5eed11,_0x1b4cca)=>{if(_0x5eed11)_0x250b3f({'status':'error','message':_0x5eed11['message']});else{if(_0x1b4cca)_0x184577(_0x1b4cca['message_id']);else{const _0xdcf34='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0xdcf34,[_0x23ad3c],function(_0x2fa93a){_0x2fa93a?_0x250b3f({'status':'error','message':_0x2fa93a['message']}):_0x184577(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x14d10c,_0x159158)=>{return new Promise((_0x3a6eb8,_0x5c090b)=>{const _0x146fa5='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x159158;db['get'](_0x146fa5,(_0x2c5946,_0x49afce)=>{_0x2c5946?_0x5c090b({'status':'error','message':_0x2c5946['message']}):_0x3a6eb8({'status':'success','count':_0x49afce['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x3c56ef,_0x58df71){try{const _0x309425=await new Promise((_0x5509d7,_0x1f83a3)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x58df71],(_0xfaa7f5,_0x119e65)=>{if(_0xfaa7f5)_0x1f83a3(_0xfaa7f5);else{if(_0x119e65['length']>0x0){let _0x4e23eb=JSON['parse'](_0x119e65[0x0]['cookie']);console['log'](_0x4e23eb),_0x5509d7(_0x4e23eb);}else _0x1f83a3(new Error('User\x20with\x20username\x20'+_0x58df71+'\x20does\x20not\x20exist.'));}});});await _0x3c56ef['setCookie'](..._0x309425),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x496014){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x496014);}}async function saveCookiesForUser(_0x514803,_0x14a9f7){try{const _0x4c4138=await _0x514803['cookies']();if(!_0x4c4138||_0x4c4138['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x14a9f7);const _0x22434f=JSON['stringify'](_0x4c4138);if(_0x22434f['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x14a9f7);return new Promise((_0x9d60df,_0x410c1f)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x14a9f7],(_0x4b8537,_0x10e26b)=>{if(_0x4b8537)return console['error']('Error\x20checking\x20user\x20existence:',_0x4b8537),_0x410c1f(_0x4b8537);if(_0x10e26b){const _0x3e2535=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x3e2535['run'](_0x22434f,_0x14a9f7,function(_0x187dfd){return _0x187dfd?(console['error']('Error\x20updating\x20cookies:',_0x187dfd),_0x410c1f(_0x187dfd)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x14a9f7),_0x9d60df());});}else{const _0x4e4d3b=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x4e4d3b['run'](_0x14a9f7,_0x22434f,function(_0x4d67b4){return _0x4d67b4?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x4d67b4),_0x410c1f(_0x4d67b4)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x14a9f7),_0x9d60df());});}});});}catch(_0x5043d3){console['error']('Error\x20fetching\x20cookies:',_0x5043d3);throw _0x5043d3;}}async function createUserIfNotExists(_0x35674d){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x35674d],(_0x132cac,_0x12b52d)=>{if(_0x132cac){console['error']('Error\x20checking\x20user\x20existence:',_0x132cac);throw _0x132cac;}else{if(!_0x12b52d){const _0xb948c8=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0xb948c8['run'](_0x35674d,function(_0x3cc240){_0x3cc240?console['error']('Error\x20inserting\x20new\x20user:',_0x3cc240):console['log']('New\x20user\x20created:',_0x35674d);});}else console['log']('User\x20already\x20exists:',_0x35674d);}});}catch(_0x38a370){console['error']('Error\x20creating\x20user:',_0x38a370);throw _0x38a370;}}ipcMain['handle']('create-relation',async(_0x3e0471,_0x152dd0)=>{return new Promise((_0xf18008,_0x5a862b)=>{const _0x4374f6='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x152dd0+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x4374f6,function(_0x118929){_0x118929?_0x5a862b(_0x118929):_0xf18008({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x175080,_0x55429d)=>{return console['log']('droping\x20table'+_0x55429d),new Promise((_0x5999b7,_0x3393c6)=>{const _0xc1af71='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x55429d;console['log']('droping\x20table'+_0x55429d),db['run'](_0xc1af71,function(_0x5494b4){_0x5494b4?_0x3393c6(_0x5494b4):_0x5999b7({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x9f78ec=>{return new Promise((_0x68567f,_0x5aa7c9)=>{const _0x48d320='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x48d320,[],(_0x1c795a,_0x629cc3)=>{_0x1c795a?_0x5aa7c9(_0x1c795a):_0x68567f(_0x629cc3['map'](_0x4f636d=>_0x4f636d['name']));});});}),ipcMain['handle']('add-user',async(_0x48e24e,_0x1f3687,_0x1c7692)=>{return new Promise(_0x518f34=>{const _0x40917f=db['prepare']('INSERT\x20INTO\x20'+_0x1c7692+'\x20(username)\x20VALUES\x20(?)');_0x40917f['run'](_0x1f3687,function(_0x53ec74){_0x53ec74?console['log']('error\x20in\x20add-user:'+_0x53ec74):_0x518f34({'status':'success','id':this['lastID']});}),_0x40917f['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x25b8b4,_0x2821e2)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x3589d2,_0x5e7329)=>{if(_0x3589d2)_0x2821e2(_0x3589d2);else{_0x25b8b4({'status':'success','users':_0x5e7329});for(_0x5e7329 of _0x5e7329){console['log'](_0x5e7329['username']);}}});});}),ipcMain['handle']('get-data',async(_0x48b33d,_0x1cbe70)=>{return new Promise((_0x4d1a61,_0xdb4fa)=>{const _0x4322df='SELECT\x20*\x20FROM\x20'+_0x1cbe70;console['log'](_0x4322df),db['all'](_0x4322df,[],(_0x3a54a3,_0xab0dde)=>{_0x3a54a3?_0xdb4fa(_0x3a54a3):_0x4d1a61(_0xab0dde);});});}),ipcMain['handle']('get-accounts',async _0x26ed4d=>{return new Promise((_0xd2e68c,_0x286e53)=>{const _0x3b2ccb='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x3b2ccb),igaccountsDB['all'](_0x3b2ccb,[],(_0x8c6f1c,_0x557976)=>{_0x8c6f1c?_0x286e53(_0x8c6f1c):_0xd2e68c(_0x557976);});});}),ipcMain['handle']('get-targets',async(_0x3c5ed0,_0x1482cf)=>{return getTargetProfiles(_0x1482cf);}),ipcMain['handle']('delete-user',async(_0x8208a9,_0x121c28,_0x5b5afc)=>{return new Promise((_0x541424,_0x509238)=>{const _0x57d8b6=db['prepare']('DELETE\x20FROM\x20'+_0x5b5afc+'\x20WHERE\x20username\x20=\x20?');_0x57d8b6['run'](_0x121c28,function(_0xf2d499){_0xf2d499?_0x509238(_0xf2d499):_0x541424({'status':'success','changes':this['changes']});}),_0x57d8b6['finalize']();});}),ipcMain['handle']('delete-account',async(_0x117cf4,_0x187ba7)=>{const _0x2643f0=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x2643f0['run'](_0x187ba7,function(_0x58d452){_0x58d452&&console['log'](_0x58d452);}),_0x2643f0['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0xfcdb5e,_0x4d9808)=>{const _0x4fb740='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x4fb740,[],(_0x5925ee,_0x335715)=>{_0x5925ee?_0x4d9808({'status':'error','message':_0x5925ee['message']}):_0xfcdb5e({'status':'success','contactedCount':_0x335715['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x28114f,_0x1cd007)=>{const _0x49416d='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x49416d,[],(_0x5d7bd6,_0x1aa68)=>{_0x5d7bd6?_0x1cd007({'status':'error','message':_0x5d7bd6['message']}):_0x28114f({'status':'success','contactedCount':_0x1aa68['contactedCount']});});});});function exportDatabase(_0x56d089){return new Promise((_0xac5d5e,_0x5e7272)=>{const _0x26a85='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x56d089+'\x0a\x20\x20\x20\x20';db['all'](_0x26a85,[],async(_0x3455d7,_0x252cb9)=>{if(_0x3455d7){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x3455d7['message']),_0x5e7272(_0x3455d7);return;}if(!_0x252cb9||_0x252cb9['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0xac5d5e();return;}const _0x5434ae=XLSX['utils']['json_to_sheet'](_0x252cb9),_0x3ac43a=XLSX['utils']['sheet_to_csv'](_0x5434ae);try{const {canceled:_0x621d0,filePath:_0x9b5e1e}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x56d089+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x621d0||!_0x9b5e1e){console['log']('Speichern\x20abgebrochen.'),_0xac5d5e();return;}fs['writeFile'](_0x9b5e1e,_0x3ac43a,'utf8',_0x21ca13=>{_0x21ca13?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x21ca13['message']),_0x5e7272(_0x21ca13)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x9b5e1e),_0xac5d5e());});}catch(_0x2db47c){console['error']('Fehler\x20im\x20Speicherdialog:',_0x2db47c),_0x5e7272(_0x2db47c);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x4809db,_0x504697)=>{shell['openExternal'](_0x504697);});