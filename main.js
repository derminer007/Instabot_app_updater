const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');async function extractFirstName(_0x1cd483,_0x465a67){try{const _0x1f8509=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x465a67},'body':JSON['stringify']({'clearname':_0x1cd483})});if(!_0x1f8509['ok']){const _0x36c7c8=await _0x1f8509['text']();throw new Error(_0x1f8509['status']+':\x20'+_0x36c7c8);}const _0xeb8b33=await _0x1f8509['json']();return _0xeb8b33;}catch(_0x211b5d){console['error']('Error\x20in\x20extractFirstName:',_0x211b5d);throw _0x211b5d;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div:has(>\x20div[style=\x22height:\x20auto;\x20overflow:\x20hidden\x20auto;\x22])',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='[style=\x22line-height:\x2018px;\x22]',COM_COMMENTS_BOX_BODY_DIV='div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='//span[contains(.,\x20\x27View\x20all\x27)\x20and\x20contains(.,\x20\x27replies\x27)]',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Message\x27]','div.x9f619.xjbqb8w.x78zum5.x15mokao.x1ga7v0g.x16uus16.xbiv7yw.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div','div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div'],K_OPTIONS_BUTTON=['[aria-label=\x22Options\x22]','section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.x1jfgfrl\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div'],K_EXPAND_MSG_BUTTON='[aria-label=\x22Expand\x22]',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD=['[aria-label=\x22Message\x22]','div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f'],K_SEND_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Send\x27]','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_ALREADY_CHATTED='[aria-label=\x22Like\x22]',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',K_BEITRAG_ARRAY_SELECTOR='._aagv',K_BEITRAG_LIKE_BUTTON='section\x20>\x20span\x20>\x20div\x20>\x20div',K_STORY_ARRAY_SELECTOR='._acaz',K_STORY_LIKE_BUTTON='div.x6s0dn4.x78zum5.x67bb7w\x20>\x20div.x78zum5.xvc5jky\x20>\x20span\x20>\x20div\x20>\x20div',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x94791c=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x94791c['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x94791c['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x156bfe){var _0x581bb2=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x4dc813){console['log']('window\x20id:'+_0x4dc813['id']),_0x4dc813['id']>0x1&&(_0x581bb2=!![]);}),console['log']('child\x20opened\x20='+_0x581bb2);if(!_0x581bb2){const _0x4174d2=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x4174d2['loadFile'](_0x156bfe['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x41cce1=require('fs'),_0x1ce8b6=path['join'](app['getPath']('userData'),'data'),_0x55600c=['campaign.db','crm.db','igaccounts.db'],_0x4e0bf0=[];try{_0x41cce1['mkdirSync'](_0x1ce8b6,{'recursive':!![]});for(const _0x181d30 of _0x55600c){const _0x515552=path['join'](process['resourcesPath'],'app','build','data',_0x181d30),_0x328666=path['join'](_0x1ce8b6,_0x181d30);!_0x41cce1['existsSync'](_0x328666)?(_0x41cce1['copyFileSync'](_0x515552,_0x328666),console['log']('[InitDB]\x20Kopiert\x20'+_0x181d30+'\x20nach:\x20'+_0x328666)):console['log']('[InitDB]\x20'+_0x181d30+'\x20existiert\x20bereits:\x20'+_0x328666),_0x4e0bf0['push'](_0x328666);}}catch(_0xbb7113){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0xbb7113);}return _0x4e0bf0;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x5b8a23,AppUpdate:_0x507ce9}=require('electron-updater');_0x5b8a23['autoDownload']=![],_0x5b8a23['autoInstallOnAppQuit']=!![],_0x5b8a23['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x5b8a23['on']('update-available',_0x25223d=>{console['log']('Update\x20verfügbar:',_0x25223d),_0x5b8a23['downloadUpdate']();}),_0x5b8a23['on']('update-downloaded',_0x29f1e2=>{console['log']('Update\x20heruntergeladen:',_0x29f1e2),_0x5b8a23['quitAndInstall']();}),_0x5b8a23['on']('error',_0x1d41cb=>{console['error']('Fehler\x20beim\x20Updaten:',_0x1d41cb);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x5da8e7,AppUpdate:_0xb67e1a}=require('electron-updater');_0x5da8e7['autoDownload']=![],_0x5da8e7['autoInstallOnAppQuit']=!![],_0x5da8e7['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x5da8e7['on']('update-available',_0x1a7183=>{console['log']('Update\x20verfügbar:',_0x1a7183),_0x5da8e7['downloadUpdate']();}),_0x5da8e7['on']('update-downloaded',_0x529ee4=>{console['log']('Update\x20heruntergeladen:',_0x529ee4),console['log']('Neustarten\x20zum\x20Updaten');}),_0x5da8e7['on']('error',_0x5ebf2a=>{console['error']('Fehler\x20beim\x20Updaten:',_0x5ebf2a);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let isHeadless=!![],browser_login=null;async function getBrowserPageLogin(){let _0x61415f='',_0x7a9a2f=null;if(process['platform']==='darwin')_0x61415f=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x61415f=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x61415f}),_0x7a9a2f=await browser_login['newPage'](),_0x7a9a2f['setDefaultNavigationTimeout'](0x3a98),_0x7a9a2f['setDefaultTimeout'](0x3a98),await _0x7a9a2f['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x7a9a2f;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0xd64f71=0x1,_0x3b4a5a=0x0){try{let _0x3590ff='',_0x64d21a=null;const _0x513a89=isHeadless;if(process['platform']==='darwin')_0x3590ff=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x3590ff=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0xd64f71===0x0&&!pageStack[_0x3b4a5a])return browser=await puppeteer['launch']({'headless':_0x513a89,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x3590ff}),_0x64d21a=await browser['newPage'](),_0x64d21a['setDefaultNavigationTimeout'](0x3a98),_0x64d21a['setDefaultTimeout'](0x3a98),await _0x64d21a['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x3b4a5a]=_0x64d21a,_0x64d21a;return(browser===null||pageStack[_0x3b4a5a]===null||pageStack[_0x3b4a5a]['isClosed']())&&(browser=await puppeteer['launch']({'headless':isHeadless,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x3590ff})),(pageStack[_0x3b4a5a]===null||pageStack[_0x3b4a5a]['isClosed']())&&(_0x64d21a=await browser['newPage'](),_0x64d21a['setDefaultNavigationTimeout'](0x3a98),_0x64d21a['setDefaultTimeout'](0x3a98),await _0x64d21a['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x3b4a5a]=_0x64d21a),pageStack[_0x3b4a5a];}catch(_0x1bfccf){console['error']('Failed\x20to\x20launch\x20browser:',_0x1bfccf);const _0x4dee93=new Error('Browser\x20konnte\x20nicht\x20gestartet\x20werden.\x20Bitte\x20starte\x20die\x20App\x20neu.\x20:\x20'+_0x1bfccf);throw _0x4dee93;}}ipcMain['on']('login',async(_0x1dce0c,_0x3974c7)=>{const _0x2a7e02=await getBrowserPageLogin();await _0x2a7e02['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x2a7e02,_0x3974c7),ipcMain['on']('setLoginCookies',async(_0x4ec4af,_0x3c17b6)=>{try{await set_login_cookies(_0x2a7e02,_0x3c17b6);}catch(_0x16b334){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x16b334);}});}),ipcMain['handle']('set-headless',async(_0x3b6217,_0x4da820)=>{return isHeadless=!!_0x4da820,console['log']('[MAIN]\x20isHeadless\x20gesetzt\x20auf:',isHeadless),{'ok':!![],'headless':isHeadless};}),ipcMain['handle']('get-headless',async()=>{return{'headless':isHeadless};}),ipcMain['on']('export-relation',async(_0xd70be2,_0x4eaaca)=>{try{await exportDatabase(_0x4eaaca),_0xd70be2['reply']('export-relation-response',{'success':!![]});}catch(_0x2301e7){console['error'](_0x2301e7),_0xd70be2['reply']('export-relation-response',{'success':![],'message':_0x2301e7['message']});}}),ipcMain['handle']('sendMessage',async(_0x88bbdd,_0x37a62a,_0x577e54,_0x194bcc,_0x2cb5a0,_0x4b1824,_0x5ab342,_0x39dd8b,_0x2cda84,_0x19cf90,_0x405925,_0x4dc249,_0x22ba27)=>{isStopping=![];let _0x13262d=null;return _0x5ab342?_0x13262d=await getBrowserPage(_0x2cb5a0,_0x39dd8b):_0x13262d=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x37a62a),send_message(_0x13262d,_0x37a62a,_0x577e54,_0x194bcc,_0x2cb5a0,_0x4b1824,_0x2cda84,_0x19cf90,_0x405925,_0x4dc249,_0x22ba27);}),ipcMain['handle']('stop-action',async(_0x2c3ad0,_0x3452f7)=>{isStopping=!![];const _0x5dccf8=await getBrowserPage(0x1,_0x3452f7);await _0x5dccf8['close']();}),ipcMain['handle']('fetch_followers',async(_0x47872b,_0x20a070,_0xa72588,_0x521027,_0x22c898,_0x349e9b,_0x4a4a08)=>{isStopping=![];const _0x2d2213=await getBrowserPage();return fetch_followers_from_account(_0x47872b,_0x2d2213,_0x20a070,_0xa72588,_0x521027,_0x22c898,_0x349e9b,_0x4a4a08);}),ipcMain['handle']('get-account-details',async(_0x58bc3d,_0x42d64d,_0x33ead9,_0x478345)=>{isStopping=![];const _0x1e552a=await getBrowserPage();return fetch_account_details(_0x1e552a,_0x42d64d,_0x33ead9,_0x478345);}),ipcMain['handle']('fetch_likes',async(_0x4dc192,_0x58331b,_0x2b356c,_0xb22c45,_0x5e0580,_0x24fef5,_0x30039c)=>{isStopping=![];const _0x49bd4a=await getBrowserPage();return fetch_likers_from_post(_0x4dc192,_0x49bd4a,_0x58331b,_0x2b356c,_0xb22c45,_0x5e0580,_0x24fef5,_0x30039c);}),ipcMain['handle']('fetch_comments',async(_0x3bdae8,_0xb6fa78,_0x3408ab,_0x3ffbc1,_0x12dcab,_0x15e389,_0x622573)=>{isStopping=![];const _0x656a89=await getBrowserPage();return fetch_comments_from_post(_0x3bdae8,_0x656a89,_0xb6fa78,_0x3408ab,_0x3ffbc1,_0x12dcab,_0x15e389,_0x622573);});async function updateAppSilent(){const {spawn:_0x172c57}=require('child_process'),_0x3bb429=require('path'),_0x8d0164=require('electron-log');return _0x8d0164['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x5347df,_0x38e16a)=>{const {updateElectronApp:_0xfe872,UpdateSourceType:_0xba147f}=require('update-electron-app');_0xfe872({'updateSource':{'type':_0xba147f['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x8d0164}),_0x5347df('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x19b5e1,_0x12fc0b)=>{doFullElectronUpdateSilent(),_0x19b5e1('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x2678b7}=require('child_process'),_0x4a379c=require('path'),_0x5b711d=require('electron-log');return _0x5b711d['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x27e58c,_0x705ae3)=>{const {updateElectronApp:_0x178442,UpdateSourceType:_0x3f872a}=require('update-electron-app');_0x178442({'updateSource':{'type':_0x3f872a['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x5b711d}),_0x27e58c('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x476c7b,_0x3ebe3e)=>{doFullElectronUpdate(),_0x476c7b('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0x1e2e0e,_0x4ccff7)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x1e2e0e('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x30b686=path['join'](__dirname,'mac-updater-intern.sh'),_0x4480b6=spawn('/bin/bash',[_0x30b686],{'detached':!![],'stdio':'ignore'});_0x4480b6['unref'](),setTimeout(()=>{_0x1e2e0e('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0x4ccff7(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0xf566dd=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x56ce4b,_0xd8fb81)=>{console['log']('Update\x20Silent:\x20'+_0xd8fb81);if(_0xd8fb81){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0x36e33c,_0x5ee5d0){return Math['random']()*(_0x5ee5d0-_0x36e33c+0x1)+_0x36e33c;}function delay(_0x4145a8,_0x106346){let _0x2e25a7=getRnd(_0x4145a8,_0x106346);return new Promise(function(_0x51a1ef){setTimeout(_0x51a1ef,_0x2e25a7);});}async function scroll(_0x1cce13,_0x644673,_0x587ec4=0x2,_0x5d914a){const _0x5cc27b=await _0x1cce13['waitForSelector'](_0x644673);for(let _0x4e83ae=0x0;_0x4e83ae<_0x587ec4;_0x4e83ae++){console['log']('Scrolling\x20'+_0x4e83ae),await _0x1cce13['evaluate'](_0x159a23=>{const _0x4c3ccd=document['querySelector'](_0x159a23);_0x4c3ccd&&_0x4c3ccd['scrollBy'](0x0,0x190);},_0x644673),await delay(0x320,0x5dc),_0x5d914a();}}async function saveCookies(_0x37969f){let _0xf7a962=await _0x37969f['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0xf7a962,null,0x2));}async function notificationClear(_0x19b7fb){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xfa0,0x1388),await _0x19b7fb['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x19b7fb['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x44b703){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x44b703);}}async function getTargetProfiles(_0xef7d6c){return new Promise((_0x14af4a,_0x3c8b2e)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0xef7d6c,(_0x2afb22,_0x50db66)=>{_0x2afb22?_0x3c8b2e(_0x2afb22):_0x14af4a(_0x50db66);});});}async function login_legacy(_0x4fac9a,_0x5416cd,_0x171b65){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x4fac9a,_0x5416cd),await createUserIfNotExists(_0x5416cd,_0x171b65);}catch(_0x1e7cf6){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x1e7cf6);}try{await _0x4fac9a['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x4fac9a['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x4fac9a['click']('button._a9--._ap36._a9_0');}catch(_0x350df6){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x4fac9a['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x4fac9a['type']('input[name=\x27username\x27]',_0x5416cd,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x4fac9a['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x4fac9a['type']('input[name=\x27password\x27]',_0x171b65,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x4fac9a['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x4fac9a['click']('button[type=\x27submit\x27]');}catch(_0x29310a){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x4fac9a),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x4fac9a,_0x5416cd);}catch(_0x262511){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x262511);}}catch(_0x2245b3){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x2245b3);}}async function login(_0x1aa3f8,_0x534094){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x1aa3f8,_0x534094),await createUserIfNotExists(_0x534094);}catch(_0x43337f){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x43337f);}try{await _0x1aa3f8['goto']('https://www.instagram.com/accounts/login/');}catch(_0x556178){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x556178);}}async function set_login_cookies(_0x521777,_0x4e038f){try{await saveCookiesForUser(_0x521777,_0x4e038f);}catch(_0x3f2de5){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x3f2de5);}}async function waitForXPath(_0x5cbf4f,_0x37dfc3,_0x2ebd56={}){return await _0x5cbf4f['waitForFunction'](_0x5236f6=>{return document['evaluate'](_0x5236f6,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x2ebd56,_0x37dfc3),_0x5cbf4f['evaluateHandle'](_0x5ad52f=>document['evaluate'](_0x5ad52f,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x37dfc3);}async function waitForSelectorWithFallbacks(_0x5946ae,_0x2cb773,_0x63f7ea={}){!Array['isArray'](_0x2cb773)&&(_0x2cb773=[_0x2cb773]);for(let _0x4158fe=0x0;_0x4158fe<_0x2cb773['length'];_0x4158fe++){const _0x18b6fd=_0x2cb773[_0x4158fe],_0x136630=_0x18b6fd['startsWith']('//')||_0x18b6fd['startsWith']('(//');try{console['log']('Versuche\x20'+(_0x136630?'XPath':'Selector')+'\x20'+(_0x4158fe+0x1)+'/'+_0x2cb773['length']+':\x20'+_0x18b6fd['substring'](0x0,0x32)+'...');const _0x3c7303=_0x4158fe===0x0?_0x63f7ea['timeout']||0x1388:0x7d0;let _0x10413a;if(_0x136630){const _0x36315b=await waitForXPath(_0x5946ae,_0x18b6fd,{..._0x63f7ea,'timeout':_0x3c7303});if(!_0x36315b)throw new Error('XPath-Element\x20nicht\x20gefunden');_0x10413a=_0x36315b;}else _0x10413a=await _0x5946ae['waitForSelector'](_0x18b6fd,{..._0x63f7ea,'timeout':_0x3c7303});return console['log']((_0x136630?'XPath':'Selector')+'\x20'+(_0x4158fe+0x1)+'\x20gefunden!'),_0x10413a;}catch(_0x4f7bb1){console['log']((_0x136630?'XPath':'Selector')+'\x20'+(_0x4158fe+0x1)+'\x20nicht\x20gefunden:\x20'+_0x4f7bb1['message']);if(_0x4158fe===_0x2cb773['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x2cb773['length']+'\x20Selektoren/XPath\x20konnte\x20gefunden\x20werden:\x20'+_0x4f7bb1['message']);}}throw new Error('Keine\x20Selektoren/XPath\x20angegeben');}async function waitForXPathAll(_0x5e4bd7,_0x2a5762,_0x715c51={}){return await _0x5e4bd7['waitForFunction'](_0x4a287e=>{return document['evaluate'](_0x4a287e,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null)['snapshotLength']>0x0;},_0x715c51,_0x2a5762),_0x5e4bd7['evaluateHandle'](_0x39e20f=>{const _0x2dffd6=document['evaluate'](_0x39e20f,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null),_0x1f27da=[];for(let _0x296a3e=0x0;_0x296a3e<_0x2dffd6['snapshotLength'];_0x296a3e++){_0x1f27da['push'](_0x2dffd6['snapshotItem'](_0x296a3e));}return _0x1f27da;},_0x2a5762)['then'](_0x5f0fe6=>_0x5f0fe6['getProperties']());}ipcMain['handle']('check-login',async(_0x51b14b,_0x2fad66)=>{if(pageStack[0x0]){try{await pageStack[0x0]['close']();}catch(_0x33d6c3){}pageStack[0x0]=null;}if(browser){try{await browser['close']();}catch(_0x34845c){}browser=null;}const _0xb76ae2=await getBrowserPage(0x0,0x0),_0x468958=await checkCookiesSession(_0xb76ae2,_0x2fad66);return _0x468958;});async function checkCookiesSession(_0x38eb81,_0x3b55e6){try{await setCookiesForUser(_0x38eb81,_0x3b55e6),console['log']('Cookies\x20für\x20'+_0x3b55e6+'\x20erfolgreich\x20geladen');}catch(_0x66549a){return console['error']('Fehler\x20beim\x20Laden\x20der\x20Cookies\x20für\x20'+_0x3b55e6+':',_0x66549a),![];}try{await _0x38eb81['goto']('https://www.instagram.com/',{'timeout':0x3a98});}catch(_0x44573b){console['error']('Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x44573b);}await delay(0x6a4,0x7d0);try{const _0x4edb6d=await checkLoginStatus(_0x38eb81);return console['log']('Login-Status\x20für\x20'+_0x3b55e6+':\x20'+_0x4edb6d),_0x4edb6d;}catch(_0x150d86){return console['warn']('Login-Prüfung\x20fehlgeschlagen\x20für\x20'+_0x3b55e6+':',_0x150d86['message']),![];}}async function checkLoginStatus(_0x4ee050){const _0x1eb71d=['[type=\x22password\x22]','//a[normalize-space(text())=\x27Log\x20In\x27]','//div[@role=\x27button\x27\x20and\x20normalize-space(.)=\x27Log\x20in\x27]','//h3[normalize-space(text())=\x27Something\x20went\x20wrong\x27]'];let _0x46f0b9=null;try{_0x46f0b9=await waitForSelectorWithFallbacks(_0x4ee050,_0x1eb71d,{'timeout':0x7d0});}catch(_0x32ee50){return console['log']('Eingeloggt,\x20kein\x20Login\x20notwendig:\x20'+_0x32ee50),!![];}if(_0x46f0b9){console['log']('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return![];}else return console['log']('Eingeloggt,\x20führe\x20keine\x20Login\x20durch'),!![];}async function checkPageExists(_0x5d6e79){const _0x49e80f=['//span[contains(normalize-space(.),\x22Sorry,\x20this\x20page\x20isn\x27t\x20available\x22)]'];let _0x32e801=null;try{_0x32e801=await waitForSelectorWithFallbacks(_0x5d6e79,_0x49e80f,{'timeout':0x7d0});}catch(_0x36975a){return console['log']('Seite\x20existiert:\x20'+_0x36975a),!![];}if(_0x32e801){console['log']('Angegbene\x20Seite\x20existiert\x20nicht');throw new Error('Angegbene\x20Seite\x20existiert\x20nicht');return![];}else return console['log']('Seite\x20existiert'),!![];}async function likeFirstPost(_0x1968b3){try{const _0x63a886=await _0x1968b3['$$'](K_BEITRAG_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Posts\x20gefunden:\x20'+_0x63a886['length']);if(_0x63a886&&_0x63a886['length']>0x0){const _0x1933bf=_0x63a886[0x0];await _0x1933bf['click'](),await delay(0xaf0,0xbb8);const _0x5a207a=await _0x1968b3['evaluate'](()=>{const _0xfcbe5=document['querySelector']('section\x20>\x20span\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20svg[aria-label=\x22Like\x22]');return!!_0xfcbe5;});if(_0x5a207a){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus');const _0x230786=await _0x1968b3['$$'](K_BEITRAG_LIKE_BUTTON),_0x52a91d=_0x230786[0x0];await delay(0x514,0x5dc),await _0x1968b3['evaluate'](_0x17b7e8=>{_0x17b7e8['click']();},_0x52a91d);}else console['log']('Beitrag\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x1968b3['goBack'](),await delay(0x7d0,0x898);}}catch(_0x3a0bbc){console['log']('Fehler\x20beim\x20Liken\x20des\x20ersten\x20Posts:',_0x3a0bbc);throw new Error('Like_Posts:\x20'+_0x3a0bbc);}}async function likeFirstStory(_0x993297){try{const _0xb813dd=await _0x993297['$$'](K_STORY_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Stories\x20gefunden:\x20'+_0xb813dd['length']);if(_0xb813dd&&_0xb813dd['length']>0x0){const _0x305f43=_0xb813dd[0x0];await _0x305f43['click'](),await delay(0xaf0,0xbb8);const _0x50198c=await _0x993297['evaluate'](()=>{const _0x1ab771=document['querySelector']('[aria-label=\x22Like\x22]');return!!_0x1ab771;});if(_0x50198c){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus'),await delay(0x514,0x5dc);try{const _0x30dc28=await _0x993297['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0x993297['click'](_0x30dc28);}catch(_0x111e85){console['log']('Direkter\x20Klick\x20fehlgeschlagen,\x20versuche\x20alternative\x20Methoden:',_0x111e85);try{const _0x1e53aa=await _0x993297['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0x993297['evaluateHandle'](_0x2a0a53=>{_0x2a0a53['click']();},_0x1e53aa);}catch(_0x58b549){console['log']('Evaluatehandle\x20fehlgeschlagen,\x20versuche\x20JS-Click:',_0x58b549),await _0x993297['evaluate'](()=>{const _0x7f2ca6=document['querySelector']('[aria-label=\x22Like\x22]');if(_0x7f2ca6)_0x7f2ca6['click']();else throw new Error('Element\x20nicht\x20gefunden');});}}}else console['log']('Story\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x993297['goBack'](),await delay(0x7d0,0x898);}}catch(_0x367be0){console['log']('Fehler\x20beim\x20Liken\x20der\x20ersten\x20Story:',_0x367be0);throw new Error('Like_Storys:\x20'+_0x367be0);}}async function send_message(_0xb6cf23,_0x1b2d4f,_0x34682e,_0x365ad6,_0x2c3a58,_0x347117,_0x404b80,_0xc50903,_0x45d054,_0x5ca61e,_0x300a32){return new Promise(async(_0x51ecd0,_0x2eea31)=>{_0x347117=_0x347117['split'](';'),console['log'](_0x347117[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x2c3a58);if(_0x365ad6===null||_0x365ad6===undefined){console['log']('Nachricht\x20ist\x20null\x20oder\x20undefined'),_0x2eea31('Nachricht\x20darf\x20nicht\x20leer\x20sein');return;}try{await setCookiesForUser(_0xb6cf23,_0x347117[0x0]);}catch(_0x110be5){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x110be5),_0x51ecd0({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x110be5});return;}await delay(0x6a4,0x7d0);try{await _0xb6cf23['goto']('https://www.instagram.com/'+_0x1b2d4f+'/'),await delay(0x1b58,0x1d4c),await notificationClear(_0xb6cf23);}catch(_0x94aafd){_0x51ecd0({'status':0x1f5,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x94aafd});return;}try{await checkLoginStatus(_0xb6cf23);}catch(_0x2f55ed){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x2f55ed),_0x2eea31('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return;}if(_0x45d054==0x1)try{await likeFirstPost(_0xb6cf23);}catch(_0x124e51){_0x2eea31(_0x124e51);}if(_0x5ca61e==0x1)try{await likeFirstStory(_0xb6cf23);}catch(_0x250cb0){_0x2eea31(_0x250cb0);}console['log']('UserSkip:\x20'+_0x404b80);if(_0x404b80==0x1)try{const _0x4f89fe=await _0xb6cf23['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x5ea4e1=>_0x5ea4e1['textContent']['trim']());console['log'](_0x4f89fe);if(_0x4f89fe==='Following'||_0x4f89fe==='Folge\x20ich')return _0x51ecd0({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x4728d1){}try{const _0x24a3cd=await waitForSelectorWithFallbacks(_0xb6cf23,K_DIRECT_MSG_BUTTON);await _0x24a3cd['click'](),await delay(0x6a4,0x7d0);try{const _0x500dca=await waitForSelectorWithFallbacks(_0xb6cf23,K_EXPAND_MSG_BUTTON);await _0x500dca['click']();}catch(_0x40115a){console['log']('Expand-Button\x20nicht\x20gefunden.\x20Überspringen:\x20'+_0x40115a);}}catch(_0x2d0986){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x2d0986);try{await delay(0x6a4,0x7d0);try{const _0x1a375c=await waitForSelectorWithFallbacks(_0xb6cf23,K_OPTIONS_BUTTON);await _0x1a375c['click']();}catch(_0x386dea){console['log']('Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x386dea),_0x51ecd0({'status':0x1f6,'message':'Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x386dea});return;}await delay(0x3e8,0x44c);const _0x37611f=await waitForXPath(_0xb6cf23,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x37611f['click']();}catch(_0x253612){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x253612),_0x51ecd0({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x708,0x7d0),await notificationClear(_0xb6cf23);}catch(_0x323311){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x323311);}try{await delay(0x708,0x7d0);const _0x34e6b6=await waitForSelectorWithFallbacks(_0xb6cf23,K_CHAT_INPUT_FIELD,{'visible':!![],'timeout':0x3a98});if(_0xc50903){const _0x1c2534=await _0xb6cf23['$'](K_ALREADY_CHATTED);if(_0x1c2534)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x1b2d4f),_0x51ecd0({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x171f87=await _0xb6cf23['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x171f87),_0x365ad6=_0x365ad6['replace']('{USERNAME}',_0x1b2d4f);let _0x3218c2;if(_0x365ad6['includes']('{NAME}')||_0x365ad6['includes']('{name}'))try{const _0x1c4fd0=await extractFirstName(_0x171f87,_0x300a32);console['log']('Response\x20Clearname\x20valid:\x20'+_0x1c4fd0['valid']),_0x1c4fd0['valid']?(_0x365ad6=_0x365ad6['replaceAll'](/{NAME}|{name}/g,_0x1c4fd0['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x1c4fd0['name']),_0x3218c2=_0x1c4fd0['name']):(_0x365ad6=_0x365ad6['replaceAll'](/ ?({NAME}|{name})/g,''),_0x3218c2='UNKNOWN_NAME');}catch(_0x30b6aa){console['log'](_0x30b6aa['message']),_0x3218c2=_0x30b6aa['message'];const _0x4e01df=_0x171f87?_0x171f87['replace'](/[^\p{L}\s]/gu,''):'',_0x2ffb88=_0x4e01df['split']('\x20')[0x0]||'';_0x2ffb88['length']>0x2&&!_0x2ffb88['includes']('Instagram')?_0x365ad6=_0x365ad6['replaceAll'](/{NAME}|{name}/g,_0x2ffb88):_0x365ad6=_0x365ad6['replaceAll'](/ ?({NAME}|{name})/g,'');}console['log']('Nachricht\x20vor\x20dem\x20Senden:\x20'+_0x365ad6);const _0x56758e=_0x365ad6['split']('\x0a');await _0x34e6b6['type'](_0x56758e[0x0],{'delay':getRnd(0x50,0x78)});for(let _0x484412=0x1;_0x484412<_0x56758e['length'];_0x484412++){await _0xb6cf23['keyboard']['down']('Shift'),await _0xb6cf23['keyboard']['press']('Enter'),await _0xb6cf23['keyboard']['up']('Shift'),await delay(0x64,0xc8),_0x56758e[_0x484412]['length']>0x0&&await _0x34e6b6['type'](_0x56758e[_0x484412],{'delay':getRnd(0x50,0x78)});}console['log']('Nachricht\x20mit\x20Zeilenumbrüchen\x20gesendet'),await delay(0x320,0x3e8);try{const _0x8503e6=await waitForSelectorWithFallbacks(_0xb6cf23,K_SEND_MSG_BUTTON);await _0x8503e6['click']();}catch(_0x56e606){console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x56e606),_0x51ecd0({'status':0x195,'message':'Send\x20nicht\x20gefunden.\x20Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x1b2d4f+'\x20überspringen.','error':_0x56e606['message']});}await delay(0x320,0x3e8),_0x51ecd0({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x171f87,'extracted_clearname':_0x3218c2});}catch(_0x407f44){let _0x2a67d6=_0x407f44;console['log']('Fehler\x20beim\x20Senden\x20der\x20Nachricht:\x20'+_0x2a67d6),_0x51ecd0({'status':0x1f4,'message':'Error\x20500:\x20'+_0x2a67d6});}});}function handle_fail(_0x1fed3a){if(isStopping)return new Promise(_0x28d370=>{_0x28d370('Scraper\x20gestoppt.');});else{let _0x2ec4e5='';switch(_0x1fed3a){case 0x0:_0x2ec4e5='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x2ec4e5='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x2ec4e5='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x2ec4e5='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x123fe1,_0x28120a)=>{_0x28120a(_0x2ec4e5);});}}async function fetch_account_details(_0x180305,_0x3b4963,_0x484ddf,_0x28542b){try{await setCookiesForUser(_0x180305,_0x484ddf['username']);}catch(_0x22f3ff){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x22f3ff);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x22f3ff);return handle_fail(0x0);}_0x180305['setDefaultNavigationTimeout'](0x7530),await _0x180305['goto']('https://www.instagram.com/'+_0x3b4963+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x180305);const _0x279350=await _0x180305['evaluate'](()=>{const _0x2c2558=document['querySelector']('meta[property=\x22og:image\x22]');return _0x2c2558?_0x2c2558['getAttribute']('content'):null;});await _0x180305['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x57ed0b=await _0x180305['evaluate'](()=>{const _0xbb6be4=document['querySelector']('meta[name=\x22description\x22]');if(!_0xbb6be4)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x168037=_0xbb6be4['getAttribute']('content');if(!_0x168037)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x168037);const _0x480996=/\s*[–-]\s*/,_0x1c60a4=_0x168037['split'](_0x480996);if(_0x1c60a4['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x3391bd=_0x1c60a4[0x0],_0x5c009a=_0x1c60a4[0x1],_0x17aaa8=_0x3391bd['split'](',\x20');if(_0x17aaa8['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x2e8dfd=_0x17aaa8[0x0]['split']('\x20')[0x0],_0x558413=_0x17aaa8[0x1]['split']('\x20')[0x0],_0x5c69e2=_0x17aaa8[0x2]['split']('\x20')[0x0];let _0x47ec1e='',_0x56dcf6='';const _0x4d21ec='\x20on\x20Instagram:\x20',_0x4fefe3=_0x5c009a['split'](_0x4d21ec);return _0x47ec1e=_0x4fefe3[0x0]['trim'](),_0x47ec1e=_0x47ec1e['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x4fefe3['length']>0x1&&(_0x56dcf6=_0x4fefe3[0x1]['trim'](),_0x56dcf6['startsWith']('\x22')&&_0x56dcf6['endsWith']('\x22')&&(_0x56dcf6=_0x56dcf6['substring'](0x1,_0x56dcf6['length']-0x1)['trim']()),_0x56dcf6=_0x56dcf6['replace'](/&quot;/g,'')['trim']()),{'followers':_0x2e8dfd,'following':_0x558413,'posts':_0x5c69e2,'nameText':_0x47ec1e,'bio':_0x56dcf6};});console['log']('Extracted\x20profile\x20data:',_0x57ed0b);const _0x14d0e0=_0x57ed0b['nameText'],_0x37917b=_0x279350,_0x59e3a0=_0x57ed0b['bio'],_0x1fa4ae=_0x57ed0b['followers'],_0x232706=_0x57ed0b['following'],_0xe8e526=_0x57ed0b['posts'],_0x5745fd=![],_0x5b0536=![],_0x486930=![],_0x1cc1bb='\x0a\x20\x20INSERT\x20INTO\x20'+_0x28542b+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x1cc1bb,[_0x3b4963,_0x14d0e0,_0x37917b,_0x59e3a0,_0x1fa4ae,_0x232706,_0xe8e526,_0x5745fd,_0x5b0536,_0x486930],function(_0x583330){_0x583330?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x583330['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x45f7a9,_0x4d5113,_0x2061a8,_0x5e19cc,_0x385b53,_0x145672,_0x2e0030,_0x23871b){let _0xfd10a1=0x4,_0x24c0d6=0x0,_0x4e930d=0x0;try{await setCookiesForUser(_0x4d5113,_0x145672['username']);}catch(_0x247bb2){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x247bb2);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x247bb2);return handle_fail(0x0);}let _0x347603=0x0;try{await _0x4d5113['goto']('https://www.instagram.com/'+_0x2061a8+'/'),await notificationClear(_0x4d5113);try{await checkLoginStatus(_0x4d5113);}catch(_0x59336a){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x59336a);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x4d5113);}catch(_0x5de56b){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x5de56b);throw new Error('Username\x20nicht\x20gefunden.\x20Existiert\x20der\x20Account?');}try{if(_0x5e19cc<=0x0){const _0x117bb9=await _0x4d5113['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0xd3aece=await _0x4d5113['evaluate'](_0x325968=>_0x325968['innerHTML'],_0x117bb9);_0x347603=Math['ceil'](_0xd3aece/0x4);}else _0x347603=Math['ceil'](_0x5e19cc/0x4);_0xfd10a1+=_0x347603,_0x4e930d=Math['round'](++_0x24c0d6/_0xfd10a1*0x64),_0x45f7a9['sender']['send']('fetch-progress',_0x4e930d,!![]);let _0x4951df=await _0x4d5113['waitForSelector']('a[href=\x22/'+_0x2061a8+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x4951df['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x2061a8+'\x20gesichtet'),_0x4e930d=Math['round'](++_0x24c0d6/_0xfd10a1*0x64),_0x45f7a9['sender']['send']('fetch-progress',_0x4e930d,!![]);}catch(_0x5b5c2c){console['log']('Follower\x20Liste\x20von\x20'+_0x2061a8+'\x20nicht\x20gefunden:'+_0x5b5c2c);throw new Error('Follower\x20Liste\x20von\x20'+_0x2061a8+'\x20nicht\x20gefunden:'+_0x5b5c2c);return handle_fail(0x0);}}catch(_0x3ea759){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x3ea759);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x3ea759);return handle_fail(0x0);}try{await delay(0x12c0,0x1388),console['log']('Auto-scrolls:\x20'+_0x347603);try{await scroll(_0x4d5113,FOLLOWER_FENSTER,_0x347603,_0x3d25dd=>{});}catch{console['log']('Fallback\x20div:has\x20ausgelöst'),await scroll(_0x4d5113,'div.x6nl9eh.x1a5l9x9.x7vuprf.x1mg3h75.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',_0x347603,_0x1a2a5f=>{});}_0x4e930d=Math['round'](++_0x24c0d6/_0xfd10a1*0x64),_0x45f7a9['sender']['send']('fetch-progress',_0x4e930d,!![]),await _0x4d5113['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x18a38b=await _0x4d5113['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0xb0a667=await _0x4d5113['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x4e930d=Math['round'](++_0x24c0d6/_0xfd10a1*0x64),_0x45f7a9['sender']['send']('fetch-progress',_0x4e930d,!![]);_0x5e19cc<=0x0&&(_0x5e19cc=_0x18a38b['length']);let _0x2fd0c2=[];for(let _0x5f1829=0x0;_0x5f1829<_0x18a38b['length']&&_0x5f1829<_0x5e19cc;_0x5f1829++){const _0x3b0c17=await _0x18a38b[_0x5f1829]['evaluate'](_0x62c4b8=>_0x62c4b8['textContent']),_0x5da0b9=await _0xb0a667[_0x5f1829]['evaluate'](_0x2cbf36=>_0x2cbf36['textContent']);if(_0x23871b){const _0xb80ee9=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x145672['username'],_0x3b0c17]);if(_0xb80ee9){console['log']('Skipping\x20already\x20contacted\x20follower:\x20'+_0x3b0c17);continue;}}_0x2fd0c2['push'](_0x3b0c17);const _0x12b9c1='INSERT\x20INTO\x20'+_0x385b53+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x12b9c1,[_0x3b0c17,_0x5da0b9],function(_0x432b3f){_0x432b3f?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x385b53+'\x27:',_0x432b3f['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x4e930d=Math['round'](++_0x24c0d6/_0xfd10a1*0x64),_0x45f7a9['sender']['send']('fetch-progress',_0x4e930d,!![]),_0x2e0030&&(_0x45f7a9['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x45f7a9,_0x4d5113,_0x145672,_0x385b53,_0x2fd0c2)),new Promise(_0x2b6184=>{_0x2b6184('Scraping\x20finished!');});}catch(_0x3af3ee){if(_0x2e0030)throw new Error(_0x3af3ee);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x2061a8+'\x20nicht\x20gefunden:\x20'+_0x3af3ee);return handle_fail(0x0);}}async function fetch_details_from_list(_0x4682a3,_0x4f7283,_0x4dcf2d,_0x198257,_0x4471e0){let _0x10673c=0x0,_0x83413c=0x0;for(let _0x4a9f51=0x0;_0x4a9f51<_0x4471e0['length'];_0x4a9f51++){console['log']('Processing\x20profile:',_0x4471e0[_0x4a9f51]);try{await fetch_account_details(_0x4f7283,_0x4471e0[_0x4a9f51],_0x4dcf2d,_0x198257);}catch(_0x2834ba){console['error']('Detailed\x20Scraping\x20von:\x20',_0x4471e0[_0x4a9f51],_0x2834ba);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x4471e0[_0x4a9f51]+'\x20'+_0x2834ba);}_0x83413c=Math['round'](++_0x10673c/_0x4471e0['length']*0x64),_0x4682a3['sender']['send']('fetch-progress',_0x83413c,!![],!![]);}}async function fetch_likers_from_post(_0x4f438b,_0x51d1fe,_0x21afae,_0xbc35f5,_0x593671,_0x19e7ab,_0x2e115d,_0x1101e2){let _0x35e246=0x4,_0x2211cb=0x0,_0x52c458=0x0;try{await setCookiesForUser(_0x51d1fe,_0x19e7ab['username']);}catch(_0x432f25){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x432f25);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x432f25);return handle_fail(0x1);}_0x52c458=Math['round'](++_0x2211cb/_0x35e246*0x64),_0x4f438b['sender']['send']('fetch-progress',_0x52c458,!![]);try{let _0x5dd707=_0x21afae['substring'](0x0,_0x21afae['lastIndexOf']('/'));_0x5dd707['includes']('/reel/')&&(_0x5dd707=_0x5dd707['replace']('/reel/','/p/'));let _0x70dbc=_0x5dd707+'/liked_by';console['log'](_0x70dbc),await _0x51d1fe['goto'](_0x70dbc),await delay(0x7d0,0xfa0),await notificationClear(_0x51d1fe),await delay(0xc8,0x1f4);try{await checkLoginStatus(_0x51d1fe);}catch(_0x24856c){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x24856c);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x51d1fe);}catch(_0x3e8a28){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x3e8a28);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}_0x52c458=Math['round'](++_0x2211cb/_0x35e246*0x64),_0x4f438b['sender']['send']('fetch-progress',_0x52c458,!![]),await _0x51d1fe['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x5ea759=await _0x51d1fe['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x48b22f=await _0x51d1fe['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x5ea759['length']);let _0xc4c28f=path['join'](__dirname,'/likers.csv');_0x52c458=Math['round'](++_0x2211cb/_0x35e246*0x64),_0x4f438b['sender']['send']('fetch-progress',_0x52c458,!![]);_0xbc35f5<=0x0&&(_0xbc35f5=_0x5ea759['length']);try{let _0x132da0=[];for(let _0x7c80d1=0x0;_0x7c80d1<_0x5ea759['length']&&_0x7c80d1<_0xbc35f5;_0x7c80d1++){const _0x224030=await _0x5ea759[_0x7c80d1]['evaluate'](_0x21605c=>_0x21605c['textContent']),_0x1ac563=await _0x48b22f[_0x7c80d1]['evaluate'](_0x360e68=>_0x360e68['textContent']);if(_0x1101e2){const _0x6a56b=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x19e7ab['username'],_0x224030]);if(_0x6a56b){console['log']('Skipping\x20already\x20contacted\x20liker:\x20'+_0x224030);continue;}}_0x132da0['push'](_0x224030);const _0xb7d7aa='INSERT\x20INTO\x20'+_0x593671+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0xb7d7aa,[_0x224030,_0x1ac563],function(_0x3d2cf2){_0x3d2cf2?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x593671+'\x27:',_0x3d2cf2['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x52c458=Math['round'](++_0x2211cb/_0x35e246*0x64),_0x4f438b['sender']['send']('fetch-progress',_0x52c458,!![]),_0x2e115d&&(_0x4f438b['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x4f438b,_0x51d1fe,_0x19e7ab,_0x593671,_0x132da0)),new Promise(_0x3780a6=>{_0x3780a6('Scraping\x20finished!');});}catch(_0x97e23e){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x97e23e);return handle_fail(0x1);}}catch(_0x29eec5){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x29eec5);throw new Error('Like-Seite\x20nicht\x20geöffnet:\x20'+_0x29eec5);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x20d7ef,_0x2e357b,_0x482a39,_0x1d0bef,_0x113ec2,_0x8d0d06,_0x3ad5cc,_0x198bdf){let _0x3c79a1=0x3,_0x4ab2b9=0x0,_0x691954=0x0;try{await setCookiesForUser(_0x2e357b,_0x8d0d06['username']);}catch(_0x20301b){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x20301b);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x20301b);return handle_fail(0x2);}try{console['log'](_0x482a39),await _0x2e357b['goto'](_0x482a39),await delay(0x7d0,0xfa0),await notificationClear(_0x2e357b),await delay(0xc8,0x1f4);const _0xbcd192=COM_COMMENTS_BOX_BODY_DIV;try{await checkLoginStatus(_0x2e357b);}catch(_0x1d53d8){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x1d53d8);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x2e357b);}catch(_0xa5c456){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0xa5c456);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}let _0x119f89;const _0xfba536=await _0x2e357b['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x4bfb5e=await _0x2e357b['evaluate'](_0x2ca74a=>_0x2ca74a['innerHTML'],_0xfba536),_0x3d3c4e=String(_0x4bfb5e)['replace'](/[^0-9]/g,''),_0x284129=Number(_0x3d3c4e)/0x14;_0x1d0bef<=0x0?_0x119f89=Math['ceil'](_0x284129/0x3):_0x119f89=Math['ceil'](_0x1d0bef/0x3);_0x3c79a1+=_0x119f89,_0x691954=Math['round'](++_0x4ab2b9/_0x3c79a1*0x64),_0x20d7ef['sender']['send']('fetch-progress',_0x691954,!![]),console['log']('Auto-scrolls:\x20'+_0x119f89),await scroll(_0x2e357b,_0xbcd192,_0x119f89,_0x18f07f=>{_0x691954=Math['round'](++_0x4ab2b9/_0x3c79a1*0x64),_0x20d7ef['sender']['send']('fetch-progress',_0x691954,!![]);});try{const _0x48e78f=COM_REPLY_BUTTON_SPAN,_0x501c52=await waitForXPathAll(_0x2e357b,_0x48e78f);console['log']('Reply-Buttons\x20gefunden:\x20ANZAHL:\x20'+_0x501c52['size']),await delay(0x1f4,0x320);let _0x1826a2=_0x501c52['size'],_0x5dbfa2=[];for(const [_0x14c3c8,_0x271dc0]of _0x501c52){_0x5dbfa2['push'](_0x271dc0);}console['log']('Alle\x20Reply-Buttons:',_0x5dbfa2['length']);try{for(let _0x3c2ab9=0x0;_0x3c2ab9<_0x1826a2;_0x3c2ab9++){await _0x5dbfa2[_0x3c2ab9]['click'](),await delay(0x320,0x5dc);}}catch(_0x246eb3){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x246eb3);throw new Error('Nicht\x20auf\x20Replies\x20geklickt:\x20'+_0x246eb3);return handle_fail(0x2);}}catch(_0x1e21b9){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x43e34e=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x2e357b['waitForSelector'](_0x43e34e),await delay(0x1f4,0x320),_0x691954=Math['round'](++_0x4ab2b9/_0x3c79a1*0x64),_0x20d7ef['sender']['send']('fetch-progress',_0x691954,!![]);const _0x355e76=await _0x2e357b['$$'](_0x43e34e);let _0x46d73a=path['join'](__dirname,'/comments.csv');_0x1d0bef<=0x0&&(_0x1d0bef=_0x355e76['length']);console['log']('fetch_limit:\x20'+_0x1d0bef),console['log']('comments_len:\x20'+_0x355e76['length']),_0x1d0bef++;try{let _0x4ba8b1=[];for(let _0xf47aa3=0x1;_0xf47aa3<_0x355e76['length']&&_0xf47aa3<_0x1d0bef;_0xf47aa3++){const _0x255c1c=await _0x355e76[_0xf47aa3]['evaluate'](_0x1e4896=>_0x1e4896['textContent']);if(_0x198bdf){const _0x16e2cf=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x8d0d06['username'],_0x255c1c]);if(_0x16e2cf){console['log']('Skipping\x20already\x20contacted\x20commenter:\x20'+_0x255c1c);continue;}}try{_0x4ba8b1['push'](_0x255c1c);const _0x2c39ee='INSERT\x20INTO\x20'+_0x113ec2+'\x20(username)\x20VALUES\x20(?)';db['run'](_0x2c39ee,[_0x255c1c],function(_0x3cdbd1){_0x3cdbd1&&console['log']('error\x20in\x20add-user:'+_0x3cdbd1);});}catch(_0x350826){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0xf47aa3+'\x20:\x20'+_0x350826);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0xf47aa3+'\x20:\x20'+_0x350826);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x691954=Math['round'](++_0x4ab2b9/_0x3c79a1*0x64),_0x20d7ef['sender']['send']('fetch-progress',_0x691954,!![]),_0x20d7ef['sender']['send']('fetch-progress',0x64,!![]),_0x3ad5cc&&(_0x20d7ef['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x20d7ef,_0x2e357b,_0x8d0d06,_0x113ec2,_0x4ba8b1)),_0x20d7ef['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x327dad=>{_0x327dad('Scraping\x20finished!');});}catch(_0x53eee0){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x53eee0);return handle_fail(0x2);}}catch(_0x30d449){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x30d449);throw new Error('Comments-Seite\x20nicht\x20geöffnet:\x20'+_0x30d449);return handle_fail(0x2);}}async function set_clearname_from_username(_0x155cdb,_0x5a89b1,_0x53102e=null){try{let _0x266895,_0x366c42;const _0x332266='SELECT\x20username\x20FROM\x20'+_0x5a89b1+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x332266,[],(_0x4e7210,_0x47afdf)=>{_0x4e7210&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x4e7210['message']),_0x47afdf['length']===0x0&&(_0x366c42=_0x47afdf['length']),_0x266895=_0x47afdf['map'](_0x599106=>_0x599106['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x366c42);if(_0x366c42===0x0){console['log']('Leave');return;}const _0x434bf0=await _0x155cdb['waitForSelector'](IG_SEARCH_BUTTON);await _0x434bf0['click'](),await delay(0x4b0,0x7d0);for(let _0x5716dc of _0x266895){const _0xb49243=await _0x155cdb['waitForSelector'](IG_SEARCH_INPUT);await _0xb49243['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x155cdb['type'](IG_SEARCH_INPUT,_0x5716dc,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x5b1765=0x1;while(_0x5b1765!=0x14){console['log']('Schleife');try{let _0x447cc2=IG_NAME_SPAN_PART1+_0x5b1765+IG_USERNAME_SPAN_PART2;const _0x2220a2=await _0x155cdb['waitForSelector'](_0x447cc2),_0x54d0c2=await _0x155cdb['evaluate'](_0x317968=>_0x317968['innerHTML'],_0x2220a2);await delay(0xc8,0x1f4);if(_0x54d0c2==_0x5716dc){let _0x1bfcc5=IG_NAME_SPAN_PART1+_0x5b1765+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x143ce4=await _0x155cdb['waitForSelector'](_0x1bfcc5);let _0x342a52=await _0x155cdb['evaluate'](_0x4ba800=>_0x4ba800['innerHTML'],_0x143ce4);const _0x157b35=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x243002=_0x342a52['match'](_0x157b35);_0x243002?_0x342a52=_0x243002[0x1]['trim']():_0x342a52=_0x342a52['trim']();_0x342a52['includes']('•')&&(_0x342a52=_0x342a52['substring'](0x0,_0x342a52['indexOf']('•')-0x1));const _0x55d2a7='UPDATE\x20'+_0x5a89b1+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x55d2a7,[_0x342a52,_0x54d0c2],function(_0x400fea){_0x400fea&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x400fea['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x5b1765++;}catch(_0x3dcbf0){const _0x55d1e9='UPDATE\x20'+_0x5a89b1+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x55d1e9,['',_0x5716dc],function(_0x51b5b7){_0x51b5b7&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x51b5b7['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x3dcbf0);break;}}_0x53102e&&_0x53102e();}await _0x434bf0['click']();}catch(_0x209d62){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x209d62);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likePost\x20\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likeStory\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likePost\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likeStory\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x590dfa,_0x45bc3a)=>{const _0x3008b7='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x3008b7,[],(_0x319f76,_0x5b5c12)=>{_0x319f76?_0x45bc3a(_0x319f76):_0x590dfa(_0x5b5c12);});});});const sqlGet=(_0x1b783d,_0x248ec0,_0x4f7080=[])=>new Promise((_0x25a0c3,_0x1e60ff)=>_0x1b783d['get'](_0x248ec0,_0x4f7080,(_0x2064ea,_0x1e6d64)=>_0x2064ea?_0x1e60ff(_0x2064ea):_0x25a0c3(_0x1e6d64))),sqlAll=(_0x3fe014,_0x2e052b,_0x531790=[])=>new Promise((_0x45fd1d,_0x469d88)=>_0x3fe014['all'](_0x2e052b,_0x531790,(_0xfa6e08,_0x58f91b)=>_0xfa6e08?_0x469d88(_0xfa6e08):_0x45fd1d(_0x58f91b)));ipcMain['handle']('get-campaign-details',async()=>{try{const _0x26b2b8=await sqlAll(campaignDB,'SELECT\x20campaign_name,\x20list_id,\x20zeitabstand,\x20account\x20FROM\x20campaign'),_0x174120=await Promise['all'](_0x26b2b8['map'](async _0x257bb9=>{const _0x339164=[];if(!_0x257bb9['list_id'])_0x339164['push']('Liste');if(!_0x257bb9['zeitabstand'])_0x339164['push']('Zeitabstand');if(!_0x257bb9['account'])_0x339164['push']('Instagram\x20Account');if(_0x257bb9['account'])try{const _0x5cf6a2=await sqlGet(igaccountsDB,'SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x257bb9['account']]);if(!_0x5cf6a2)_0x339164['push']('Instagram\x20Login\x20nicht\x20möglich');else{const _0x446077=_0x5cf6a2['cookie']&&_0x5cf6a2['cookie']['trim']()!==''&&_0x5cf6a2['cookie']['trim']()!=='[]';if(!_0x446077)_0x339164['push']('Instagram\x20Login');}}catch(_0x2998e2){console['error']('Account-Prüfung\x20SQL-Fehler:',_0x2998e2['message']),_0x339164['push']('Instagram\x20Account');}let _0x366f73='N/A',_0x36d55d='N/A';if(!_0x339164['includes']('Liste')){try{const _0x347f2d=await sqlGet(db,'SELECT\x20COUNT(*)\x20AS\x20lead_count\x20FROM\x20'+_0x257bb9['list_id']);_0x366f73=_0x347f2d?.['lead_count']??0x0;}catch(_0x2cc4d1){if(/no such table/i['test'](_0x2cc4d1['message']))_0x339164['push']('Liste\x20nicht\x20vorhanden');}try{const _0x33246a=await sqlGet(campaignDB,'SELECT\x20COUNT(*)\x20AS\x20contacted_count\x20FROM\x20dm\x20WHERE\x20list_id\x20=\x20?',[_0x257bb9['list_id']]);_0x36d55d=_0x33246a?.['contacted_count']??0x0;}catch(_0xd89d11){}}return{'campaign_name':_0x257bb9['campaign_name'],'lead_count':_0x366f73,'contacted_count':_0x36d55d,'status':_0x339164['length']===0x0?'Positiv':'Fehler:\x20'+_0x339164['join'](',\x20')};}));return{'status':'success','campaigns':_0x174120};}catch(_0xb3128d){return console['error']('get-campaign-details\x20fehlgeschlagen:',_0xb3128d['message']),{'status':'error','message':_0xb3128d['message']};}}),ipcMain['handle']('get-campaign-writer-information',async(_0x5215e9,_0x441423)=>{return new Promise((_0x9ea6d4,_0x276e54)=>{const _0x5ce807='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted,\x20likePost,\x20likeStory\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x5ce807,[_0x441423],(_0x4d7915,_0x5b61d3)=>{_0x4d7915?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x4d7915),_0x276e54(_0x4d7915)):(console['log']('ROWS'),console['log'](_0x5b61d3),debugDatabaseContents(),_0x9ea6d4(_0x5b61d3));});});});const showTableContents=_0x198608=>{return new Promise((_0x567849,_0x386982)=>{const _0x46f7c4='SELECT\x20*\x20FROM\x20'+_0x198608+';';campaignDB['all'](_0x46f7c4,(_0x28e592,_0x1b56d7)=>{_0x28e592?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x198608+':',_0x28e592),_0x386982(_0x28e592)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x198608+':',_0x1b56d7),_0x567849({'status':'success','message':_0x1b56d7}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x813d65){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x813d65);}}ipcMain['handle']('create-campaign',async(_0x1d0ca5,_0x38e763)=>{return new Promise((_0x18f6d2,_0x5b5c75)=>{const _0x2cef1d='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x2cef1d,[String(_0x38e763)],function(_0xc2116f){_0xc2116f?_0x5b5c75(_0xc2116f):_0x18f6d2({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x505af4,_0x5d399c)=>{return new Promise((_0x200322,_0x13f01a)=>{const _0x2be628='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x2be628,[_0x5d399c],function(_0x50df60){_0x50df60?_0x13f01a(_0x50df60):_0x200322({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x1cc04e,_0x3fe055,_0xd54eca,_0x4b8620,_0x1b0961,_0x1a1738,_0x595d19,_0x2915db,_0x1472e9,_0x294aab)=>{const _0x333b2b=await createMessageID(_0x1b0961);return new Promise((_0x86f2b6,_0x540419)=>{console['log']('ZEITABSTAND:\x20'+_0x4b8620);if(!_0x3fe055||!_0xd54eca||_0x4b8620===undefined||_0x4b8620===null||_0x4b8620===''||!_0x333b2b||!_0x1a1738)return _0x540419({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x333b2b);const _0x5df3e1='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?,\x20likePost\x20=\x20?,\x20likeStory\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x5df3e1,[_0xd54eca,_0x4b8620,_0x333b2b,_0x1a1738,_0x595d19,_0x2915db,_0x1472e9,_0x294aab,_0x3fe055],function(_0x39f9b2){if(_0x39f9b2)_0x540419({'status':'error','message':_0x39f9b2['message']});else this['changes']===0x0?_0x540419({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x86f2b6({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x37a04f,_0x24ed41,_0x19ed86,_0x2eea1a,_0x34a66f)=>{return new Promise((_0x2fdb1d,_0x463095)=>{const _0x3f16b5='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x3f16b5,[_0x24ed41,_0x19ed86,_0x2eea1a,_0x34a66f],function(_0x85bb3){return _0x85bb3?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x85bb3['message']),_0x463095('insert-dm-response',{'success':![],'message':_0x85bb3['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x2fdb1d('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x3c763c=>{return new Promise((_0x463a56,_0x312f43)=>{const _0x6d8d68='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x6d8d68,[_0x3c763c],(_0x898c85,_0x161cf9)=>{if(_0x898c85)_0x312f43({'status':'error','message':_0x898c85['message']});else{if(_0x161cf9)_0x463a56(_0x161cf9['message_id']);else{const _0x31b0cc='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x31b0cc,[_0x3c763c],function(_0x2c07b9){_0x2c07b9?_0x312f43({'status':'error','message':_0x2c07b9['message']}):_0x463a56(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x5b4665,_0x2a0fc1)=>{return new Promise((_0xbfdc09,_0x48d168)=>{const _0x58b970='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x2a0fc1;db['get'](_0x58b970,(_0x43da70,_0x509ea6)=>{_0x43da70?_0x48d168({'status':'error','message':_0x43da70['message']}):_0xbfdc09({'status':'success','count':_0x509ea6['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x59d97c,_0x11d307){try{const _0x43dadf=await new Promise((_0x411b7c,_0xdedbc)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x11d307],(_0x11bbbd,_0x2081e3)=>{if(_0x11bbbd)_0xdedbc(_0x11bbbd);else{if(_0x2081e3['length']>0x0){let _0x4dd005=JSON['parse'](_0x2081e3[0x0]['cookie']);console['log'](_0x4dd005),_0x411b7c(_0x4dd005);}else _0xdedbc(new Error('User\x20with\x20username\x20'+_0x11d307+'\x20does\x20not\x20exist.'));}});});await _0x59d97c['setCookie'](..._0x43dadf),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x4ba736){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x4ba736);}}async function saveCookiesForUser(_0x1683c9,_0x3596ea){try{const _0x215fb3=await _0x1683c9['cookies']();if(!_0x215fb3||_0x215fb3['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x3596ea);const _0x802a6f=JSON['stringify'](_0x215fb3);if(_0x802a6f['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x3596ea);return new Promise((_0xaf9ba5,_0x479347)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x3596ea],(_0x121919,_0xf799ce)=>{if(_0x121919)return console['error']('Error\x20checking\x20user\x20existence:',_0x121919),_0x479347(_0x121919);if(_0xf799ce){const _0x429aa7=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x429aa7['run'](_0x802a6f,_0x3596ea,function(_0x4418af){return _0x4418af?(console['error']('Error\x20updating\x20cookies:',_0x4418af),_0x479347(_0x4418af)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x3596ea),_0xaf9ba5());});}else{const _0x5a77ae=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x5a77ae['run'](_0x3596ea,_0x802a6f,function(_0x3b5cee){return _0x3b5cee?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x3b5cee),_0x479347(_0x3b5cee)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x3596ea),_0xaf9ba5());});}});});}catch(_0x12b012){console['error']('Error\x20fetching\x20cookies:',_0x12b012);throw _0x12b012;}}async function createUserIfNotExists(_0x4b123f){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x4b123f],(_0x1462c8,_0x3e6566)=>{if(_0x1462c8){console['error']('Error\x20checking\x20user\x20existence:',_0x1462c8);throw _0x1462c8;}else{if(!_0x3e6566){const _0x2a015d=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x2a015d['run'](_0x4b123f,function(_0x2f7ab8){_0x2f7ab8?console['error']('Error\x20inserting\x20new\x20user:',_0x2f7ab8):console['log']('New\x20user\x20created:',_0x4b123f);});}else console['log']('User\x20already\x20exists:',_0x4b123f);}});}catch(_0x40be44){console['error']('Error\x20creating\x20user:',_0x40be44);throw _0x40be44;}}ipcMain['handle']('create-relation',async(_0x42ec87,_0x97e0da)=>{return new Promise((_0x439447,_0x4a5493)=>{const _0x407f3f='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x97e0da+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x407f3f,function(_0x76cdaf){_0x76cdaf?_0x4a5493(_0x76cdaf):_0x439447({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x1e7507,_0x2ab3c4)=>{return console['log']('droping\x20table'+_0x2ab3c4),new Promise((_0x14b0a8,_0x4d6152)=>{const _0xd48f78='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x2ab3c4;console['log']('droping\x20table'+_0x2ab3c4),db['run'](_0xd48f78,function(_0xd5ab57){_0xd5ab57?_0x4d6152(_0xd5ab57):_0x14b0a8({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x28dd6a=>{return new Promise((_0x57a47d,_0x516fcd)=>{const _0x5d8f18='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x5d8f18,[],(_0xac95bf,_0x2bedc6)=>{_0xac95bf?_0x516fcd(_0xac95bf):_0x57a47d(_0x2bedc6['map'](_0x292e1c=>_0x292e1c['name']));});});}),ipcMain['handle']('add-user',async(_0x132a8a,_0xac0858,_0x4fa995)=>{return new Promise(_0x3d2dd7=>{const _0x439057=db['prepare']('INSERT\x20INTO\x20'+_0x4fa995+'\x20(username)\x20VALUES\x20(?)');_0x439057['run'](_0xac0858,function(_0x455d64){_0x455d64?console['log']('error\x20in\x20add-user:'+_0x455d64):_0x3d2dd7({'status':'success','id':this['lastID']});}),_0x439057['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x475c34,_0x53c71a)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x519ca4,_0x20f7e0)=>{if(_0x519ca4)_0x53c71a(_0x519ca4);else{_0x475c34({'status':'success','users':_0x20f7e0});for(_0x20f7e0 of _0x20f7e0){console['log'](_0x20f7e0['username']);}}});});}),ipcMain['handle']('get-data',async(_0x577931,_0x3596dc)=>{return new Promise((_0x14a44b,_0xae97cf)=>{const _0x4c37bc='SELECT\x20*\x20FROM\x20'+_0x3596dc;console['log'](_0x4c37bc),db['all'](_0x4c37bc,[],(_0x5644af,_0x167447)=>{_0x5644af?_0xae97cf(_0x5644af):_0x14a44b(_0x167447);});});}),ipcMain['handle']('get-accounts',async _0x726ea9=>{return new Promise((_0x58a807,_0x38516f)=>{const _0x409271='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x409271),igaccountsDB['all'](_0x409271,[],(_0x8ea85c,_0x57a1f1)=>{_0x8ea85c?_0x38516f(_0x8ea85c):_0x58a807(_0x57a1f1);});});}),ipcMain['handle']('get-targets',async(_0xaf1184,_0x135507)=>{return getTargetProfiles(_0x135507);}),ipcMain['handle']('delete-user',async(_0x12665d,_0x837d5a,_0x2f819c)=>{return new Promise((_0x5db5ae,_0x5be40f)=>{const _0x3bcf38=db['prepare']('DELETE\x20FROM\x20'+_0x2f819c+'\x20WHERE\x20username\x20=\x20?');_0x3bcf38['run'](_0x837d5a,function(_0x3bb757){_0x3bb757?_0x5be40f(_0x3bb757):_0x5db5ae({'status':'success','changes':this['changes']});}),_0x3bcf38['finalize']();});}),ipcMain['handle']('delete-account',async(_0x60d8e1,_0x4aacdd)=>{const _0x37489d=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x37489d['run'](_0x4aacdd,function(_0x5e95b9){_0x5e95b9&&console['log'](_0x5e95b9);}),_0x37489d['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x1ad680,_0x3178f9)=>{const _0xd55283='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0xd55283,[],(_0x2c381d,_0x223f51)=>{_0x2c381d?_0x3178f9({'status':'error','message':_0x2c381d['message']}):_0x1ad680({'status':'success','contactedCount':_0x223f51['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x735b8d,_0x2436bc)=>{const _0x45f364='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x45f364,[],(_0x5e27a7,_0x1a25ef)=>{_0x5e27a7?_0x2436bc({'status':'error','message':_0x5e27a7['message']}):_0x735b8d({'status':'success','contactedCount':_0x1a25ef['contactedCount']});});});});function exportDatabase(_0x276bf9){return new Promise((_0x525d91,_0x1f9671)=>{const _0x411f5c='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x276bf9+'\x0a\x20\x20\x20\x20';db['all'](_0x411f5c,[],async(_0x53b3b7,_0x32a22b)=>{if(_0x53b3b7){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x53b3b7['message']),_0x1f9671(_0x53b3b7);return;}if(!_0x32a22b||_0x32a22b['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x525d91();return;}const _0x3bec91=XLSX['utils']['json_to_sheet'](_0x32a22b),_0x2a5de4=XLSX['utils']['sheet_to_csv'](_0x3bec91);try{const {canceled:_0x500b25,filePath:_0x1276e1}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x276bf9+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x500b25||!_0x1276e1){console['log']('Speichern\x20abgebrochen.'),_0x525d91();return;}fs['writeFile'](_0x1276e1,_0x2a5de4,'utf8',_0x4b0de6=>{_0x4b0de6?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x4b0de6['message']),_0x1f9671(_0x4b0de6)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x1276e1),_0x525d91());});}catch(_0x44e591){console['error']('Fehler\x20im\x20Speicherdialog:',_0x44e591),_0x1f9671(_0x44e591);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x30a4a4,_0x5a8ae4)=>{shell['openExternal'](_0x5a8ae4);});