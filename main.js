const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');async function extractFirstName(_0x5415b1,_0x5077cd){try{const _0x390dbe=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x5077cd},'body':JSON['stringify']({'clearname':_0x5415b1})});if(!_0x390dbe['ok']){const _0x515462=await _0x390dbe['text']();throw new Error(_0x390dbe['status']+':\x20'+_0x515462);}const _0x50d56b=await _0x390dbe['json']();return _0x50d56b;}catch(_0x3d5ffa){console['error']('Error\x20in\x20extractFirstName:',_0x3d5ffa);throw _0x3d5ffa;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div:has(>\x20div[style=\x22height:\x20auto;\x20overflow:\x20hidden\x20auto;\x22])',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='[style=\x22line-height:\x2018px;\x22]',COM_COMMENTS_BOX_BODY_DIV='div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='//span[contains(.,\x20\x27View\x20all\x27)\x20and\x20contains(.,\x20\x27replies\x27)]',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Message\x27]','div.x9f619.xjbqb8w.x78zum5.x15mokao.x1ga7v0g.x16uus16.xbiv7yw.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div','div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div'],K_OPTIONS_BUTTON=['[aria-label=\x22Options\x22]','section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.x1jfgfrl\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div'],K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD=['[aria-label=\x22Message\x22]','div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f'],K_SEND_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Send\x27]','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_ALREADY_CHATTED='[aria-label=\x22Double\x20tap\x20to\x20like\x22]',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x5052c4=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x5052c4['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x5052c4['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x553274){var _0x2b1d2a=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x40aa4c){console['log']('window\x20id:'+_0x40aa4c['id']),_0x40aa4c['id']>0x1&&(_0x2b1d2a=!![]);}),console['log']('child\x20opened\x20='+_0x2b1d2a);if(!_0x2b1d2a){const _0xeb9c79=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0xeb9c79['loadFile'](_0x553274['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x325b6c=require('fs'),_0x4fb9cb=path['join'](app['getPath']('userData'),'data'),_0x583b3c=['campaign.db','crm.db','igaccounts.db'],_0x38d1af=[];try{_0x325b6c['mkdirSync'](_0x4fb9cb,{'recursive':!![]});for(const _0x553d79 of _0x583b3c){const _0x52e73a=path['join'](process['resourcesPath'],'app','build','data',_0x553d79),_0x3de97d=path['join'](_0x4fb9cb,_0x553d79);!_0x325b6c['existsSync'](_0x3de97d)?(_0x325b6c['copyFileSync'](_0x52e73a,_0x3de97d),console['log']('[InitDB]\x20Kopiert\x20'+_0x553d79+'\x20nach:\x20'+_0x3de97d)):console['log']('[InitDB]\x20'+_0x553d79+'\x20existiert\x20bereits:\x20'+_0x3de97d),_0x38d1af['push'](_0x3de97d);}}catch(_0x50f181){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x50f181);}return _0x38d1af;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x45ef7a,AppUpdate:_0x376b64}=require('electron-updater');_0x45ef7a['autoDownload']=![],_0x45ef7a['autoInstallOnAppQuit']=!![],_0x45ef7a['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x45ef7a['on']('update-available',_0x719dc3=>{console['log']('Update\x20verfügbar:',_0x719dc3),_0x45ef7a['downloadUpdate']();}),_0x45ef7a['on']('update-downloaded',_0x209e36=>{console['log']('Update\x20heruntergeladen:',_0x209e36),_0x45ef7a['quitAndInstall']();}),_0x45ef7a['on']('error',_0xc1c1a3=>{console['error']('Fehler\x20beim\x20Updaten:',_0xc1c1a3);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x4b7802,AppUpdate:_0x38ab60}=require('electron-updater');_0x4b7802['autoDownload']=![],_0x4b7802['autoInstallOnAppQuit']=!![],_0x4b7802['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x4b7802['on']('update-available',_0x328b1e=>{console['log']('Update\x20verfügbar:',_0x328b1e),_0x4b7802['downloadUpdate']();}),_0x4b7802['on']('update-downloaded',_0x209c8=>{console['log']('Update\x20heruntergeladen:',_0x209c8),console['log']('Neustarten\x20zum\x20Updaten');}),_0x4b7802['on']('error',_0x2f1210=>{console['error']('Fehler\x20beim\x20Updaten:',_0x2f1210);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x450f6f='',_0x5549b7=null;if(process['platform']==='darwin')_0x450f6f=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x450f6f=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x450f6f}),_0x5549b7=await browser_login['newPage'](),_0x5549b7['setDefaultNavigationTimeout'](0x1d4c),_0x5549b7['setDefaultTimeout'](0x1d4c),await _0x5549b7['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x5549b7;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x174b80=0x1,_0x5b985f=0x0){try{let _0x108071='',_0x11872b=null;const _0x5a4ab9=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x108071=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x108071=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x174b80===0x0&&!pageStack[_0x5b985f])return browser=await puppeteer['launch']({'headless':_0x5a4ab9,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x108071}),_0x11872b=await browser['newPage'](),_0x11872b['setDefaultNavigationTimeout'](0x1d4c),_0x11872b['setDefaultTimeout'](0x1d4c),await _0x11872b['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x5b985f]=_0x11872b,_0x11872b;return(browser===null||pageStack[_0x5b985f]===null||pageStack[_0x5b985f]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x5a4ab9,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x108071})),(pageStack[_0x5b985f]===null||pageStack[_0x5b985f]['isClosed']())&&(_0x11872b=await browser['newPage'](),_0x11872b['setDefaultNavigationTimeout'](0x1d4c),_0x11872b['setDefaultTimeout'](0x1d4c),await _0x11872b['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x5b985f]=_0x11872b),pageStack[_0x5b985f];}catch(_0x272184){console['error']('Failed\x20to\x20launch\x20browser:',_0x272184);const _0x59fd4b=new Error('Browser\x20konnte\x20nicht\x20gestartet\x20werden.\x20Bitte\x20starte\x20die\x20App\x20neu.\x20:\x20'+_0x272184);throw _0x59fd4b;}}ipcMain['on']('login',async(_0x11660a,_0x1a29e0)=>{const _0x12160c=await getBrowserPageLogin();await _0x12160c['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x12160c,_0x1a29e0),ipcMain['on']('setLoginCookies',async(_0x6bcab8,_0x4acb56)=>{try{await set_login_cookies(_0x12160c,_0x4acb56);}catch(_0x1f3d6c){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x1f3d6c);}});}),ipcMain['on']('export-relation',async(_0x3c17ee,_0x186fa7)=>{try{await exportDatabase(_0x186fa7),_0x3c17ee['reply']('export-relation-response',{'success':!![]});}catch(_0x1e6020){console['error'](_0x1e6020),_0x3c17ee['reply']('export-relation-response',{'success':![],'message':_0x1e6020['message']});}}),ipcMain['handle']('sendMessage',async(_0xc5fed7,_0x2cce94,_0x3707e6,_0x683c67,_0x3595bd,_0x2962cc,_0x4edd17,_0x805424,_0x598171,_0x687727,_0x9a1677)=>{isStopping=![];let _0x546a95=null;return _0x4edd17?_0x546a95=await getBrowserPage(_0x3595bd,_0x805424):_0x546a95=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x2cce94),send_message(_0x546a95,_0x2cce94,_0x3707e6,_0x683c67,_0x3595bd,_0x2962cc,_0x598171,_0x687727,_0x9a1677);}),ipcMain['handle']('stop-action',async(_0x8b44dd,_0x11ee9f)=>{isStopping=!![];const _0x303749=await getBrowserPage(0x1,_0x11ee9f);await _0x303749['close']();}),ipcMain['handle']('fetch_followers',async(_0xd8f177,_0x541b50,_0x4a15ce,_0xfe8f51,_0x1bf60c,_0x108126)=>{isStopping=![];const _0x56d861=await getBrowserPage();return fetch_followers_from_account(_0xd8f177,_0x56d861,_0x541b50,_0x4a15ce,_0xfe8f51,_0x1bf60c,_0x108126);}),ipcMain['handle']('get-account-details',async(_0x2ea8dc,_0x5ee5a0,_0x45e058,_0x489fec)=>{isStopping=![];const _0x54abd9=await getBrowserPage();return fetch_account_details(_0x54abd9,_0x5ee5a0,_0x45e058,_0x489fec);}),ipcMain['handle']('fetch_likes',async(_0x3f6bd7,_0x22f7cb,_0x57c91a,_0x3399d4,_0x80d656,_0x5a3038)=>{isStopping=![];const _0x339e01=await getBrowserPage();return fetch_likers_from_post(_0x3f6bd7,_0x339e01,_0x22f7cb,_0x57c91a,_0x3399d4,_0x80d656,_0x5a3038);}),ipcMain['handle']('fetch_comments',async(_0x214777,_0x12be4b,_0x143f1f,_0x190981,_0x92c33d,_0x11d4c1)=>{isStopping=![];const _0x57d99e=await getBrowserPage();return fetch_comments_from_post(_0x214777,_0x57d99e,_0x12be4b,_0x143f1f,_0x190981,_0x92c33d,_0x11d4c1);});async function updateAppSilent(){const {spawn:_0x2ba588}=require('child_process'),_0x4a73a7=require('path'),_0x511e15=require('electron-log');return _0x511e15['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x4b92e9,_0x6555c4)=>{const {updateElectronApp:_0x4dbb2e,UpdateSourceType:_0x9cad49}=require('update-electron-app');_0x4dbb2e({'updateSource':{'type':_0x9cad49['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x511e15}),_0x4b92e9('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x4224ae,_0x1b2a80)=>{doFullElectronUpdateSilent(),_0x4224ae('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x22f1f0}=require('child_process'),_0x1f6e9b=require('path'),_0x231a6d=require('electron-log');return _0x231a6d['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x10427c,_0x326272)=>{const {updateElectronApp:_0x1e4fc1,UpdateSourceType:_0x3f2e08}=require('update-electron-app');_0x1e4fc1({'updateSource':{'type':_0x3f2e08['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x231a6d}),_0x10427c('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x4b31f3,_0x41ef16)=>{doFullElectronUpdate(),_0x4b31f3('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0xa0fe5c,_0x2f1043)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0xa0fe5c('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x29c7e0=path['join'](__dirname,'mac-updater-intern.sh'),_0x29eca7=spawn('/bin/bash',[_0x29c7e0],{'detached':!![],'stdio':'ignore'});_0x29eca7['unref'](),setTimeout(()=>{_0xa0fe5c('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0x2f1043(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0x44585f=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x4cee87,_0x5bb550)=>{console['log']('Update\x20Silent:\x20'+_0x5bb550);if(_0x5bb550){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0x1b2d1d,_0x24d6d3){return Math['random']()*(_0x24d6d3-_0x1b2d1d+0x1)+_0x1b2d1d;}function delay(_0x51b16c,_0x596109){let _0x400a90=getRnd(_0x51b16c,_0x596109);return new Promise(function(_0x38e922){setTimeout(_0x38e922,_0x400a90);});}async function scroll(_0x4333aa,_0x47f716,_0x295cff=0x2,_0xa6e9a5){const _0x4b1911=await _0x4333aa['waitForSelector'](_0x47f716);for(let _0xee5418=0x0;_0xee5418<_0x295cff;_0xee5418++){console['log']('Scrolling\x20'+_0xee5418),await _0x4333aa['evaluate'](_0x1d320f=>{const _0x1eac5b=document['querySelector'](_0x1d320f);_0x1eac5b&&_0x1eac5b['scrollBy'](0x0,0x190);},_0x47f716),await delay(0x320,0x5dc),_0xa6e9a5();}}async function saveCookies(_0x135158){let _0x5c2ffb=await _0x135158['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x5c2ffb,null,0x2));}async function notificationClear(_0x19e257){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xfa0,0x1388),await _0x19e257['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x19e257['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x4d4ea9){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x4d4ea9);}}async function getTargetProfiles(_0x7e7ae){return new Promise((_0x1b42f9,_0x26a4be)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x7e7ae,(_0x4a9ea3,_0x20a51b)=>{_0x4a9ea3?_0x26a4be(_0x4a9ea3):_0x1b42f9(_0x20a51b);});});}async function login_legacy(_0x4992b8,_0x58618e,_0xdc7072){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x4992b8,_0x58618e),await createUserIfNotExists(_0x58618e,_0xdc7072);}catch(_0x2b51d6){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x2b51d6);}try{await _0x4992b8['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x4992b8['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x4992b8['click']('button._a9--._ap36._a9_0');}catch(_0x54096a){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x4992b8['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x4992b8['type']('input[name=\x27username\x27]',_0x58618e,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x4992b8['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x4992b8['type']('input[name=\x27password\x27]',_0xdc7072,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x4992b8['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x4992b8['click']('button[type=\x27submit\x27]');}catch(_0x62db64){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x4992b8),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x4992b8,_0x58618e);}catch(_0x3abfe7){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x3abfe7);}}catch(_0x23d285){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x23d285);}}async function login(_0x46aa57,_0x4d4ae5){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x46aa57,_0x4d4ae5),await createUserIfNotExists(_0x4d4ae5);}catch(_0x907fb2){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x907fb2);}try{await _0x46aa57['goto']('https://www.instagram.com/accounts/login/');}catch(_0x28f1f8){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x28f1f8);}}async function set_login_cookies(_0x3abe72,_0x213074){try{await saveCookiesForUser(_0x3abe72,_0x213074);}catch(_0x2db904){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x2db904);}}async function waitForXPath(_0x5645d2,_0x440943,_0x133407={}){return await _0x5645d2['waitForFunction'](_0x11d034=>{return document['evaluate'](_0x11d034,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x133407,_0x440943),_0x5645d2['evaluateHandle'](_0x473c18=>document['evaluate'](_0x473c18,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x440943);}async function waitForSelectorWithFallbacks(_0x4a0a1c,_0x184dd3,_0x1cc535={}){!Array['isArray'](_0x184dd3)&&(_0x184dd3=[_0x184dd3]);for(let _0x56006a=0x0;_0x56006a<_0x184dd3['length'];_0x56006a++){const _0x1e5531=_0x184dd3[_0x56006a],_0x19716c=_0x1e5531['startsWith']('//')||_0x1e5531['startsWith']('(//');try{console['log']('Versuche\x20'+(_0x19716c?'XPath':'Selector')+'\x20'+(_0x56006a+0x1)+'/'+_0x184dd3['length']+':\x20'+_0x1e5531['substring'](0x0,0x32)+'...');const _0x45bba1=_0x56006a===0x0?_0x1cc535['timeout']||0x1388:0x7d0;let _0x36a5c8;if(_0x19716c){const _0x229c1f=await waitForXPath(_0x4a0a1c,_0x1e5531,{..._0x1cc535,'timeout':_0x45bba1});if(!_0x229c1f)throw new Error('XPath-Element\x20nicht\x20gefunden');_0x36a5c8=_0x229c1f;}else _0x36a5c8=await _0x4a0a1c['waitForSelector'](_0x1e5531,{..._0x1cc535,'timeout':_0x45bba1});return console['log']((_0x19716c?'XPath':'Selector')+'\x20'+(_0x56006a+0x1)+'\x20gefunden!'),_0x36a5c8;}catch(_0xcb3629){console['log']((_0x19716c?'XPath':'Selector')+'\x20'+(_0x56006a+0x1)+'\x20nicht\x20gefunden:\x20'+_0xcb3629['message']);if(_0x56006a===_0x184dd3['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x184dd3['length']+'\x20Selektoren/XPath\x20konnte\x20gefunden\x20werden:\x20'+_0xcb3629['message']);}}throw new Error('Keine\x20Selektoren/XPath\x20angegeben');}async function waitForXPathAll(_0x314805,_0x3b0bdc,_0x563abe={}){return await _0x314805['waitForFunction'](_0x2a3a0a=>{return document['evaluate'](_0x2a3a0a,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null)['snapshotLength']>0x0;},_0x563abe,_0x3b0bdc),_0x314805['evaluateHandle'](_0x56069e=>{const _0x1cb5df=document['evaluate'](_0x56069e,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null),_0xf3fef7=[];for(let _0x222380=0x0;_0x222380<_0x1cb5df['snapshotLength'];_0x222380++){_0xf3fef7['push'](_0x1cb5df['snapshotItem'](_0x222380));}return _0xf3fef7;},_0x3b0bdc)['then'](_0x2b6589=>_0x2b6589['getProperties']());}async function checkLoginStatus(_0x39e178){const _0x474312=['[type=\x22password\x22]','//a[normalize-space(text())=\x27Log\x20In\x27]','//div[@role=\x27button\x27\x20and\x20normalize-space(.)=\x27Log\x20in\x27]','//h3[normalize-space(text())=\x27Something\x20went\x20wrong\x27]'];let _0x147618=null;try{_0x147618=await waitForSelectorWithFallbacks(_0x39e178,_0x474312,{'timeout':0x7d0});}catch(_0x36ebc8){return console['log']('Eingeloggt,\x20kein\x20Login\x20notwendig:\x20'+_0x36ebc8),!![];}if(_0x147618){console['log']('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return![];}else return console['log']('Eingeloggt,\x20führe\x20keine\x20Login\x20durch'),!![];}async function send_message(_0x5e97f3,_0x22af1f,_0x319943,_0x597f33,_0x30afa9,_0x6d4dc1,_0x4e7f81,_0x1e8c39,_0x31e327){return new Promise(async(_0x4d1f4f,_0x196cbe)=>{_0x6d4dc1=_0x6d4dc1['split'](';'),console['log'](_0x6d4dc1[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x30afa9);try{await setCookiesForUser(_0x5e97f3,_0x6d4dc1[0x0]);}catch(_0x492ab0){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x492ab0),_0x4d1f4f({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x492ab0});return;}await delay(0x6a4,0x7d0);try{await _0x5e97f3['goto']('https://www.instagram.com/'+_0x22af1f+'/'),await delay(0x1b58,0x1d4c),await notificationClear(_0x5e97f3);}catch(_0x456a0f){_0x4d1f4f({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x456a0f});return;}try{await checkLoginStatus(_0x5e97f3);}catch(_0x44b0f1){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x44b0f1),_0x196cbe('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return;}console['log']('UserSkip:\x20'+_0x4e7f81);if(_0x4e7f81==0x1)try{const _0x34cc29=await _0x5e97f3['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x37b4cd=>_0x37b4cd['textContent']['trim']());console['log'](_0x34cc29);if(_0x34cc29==='Following'||_0x34cc29==='Folge\x20ich')return _0x4d1f4f({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x460789){}try{const _0x543f7f=await waitForSelectorWithFallbacks(_0x5e97f3,K_DIRECT_MSG_BUTTON);await _0x543f7f['click']();}catch(_0x1389bd){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x1389bd);try{try{const _0x3ecc36=await waitForSelectorWithFallbacks(_0x5e97f3,K_OPTIONS_BUTTON);await _0x3ecc36['click']();}catch(_0x480f14){console['log']('Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x480f14),_0x4d1f4f({'status':0x1f4,'message':'Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x480f14});return;}await delay(0x1f4,0x320);const _0x1ab1e5=await waitForXPath(_0x5e97f3,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x1ab1e5['click']();}catch(_0x3e0665){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x3e0665),_0x4d1f4f({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x5e97f3);}catch(_0x3c5667){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x3c5667);}try{const _0x1d654d=await waitForSelectorWithFallbacks(_0x5e97f3,K_CHAT_INPUT_FIELD);if(_0x1e8c39){const _0x2bf45d=await _0x5e97f3['$'](K_ALREADY_CHATTED);if(_0x2bf45d)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x22af1f),_0x4d1f4f({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x2e7ede=await _0x5e97f3['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x2e7ede),_0x597f33=_0x597f33['replace']('{USERNAME}',_0x22af1f);let _0x3877ff;if(_0x597f33['includes']('{NAME}')||_0x597f33['includes']('{name}'))try{const _0x14c49b=await extractFirstName(_0x2e7ede,_0x31e327);console['log']('Response\x20Clearname\x20valid:\x20'+_0x14c49b['valid']),_0x14c49b['valid']?(_0x597f33=_0x597f33['replaceAll'](/{NAME}|{name}/g,_0x14c49b['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x14c49b['name']),_0x3877ff=_0x14c49b['name']):(_0x597f33=_0x597f33['replaceAll'](/ ?({NAME}|{name})/g,''),_0x3877ff='UNKNOWN_NAME');}catch(_0x15cdcb){console['log'](_0x15cdcb['message']),_0x3877ff=_0x15cdcb['message'];let _0x29d47=_0x2e7ede['replace'](/[^\p{L}\s]/gu,''),_0x1e7847=_0x29d47['split']('\x20')[0x0];_0x1e7847['length']>0x2&&!_0x1e7847['includes']('Instagram')?_0x597f33=_0x597f33['replaceAll'](/{NAME}|{name}/g,_0x1e7847):_0x597f33=_0x597f33['replaceAll'](/ ?({NAME}|{name})/g,'');}console['log']('Nachricht\x20vor\x20dem\x20Senden:\x20'+_0x597f33);const _0x166ca8=_0x597f33['split']('\x0a');await _0x1d654d['type'](_0x166ca8[0x0],{'delay':getRnd(0x50,0x78)});for(let _0x317724=0x1;_0x317724<_0x166ca8['length'];_0x317724++){await _0x5e97f3['keyboard']['down']('Shift'),await _0x5e97f3['keyboard']['press']('Enter'),await _0x5e97f3['keyboard']['up']('Shift'),await delay(0x64,0xc8),_0x166ca8[_0x317724]['length']>0x0&&await _0x1d654d['type'](_0x166ca8[_0x317724],{'delay':getRnd(0x50,0x78)});}console['log']('Nachricht\x20mit\x20Zeilenumbrüchen\x20gesendet'),await delay(0x320,0x3e8);const _0xc14e49=await waitForSelectorWithFallbacks(_0x5e97f3,K_SEND_MSG_BUTTON);await _0xc14e49['click'](),await delay(0x320,0x3e8),_0x4d1f4f({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x2e7ede,'extracted_clearname':_0x3877ff});}catch(_0x5c9c9b){let _0x39a8ea=_0x5c9c9b;console['log']('Fehler\x20beim\x20Senden\x20der\x20Nachricht:\x20'+_0x39a8ea),_0x4d1f4f({'status':0x1f4,'message':'Error\x20500:\x20'+_0x39a8ea});}});}function handle_fail(_0x38128a){if(isStopping)return new Promise(_0x28fbc5=>{_0x28fbc5('Scraper\x20gestoppt.');});else{let _0x39722b='';switch(_0x38128a){case 0x0:_0x39722b='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x39722b='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x39722b='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x39722b='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x280cf5,_0x18221f)=>{_0x18221f(_0x39722b);});}}async function fetch_account_details(_0x2efd35,_0x303cdb,_0x43b262,_0x6d1371){try{await setCookiesForUser(_0x2efd35,_0x43b262['username']);}catch(_0x2f3d48){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2f3d48);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2f3d48);return handle_fail(0x0);}_0x2efd35['setDefaultNavigationTimeout'](0x7530),await _0x2efd35['goto']('https://www.instagram.com/'+_0x303cdb+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x2efd35);const _0x4e1df6=await _0x2efd35['evaluate'](()=>{const _0x525725=document['querySelector']('meta[property=\x22og:image\x22]');return _0x525725?_0x525725['getAttribute']('content'):null;});await _0x2efd35['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x178a52=await _0x2efd35['evaluate'](()=>{const _0xbc7fe3=document['querySelector']('meta[name=\x22description\x22]');if(!_0xbc7fe3)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0xdc2e1d=_0xbc7fe3['getAttribute']('content');if(!_0xdc2e1d)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0xdc2e1d);const _0x5d70e7=/\s*[–-]\s*/,_0x409062=_0xdc2e1d['split'](_0x5d70e7);if(_0x409062['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x3d312d=_0x409062[0x0],_0x110ade=_0x409062[0x1],_0x1ca44b=_0x3d312d['split'](',\x20');if(_0x1ca44b['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x586243=_0x1ca44b[0x0]['split']('\x20')[0x0],_0x557fa4=_0x1ca44b[0x1]['split']('\x20')[0x0],_0xa11b1=_0x1ca44b[0x2]['split']('\x20')[0x0];let _0x10de07='',_0x1eaf33='';const _0x1be704='\x20on\x20Instagram:\x20',_0x4e6bf7=_0x110ade['split'](_0x1be704);return _0x10de07=_0x4e6bf7[0x0]['trim'](),_0x10de07=_0x10de07['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x4e6bf7['length']>0x1&&(_0x1eaf33=_0x4e6bf7[0x1]['trim'](),_0x1eaf33['startsWith']('\x22')&&_0x1eaf33['endsWith']('\x22')&&(_0x1eaf33=_0x1eaf33['substring'](0x1,_0x1eaf33['length']-0x1)['trim']()),_0x1eaf33=_0x1eaf33['replace'](/&quot;/g,'')['trim']()),{'followers':_0x586243,'following':_0x557fa4,'posts':_0xa11b1,'nameText':_0x10de07,'bio':_0x1eaf33};});console['log']('Extracted\x20profile\x20data:',_0x178a52);const _0x3be811=_0x178a52['nameText'],_0x482915=_0x4e1df6,_0x7e2198=_0x178a52['bio'],_0x549db9=_0x178a52['followers'],_0xfbc9db=_0x178a52['following'],_0x1c947f=_0x178a52['posts'],_0x469cd3=![],_0x5d05f6=![],_0x578095=![],_0x1a4327='\x0a\x20\x20INSERT\x20INTO\x20'+_0x6d1371+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x1a4327,[_0x303cdb,_0x3be811,_0x482915,_0x7e2198,_0x549db9,_0xfbc9db,_0x1c947f,_0x469cd3,_0x5d05f6,_0x578095],function(_0x465e23){_0x465e23?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x465e23['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x9c32ed,_0x24ed1f,_0x5450a0,_0x57a787,_0x421660,_0x2dbcb8,_0x1f5e27){let _0x42f667=0x4,_0x2a2aa7=0x0,_0x449224=0x0;try{await setCookiesForUser(_0x24ed1f,_0x2dbcb8['username']);}catch(_0x550e6b){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x550e6b);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x550e6b);return handle_fail(0x0);}let _0xa49ce9=0x0;try{await _0x24ed1f['goto']('https://www.instagram.com/'+_0x5450a0+'/'),await notificationClear(_0x24ed1f);try{if(_0x57a787<=0x0){const _0x2d9487=await _0x24ed1f['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x525cf8=await _0x24ed1f['evaluate'](_0x4490bd=>_0x4490bd['innerHTML'],_0x2d9487);_0xa49ce9=Math['ceil'](_0x525cf8/0x4);}else _0xa49ce9=Math['ceil'](_0x57a787/0x4);_0x42f667+=_0xa49ce9,_0x449224=Math['round'](++_0x2a2aa7/_0x42f667*0x64),_0x9c32ed['sender']['send']('fetch-progress',_0x449224,!![]);let _0x401ddd=await _0x24ed1f['waitForSelector']('a[href=\x22/'+_0x5450a0+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x401ddd['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x5450a0+'\x20gesichtet'),_0x449224=Math['round'](++_0x2a2aa7/_0x42f667*0x64),_0x9c32ed['sender']['send']('fetch-progress',_0x449224,!![]);}catch(_0x22bfd9){console['log']('Follower\x20Liste\x20von\x20'+_0x5450a0+'\x20nicht\x20gefunden:'+_0x22bfd9);throw new Error('Follower\x20Liste\x20von\x20'+_0x5450a0+'\x20nicht\x20gefunden:'+_0x22bfd9);return handle_fail(0x0);}}catch(_0x150f7b){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x150f7b);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x150f7b);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0xa49ce9),await scroll(_0x24ed1f,FOLLOWER_FENSTER,_0xa49ce9,_0x307c02=>{_0x449224=Math['round'](++_0x2a2aa7/_0x42f667*0x64),_0x9c32ed['sender']['send']('fetch-progress',_0x449224,!![]);}),await _0x24ed1f['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x27d9ce=await _0x24ed1f['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x2ac435=await _0x24ed1f['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x449224=Math['round'](++_0x2a2aa7/_0x42f667*0x64),_0x9c32ed['sender']['send']('fetch-progress',_0x449224,!![]);_0x57a787<=0x0&&(_0x57a787=_0x27d9ce['length']);let _0x575648=[];for(let _0x2231bd=0x0;_0x2231bd<_0x27d9ce['length']&&_0x2231bd<_0x57a787;_0x2231bd++){_0x575648['push'](await _0x27d9ce[_0x2231bd]['evaluate'](_0x3be0ad=>_0x3be0ad['textContent']));const _0x33628a='INSERT\x20INTO\x20'+_0x421660+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x33628a,[await _0x27d9ce[_0x2231bd]['evaluate'](_0x38be3b=>_0x38be3b['textContent']),await _0x2ac435[_0x2231bd]['evaluate'](_0x2eb60e=>_0x2eb60e['textContent'])],function(_0x5b9b59){_0x5b9b59?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x421660+'\x27:',_0x5b9b59['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x449224=Math['round'](++_0x2a2aa7/_0x42f667*0x64),_0x9c32ed['sender']['send']('fetch-progress',_0x449224,!![]),_0x1f5e27&&(_0x9c32ed['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x9c32ed,_0x24ed1f,_0x2dbcb8,_0x421660,_0x575648)),new Promise(_0x2ba908=>{_0x2ba908('Scraping\x20finished!');});}catch(_0x5e5bf7){if(_0x1f5e27)throw new Error(_0x5e5bf7);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x5450a0+'\x20nicht\x20gefunden:\x20'+_0x5e5bf7);return handle_fail(0x0);}}async function fetch_details_from_list(_0x2041f7,_0x25b861,_0x537736,_0x3109e9,_0x20ac7a){let _0x26d4be=0x0,_0x57c934=0x0;for(let _0x6d589e=0x0;_0x6d589e<_0x20ac7a['length'];_0x6d589e++){console['log']('Processing\x20profile:',_0x20ac7a[_0x6d589e]);try{await fetch_account_details(_0x25b861,_0x20ac7a[_0x6d589e],_0x537736,_0x3109e9);}catch(_0xadb6e0){console['error']('Detailed\x20Scraping\x20von:\x20',_0x20ac7a[_0x6d589e],_0xadb6e0);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x20ac7a[_0x6d589e]+'\x20'+_0xadb6e0);}_0x57c934=Math['round'](++_0x26d4be/_0x20ac7a['length']*0x64),_0x2041f7['sender']['send']('fetch-progress',_0x57c934,!![],!![]);}}async function fetch_likers_from_post(_0x278826,_0x4a2762,_0x1d9a33,_0x3bcf8d,_0xcec1b,_0x2aa729,_0xe52eb7){let _0x4e6a5a=0x4,_0x4cb2aa=0x0,_0x57706d=0x0;try{await setCookiesForUser(_0x4a2762,_0x2aa729['username']);}catch(_0x9b8a08){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x9b8a08);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x9b8a08);return handle_fail(0x1);return;}_0x57706d=Math['round'](++_0x4cb2aa/_0x4e6a5a*0x64),_0x278826['sender']['send']('fetch-progress',_0x57706d,!![]);try{let _0x5a64fd=_0x1d9a33['substring'](0x0,_0x1d9a33['lastIndexOf']('/'));_0x5a64fd['includes']('/reel/')&&(_0x5a64fd=_0x5a64fd['replace']('/reel/','/p/'));let _0x4acb32=_0x5a64fd+'/liked_by';console['log'](_0x4acb32),await _0x4a2762['goto'](_0x4acb32),await delay(0x7d0,0xfa0),await notificationClear(_0x4a2762),await delay(0xc8,0x1f4),_0x57706d=Math['round'](++_0x4cb2aa/_0x4e6a5a*0x64),_0x278826['sender']['send']('fetch-progress',_0x57706d,!![]),await _0x4a2762['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x19e602=await _0x4a2762['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x52fb43=await _0x4a2762['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x19e602['length']);let _0x148e06=path['join'](__dirname,'/likers.csv');_0x57706d=Math['round'](++_0x4cb2aa/_0x4e6a5a*0x64),_0x278826['sender']['send']('fetch-progress',_0x57706d,!![]);_0x3bcf8d<=0x0&&(_0x3bcf8d=_0x19e602['length']);try{let _0x2110a3=[];for(let _0x2ca014=0x0;_0x2ca014<_0x19e602['length']&&_0x2ca014<_0x3bcf8d;_0x2ca014++){_0x2110a3['push'](await _0x19e602[_0x2ca014]['evaluate'](_0x3a5f34=>_0x3a5f34['textContent']));try{const _0x254c99='INSERT\x20INTO\x20'+_0xcec1b+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x254c99,[await _0x19e602[_0x2ca014]['evaluate'](_0x13d1c0=>_0x13d1c0['textContent']),await _0x52fb43[_0x2ca014]['evaluate'](_0x28d2bd=>_0x28d2bd['textContent'])],function(_0x181e15){_0x181e15?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0xcec1b+'\x27:',_0x181e15['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x297edc){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x2ca014+'\x20:\x20'+_0x297edc);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x2ca014+'\x20:\x20'+_0x297edc);return handle_fail(0x1);}}return _0x57706d=Math['round'](++_0x4cb2aa/_0x4e6a5a*0x64),_0x278826['sender']['send']('fetch-progress',_0x57706d,!![]),_0xe52eb7&&(_0x278826['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x278826,_0x4a2762,_0x2aa729,_0xcec1b,_0x2110a3)),new Promise(_0x4cf817=>{_0x4cf817('Scraping\x20finished!');});}catch(_0x2b9f83){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x2b9f83);return handle_fail(0x1);}}catch(_0x587350){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x587350);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x587350);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x54848b,_0x877f44,_0x2a65c5,_0x54ec55,_0x3b9d20,_0x426a4e,_0x20b5c0){let _0x407aa1=0x3,_0x2f3d32=0x0,_0x5c6da2=0x0;try{await setCookiesForUser(_0x877f44,_0x426a4e['username']);}catch(_0x35fe39){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x35fe39);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x35fe39);return handle_fail(0x2);}try{console['log'](_0x2a65c5),await _0x877f44['goto'](_0x2a65c5),await delay(0x7d0,0xfa0),await notificationClear(_0x877f44),await delay(0xc8,0x1f4);const _0x45a42b=COM_COMMENTS_BOX_BODY_DIV;let _0x2be4bf;const _0x18a746=await _0x877f44['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x53a5a2=await _0x877f44['evaluate'](_0x5c2885=>_0x5c2885['innerHTML'],_0x18a746),_0x36ce18=String(_0x53a5a2)['replace'](/[^0-9]/g,''),_0x17cbd4=Number(_0x36ce18)/0x14;_0x54ec55<=0x0?_0x2be4bf=Math['ceil'](_0x17cbd4/0x3):_0x2be4bf=Math['ceil'](_0x54ec55/0x3);_0x407aa1+=_0x2be4bf,_0x5c6da2=Math['round'](++_0x2f3d32/_0x407aa1*0x64),_0x54848b['sender']['send']('fetch-progress',_0x5c6da2,!![]),console['log']('Auto-scrolls:\x20'+_0x2be4bf),await scroll(_0x877f44,_0x45a42b,_0x2be4bf,_0x1cc93c=>{_0x5c6da2=Math['round'](++_0x2f3d32/_0x407aa1*0x64),_0x54848b['sender']['send']('fetch-progress',_0x5c6da2,!![]);});try{const _0xbdf80d=COM_REPLY_BUTTON_SPAN,_0xc99417=await waitForXPathAll(_0x877f44,_0xbdf80d);console['log']('Reply-Buttons\x20gefunden:\x20ANZAHL:\x20'+_0xc99417['size']),await delay(0x1f4,0x320);let _0x464d97=_0xc99417['size'],_0x533f9b=[];for(const [_0x628b5c,_0x6600b1]of _0xc99417){_0x533f9b['push'](_0x6600b1);}console['log']('Alle\x20Reply-Buttons:',_0x533f9b['length']);try{for(let _0x1fa185=0x0;_0x1fa185<_0x464d97;_0x1fa185++){await _0x533f9b[_0x1fa185]['click'](),await delay(0x320,0x5dc);}}catch(_0x24ed85){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x24ed85);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x24ed85);return handle_fail(0x2);}}catch(_0x17f07a){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x37bf11=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x877f44['waitForSelector'](_0x37bf11),await delay(0x1f4,0x320),_0x5c6da2=Math['round'](++_0x2f3d32/_0x407aa1*0x64),_0x54848b['sender']['send']('fetch-progress',_0x5c6da2,!![]);const _0x2ec9ef=await _0x877f44['$$'](_0x37bf11);let _0x598787=path['join'](__dirname,'/comments.csv');_0x54ec55<=0x0&&(_0x54ec55=_0x2ec9ef['length']);console['log']('fetch_limit:\x20'+_0x54ec55),console['log']('comments_len:\x20'+_0x2ec9ef['length']),_0x54ec55++;try{let _0x28a4de=[];for(let _0x46d6ce=0x1;_0x46d6ce<_0x2ec9ef['length']&&_0x46d6ce<_0x54ec55;_0x46d6ce++){try{_0x28a4de['push'](await _0x2ec9ef[_0x46d6ce]['evaluate'](_0x22a34e=>_0x22a34e['textContent']));const _0x2bcd6e=await db['prepare']('INSERT\x20INTO\x20'+_0x3b9d20+'\x20(username)\x20VALUES\x20(?)');await _0x2bcd6e['run'](await _0x2ec9ef[_0x46d6ce]['evaluate'](_0x47837b=>_0x47837b['textContent']),function(_0x31c16c){_0x31c16c&&console['log']('error\x20in\x20add-user:'+_0x31c16c);}),await _0x2bcd6e['finalize']();}catch(_0x1dc3a6){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x46d6ce+'\x20:\x20'+_0x1dc3a6);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x46d6ce+'\x20:\x20'+_0x1dc3a6);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x5c6da2=Math['round'](++_0x2f3d32/_0x407aa1*0x64),_0x54848b['sender']['send']('fetch-progress',_0x5c6da2,!![]),_0x54848b['sender']['send']('fetch-progress',0x64,!![]),_0x20b5c0&&(_0x54848b['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x54848b,_0x877f44,_0x426a4e,_0x3b9d20,_0x28a4de)),_0x54848b['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x538d17=>{_0x538d17('Scraping\x20finished!');});}catch(_0xbdc775){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0xbdc775);return handle_fail(0x2);}}catch(_0x362567){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x362567);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x362567);return handle_fail(0x2);}}async function set_clearname_from_username(_0x3a0144,_0x3b63c0,_0x59c18e=null){try{let _0x4f6758,_0x1d8d4e;const _0xd16fa7='SELECT\x20username\x20FROM\x20'+_0x3b63c0+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0xd16fa7,[],(_0x206121,_0x14dd35)=>{_0x206121&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x206121['message']),_0x14dd35['length']===0x0&&(_0x1d8d4e=_0x14dd35['length']),_0x4f6758=_0x14dd35['map'](_0x5b4163=>_0x5b4163['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x1d8d4e);if(_0x1d8d4e===0x0){console['log']('Leave');return;}const _0x2d4e86=await _0x3a0144['waitForSelector'](IG_SEARCH_BUTTON);await _0x2d4e86['click'](),await delay(0x4b0,0x7d0);for(let _0x8c71e0 of _0x4f6758){const _0x2b24b9=await _0x3a0144['waitForSelector'](IG_SEARCH_INPUT);await _0x2b24b9['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x3a0144['type'](IG_SEARCH_INPUT,_0x8c71e0,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x585dd8=0x1;while(_0x585dd8!=0x14){console['log']('Schleife');try{let _0x3cbeab=IG_NAME_SPAN_PART1+_0x585dd8+IG_USERNAME_SPAN_PART2;const _0x768e93=await _0x3a0144['waitForSelector'](_0x3cbeab),_0x1f7b20=await _0x3a0144['evaluate'](_0x362dc7=>_0x362dc7['innerHTML'],_0x768e93);await delay(0xc8,0x1f4);if(_0x1f7b20==_0x8c71e0){let _0x55ab1e=IG_NAME_SPAN_PART1+_0x585dd8+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x152303=await _0x3a0144['waitForSelector'](_0x55ab1e);let _0x13b779=await _0x3a0144['evaluate'](_0x49df3f=>_0x49df3f['innerHTML'],_0x152303);const _0x1c88be=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0xf43a1=_0x13b779['match'](_0x1c88be);_0xf43a1?_0x13b779=_0xf43a1[0x1]['trim']():_0x13b779=_0x13b779['trim']();_0x13b779['includes']('•')&&(_0x13b779=_0x13b779['substring'](0x0,_0x13b779['indexOf']('•')-0x1));const _0x1c31d2='UPDATE\x20'+_0x3b63c0+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x1c31d2,[_0x13b779,_0x1f7b20],function(_0x180f9a){_0x180f9a&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x180f9a['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x585dd8++;}catch(_0x4dfd4e){const _0x8989a4='UPDATE\x20'+_0x3b63c0+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x8989a4,['',_0x8c71e0],function(_0x3fcd7c){_0x3fcd7c&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x3fcd7c['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x4dfd4e);break;}}_0x59c18e&&_0x59c18e();}await _0x2d4e86['click']();}catch(_0x15fbd6){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x15fbd6);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x3fff68,_0x20dde7)=>{const _0x346de5='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x346de5,[],(_0x2b5e83,_0x188828)=>{_0x2b5e83?_0x20dde7(_0x2b5e83):_0x3fff68(_0x188828);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0xcbc879,_0x4801ca)=>{const _0x3a8415='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x3a8415,[],async(_0x3ba0d0,_0xb9bae1)=>{if(_0x3ba0d0)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x3ba0d0['message']),_0x4801ca({'status':'error','message':_0x3ba0d0['message']});else try{const _0x279ef4=await Promise['all'](_0xb9bae1['map'](_0x4eafbd=>{return new Promise(_0x5e50f2=>{if(!_0x4eafbd['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x4eafbd['campaign_name']),_0x5e50f2({'campaign_name':_0x4eafbd['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x14292b='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x4eafbd['list_id'],_0x5d9e51='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x4eafbd['list_id']+'\x22';db['get'](_0x14292b,[],(_0x3d61c2,_0x3ac9d4)=>{_0x3d61c2?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x4eafbd['campaign_name']+':',_0x3d61c2['message']),_0x5e50f2({'campaign_name':_0x4eafbd['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x5d9e51,[],(_0x16afa0,_0x350f2b)=>{_0x16afa0?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x4eafbd['campaign_name']+':',_0x16afa0['message']),_0x5e50f2({'campaign_name':_0x4eafbd['campaign_name'],'lead_count':_0x3ac9d4?_0x3ac9d4['lead_count']:0x0,'contacted_count':'N/A'})):_0x5e50f2({'campaign_name':_0x4eafbd['campaign_name'],'lead_count':_0x3ac9d4?_0x3ac9d4['lead_count']:0x0,'contacted_count':_0x350f2b?_0x350f2b['contacted_count']:0x0});});});});}));_0xcbc879({'status':'success','campaigns':_0x279ef4});}catch(_0x1863e3){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x1863e3),_0x4801ca({'status':'error','message':_0x1863e3['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x13bd06,_0x310aca)=>{return new Promise((_0x2f963e,_0x447613)=>{const _0x425133='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x425133,[_0x310aca],(_0x5a26a6,_0x475ae5)=>{_0x5a26a6?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x5a26a6),_0x447613(_0x5a26a6)):(console['log']('ROWS'),console['log'](_0x475ae5),debugDatabaseContents(),_0x2f963e(_0x475ae5));});});});const showTableContents=_0x4b4bdf=>{return new Promise((_0x3dd689,_0x475a6b)=>{const _0x440be6='SELECT\x20*\x20FROM\x20'+_0x4b4bdf+';';campaignDB['all'](_0x440be6,(_0x4b9ded,_0x1124c2)=>{_0x4b9ded?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x4b4bdf+':',_0x4b9ded),_0x475a6b(_0x4b9ded)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x4b4bdf+':',_0x1124c2),_0x3dd689({'status':'success','message':_0x1124c2}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x225faa){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x225faa);}}ipcMain['handle']('create-campaign',async(_0x3d024c,_0x37af52)=>{return new Promise((_0x79791e,_0x3923e9)=>{const _0x56005d='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x56005d,[String(_0x37af52)],function(_0x5a0125){_0x5a0125?_0x3923e9(_0x5a0125):_0x79791e({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x4bf7d2,_0x36e694)=>{return new Promise((_0x56dafc,_0xc0d5f8)=>{const _0x2ca3d1='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x2ca3d1,[_0x36e694],function(_0x18b90c){_0x18b90c?_0xc0d5f8(_0x18b90c):_0x56dafc({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0xf023a0,_0x3768f9,_0xf851cf,_0x493324,_0x4c800d,_0x5ced25,_0x5cef94,_0x1b14d4)=>{const _0x3cee31=await createMessageID(_0x4c800d);return new Promise((_0x904c86,_0x4e80c9)=>{if(!_0x3768f9||!_0xf851cf||!_0x493324||!_0x3cee31||!_0x5ced25)return _0x4e80c9({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x3cee31);const _0x61f729='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x61f729,[_0xf851cf,_0x493324,_0x3cee31,_0x5ced25,_0x5cef94,_0x1b14d4,_0x3768f9],function(_0x11c569){if(_0x11c569)_0x4e80c9({'status':'error','message':_0x11c569['message']});else this['changes']===0x0?_0x4e80c9({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x904c86({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x4348f9,_0x3768ca,_0x59f513,_0x20af39,_0xd9fa67)=>{return new Promise((_0x33d555,_0x5de20b)=>{const _0x1955ac='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x1955ac,[_0x3768ca,_0x59f513,_0x20af39,_0xd9fa67],function(_0x1071c3){return _0x1071c3?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x1071c3['message']),_0x5de20b('insert-dm-response',{'success':![],'message':_0x1071c3['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x33d555('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x4767c5=>{return new Promise((_0x555f36,_0x4a7f24)=>{const _0x550c18='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x550c18,[_0x4767c5],(_0x2036ee,_0x1d19a3)=>{if(_0x2036ee)_0x4a7f24({'status':'error','message':_0x2036ee['message']});else{if(_0x1d19a3)_0x555f36(_0x1d19a3['message_id']);else{const _0x4f1980='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x4f1980,[_0x4767c5],function(_0x12ae61){_0x12ae61?_0x4a7f24({'status':'error','message':_0x12ae61['message']}):_0x555f36(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x146e58,_0x4f3fef)=>{return new Promise((_0x332db6,_0xabc56c)=>{const _0x53060e='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x4f3fef;db['get'](_0x53060e,(_0xf4b484,_0x1236f6)=>{_0xf4b484?_0xabc56c({'status':'error','message':_0xf4b484['message']}):_0x332db6({'status':'success','count':_0x1236f6['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x2171f3,_0x576aa7){try{const _0x1bf42f=await new Promise((_0x48e72e,_0x25e5f9)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x576aa7],(_0x263757,_0x489ecb)=>{if(_0x263757)_0x25e5f9(_0x263757);else{if(_0x489ecb['length']>0x0){let _0x3c4575=JSON['parse'](_0x489ecb[0x0]['cookie']);console['log'](_0x3c4575),_0x48e72e(_0x3c4575);}else _0x25e5f9(new Error('User\x20with\x20username\x20'+_0x576aa7+'\x20does\x20not\x20exist.'));}});});await _0x2171f3['setCookie'](..._0x1bf42f),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x3ac7cf){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x3ac7cf);}}async function saveCookiesForUser(_0x2838ab,_0x49a66d){try{const _0x3788ea=await _0x2838ab['cookies']();if(!_0x3788ea||_0x3788ea['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x49a66d);const _0x5283eb=JSON['stringify'](_0x3788ea);if(_0x5283eb['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x49a66d);return new Promise((_0x4aa3bd,_0x44a0db)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x49a66d],(_0x211dde,_0x1b3211)=>{if(_0x211dde)return console['error']('Error\x20checking\x20user\x20existence:',_0x211dde),_0x44a0db(_0x211dde);if(_0x1b3211){const _0x3a4097=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x3a4097['run'](_0x5283eb,_0x49a66d,function(_0x286b1f){return _0x286b1f?(console['error']('Error\x20updating\x20cookies:',_0x286b1f),_0x44a0db(_0x286b1f)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x49a66d),_0x4aa3bd());});}else{const _0x91ba96=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x91ba96['run'](_0x49a66d,_0x5283eb,function(_0xd87c82){return _0xd87c82?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0xd87c82),_0x44a0db(_0xd87c82)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x49a66d),_0x4aa3bd());});}});});}catch(_0xdb58d1){console['error']('Error\x20fetching\x20cookies:',_0xdb58d1);throw _0xdb58d1;}}async function createUserIfNotExists(_0x58d288){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x58d288],(_0x2acbbf,_0x5aec8d)=>{if(_0x2acbbf){console['error']('Error\x20checking\x20user\x20existence:',_0x2acbbf);throw _0x2acbbf;}else{if(!_0x5aec8d){const _0x3cd99d=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x3cd99d['run'](_0x58d288,function(_0x2ab855){_0x2ab855?console['error']('Error\x20inserting\x20new\x20user:',_0x2ab855):console['log']('New\x20user\x20created:',_0x58d288);});}else console['log']('User\x20already\x20exists:',_0x58d288);}});}catch(_0x38304e){console['error']('Error\x20creating\x20user:',_0x38304e);throw _0x38304e;}}ipcMain['handle']('create-relation',async(_0x5d2405,_0x4bbfee)=>{return new Promise((_0x2b9cb8,_0x10d44f)=>{const _0xb354f8='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x4bbfee+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0xb354f8,function(_0x458a99){_0x458a99?_0x10d44f(_0x458a99):_0x2b9cb8({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x3eef55,_0x5de641)=>{return console['log']('droping\x20table'+_0x5de641),new Promise((_0x21338d,_0x5a37fa)=>{const _0x5c13c2='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x5de641;console['log']('droping\x20table'+_0x5de641),db['run'](_0x5c13c2,function(_0x5efe0){_0x5efe0?_0x5a37fa(_0x5efe0):_0x21338d({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x2f33d8=>{return new Promise((_0x360c24,_0x3cf25b)=>{const _0x480b28='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x480b28,[],(_0x2c19b7,_0xd98b6f)=>{_0x2c19b7?_0x3cf25b(_0x2c19b7):_0x360c24(_0xd98b6f['map'](_0x25dd63=>_0x25dd63['name']));});});}),ipcMain['handle']('add-user',async(_0x305951,_0x477520,_0x4493f5)=>{return new Promise(_0x2941d2=>{const _0x55ceed=db['prepare']('INSERT\x20INTO\x20'+_0x4493f5+'\x20(username)\x20VALUES\x20(?)');_0x55ceed['run'](_0x477520,function(_0x380eca){_0x380eca?console['log']('error\x20in\x20add-user:'+_0x380eca):_0x2941d2({'status':'success','id':this['lastID']});}),_0x55ceed['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x32eddc,_0x4b7aa5)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x224111,_0x216cea)=>{if(_0x224111)_0x4b7aa5(_0x224111);else{_0x32eddc({'status':'success','users':_0x216cea});for(_0x216cea of _0x216cea){console['log'](_0x216cea['username']);}}});});}),ipcMain['handle']('get-data',async(_0x2203af,_0x2b9b14)=>{return new Promise((_0x513abf,_0x13a86b)=>{const _0x490f63='SELECT\x20*\x20FROM\x20'+_0x2b9b14;console['log'](_0x490f63),db['all'](_0x490f63,[],(_0x50cdbc,_0x20a97e)=>{_0x50cdbc?_0x13a86b(_0x50cdbc):_0x513abf(_0x20a97e);});});}),ipcMain['handle']('get-accounts',async _0x552e3d=>{return new Promise((_0x3176ec,_0x3835d2)=>{const _0x84722d='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x84722d),igaccountsDB['all'](_0x84722d,[],(_0x597425,_0x139bf4)=>{_0x597425?_0x3835d2(_0x597425):_0x3176ec(_0x139bf4);});});}),ipcMain['handle']('get-targets',async(_0x37105e,_0x331e6e)=>{return getTargetProfiles(_0x331e6e);}),ipcMain['handle']('delete-user',async(_0x4a680d,_0x354060,_0x3e080b)=>{return new Promise((_0x35a008,_0x2a6bcc)=>{const _0x1be80b=db['prepare']('DELETE\x20FROM\x20'+_0x3e080b+'\x20WHERE\x20username\x20=\x20?');_0x1be80b['run'](_0x354060,function(_0x2057bb){_0x2057bb?_0x2a6bcc(_0x2057bb):_0x35a008({'status':'success','changes':this['changes']});}),_0x1be80b['finalize']();});}),ipcMain['handle']('delete-account',async(_0x3bed00,_0x4f413f)=>{const _0x3704d5=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x3704d5['run'](_0x4f413f,function(_0x381a49){_0x381a49&&console['log'](_0x381a49);}),_0x3704d5['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x35ecf1,_0x46e47f)=>{const _0x5da837='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x5da837,[],(_0x59ca4b,_0x477318)=>{_0x59ca4b?_0x46e47f({'status':'error','message':_0x59ca4b['message']}):_0x35ecf1({'status':'success','contactedCount':_0x477318['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x185786,_0x412b8b)=>{const _0x28dd8e='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x28dd8e,[],(_0x4177e1,_0x575de)=>{_0x4177e1?_0x412b8b({'status':'error','message':_0x4177e1['message']}):_0x185786({'status':'success','contactedCount':_0x575de['contactedCount']});});});});function exportDatabase(_0x25cff3){return new Promise((_0x18a409,_0x2d95fb)=>{const _0x276244='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x25cff3+'\x0a\x20\x20\x20\x20';db['all'](_0x276244,[],async(_0x42e0da,_0x10d4e0)=>{if(_0x42e0da){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x42e0da['message']),_0x2d95fb(_0x42e0da);return;}if(!_0x10d4e0||_0x10d4e0['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x18a409();return;}const _0x4a01be=XLSX['utils']['json_to_sheet'](_0x10d4e0),_0x367a65=XLSX['utils']['sheet_to_csv'](_0x4a01be);try{const {canceled:_0x1adf54,filePath:_0x49070b}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x25cff3+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x1adf54||!_0x49070b){console['log']('Speichern\x20abgebrochen.'),_0x18a409();return;}fs['writeFile'](_0x49070b,_0x367a65,'utf8',_0x377bcb=>{_0x377bcb?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x377bcb['message']),_0x2d95fb(_0x377bcb)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x49070b),_0x18a409());});}catch(_0x36daae){console['error']('Fehler\x20im\x20Speicherdialog:',_0x36daae),_0x2d95fb(_0x36daae);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x5c41a0,_0x3eb529)=>{shell['openExternal'](_0x3eb529);});