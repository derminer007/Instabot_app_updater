const {app,BrowserWindow,ipcMain,dialog,shell}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div',K_OPTIONS_BUTTON='section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.xs5motx\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD='div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f',K_SEND_MSG_BUTTON='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x3f667e=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x3f667e['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x3f667e['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x4d07f0){var _0x5ebdfa=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x514d02){console['log']('window\x20id:'+_0x514d02['id']),_0x514d02['id']>0x1&&(_0x5ebdfa=!![]);}),console['log']('child\x20opened\x20='+_0x5ebdfa);if(!_0x5ebdfa){const _0x133106=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x133106['loadFile'](_0x4d07f0['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0);});const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x1a24a0='',_0x4d5b3e=null;if(process['platform']==='darwin')_0x1a24a0=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x1a24a0=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x1a24a0}),_0x4d5b3e=await browser_login['newPage'](),_0x4d5b3e['setDefaultNavigationTimeout'](0x1d4c),_0x4d5b3e['setDefaultTimeout'](0x1d4c),_0x4d5b3e;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x37009f=0x1,_0xda37c2=0x0){let _0x38081d='',_0x3dad4f=null;const _0x21a961=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x38081d=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x38081d=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x37009f===0x0&&!pageStack[_0xda37c2])return browser=await puppeteer['launch']({'headless':_0x21a961,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x38081d}),_0x3dad4f=await browser['newPage'](),_0x3dad4f['setDefaultNavigationTimeout'](0x1d4c),_0x3dad4f['setDefaultTimeout'](0x1d4c),pageStack[_0xda37c2]=_0x3dad4f,_0x3dad4f;return(browser===null||pageStack[_0xda37c2]===null||pageStack[_0xda37c2]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x21a961,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x38081d})),(pageStack[_0xda37c2]===null||pageStack[_0xda37c2]['isClosed']())&&(_0x3dad4f=await browser['newPage'](),_0x3dad4f['setDefaultNavigationTimeout'](0x1d4c),_0x3dad4f['setDefaultTimeout'](0x1d4c),pageStack[_0xda37c2]=_0x3dad4f),pageStack[_0xda37c2];}ipcMain['on']('login',async(_0x3ae9c3,_0x24262b)=>{const _0xd166a3=await getBrowserPageLogin();await _0xd166a3['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0xd166a3,_0x24262b),ipcMain['on']('setLoginCookies',async(_0x405a30,_0x37e511)=>{try{await set_login_cookies(_0xd166a3,_0x37e511);}catch(_0x498a91){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x498a91);}});}),ipcMain['on']('export-relation',async(_0x3d974e,_0x188608)=>{try{await exportDatabase(_0x188608),_0x3d974e['reply']('export-relation-response',{'success':!![]});}catch(_0x493396){console['error'](_0x493396),_0x3d974e['reply']('export-relation-response',{'success':![],'message':_0x493396['message']});}}),ipcMain['handle']('sendMessage',async(_0x5b1ddd,_0x32e0fa,_0x6b182a,_0x5895ff,_0x2b7400,_0x488c2a,_0x382f7c,_0x2b48a9)=>{isStopping=![];let _0x23bd6b=null;return _0x382f7c?_0x23bd6b=await getBrowserPage(_0x2b7400,_0x2b48a9):_0x23bd6b=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x32e0fa),send_message(_0x23bd6b,_0x32e0fa,_0x6b182a,_0x5895ff,_0x2b7400,_0x488c2a);}),ipcMain['handle']('stop-action',async(_0x5f1c9e,_0x4e51d3)=>{isStopping=!![];const _0x2db0bc=await getBrowserPage(0x1,_0x4e51d3);await _0x2db0bc['close']();}),ipcMain['handle']('fetch_followers',async(_0x27291c,_0x513dde,_0x19132e,_0x5c498f,_0x16fba4,_0x8cf718)=>{isStopping=![];const _0x17f1f7=await getBrowserPage();return fetch_followers_from_account(_0x27291c,_0x17f1f7,_0x513dde,_0x19132e,_0x5c498f,_0x16fba4,_0x8cf718);}),ipcMain['handle']('get-account-details',async(_0x211a26,_0x4c788e,_0x3beff8,_0x341699)=>{isStopping=![];const _0x158584=await getBrowserPage();return fetch_account_details(_0x158584,_0x4c788e,_0x3beff8,_0x341699);}),ipcMain['handle']('fetch_likes',async(_0x29baa4,_0xee2aef,_0x1223ed,_0x1ca419,_0x8e1358,_0x3ed703)=>{isStopping=![];const _0x1059e6=await getBrowserPage();return fetch_likers_from_post(_0x29baa4,_0x1059e6,_0xee2aef,_0x1223ed,_0x1ca419,_0x8e1358,_0x3ed703);}),ipcMain['handle']('fetch_comments',async(_0x47c1e2,_0x272526,_0x1f5f41,_0xaf0012,_0x4eaf75,_0x5995ea)=>{isStopping=![];const _0x5b4ee6=await getBrowserPage();return fetch_comments_from_post(_0x47c1e2,_0x5b4ee6,_0x272526,_0x1f5f41,_0xaf0012,_0x4eaf75,_0x5995ea);}),ipcMain['handle']('update-app',async _0x4eb379=>{const {spawn:_0x4a591a}=require('child_process'),_0x493632=require('path');return new Promise((_0x2d870,_0x40df58)=>{(process['env']['NODE_ENV']==='development'||process['env']['SKIP_UPDATES']==='true')&&(console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x2d870('Update\x20übersprungen'));if(process['platform']==='darwin'){const _0x452a2e=_0x493632['join'](__dirname,'mac-updater-intern.sh'),_0xefc59c=_0x4a591a('/bin/bash',[_0x452a2e]);_0xefc59c['stdout']['on']('data',_0x3adbe8=>{console['log']('stdout:\x20'+_0x3adbe8);}),_0xefc59c['stderr']['on']('data',_0x386d35=>{console['error']('stderr:\x20'+_0x386d35);}),_0xefc59c['on']('close',_0x312ee6=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x312ee6),_0x312ee6===0x0?_0x2d870('Update\x20erfolgreich\x20abgeschlossen.'):_0x40df58(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x312ee6));});}else{if(process['platform']==='win32'){const _0x2d8bd2=_0x493632['join'](__dirname,'../','../','../');process['chdir'](_0x2d8bd2),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0xa43916='soft-ui-updater-windows.ps1',_0x1dbb32=_0x4a591a('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0xa43916]);_0x1dbb32['stdout']['on']('data',_0xe3c577=>{console['log']('stdout:\x20'+_0xe3c577);}),_0x1dbb32['stderr']['on']('data',_0x3fca50=>{console['error']('stderr:\x20'+_0x3fca50);}),_0x1dbb32['on']('close',_0x5e6fa0=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x5e6fa0),_0x5e6fa0===0x0?_0x2d870('Update\x20erfolgreich\x20abgeschlossen.'):_0x40df58(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x5e6fa0));});}else _0x40df58(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}});});function getRnd(_0x2b92b7,_0x3f9c56){return Math['random']()*(_0x3f9c56-_0x2b92b7+0x1)+_0x2b92b7;}function delay(_0x37fe17,_0x2691df){let _0x427047=getRnd(_0x37fe17,_0x2691df);return new Promise(function(_0x36625d){setTimeout(_0x36625d,_0x427047);});}async function scroll(_0x298017,_0x28f72b,_0x3e1e3a=0x2,_0x717f7b){const _0x59714e=await _0x298017['waitForSelector'](_0x28f72b);for(let _0x5eb83c=0x0;_0x5eb83c<_0x3e1e3a;_0x5eb83c++){console['log']('Scrolling\x20'+_0x5eb83c),await _0x298017['evaluate'](_0x185792=>{const _0x3bb63f=document['querySelector'](_0x185792);_0x3bb63f&&_0x3bb63f['scrollBy'](0x0,0x190);},_0x28f72b),await delay(0x320,0x5dc),_0x717f7b();}}async function saveCookies(_0x72d683){let _0x5872fe=await _0x72d683['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x5872fe,null,0x2));}async function notificationClear(_0x5ccf2c){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x5ccf2c['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x5ccf2c['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x344e52){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x344e52);}}async function getTargetProfiles(_0x2bfb40){return new Promise((_0x4f84b2,_0x188822)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x2bfb40,(_0x2743fc,_0xdf6c8b)=>{_0x2743fc?_0x188822(_0x2743fc):_0x4f84b2(_0xdf6c8b);});});}async function login_legacy(_0x5cc684,_0x10c065,_0x4f315f){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x5cc684,_0x10c065),await createUserIfNotExists(_0x10c065,_0x4f315f);}catch(_0xc300f2){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0xc300f2);}try{await _0x5cc684['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x5cc684['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x5cc684['click']('button._a9--._ap36._a9_0');}catch(_0x3fc13b){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x5cc684['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x5cc684['type']('input[name=\x27username\x27]',_0x10c065,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x5cc684['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x5cc684['type']('input[name=\x27password\x27]',_0x4f315f,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x5cc684['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x5cc684['click']('button[type=\x27submit\x27]');}catch(_0x184294){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x5cc684),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x5cc684,_0x10c065);}catch(_0x43bce9){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x43bce9);}}catch(_0x386018){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x386018);}}async function login(_0x4db2ce,_0xed7050){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x4db2ce,_0xed7050),await createUserIfNotExists(_0xed7050);}catch(_0x4fd78d){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4fd78d);}try{await _0x4db2ce['goto']('https://www.instagram.com/accounts/login/');}catch(_0xff5bde){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0xff5bde);}}async function set_login_cookies(_0x174357,_0x5d47ca){try{await saveCookiesForUser(_0x174357,_0x5d47ca);}catch(_0x239022){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x239022);}}async function waitForXPath(_0x4f4ae6,_0x5ec44a,_0x137498={}){return await _0x4f4ae6['waitForFunction'](_0x1bb264=>{return document['evaluate'](_0x1bb264,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x137498,_0x5ec44a),_0x4f4ae6['evaluateHandle'](_0x2f1abf=>document['evaluate'](_0x2f1abf,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x5ec44a);}async function send_message(_0x5ef2ae,_0x469bd9,_0x411d2f,_0x229ba6,_0x33b6b5,_0x41da15){return new Promise(async(_0x307881,_0x430b2a)=>{_0x41da15=_0x41da15['split'](';'),console['log'](_0x41da15[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x33b6b5);try{await setCookiesForUser(_0x5ef2ae,_0x41da15[0x0]);}catch(_0x380d68){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x380d68),_0x430b2a({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x380d68});return;}try{await _0x5ef2ae['goto']('https://www.instagram.com/'+_0x469bd9+'/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x5ef2ae);}catch(_0x1df63f){_0x430b2a({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x1df63f});return;}try{await _0x5ef2ae['waitForSelector'](K_DIRECT_MSG_BUTTON),await _0x5ef2ae['click'](K_DIRECT_MSG_BUTTON);}catch(_0x368a5d){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x368a5d);try{await _0x5ef2ae['waitForSelector'](K_OPTIONS_BUTTON),await _0x5ef2ae['click'](K_OPTIONS_BUTTON),await delay(0x1f4,0x320);const _0x13e297=await waitForXPath(_0x5ef2ae,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x13e297['click']();}catch(_0x234d13){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x234d13),_0x307881({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x5ef2ae);}catch(_0x43585b){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x43585b);}try{const _0x31069f=await _0x5ef2ae['waitForSelector'](K_CHAT_INPUT_FIELD),_0x5f1b02=await _0x5ef2ae['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x5f1b02),_0x229ba6=_0x229ba6['replace']('{USERNAME}',_0x469bd9);let _0x5cc9ce=_0x5f1b02['split']('\x20')[0x0];_0x229ba6=_0x229ba6['replace']('{NAME}',_0x5cc9ce),_0x229ba6=_0x229ba6['replace']('{name}',_0x5cc9ce),await _0x31069f['type'](_0x229ba6,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0x56c92b=await _0x5ef2ae['waitForSelector'](K_SEND_MSG_BUTTON);await _0x56c92b['click'](),await delay(0x320,0x3e8),_0x307881({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!'});}catch(_0x190890){console['error']('Nachricht\x20nicht\x20gesendet:\x20'+_0x190890),_0x430b2a('Nachricht\x20nicht\x20gesendet:\x20'+_0x190890);}});}function handle_fail(_0x1593dc){if(isStopping)return new Promise(_0x56455c=>{_0x56455c('Scraper\x20gestoppt.');});else{let _0xb2f586='';switch(_0x1593dc){case 0x0:_0xb2f586='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0xb2f586='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0xb2f586='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0xb2f586='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x53c0db,_0x170c47)=>{_0x170c47(_0xb2f586);});}}async function fetch_account_details(_0x542c82,_0x268cc8,_0x343c52,_0x12c482){try{await setCookiesForUser(_0x542c82,_0x343c52['username']);}catch(_0x3cf6bb){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x3cf6bb);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x3cf6bb);return handle_fail(0x0);}_0x542c82['setDefaultNavigationTimeout'](0x7530),await _0x542c82['goto']('https://www.instagram.com/'+_0x268cc8+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x542c82);const _0x34b692=await _0x542c82['evaluate'](()=>{const _0x3949df=document['querySelector']('meta[property=\x22og:image\x22]');return _0x3949df?_0x3949df['getAttribute']('content'):null;});await _0x542c82['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x21b9bb=await _0x542c82['evaluate'](()=>{const _0x2320d5=document['querySelector']('meta[name=\x22description\x22]');if(!_0x2320d5)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0xba9833=_0x2320d5['getAttribute']('content');if(!_0xba9833)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0xba9833);const _0x19fde1=/\s*[–-]\s*/,_0x13d7e4=_0xba9833['split'](_0x19fde1);if(_0x13d7e4['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x498db9=_0x13d7e4[0x0],_0x4a6d15=_0x13d7e4[0x1],_0x1afc55=_0x498db9['split'](',\x20');if(_0x1afc55['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x449f7c=_0x1afc55[0x0]['split']('\x20')[0x0],_0x542fce=_0x1afc55[0x1]['split']('\x20')[0x0],_0x1be0cf=_0x1afc55[0x2]['split']('\x20')[0x0];let _0x1fd4d5='',_0x23257c='';const _0x139f3e='\x20on\x20Instagram:\x20',_0x2ff8f7=_0x4a6d15['split'](_0x139f3e);return _0x1fd4d5=_0x2ff8f7[0x0]['trim'](),_0x1fd4d5=_0x1fd4d5['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x2ff8f7['length']>0x1&&(_0x23257c=_0x2ff8f7[0x1]['trim'](),_0x23257c['startsWith']('\x22')&&_0x23257c['endsWith']('\x22')&&(_0x23257c=_0x23257c['substring'](0x1,_0x23257c['length']-0x1)['trim']()),_0x23257c=_0x23257c['replace'](/&quot;/g,'')['trim']()),{'followers':_0x449f7c,'following':_0x542fce,'posts':_0x1be0cf,'nameText':_0x1fd4d5,'bio':_0x23257c};});console['log']('Extracted\x20profile\x20data:',_0x21b9bb);const _0x1d16ed=_0x21b9bb['nameText'],_0x1de011=_0x34b692,_0x1e09ba=_0x21b9bb['bio'],_0x1504b6=_0x21b9bb['followers'],_0x44f3e3=_0x21b9bb['following'],_0x5e5d90=_0x21b9bb['posts'],_0x4ec943=![],_0x414f3c=![],_0x1979f7=![],_0xc8b088='\x0a\x20\x20INSERT\x20INTO\x20'+_0x12c482+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0xc8b088,[_0x268cc8,_0x1d16ed,_0x1de011,_0x1e09ba,_0x1504b6,_0x44f3e3,_0x5e5d90,_0x4ec943,_0x414f3c,_0x1979f7],function(_0x4d75ce){_0x4d75ce?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x4d75ce['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x366989,_0x42118a,_0x5c4547,_0x4d457f,_0xf7f6e3,_0x175c5e,_0x2f439b){let _0x2722b9=0x4,_0x31fb5d=0x0,_0x43b42b=0x0;try{await setCookiesForUser(_0x42118a,_0x175c5e['username']);}catch(_0x1142df){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x1142df);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x1142df);return handle_fail(0x0);}let _0x4c3692=0x0;try{await _0x42118a['goto']('https://www.instagram.com/'+_0x5c4547+'/'),await notificationClear(_0x42118a);try{if(_0x4d457f<=0x0){const _0x4675b0=await _0x42118a['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x1079d1=await _0x42118a['evaluate'](_0x3ccb66=>_0x3ccb66['innerHTML'],_0x4675b0);_0x4c3692=Math['ceil'](_0x1079d1/0x4);}else _0x4c3692=Math['ceil'](_0x4d457f/0x4);_0x2722b9+=_0x4c3692,_0x43b42b=Math['round'](++_0x31fb5d/_0x2722b9*0x64),_0x366989['sender']['send']('fetch-progress',_0x43b42b,!![]);let _0x83a0db=await _0x42118a['waitForSelector']('a[href=\x22/'+_0x5c4547+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x83a0db['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x5c4547+'\x20gesichtet'),_0x43b42b=Math['round'](++_0x31fb5d/_0x2722b9*0x64),_0x366989['sender']['send']('fetch-progress',_0x43b42b,!![]);}catch(_0x5f28f3){console['log']('Follower\x20Liste\x20von\x20'+_0x5c4547+'\x20nicht\x20gefunden:'+_0x5f28f3);throw new Error('Follower\x20Liste\x20von\x20'+_0x5c4547+'\x20nicht\x20gefunden:'+_0x5f28f3);return handle_fail(0x0);}}catch(_0x114073){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x114073);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x114073);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x4c3692),await scroll(_0x42118a,FOLLOWER_FENSTER,_0x4c3692,_0x1ebf4b=>{_0x43b42b=Math['round'](++_0x31fb5d/_0x2722b9*0x64),_0x366989['sender']['send']('fetch-progress',_0x43b42b,!![]);}),await _0x42118a['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0xf93b60=await _0x42118a['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x3b37ce=await _0x42118a['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x43b42b=Math['round'](++_0x31fb5d/_0x2722b9*0x64),_0x366989['sender']['send']('fetch-progress',_0x43b42b,!![]);_0x4d457f<=0x0&&(_0x4d457f=_0xf93b60['length']);let _0x42b311=[];for(let _0x2acd2d=0x0;_0x2acd2d<_0xf93b60['length']&&_0x2acd2d<_0x4d457f;_0x2acd2d++){_0x42b311['push'](await _0xf93b60[_0x2acd2d]['evaluate'](_0x281169=>_0x281169['textContent']));const _0x3fbab0='INSERT\x20INTO\x20'+_0xf7f6e3+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x3fbab0,[await _0xf93b60[_0x2acd2d]['evaluate'](_0x333c0e=>_0x333c0e['textContent']),await _0x3b37ce[_0x2acd2d]['evaluate'](_0x13c83c=>_0x13c83c['textContent'])],function(_0x459bf0){_0x459bf0?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0xf7f6e3+'\x27:',_0x459bf0['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x43b42b=Math['round'](++_0x31fb5d/_0x2722b9*0x64),_0x366989['sender']['send']('fetch-progress',_0x43b42b,!![]),_0x2f439b&&(_0x366989['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x366989,_0x42118a,_0x175c5e,_0xf7f6e3,_0x42b311)),new Promise(_0xa9d32c=>{_0xa9d32c('Scraping\x20finished!');});}catch(_0x502ed1){if(_0x2f439b)throw new Error(_0x502ed1);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x5c4547+'\x20nicht\x20gefunden:\x20'+_0x502ed1);return handle_fail(0x0);}}async function fetch_details_from_list(_0x226b58,_0x38b6d0,_0x11f2c8,_0x23b445,_0x5d442a){let _0x37cd52=0x0,_0xaee1c0=0x0;for(let _0x2fa85e=0x0;_0x2fa85e<_0x5d442a['length'];_0x2fa85e++){console['log']('Processing\x20profile:',_0x5d442a[_0x2fa85e]);try{await fetch_account_details(_0x38b6d0,_0x5d442a[_0x2fa85e],_0x11f2c8,_0x23b445);}catch(_0x39f56a){console['error']('Detailed\x20Scraping\x20von:\x20',_0x5d442a[_0x2fa85e],_0x39f56a);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x5d442a[_0x2fa85e]+'\x20'+_0x39f56a);}_0xaee1c0=Math['round'](++_0x37cd52/_0x5d442a['length']*0x64),_0x226b58['sender']['send']('fetch-progress',_0xaee1c0,!![],!![]);}}async function fetch_likers_from_post(_0x3151f4,_0x35bfe0,_0x4ca605,_0x5c45e7,_0x39c732,_0x5632f2,_0xddef2a){let _0x2adb0c=0x4,_0x369f03=0x0,_0x46560a=0x0;try{await setCookiesForUser(_0x35bfe0,_0x5632f2['username']);}catch(_0x5488b0){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5488b0);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5488b0);return handle_fail(0x1);return;}_0x46560a=Math['round'](++_0x369f03/_0x2adb0c*0x64),_0x3151f4['sender']['send']('fetch-progress',_0x46560a,!![]);try{let _0x4b6567=_0x4ca605['substring'](0x0,_0x4ca605['lastIndexOf']('/')),_0x4b494e=_0x4b6567+'/liked_by';console['log'](_0x4b494e),await _0x35bfe0['goto'](_0x4b494e),await delay(0x7d0,0xfa0),await notificationClear(_0x35bfe0),await delay(0xc8,0x1f4),_0x46560a=Math['round'](++_0x369f03/_0x2adb0c*0x64),_0x3151f4['sender']['send']('fetch-progress',_0x46560a,!![]),await _0x35bfe0['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x2fbf8a=await _0x35bfe0['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x21026a=await _0x35bfe0['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x2fbf8a['length']);let _0x451876=path['join'](__dirname,'/likers.csv');_0x46560a=Math['round'](++_0x369f03/_0x2adb0c*0x64),_0x3151f4['sender']['send']('fetch-progress',_0x46560a,!![]);_0x5c45e7<=0x0&&(_0x5c45e7=_0x2fbf8a['length']);try{let _0x435930=[];for(let _0x47d3cd=0x0;_0x47d3cd<_0x2fbf8a['length']&&_0x47d3cd<_0x5c45e7;_0x47d3cd++){_0x435930['push'](await _0x2fbf8a[_0x47d3cd]['evaluate'](_0x3d10b4=>_0x3d10b4['textContent']));try{const _0x1504a4='INSERT\x20INTO\x20'+_0x39c732+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x1504a4,[await _0x2fbf8a[_0x47d3cd]['evaluate'](_0x1d6b49=>_0x1d6b49['textContent']),await _0x21026a[_0x47d3cd]['evaluate'](_0x3d96ad=>_0x3d96ad['textContent'])],function(_0x3e58ef){_0x3e58ef?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x39c732+'\x27:',_0x3e58ef['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x21bffc){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x47d3cd+'\x20:\x20'+_0x21bffc);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x47d3cd+'\x20:\x20'+_0x21bffc);return handle_fail(0x1);}}return _0x46560a=Math['round'](++_0x369f03/_0x2adb0c*0x64),_0x3151f4['sender']['send']('fetch-progress',_0x46560a,!![]),_0xddef2a&&(_0x3151f4['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x3151f4,_0x35bfe0,_0x5632f2,_0x39c732,_0x435930)),new Promise(_0xf75a=>{_0xf75a('Scraping\x20finished!');});}catch(_0x27b010){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x27b010);return handle_fail(0x1);}}catch(_0x4f3042){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x4f3042);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x4f3042);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x2a4409,_0x30c758,_0x529b64,_0x33c31f,_0xf07cc4,_0x36ae9a,_0x384f24){let _0x4dee11=0x3,_0x61e32b=0x0,_0x5e6f76=0x0;try{await setCookiesForUser(_0x30c758,_0x36ae9a['username']);}catch(_0x389685){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x389685);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x389685);return handle_fail(0x2);}try{console['log'](_0x529b64),await _0x30c758['goto'](_0x529b64),await delay(0x7d0,0xfa0),await notificationClear(_0x30c758),await delay(0xc8,0x1f4);const _0x9a4d92=COM_COMMENTS_BOX_BODY_DIV;let _0xbbd6f1;const _0x3cdbf4=await _0x30c758['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x1b65f8=await _0x30c758['evaluate'](_0x4ef6e7=>_0x4ef6e7['innerHTML'],_0x3cdbf4),_0x5f29ec=String(_0x1b65f8)['replace'](/[^0-9]/g,''),_0x539fb4=Number(_0x5f29ec)/0x14;_0x33c31f<=0x0?_0xbbd6f1=Math['ceil'](_0x539fb4/0x3):_0xbbd6f1=Math['ceil'](_0x33c31f/0x3);_0x4dee11+=_0xbbd6f1,_0x5e6f76=Math['round'](++_0x61e32b/_0x4dee11*0x64),_0x2a4409['sender']['send']('fetch-progress',_0x5e6f76,!![]),console['log']('Auto-scrolls:\x20'+_0xbbd6f1),await scroll(_0x30c758,_0x9a4d92,_0xbbd6f1,_0x2eb499=>{_0x5e6f76=Math['round'](++_0x61e32b/_0x4dee11*0x64),_0x2a4409['sender']['send']('fetch-progress',_0x5e6f76,!![]);});try{const _0x4913fa=COM_REPLY_BUTTON_SPAN;await _0x30c758['waitForSelector'](_0x4913fa),await delay(0x1f4,0x320);const _0xecbcb4=await _0x30c758['$$'](_0x4913fa);console['log'](_0xecbcb4);let _0x4f7d64=_0xecbcb4['length'];await delay(0xc8,0x1f4);try{for(let _0x318f85=0x0;_0x318f85<_0x4f7d64;_0x318f85++){_0xecbcb4[_0x318f85]['click'](),await delay(0x320,0x5dc);}}catch(_0x4b4524){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x4b4524);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x4b4524);return handle_fail(0x2);}}catch(_0x279859){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x4800a9=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x30c758['waitForSelector'](_0x4800a9),await delay(0x1f4,0x320),_0x5e6f76=Math['round'](++_0x61e32b/_0x4dee11*0x64),_0x2a4409['sender']['send']('fetch-progress',_0x5e6f76,!![]);const _0x5cfcce=await _0x30c758['$$'](_0x4800a9);let _0x230106=path['join'](__dirname,'/comments.csv');_0x33c31f<=0x0&&(_0x33c31f=_0x5cfcce['length']);console['log']('fetch_limit:\x20'+_0x33c31f),console['log']('comments_len:\x20'+_0x5cfcce['length']),_0x33c31f++;try{let _0x475a2a=[];for(let _0x30981e=0x1;_0x30981e<_0x5cfcce['length']&&_0x30981e<_0x33c31f;_0x30981e++){try{_0x475a2a['push'](await _0x5cfcce[_0x30981e]['evaluate'](_0xc60617=>_0xc60617['textContent']));const _0x52f12b=await db['prepare']('INSERT\x20INTO\x20'+_0xf07cc4+'\x20(username)\x20VALUES\x20(?)');await _0x52f12b['run'](await _0x5cfcce[_0x30981e]['evaluate'](_0xcd7c28=>_0xcd7c28['textContent']),function(_0x118574){_0x118574&&console['log']('error\x20in\x20add-user:'+_0x118574);}),await _0x52f12b['finalize']();}catch(_0x2eace5){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x30981e+'\x20:\x20'+_0x2eace5);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x30981e+'\x20:\x20'+_0x2eace5);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x5e6f76=Math['round'](++_0x61e32b/_0x4dee11*0x64),_0x2a4409['sender']['send']('fetch-progress',_0x5e6f76,!![]),_0x2a4409['sender']['send']('fetch-progress',0x64,!![]),_0x384f24&&(_0x2a4409['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x2a4409,_0x30c758,_0x36ae9a,_0xf07cc4,_0x475a2a)),_0x2a4409['sender']['send']('fetch-progress',0x64,![]),new Promise(_0xb0e1d=>{_0xb0e1d('Scraping\x20finished!');});}catch(_0x3dedda){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x3dedda);return handle_fail(0x2);}}catch(_0x3cf437){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x3cf437);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x3cf437);return handle_fail(0x2);}}async function set_clearname_from_username(_0x242e96,_0x543cee,_0x390c47=null){try{let _0x3d98b2,_0x37975e;const _0x53705d='SELECT\x20username\x20FROM\x20'+_0x543cee+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x53705d,[],(_0x3ba9eb,_0x435a6f)=>{_0x3ba9eb&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x3ba9eb['message']),_0x435a6f['length']===0x0&&(_0x37975e=_0x435a6f['length']),_0x3d98b2=_0x435a6f['map'](_0x1c511a=>_0x1c511a['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x37975e);if(_0x37975e===0x0){console['log']('Leave');return;}const _0x192aae=await _0x242e96['waitForSelector'](IG_SEARCH_BUTTON);await _0x192aae['click'](),await delay(0x4b0,0x7d0);for(let _0x5c6f84 of _0x3d98b2){const _0x82afbe=await _0x242e96['waitForSelector'](IG_SEARCH_INPUT);await _0x82afbe['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x242e96['type'](IG_SEARCH_INPUT,_0x5c6f84,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x50accc=0x1;while(_0x50accc!=0x14){console['log']('Schleife');try{let _0x4ed64c=IG_NAME_SPAN_PART1+_0x50accc+IG_USERNAME_SPAN_PART2;const _0x53f640=await _0x242e96['waitForSelector'](_0x4ed64c),_0x93ca3a=await _0x242e96['evaluate'](_0x5f1783=>_0x5f1783['innerHTML'],_0x53f640);await delay(0xc8,0x1f4);if(_0x93ca3a==_0x5c6f84){let _0x3d76f8=IG_NAME_SPAN_PART1+_0x50accc+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x20ca04=await _0x242e96['waitForSelector'](_0x3d76f8);let _0x250414=await _0x242e96['evaluate'](_0x450085=>_0x450085['innerHTML'],_0x20ca04);const _0x40aca2=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x425573=_0x250414['match'](_0x40aca2);_0x425573?_0x250414=_0x425573[0x1]['trim']():_0x250414=_0x250414['trim']();_0x250414['includes']('•')&&(_0x250414=_0x250414['substring'](0x0,_0x250414['indexOf']('•')-0x1));const _0x4c7b79='UPDATE\x20'+_0x543cee+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x4c7b79,[_0x250414,_0x93ca3a],function(_0x2b88ff){_0x2b88ff&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x2b88ff['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x50accc++;}catch(_0x10c8c1){const _0x4bc1b3='UPDATE\x20'+_0x543cee+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x4bc1b3,['',_0x5c6f84],function(_0x1026f4){_0x1026f4&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x1026f4['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x10c8c1);break;}}_0x390c47&&_0x390c47();}await _0x192aae['click']();}catch(_0x280df1){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x280df1);}}const campaignPath=path['resolve'](__dirname,'data/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(campaign_name\x20TEXT\x20PRIMARY\x20KEY,\x20list_id\x20TEXT,\x20zeitabstand\x20REAL,\x20message_id\x20TEXT,\x20account\x20TEXT,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x23e4e0,_0x48a515)=>{const _0x3a83bf='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x3a83bf,[],(_0x3c9515,_0x2977e8)=>{_0x3c9515?_0x48a515(_0x3c9515):_0x23e4e0(_0x2977e8);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0xe7161e,_0x2640ed)=>{const _0x28fcbf='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x28fcbf,[],async(_0x46d44e,_0x15c191)=>{if(_0x46d44e)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x46d44e['message']),_0x2640ed({'status':'error','message':_0x46d44e['message']});else try{const _0x4fac80=await Promise['all'](_0x15c191['map'](_0x593d7b=>{return new Promise(_0x26a302=>{if(!_0x593d7b['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x593d7b['campaign_name']),_0x26a302({'campaign_name':_0x593d7b['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x14e6f5='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x593d7b['list_id'],_0xca12eb='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x593d7b['list_id']+'\x22';db['get'](_0x14e6f5,[],(_0x5ec8af,_0x547470)=>{_0x5ec8af?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x593d7b['campaign_name']+':',_0x5ec8af['message']),_0x26a302({'campaign_name':_0x593d7b['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0xca12eb,[],(_0x2c050e,_0xc788bb)=>{_0x2c050e?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x593d7b['campaign_name']+':',_0x2c050e['message']),_0x26a302({'campaign_name':_0x593d7b['campaign_name'],'lead_count':_0x547470?_0x547470['lead_count']:0x0,'contacted_count':'N/A'})):_0x26a302({'campaign_name':_0x593d7b['campaign_name'],'lead_count':_0x547470?_0x547470['lead_count']:0x0,'contacted_count':_0xc788bb?_0xc788bb['contacted_count']:0x0});});});});}));_0xe7161e({'status':'success','campaigns':_0x4fac80});}catch(_0x16a65b){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x16a65b),_0x2640ed({'status':'error','message':_0x16a65b['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x1a6f80,_0xf00d24)=>{return new Promise((_0x53a8bb,_0x362a57)=>{const _0x322567='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x322567,[_0xf00d24],(_0x4ea6e8,_0x126c55)=>{_0x4ea6e8?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x4ea6e8),_0x362a57(_0x4ea6e8)):(console['log']('ROWS'),console['log'](_0x126c55),debugDatabaseContents(),_0x53a8bb(_0x126c55));});});});const showTableContents=_0x2d1814=>{return new Promise((_0x76972d,_0x445421)=>{const _0x2b640d='SELECT\x20*\x20FROM\x20'+_0x2d1814+';';campaignDB['all'](_0x2b640d,(_0xa09935,_0x9e5e5d)=>{_0xa09935?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x2d1814+':',_0xa09935),_0x445421(_0xa09935)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x2d1814+':',_0x9e5e5d),_0x76972d({'status':'success','message':_0x9e5e5d}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x2a7171){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x2a7171);}}ipcMain['handle']('create-campaign',async(_0x27984a,_0xf618b9)=>{return new Promise((_0x281f33,_0x3b0f9f)=>{const _0x1fbb45='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x1fbb45,[String(_0xf618b9)],function(_0x946f0e){_0x946f0e?_0x3b0f9f(_0x946f0e):_0x281f33({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x2103c4,_0x364537)=>{return new Promise((_0x195043,_0x18abf2)=>{const _0x42e034='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x42e034,[_0x364537],function(_0x928c13){_0x928c13?_0x18abf2(_0x928c13):_0x195043({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x10d6d2,_0x455579,_0xde0fae,_0x32a696,_0x11fa72,_0x24bdcb)=>{const _0x587f68=await createMessageID(_0x11fa72);return new Promise((_0xbe5ec0,_0x2c1485)=>{if(!_0x455579||!_0xde0fae||!_0x32a696||!_0x587f68||!_0x24bdcb)return _0x2c1485({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x587f68);const _0x1be394='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x1be394,[_0xde0fae,_0x32a696,_0x587f68,_0x24bdcb,_0x455579],function(_0x224e62){if(_0x224e62)_0x2c1485({'status':'error','message':_0x224e62['message']});else this['changes']===0x0?_0x2c1485({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0xbe5ec0({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x250f97,_0x285de8,_0xe34ac8,_0x565cc1,_0x1823c5)=>{return new Promise((_0x4483cc,_0x480ad1)=>{const _0x2eb63e='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x2eb63e,[_0x285de8,_0xe34ac8,_0x565cc1,_0x1823c5],function(_0x59d08d){return _0x59d08d?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x59d08d['message']),_0x480ad1('insert-dm-response',{'success':![],'message':_0x59d08d['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x4483cc('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0xcd99d1=>{return new Promise((_0x1f1a11,_0x5ea802)=>{const _0x1a0618='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x1a0618,[_0xcd99d1],(_0x55d5d5,_0x597f31)=>{if(_0x55d5d5)_0x5ea802({'status':'error','message':_0x55d5d5['message']});else{if(_0x597f31)_0x1f1a11(_0x597f31['message_id']);else{const _0x140159='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x140159,[_0xcd99d1],function(_0x199b11){_0x199b11?_0x5ea802({'status':'error','message':_0x199b11['message']}):_0x1f1a11(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x4135c0,_0x450e46)=>{return new Promise((_0x2d9a7b,_0x9cd25c)=>{const _0x4016c0='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x450e46;db['get'](_0x4016c0,(_0x437f70,_0x3c877d)=>{_0x437f70?_0x9cd25c({'status':'error','message':_0x437f70['message']}):_0x2d9a7b({'status':'success','count':_0x3c877d['count']});});});});const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x24a5f2,_0x34138f){try{const _0x1c4bd4=await new Promise((_0x16885f,_0x51c8aa)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x34138f],(_0x5adf16,_0x47ea18)=>{if(_0x5adf16)_0x51c8aa(_0x5adf16);else{if(_0x47ea18['length']>0x0){let _0x1c5fd6=JSON['parse'](_0x47ea18[0x0]['cookie']);console['log'](_0x1c5fd6),_0x16885f(_0x1c5fd6);}else _0x51c8aa(new Error('User\x20with\x20username\x20'+_0x34138f+'\x20does\x20not\x20exist.'));}});});await _0x24a5f2['setCookie'](..._0x1c4bd4),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x4c8f79){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x4c8f79);}}async function saveCookiesForUser(_0x34435f,_0x96374a){try{const _0x70d386=await _0x34435f['cookies']();if(!_0x70d386||_0x70d386['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x96374a);const _0x20bbcf=JSON['stringify'](_0x70d386);if(_0x20bbcf['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x96374a);return new Promise((_0x4edbdc,_0x3e5343)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x96374a],(_0x5711d7,_0x36a4f7)=>{if(_0x5711d7)return console['error']('Error\x20checking\x20user\x20existence:',_0x5711d7),_0x3e5343(_0x5711d7);if(_0x36a4f7){const _0x5f2efc=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x5f2efc['run'](_0x20bbcf,_0x96374a,function(_0xfa86d9){return _0xfa86d9?(console['error']('Error\x20updating\x20cookies:',_0xfa86d9),_0x3e5343(_0xfa86d9)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x96374a),_0x4edbdc());});}else{const _0x3d7104=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x3d7104['run'](_0x96374a,_0x20bbcf,function(_0x434a78){return _0x434a78?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x434a78),_0x3e5343(_0x434a78)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x96374a),_0x4edbdc());});}});});}catch(_0x1bf9df){console['error']('Error\x20fetching\x20cookies:',_0x1bf9df);throw _0x1bf9df;}}async function createUserIfNotExists(_0x2370b3){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x2370b3],(_0x640c68,_0x429cb3)=>{if(_0x640c68){console['error']('Error\x20checking\x20user\x20existence:',_0x640c68);throw _0x640c68;}else{if(!_0x429cb3){const _0xc3bbfe=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0xc3bbfe['run'](_0x2370b3,function(_0x5bb5fa){_0x5bb5fa?console['error']('Error\x20inserting\x20new\x20user:',_0x5bb5fa):console['log']('New\x20user\x20created:',_0x2370b3);});}else console['log']('User\x20already\x20exists:',_0x2370b3);}});}catch(_0x3c8acc){console['error']('Error\x20creating\x20user:',_0x3c8acc);throw _0x3c8acc;}}ipcMain['handle']('create-relation',async(_0x271dce,_0x377c51)=>{return new Promise((_0x569dfc,_0x3125c7)=>{const _0x3db45b='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x377c51+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x3db45b,function(_0x4eb1f8){_0x4eb1f8?_0x3125c7(_0x4eb1f8):_0x569dfc({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x130fa3,_0x2dbf41)=>{return console['log']('droping\x20table'+_0x2dbf41),new Promise((_0x49af74,_0x4b17c5)=>{const _0x4f5a1e='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x2dbf41;console['log']('droping\x20table'+_0x2dbf41),db['run'](_0x4f5a1e,function(_0x3901f4){_0x3901f4?_0x4b17c5(_0x3901f4):_0x49af74({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x140c70=>{return new Promise((_0x4fc772,_0x1bb463)=>{const _0x481cc9='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x481cc9,[],(_0x288207,_0x288b82)=>{_0x288207?_0x1bb463(_0x288207):_0x4fc772(_0x288b82['map'](_0x8ec128=>_0x8ec128['name']));});});}),ipcMain['handle']('add-user',async(_0x440db1,_0x4200d2,_0x5d293a)=>{return new Promise(_0x136a9e=>{const _0x3cd8ae=db['prepare']('INSERT\x20INTO\x20'+_0x5d293a+'\x20(username)\x20VALUES\x20(?)');_0x3cd8ae['run'](_0x4200d2,function(_0x1c70f9){_0x1c70f9?console['log']('error\x20in\x20add-user:'+_0x1c70f9):_0x136a9e({'status':'success','id':this['lastID']});}),_0x3cd8ae['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x5ba31e,_0x2f5b15)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x2434f4,_0x1b3f77)=>{if(_0x2434f4)_0x2f5b15(_0x2434f4);else{_0x5ba31e({'status':'success','users':_0x1b3f77});for(_0x1b3f77 of _0x1b3f77){console['log'](_0x1b3f77['username']);}}});});}),ipcMain['handle']('get-data',async(_0x43454b,_0x367e1c)=>{return new Promise((_0x31bd06,_0x8c6042)=>{const _0x1c6bbe='SELECT\x20*\x20FROM\x20'+_0x367e1c;console['log'](_0x1c6bbe),db['all'](_0x1c6bbe,[],(_0x1b69b2,_0x271a46)=>{_0x1b69b2?_0x8c6042(_0x1b69b2):_0x31bd06(_0x271a46);});});}),ipcMain['handle']('get-accounts',async _0x20dd29=>{return new Promise((_0x89e0ac,_0x347028)=>{const _0x3d9499='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x3d9499),igaccountsDB['all'](_0x3d9499,[],(_0x3fc73c,_0x28c0b5)=>{_0x3fc73c?_0x347028(_0x3fc73c):_0x89e0ac(_0x28c0b5);});});}),ipcMain['handle']('get-targets',async(_0x24c990,_0x70f0bd)=>{return getTargetProfiles(_0x70f0bd);}),ipcMain['handle']('delete-user',async(_0x1374ab,_0x2be085,_0x4bcf77)=>{return new Promise((_0x4b24fd,_0x4009da)=>{const _0x545938=db['prepare']('DELETE\x20FROM\x20'+_0x4bcf77+'\x20WHERE\x20username\x20=\x20?');_0x545938['run'](_0x2be085,function(_0x526ba5){_0x526ba5?_0x4009da(_0x526ba5):_0x4b24fd({'status':'success','changes':this['changes']});}),_0x545938['finalize']();});}),ipcMain['handle']('delete-account',async(_0x46cf8f,_0x12eee5)=>{const _0x4c94c1=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x4c94c1['run'](_0x12eee5,function(_0x553d9c){_0x553d9c&&console['log'](_0x553d9c);}),_0x4c94c1['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x5a75b3,_0x1e7489)=>{const _0xe1efbf='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0xe1efbf,[],(_0x2669c9,_0x49adb1)=>{_0x2669c9?_0x1e7489({'status':'error','message':_0x2669c9['message']}):_0x5a75b3({'status':'success','contactedCount':_0x49adb1['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x2a3845,_0x20da0f)=>{const _0x6826bb='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x6826bb,[],(_0x3b8480,_0x2608ab)=>{_0x3b8480?_0x20da0f({'status':'error','message':_0x3b8480['message']}):_0x2a3845({'status':'success','contactedCount':_0x2608ab['contactedCount']});});});});function exportDatabase(_0x593be6){return new Promise((_0x255327,_0x2b857d)=>{const _0x2803f3='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x593be6+'\x0a\x20\x20\x20\x20';db['all'](_0x2803f3,[],async(_0x119e3b,_0x5e7de5)=>{if(_0x119e3b){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x119e3b['message']),_0x2b857d(_0x119e3b);return;}if(!_0x5e7de5||_0x5e7de5['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x255327();return;}const _0x22c251=XLSX['utils']['json_to_sheet'](_0x5e7de5),_0x283451=XLSX['utils']['sheet_to_csv'](_0x22c251);try{const {canceled:_0xc1a8d3,filePath:_0xff2d01}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x593be6+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0xc1a8d3||!_0xff2d01){console['log']('Speichern\x20abgebrochen.'),_0x255327();return;}fs['writeFile'](_0xff2d01,_0x283451,'utf8',_0x55d4b6=>{_0x55d4b6?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x55d4b6['message']),_0x2b857d(_0x55d4b6)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0xff2d01),_0x255327());});}catch(_0x3b493b){console['error']('Fehler\x20im\x20Speicherdialog:',_0x3b493b),_0x2b857d(_0x3b493b);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x164f75,_0x24b06f)=>{shell['openExternal'](_0x24b06f);});A