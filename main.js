const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div',K_OPTIONS_BUTTON='section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.xs5motx\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD='div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f',K_SEND_MSG_BUTTON='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x3e379d=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x3e379d['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x3e379d['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x485d20){var _0x3abc12=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x423655){console['log']('window\x20id:'+_0x423655['id']),_0x423655['id']>0x1&&(_0x3abc12=!![]);}),console['log']('child\x20opened\x20='+_0x3abc12);if(!_0x3abc12){const _0x297084=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x297084['loadFile'](_0x485d20['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0);});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));});const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x50cf95='',_0x50c493=null;if(process['platform']==='darwin')_0x50cf95=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x50cf95=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x50cf95}),_0x50c493=await browser_login['newPage'](),_0x50c493['setDefaultNavigationTimeout'](0x1d4c),_0x50c493['setDefaultTimeout'](0x1d4c),_0x50c493;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x1ec6b0=0x1,_0xc5762e=0x0){let _0x1097ac='',_0xfb1f48=null;const _0x515784=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x1097ac=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x1097ac=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x1ec6b0===0x0&&!pageStack[_0xc5762e])return browser=await puppeteer['launch']({'headless':_0x515784,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x1097ac}),_0xfb1f48=await browser['newPage'](),_0xfb1f48['setDefaultNavigationTimeout'](0x1d4c),_0xfb1f48['setDefaultTimeout'](0x1d4c),pageStack[_0xc5762e]=_0xfb1f48,_0xfb1f48;return(browser===null||pageStack[_0xc5762e]===null||pageStack[_0xc5762e]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x515784,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x1097ac})),(pageStack[_0xc5762e]===null||pageStack[_0xc5762e]['isClosed']())&&(_0xfb1f48=await browser['newPage'](),_0xfb1f48['setDefaultNavigationTimeout'](0x1d4c),_0xfb1f48['setDefaultTimeout'](0x1d4c),pageStack[_0xc5762e]=_0xfb1f48),pageStack[_0xc5762e];}ipcMain['on']('login',async(_0x2e1b6c,_0x26ee51)=>{const _0x9daeea=await getBrowserPageLogin();await _0x9daeea['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x9daeea,_0x26ee51),ipcMain['on']('setLoginCookies',async(_0x40937c,_0x4035db)=>{try{await set_login_cookies(_0x9daeea,_0x4035db);}catch(_0x34945c){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x34945c);}});}),ipcMain['on']('export-relation',async(_0x3c7a6a,_0x3d520f)=>{try{await exportDatabase(_0x3d520f),_0x3c7a6a['reply']('export-relation-response',{'success':!![]});}catch(_0x52d1bc){console['error'](_0x52d1bc),_0x3c7a6a['reply']('export-relation-response',{'success':![],'message':_0x52d1bc['message']});}}),ipcMain['handle']('sendMessage',async(_0x3102df,_0x39bced,_0x51700c,_0x280cf4,_0x4c5e5e,_0x26f4de,_0x131dc6,_0xa98dd1)=>{isStopping=![];let _0x4ee6e8=null;return _0x131dc6?_0x4ee6e8=await getBrowserPage(_0x4c5e5e,_0xa98dd1):_0x4ee6e8=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x39bced),send_message(_0x4ee6e8,_0x39bced,_0x51700c,_0x280cf4,_0x4c5e5e,_0x26f4de);}),ipcMain['handle']('stop-action',async(_0x418a86,_0x2297ed)=>{isStopping=!![];const _0x5095e5=await getBrowserPage(0x1,_0x2297ed);await _0x5095e5['close']();}),ipcMain['handle']('fetch_followers',async(_0x3fe6f8,_0x39516d,_0x3a2913,_0x13a4c6,_0x84cb88,_0x21bd1b)=>{isStopping=![];const _0x33ce81=await getBrowserPage();return fetch_followers_from_account(_0x3fe6f8,_0x33ce81,_0x39516d,_0x3a2913,_0x13a4c6,_0x84cb88,_0x21bd1b);}),ipcMain['handle']('get-account-details',async(_0x10fd43,_0x3878a7,_0x5f5ac3,_0x2b9eb1)=>{isStopping=![];const _0x457546=await getBrowserPage();return fetch_account_details(_0x457546,_0x3878a7,_0x5f5ac3,_0x2b9eb1);}),ipcMain['handle']('fetch_likes',async(_0x1fb471,_0xbe7edf,_0x1f261b,_0x5592bd,_0xf69918,_0x448992)=>{isStopping=![];const _0x440282=await getBrowserPage();return fetch_likers_from_post(_0x1fb471,_0x440282,_0xbe7edf,_0x1f261b,_0x5592bd,_0xf69918,_0x448992);}),ipcMain['handle']('fetch_comments',async(_0x2574c2,_0x577750,_0x425c49,_0x4e42ec,_0x1a27e2,_0x11f547)=>{isStopping=![];const _0x5b0f69=await getBrowserPage();return fetch_comments_from_post(_0x2574c2,_0x5b0f69,_0x577750,_0x425c49,_0x4e42ec,_0x1a27e2,_0x11f547);}),ipcMain['handle']('update-app',async _0xb29361=>{const {spawn:_0x279639}=require('child_process'),_0x386fa4=require('path');return new Promise((_0x56bc47,_0x10b181)=>{(process['env']['NODE_ENV']==='development'||process['env']['SKIP_UPDATES']==='true')&&(console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x56bc47('Update\x20übersprungen'));if(process['platform']==='darwin'){const _0x15e5ba=_0x386fa4['join'](__dirname,'mac-updater-intern.sh'),_0x24f72e=_0x279639('/bin/bash',[_0x15e5ba]);_0x24f72e['stdout']['on']('data',_0x53aa9f=>{console['log']('stdout:\x20'+_0x53aa9f);}),_0x24f72e['stderr']['on']('data',_0x535327=>{console['error']('stderr:\x20'+_0x535327);}),_0x24f72e['on']('close',_0x132ac8=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x132ac8),_0x132ac8===0x0?_0x56bc47('Update\x20erfolgreich\x20abgeschlossen.'):_0x10b181(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x132ac8));});}else{if(process['platform']==='win32'){const _0x50b4a6=_0x386fa4['join'](__dirname,'../','../','../');process['chdir'](_0x50b4a6),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x381e90='soft-ui-updater-windows.ps1',_0x45dcae=_0x279639('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x381e90]);_0x45dcae['stdout']['on']('data',_0x5215a5=>{console['log']('stdout:\x20'+_0x5215a5);}),_0x45dcae['stderr']['on']('data',_0x380539=>{console['error']('stderr:\x20'+_0x380539);}),_0x45dcae['on']('close',_0x291283=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x291283),_0x291283===0x0?_0x56bc47('Update\x20erfolgreich\x20abgeschlossen.'):_0x10b181(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x291283));});}else _0x10b181(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}});});function getRnd(_0x456f71,_0x59baa9){return Math['random']()*(_0x59baa9-_0x456f71+0x1)+_0x456f71;}function delay(_0xeaaf71,_0x264c97){let _0x536aaf=getRnd(_0xeaaf71,_0x264c97);return new Promise(function(_0x2c459d){setTimeout(_0x2c459d,_0x536aaf);});}async function scroll(_0x3aa70a,_0x54ed09,_0x102bc7=0x2,_0x3b90a6){const _0x50815f=await _0x3aa70a['waitForSelector'](_0x54ed09);for(let _0x3b6f28=0x0;_0x3b6f28<_0x102bc7;_0x3b6f28++){console['log']('Scrolling\x20'+_0x3b6f28),await _0x3aa70a['evaluate'](_0x86aff8=>{const _0x3aa0a6=document['querySelector'](_0x86aff8);_0x3aa0a6&&_0x3aa0a6['scrollBy'](0x0,0x190);},_0x54ed09),await delay(0x320,0x5dc),_0x3b90a6();}}async function saveCookies(_0x5e3886){let _0xfaa26=await _0x5e3886['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0xfaa26,null,0x2));}async function notificationClear(_0x4b5c35){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x4b5c35['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x4b5c35['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x46e0d0){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x46e0d0);}}async function getTargetProfiles(_0x3c110d){return new Promise((_0x563e43,_0xbfbc47)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x3c110d,(_0x8350fe,_0x27c940)=>{_0x8350fe?_0xbfbc47(_0x8350fe):_0x563e43(_0x27c940);});});}async function login_legacy(_0x1359b3,_0x3c8186,_0xf44ad9){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x1359b3,_0x3c8186),await createUserIfNotExists(_0x3c8186,_0xf44ad9);}catch(_0x329f38){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x329f38);}try{await _0x1359b3['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x1359b3['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x1359b3['click']('button._a9--._ap36._a9_0');}catch(_0x143ec8){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x1359b3['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x1359b3['type']('input[name=\x27username\x27]',_0x3c8186,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x1359b3['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x1359b3['type']('input[name=\x27password\x27]',_0xf44ad9,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x1359b3['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x1359b3['click']('button[type=\x27submit\x27]');}catch(_0x576e45){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x1359b3),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x1359b3,_0x3c8186);}catch(_0x28b0ff){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x28b0ff);}}catch(_0x43a5ed){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x43a5ed);}}async function login(_0x3ba8ae,_0x46549d){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x3ba8ae,_0x46549d),await createUserIfNotExists(_0x46549d);}catch(_0x470266){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x470266);}try{await _0x3ba8ae['goto']('https://www.instagram.com/accounts/login/');}catch(_0xe0433f){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0xe0433f);}}async function set_login_cookies(_0x2946d0,_0x2188eb){try{await saveCookiesForUser(_0x2946d0,_0x2188eb);}catch(_0x523224){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x523224);}}async function waitForXPath(_0x54f415,_0x2e3b5b,_0x219b23={}){return await _0x54f415['waitForFunction'](_0x10d611=>{return document['evaluate'](_0x10d611,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x219b23,_0x2e3b5b),_0x54f415['evaluateHandle'](_0x73dbed=>document['evaluate'](_0x73dbed,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x2e3b5b);}async function send_message(_0x17d69f,_0x4e43af,_0x41ab04,_0x5d6de9,_0x432af1,_0x16c20b){return new Promise(async(_0x23f774,_0x33d48a)=>{_0x16c20b=_0x16c20b['split'](';'),console['log'](_0x16c20b[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x432af1);try{await setCookiesForUser(_0x17d69f,_0x16c20b[0x0]);}catch(_0x5b71de){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x5b71de),_0x33d48a({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x5b71de});return;}try{await _0x17d69f['goto']('https://www.instagram.com/'+_0x4e43af+'/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x17d69f);}catch(_0x3a4311){_0x33d48a({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x3a4311});return;}try{await _0x17d69f['waitForSelector'](K_DIRECT_MSG_BUTTON),await _0x17d69f['click'](K_DIRECT_MSG_BUTTON);}catch(_0x22f086){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x22f086);try{await _0x17d69f['waitForSelector'](K_OPTIONS_BUTTON),await _0x17d69f['click'](K_OPTIONS_BUTTON),await delay(0x1f4,0x320);const _0x1c2a8e=await waitForXPath(_0x17d69f,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x1c2a8e['click']();}catch(_0x5ef014){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x5ef014),_0x23f774({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x17d69f);}catch(_0x57899d){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x57899d);}try{const _0x3c9f7e=await _0x17d69f['waitForSelector'](K_CHAT_INPUT_FIELD),_0x3ce05b=await _0x17d69f['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x3ce05b),_0x5d6de9=_0x5d6de9['replace']('{USERNAME}',_0x4e43af);let _0x1fd930=_0x3ce05b['replace'](/[^\p{L}\s]/gu,''),_0x5bb79e=_0x1fd930['split']('\x20')[0x0];console['log']('Extrahierter\x20Clearname\x20mit\x20Len:\x20'+_0x5bb79e['length']+'nach\x20Split:\x20'+_0x5bb79e);_0x5bb79e['length']>0x2&&!_0x5bb79e['includes']('Instagram')?(_0x5d6de9=_0x5d6de9['replaceAll']('{NAME}',_0x5bb79e),_0x5d6de9=_0x5d6de9['replaceAll']('{name}',_0x5bb79e)):(_0x5d6de9=_0x5d6de9['replaceAll']('\x20{NAME}',''),_0x5d6de9=_0x5d6de9['replaceAll']('\x20{name}',''),_0x5d6de9=_0x5d6de9['replaceAll']('{NAME}',''),_0x5d6de9=_0x5d6de9['replaceAll']('{name}',''));await _0x3c9f7e['type'](_0x5d6de9,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0xdaf952=await _0x17d69f['waitForSelector'](K_SEND_MSG_BUTTON);await _0xdaf952['click'](),await delay(0x320,0x3e8),_0x23f774({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!'});}catch(_0x1f719e){try{await _0x17d69f['waitForSelector'](K_MSG_DISABLED_LABEL);const _0x48e3e4=await _0x17d69f['evaluate'](_0x4e16a5=>{return document['querySelector'](_0x4e16a5)['textContent'];},K_MSG_DISABLED_LABEL);console['log']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20gefunden:\x20'+_0x48e3e4),console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x1f719e),_0x23f774({'status':0x195,'message':'Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x4e43af+'\x20überspringen.'});}catch(_0x366b9a){console['error']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20nicht\x20gefunden:\x20'+_0x366b9a),console['error']('Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x4e43af+'\x20:\x20'+_0x366b9a),_0x23f774({'status':0x196,'message':'Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x4e43af+'\x20:\x20'+_0x366b9a});}}});}function handle_fail(_0x5e7f2f){if(isStopping)return new Promise(_0xa52c9f=>{_0xa52c9f('Scraper\x20gestoppt.');});else{let _0x264d7c='';switch(_0x5e7f2f){case 0x0:_0x264d7c='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x264d7c='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x264d7c='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x264d7c='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x451fc2,_0x262ef9)=>{_0x262ef9(_0x264d7c);});}}async function fetch_account_details(_0x54dc3e,_0x3da1bb,_0x4994e9,_0x446b78){try{await setCookiesForUser(_0x54dc3e,_0x4994e9['username']);}catch(_0xf0302e){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0xf0302e);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0xf0302e);return handle_fail(0x0);}_0x54dc3e['setDefaultNavigationTimeout'](0x7530),await _0x54dc3e['goto']('https://www.instagram.com/'+_0x3da1bb+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x54dc3e);const _0x65b728=await _0x54dc3e['evaluate'](()=>{const _0x1b5606=document['querySelector']('meta[property=\x22og:image\x22]');return _0x1b5606?_0x1b5606['getAttribute']('content'):null;});await _0x54dc3e['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x3bf195=await _0x54dc3e['evaluate'](()=>{const _0x1c0c95=document['querySelector']('meta[name=\x22description\x22]');if(!_0x1c0c95)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x37f251=_0x1c0c95['getAttribute']('content');if(!_0x37f251)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x37f251);const _0x15ed6e=/\s*[–-]\s*/,_0x58e254=_0x37f251['split'](_0x15ed6e);if(_0x58e254['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x3c2c20=_0x58e254[0x0],_0x1e3d9c=_0x58e254[0x1],_0x4c9cf8=_0x3c2c20['split'](',\x20');if(_0x4c9cf8['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0xd2adcb=_0x4c9cf8[0x0]['split']('\x20')[0x0],_0x594041=_0x4c9cf8[0x1]['split']('\x20')[0x0],_0x361e83=_0x4c9cf8[0x2]['split']('\x20')[0x0];let _0x578dfe='',_0x3189f7='';const _0x590542='\x20on\x20Instagram:\x20',_0xdea264=_0x1e3d9c['split'](_0x590542);return _0x578dfe=_0xdea264[0x0]['trim'](),_0x578dfe=_0x578dfe['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0xdea264['length']>0x1&&(_0x3189f7=_0xdea264[0x1]['trim'](),_0x3189f7['startsWith']('\x22')&&_0x3189f7['endsWith']('\x22')&&(_0x3189f7=_0x3189f7['substring'](0x1,_0x3189f7['length']-0x1)['trim']()),_0x3189f7=_0x3189f7['replace'](/&quot;/g,'')['trim']()),{'followers':_0xd2adcb,'following':_0x594041,'posts':_0x361e83,'nameText':_0x578dfe,'bio':_0x3189f7};});console['log']('Extracted\x20profile\x20data:',_0x3bf195);const _0x17e755=_0x3bf195['nameText'],_0x327906=_0x65b728,_0x266359=_0x3bf195['bio'],_0x4af015=_0x3bf195['followers'],_0x4cbb40=_0x3bf195['following'],_0x808996=_0x3bf195['posts'],_0x5f1732=![],_0x25c4d8=![],_0x5513cc=![],_0xe8f393='\x0a\x20\x20INSERT\x20INTO\x20'+_0x446b78+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0xe8f393,[_0x3da1bb,_0x17e755,_0x327906,_0x266359,_0x4af015,_0x4cbb40,_0x808996,_0x5f1732,_0x25c4d8,_0x5513cc],function(_0x499894){_0x499894?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x499894['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x26cdd3,_0x3e76f0,_0x2e16d8,_0x49de70,_0xbc543e,_0x8e6f0c,_0x4e58d7){let _0x52cce1=0x4,_0xe75683=0x0,_0x548261=0x0;try{await setCookiesForUser(_0x3e76f0,_0x8e6f0c['username']);}catch(_0x34af9c){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x34af9c);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x34af9c);return handle_fail(0x0);}let _0x5e4596=0x0;try{await _0x3e76f0['goto']('https://www.instagram.com/'+_0x2e16d8+'/'),await notificationClear(_0x3e76f0);try{if(_0x49de70<=0x0){const _0x8c885b=await _0x3e76f0['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x13f36c=await _0x3e76f0['evaluate'](_0x327b11=>_0x327b11['innerHTML'],_0x8c885b);_0x5e4596=Math['ceil'](_0x13f36c/0x4);}else _0x5e4596=Math['ceil'](_0x49de70/0x4);_0x52cce1+=_0x5e4596,_0x548261=Math['round'](++_0xe75683/_0x52cce1*0x64),_0x26cdd3['sender']['send']('fetch-progress',_0x548261,!![]);let _0x23f9ff=await _0x3e76f0['waitForSelector']('a[href=\x22/'+_0x2e16d8+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x23f9ff['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x2e16d8+'\x20gesichtet'),_0x548261=Math['round'](++_0xe75683/_0x52cce1*0x64),_0x26cdd3['sender']['send']('fetch-progress',_0x548261,!![]);}catch(_0x5af23f){console['log']('Follower\x20Liste\x20von\x20'+_0x2e16d8+'\x20nicht\x20gefunden:'+_0x5af23f);throw new Error('Follower\x20Liste\x20von\x20'+_0x2e16d8+'\x20nicht\x20gefunden:'+_0x5af23f);return handle_fail(0x0);}}catch(_0x554541){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x554541);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x554541);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x5e4596),await scroll(_0x3e76f0,FOLLOWER_FENSTER,_0x5e4596,_0x559670=>{_0x548261=Math['round'](++_0xe75683/_0x52cce1*0x64),_0x26cdd3['sender']['send']('fetch-progress',_0x548261,!![]);}),await _0x3e76f0['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x34a7cc=await _0x3e76f0['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x3a0ef2=await _0x3e76f0['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x548261=Math['round'](++_0xe75683/_0x52cce1*0x64),_0x26cdd3['sender']['send']('fetch-progress',_0x548261,!![]);_0x49de70<=0x0&&(_0x49de70=_0x34a7cc['length']);let _0x5941cc=[];for(let _0x34e664=0x0;_0x34e664<_0x34a7cc['length']&&_0x34e664<_0x49de70;_0x34e664++){_0x5941cc['push'](await _0x34a7cc[_0x34e664]['evaluate'](_0x1f444c=>_0x1f444c['textContent']));const _0x54a589='INSERT\x20INTO\x20'+_0xbc543e+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x54a589,[await _0x34a7cc[_0x34e664]['evaluate'](_0x4c1f2c=>_0x4c1f2c['textContent']),await _0x3a0ef2[_0x34e664]['evaluate'](_0x54054c=>_0x54054c['textContent'])],function(_0x4c9875){_0x4c9875?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0xbc543e+'\x27:',_0x4c9875['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x548261=Math['round'](++_0xe75683/_0x52cce1*0x64),_0x26cdd3['sender']['send']('fetch-progress',_0x548261,!![]),_0x4e58d7&&(_0x26cdd3['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x26cdd3,_0x3e76f0,_0x8e6f0c,_0xbc543e,_0x5941cc)),new Promise(_0x3bb84c=>{_0x3bb84c('Scraping\x20finished!');});}catch(_0x3c5b22){if(_0x4e58d7)throw new Error(_0x3c5b22);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x2e16d8+'\x20nicht\x20gefunden:\x20'+_0x3c5b22);return handle_fail(0x0);}}async function fetch_details_from_list(_0x712068,_0x212fec,_0x4843bc,_0x3c2822,_0x306718){let _0xc52378=0x0,_0x30e732=0x0;for(let _0xb1edfe=0x0;_0xb1edfe<_0x306718['length'];_0xb1edfe++){console['log']('Processing\x20profile:',_0x306718[_0xb1edfe]);try{await fetch_account_details(_0x212fec,_0x306718[_0xb1edfe],_0x4843bc,_0x3c2822);}catch(_0x46c125){console['error']('Detailed\x20Scraping\x20von:\x20',_0x306718[_0xb1edfe],_0x46c125);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x306718[_0xb1edfe]+'\x20'+_0x46c125);}_0x30e732=Math['round'](++_0xc52378/_0x306718['length']*0x64),_0x712068['sender']['send']('fetch-progress',_0x30e732,!![],!![]);}}async function fetch_likers_from_post(_0x3c22c1,_0x5ee84a,_0x53b8c7,_0x1fc035,_0x250feb,_0x1581f8,_0x3a6dd0){let _0x1d4d22=0x4,_0x3b924c=0x0,_0x45b5b3=0x0;try{await setCookiesForUser(_0x5ee84a,_0x1581f8['username']);}catch(_0x3d13bc){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x3d13bc);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x3d13bc);return handle_fail(0x1);return;}_0x45b5b3=Math['round'](++_0x3b924c/_0x1d4d22*0x64),_0x3c22c1['sender']['send']('fetch-progress',_0x45b5b3,!![]);try{let _0x4cd018=_0x53b8c7['substring'](0x0,_0x53b8c7['lastIndexOf']('/')),_0xc6f05f=_0x4cd018+'/liked_by';console['log'](_0xc6f05f),await _0x5ee84a['goto'](_0xc6f05f),await delay(0x7d0,0xfa0),await notificationClear(_0x5ee84a),await delay(0xc8,0x1f4),_0x45b5b3=Math['round'](++_0x3b924c/_0x1d4d22*0x64),_0x3c22c1['sender']['send']('fetch-progress',_0x45b5b3,!![]),await _0x5ee84a['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x3d7e98=await _0x5ee84a['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x495f91=await _0x5ee84a['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x3d7e98['length']);let _0x5b464b=path['join'](__dirname,'/likers.csv');_0x45b5b3=Math['round'](++_0x3b924c/_0x1d4d22*0x64),_0x3c22c1['sender']['send']('fetch-progress',_0x45b5b3,!![]);_0x1fc035<=0x0&&(_0x1fc035=_0x3d7e98['length']);try{let _0x226b04=[];for(let _0x37962a=0x0;_0x37962a<_0x3d7e98['length']&&_0x37962a<_0x1fc035;_0x37962a++){_0x226b04['push'](await _0x3d7e98[_0x37962a]['evaluate'](_0x50f876=>_0x50f876['textContent']));try{const _0x574250='INSERT\x20INTO\x20'+_0x250feb+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x574250,[await _0x3d7e98[_0x37962a]['evaluate'](_0x3d0004=>_0x3d0004['textContent']),await _0x495f91[_0x37962a]['evaluate'](_0x5bdb82=>_0x5bdb82['textContent'])],function(_0x54f6bc){_0x54f6bc?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x250feb+'\x27:',_0x54f6bc['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x5064ca){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x37962a+'\x20:\x20'+_0x5064ca);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x37962a+'\x20:\x20'+_0x5064ca);return handle_fail(0x1);}}return _0x45b5b3=Math['round'](++_0x3b924c/_0x1d4d22*0x64),_0x3c22c1['sender']['send']('fetch-progress',_0x45b5b3,!![]),_0x3a6dd0&&(_0x3c22c1['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x3c22c1,_0x5ee84a,_0x1581f8,_0x250feb,_0x226b04)),new Promise(_0x3e496d=>{_0x3e496d('Scraping\x20finished!');});}catch(_0x5f6e6a){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x5f6e6a);return handle_fail(0x1);}}catch(_0x1d99f0){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x1d99f0);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x1d99f0);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x2cd5a7,_0x4b0519,_0x3187ab,_0x3d5cf5,_0xd2fde5,_0x44e147,_0x527a25){let _0x163a79=0x3,_0x15f139=0x0,_0x3ddc92=0x0;try{await setCookiesForUser(_0x4b0519,_0x44e147['username']);}catch(_0x16046b){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x16046b);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x16046b);return handle_fail(0x2);}try{console['log'](_0x3187ab),await _0x4b0519['goto'](_0x3187ab),await delay(0x7d0,0xfa0),await notificationClear(_0x4b0519),await delay(0xc8,0x1f4);const _0x4560cc=COM_COMMENTS_BOX_BODY_DIV;let _0x144187;const _0x101ff2=await _0x4b0519['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x5a192a=await _0x4b0519['evaluate'](_0x4b6c5f=>_0x4b6c5f['innerHTML'],_0x101ff2),_0x3f7e09=String(_0x5a192a)['replace'](/[^0-9]/g,''),_0x1aeb19=Number(_0x3f7e09)/0x14;_0x3d5cf5<=0x0?_0x144187=Math['ceil'](_0x1aeb19/0x3):_0x144187=Math['ceil'](_0x3d5cf5/0x3);_0x163a79+=_0x144187,_0x3ddc92=Math['round'](++_0x15f139/_0x163a79*0x64),_0x2cd5a7['sender']['send']('fetch-progress',_0x3ddc92,!![]),console['log']('Auto-scrolls:\x20'+_0x144187),await scroll(_0x4b0519,_0x4560cc,_0x144187,_0x15e52f=>{_0x3ddc92=Math['round'](++_0x15f139/_0x163a79*0x64),_0x2cd5a7['sender']['send']('fetch-progress',_0x3ddc92,!![]);});try{const _0x5bfa97=COM_REPLY_BUTTON_SPAN;await _0x4b0519['waitForSelector'](_0x5bfa97),await delay(0x1f4,0x320);const _0x385e74=await _0x4b0519['$$'](_0x5bfa97);console['log'](_0x385e74);let _0x4480b4=_0x385e74['length'];await delay(0xc8,0x1f4);try{for(let _0x13148f=0x0;_0x13148f<_0x4480b4;_0x13148f++){_0x385e74[_0x13148f]['click'](),await delay(0x320,0x5dc);}}catch(_0x2846ef){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x2846ef);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x2846ef);return handle_fail(0x2);}}catch(_0x5d0a33){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x274365=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x4b0519['waitForSelector'](_0x274365),await delay(0x1f4,0x320),_0x3ddc92=Math['round'](++_0x15f139/_0x163a79*0x64),_0x2cd5a7['sender']['send']('fetch-progress',_0x3ddc92,!![]);const _0x283f54=await _0x4b0519['$$'](_0x274365);let _0x5ecafd=path['join'](__dirname,'/comments.csv');_0x3d5cf5<=0x0&&(_0x3d5cf5=_0x283f54['length']);console['log']('fetch_limit:\x20'+_0x3d5cf5),console['log']('comments_len:\x20'+_0x283f54['length']),_0x3d5cf5++;try{let _0x3febfa=[];for(let _0x51c67e=0x1;_0x51c67e<_0x283f54['length']&&_0x51c67e<_0x3d5cf5;_0x51c67e++){try{_0x3febfa['push'](await _0x283f54[_0x51c67e]['evaluate'](_0x587f18=>_0x587f18['textContent']));const _0x40eaf1=await db['prepare']('INSERT\x20INTO\x20'+_0xd2fde5+'\x20(username)\x20VALUES\x20(?)');await _0x40eaf1['run'](await _0x283f54[_0x51c67e]['evaluate'](_0x518820=>_0x518820['textContent']),function(_0x3062ce){_0x3062ce&&console['log']('error\x20in\x20add-user:'+_0x3062ce);}),await _0x40eaf1['finalize']();}catch(_0x13a83e){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x51c67e+'\x20:\x20'+_0x13a83e);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x51c67e+'\x20:\x20'+_0x13a83e);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x3ddc92=Math['round'](++_0x15f139/_0x163a79*0x64),_0x2cd5a7['sender']['send']('fetch-progress',_0x3ddc92,!![]),_0x2cd5a7['sender']['send']('fetch-progress',0x64,!![]),_0x527a25&&(_0x2cd5a7['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x2cd5a7,_0x4b0519,_0x44e147,_0xd2fde5,_0x3febfa)),_0x2cd5a7['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x48a32d=>{_0x48a32d('Scraping\x20finished!');});}catch(_0x8dfba4){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x8dfba4);return handle_fail(0x2);}}catch(_0x36453d){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x36453d);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x36453d);return handle_fail(0x2);}}async function set_clearname_from_username(_0xc41b55,_0x3eb02d,_0x303a41=null){try{let _0x5255e3,_0x169459;const _0x4da647='SELECT\x20username\x20FROM\x20'+_0x3eb02d+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x4da647,[],(_0x3fa93a,_0x1c12bf)=>{_0x3fa93a&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x3fa93a['message']),_0x1c12bf['length']===0x0&&(_0x169459=_0x1c12bf['length']),_0x5255e3=_0x1c12bf['map'](_0x39497d=>_0x39497d['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x169459);if(_0x169459===0x0){console['log']('Leave');return;}const _0xd03547=await _0xc41b55['waitForSelector'](IG_SEARCH_BUTTON);await _0xd03547['click'](),await delay(0x4b0,0x7d0);for(let _0x2e11aa of _0x5255e3){const _0x3d597a=await _0xc41b55['waitForSelector'](IG_SEARCH_INPUT);await _0x3d597a['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0xc41b55['type'](IG_SEARCH_INPUT,_0x2e11aa,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x299072=0x1;while(_0x299072!=0x14){console['log']('Schleife');try{let _0x58168d=IG_NAME_SPAN_PART1+_0x299072+IG_USERNAME_SPAN_PART2;const _0x440ae9=await _0xc41b55['waitForSelector'](_0x58168d),_0xf46938=await _0xc41b55['evaluate'](_0x2d5293=>_0x2d5293['innerHTML'],_0x440ae9);await delay(0xc8,0x1f4);if(_0xf46938==_0x2e11aa){let _0x283e11=IG_NAME_SPAN_PART1+_0x299072+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0xb4c29c=await _0xc41b55['waitForSelector'](_0x283e11);let _0x3a20f6=await _0xc41b55['evaluate'](_0x1a7e41=>_0x1a7e41['innerHTML'],_0xb4c29c);const _0x16c68c=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x12c002=_0x3a20f6['match'](_0x16c68c);_0x12c002?_0x3a20f6=_0x12c002[0x1]['trim']():_0x3a20f6=_0x3a20f6['trim']();_0x3a20f6['includes']('•')&&(_0x3a20f6=_0x3a20f6['substring'](0x0,_0x3a20f6['indexOf']('•')-0x1));const _0xf347e9='UPDATE\x20'+_0x3eb02d+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0xf347e9,[_0x3a20f6,_0xf46938],function(_0x2b0a7b){_0x2b0a7b&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x2b0a7b['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x299072++;}catch(_0x5840e2){const _0x44681a='UPDATE\x20'+_0x3eb02d+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x44681a,['',_0x2e11aa],function(_0x5ecb3d){_0x5ecb3d&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x5ecb3d['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x5840e2);break;}}_0x303a41&&_0x303a41();}await _0xd03547['click']();}catch(_0x8f9cb){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x8f9cb);}}const campaignPath=path['resolve'](__dirname,'data/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(campaign_name\x20TEXT\x20PRIMARY\x20KEY,\x20list_id\x20TEXT,\x20zeitabstand\x20REAL,\x20message_id\x20TEXT,\x20account\x20TEXT,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x387138,_0x23b34d)=>{const _0xa8a89c='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0xa8a89c,[],(_0x37b568,_0x32214c)=>{_0x37b568?_0x23b34d(_0x37b568):_0x387138(_0x32214c);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0xc7efac,_0x534e4d)=>{const _0x2a97a5='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x2a97a5,[],async(_0x208eb1,_0x282fbd)=>{if(_0x208eb1)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x208eb1['message']),_0x534e4d({'status':'error','message':_0x208eb1['message']});else try{const _0x5dafd1=await Promise['all'](_0x282fbd['map'](_0x2d7541=>{return new Promise(_0x2022a9=>{if(!_0x2d7541['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x2d7541['campaign_name']),_0x2022a9({'campaign_name':_0x2d7541['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x40143e='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x2d7541['list_id'],_0x5042ec='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x2d7541['list_id']+'\x22';db['get'](_0x40143e,[],(_0x425540,_0x1527fc)=>{_0x425540?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x2d7541['campaign_name']+':',_0x425540['message']),_0x2022a9({'campaign_name':_0x2d7541['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x5042ec,[],(_0x36f836,_0x1a4812)=>{_0x36f836?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x2d7541['campaign_name']+':',_0x36f836['message']),_0x2022a9({'campaign_name':_0x2d7541['campaign_name'],'lead_count':_0x1527fc?_0x1527fc['lead_count']:0x0,'contacted_count':'N/A'})):_0x2022a9({'campaign_name':_0x2d7541['campaign_name'],'lead_count':_0x1527fc?_0x1527fc['lead_count']:0x0,'contacted_count':_0x1a4812?_0x1a4812['contacted_count']:0x0});});});});}));_0xc7efac({'status':'success','campaigns':_0x5dafd1});}catch(_0x3b320f){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x3b320f),_0x534e4d({'status':'error','message':_0x3b320f['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x1bb8f9,_0x50c9b8)=>{return new Promise((_0x494be6,_0x3a3260)=>{const _0x596121='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x596121,[_0x50c9b8],(_0x3fe71e,_0x2bf237)=>{_0x3fe71e?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x3fe71e),_0x3a3260(_0x3fe71e)):(console['log']('ROWS'),console['log'](_0x2bf237),debugDatabaseContents(),_0x494be6(_0x2bf237));});});});const showTableContents=_0x319817=>{return new Promise((_0x322e81,_0x202333)=>{const _0x57ede7='SELECT\x20*\x20FROM\x20'+_0x319817+';';campaignDB['all'](_0x57ede7,(_0x2c9c4f,_0x132ad7)=>{_0x2c9c4f?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x319817+':',_0x2c9c4f),_0x202333(_0x2c9c4f)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x319817+':',_0x132ad7),_0x322e81({'status':'success','message':_0x132ad7}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x18c7fb){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x18c7fb);}}ipcMain['handle']('create-campaign',async(_0x523cf7,_0x83c2e5)=>{return new Promise((_0x26abb9,_0x166975)=>{const _0x1f926c='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x1f926c,[String(_0x83c2e5)],function(_0x1eab93){_0x1eab93?_0x166975(_0x1eab93):_0x26abb9({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x508059,_0x41683d)=>{return new Promise((_0x2ee7cf,_0x2fd850)=>{const _0x40b20a='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x40b20a,[_0x41683d],function(_0x4d1aa1){_0x4d1aa1?_0x2fd850(_0x4d1aa1):_0x2ee7cf({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x46da36,_0x437655,_0x416427,_0x3a0855,_0x5931ba,_0xca5f30)=>{const _0x265641=await createMessageID(_0x5931ba);return new Promise((_0x2e5bd7,_0x5a472f)=>{if(!_0x437655||!_0x416427||!_0x3a0855||!_0x265641||!_0xca5f30)return _0x5a472f({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x265641);const _0x2a41f2='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x2a41f2,[_0x416427,_0x3a0855,_0x265641,_0xca5f30,_0x437655],function(_0x363c5b){if(_0x363c5b)_0x5a472f({'status':'error','message':_0x363c5b['message']});else this['changes']===0x0?_0x5a472f({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x2e5bd7({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x3cc6f9,_0x2409af,_0x508022,_0x1d3665,_0x358ad5)=>{return new Promise((_0x28d7f6,_0x5b5ed0)=>{const _0x4774fe='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x4774fe,[_0x2409af,_0x508022,_0x1d3665,_0x358ad5],function(_0x138766){return _0x138766?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x138766['message']),_0x5b5ed0('insert-dm-response',{'success':![],'message':_0x138766['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x28d7f6('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0xfba569=>{return new Promise((_0x582b21,_0x4b7676)=>{const _0xeda033='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0xeda033,[_0xfba569],(_0x21e4b2,_0x132961)=>{if(_0x21e4b2)_0x4b7676({'status':'error','message':_0x21e4b2['message']});else{if(_0x132961)_0x582b21(_0x132961['message_id']);else{const _0x1f2e35='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x1f2e35,[_0xfba569],function(_0x58efc8){_0x58efc8?_0x4b7676({'status':'error','message':_0x58efc8['message']}):_0x582b21(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x54ce81,_0x2fabd9)=>{return new Promise((_0x2fa74f,_0x4058be)=>{const _0x42ed95='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x2fabd9;db['get'](_0x42ed95,(_0x5e2ade,_0x146758)=>{_0x5e2ade?_0x4058be({'status':'error','message':_0x5e2ade['message']}):_0x2fa74f({'status':'success','count':_0x146758['count']});});});});const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x1b5784,_0x50deef){try{const _0x18f2bb=await new Promise((_0x350068,_0x3c1fa0)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x50deef],(_0x318b71,_0x512089)=>{if(_0x318b71)_0x3c1fa0(_0x318b71);else{if(_0x512089['length']>0x0){let _0x1b7634=JSON['parse'](_0x512089[0x0]['cookie']);console['log'](_0x1b7634),_0x350068(_0x1b7634);}else _0x3c1fa0(new Error('User\x20with\x20username\x20'+_0x50deef+'\x20does\x20not\x20exist.'));}});});await _0x1b5784['setCookie'](..._0x18f2bb),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x5f2df5){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x5f2df5);}}async function saveCookiesForUser(_0x432557,_0x50e8f4){try{const _0x49f47e=await _0x432557['cookies']();if(!_0x49f47e||_0x49f47e['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x50e8f4);const _0x224b0d=JSON['stringify'](_0x49f47e);if(_0x224b0d['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x50e8f4);return new Promise((_0x302df9,_0x785510)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x50e8f4],(_0x9eb76a,_0x35a4e2)=>{if(_0x9eb76a)return console['error']('Error\x20checking\x20user\x20existence:',_0x9eb76a),_0x785510(_0x9eb76a);if(_0x35a4e2){const _0x2f03fb=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x2f03fb['run'](_0x224b0d,_0x50e8f4,function(_0x79e1aa){return _0x79e1aa?(console['error']('Error\x20updating\x20cookies:',_0x79e1aa),_0x785510(_0x79e1aa)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x50e8f4),_0x302df9());});}else{const _0x3696f5=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x3696f5['run'](_0x50e8f4,_0x224b0d,function(_0x5584fe){return _0x5584fe?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x5584fe),_0x785510(_0x5584fe)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x50e8f4),_0x302df9());});}});});}catch(_0x1b3b14){console['error']('Error\x20fetching\x20cookies:',_0x1b3b14);throw _0x1b3b14;}}async function createUserIfNotExists(_0x2aa5a9){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x2aa5a9],(_0x3f0ba7,_0x438460)=>{if(_0x3f0ba7){console['error']('Error\x20checking\x20user\x20existence:',_0x3f0ba7);throw _0x3f0ba7;}else{if(!_0x438460){const _0x2a39f1=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x2a39f1['run'](_0x2aa5a9,function(_0x3d220a){_0x3d220a?console['error']('Error\x20inserting\x20new\x20user:',_0x3d220a):console['log']('New\x20user\x20created:',_0x2aa5a9);});}else console['log']('User\x20already\x20exists:',_0x2aa5a9);}});}catch(_0x12af39){console['error']('Error\x20creating\x20user:',_0x12af39);throw _0x12af39;}}ipcMain['handle']('create-relation',async(_0x40bf68,_0x582107)=>{return new Promise((_0x1c1033,_0x1da578)=>{const _0x5ed370='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x582107+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x5ed370,function(_0x302d4d){_0x302d4d?_0x1da578(_0x302d4d):_0x1c1033({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x5a7f28,_0x27afd9)=>{return console['log']('droping\x20table'+_0x27afd9),new Promise((_0x35084b,_0x4ce940)=>{const _0x26383a='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x27afd9;console['log']('droping\x20table'+_0x27afd9),db['run'](_0x26383a,function(_0x3f0e29){_0x3f0e29?_0x4ce940(_0x3f0e29):_0x35084b({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x1f4812=>{return new Promise((_0x46ba1a,_0x5d14e1)=>{const _0x4780a1='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x4780a1,[],(_0x2d564b,_0x52cd59)=>{_0x2d564b?_0x5d14e1(_0x2d564b):_0x46ba1a(_0x52cd59['map'](_0x33b1b1=>_0x33b1b1['name']));});});}),ipcMain['handle']('add-user',async(_0x3ed436,_0x194758,_0x58b920)=>{return new Promise(_0x5959ed=>{const _0x56138c=db['prepare']('INSERT\x20INTO\x20'+_0x58b920+'\x20(username)\x20VALUES\x20(?)');_0x56138c['run'](_0x194758,function(_0x4e4e71){_0x4e4e71?console['log']('error\x20in\x20add-user:'+_0x4e4e71):_0x5959ed({'status':'success','id':this['lastID']});}),_0x56138c['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x353803,_0x72087e)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0xa1251,_0x3aa17e)=>{if(_0xa1251)_0x72087e(_0xa1251);else{_0x353803({'status':'success','users':_0x3aa17e});for(_0x3aa17e of _0x3aa17e){console['log'](_0x3aa17e['username']);}}});});}),ipcMain['handle']('get-data',async(_0x5b7405,_0xc3b046)=>{return new Promise((_0x1c37be,_0x12955c)=>{const _0x7bdc50='SELECT\x20*\x20FROM\x20'+_0xc3b046;console['log'](_0x7bdc50),db['all'](_0x7bdc50,[],(_0x264e3c,_0x37d7c0)=>{_0x264e3c?_0x12955c(_0x264e3c):_0x1c37be(_0x37d7c0);});});}),ipcMain['handle']('get-accounts',async _0x12fbfa=>{return new Promise((_0x57706a,_0x341c84)=>{const _0x5b2af1='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x5b2af1),igaccountsDB['all'](_0x5b2af1,[],(_0x73c47d,_0x3db2a3)=>{_0x73c47d?_0x341c84(_0x73c47d):_0x57706a(_0x3db2a3);});});}),ipcMain['handle']('get-targets',async(_0x2adf92,_0x564392)=>{return getTargetProfiles(_0x564392);}),ipcMain['handle']('delete-user',async(_0xe606ff,_0x61616,_0x456daf)=>{return new Promise((_0x5d3d05,_0x5249e4)=>{const _0x4259ff=db['prepare']('DELETE\x20FROM\x20'+_0x456daf+'\x20WHERE\x20username\x20=\x20?');_0x4259ff['run'](_0x61616,function(_0x343462){_0x343462?_0x5249e4(_0x343462):_0x5d3d05({'status':'success','changes':this['changes']});}),_0x4259ff['finalize']();});}),ipcMain['handle']('delete-account',async(_0x1bda7b,_0x84aad1)=>{const _0x23fa10=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x23fa10['run'](_0x84aad1,function(_0x587803){_0x587803&&console['log'](_0x587803);}),_0x23fa10['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x33e5d6,_0x1ec5a9)=>{const _0x3847ee='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x3847ee,[],(_0x798667,_0x150600)=>{_0x798667?_0x1ec5a9({'status':'error','message':_0x798667['message']}):_0x33e5d6({'status':'success','contactedCount':_0x150600['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x4f7498,_0x163104)=>{const _0x833013='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x833013,[],(_0x416dc4,_0x5af491)=>{_0x416dc4?_0x163104({'status':'error','message':_0x416dc4['message']}):_0x4f7498({'status':'success','contactedCount':_0x5af491['contactedCount']});});});});function exportDatabase(_0x3287e9){return new Promise((_0x500b0f,_0x3f6fe7)=>{const _0x54b24c='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x3287e9+'\x0a\x20\x20\x20\x20';db['all'](_0x54b24c,[],async(_0x4e1f90,_0x27cb3d)=>{if(_0x4e1f90){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x4e1f90['message']),_0x3f6fe7(_0x4e1f90);return;}if(!_0x27cb3d||_0x27cb3d['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x500b0f();return;}const _0x4088ab=XLSX['utils']['json_to_sheet'](_0x27cb3d),_0x16f5fb=XLSX['utils']['sheet_to_csv'](_0x4088ab);try{const {canceled:_0x309b4c,filePath:_0x246be1}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x3287e9+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x309b4c||!_0x246be1){console['log']('Speichern\x20abgebrochen.'),_0x500b0f();return;}fs['writeFile'](_0x246be1,_0x16f5fb,'utf8',_0x474723=>{_0x474723?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x474723['message']),_0x3f6fe7(_0x474723)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x246be1),_0x500b0f());});}catch(_0x4047c6){console['error']('Fehler\x20im\x20Speicherdialog:',_0x4047c6),_0x3f6fe7(_0x4047c6);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x59c36f,_0x12faee)=>{shell['openExternal'](_0x12faee);});