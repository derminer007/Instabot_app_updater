const {app,BrowserWindow,ipcMain,dialog}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),sqlite3=require('sqlite3')['verbose']();function createWindow(){const _0x1d5444=new BrowserWindow({'width':0x320,'height':0x258,'webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x1d5444['loadFile'](path['join'](__dirname,'index.html'));}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x1981e4){var _0x3af192=![];BrowserWindow['getAllWindows']()['forEach'](function(_0xa26aa8){console['log']('window\x20id:'+_0xa26aa8['id']),_0xa26aa8['id']>0x1&&(_0x3af192=!![]);}),console['log']('child\x20opened\x20='+_0x3af192);if(!_0x3af192){const _0x5b8a0f=new BrowserWindow({'width':0x320,'height':0x258,'webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x5b8a0f['loadFile'](_0x1981e4['url']);}else console['log']('child\x20window\x20opened\x20already');}let browser=null,page=null;async function getBrowserPage(){let _0x31d78f='';if(process['platform']==='darwin')_0x31d78f='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome';else{if(process['platform']==='win32')_0x31d78f='chromium_local/chrome-win/chrome.exe';else{if(process['platform']==='linux'){}}}return(browser===null||page['isClosed']())&&(browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0x31d78f})),(page===null||page['isClosed']())&&(page=await browser['newPage'](),page['setDefaultNavigationTimeout'](0x1d4c),page['setDefaultTimeout'](0x1d4c)),page;}ipcMain['on']('login',async(_0x4fd966,_0x3ac45b,_0x3d4bba)=>{const _0x2eafc2=await getBrowserPage();await _0x2eafc2['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x2eafc2,_0x3ac45b,_0x3d4bba),setTimeout(async()=>{await browser['close']();},0x1388);}),ipcMain['handle']('sendMessage',async(_0x5982eb,_0x2bab4d,_0x53299d,_0x137ab9,_0x277566)=>{const _0x556671=await getBrowserPage();return console['log']('send\x20Message\x20gestartet'),console['log'](_0x2bab4d),new Promise((_0x235c77,_0x586872)=>{send_message(_0x556671,_0x2bab4d,_0x53299d,_0x137ab9,_0x277566)['then'](_0x3cd87c=>_0x235c77(_0x3cd87c))['catch'](_0x51b7a3=>_0x586872(_0x51b7a3));});}),ipcMain['on']('fetch_followers',async(_0x3f2137,_0x39e3e1,_0x58217e,_0x17366c,_0x881790)=>{const _0x54fb4a=await getBrowserPage();await fetch_followers_from_account(_0x54fb4a,_0x39e3e1,_0x58217e,_0x17366c,_0x881790);}),ipcMain['on']('fetch_likes',async(_0xa8d6ca,_0x467d32,_0x393775,_0x4e86fc,_0x4c98b0)=>{const _0x59ff34=await getBrowserPage();await fetch_likers_from_post(_0x59ff34,_0x467d32,_0x393775,_0x4e86fc,_0x4c98b0);}),ipcMain['on']('fetch_comments',async(_0x195a10,_0x5dca15,_0x427498,_0x5cf32a,_0x1a7fb9)=>{const _0xab562e=await getBrowserPage();await fetch_comments_from_post(_0xab562e,_0x5dca15,_0x427498,_0x5cf32a,_0x1a7fb9);});function getRnd(_0x34d58a,_0x42db50){return Math['random']()*(_0x42db50-_0x34d58a+0x1)+_0x34d58a;}function delay(_0x52b068,_0x3988ce){let _0x3bbea5=getRnd(_0x52b068,_0x3988ce);return new Promise(function(_0x3e9df3){setTimeout(_0x3e9df3,_0x3bbea5);});}async function scroll(_0x248638,_0x44822f,_0x382ee0=0x2){const _0x2d1300=await _0x248638['waitForSelector'](_0x44822f);for(let _0x3f770d=0x0;_0x3f770d<_0x382ee0;_0x3f770d++){console['log']('Scrolling\x20'+_0x3f770d),await _0x248638['evaluate'](_0x266c16=>{const _0x2c5675=document['querySelector'](_0x266c16);_0x2c5675&&_0x2c5675['scrollBy'](0x0,0x190);},_0x44822f),await delay(0xc8,0x1f4);}}async function saveCookies(_0x509224){let _0x546983=await _0x509224['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x546983,null,0x2));}async function notificationClear(_0x5959bb){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x5959bb['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x5959bb['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x15ac8c){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x15ac8c);}}async function getTargetProfiles(_0x729616){return new Promise((_0x4d2aac,_0x3e0f61)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x729616,(_0x3b73b6,_0x1f9abd)=>{_0x3b73b6?_0x3e0f61(_0x3b73b6):_0x4d2aac(_0x1f9abd);});});}async function login(_0x200ab8,_0x37998e,_0x518dcb){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x200ab8,_0x37998e),await createUserIfNotExists(_0x37998e,_0x518dcb);}catch(_0x2404e1){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x2404e1);}try{await _0x200ab8['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x200ab8['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x200ab8['click']('button._a9--._ap36._a9_0');}catch(_0x14684d){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x200ab8['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x200ab8['type']('input[name=\x27username\x27]',_0x37998e,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x200ab8['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x200ab8['type']('input[name=\x27password\x27]',_0x518dcb,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x200ab8['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x200ab8['click']('button[type=\x27submit\x27]');}catch(_0x1a1784){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x200ab8),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x200ab8,_0x37998e);}catch(_0x26f844){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x26f844);}}catch(_0x1445b1){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x1445b1);}}async function send_message(_0x30e679,_0x4a5749,_0x1fddbe,_0x49aeaf,_0x5bd992){console['log'](_0x5bd992),console['log']('Anfang'),console['log']('Counter:\x20'+_0x49aeaf);if(_0x49aeaf==0x0){try{console['log'](_0x5bd992),await login(_0x30e679,_0x5bd992['username'],_0x5bd992['password']);}catch(_0x40462e){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x40462e);return;}await _0x30e679['goto']('https://www.instagram.com/direct/inbox/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x30e679);}try{try{const _0x104d54='div.x1i10hfl.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.x6s0dn4.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x1ypdohk.x78zum5.xl56j7k.x1y1aw1k.x1sxyh0.xwib8y2.xurb0ha.xcdnw81';await delay(0xfa0,0x1d4c),await _0x30e679['waitForSelector'](_0x104d54),await _0x30e679['click'](_0x104d54),console['log']('Message-Button\x20geklickt'),console['log'](_0x4a5749+'\x20'+_0x1fddbe),await delay(0xfa0,0x1d4c);try{const _0x14113a='input[name=\x22queryBox\x22]',_0x2f4b66='body\x20>\x20div.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x1k90msu.x6o7n8i.x1qfuztq.x10l6tqk.x17qophe.x13vifvy.x1hc1fzr.x71s49j.xh8yej3\x20>\x20div\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.x1q0g3np.x1a02dak.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20input';await _0x30e679['waitForSelector'](_0x2f4b66),await _0x30e679['click'](_0x2f4b66),await delay(0xfa0,0x1d4c),await _0x30e679['waitForSelector'](_0x14113a),await _0x30e679['click'](_0x14113a),await delay(0xfa0,0x1d4c),await _0x30e679['type'](_0x14113a,_0x4a5749,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),console['log']('Account\x20Name\x20eingefügt');const _0x52873b='body\x20>\x20div.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x1k90msu.x6o7n8i.x1qfuztq.x10l6tqk.x17qophe.x13vifvy.x1hc1fzr.x71s49j.xh8yej3\x20>\x20div\x20>\x20div.xjp7ctv\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(',_0x2f308c=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1pi30zi.x1swvt13.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z.x78zum5.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span';let _0x445b94=0x1;try{while(_0x445b94!=0x14){console['log']('Schleife');let _0x3f3a45=_0x52873b+_0x445b94+_0x2f308c;const _0x110b8f=await _0x30e679['waitForSelector'](_0x3f3a45),_0x538979=await _0x30e679['evaluate'](_0x3c7a7e=>_0x3c7a7e['innerHTML'],_0x110b8f);console['log'](_0x538979+'\x20'+_0x4a5749),delay(0x3e8,0xbb8);if(_0x538979==_0x4a5749){console['log']('Account\x20gefunden'),await _0x30e679['click'](_0x3f3a45);break;}_0x445b94++;}try{await delay(0xbb8,0x1388);const _0x1afc8a=await _0x30e679['waitForSelector']('div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.x972fbf.xcfux6l.x1qhh985.xm0m39n.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.xexx8yu.x18d9i69.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1lq5wgf.xgqcy7u.x30kzoy.x9jhf4c.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x9bdzbf.x1ypdohk.x78zum5.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x1n2onr6.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xn3w4p2.x5ib6vp.xc73u3c.x1tu34mt.xzloghq');console['log'](_0x1afc8a),await delay(0xbb8,0x1388),await _0x1afc8a['click']();try{await delay(0xbb8,0x1388);const _0x2e17a7=await _0x30e679['waitForSelector']('div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1i64zmx.xw3qccf.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f.notranslate');await _0x2e17a7['type'](_0x1fddbe,{'delay':getRnd(0x50,0x78)}),await delay(0xbb8,0x1388);try{const _0x446228=await _0x30e679['waitForSelector']('div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.xfs2ol5[role=\x22button\x22][tabindex=\x220\x22]');await _0x446228['click'](),await delay(0xbb8,0x1388);}catch(_0x24ea8f){console['log']('Message-Button\x20nicht\x20geklickt:\x20'+_0x24ea8f);}}catch(_0xd87c58){console['log']('Chat-Fenster\x20nicht\x20gefunden:\x20'+_0xd87c58);}}catch(_0x56c293){console['log']('error:\x20'+_0x56c293);}}catch(_0x18706a){console['log']('User\x20nicht\x20gefunden:'+_0x18706a);}}catch(_0x483430){console['log']('DM-Fenster\x20nicht\x20gefunden:'+_0x483430);}}catch(_0x4d86b0){console['log']('Message-Button\x20nicht\x20geklickt:'+_0x4d86b0);}}catch(_0xb644e8){console['log']('Nachricht\x20senden\x20fehlgeschlagen:\x20'+_0xb644e8);}console['log']('Ende');}async function fetch_followers_from_account(_0x60a110,_0x41fb41,_0x14e9af,_0x525668,_0x3cb059){try{await login(_0x60a110,_0x3cb059['username'],_0x3cb059['password']);}catch(_0x5d9a1c){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5d9a1c);}let _0x5b0b02=0x0;try{await _0x60a110['goto']('https://www.instagram.com/'+_0x41fb41+'/'),await notificationClear(_0x60a110);try{if(_0x14e9af<=0x0){const _0x135e24=await _0x60a110['waitForSelector']('div.x9f619.x1n2onr6\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span');await delay(0x12c,0x320);const _0x562bc3=await _0x60a110['evaluate'](_0x56df7f=>_0x56df7f['innerHTML'],_0x135e24);_0x5b0b02=Math['ceil'](_0x562bc3/0x4);}else _0x5b0b02=Math['ceil'](_0x14e9af/0x4);let _0x1bac82=await _0x60a110['waitForSelector']('div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a');await delay(0xbb8,0x1388),await _0x1bac82['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x41fb41+'\x20gesichtet');}catch(_0xe078f8){console['log']('Follower\x20Liste\x20von\x20'+_0x41fb41+'\x20nicht\x20gefunden:'+_0xe078f8);}}catch(_0x1ecf52){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x1ecf52);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x5b0b02),await scroll(_0x60a110,'div.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1sxyh0.xurb0ha.x1uhb9sk.x6ikm8r.x1rife3k.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1l90r2v',_0x5b0b02),await _0x60a110['waitForSelector']('a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd');const _0x125ea4=await _0x60a110['$$']('a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd');_0x14e9af<=0x0&&(_0x14e9af=_0x125ea4['length']);for(let _0x3bb415=0x0;_0x3bb415<_0x125ea4['length']&&_0x3bb415<_0x14e9af;_0x3bb415++){console['log'](await _0x125ea4[_0x3bb415]['evaluate'](_0x15d5c0=>_0x15d5c0['textContent']));const _0x41e987=await db['prepare']('INSERT\x20INTO\x20'+_0x525668+'\x20(username)\x20VALUES\x20(?)');await _0x41e987['run'](await _0x125ea4[_0x3bb415]['evaluate'](_0x31e7e2=>_0x31e7e2['textContent']),function(_0xfd6f25){_0xfd6f25&&console['log']('error\x20in\x20add-user:'+_0xfd6f25);}),await _0x41e987['finalize']();}await dialog['showMessageBox']({'type':'info','buttons':['OK'],'title':'Information','message':'Scraping\x20finished!'});}catch(_0x2f8436){console['log']('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x41fb41+'\x20nicht\x20gefunden:'+_0x2f8436);}}async function fetch_likers_from_post(_0x4f4a6f,_0x26403e,_0xf7ebb2,_0x56e8d4,_0x32f380){try{await login(_0x4f4a6f,_0x32f380['username'],_0x32f380['password']);}catch(_0x537568){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x537568);return;}try{let _0x18d1dd=_0x26403e['substring'](0x0,_0x26403e['lastIndexOf']('/')),_0x1c6734=_0x18d1dd+'/liked_by';console['log'](_0x1c6734),await _0x4f4a6f['goto'](_0x1c6734),await delay(0x7d0,0xfa0),await notificationClear(_0x4f4a6f),await delay(0xc8,0x1f4);let _0x577772='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd';await _0x4f4a6f['waitForSelector'](_0x577772),await delay(0x1f4,0x320);const _0x840c3=await _0x4f4a6f['$$'](_0x577772);await delay(0x1f4,0x320),console['log'](_0x840c3['length']);let _0x3a2ff2=path['join'](__dirname,'/likers.csv');_0xf7ebb2<=0x0&&(_0xf7ebb2=_0x840c3['length']);try{for(let _0x2c4fa0=0x0;_0x2c4fa0<_0x840c3['length']&&_0x2c4fa0<_0xf7ebb2;_0x2c4fa0++){console['log'](await _0x840c3[_0x2c4fa0]['evaluate'](_0x21eeda=>_0x21eeda['textContent']));try{const _0x4fbb9c=await db['prepare']('INSERT\x20INTO\x20'+_0x56e8d4+'\x20(username)\x20VALUES\x20(?)');await _0x4fbb9c['run'](await _0x840c3[_0x2c4fa0]['evaluate'](_0x3db859=>_0x3db859['textContent']),function(_0x381e21){_0x381e21&&console['log']('error\x20in\x20add-user:'+_0x381e21);}),await _0x4fbb9c['finalize']();}catch(_0x53e7b8){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x2c4fa0+'\x20:\x20'+_0x53e7b8);}}await dialog['showMessageBox']({'type':'info','buttons':['OK'],'title':'Information','message':'Scraping\x20finished!'});}catch(_0x27101f){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');}}catch(_0x36a909){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x36a909);}}async function fetch_comments_from_post(_0x5968a8,_0x408195,_0x32c87f,_0x19d6f0,_0x7928d6){try{await login(_0x5968a8,_0x7928d6['username'],_0x7928d6['password']);}catch(_0xd7281d){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0xd7281d);return;}try{console['log'](_0x408195),await _0x5968a8['goto'](_0x408195),await delay(0x7d0,0xfa0),await notificationClear(_0x5968a8),await delay(0xc8,0x1f4);const _0x283ca0='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6';let _0x5645fe;if(_0x32c87f<=0x0){const _0x42ccb9=await _0x5968a8['waitForSelector']('div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span');await delay(0x12c,0x320);let _0x325840=await _0x5968a8['evaluate'](_0x35efb3=>_0x35efb3['innerHTML'],_0x42ccb9),_0xd84225=String(_0x325840)['replace'](/[^0-9]/g,''),_0x13e746=Number(_0xd84225)/0x14;_0x5645fe=Math['ceil'](_0x13e746/0x3);}else _0x5645fe=Math['ceil'](_0x32c87f/0x3);console['log']('Auto-scrolls:\x20'+_0x5645fe),await scroll(_0x5968a8,_0x283ca0,_0x5645fe);try{const _0x8646ce='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span';await _0x5968a8['waitForSelector'](_0x8646ce),await delay(0x1f4,0x320);const _0xd7dfeb=await _0x5968a8['$$'](_0x8646ce);console['log'](_0xd7dfeb),await delay(0xc8,0x1f4);try{for(let _0x3de11d=0x0;_0x3de11d<_0xd7dfeb['length'];_0x3de11d++){_0xd7dfeb[_0x3de11d]['click'](),await delay(0x320,0x5dc);}}catch(_0x2702d3){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x2702d3);}}catch(_0x47c467){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0xba2efd='span._ap3a._aaco._aacw._aacx._aad7._aade';await _0x5968a8['waitForSelector'](_0xba2efd),await delay(0x1f4,0x320);const _0x26190f=await _0x5968a8['$$'](_0xba2efd);let _0x124998=path['join'](__dirname,'/comments.csv');_0x32c87f<=0x0&&(_0x32c87f=_0x26190f['length']);console['log']('fetch_limit:\x20'+_0x32c87f),console['log']('comments_len:\x20'+_0x26190f['length']),_0x32c87f++;try{for(let _0x27e792=0x1;_0x27e792<_0x26190f['length']&&_0x27e792<_0x32c87f;_0x27e792++){try{console['log'](await _0x26190f[_0x27e792]['evaluate'](_0xe7f75b=>_0xe7f75b['textContent']));const _0x1a2911=await db['prepare']('INSERT\x20INTO\x20'+_0x19d6f0+'\x20(username)\x20VALUES\x20(?)');await _0x1a2911['run'](await _0x26190f[_0x27e792]['evaluate'](_0x46f162=>_0x46f162['textContent']),function(_0x17ab0d){_0x17ab0d&&console['log']('error\x20in\x20add-user:'+_0x17ab0d);}),await _0x1a2911['finalize']();}catch(_0x57c820){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x27e792+'\x20:\x20'+_0x57c820);}}await dialog['showMessageBox']({'type':'info','buttons':['OK'],'title':'Information','message':'Scraping\x20finished!'});}catch(_0x5a2044){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');}}catch(_0x3ed58d){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x3ed58d);}}const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20password\x20TEXT,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0xa2bc7a,_0x3e4b5a){try{const _0x27d63c=await new Promise((_0x21a614,_0x2841db)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x3e4b5a],(_0x588a8d,_0x2d8f74)=>{if(_0x588a8d)_0x2841db(_0x588a8d);else{if(_0x2d8f74['length']>0x0){let _0x4cee6f=JSON['parse'](_0x2d8f74[0x0]['cookie']);console['log'](_0x4cee6f),_0x21a614(_0x4cee6f);}else _0x2841db(new Error('User\x20with\x20username\x20'+_0x3e4b5a+'\x20does\x20not\x20exist.'));}});});await _0xa2bc7a['setCookie'](..._0x27d63c),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x25d405){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x25d405);}}async function saveCookiesForUser(_0x192acb,_0x432936){try{let _0x269477=await _0x192acb['cookies']();_0x269477=JSON['stringify'](_0x269477),igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x432936],(_0x4596bc,_0x1e2c8a)=>{if(_0x4596bc){console['error']('Error\x20checking\x20user\x20existence:',_0x4596bc);throw _0x4596bc;}else{if(_0x1e2c8a){const _0x1a623b=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x1a623b['run'](_0x269477,_0x432936,function(_0x499fae){_0x499fae?console['error']('Error\x20updating\x20cookies:',_0x499fae):console['log']('Cookies\x20updated\x20for\x20user:',_0x432936);});}else{const _0x519b75=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x519b75['run'](_0x432936,_0x269477,function(_0x1b0bb0){_0x1b0bb0?console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x1b0bb0):console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x432936);});}}});}catch(_0x2c845a){console['error']('Error\x20fetching\x20cookies:',_0x2c845a);throw _0x2c845a;}}async function createUserIfNotExists(_0x2613a4,_0x35059a){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x2613a4],(_0x1c5d71,_0x349f51)=>{if(_0x1c5d71){console['error']('Error\x20checking\x20user\x20existence:',_0x1c5d71);throw _0x1c5d71;}else{if(!_0x349f51){const _0x3806d8=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20password)\x20VALUES\x20(?,\x20?)');_0x3806d8['run'](_0x2613a4,_0x35059a,function(_0x439f72){_0x439f72?console['error']('Error\x20inserting\x20new\x20user:',_0x439f72):console['log']('New\x20user\x20created:',_0x2613a4);});}else console['log']('User\x20already\x20exists:',_0x2613a4);}});}catch(_0x2d252f){console['error']('Error\x20creating\x20user:',_0x2d252f);throw _0x2d252f;}}ipcMain['handle']('create-relation',async(_0x313bc2,_0x2ddeff)=>{return new Promise((_0x2f45e0,_0xee1471)=>{const _0x4a7974='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x2ddeff+'\x20(username\x20TEXT\x20PRIMARY\x20KEY)';db['run'](_0x4a7974,function(_0x34d289){_0x34d289?_0xee1471(_0x34d289):_0x2f45e0({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x35bb83,_0x2f0618)=>{return console['log']('droping\x20table'+_0x2f0618),new Promise((_0xd357bd,_0x35f0bf)=>{const _0xdef416='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x2f0618;console['log']('droping\x20table'+_0x2f0618),db['run'](_0xdef416,function(_0x29c374){_0x29c374?_0x35f0bf(_0x29c374):_0xd357bd({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x3dd9be=>{return new Promise((_0x2240bf,_0x397558)=>{const _0x10eb10='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x10eb10,[],(_0x3f511c,_0x5a7d42)=>{_0x3f511c?_0x397558(_0x3f511c):_0x2240bf(_0x5a7d42['map'](_0x19e08c=>_0x19e08c['name']));});});}),ipcMain['handle']('add-user',async(_0x3ccfe7,_0x1a4d6c,_0x3eb7d3)=>{return new Promise(_0x370986=>{const _0x59a816=db['prepare']('INSERT\x20INTO\x20'+_0x3eb7d3+'\x20(username)\x20VALUES\x20(?)');_0x59a816['run'](_0x1a4d6c,function(_0x4c5eda){_0x4c5eda?console['log']('error\x20in\x20add-user:'+_0x4c5eda):_0x370986({'status':'success','id':this['lastID']});}),_0x59a816['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x26d103,_0x146c3e)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x155db3,_0x4fc523)=>{if(_0x155db3)_0x146c3e(_0x155db3);else{_0x26d103({'status':'success','users':_0x4fc523});for(_0x4fc523 of _0x4fc523){console['log'](_0x4fc523['username']);}}});});}),ipcMain['handle']('get-data',async(_0x2b27b8,_0x403c0f)=>{return new Promise((_0x3293a6,_0x4b8cfb)=>{const _0x3edfb7='SELECT\x20*\x20FROM\x20'+_0x403c0f;console['log'](_0x3edfb7),db['all'](_0x3edfb7,[],(_0xe93a76,_0x5de601)=>{_0xe93a76?_0x4b8cfb(_0xe93a76):_0x3293a6(_0x5de601);});});}),ipcMain['handle']('get-accounts',async _0x8cd66a=>{return new Promise((_0x3de8a4,_0x105ced)=>{const _0xc632c8='SELECT\x20*\x20FROM\x20accounts';console['log'](_0xc632c8),igaccountsDB['all'](_0xc632c8,[],(_0x5106f2,_0x4b6abc)=>{_0x5106f2?_0x105ced(_0x5106f2):_0x3de8a4(_0x4b6abc);});});}),ipcMain['handle']('get-targets',async(_0x1025ef,_0x37402d)=>{return getTargetProfiles(_0x37402d);}),ipcMain['handle']('delete-user',async(_0x3a0654,_0x45056a,_0x3129ac)=>{return new Promise((_0x706d0d,_0x3be861)=>{const _0x2db6c8=db['prepare']('DELETE\x20FROM\x20'+_0x3129ac+'\x20WHERE\x20username\x20=\x20?');_0x2db6c8['run'](_0x45056a,function(_0x3b11ea){_0x3b11ea?_0x3be861(_0x3b11ea):_0x706d0d({'status':'success','changes':this['changes']});}),_0x2db6c8['finalize']();});}),ipcMain['handle']('delete-account',async(_0x542a96,_0x1aa482)=>{const _0x2a1f4a=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x2a1f4a['run'](_0x1aa482,function(_0x5ce8a0){_0x5ce8a0&&console['log'](_0x5ce8a0);}),_0x2a1f4a['finalize']();});