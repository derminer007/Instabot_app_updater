const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div',K_OPTIONS_BUTTON='section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.xs5motx\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD='div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f',K_SEND_MSG_BUTTON='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x4479a8=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x4479a8['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x4479a8['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x2efa00){var _0x5792be=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x477ac4){console['log']('window\x20id:'+_0x477ac4['id']),_0x477ac4['id']>0x1&&(_0x5792be=!![]);}),console['log']('child\x20opened\x20='+_0x5792be);if(!_0x5792be){const _0x27557f=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x27557f['loadFile'](_0x2efa00['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0);});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));});const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x130018='',_0x30358c=null;if(process['platform']==='darwin')_0x130018=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x130018=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x130018}),_0x30358c=await browser_login['newPage'](),_0x30358c['setDefaultNavigationTimeout'](0x1d4c),_0x30358c['setDefaultTimeout'](0x1d4c),_0x30358c;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x5815de=0x1,_0x480d4b=0x0){let _0x53bcb1='',_0x271156=null;const _0x157e14=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x53bcb1=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x53bcb1=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x5815de===0x0&&!pageStack[_0x480d4b])return browser=await puppeteer['launch']({'headless':_0x157e14,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x53bcb1}),_0x271156=await browser['newPage'](),_0x271156['setDefaultNavigationTimeout'](0x1d4c),_0x271156['setDefaultTimeout'](0x1d4c),pageStack[_0x480d4b]=_0x271156,_0x271156;return(browser===null||pageStack[_0x480d4b]===null||pageStack[_0x480d4b]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x157e14,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x53bcb1})),(pageStack[_0x480d4b]===null||pageStack[_0x480d4b]['isClosed']())&&(_0x271156=await browser['newPage'](),_0x271156['setDefaultNavigationTimeout'](0x1d4c),_0x271156['setDefaultTimeout'](0x1d4c),pageStack[_0x480d4b]=_0x271156),pageStack[_0x480d4b];}ipcMain['on']('login',async(_0x24ef4e,_0x3fc296)=>{const _0x48fcc5=await getBrowserPageLogin();await _0x48fcc5['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x48fcc5,_0x3fc296),ipcMain['on']('setLoginCookies',async(_0x2ad7bb,_0x5ba485)=>{try{await set_login_cookies(_0x48fcc5,_0x5ba485);}catch(_0x3b198e){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x3b198e);}});}),ipcMain['on']('export-relation',async(_0x3cb8e9,_0x3325bc)=>{try{await exportDatabase(_0x3325bc),_0x3cb8e9['reply']('export-relation-response',{'success':!![]});}catch(_0x27c325){console['error'](_0x27c325),_0x3cb8e9['reply']('export-relation-response',{'success':![],'message':_0x27c325['message']});}}),ipcMain['handle']('sendMessage',async(_0x4c65d8,_0x232418,_0x2f548a,_0x5ea082,_0x4ad53e,_0x5e130b,_0x308417,_0x7fc339,_0x4d8823,_0x47bff7)=>{isStopping=![];let _0x455080=null;return _0x308417?_0x455080=await getBrowserPage(_0x4ad53e,_0x7fc339):_0x455080=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x232418),send_message(_0x455080,_0x232418,_0x2f548a,_0x5ea082,_0x4ad53e,_0x5e130b,_0x4d8823,_0x47bff7);}),ipcMain['handle']('stop-action',async(_0x55a578,_0x18d960)=>{isStopping=!![];const _0xc70a9a=await getBrowserPage(0x1,_0x18d960);await _0xc70a9a['close']();}),ipcMain['handle']('fetch_followers',async(_0xec1888,_0x2e471e,_0x13b4d8,_0xfc8330,_0x27d53c,_0x53644c)=>{isStopping=![];const _0x481f8d=await getBrowserPage();return fetch_followers_from_account(_0xec1888,_0x481f8d,_0x2e471e,_0x13b4d8,_0xfc8330,_0x27d53c,_0x53644c);}),ipcMain['handle']('get-account-details',async(_0x1df90c,_0x330e47,_0x501338,_0x4a3cd4)=>{isStopping=![];const _0x1c2813=await getBrowserPage();return fetch_account_details(_0x1c2813,_0x330e47,_0x501338,_0x4a3cd4);}),ipcMain['handle']('fetch_likes',async(_0x1ba004,_0x4dab79,_0x204046,_0x57419d,_0x2bdcd1,_0x41fad9)=>{isStopping=![];const _0x565fda=await getBrowserPage();return fetch_likers_from_post(_0x1ba004,_0x565fda,_0x4dab79,_0x204046,_0x57419d,_0x2bdcd1,_0x41fad9);}),ipcMain['handle']('fetch_comments',async(_0x34e3e9,_0x1a37dc,_0x21c092,_0x28e30b,_0x639393,_0x59b146)=>{isStopping=![];const _0x45b698=await getBrowserPage();return fetch_comments_from_post(_0x34e3e9,_0x45b698,_0x1a37dc,_0x21c092,_0x28e30b,_0x639393,_0x59b146);}),ipcMain['handle']('update-app',async _0x1e33c3=>{const {spawn:_0x54af2b}=require('child_process'),_0xb7e20a=require('path');return new Promise((_0x10fe43,_0x3b7b20)=>{(process['env']['NODE_ENV']==='development'||process['env']['SKIP_UPDATES']==='true')&&(console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x10fe43('Update\x20übersprungen'));if(process['platform']==='darwin'){const _0x39f233=_0xb7e20a['join'](__dirname,'mac-updater-intern.sh'),_0x314603=_0x54af2b('/bin/bash',[_0x39f233]);_0x314603['stdout']['on']('data',_0x316ca7=>{console['log']('stdout:\x20'+_0x316ca7);}),_0x314603['stderr']['on']('data',_0x2f3181=>{console['error']('stderr:\x20'+_0x2f3181);}),_0x314603['on']('close',_0x1bb923=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x1bb923),_0x1bb923===0x0?_0x10fe43('Update\x20erfolgreich\x20abgeschlossen.'):_0x3b7b20(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x1bb923));});}else{if(process['platform']==='win32'){const _0x2cb71e=_0xb7e20a['join'](__dirname,'../','../','../');process['chdir'](_0x2cb71e),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x1d4092='soft-ui-updater-windows.ps1',_0x5b4890=_0x54af2b('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x1d4092]);_0x5b4890['stdout']['on']('data',_0x34a3de=>{console['log']('stdout:\x20'+_0x34a3de);}),_0x5b4890['stderr']['on']('data',_0x2e4c85=>{console['error']('stderr:\x20'+_0x2e4c85);}),_0x5b4890['on']('close',_0x4ce505=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x4ce505),_0x4ce505===0x0?_0x10fe43('Update\x20erfolgreich\x20abgeschlossen.'):_0x3b7b20(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x4ce505));});}else _0x3b7b20(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}});});function getRnd(_0x5e6bfc,_0x45a42a){return Math['random']()*(_0x45a42a-_0x5e6bfc+0x1)+_0x5e6bfc;}function delay(_0xa73ded,_0x4c1442){let _0x38d1d7=getRnd(_0xa73ded,_0x4c1442);return new Promise(function(_0x394a2c){setTimeout(_0x394a2c,_0x38d1d7);});}async function scroll(_0xf26e29,_0x652c05,_0x224bf9=0x2,_0x5e4757){const _0x4b9da4=await _0xf26e29['waitForSelector'](_0x652c05);for(let _0x1a5af7=0x0;_0x1a5af7<_0x224bf9;_0x1a5af7++){console['log']('Scrolling\x20'+_0x1a5af7),await _0xf26e29['evaluate'](_0x4121e0=>{const _0x2fa33d=document['querySelector'](_0x4121e0);_0x2fa33d&&_0x2fa33d['scrollBy'](0x0,0x190);},_0x652c05),await delay(0x320,0x5dc),_0x5e4757();}}async function saveCookies(_0x3fd1a8){let _0xfca31b=await _0x3fd1a8['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0xfca31b,null,0x2));}async function notificationClear(_0x92236f){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x92236f['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x92236f['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x191c74){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x191c74);}}async function getTargetProfiles(_0x46d106){return new Promise((_0x54e03f,_0x4cf24a)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x46d106,(_0x237372,_0x269290)=>{_0x237372?_0x4cf24a(_0x237372):_0x54e03f(_0x269290);});});}async function login_legacy(_0x55c33f,_0x4d6b78,_0x2602ca){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x55c33f,_0x4d6b78),await createUserIfNotExists(_0x4d6b78,_0x2602ca);}catch(_0x315d83){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x315d83);}try{await _0x55c33f['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x55c33f['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x55c33f['click']('button._a9--._ap36._a9_0');}catch(_0x3e879e){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x55c33f['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x55c33f['type']('input[name=\x27username\x27]',_0x4d6b78,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x55c33f['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x55c33f['type']('input[name=\x27password\x27]',_0x2602ca,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x55c33f['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x55c33f['click']('button[type=\x27submit\x27]');}catch(_0x2ef80f){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x55c33f),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x55c33f,_0x4d6b78);}catch(_0x1a202b){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x1a202b);}}catch(_0x5227f9){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x5227f9);}}async function login(_0x900beb,_0x3cfa24){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x900beb,_0x3cfa24),await createUserIfNotExists(_0x3cfa24);}catch(_0x462fb7){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x462fb7);}try{await _0x900beb['goto']('https://www.instagram.com/accounts/login/');}catch(_0x142ed4){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x142ed4);}}async function set_login_cookies(_0x6cb5ff,_0x39fd39){try{await saveCookiesForUser(_0x6cb5ff,_0x39fd39);}catch(_0x1a8e89){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x1a8e89);}}async function waitForXPath(_0x2a1779,_0x3baa6b,_0x367c3c={}){return await _0x2a1779['waitForFunction'](_0x402b97=>{return document['evaluate'](_0x402b97,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x367c3c,_0x3baa6b),_0x2a1779['evaluateHandle'](_0x319714=>document['evaluate'](_0x319714,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x3baa6b);}async function send_message(_0x2c7dc9,_0x39d0d1,_0x19100c,_0x50b11d,_0x1c021b,_0x1cccaf,_0xaf551b,_0x39f662){return new Promise(async(_0x932814,_0x231e4e)=>{_0x1cccaf=_0x1cccaf['split'](';'),console['log'](_0x1cccaf[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x1c021b);try{await setCookiesForUser(_0x2c7dc9,_0x1cccaf[0x0]);}catch(_0x4f1d49){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x4f1d49),_0x231e4e({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x4f1d49});return;}try{await _0x2c7dc9['goto']('https://www.instagram.com/'+_0x39d0d1+'/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x2c7dc9);}catch(_0x76f421){_0x231e4e({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x76f421});return;}console['log']('UserSkip:\x20'+_0xaf551b);if(_0xaf551b==0x1)try{const _0x4660dc=await _0x2c7dc9['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x54c99d=>_0x54c99d['textContent']['trim']());console['log'](_0x4660dc);if(_0x4660dc==='Following'||_0x4660dc==='Folge\x20ich')return _0x932814({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x17c4a3){}try{await _0x2c7dc9['waitForSelector'](K_DIRECT_MSG_BUTTON),await _0x2c7dc9['click'](K_DIRECT_MSG_BUTTON);}catch(_0xa0042c){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0xa0042c);try{await _0x2c7dc9['waitForSelector'](K_OPTIONS_BUTTON),await _0x2c7dc9['click'](K_OPTIONS_BUTTON),await delay(0x1f4,0x320);const _0x2285db=await waitForXPath(_0x2c7dc9,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x2285db['click']();}catch(_0x1b43e0){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x1b43e0),_0x932814({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x2c7dc9);}catch(_0x5e2821){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x5e2821);}try{const _0x435f50=await _0x2c7dc9['waitForSelector'](K_CHAT_INPUT_FIELD);if(_0x39f662){const _0x40b849=await _0x2c7dc9['$']('div.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x6ikm8r.x10wlt62');if(_0x40b849)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x39d0d1),_0x932814({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x4efed4=await _0x2c7dc9['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x4efed4),_0x50b11d=_0x50b11d['replace']('{USERNAME}',_0x39d0d1);let _0x400da5=_0x4efed4['replace'](/[^\p{L}\s]/gu,''),_0xce310f=_0x400da5['split']('\x20')[0x0];console['log']('Extrahierter\x20Clearname\x20mit\x20Len:\x20'+_0xce310f['length']+'nach\x20Split:\x20'+_0xce310f);_0xce310f['length']>0x2&&!_0xce310f['includes']('Instagram')?(_0x50b11d=_0x50b11d['replaceAll']('{NAME}',_0xce310f),_0x50b11d=_0x50b11d['replaceAll']('{name}',_0xce310f)):(_0x50b11d=_0x50b11d['replaceAll']('\x20{NAME}',''),_0x50b11d=_0x50b11d['replaceAll']('\x20{name}',''),_0x50b11d=_0x50b11d['replaceAll']('{NAME}',''),_0x50b11d=_0x50b11d['replaceAll']('{name}',''));await _0x435f50['type'](_0x50b11d,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0x35d43a=await _0x2c7dc9['waitForSelector'](K_SEND_MSG_BUTTON);await _0x35d43a['click'](),await delay(0x320,0x3e8),_0x932814({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!'});}catch(_0x1f58a4){try{await _0x2c7dc9['waitForSelector'](K_MSG_DISABLED_LABEL);const _0x5f96ff=await _0x2c7dc9['evaluate'](_0x4afccc=>{return document['querySelector'](_0x4afccc)['textContent'];},K_MSG_DISABLED_LABEL);console['log']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20gefunden:\x20'+_0x5f96ff),console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x1f58a4),_0x932814({'status':0x195,'message':'Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x39d0d1+'\x20überspringen.'});}catch(_0x43b40e){console['error']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20nicht\x20gefunden:\x20'+_0x43b40e),console['error']('Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x39d0d1+'\x20:\x20'+_0x43b40e),_0x932814({'status':0x196,'message':'Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x39d0d1+'\x20:\x20'+_0x43b40e});}}});}function handle_fail(_0x53bba9){if(isStopping)return new Promise(_0xce81ec=>{_0xce81ec('Scraper\x20gestoppt.');});else{let _0x16ddac='';switch(_0x53bba9){case 0x0:_0x16ddac='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x16ddac='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x16ddac='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x16ddac='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x2e9422,_0x2bcfe0)=>{_0x2bcfe0(_0x16ddac);});}}async function fetch_account_details(_0x73d903,_0x35b911,_0x3307ad,_0x5e7bf2){try{await setCookiesForUser(_0x73d903,_0x3307ad['username']);}catch(_0x100fae){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x100fae);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x100fae);return handle_fail(0x0);}_0x73d903['setDefaultNavigationTimeout'](0x7530),await _0x73d903['goto']('https://www.instagram.com/'+_0x35b911+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x73d903);const _0x880f20=await _0x73d903['evaluate'](()=>{const _0x5e3e24=document['querySelector']('meta[property=\x22og:image\x22]');return _0x5e3e24?_0x5e3e24['getAttribute']('content'):null;});await _0x73d903['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x1023d3=await _0x73d903['evaluate'](()=>{const _0x298ead=document['querySelector']('meta[name=\x22description\x22]');if(!_0x298ead)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0xac9e86=_0x298ead['getAttribute']('content');if(!_0xac9e86)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0xac9e86);const _0x1419cc=/\s*[–-]\s*/,_0x34f7d0=_0xac9e86['split'](_0x1419cc);if(_0x34f7d0['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x1a8dd3=_0x34f7d0[0x0],_0x6dbe8d=_0x34f7d0[0x1],_0x2ca126=_0x1a8dd3['split'](',\x20');if(_0x2ca126['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x55035d=_0x2ca126[0x0]['split']('\x20')[0x0],_0x4518a6=_0x2ca126[0x1]['split']('\x20')[0x0],_0x90d8db=_0x2ca126[0x2]['split']('\x20')[0x0];let _0x1f5320='',_0x442ccf='';const _0x2b7c1b='\x20on\x20Instagram:\x20',_0x557463=_0x6dbe8d['split'](_0x2b7c1b);return _0x1f5320=_0x557463[0x0]['trim'](),_0x1f5320=_0x1f5320['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x557463['length']>0x1&&(_0x442ccf=_0x557463[0x1]['trim'](),_0x442ccf['startsWith']('\x22')&&_0x442ccf['endsWith']('\x22')&&(_0x442ccf=_0x442ccf['substring'](0x1,_0x442ccf['length']-0x1)['trim']()),_0x442ccf=_0x442ccf['replace'](/&quot;/g,'')['trim']()),{'followers':_0x55035d,'following':_0x4518a6,'posts':_0x90d8db,'nameText':_0x1f5320,'bio':_0x442ccf};});console['log']('Extracted\x20profile\x20data:',_0x1023d3);const _0x23640e=_0x1023d3['nameText'],_0x3eda03=_0x880f20,_0x30a1e8=_0x1023d3['bio'],_0x16f288=_0x1023d3['followers'],_0x32f529=_0x1023d3['following'],_0x10adca=_0x1023d3['posts'],_0x43de07=![],_0xb24a0c=![],_0xb11386=![],_0x5d509e='\x0a\x20\x20INSERT\x20INTO\x20'+_0x5e7bf2+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x5d509e,[_0x35b911,_0x23640e,_0x3eda03,_0x30a1e8,_0x16f288,_0x32f529,_0x10adca,_0x43de07,_0xb24a0c,_0xb11386],function(_0x15b7f4){_0x15b7f4?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x15b7f4['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x5dffe9,_0x2a33a8,_0x340064,_0x3f49d4,_0x50e433,_0x2af0ed,_0x30dc21){let _0x26ca39=0x4,_0x235c55=0x0,_0x3b9f14=0x0;try{await setCookiesForUser(_0x2a33a8,_0x2af0ed['username']);}catch(_0x191c1e){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x191c1e);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x191c1e);return handle_fail(0x0);}let _0xbfb78=0x0;try{await _0x2a33a8['goto']('https://www.instagram.com/'+_0x340064+'/'),await notificationClear(_0x2a33a8);try{if(_0x3f49d4<=0x0){const _0x1e1e5b=await _0x2a33a8['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x4dc22a=await _0x2a33a8['evaluate'](_0x20824b=>_0x20824b['innerHTML'],_0x1e1e5b);_0xbfb78=Math['ceil'](_0x4dc22a/0x4);}else _0xbfb78=Math['ceil'](_0x3f49d4/0x4);_0x26ca39+=_0xbfb78,_0x3b9f14=Math['round'](++_0x235c55/_0x26ca39*0x64),_0x5dffe9['sender']['send']('fetch-progress',_0x3b9f14,!![]);let _0x4e680e=await _0x2a33a8['waitForSelector']('a[href=\x22/'+_0x340064+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x4e680e['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x340064+'\x20gesichtet'),_0x3b9f14=Math['round'](++_0x235c55/_0x26ca39*0x64),_0x5dffe9['sender']['send']('fetch-progress',_0x3b9f14,!![]);}catch(_0x455f4e){console['log']('Follower\x20Liste\x20von\x20'+_0x340064+'\x20nicht\x20gefunden:'+_0x455f4e);throw new Error('Follower\x20Liste\x20von\x20'+_0x340064+'\x20nicht\x20gefunden:'+_0x455f4e);return handle_fail(0x0);}}catch(_0x19329a){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x19329a);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x19329a);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0xbfb78),await scroll(_0x2a33a8,FOLLOWER_FENSTER,_0xbfb78,_0x32842e=>{_0x3b9f14=Math['round'](++_0x235c55/_0x26ca39*0x64),_0x5dffe9['sender']['send']('fetch-progress',_0x3b9f14,!![]);}),await _0x2a33a8['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x564e12=await _0x2a33a8['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x4f5883=await _0x2a33a8['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x3b9f14=Math['round'](++_0x235c55/_0x26ca39*0x64),_0x5dffe9['sender']['send']('fetch-progress',_0x3b9f14,!![]);_0x3f49d4<=0x0&&(_0x3f49d4=_0x564e12['length']);let _0x565493=[];for(let _0x32be0a=0x0;_0x32be0a<_0x564e12['length']&&_0x32be0a<_0x3f49d4;_0x32be0a++){_0x565493['push'](await _0x564e12[_0x32be0a]['evaluate'](_0x4f7948=>_0x4f7948['textContent']));const _0x5aee5d='INSERT\x20INTO\x20'+_0x50e433+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x5aee5d,[await _0x564e12[_0x32be0a]['evaluate'](_0x71818=>_0x71818['textContent']),await _0x4f5883[_0x32be0a]['evaluate'](_0x2a1bc0=>_0x2a1bc0['textContent'])],function(_0x20541c){_0x20541c?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x50e433+'\x27:',_0x20541c['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x3b9f14=Math['round'](++_0x235c55/_0x26ca39*0x64),_0x5dffe9['sender']['send']('fetch-progress',_0x3b9f14,!![]),_0x30dc21&&(_0x5dffe9['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x5dffe9,_0x2a33a8,_0x2af0ed,_0x50e433,_0x565493)),new Promise(_0xdae7b8=>{_0xdae7b8('Scraping\x20finished!');});}catch(_0x24fd6a){if(_0x30dc21)throw new Error(_0x24fd6a);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x340064+'\x20nicht\x20gefunden:\x20'+_0x24fd6a);return handle_fail(0x0);}}async function fetch_details_from_list(_0x4de381,_0x31c859,_0x1e7fc0,_0x144452,_0x5b3fd0){let _0x1f7fd1=0x0,_0x4e413c=0x0;for(let _0xa303f2=0x0;_0xa303f2<_0x5b3fd0['length'];_0xa303f2++){console['log']('Processing\x20profile:',_0x5b3fd0[_0xa303f2]);try{await fetch_account_details(_0x31c859,_0x5b3fd0[_0xa303f2],_0x1e7fc0,_0x144452);}catch(_0x572435){console['error']('Detailed\x20Scraping\x20von:\x20',_0x5b3fd0[_0xa303f2],_0x572435);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x5b3fd0[_0xa303f2]+'\x20'+_0x572435);}_0x4e413c=Math['round'](++_0x1f7fd1/_0x5b3fd0['length']*0x64),_0x4de381['sender']['send']('fetch-progress',_0x4e413c,!![],!![]);}}async function fetch_likers_from_post(_0x5b9443,_0x3c1967,_0x235ffc,_0x249f0c,_0x4dd052,_0x1e2ab6,_0x317aab){let _0x29a93b=0x4,_0x828a99=0x0,_0x1404fa=0x0;try{await setCookiesForUser(_0x3c1967,_0x1e2ab6['username']);}catch(_0x2e77b0){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x2e77b0);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x2e77b0);return handle_fail(0x1);return;}_0x1404fa=Math['round'](++_0x828a99/_0x29a93b*0x64),_0x5b9443['sender']['send']('fetch-progress',_0x1404fa,!![]);try{let _0x26eb5e=_0x235ffc['substring'](0x0,_0x235ffc['lastIndexOf']('/')),_0x4f2b0b=_0x26eb5e+'/liked_by';console['log'](_0x4f2b0b),await _0x3c1967['goto'](_0x4f2b0b),await delay(0x7d0,0xfa0),await notificationClear(_0x3c1967),await delay(0xc8,0x1f4),_0x1404fa=Math['round'](++_0x828a99/_0x29a93b*0x64),_0x5b9443['sender']['send']('fetch-progress',_0x1404fa,!![]),await _0x3c1967['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x1fb644=await _0x3c1967['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x2caf1b=await _0x3c1967['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x1fb644['length']);let _0x988421=path['join'](__dirname,'/likers.csv');_0x1404fa=Math['round'](++_0x828a99/_0x29a93b*0x64),_0x5b9443['sender']['send']('fetch-progress',_0x1404fa,!![]);_0x249f0c<=0x0&&(_0x249f0c=_0x1fb644['length']);try{let _0x557a0e=[];for(let _0x32440d=0x0;_0x32440d<_0x1fb644['length']&&_0x32440d<_0x249f0c;_0x32440d++){_0x557a0e['push'](await _0x1fb644[_0x32440d]['evaluate'](_0x480364=>_0x480364['textContent']));try{const _0x321f99='INSERT\x20INTO\x20'+_0x4dd052+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x321f99,[await _0x1fb644[_0x32440d]['evaluate'](_0x1b80d1=>_0x1b80d1['textContent']),await _0x2caf1b[_0x32440d]['evaluate'](_0x4ea518=>_0x4ea518['textContent'])],function(_0x2cc85e){_0x2cc85e?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x4dd052+'\x27:',_0x2cc85e['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x107888){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x32440d+'\x20:\x20'+_0x107888);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x32440d+'\x20:\x20'+_0x107888);return handle_fail(0x1);}}return _0x1404fa=Math['round'](++_0x828a99/_0x29a93b*0x64),_0x5b9443['sender']['send']('fetch-progress',_0x1404fa,!![]),_0x317aab&&(_0x5b9443['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x5b9443,_0x3c1967,_0x1e2ab6,_0x4dd052,_0x557a0e)),new Promise(_0x38f736=>{_0x38f736('Scraping\x20finished!');});}catch(_0x5598c5){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x5598c5);return handle_fail(0x1);}}catch(_0x1d4baf){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x1d4baf);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x1d4baf);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x43e3f3,_0x1af9cb,_0x20c507,_0x56c1ce,_0x2785cc,_0x53b0c3,_0x4ee5d2){let _0x32efe8=0x3,_0x1a1cad=0x0,_0x44cd77=0x0;try{await setCookiesForUser(_0x1af9cb,_0x53b0c3['username']);}catch(_0x4ccbb2){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4ccbb2);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4ccbb2);return handle_fail(0x2);}try{console['log'](_0x20c507),await _0x1af9cb['goto'](_0x20c507),await delay(0x7d0,0xfa0),await notificationClear(_0x1af9cb),await delay(0xc8,0x1f4);const _0x14ae82=COM_COMMENTS_BOX_BODY_DIV;let _0x59f4be;const _0x2779c5=await _0x1af9cb['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x25ab13=await _0x1af9cb['evaluate'](_0x360f22=>_0x360f22['innerHTML'],_0x2779c5),_0x2ea140=String(_0x25ab13)['replace'](/[^0-9]/g,''),_0x4a4029=Number(_0x2ea140)/0x14;_0x56c1ce<=0x0?_0x59f4be=Math['ceil'](_0x4a4029/0x3):_0x59f4be=Math['ceil'](_0x56c1ce/0x3);_0x32efe8+=_0x59f4be,_0x44cd77=Math['round'](++_0x1a1cad/_0x32efe8*0x64),_0x43e3f3['sender']['send']('fetch-progress',_0x44cd77,!![]),console['log']('Auto-scrolls:\x20'+_0x59f4be),await scroll(_0x1af9cb,_0x14ae82,_0x59f4be,_0x24f31d=>{_0x44cd77=Math['round'](++_0x1a1cad/_0x32efe8*0x64),_0x43e3f3['sender']['send']('fetch-progress',_0x44cd77,!![]);});try{const _0x3da6e7=COM_REPLY_BUTTON_SPAN;await _0x1af9cb['waitForSelector'](_0x3da6e7),await delay(0x1f4,0x320);const _0x5f3401=await _0x1af9cb['$$'](_0x3da6e7);console['log'](_0x5f3401);let _0x17ea5e=_0x5f3401['length'];await delay(0xc8,0x1f4);try{for(let _0x445236=0x0;_0x445236<_0x17ea5e;_0x445236++){_0x5f3401[_0x445236]['click'](),await delay(0x320,0x5dc);}}catch(_0x27ab6c){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x27ab6c);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x27ab6c);return handle_fail(0x2);}}catch(_0x4f92e7){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x481a5d=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x1af9cb['waitForSelector'](_0x481a5d),await delay(0x1f4,0x320),_0x44cd77=Math['round'](++_0x1a1cad/_0x32efe8*0x64),_0x43e3f3['sender']['send']('fetch-progress',_0x44cd77,!![]);const _0xed358a=await _0x1af9cb['$$'](_0x481a5d);let _0x4f905f=path['join'](__dirname,'/comments.csv');_0x56c1ce<=0x0&&(_0x56c1ce=_0xed358a['length']);console['log']('fetch_limit:\x20'+_0x56c1ce),console['log']('comments_len:\x20'+_0xed358a['length']),_0x56c1ce++;try{let _0x35fcc1=[];for(let _0x4c0982=0x1;_0x4c0982<_0xed358a['length']&&_0x4c0982<_0x56c1ce;_0x4c0982++){try{_0x35fcc1['push'](await _0xed358a[_0x4c0982]['evaluate'](_0xb9357e=>_0xb9357e['textContent']));const _0x86c9eb=await db['prepare']('INSERT\x20INTO\x20'+_0x2785cc+'\x20(username)\x20VALUES\x20(?)');await _0x86c9eb['run'](await _0xed358a[_0x4c0982]['evaluate'](_0x15fbc1=>_0x15fbc1['textContent']),function(_0x3ee7e6){_0x3ee7e6&&console['log']('error\x20in\x20add-user:'+_0x3ee7e6);}),await _0x86c9eb['finalize']();}catch(_0x1be713){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x4c0982+'\x20:\x20'+_0x1be713);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x4c0982+'\x20:\x20'+_0x1be713);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x44cd77=Math['round'](++_0x1a1cad/_0x32efe8*0x64),_0x43e3f3['sender']['send']('fetch-progress',_0x44cd77,!![]),_0x43e3f3['sender']['send']('fetch-progress',0x64,!![]),_0x4ee5d2&&(_0x43e3f3['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x43e3f3,_0x1af9cb,_0x53b0c3,_0x2785cc,_0x35fcc1)),_0x43e3f3['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x54fa22=>{_0x54fa22('Scraping\x20finished!');});}catch(_0x280b76){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x280b76);return handle_fail(0x2);}}catch(_0x525b4b){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x525b4b);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x525b4b);return handle_fail(0x2);}}async function set_clearname_from_username(_0x418746,_0x1ea6de,_0x4016af=null){try{let _0x2bdf1f,_0x4b768e;const _0x47a359='SELECT\x20username\x20FROM\x20'+_0x1ea6de+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x47a359,[],(_0x540409,_0x2128a2)=>{_0x540409&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x540409['message']),_0x2128a2['length']===0x0&&(_0x4b768e=_0x2128a2['length']),_0x2bdf1f=_0x2128a2['map'](_0x38d100=>_0x38d100['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x4b768e);if(_0x4b768e===0x0){console['log']('Leave');return;}const _0xa2fe51=await _0x418746['waitForSelector'](IG_SEARCH_BUTTON);await _0xa2fe51['click'](),await delay(0x4b0,0x7d0);for(let _0x185c9d of _0x2bdf1f){const _0x5763f8=await _0x418746['waitForSelector'](IG_SEARCH_INPUT);await _0x5763f8['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x418746['type'](IG_SEARCH_INPUT,_0x185c9d,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x238888=0x1;while(_0x238888!=0x14){console['log']('Schleife');try{let _0x1b8cbf=IG_NAME_SPAN_PART1+_0x238888+IG_USERNAME_SPAN_PART2;const _0x5e0e1f=await _0x418746['waitForSelector'](_0x1b8cbf),_0x191586=await _0x418746['evaluate'](_0x34ef7f=>_0x34ef7f['innerHTML'],_0x5e0e1f);await delay(0xc8,0x1f4);if(_0x191586==_0x185c9d){let _0xe9182d=IG_NAME_SPAN_PART1+_0x238888+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x2caadd=await _0x418746['waitForSelector'](_0xe9182d);let _0x3a1630=await _0x418746['evaluate'](_0x4a7b5c=>_0x4a7b5c['innerHTML'],_0x2caadd);const _0x667a19=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x430384=_0x3a1630['match'](_0x667a19);_0x430384?_0x3a1630=_0x430384[0x1]['trim']():_0x3a1630=_0x3a1630['trim']();_0x3a1630['includes']('•')&&(_0x3a1630=_0x3a1630['substring'](0x0,_0x3a1630['indexOf']('•')-0x1));const _0x1bd346='UPDATE\x20'+_0x1ea6de+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x1bd346,[_0x3a1630,_0x191586],function(_0x6a6133){_0x6a6133&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x6a6133['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x238888++;}catch(_0xd3496f){const _0x2396f3='UPDATE\x20'+_0x1ea6de+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x2396f3,['',_0x185c9d],function(_0x53c1e8){_0x53c1e8&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x53c1e8['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0xd3496f);break;}}_0x4016af&&_0x4016af();}await _0xa2fe51['click']();}catch(_0x41122a){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x41122a);}}const campaignPath=path['resolve'](__dirname,'data/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x2a9c31,_0x204d40)=>{const _0x383c6a='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x383c6a,[],(_0x5b1b95,_0xea49fb)=>{_0x5b1b95?_0x204d40(_0x5b1b95):_0x2a9c31(_0xea49fb);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x28e2ce,_0x48ec1e)=>{const _0x5407cd='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x5407cd,[],async(_0x350bc6,_0x3bfc4b)=>{if(_0x350bc6)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x350bc6['message']),_0x48ec1e({'status':'error','message':_0x350bc6['message']});else try{const _0x223680=await Promise['all'](_0x3bfc4b['map'](_0x2dfa8d=>{return new Promise(_0x416ee4=>{if(!_0x2dfa8d['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x2dfa8d['campaign_name']),_0x416ee4({'campaign_name':_0x2dfa8d['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x5dcd0f='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x2dfa8d['list_id'],_0x39ed61='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x2dfa8d['list_id']+'\x22';db['get'](_0x5dcd0f,[],(_0x4a6dbf,_0x1ae206)=>{_0x4a6dbf?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x2dfa8d['campaign_name']+':',_0x4a6dbf['message']),_0x416ee4({'campaign_name':_0x2dfa8d['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x39ed61,[],(_0xca26b7,_0x848999)=>{_0xca26b7?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x2dfa8d['campaign_name']+':',_0xca26b7['message']),_0x416ee4({'campaign_name':_0x2dfa8d['campaign_name'],'lead_count':_0x1ae206?_0x1ae206['lead_count']:0x0,'contacted_count':'N/A'})):_0x416ee4({'campaign_name':_0x2dfa8d['campaign_name'],'lead_count':_0x1ae206?_0x1ae206['lead_count']:0x0,'contacted_count':_0x848999?_0x848999['contacted_count']:0x0});});});});}));_0x28e2ce({'status':'success','campaigns':_0x223680});}catch(_0x5ba0ec){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x5ba0ec),_0x48ec1e({'status':'error','message':_0x5ba0ec['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x3d8fe1,_0x2edcc4)=>{return new Promise((_0x521d4c,_0x206820)=>{const _0x2e12ba='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x2e12ba,[_0x2edcc4],(_0x1f33bc,_0x5a04e6)=>{_0x1f33bc?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x1f33bc),_0x206820(_0x1f33bc)):(console['log']('ROWS'),console['log'](_0x5a04e6),debugDatabaseContents(),_0x521d4c(_0x5a04e6));});});});const showTableContents=_0x23f52f=>{return new Promise((_0x1f85b4,_0x5e06e0)=>{const _0x48c73c='SELECT\x20*\x20FROM\x20'+_0x23f52f+';';campaignDB['all'](_0x48c73c,(_0x4ec051,_0x266458)=>{_0x4ec051?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x23f52f+':',_0x4ec051),_0x5e06e0(_0x4ec051)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x23f52f+':',_0x266458),_0x1f85b4({'status':'success','message':_0x266458}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x15eede){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x15eede);}}ipcMain['handle']('create-campaign',async(_0x481764,_0xb85aa3)=>{return new Promise((_0x4f62d8,_0x135dfa)=>{const _0x35d353='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x35d353,[String(_0xb85aa3)],function(_0x4f71b7){_0x4f71b7?_0x135dfa(_0x4f71b7):_0x4f62d8({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x55ee08,_0x1de1b2)=>{return new Promise((_0xb6d504,_0x4cadd8)=>{const _0x3af0f9='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x3af0f9,[_0x1de1b2],function(_0x41a173){_0x41a173?_0x4cadd8(_0x41a173):_0xb6d504({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x3f0e62,_0x229a98,_0x4633d7,_0x2bb872,_0x3965d3,_0x4bda0a,_0x1c467f,_0x1e8e45)=>{const _0x490a8a=await createMessageID(_0x3965d3);return new Promise((_0x59eec0,_0x6d1cdd)=>{if(!_0x229a98||!_0x4633d7||!_0x2bb872||!_0x490a8a||!_0x4bda0a)return _0x6d1cdd({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x490a8a);const _0x55ac2b='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x55ac2b,[_0x4633d7,_0x2bb872,_0x490a8a,_0x4bda0a,_0x1c467f,_0x1e8e45,_0x229a98],function(_0x2b5f5f){if(_0x2b5f5f)_0x6d1cdd({'status':'error','message':_0x2b5f5f['message']});else this['changes']===0x0?_0x6d1cdd({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x59eec0({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x10f841,_0x1bf666,_0x48baa7,_0x3bc0f4,_0x28c727)=>{return new Promise((_0xd6b8fc,_0x5af570)=>{const _0x41ceda='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x41ceda,[_0x1bf666,_0x48baa7,_0x3bc0f4,_0x28c727],function(_0x42a884){return _0x42a884?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x42a884['message']),_0x5af570('insert-dm-response',{'success':![],'message':_0x42a884['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0xd6b8fc('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x33de59=>{return new Promise((_0x4b90e7,_0x24711e)=>{const _0x2ff678='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x2ff678,[_0x33de59],(_0x2f64c2,_0x441633)=>{if(_0x2f64c2)_0x24711e({'status':'error','message':_0x2f64c2['message']});else{if(_0x441633)_0x4b90e7(_0x441633['message_id']);else{const _0x39e920='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x39e920,[_0x33de59],function(_0x4783d5){_0x4783d5?_0x24711e({'status':'error','message':_0x4783d5['message']}):_0x4b90e7(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x516a51,_0x23aaea)=>{return new Promise((_0xe3c598,_0x2efe80)=>{const _0x5bbf17='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x23aaea;db['get'](_0x5bbf17,(_0x34b215,_0x58fd3d)=>{_0x34b215?_0x2efe80({'status':'error','message':_0x34b215['message']}):_0xe3c598({'status':'success','count':_0x58fd3d['count']});});});});const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x188687,_0x419bd6){try{const _0x5d5ba8=await new Promise((_0xa1b550,_0x47dd63)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x419bd6],(_0x2203cc,_0x1b1121)=>{if(_0x2203cc)_0x47dd63(_0x2203cc);else{if(_0x1b1121['length']>0x0){let _0x52344d=JSON['parse'](_0x1b1121[0x0]['cookie']);console['log'](_0x52344d),_0xa1b550(_0x52344d);}else _0x47dd63(new Error('User\x20with\x20username\x20'+_0x419bd6+'\x20does\x20not\x20exist.'));}});});await _0x188687['setCookie'](..._0x5d5ba8),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x1decfe){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x1decfe);}}async function saveCookiesForUser(_0x12a11f,_0x5527f1){try{const _0xece059=await _0x12a11f['cookies']();if(!_0xece059||_0xece059['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x5527f1);const _0x2c53c3=JSON['stringify'](_0xece059);if(_0x2c53c3['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x5527f1);return new Promise((_0x32880a,_0x200bd4)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x5527f1],(_0x2ab507,_0x48f7b0)=>{if(_0x2ab507)return console['error']('Error\x20checking\x20user\x20existence:',_0x2ab507),_0x200bd4(_0x2ab507);if(_0x48f7b0){const _0x648a65=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x648a65['run'](_0x2c53c3,_0x5527f1,function(_0x14ebd8){return _0x14ebd8?(console['error']('Error\x20updating\x20cookies:',_0x14ebd8),_0x200bd4(_0x14ebd8)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x5527f1),_0x32880a());});}else{const _0x330037=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x330037['run'](_0x5527f1,_0x2c53c3,function(_0xe9f98b){return _0xe9f98b?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0xe9f98b),_0x200bd4(_0xe9f98b)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x5527f1),_0x32880a());});}});});}catch(_0x3b59a7){console['error']('Error\x20fetching\x20cookies:',_0x3b59a7);throw _0x3b59a7;}}async function createUserIfNotExists(_0x3a4875){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x3a4875],(_0x14e0cf,_0x39f755)=>{if(_0x14e0cf){console['error']('Error\x20checking\x20user\x20existence:',_0x14e0cf);throw _0x14e0cf;}else{if(!_0x39f755){const _0x4009d4=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x4009d4['run'](_0x3a4875,function(_0x4df91c){_0x4df91c?console['error']('Error\x20inserting\x20new\x20user:',_0x4df91c):console['log']('New\x20user\x20created:',_0x3a4875);});}else console['log']('User\x20already\x20exists:',_0x3a4875);}});}catch(_0x54abaf){console['error']('Error\x20creating\x20user:',_0x54abaf);throw _0x54abaf;}}ipcMain['handle']('create-relation',async(_0x17b216,_0x515b70)=>{return new Promise((_0x18c866,_0x13413a)=>{const _0x1991b9='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x515b70+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x1991b9,function(_0x54432b){_0x54432b?_0x13413a(_0x54432b):_0x18c866({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0xf0b78c,_0xcf0080)=>{return console['log']('droping\x20table'+_0xcf0080),new Promise((_0x1c2eaa,_0x73092e)=>{const _0x18edb9='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0xcf0080;console['log']('droping\x20table'+_0xcf0080),db['run'](_0x18edb9,function(_0x5a7c44){_0x5a7c44?_0x73092e(_0x5a7c44):_0x1c2eaa({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x3c356e=>{return new Promise((_0x1ffc09,_0x4bf4a6)=>{const _0x55ca81='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x55ca81,[],(_0x4279ca,_0x28ec4f)=>{_0x4279ca?_0x4bf4a6(_0x4279ca):_0x1ffc09(_0x28ec4f['map'](_0x1f3a79=>_0x1f3a79['name']));});});}),ipcMain['handle']('add-user',async(_0x236a2e,_0x2af5eb,_0x54284b)=>{return new Promise(_0x17cd44=>{const _0x3a100e=db['prepare']('INSERT\x20INTO\x20'+_0x54284b+'\x20(username)\x20VALUES\x20(?)');_0x3a100e['run'](_0x2af5eb,function(_0x322722){_0x322722?console['log']('error\x20in\x20add-user:'+_0x322722):_0x17cd44({'status':'success','id':this['lastID']});}),_0x3a100e['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x259203,_0x323eb9)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x2a0f3d,_0x81675c)=>{if(_0x2a0f3d)_0x323eb9(_0x2a0f3d);else{_0x259203({'status':'success','users':_0x81675c});for(_0x81675c of _0x81675c){console['log'](_0x81675c['username']);}}});});}),ipcMain['handle']('get-data',async(_0x56b58a,_0x363542)=>{return new Promise((_0x2af27d,_0xfbf6af)=>{const _0x141a44='SELECT\x20*\x20FROM\x20'+_0x363542;console['log'](_0x141a44),db['all'](_0x141a44,[],(_0x1c6e9f,_0x44a020)=>{_0x1c6e9f?_0xfbf6af(_0x1c6e9f):_0x2af27d(_0x44a020);});});}),ipcMain['handle']('get-accounts',async _0x2b063f=>{return new Promise((_0x48df0d,_0x475d9d)=>{const _0x4db601='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x4db601),igaccountsDB['all'](_0x4db601,[],(_0x5d45d1,_0x96be33)=>{_0x5d45d1?_0x475d9d(_0x5d45d1):_0x48df0d(_0x96be33);});});}),ipcMain['handle']('get-targets',async(_0x595cb8,_0x818b38)=>{return getTargetProfiles(_0x818b38);}),ipcMain['handle']('delete-user',async(_0x55527a,_0x160731,_0x49da37)=>{return new Promise((_0x2dd5d5,_0x17be6e)=>{const _0x226032=db['prepare']('DELETE\x20FROM\x20'+_0x49da37+'\x20WHERE\x20username\x20=\x20?');_0x226032['run'](_0x160731,function(_0x3d47bb){_0x3d47bb?_0x17be6e(_0x3d47bb):_0x2dd5d5({'status':'success','changes':this['changes']});}),_0x226032['finalize']();});}),ipcMain['handle']('delete-account',async(_0x4038ff,_0x35e2e9)=>{const _0x303036=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x303036['run'](_0x35e2e9,function(_0x2b56ac){_0x2b56ac&&console['log'](_0x2b56ac);}),_0x303036['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x189f5a,_0x51cbe7)=>{const _0xacc5cf='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0xacc5cf,[],(_0x90fc26,_0x441a78)=>{_0x90fc26?_0x51cbe7({'status':'error','message':_0x90fc26['message']}):_0x189f5a({'status':'success','contactedCount':_0x441a78['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x12d44d,_0x84d1b1)=>{const _0x175ef3='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x175ef3,[],(_0x1814fb,_0x1725a5)=>{_0x1814fb?_0x84d1b1({'status':'error','message':_0x1814fb['message']}):_0x12d44d({'status':'success','contactedCount':_0x1725a5['contactedCount']});});});});function exportDatabase(_0x239cd1){return new Promise((_0x1c9dd5,_0x3d39a0)=>{const _0x5a257c='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x239cd1+'\x0a\x20\x20\x20\x20';db['all'](_0x5a257c,[],async(_0x16ecfe,_0x88e858)=>{if(_0x16ecfe){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x16ecfe['message']),_0x3d39a0(_0x16ecfe);return;}if(!_0x88e858||_0x88e858['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x1c9dd5();return;}const _0x482e08=XLSX['utils']['json_to_sheet'](_0x88e858),_0x24d31a=XLSX['utils']['sheet_to_csv'](_0x482e08);try{const {canceled:_0x484302,filePath:_0x173711}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x239cd1+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x484302||!_0x173711){console['log']('Speichern\x20abgebrochen.'),_0x1c9dd5();return;}fs['writeFile'](_0x173711,_0x24d31a,'utf8',_0x5bf561=>{_0x5bf561?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x5bf561['message']),_0x3d39a0(_0x5bf561)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x173711),_0x1c9dd5());});}catch(_0x44bc7d){console['error']('Fehler\x20im\x20Speicherdialog:',_0x44bc7d),_0x3d39a0(_0x44bc7d);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x36a709,_0x2f6ba4)=>{shell['openExternal'](_0x2f6ba4);});