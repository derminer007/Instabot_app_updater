const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');async function extractFirstName(_0x490b22,_0x149ac8){try{const _0x544eb1=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x149ac8},'body':JSON['stringify']({'clearname':_0x490b22})});if(!_0x544eb1['ok']){const _0x3e84e9=await _0x544eb1['text']();throw new Error(_0x544eb1['status']+':\x20'+_0x3e84e9);}const _0x3d2232=await _0x544eb1['json']();return _0x3d2232;}catch(_0x1655e4){console['error']('Error\x20in\x20extractFirstName:',_0x1655e4);throw _0x1655e4;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div:has(>\x20div[style=\x22height:\x20auto;\x20overflow:\x20hidden\x20auto;\x22])',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='[style=\x22line-height:\x2018px;\x22]',COM_COMMENTS_BOX_BODY_DIV='div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='//span[contains(.,\x20\x27View\x20all\x27)\x20and\x20contains(.,\x20\x27replies\x27)]',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Message\x27]','div.x9f619.xjbqb8w.x78zum5.x15mokao.x1ga7v0g.x16uus16.xbiv7yw.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div','div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div'],K_OPTIONS_BUTTON=['[aria-label=\x22Options\x22]','section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.x1jfgfrl\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div'],K_EXPAND_MSG_BUTTON='[aria-label=\x22Expand\x22]',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD=['[aria-label=\x22Message\x22]','div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f'],K_SEND_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Send\x27]','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_ALREADY_CHATTED='[aria-label=\x22Like\x22]',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',K_BEITRAG_ARRAY_SELECTOR='._aagv',K_BEITRAG_LIKE_BUTTON='section\x20>\x20span\x20>\x20div\x20>\x20div',K_STORY_ARRAY_SELECTOR='._acaz',K_STORY_LIKE_BUTTON='div.x6s0dn4.x78zum5.x67bb7w\x20>\x20div.x78zum5.xvc5jky\x20>\x20span\x20>\x20div\x20>\x20div',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x59d4c3=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x59d4c3['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x59d4c3['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x1ffd6f){var _0x4afc12=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x41bd82){console['log']('window\x20id:'+_0x41bd82['id']),_0x41bd82['id']>0x1&&(_0x4afc12=!![]);}),console['log']('child\x20opened\x20='+_0x4afc12);if(!_0x4afc12){const _0x4758ea=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x4758ea['loadFile'](_0x1ffd6f['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x4a61e3=require('fs'),_0x5e044f=path['join'](app['getPath']('userData'),'data'),_0x5d0ef6=['campaign.db','crm.db','igaccounts.db'],_0x4f34f9=[];try{_0x4a61e3['mkdirSync'](_0x5e044f,{'recursive':!![]});for(const _0x1b09ca of _0x5d0ef6){const _0x5a4476=path['join'](process['resourcesPath'],'app','build','data',_0x1b09ca),_0x3312aa=path['join'](_0x5e044f,_0x1b09ca);!_0x4a61e3['existsSync'](_0x3312aa)?(_0x4a61e3['copyFileSync'](_0x5a4476,_0x3312aa),console['log']('[InitDB]\x20Kopiert\x20'+_0x1b09ca+'\x20nach:\x20'+_0x3312aa)):console['log']('[InitDB]\x20'+_0x1b09ca+'\x20existiert\x20bereits:\x20'+_0x3312aa),_0x4f34f9['push'](_0x3312aa);}}catch(_0x67b4ec){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x67b4ec);}return _0x4f34f9;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0xdc279f,AppUpdate:_0x52705d}=require('electron-updater');_0xdc279f['autoDownload']=![],_0xdc279f['autoInstallOnAppQuit']=!![],_0xdc279f['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0xdc279f['on']('update-available',_0x532cb4=>{console['log']('Update\x20verfügbar:',_0x532cb4),_0xdc279f['downloadUpdate']();}),_0xdc279f['on']('update-downloaded',_0x4a899e=>{console['log']('Update\x20heruntergeladen:',_0x4a899e),_0xdc279f['quitAndInstall']();}),_0xdc279f['on']('error',_0x43ad7c=>{console['error']('Fehler\x20beim\x20Updaten:',_0x43ad7c);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x5149cd,AppUpdate:_0x1887cf}=require('electron-updater');_0x5149cd['autoDownload']=![],_0x5149cd['autoInstallOnAppQuit']=!![],_0x5149cd['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x5149cd['on']('update-available',_0x4d4026=>{console['log']('Update\x20verfügbar:',_0x4d4026),_0x5149cd['downloadUpdate']();}),_0x5149cd['on']('update-downloaded',_0x21e39a=>{console['log']('Update\x20heruntergeladen:',_0x21e39a),console['log']('Neustarten\x20zum\x20Updaten');}),_0x5149cd['on']('error',_0x3f2174=>{console['error']('Fehler\x20beim\x20Updaten:',_0x3f2174);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let isHeadless=!![],browser_login=null;async function getBrowserPageLogin(){let _0x4e685f='',_0x4e6485=null;if(process['platform']==='darwin')_0x4e685f=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x4e685f=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x4e685f}),_0x4e6485=await browser_login['newPage'](),_0x4e6485['setDefaultNavigationTimeout'](0x3a98),_0x4e6485['setDefaultTimeout'](0x3a98),await _0x4e6485['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x4e6485;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x32e5c0=0x1,_0x5e6670=0x0){try{let _0x4aa49b='',_0x4c4249=null;const _0x5434c5=isHeadless;if(process['platform']==='darwin')_0x4aa49b=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x4aa49b=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x32e5c0===0x0&&!pageStack[_0x5e6670])return browser=await puppeteer['launch']({'headless':_0x5434c5,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x4aa49b}),_0x4c4249=await browser['newPage'](),_0x4c4249['setDefaultNavigationTimeout'](0x3a98),_0x4c4249['setDefaultTimeout'](0x3a98),await _0x4c4249['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x5e6670]=_0x4c4249,_0x4c4249;return(browser===null||pageStack[_0x5e6670]===null||pageStack[_0x5e6670]['isClosed']())&&(browser=await puppeteer['launch']({'headless':isHeadless,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x4aa49b})),(pageStack[_0x5e6670]===null||pageStack[_0x5e6670]['isClosed']())&&(_0x4c4249=await browser['newPage'](),_0x4c4249['setDefaultNavigationTimeout'](0x3a98),_0x4c4249['setDefaultTimeout'](0x3a98),await _0x4c4249['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x5e6670]=_0x4c4249),pageStack[_0x5e6670];}catch(_0x3cc9c2){console['error']('Failed\x20to\x20launch\x20browser:',_0x3cc9c2);const _0x193c1d=new Error('Browser\x20konnte\x20nicht\x20gestartet\x20werden.\x20Bitte\x20starte\x20die\x20App\x20neu.\x20:\x20'+_0x3cc9c2);throw _0x193c1d;}}ipcMain['on']('login',async(_0x2e8951,_0x3b3a81)=>{const _0x1a3f20=await getBrowserPageLogin();await _0x1a3f20['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x1a3f20,_0x3b3a81),ipcMain['on']('setLoginCookies',async(_0x15b448,_0x37b28b)=>{try{await set_login_cookies(_0x1a3f20,_0x37b28b);}catch(_0x3f3890){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x3f3890);}});}),ipcMain['handle']('set-headless',async(_0x24f7d7,_0x483fc)=>{return isHeadless=!!_0x483fc,console['log']('[MAIN]\x20isHeadless\x20gesetzt\x20auf:',isHeadless),{'ok':!![],'headless':isHeadless};}),ipcMain['handle']('get-headless',async()=>{return{'headless':isHeadless};}),ipcMain['on']('export-relation',async(_0x3db298,_0x5ec7e9)=>{try{await exportDatabase(_0x5ec7e9),_0x3db298['reply']('export-relation-response',{'success':!![]});}catch(_0x56311a){console['error'](_0x56311a),_0x3db298['reply']('export-relation-response',{'success':![],'message':_0x56311a['message']});}}),ipcMain['handle']('sendMessage',async(_0x704890,_0x49fa69,_0x44e566,_0x308f39,_0x5a9a2a,_0x3fb633,_0x2b9482,_0x5970b6,_0xaa6b8f,_0x14ae93,_0x88aa60,_0x41d2d5,_0x4688cf)=>{isStopping=![];let _0x4b6caa=null;return _0x2b9482?_0x4b6caa=await getBrowserPage(_0x5a9a2a,_0x5970b6):_0x4b6caa=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x49fa69),send_message(_0x4b6caa,_0x49fa69,_0x44e566,_0x308f39,_0x5a9a2a,_0x3fb633,_0xaa6b8f,_0x14ae93,_0x88aa60,_0x41d2d5,_0x4688cf);}),ipcMain['handle']('stop-action',async(_0x36e262,_0x18d644)=>{isStopping=!![];const _0x2df783=await getBrowserPage(0x1,_0x18d644);await _0x2df783['close']();}),ipcMain['handle']('fetch_followers',async(_0x22f33c,_0x227981,_0x1d36b9,_0x1b55aa,_0x53fe4a,_0x589932,_0x23cd0e)=>{isStopping=![];const _0x51ea26=await getBrowserPage();return fetch_followers_from_account(_0x22f33c,_0x51ea26,_0x227981,_0x1d36b9,_0x1b55aa,_0x53fe4a,_0x589932,_0x23cd0e);}),ipcMain['handle']('get-account-details',async(_0x1bd396,_0x4b54c1,_0x6aa740,_0x4b4627)=>{isStopping=![];const _0x25e95a=await getBrowserPage();return fetch_account_details(_0x25e95a,_0x4b54c1,_0x6aa740,_0x4b4627);}),ipcMain['handle']('fetch_likes',async(_0x533b06,_0x4fc0e9,_0x33610b,_0x4d4d8f,_0x3b5304,_0x195dda,_0xa2bfaf)=>{isStopping=![];const _0x38e563=await getBrowserPage();return fetch_likers_from_post(_0x533b06,_0x38e563,_0x4fc0e9,_0x33610b,_0x4d4d8f,_0x3b5304,_0x195dda,_0xa2bfaf);}),ipcMain['handle']('fetch_comments',async(_0x47f923,_0x512873,_0x3109db,_0x1fcfce,_0x569ede,_0xa428d5,_0x3f41ef)=>{isStopping=![];const _0x3af081=await getBrowserPage();return fetch_comments_from_post(_0x47f923,_0x3af081,_0x512873,_0x3109db,_0x1fcfce,_0x569ede,_0xa428d5,_0x3f41ef);});async function updateAppSilent(){const {spawn:_0x2f6758}=require('child_process'),_0x22c4c9=require('path'),_0x43c2cb=require('electron-log');return _0x43c2cb['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x1f500a,_0x5e181d)=>{const {updateElectronApp:_0x18519b,UpdateSourceType:_0x1c361d}=require('update-electron-app');_0x18519b({'updateSource':{'type':_0x1c361d['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x43c2cb}),_0x1f500a('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x1ea360,_0x2d29a6)=>{doFullElectronUpdateSilent(),_0x1ea360('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x5764e3}=require('child_process'),_0x1e9a6d=require('path'),_0x33a277=require('electron-log');return _0x33a277['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x56bde0,_0x4dabee)=>{const {updateElectronApp:_0x3a70d7,UpdateSourceType:_0x40f24c}=require('update-electron-app');_0x3a70d7({'updateSource':{'type':_0x40f24c['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x33a277}),_0x56bde0('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x25eadf,_0xcdd7c5)=>{doFullElectronUpdate(),_0x25eadf('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0x2d9b11,_0x4798f1)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x2d9b11('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x3fc359=path['join'](__dirname,'mac-updater-intern.sh'),_0x3e2c85=spawn('/bin/bash',[_0x3fc359],{'detached':!![],'stdio':'ignore'});_0x3e2c85['unref'](),setTimeout(()=>{_0x2d9b11('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0x4798f1(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0xe37979=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x54020d,_0x4aa966)=>{console['log']('Update\x20Silent:\x20'+_0x4aa966);if(_0x4aa966){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0x1199c3,_0x1e47e1){return Math['random']()*(_0x1e47e1-_0x1199c3+0x1)+_0x1199c3;}function delay(_0x92d768,_0x3828d2){let _0xffe110=getRnd(_0x92d768,_0x3828d2);return new Promise(function(_0x30fdd2){setTimeout(_0x30fdd2,_0xffe110);});}async function scroll(_0x43c9d8,_0x33aed9,_0x1950d7=0x2,_0x15341b){const _0x207772=await _0x43c9d8['waitForSelector'](_0x33aed9);for(let _0x10ce44=0x0;_0x10ce44<_0x1950d7;_0x10ce44++){console['log']('Scrolling\x20'+_0x10ce44),await _0x43c9d8['evaluate'](_0x30f986=>{const _0x2c65ec=document['querySelector'](_0x30f986);_0x2c65ec&&_0x2c65ec['scrollBy'](0x0,0x190);},_0x33aed9),await delay(0x320,0x5dc),_0x15341b();}}async function saveCookies(_0x12c081){let _0x5e77b7=await _0x12c081['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x5e77b7,null,0x2));}async function notificationClear(_0x66d9cc){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xfa0,0x1388),await _0x66d9cc['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x66d9cc['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x4165d6){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x4165d6);}}async function getTargetProfiles(_0x4cbf17){return new Promise((_0x2074fa,_0x51b1f9)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x4cbf17,(_0x5e2b7f,_0x245568)=>{_0x5e2b7f?_0x51b1f9(_0x5e2b7f):_0x2074fa(_0x245568);});});}async function login_legacy(_0x4163f5,_0x1271ae,_0x4ce46d){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x4163f5,_0x1271ae),await createUserIfNotExists(_0x1271ae,_0x4ce46d);}catch(_0x4d2371){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4d2371);}try{await _0x4163f5['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x4163f5['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x4163f5['click']('button._a9--._ap36._a9_0');}catch(_0x4e9046){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x4163f5['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x4163f5['type']('input[name=\x27username\x27]',_0x1271ae,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x4163f5['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x4163f5['type']('input[name=\x27password\x27]',_0x4ce46d,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x4163f5['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x4163f5['click']('button[type=\x27submit\x27]');}catch(_0x15ed03){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x4163f5),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x4163f5,_0x1271ae);}catch(_0x14b1c9){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x14b1c9);}}catch(_0x3b1e98){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x3b1e98);}}async function login(_0x4b92aa,_0x5f48c6){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x4b92aa,_0x5f48c6),await createUserIfNotExists(_0x5f48c6);}catch(_0x26dd8f){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x26dd8f);}try{await _0x4b92aa['goto']('https://www.instagram.com/accounts/login/');}catch(_0x1ba09f){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x1ba09f);}}async function set_login_cookies(_0x235d32,_0x21c876){try{await saveCookiesForUser(_0x235d32,_0x21c876);}catch(_0x3db7ec){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x3db7ec);}}async function waitForXPath(_0x465a05,_0x4d0eb8,_0x37ffac={}){return await _0x465a05['waitForFunction'](_0x445fb9=>{return document['evaluate'](_0x445fb9,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x37ffac,_0x4d0eb8),_0x465a05['evaluateHandle'](_0x5e4064=>document['evaluate'](_0x5e4064,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x4d0eb8);}async function waitForSelectorWithFallbacks(_0x2252d0,_0x46f133,_0x449ea8={}){!Array['isArray'](_0x46f133)&&(_0x46f133=[_0x46f133]);for(let _0x487151=0x0;_0x487151<_0x46f133['length'];_0x487151++){const _0x8c47e5=_0x46f133[_0x487151],_0x255da9=_0x8c47e5['startsWith']('//')||_0x8c47e5['startsWith']('(//');try{console['log']('Versuche\x20'+(_0x255da9?'XPath':'Selector')+'\x20'+(_0x487151+0x1)+'/'+_0x46f133['length']+':\x20'+_0x8c47e5['substring'](0x0,0x32)+'...');const _0x4490af=_0x487151===0x0?_0x449ea8['timeout']||0x1388:0x7d0;let _0x435b5c;if(_0x255da9){const _0x13bd75=await waitForXPath(_0x2252d0,_0x8c47e5,{..._0x449ea8,'timeout':_0x4490af});if(!_0x13bd75)throw new Error('XPath-Element\x20nicht\x20gefunden');_0x435b5c=_0x13bd75;}else _0x435b5c=await _0x2252d0['waitForSelector'](_0x8c47e5,{..._0x449ea8,'timeout':_0x4490af});return console['log']((_0x255da9?'XPath':'Selector')+'\x20'+(_0x487151+0x1)+'\x20gefunden!'),_0x435b5c;}catch(_0x1bc73a){console['log']((_0x255da9?'XPath':'Selector')+'\x20'+(_0x487151+0x1)+'\x20nicht\x20gefunden:\x20'+_0x1bc73a['message']);if(_0x487151===_0x46f133['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x46f133['length']+'\x20Selektoren/XPath\x20konnte\x20gefunden\x20werden:\x20'+_0x1bc73a['message']);}}throw new Error('Keine\x20Selektoren/XPath\x20angegeben');}async function waitForXPathAll(_0x228804,_0x13ad88,_0x300996={}){return await _0x228804['waitForFunction'](_0x441a68=>{return document['evaluate'](_0x441a68,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null)['snapshotLength']>0x0;},_0x300996,_0x13ad88),_0x228804['evaluateHandle'](_0x67906c=>{const _0x381828=document['evaluate'](_0x67906c,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null),_0x1e2212=[];for(let _0x1a4b83=0x0;_0x1a4b83<_0x381828['snapshotLength'];_0x1a4b83++){_0x1e2212['push'](_0x381828['snapshotItem'](_0x1a4b83));}return _0x1e2212;},_0x13ad88)['then'](_0x4b381c=>_0x4b381c['getProperties']());}ipcMain['handle']('check-login',async(_0x8292d6,_0x19060e)=>{if(pageStack[0x0]){try{await pageStack[0x0]['close']();}catch(_0x1d10ad){}pageStack[0x0]=null;}if(browser){try{await browser['close']();}catch(_0x11050d){}browser=null;}const _0x3dcbce=await getBrowserPage(0x0,0x0),_0x1bba57=await checkCookiesSession(_0x3dcbce,_0x19060e);return _0x1bba57;});async function checkCookiesSession(_0x5c9bd0,_0x43dd0d){try{await setCookiesForUser(_0x5c9bd0,_0x43dd0d),console['log']('Cookies\x20für\x20'+_0x43dd0d+'\x20erfolgreich\x20geladen');}catch(_0x3e4d4d){return console['error']('Fehler\x20beim\x20Laden\x20der\x20Cookies\x20für\x20'+_0x43dd0d+':',_0x3e4d4d),![];}try{await _0x5c9bd0['goto']('https://www.instagram.com/',{'timeout':0x3a98});}catch(_0x49bb21){console['error']('Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x49bb21);}await delay(0x6a4,0x7d0);try{const _0x336924=await checkLoginStatus(_0x5c9bd0);return console['log']('Login-Status\x20für\x20'+_0x43dd0d+':\x20'+_0x336924),_0x336924;}catch(_0x130094){return console['warn']('Login-Prüfung\x20fehlgeschlagen\x20für\x20'+_0x43dd0d+':',_0x130094['message']),![];}}async function checkLoginStatus(_0x4f72d6){const _0x335964=['[type=\x22password\x22]','//a[normalize-space(text())=\x27Log\x20In\x27]','//div[@role=\x27button\x27\x20and\x20normalize-space(.)=\x27Log\x20in\x27]','//h3[normalize-space(text())=\x27Something\x20went\x20wrong\x27]'];let _0x2f4bf2=null;try{_0x2f4bf2=await waitForSelectorWithFallbacks(_0x4f72d6,_0x335964,{'timeout':0x7d0});}catch(_0x5a6855){return console['log']('Eingeloggt,\x20kein\x20Login\x20notwendig:\x20'+_0x5a6855),!![];}if(_0x2f4bf2){console['log']('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return![];}else return console['log']('Eingeloggt,\x20führe\x20keine\x20Login\x20durch'),!![];}async function checkPageExists(_0xaf8f0a){const _0x54e2cc=['//span[contains(normalize-space(.),\x22Sorry,\x20this\x20page\x20isn\x27t\x20available\x22)]'];let _0x42ef7c=null;try{_0x42ef7c=await waitForSelectorWithFallbacks(_0xaf8f0a,_0x54e2cc,{'timeout':0x7d0});}catch(_0x484064){return console['log']('Seite\x20existiert:\x20'+_0x484064),!![];}if(_0x42ef7c){console['log']('Angegbene\x20Seite\x20existiert\x20nicht');throw new Error('Angegbene\x20Seite\x20existiert\x20nicht');return![];}else return console['log']('Seite\x20existiert'),!![];}async function likeFirstPost(_0x30b8e3){try{const _0x5db8c9=await _0x30b8e3['$$'](K_BEITRAG_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Posts\x20gefunden:\x20'+_0x5db8c9['length']);if(_0x5db8c9&&_0x5db8c9['length']>0x0){const _0x2c749e=_0x5db8c9[0x0];await _0x2c749e['click'](),await delay(0xaf0,0xbb8);const _0x236063=await _0x30b8e3['evaluate'](()=>{const _0x408127=document['querySelector']('section\x20>\x20span\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20svg[aria-label=\x22Like\x22]');return!!_0x408127;});if(_0x236063){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus');const _0x1f4983=await _0x30b8e3['$$'](K_BEITRAG_LIKE_BUTTON),_0x33c189=_0x1f4983[0x0];await delay(0x514,0x5dc),await _0x30b8e3['evaluate'](_0x224835=>{_0x224835['click']();},_0x33c189);}else console['log']('Beitrag\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x30b8e3['goBack'](),await delay(0x7d0,0x898);}}catch(_0x43f48b){console['log']('Fehler\x20beim\x20Liken\x20des\x20ersten\x20Posts:',_0x43f48b);throw new Error('Like_Posts:\x20'+_0x43f48b);}}async function likeFirstStory(_0x3dbb05){try{const _0x3b3ace=await _0x3dbb05['$$'](K_STORY_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Stories\x20gefunden:\x20'+_0x3b3ace['length']);if(_0x3b3ace&&_0x3b3ace['length']>0x0){const _0x1b7f32=_0x3b3ace[0x0];await _0x1b7f32['click'](),await delay(0xaf0,0xbb8);const _0x51e738=await _0x3dbb05['evaluate'](()=>{const _0x5ec060=document['querySelector']('[aria-label=\x22Like\x22]');return!!_0x5ec060;});if(_0x51e738){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus'),await delay(0x514,0x5dc);try{const _0xff6e02=await _0x3dbb05['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0x3dbb05['click'](_0xff6e02);}catch(_0x11ef0d){console['log']('Direkter\x20Klick\x20fehlgeschlagen,\x20versuche\x20alternative\x20Methoden:',_0x11ef0d);try{const _0x2412b6=await _0x3dbb05['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0x3dbb05['evaluateHandle'](_0x12817d=>{_0x12817d['click']();},_0x2412b6);}catch(_0x454b1b){console['log']('Evaluatehandle\x20fehlgeschlagen,\x20versuche\x20JS-Click:',_0x454b1b),await _0x3dbb05['evaluate'](()=>{const _0x37eab0=document['querySelector']('[aria-label=\x22Like\x22]');if(_0x37eab0)_0x37eab0['click']();else throw new Error('Element\x20nicht\x20gefunden');});}}}else console['log']('Story\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x3dbb05['goBack'](),await delay(0x7d0,0x898);}}catch(_0x4d0d24){console['log']('Fehler\x20beim\x20Liken\x20der\x20ersten\x20Story:',_0x4d0d24);throw new Error('Like_Storys:\x20'+_0x4d0d24);}}async function send_message(_0x17544b,_0x5683e3,_0x1b59b2,_0x5b69f6,_0x596cc9,_0x3fef15,_0x4b1004,_0xd73291,_0x4c8858,_0x1262f8,_0x5001fe){return new Promise(async(_0x248567,_0x49d45d)=>{_0x3fef15=_0x3fef15['split'](';'),console['log'](_0x3fef15[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x596cc9);if(_0x5b69f6===null||_0x5b69f6===undefined){console['log']('Nachricht\x20ist\x20null\x20oder\x20undefined'),_0x49d45d('Nachricht\x20darf\x20nicht\x20leer\x20sein');return;}try{await setCookiesForUser(_0x17544b,_0x3fef15[0x0]);}catch(_0x4c544a){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x4c544a),_0x248567({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x4c544a});return;}await delay(0x6a4,0x7d0);try{await _0x17544b['goto']('https://www.instagram.com/'+_0x5683e3+'/'),await delay(0x1b58,0x1d4c),await notificationClear(_0x17544b);}catch(_0x3e6528){_0x248567({'status':0x1f5,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x3e6528});return;}try{await checkLoginStatus(_0x17544b);}catch(_0x5578c8){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x5578c8),_0x49d45d('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return;}if(_0x4c8858==0x1)try{await likeFirstPost(_0x17544b);}catch(_0x1c2cf8){_0x49d45d(_0x1c2cf8);}if(_0x1262f8==0x1)try{await likeFirstStory(_0x17544b);}catch(_0x29b488){_0x49d45d(_0x29b488);}console['log']('UserSkip:\x20'+_0x4b1004);if(_0x4b1004==0x1)try{const _0x4c88cc=await _0x17544b['$eval']('._ap3a._aaco._aacw._aad6._aade',_0xbabce1=>_0xbabce1['textContent']['trim']());console['log'](_0x4c88cc);if(_0x4c88cc==='Following'||_0x4c88cc==='Folge\x20ich')return _0x248567({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x495892){}try{const _0x2ae06e=await waitForSelectorWithFallbacks(_0x17544b,K_DIRECT_MSG_BUTTON);await _0x2ae06e['click'](),await delay(0x6a4,0x7d0);try{const _0x3fc233=await waitForSelectorWithFallbacks(_0x17544b,K_EXPAND_MSG_BUTTON);await _0x3fc233['click']();}catch(_0x34fbba){console['log']('Expand-Button\x20nicht\x20gefunden.\x20Überspringen:\x20'+_0x34fbba);}}catch(_0x55fba4){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x55fba4);try{await delay(0x6a4,0x7d0);try{const _0x4f15d5=await waitForSelectorWithFallbacks(_0x17544b,K_OPTIONS_BUTTON);await _0x4f15d5['click']();}catch(_0x555e3c){console['log']('Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x555e3c),_0x248567({'status':0x1f6,'message':'Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x555e3c});return;}await delay(0x3e8,0x44c);const _0x346cbd=await waitForXPath(_0x17544b,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x346cbd['click']();}catch(_0x5045a6){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x5045a6),_0x248567({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x708,0x7d0),await notificationClear(_0x17544b);}catch(_0x35a673){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x35a673);}try{await delay(0x708,0x7d0);const _0x273db8=await waitForSelectorWithFallbacks(_0x17544b,K_CHAT_INPUT_FIELD,{'visible':!![],'timeout':0x3a98});if(_0xd73291){const _0x36e0ed=await _0x17544b['$'](K_ALREADY_CHATTED);if(_0x36e0ed)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x5683e3),_0x248567({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x2b4c8b=await _0x17544b['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x2b4c8b),_0x5b69f6=_0x5b69f6['replace']('{USERNAME}',_0x5683e3);let _0x3d7d3f;if(_0x5b69f6['includes']('{NAME}')||_0x5b69f6['includes']('{name}'))try{const _0x145277=await extractFirstName(_0x2b4c8b,_0x5001fe);console['log']('Response\x20Clearname\x20valid:\x20'+_0x145277['valid']),_0x145277['valid']?(_0x5b69f6=_0x5b69f6['replaceAll'](/{NAME}|{name}/g,_0x145277['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x145277['name']),_0x3d7d3f=_0x145277['name']):(_0x5b69f6=_0x5b69f6['replaceAll'](/ ?({NAME}|{name})/g,''),_0x3d7d3f='UNKNOWN_NAME');}catch(_0x91e201){console['log'](_0x91e201['message']),_0x3d7d3f=_0x91e201['message'];const _0x3ef469=_0x2b4c8b?_0x2b4c8b['replace'](/[^\p{L}\s]/gu,''):'',_0x25144d=_0x3ef469['split']('\x20')[0x0]||'';_0x25144d['length']>0x2&&!_0x25144d['includes']('Instagram')?_0x5b69f6=_0x5b69f6['replaceAll'](/{NAME}|{name}/g,_0x25144d):_0x5b69f6=_0x5b69f6['replaceAll'](/ ?({NAME}|{name})/g,'');}console['log']('Nachricht\x20vor\x20dem\x20Senden:\x20'+_0x5b69f6);const _0xb2fa0a=_0x5b69f6['split']('\x0a');await _0x273db8['type'](_0xb2fa0a[0x0],{'delay':getRnd(0x50,0x78)});for(let _0x4567ca=0x1;_0x4567ca<_0xb2fa0a['length'];_0x4567ca++){await _0x17544b['keyboard']['down']('Shift'),await _0x17544b['keyboard']['press']('Enter'),await _0x17544b['keyboard']['up']('Shift'),await delay(0x64,0xc8),_0xb2fa0a[_0x4567ca]['length']>0x0&&await _0x273db8['type'](_0xb2fa0a[_0x4567ca],{'delay':getRnd(0x50,0x78)});}console['log']('Nachricht\x20mit\x20Zeilenumbrüchen\x20gesendet'),await delay(0x320,0x3e8);try{const _0x202b76=await waitForSelectorWithFallbacks(_0x17544b,K_SEND_MSG_BUTTON);await _0x202b76['click']();}catch(_0x153899){console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x153899),_0x248567({'status':0x195,'message':'Send\x20nicht\x20gefunden.\x20Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x5683e3+'\x20überspringen.','error':_0x153899['message']});}await delay(0x320,0x3e8),_0x248567({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x2b4c8b,'extracted_clearname':_0x3d7d3f});}catch(_0x45996b){let _0x19069a=_0x45996b;console['log']('Fehler\x20beim\x20Senden\x20der\x20Nachricht:\x20'+_0x19069a),_0x248567({'status':0x1f4,'message':'Error\x20500:\x20'+_0x19069a});}});}function handle_fail(_0x2825d2){if(isStopping)return new Promise(_0x22e7f4=>{_0x22e7f4('Scraper\x20gestoppt.');});else{let _0x50e67c='';switch(_0x2825d2){case 0x0:_0x50e67c='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x50e67c='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x50e67c='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x50e67c='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x20d8b2,_0x152784)=>{_0x152784(_0x50e67c);});}}async function fetch_account_details(_0x91db92,_0x432757,_0x407be7,_0x32c81c){try{await setCookiesForUser(_0x91db92,_0x407be7['username']);}catch(_0x30e4cc){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x30e4cc);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x30e4cc);return handle_fail(0x0);}_0x91db92['setDefaultNavigationTimeout'](0x7530),await _0x91db92['goto']('https://www.instagram.com/'+_0x432757+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x91db92);const _0x88b656=await _0x91db92['evaluate'](()=>{const _0x145845=document['querySelector']('meta[property=\x22og:image\x22]');return _0x145845?_0x145845['getAttribute']('content'):null;});await _0x91db92['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x154f82=await _0x91db92['evaluate'](()=>{const _0x25a95e=document['querySelector']('meta[name=\x22description\x22]');if(!_0x25a95e)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x29c6ae=_0x25a95e['getAttribute']('content');if(!_0x29c6ae)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x29c6ae);const _0x38983e=/\s*[–-]\s*/,_0x5bbbcb=_0x29c6ae['split'](_0x38983e);if(_0x5bbbcb['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x32018f=_0x5bbbcb[0x0],_0x2c3eeb=_0x5bbbcb[0x1],_0x1c0446=_0x32018f['split'](',\x20');if(_0x1c0446['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x7013d3=_0x1c0446[0x0]['split']('\x20')[0x0],_0x259a45=_0x1c0446[0x1]['split']('\x20')[0x0],_0x48363c=_0x1c0446[0x2]['split']('\x20')[0x0];let _0x2dfaea='',_0x33c825='';const _0x336a82='\x20on\x20Instagram:\x20',_0x28425a=_0x2c3eeb['split'](_0x336a82);return _0x2dfaea=_0x28425a[0x0]['trim'](),_0x2dfaea=_0x2dfaea['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x28425a['length']>0x1&&(_0x33c825=_0x28425a[0x1]['trim'](),_0x33c825['startsWith']('\x22')&&_0x33c825['endsWith']('\x22')&&(_0x33c825=_0x33c825['substring'](0x1,_0x33c825['length']-0x1)['trim']()),_0x33c825=_0x33c825['replace'](/&quot;/g,'')['trim']()),{'followers':_0x7013d3,'following':_0x259a45,'posts':_0x48363c,'nameText':_0x2dfaea,'bio':_0x33c825};});console['log']('Extracted\x20profile\x20data:',_0x154f82);const _0x248a15=_0x154f82['nameText'],_0x2d57ca=_0x88b656,_0x2376d1=_0x154f82['bio'],_0x1136f9=_0x154f82['followers'],_0x3bf7cd=_0x154f82['following'],_0x35ba91=_0x154f82['posts'],_0x3f96c7=![],_0x375ae4=![],_0x591e5b=![],_0x3ad05c='\x0a\x20\x20INSERT\x20INTO\x20'+_0x32c81c+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x3ad05c,[_0x432757,_0x248a15,_0x2d57ca,_0x2376d1,_0x1136f9,_0x3bf7cd,_0x35ba91,_0x3f96c7,_0x375ae4,_0x591e5b],function(_0x356e2f){_0x356e2f?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x356e2f['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x40ee48,_0x29e20c,_0x49a93f,_0x38717a,_0x2317ae,_0x544372,_0x2502c1,_0x31002f){let _0x46715c=0x4,_0x251732=0x0,_0x26dbcd=0x0;try{await setCookiesForUser(_0x29e20c,_0x544372['username']);}catch(_0x111b1a){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x111b1a);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x111b1a);return handle_fail(0x0);}let _0x5aa40b=0x0;try{await _0x29e20c['goto']('https://www.instagram.com/'+_0x49a93f+'/'),await notificationClear(_0x29e20c);try{await checkLoginStatus(_0x29e20c);}catch(_0x3b16ef){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x3b16ef);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x29e20c);}catch(_0x1aa509){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x1aa509);throw new Error('Username\x20nicht\x20gefunden.\x20Existiert\x20der\x20Account?');}try{if(_0x38717a<=0x0){const _0x4e9cb5=await _0x29e20c['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x248083=await _0x29e20c['evaluate'](_0x54e8da=>_0x54e8da['innerHTML'],_0x4e9cb5);_0x5aa40b=Math['ceil'](_0x248083/0x4);}else _0x5aa40b=Math['ceil'](_0x38717a/0x4);_0x46715c+=_0x5aa40b,_0x26dbcd=Math['round'](++_0x251732/_0x46715c*0x64),_0x40ee48['sender']['send']('fetch-progress',_0x26dbcd,!![]);let _0x4e61c4=await _0x29e20c['waitForSelector']('a[href=\x22/'+_0x49a93f+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x4e61c4['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x49a93f+'\x20gesichtet'),_0x26dbcd=Math['round'](++_0x251732/_0x46715c*0x64),_0x40ee48['sender']['send']('fetch-progress',_0x26dbcd,!![]);}catch(_0x32e448){console['log']('Follower\x20Liste\x20von\x20'+_0x49a93f+'\x20nicht\x20gefunden:'+_0x32e448);throw new Error('Follower\x20Liste\x20von\x20'+_0x49a93f+'\x20nicht\x20gefunden:'+_0x32e448);return handle_fail(0x0);}}catch(_0x3969b8){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x3969b8);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x3969b8);return handle_fail(0x0);}try{await delay(0x12c0,0x1388),console['log']('Auto-scrolls:\x20'+_0x5aa40b);try{await scroll(_0x29e20c,FOLLOWER_FENSTER,_0x5aa40b,_0x429ed1=>{});}catch{console['log']('Fallback\x20div:has\x20ausgelöst'),await scroll(_0x29e20c,'div.x6nl9eh.x1a5l9x9.x7vuprf.x1mg3h75.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',_0x5aa40b,_0x4aaba5=>{});}_0x26dbcd=Math['round'](++_0x251732/_0x46715c*0x64),_0x40ee48['sender']['send']('fetch-progress',_0x26dbcd,!![]),await _0x29e20c['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x25b678=await _0x29e20c['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x5e8a95=await _0x29e20c['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x26dbcd=Math['round'](++_0x251732/_0x46715c*0x64),_0x40ee48['sender']['send']('fetch-progress',_0x26dbcd,!![]);_0x38717a<=0x0&&(_0x38717a=_0x25b678['length']);let _0x519de9=[];for(let _0x231e69=0x0;_0x231e69<_0x25b678['length']&&_0x231e69<_0x38717a;_0x231e69++){const _0x4d4aa4=await _0x25b678[_0x231e69]['evaluate'](_0x345ed2=>_0x345ed2['textContent']),_0x33a10a=await _0x5e8a95[_0x231e69]['evaluate'](_0x34c295=>_0x34c295['textContent']);if(_0x31002f){const _0xc192f5=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x544372['username'],_0x4d4aa4]);if(_0xc192f5){console['log']('Skipping\x20already\x20contacted\x20follower:\x20'+_0x4d4aa4);continue;}}_0x519de9['push'](_0x4d4aa4);const _0x57f1ab='INSERT\x20INTO\x20'+_0x2317ae+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x57f1ab,[_0x4d4aa4,_0x33a10a],function(_0x32746a){_0x32746a?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x2317ae+'\x27:',_0x32746a['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x26dbcd=Math['round'](++_0x251732/_0x46715c*0x64),_0x40ee48['sender']['send']('fetch-progress',_0x26dbcd,!![]),_0x2502c1&&(_0x40ee48['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x40ee48,_0x29e20c,_0x544372,_0x2317ae,_0x519de9)),new Promise(_0x2d6be8=>{_0x2d6be8('Scraping\x20finished!');});}catch(_0x3ac489){if(_0x2502c1)throw new Error(_0x3ac489);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x49a93f+'\x20nicht\x20gefunden:\x20'+_0x3ac489);return handle_fail(0x0);}}async function fetch_details_from_list(_0x3dd160,_0x76d3af,_0x23d372,_0x5e6f7c,_0x179936){let _0x16a970=0x0,_0xe4a704=0x0;for(let _0xf9b2c6=0x0;_0xf9b2c6<_0x179936['length'];_0xf9b2c6++){console['log']('Processing\x20profile:',_0x179936[_0xf9b2c6]);try{await fetch_account_details(_0x76d3af,_0x179936[_0xf9b2c6],_0x23d372,_0x5e6f7c);}catch(_0x1bfc75){console['error']('Detailed\x20Scraping\x20von:\x20',_0x179936[_0xf9b2c6],_0x1bfc75);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x179936[_0xf9b2c6]+'\x20'+_0x1bfc75);}_0xe4a704=Math['round'](++_0x16a970/_0x179936['length']*0x64),_0x3dd160['sender']['send']('fetch-progress',_0xe4a704,!![],!![]);}}async function fetch_likers_from_post(_0x2e58c0,_0x5ef15a,_0x54cde7,_0x34572b,_0x1fa130,_0x57be89,_0x502593,_0x29fbaa){let _0xfe4cc5=0x4,_0x1fb557=0x0,_0x49a9d8=0x0;try{await setCookiesForUser(_0x5ef15a,_0x57be89['username']);}catch(_0x5d24b5){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x5d24b5);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x5d24b5);return handle_fail(0x1);}_0x49a9d8=Math['round'](++_0x1fb557/_0xfe4cc5*0x64),_0x2e58c0['sender']['send']('fetch-progress',_0x49a9d8,!![]);try{let _0x5d8b96=_0x54cde7['substring'](0x0,_0x54cde7['lastIndexOf']('/'));_0x5d8b96['includes']('/reel/')&&(_0x5d8b96=_0x5d8b96['replace']('/reel/','/p/'));let _0xab7c85=_0x5d8b96+'/liked_by';console['log'](_0xab7c85),await _0x5ef15a['goto'](_0xab7c85),await delay(0x7d0,0xfa0),await notificationClear(_0x5ef15a),await delay(0xc8,0x1f4);try{await checkLoginStatus(_0x5ef15a);}catch(_0x35174c){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x35174c);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x5ef15a);}catch(_0x172648){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x172648);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}_0x49a9d8=Math['round'](++_0x1fb557/_0xfe4cc5*0x64),_0x2e58c0['sender']['send']('fetch-progress',_0x49a9d8,!![]),await _0x5ef15a['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x1e0bb5=await _0x5ef15a['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x45fbd6=await _0x5ef15a['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x1e0bb5['length']);let _0x5d6aba=path['join'](__dirname,'/likers.csv');_0x49a9d8=Math['round'](++_0x1fb557/_0xfe4cc5*0x64),_0x2e58c0['sender']['send']('fetch-progress',_0x49a9d8,!![]);_0x34572b<=0x0&&(_0x34572b=_0x1e0bb5['length']);try{let _0x40a34a=[];for(let _0x39e506=0x0;_0x39e506<_0x1e0bb5['length']&&_0x39e506<_0x34572b;_0x39e506++){const _0x300561=await _0x1e0bb5[_0x39e506]['evaluate'](_0x3e9d0b=>_0x3e9d0b['textContent']),_0x581f23=await _0x45fbd6[_0x39e506]['evaluate'](_0x13d5de=>_0x13d5de['textContent']);if(_0x29fbaa){const _0xb9fe73=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x57be89['username'],_0x300561]);if(_0xb9fe73){console['log']('Skipping\x20already\x20contacted\x20liker:\x20'+_0x300561);continue;}}_0x40a34a['push'](_0x300561);const _0xf0b382='INSERT\x20INTO\x20'+_0x1fa130+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0xf0b382,[_0x300561,_0x581f23],function(_0x3dbe6b){_0x3dbe6b?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x1fa130+'\x27:',_0x3dbe6b['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x49a9d8=Math['round'](++_0x1fb557/_0xfe4cc5*0x64),_0x2e58c0['sender']['send']('fetch-progress',_0x49a9d8,!![]),_0x502593&&(_0x2e58c0['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x2e58c0,_0x5ef15a,_0x57be89,_0x1fa130,_0x40a34a)),new Promise(_0x43389a=>{_0x43389a('Scraping\x20finished!');});}catch(_0x4ec017){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x4ec017);return handle_fail(0x1);}}catch(_0x561cf6){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x561cf6);throw new Error('Like-Seite\x20nicht\x20geöffnet:\x20'+_0x561cf6);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x28b10b,_0x62bc8a,_0x5b8cb1,_0x562f9e,_0x1e28bb,_0x473d39,_0x4e342c,_0x217495){let _0x23d2ec=0x3,_0x5dcf29=0x0,_0x4eed14=0x0;try{await setCookiesForUser(_0x62bc8a,_0x473d39['username']);}catch(_0x143ddb){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x143ddb);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x143ddb);return handle_fail(0x2);}try{console['log'](_0x5b8cb1),await _0x62bc8a['goto'](_0x5b8cb1),await delay(0x7d0,0xfa0),await notificationClear(_0x62bc8a),await delay(0xc8,0x1f4);const _0x255187=COM_COMMENTS_BOX_BODY_DIV;try{await checkLoginStatus(_0x62bc8a);}catch(_0x30bcae){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x30bcae);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x62bc8a);}catch(_0x6d159f){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x6d159f);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}let _0xf980ba;const _0x5cc09e=await _0x62bc8a['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x3dbbfe=await _0x62bc8a['evaluate'](_0x3cd7a0=>_0x3cd7a0['innerHTML'],_0x5cc09e),_0x2b98cd=String(_0x3dbbfe)['replace'](/[^0-9]/g,''),_0x337c30=Number(_0x2b98cd)/0x14;_0x562f9e<=0x0?_0xf980ba=Math['ceil'](_0x337c30/0x3):_0xf980ba=Math['ceil'](_0x562f9e/0x3);_0x23d2ec+=_0xf980ba,_0x4eed14=Math['round'](++_0x5dcf29/_0x23d2ec*0x64),_0x28b10b['sender']['send']('fetch-progress',_0x4eed14,!![]),console['log']('Auto-scrolls:\x20'+_0xf980ba),await scroll(_0x62bc8a,_0x255187,_0xf980ba,_0x1e5b6a=>{_0x4eed14=Math['round'](++_0x5dcf29/_0x23d2ec*0x64),_0x28b10b['sender']['send']('fetch-progress',_0x4eed14,!![]);});try{const _0x515afc=COM_REPLY_BUTTON_SPAN,_0x46e676=await waitForXPathAll(_0x62bc8a,_0x515afc);console['log']('Reply-Buttons\x20gefunden:\x20ANZAHL:\x20'+_0x46e676['size']),await delay(0x1f4,0x320);let _0x392f07=_0x46e676['size'],_0x343c1f=[];for(const [_0x4e72fb,_0x5baeef]of _0x46e676){_0x343c1f['push'](_0x5baeef);}console['log']('Alle\x20Reply-Buttons:',_0x343c1f['length']);try{for(let _0x281a86=0x0;_0x281a86<_0x392f07;_0x281a86++){await _0x343c1f[_0x281a86]['click'](),await delay(0x320,0x5dc);}}catch(_0x22bd46){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x22bd46);throw new Error('Nicht\x20auf\x20Replies\x20geklickt:\x20'+_0x22bd46);return handle_fail(0x2);}}catch(_0x80fed4){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x151cde=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x62bc8a['waitForSelector'](_0x151cde),await delay(0x1f4,0x320),_0x4eed14=Math['round'](++_0x5dcf29/_0x23d2ec*0x64),_0x28b10b['sender']['send']('fetch-progress',_0x4eed14,!![]);const _0x40fe3e=await _0x62bc8a['$$'](_0x151cde);let _0x5136af=path['join'](__dirname,'/comments.csv');_0x562f9e<=0x0&&(_0x562f9e=_0x40fe3e['length']);console['log']('fetch_limit:\x20'+_0x562f9e),console['log']('comments_len:\x20'+_0x40fe3e['length']),_0x562f9e++;try{let _0x420da1=[];for(let _0x21623c=0x1;_0x21623c<_0x40fe3e['length']&&_0x21623c<_0x562f9e;_0x21623c++){const _0x9539c2=await _0x40fe3e[_0x21623c]['evaluate'](_0x379587=>_0x379587['textContent']);if(_0x217495){const _0x1f8c50=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x473d39['username'],_0x9539c2]);if(_0x1f8c50){console['log']('Skipping\x20already\x20contacted\x20commenter:\x20'+_0x9539c2);continue;}}try{_0x420da1['push'](_0x9539c2);const _0x4c974b='INSERT\x20INTO\x20'+_0x1e28bb+'\x20(username)\x20VALUES\x20(?)';db['run'](_0x4c974b,[_0x9539c2],function(_0x5a2889){_0x5a2889&&console['log']('error\x20in\x20add-user:'+_0x5a2889);});}catch(_0x300576){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x21623c+'\x20:\x20'+_0x300576);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x21623c+'\x20:\x20'+_0x300576);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x4eed14=Math['round'](++_0x5dcf29/_0x23d2ec*0x64),_0x28b10b['sender']['send']('fetch-progress',_0x4eed14,!![]),_0x28b10b['sender']['send']('fetch-progress',0x64,!![]),_0x4e342c&&(_0x28b10b['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x28b10b,_0x62bc8a,_0x473d39,_0x1e28bb,_0x420da1)),_0x28b10b['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x5eaba8=>{_0x5eaba8('Scraping\x20finished!');});}catch(_0x188373){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x188373);return handle_fail(0x2);}}catch(_0xed7965){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0xed7965);throw new Error('Comments-Seite\x20nicht\x20geöffnet:\x20'+_0xed7965);return handle_fail(0x2);}}async function set_clearname_from_username(_0x52d4d0,_0x48872f,_0x1bd690=null){try{let _0xd41ec5,_0xb84ad0;const _0xb1a6fc='SELECT\x20username\x20FROM\x20'+_0x48872f+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0xb1a6fc,[],(_0x499ba9,_0x69cfaa)=>{_0x499ba9&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x499ba9['message']),_0x69cfaa['length']===0x0&&(_0xb84ad0=_0x69cfaa['length']),_0xd41ec5=_0x69cfaa['map'](_0x5b2224=>_0x5b2224['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0xb84ad0);if(_0xb84ad0===0x0){console['log']('Leave');return;}const _0x46d49f=await _0x52d4d0['waitForSelector'](IG_SEARCH_BUTTON);await _0x46d49f['click'](),await delay(0x4b0,0x7d0);for(let _0x204058 of _0xd41ec5){const _0x4b4966=await _0x52d4d0['waitForSelector'](IG_SEARCH_INPUT);await _0x4b4966['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x52d4d0['type'](IG_SEARCH_INPUT,_0x204058,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x25e5a9=0x1;while(_0x25e5a9!=0x14){console['log']('Schleife');try{let _0x141c7e=IG_NAME_SPAN_PART1+_0x25e5a9+IG_USERNAME_SPAN_PART2;const _0x1d2f62=await _0x52d4d0['waitForSelector'](_0x141c7e),_0x37b13c=await _0x52d4d0['evaluate'](_0x22b012=>_0x22b012['innerHTML'],_0x1d2f62);await delay(0xc8,0x1f4);if(_0x37b13c==_0x204058){let _0x2f112f=IG_NAME_SPAN_PART1+_0x25e5a9+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x378258=await _0x52d4d0['waitForSelector'](_0x2f112f);let _0x434ea3=await _0x52d4d0['evaluate'](_0x414505=>_0x414505['innerHTML'],_0x378258);const _0x43f55e=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0xe7744b=_0x434ea3['match'](_0x43f55e);_0xe7744b?_0x434ea3=_0xe7744b[0x1]['trim']():_0x434ea3=_0x434ea3['trim']();_0x434ea3['includes']('•')&&(_0x434ea3=_0x434ea3['substring'](0x0,_0x434ea3['indexOf']('•')-0x1));const _0x2a1d64='UPDATE\x20'+_0x48872f+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x2a1d64,[_0x434ea3,_0x37b13c],function(_0x4435dc){_0x4435dc&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x4435dc['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x25e5a9++;}catch(_0x549ea1){const _0x43c5ff='UPDATE\x20'+_0x48872f+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x43c5ff,['',_0x204058],function(_0x32f0e6){_0x32f0e6&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x32f0e6['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x549ea1);break;}}_0x1bd690&&_0x1bd690();}await _0x46d49f['click']();}catch(_0x3d303b){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x3d303b);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likePost\x20\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likeStory\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likePost\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likeStory\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x3d7276,_0x547e40)=>{const _0x2de675='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x2de675,[],(_0x351126,_0x1aca96)=>{_0x351126?_0x547e40(_0x351126):_0x3d7276(_0x1aca96);});});});const sqlGet=(_0x1f7bc3,_0x5939f4,_0x507ee6=[])=>new Promise((_0x2203f6,_0xb16538)=>_0x1f7bc3['get'](_0x5939f4,_0x507ee6,(_0x29a76f,_0x7754e0)=>_0x29a76f?_0xb16538(_0x29a76f):_0x2203f6(_0x7754e0))),sqlAll=(_0x583a32,_0x84d5f4,_0x27b82d=[])=>new Promise((_0x3711dc,_0x14dc1d)=>_0x583a32['all'](_0x84d5f4,_0x27b82d,(_0x5965f0,_0x253c48)=>_0x5965f0?_0x14dc1d(_0x5965f0):_0x3711dc(_0x253c48)));ipcMain['handle']('get-campaign-details',async()=>{try{const _0x4fcc6e=await sqlAll(campaignDB,'SELECT\x20campaign_name,\x20list_id,\x20zeitabstand,\x20account\x20FROM\x20campaign'),_0xd1e150=await Promise['all'](_0x4fcc6e['map'](async _0x5edf01=>{const _0x1a9fc3=[];if(!_0x5edf01['list_id'])_0x1a9fc3['push']('Liste');if(!_0x5edf01['zeitabstand'])_0x1a9fc3['push']('Zeitabstand');if(!_0x5edf01['account'])_0x1a9fc3['push']('Instagram\x20Account');if(_0x5edf01['account'])try{const _0x35ef42=await sqlGet(igaccountsDB,'SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x5edf01['account']]);if(!_0x35ef42)_0x1a9fc3['push']('Instagram\x20Login\x20nicht\x20möglich');else{const _0x3a84f8=_0x35ef42['cookie']&&_0x35ef42['cookie']['trim']()!==''&&_0x35ef42['cookie']['trim']()!=='[]';if(!_0x3a84f8)_0x1a9fc3['push']('Instagram\x20Login');}}catch(_0x226b7e){console['error']('Account-Prüfung\x20SQL-Fehler:',_0x226b7e['message']),_0x1a9fc3['push']('Instagram\x20Account');}let _0x4885a1='N/A',_0x56040f='N/A';if(!_0x1a9fc3['includes']('Liste')){try{const _0x5e0ea7=await sqlGet(db,'SELECT\x20COUNT(*)\x20AS\x20lead_count\x20FROM\x20'+_0x5edf01['list_id']);_0x4885a1=_0x5e0ea7?.['lead_count']??0x0;}catch(_0x3152b2){if(/no such table/i['test'](_0x3152b2['message']))_0x1a9fc3['push']('Liste\x20nicht\x20vorhanden');}try{const _0x33450d=await sqlGet(campaignDB,'SELECT\x20COUNT(*)\x20AS\x20contacted_count\x20FROM\x20dm\x20WHERE\x20list_id\x20=\x20?',[_0x5edf01['list_id']]);_0x56040f=_0x33450d?.['contacted_count']??0x0;}catch(_0x4079fb){}}return{'campaign_name':_0x5edf01['campaign_name'],'lead_count':_0x4885a1,'contacted_count':_0x56040f,'status':_0x1a9fc3['length']===0x0?'Positiv':'Fehler:\x20'+_0x1a9fc3['join'](',\x20')};}));return{'status':'success','campaigns':_0xd1e150};}catch(_0x6e0270){return console['error']('get-campaign-details\x20fehlgeschlagen:',_0x6e0270['message']),{'status':'error','message':_0x6e0270['message']};}}),ipcMain['handle']('get-campaign-writer-information',async(_0x54f259,_0x3fd601)=>{return new Promise((_0x57bcb8,_0x5d8220)=>{const _0x4c998c='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted,\x20likePost,\x20likeStory\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x4c998c,[_0x3fd601],(_0x214d7f,_0x3fa625)=>{_0x214d7f?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x214d7f),_0x5d8220(_0x214d7f)):(console['log']('ROWS'),console['log'](_0x3fa625),debugDatabaseContents(),_0x57bcb8(_0x3fa625));});});});const showTableContents=_0x47e479=>{return new Promise((_0x470222,_0x20c6c5)=>{const _0x201be0='SELECT\x20*\x20FROM\x20'+_0x47e479+';';campaignDB['all'](_0x201be0,(_0xc40eea,_0x4906a7)=>{_0xc40eea?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x47e479+':',_0xc40eea),_0x20c6c5(_0xc40eea)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x47e479+':',_0x4906a7),_0x470222({'status':'success','message':_0x4906a7}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x37200c){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x37200c);}}ipcMain['handle']('create-campaign',async(_0x12ec26,_0x2b6ab3)=>{return new Promise((_0xcfb96b,_0x335b25)=>{const _0x229e0f='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x229e0f,[String(_0x2b6ab3)],function(_0x3798aa){_0x3798aa?_0x335b25(_0x3798aa):_0xcfb96b({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x2bed23,_0xc8070)=>{return new Promise((_0x4382f9,_0x2e376e)=>{const _0x19145f='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x19145f,[_0xc8070],function(_0x33a030){_0x33a030?_0x2e376e(_0x33a030):_0x4382f9({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0xc7b0e0,_0x2dcdbc,_0x3dd60f,_0x292860,_0x57db17,_0x136010,_0x28d3ae,_0x453ba9,_0x51d98b,_0x48fe11)=>{const _0x1cfd89=await createMessageID(_0x57db17);return new Promise((_0x10f39d,_0x49e22c)=>{console['log']('ZEITABSTAND:\x20'+_0x292860);if(!_0x2dcdbc||!_0x3dd60f||_0x292860===undefined||_0x292860===null||_0x292860===''||!_0x1cfd89||!_0x136010)return _0x49e22c({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x1cfd89);const _0x5b72a4='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?,\x20likePost\x20=\x20?,\x20likeStory\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x5b72a4,[_0x3dd60f,_0x292860,_0x1cfd89,_0x136010,_0x28d3ae,_0x453ba9,_0x51d98b,_0x48fe11,_0x2dcdbc],function(_0x5edf23){if(_0x5edf23)_0x49e22c({'status':'error','message':_0x5edf23['message']});else this['changes']===0x0?_0x49e22c({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x10f39d({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x103b46,_0xf57e6d,_0x21ecae,_0x398068,_0x5b1acd)=>{return new Promise((_0x451efa,_0x1c8639)=>{const _0x33edbe='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x33edbe,[_0xf57e6d,_0x21ecae,_0x398068,_0x5b1acd],function(_0xc23309){return _0xc23309?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0xc23309['message']),_0x1c8639('insert-dm-response',{'success':![],'message':_0xc23309['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x451efa('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x53453b=>{return new Promise((_0x1bc319,_0x27ac50)=>{const _0x350f25='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x350f25,[_0x53453b],(_0x2b5b37,_0x427af2)=>{if(_0x2b5b37)_0x27ac50({'status':'error','message':_0x2b5b37['message']});else{if(_0x427af2)_0x1bc319(_0x427af2['message_id']);else{const _0xde48a7='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0xde48a7,[_0x53453b],function(_0x4a0863){_0x4a0863?_0x27ac50({'status':'error','message':_0x4a0863['message']}):_0x1bc319(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x540dec,_0x1e6ea3)=>{return new Promise((_0x28a897,_0x87e830)=>{const _0x57fe41='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x1e6ea3;db['get'](_0x57fe41,(_0x4f113d,_0x1739f8)=>{_0x4f113d?_0x87e830({'status':'error','message':_0x4f113d['message']}):_0x28a897({'status':'success','count':_0x1739f8['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x25ec76,_0x41f875){try{const _0x275f48=await new Promise((_0x5cffef,_0x552906)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x41f875],(_0x4cf304,_0x37fa2c)=>{if(_0x4cf304)_0x552906(_0x4cf304);else{if(_0x37fa2c['length']>0x0){let _0x4cf544=JSON['parse'](_0x37fa2c[0x0]['cookie']);console['log'](_0x4cf544),_0x5cffef(_0x4cf544);}else _0x552906(new Error('User\x20with\x20username\x20'+_0x41f875+'\x20does\x20not\x20exist.'));}});});await _0x25ec76['setCookie'](..._0x275f48),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x2a3b0f){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2a3b0f);}}async function saveCookiesForUser(_0xd81a19,_0x34fe00){try{const _0x1548d2=await _0xd81a19['cookies']();if(!_0x1548d2||_0x1548d2['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x34fe00);const _0x503bf9=JSON['stringify'](_0x1548d2);if(_0x503bf9['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x34fe00);return new Promise((_0x4895f3,_0x18aff9)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x34fe00],(_0x59effd,_0x4c95d8)=>{if(_0x59effd)return console['error']('Error\x20checking\x20user\x20existence:',_0x59effd),_0x18aff9(_0x59effd);if(_0x4c95d8){const _0x3df423=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x3df423['run'](_0x503bf9,_0x34fe00,function(_0x43d2ec){return _0x43d2ec?(console['error']('Error\x20updating\x20cookies:',_0x43d2ec),_0x18aff9(_0x43d2ec)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x34fe00),_0x4895f3());});}else{const _0x4058f9=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x4058f9['run'](_0x34fe00,_0x503bf9,function(_0x1b86a7){return _0x1b86a7?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x1b86a7),_0x18aff9(_0x1b86a7)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x34fe00),_0x4895f3());});}});});}catch(_0xa3cc37){console['error']('Error\x20fetching\x20cookies:',_0xa3cc37);throw _0xa3cc37;}}async function createUserIfNotExists(_0x2b47ae){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x2b47ae],(_0x453de5,_0x226217)=>{if(_0x453de5){console['error']('Error\x20checking\x20user\x20existence:',_0x453de5);throw _0x453de5;}else{if(!_0x226217){const _0x555bce=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x555bce['run'](_0x2b47ae,function(_0x437fb1){_0x437fb1?console['error']('Error\x20inserting\x20new\x20user:',_0x437fb1):console['log']('New\x20user\x20created:',_0x2b47ae);});}else console['log']('User\x20already\x20exists:',_0x2b47ae);}});}catch(_0x108df5){console['error']('Error\x20creating\x20user:',_0x108df5);throw _0x108df5;}}ipcMain['handle']('create-relation',async(_0x584888,_0x418f42)=>{return new Promise((_0x2c4e97,_0x20a0ee)=>{const _0xbdbbb9='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x418f42+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0xbdbbb9,function(_0xfa235e){_0xfa235e?_0x20a0ee(_0xfa235e):_0x2c4e97({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x7209a3,_0x160115)=>{return console['log']('droping\x20table'+_0x160115),new Promise((_0x31a10e,_0x1cf48a)=>{const _0x509db2='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x160115;console['log']('droping\x20table'+_0x160115),db['run'](_0x509db2,function(_0x57aea6){_0x57aea6?_0x1cf48a(_0x57aea6):_0x31a10e({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x11674e=>{return new Promise((_0x396879,_0x1ebd83)=>{const _0x396988='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x396988,[],(_0x1b033d,_0x26d857)=>{_0x1b033d?_0x1ebd83(_0x1b033d):_0x396879(_0x26d857['map'](_0x452079=>_0x452079['name']));});});}),ipcMain['handle']('add-user',async(_0xe4a6a2,_0xd085ad,_0x2ca762)=>{return new Promise(_0x24dc44=>{const _0x688c40=db['prepare']('INSERT\x20INTO\x20'+_0x2ca762+'\x20(username)\x20VALUES\x20(?)');_0x688c40['run'](_0xd085ad,function(_0x218c08){_0x218c08?console['log']('error\x20in\x20add-user:'+_0x218c08):_0x24dc44({'status':'success','id':this['lastID']});}),_0x688c40['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x15fcee,_0x29cb2e)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x5d2eeb,_0x3fb1f1)=>{if(_0x5d2eeb)_0x29cb2e(_0x5d2eeb);else{_0x15fcee({'status':'success','users':_0x3fb1f1});for(_0x3fb1f1 of _0x3fb1f1){console['log'](_0x3fb1f1['username']);}}});});}),ipcMain['handle']('get-data',async(_0x3fb3c5,_0x36c294)=>{return new Promise((_0x14e1d2,_0x93ab0f)=>{const _0x312b92='SELECT\x20*\x20FROM\x20'+_0x36c294;console['log'](_0x312b92),db['all'](_0x312b92,[],(_0x2d5a48,_0x252722)=>{_0x2d5a48?_0x93ab0f(_0x2d5a48):_0x14e1d2(_0x252722);});});}),ipcMain['handle']('get-accounts',async _0x50bd1f=>{return new Promise((_0x483faa,_0x9819d4)=>{const _0x50a437='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x50a437),igaccountsDB['all'](_0x50a437,[],(_0x3c2aa2,_0x44709d)=>{_0x3c2aa2?_0x9819d4(_0x3c2aa2):_0x483faa(_0x44709d);});});}),ipcMain['handle']('get-targets',async(_0x3f5e2e,_0x109e7c)=>{return getTargetProfiles(_0x109e7c);}),ipcMain['handle']('delete-user',async(_0x593a41,_0x408dd8,_0x521973)=>{return new Promise((_0x33692d,_0x4bf81a)=>{const _0x5707b0=db['prepare']('DELETE\x20FROM\x20'+_0x521973+'\x20WHERE\x20username\x20=\x20?');_0x5707b0['run'](_0x408dd8,function(_0x798b91){_0x798b91?_0x4bf81a(_0x798b91):_0x33692d({'status':'success','changes':this['changes']});}),_0x5707b0['finalize']();});}),ipcMain['handle']('delete-account',async(_0x2874af,_0x224f89)=>{const _0x35f5c4=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x35f5c4['run'](_0x224f89,function(_0x321370){_0x321370&&console['log'](_0x321370);}),_0x35f5c4['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x5d4105,_0x205c68)=>{const _0x350956='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x350956,[],(_0x170039,_0x97107)=>{_0x170039?_0x205c68({'status':'error','message':_0x170039['message']}):_0x5d4105({'status':'success','contactedCount':_0x97107['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x262d20,_0x20f3e0)=>{const _0x29682c='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x29682c,[],(_0x4f5d18,_0x1d3dd3)=>{_0x4f5d18?_0x20f3e0({'status':'error','message':_0x4f5d18['message']}):_0x262d20({'status':'success','contactedCount':_0x1d3dd3['contactedCount']});});});});function exportDatabase(_0x1ca914){return new Promise((_0x43908f,_0x20bfff)=>{const _0x22f9a3='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x1ca914+'\x0a\x20\x20\x20\x20';db['all'](_0x22f9a3,[],async(_0x498eb4,_0x77fd35)=>{if(_0x498eb4){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x498eb4['message']),_0x20bfff(_0x498eb4);return;}if(!_0x77fd35||_0x77fd35['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x43908f();return;}const _0x4f6168=XLSX['utils']['json_to_sheet'](_0x77fd35),_0x5761a9=XLSX['utils']['sheet_to_csv'](_0x4f6168);try{const {canceled:_0x17617a,filePath:_0x149ad2}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x1ca914+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x17617a||!_0x149ad2){console['log']('Speichern\x20abgebrochen.'),_0x43908f();return;}fs['writeFile'](_0x149ad2,_0x5761a9,'utf8',_0xc1b469=>{_0xc1b469?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0xc1b469['message']),_0x20bfff(_0xc1b469)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x149ad2),_0x43908f());});}catch(_0x14b034){console['error']('Fehler\x20im\x20Speicherdialog:',_0x14b034),_0x20bfff(_0x14b034);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x28535d,_0x5b6ebd)=>{shell['openExternal'](_0x5b6ebd);});