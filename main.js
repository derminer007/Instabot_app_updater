const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');async function extractFirstName(_0x394903,_0x43134c){try{const _0x2468f8=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x43134c},'body':JSON['stringify']({'clearname':_0x394903})});if(!_0x2468f8['ok']){const _0x3a0180=await _0x2468f8['text']();throw new Error(_0x2468f8['status']+':\x20'+_0x3a0180);}const _0x28b6d9=await _0x2468f8['json']();return _0x28b6d9;}catch(_0x37415a){console['error']('Error\x20in\x20extractFirstName:',_0x37415a);throw _0x37415a;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div:has(>\x20div[style=\x22height:\x20auto;\x20overflow:\x20hidden\x20auto;\x22])',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='[style=\x22line-height:\x2018px;\x22]',COM_COMMENTS_BOX_BODY_DIV='div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='//span[contains(.,\x20\x27View\x20all\x27)\x20and\x20contains(.,\x20\x27replies\x27)]',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Message\x27]','div.x9f619.xjbqb8w.x78zum5.x15mokao.x1ga7v0g.x16uus16.xbiv7yw.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div','div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div'],K_OPTIONS_BUTTON=['[aria-label=\x22Options\x22]','section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.x1jfgfrl\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div'],K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD=['[aria-label=\x22Message\x22]','div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f'],K_SEND_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Send\x27]','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_ALREADY_CHATTED='[aria-label=\x22Double\x20tap\x20to\x20like\x22]',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x10cbd0=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x10cbd0['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x10cbd0['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x298b2d){var _0x30d126=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x315b93){console['log']('window\x20id:'+_0x315b93['id']),_0x315b93['id']>0x1&&(_0x30d126=!![]);}),console['log']('child\x20opened\x20='+_0x30d126);if(!_0x30d126){const _0x5bcc7f=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x5bcc7f['loadFile'](_0x298b2d['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x3b403c=require('fs'),_0x73b37=path['join'](app['getPath']('userData'),'data'),_0x49dd4d=['campaign.db','crm.db','igaccounts.db'],_0x359295=[];try{_0x3b403c['mkdirSync'](_0x73b37,{'recursive':!![]});for(const _0x464524 of _0x49dd4d){const _0x4ae36c=path['join'](process['resourcesPath'],'app','build','data',_0x464524),_0x3e4c92=path['join'](_0x73b37,_0x464524);!_0x3b403c['existsSync'](_0x3e4c92)?(_0x3b403c['copyFileSync'](_0x4ae36c,_0x3e4c92),console['log']('[InitDB]\x20Kopiert\x20'+_0x464524+'\x20nach:\x20'+_0x3e4c92)):console['log']('[InitDB]\x20'+_0x464524+'\x20existiert\x20bereits:\x20'+_0x3e4c92),_0x359295['push'](_0x3e4c92);}}catch(_0x135405){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x135405);}return _0x359295;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x579ba2,AppUpdate:_0x1d5374}=require('electron-updater');_0x579ba2['autoDownload']=![],_0x579ba2['autoInstallOnAppQuit']=!![],_0x579ba2['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x579ba2['on']('update-available',_0x31d4a0=>{console['log']('Update\x20verfügbar:',_0x31d4a0),_0x579ba2['downloadUpdate']();}),_0x579ba2['on']('update-downloaded',_0xf91e7d=>{console['log']('Update\x20heruntergeladen:',_0xf91e7d),_0x579ba2['quitAndInstall']();}),_0x579ba2['on']('error',_0x98a06c=>{console['error']('Fehler\x20beim\x20Updaten:',_0x98a06c);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x2122c1,AppUpdate:_0x4efd03}=require('electron-updater');_0x2122c1['autoDownload']=![],_0x2122c1['autoInstallOnAppQuit']=!![],_0x2122c1['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x2122c1['on']('update-available',_0x724095=>{console['log']('Update\x20verfügbar:',_0x724095),_0x2122c1['downloadUpdate']();}),_0x2122c1['on']('update-downloaded',_0x1269ea=>{console['log']('Update\x20heruntergeladen:',_0x1269ea),console['log']('Neustarten\x20zum\x20Updaten');}),_0x2122c1['on']('error',_0x1e8437=>{console['error']('Fehler\x20beim\x20Updaten:',_0x1e8437);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x43cb40='',_0x26c5f5=null;if(process['platform']==='darwin')_0x43cb40=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x43cb40=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x43cb40}),_0x26c5f5=await browser_login['newPage'](),_0x26c5f5['setDefaultNavigationTimeout'](0x1d4c),_0x26c5f5['setDefaultTimeout'](0x1d4c),await _0x26c5f5['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x26c5f5;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0xf58219=0x1,_0x411a93=0x0){try{let _0x487eae='',_0x15b493=null;const _0x1252a1=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x487eae=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x487eae=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0xf58219===0x0&&!pageStack[_0x411a93])return browser=await puppeteer['launch']({'headless':_0x1252a1,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x487eae}),_0x15b493=await browser['newPage'](),_0x15b493['setDefaultNavigationTimeout'](0x1d4c),_0x15b493['setDefaultTimeout'](0x1d4c),await _0x15b493['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x411a93]=_0x15b493,_0x15b493;return(browser===null||pageStack[_0x411a93]===null||pageStack[_0x411a93]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x1252a1,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x487eae})),(pageStack[_0x411a93]===null||pageStack[_0x411a93]['isClosed']())&&(_0x15b493=await browser['newPage'](),_0x15b493['setDefaultNavigationTimeout'](0x1d4c),_0x15b493['setDefaultTimeout'](0x1d4c),await _0x15b493['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x411a93]=_0x15b493),pageStack[_0x411a93];}catch(_0x37b786){console['error']('Failed\x20to\x20launch\x20browser:',_0x37b786);const _0x3faf09=new Error('Browser\x20konnte\x20nicht\x20gestartet\x20werden.\x20Bitte\x20starte\x20die\x20App\x20neu.\x20:\x20'+_0x37b786);throw _0x3faf09;}}ipcMain['on']('login',async(_0x11bec5,_0x417c66)=>{const _0x1efa86=await getBrowserPageLogin();await _0x1efa86['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x1efa86,_0x417c66),ipcMain['on']('setLoginCookies',async(_0x19e43b,_0x263dd4)=>{try{await set_login_cookies(_0x1efa86,_0x263dd4);}catch(_0x198b06){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x198b06);}});}),ipcMain['on']('export-relation',async(_0x317fec,_0x2674d1)=>{try{await exportDatabase(_0x2674d1),_0x317fec['reply']('export-relation-response',{'success':!![]});}catch(_0x381a68){console['error'](_0x381a68),_0x317fec['reply']('export-relation-response',{'success':![],'message':_0x381a68['message']});}}),ipcMain['handle']('sendMessage',async(_0x3253fa,_0x51a17f,_0x231cb4,_0x7a455b,_0x670b39,_0x251c45,_0x2f292f,_0x352f1e,_0x5f27c0,_0xf86e9f,_0x5396b4)=>{isStopping=![];let _0x2b80fb=null;return _0x2f292f?_0x2b80fb=await getBrowserPage(_0x670b39,_0x352f1e):_0x2b80fb=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x51a17f),send_message(_0x2b80fb,_0x51a17f,_0x231cb4,_0x7a455b,_0x670b39,_0x251c45,_0x5f27c0,_0xf86e9f,_0x5396b4);}),ipcMain['handle']('stop-action',async(_0x4031d4,_0x1f99d2)=>{isStopping=!![];const _0x474a41=await getBrowserPage(0x1,_0x1f99d2);await _0x474a41['close']();}),ipcMain['handle']('fetch_followers',async(_0x14b7c6,_0x147617,_0x57aa70,_0x23f05a,_0x50f95d,_0x229cd3)=>{isStopping=![];const _0x256b1e=await getBrowserPage();return fetch_followers_from_account(_0x14b7c6,_0x256b1e,_0x147617,_0x57aa70,_0x23f05a,_0x50f95d,_0x229cd3);}),ipcMain['handle']('get-account-details',async(_0x5143be,_0x201310,_0x23a8eb,_0x58e468)=>{isStopping=![];const _0x44603a=await getBrowserPage();return fetch_account_details(_0x44603a,_0x201310,_0x23a8eb,_0x58e468);}),ipcMain['handle']('fetch_likes',async(_0x3e2ddc,_0x5af6ec,_0x2fd62f,_0x115f1f,_0x4f5814,_0x4c3d6d)=>{isStopping=![];const _0x425238=await getBrowserPage();return fetch_likers_from_post(_0x3e2ddc,_0x425238,_0x5af6ec,_0x2fd62f,_0x115f1f,_0x4f5814,_0x4c3d6d);}),ipcMain['handle']('fetch_comments',async(_0x27d42e,_0x429b94,_0x25c46f,_0x2d51d5,_0x38e45a,_0x288bc3)=>{isStopping=![];const _0xf229ad=await getBrowserPage();return fetch_comments_from_post(_0x27d42e,_0xf229ad,_0x429b94,_0x25c46f,_0x2d51d5,_0x38e45a,_0x288bc3);});async function updateAppSilent(){const {spawn:_0x1e3a8e}=require('child_process'),_0x6a6b12=require('path'),_0x4196c8=require('electron-log');return _0x4196c8['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x5bada9,_0x322f5a)=>{const {updateElectronApp:_0x4e01ef,UpdateSourceType:_0x47fe52}=require('update-electron-app');_0x4e01ef({'updateSource':{'type':_0x47fe52['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x4196c8}),_0x5bada9('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x283b33,_0x32cf18)=>{doFullElectronUpdateSilent(),_0x283b33('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x4f5975}=require('child_process'),_0x242fbf=require('path'),_0x2533f4=require('electron-log');return _0x2533f4['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0xaa9c30,_0x587c68)=>{const {updateElectronApp:_0x3aaa38,UpdateSourceType:_0x337144}=require('update-electron-app');_0x3aaa38({'updateSource':{'type':_0x337144['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x2533f4}),_0xaa9c30('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x2b4c2e,_0x550844)=>{doFullElectronUpdate(),_0x2b4c2e('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0x90bc2,_0x12b857)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x90bc2('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x3f2be4=path['join'](__dirname,'mac-updater-intern.sh'),_0x1544da=spawn('/bin/bash',[_0x3f2be4],{'detached':!![],'stdio':'ignore'});_0x1544da['unref'](),setTimeout(()=>{_0x90bc2('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0x12b857(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0x296809=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x126f75,_0x5e308c)=>{console['log']('Update\x20Silent:\x20'+_0x5e308c);if(_0x5e308c){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0x46e366,_0x1cf166){return Math['random']()*(_0x1cf166-_0x46e366+0x1)+_0x46e366;}function delay(_0x290976,_0x53701e){let _0x3aba85=getRnd(_0x290976,_0x53701e);return new Promise(function(_0x3b9234){setTimeout(_0x3b9234,_0x3aba85);});}async function scroll(_0x3e0125,_0x389c35,_0x556565=0x2,_0xf43f8){const _0x5326a6=await _0x3e0125['waitForSelector'](_0x389c35);for(let _0x3016d2=0x0;_0x3016d2<_0x556565;_0x3016d2++){console['log']('Scrolling\x20'+_0x3016d2),await _0x3e0125['evaluate'](_0x5e8d39=>{const _0x2cf972=document['querySelector'](_0x5e8d39);_0x2cf972&&_0x2cf972['scrollBy'](0x0,0x190);},_0x389c35),await delay(0x320,0x5dc),_0xf43f8();}}async function saveCookies(_0x594535){let _0x385097=await _0x594535['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x385097,null,0x2));}async function notificationClear(_0x456335){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xfa0,0x1388),await _0x456335['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x456335['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x4ae162){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x4ae162);}}async function getTargetProfiles(_0x311b3c){return new Promise((_0x2318f7,_0x13ba7d)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x311b3c,(_0x2eb854,_0x3a7c3a)=>{_0x2eb854?_0x13ba7d(_0x2eb854):_0x2318f7(_0x3a7c3a);});});}async function login_legacy(_0x263fbd,_0x1e3d33,_0x22dbf4){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x263fbd,_0x1e3d33),await createUserIfNotExists(_0x1e3d33,_0x22dbf4);}catch(_0x42fc8a){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x42fc8a);}try{await _0x263fbd['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x263fbd['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x263fbd['click']('button._a9--._ap36._a9_0');}catch(_0x498453){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x263fbd['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x263fbd['type']('input[name=\x27username\x27]',_0x1e3d33,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x263fbd['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x263fbd['type']('input[name=\x27password\x27]',_0x22dbf4,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x263fbd['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x263fbd['click']('button[type=\x27submit\x27]');}catch(_0x50c3e2){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x263fbd),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x263fbd,_0x1e3d33);}catch(_0x119c30){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x119c30);}}catch(_0x37177a){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x37177a);}}async function login(_0x3b9073,_0x41b8c6){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x3b9073,_0x41b8c6),await createUserIfNotExists(_0x41b8c6);}catch(_0x49aae1){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x49aae1);}try{await _0x3b9073['goto']('https://www.instagram.com/accounts/login/');}catch(_0x4ab1ba){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x4ab1ba);}}async function set_login_cookies(_0x20e2b3,_0x1b01c7){try{await saveCookiesForUser(_0x20e2b3,_0x1b01c7);}catch(_0x485750){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x485750);}}async function waitForXPath(_0xd25926,_0x20fcb1,_0x1e2104={}){return await _0xd25926['waitForFunction'](_0x152432=>{return document['evaluate'](_0x152432,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x1e2104,_0x20fcb1),_0xd25926['evaluateHandle'](_0x209a6b=>document['evaluate'](_0x209a6b,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x20fcb1);}async function waitForSelectorWithFallbacks(_0x4d0638,_0x1b9af2,_0x3aa3a0={}){!Array['isArray'](_0x1b9af2)&&(_0x1b9af2=[_0x1b9af2]);for(let _0x32c703=0x0;_0x32c703<_0x1b9af2['length'];_0x32c703++){const _0x54d747=_0x1b9af2[_0x32c703],_0x161883=_0x54d747['startsWith']('//')||_0x54d747['startsWith']('(//');try{console['log']('Versuche\x20'+(_0x161883?'XPath':'Selector')+'\x20'+(_0x32c703+0x1)+'/'+_0x1b9af2['length']+':\x20'+_0x54d747['substring'](0x0,0x32)+'...');const _0x2b4ab5=_0x32c703===0x0?_0x3aa3a0['timeout']||0x1388:0x7d0;let _0x2528c8;if(_0x161883){const _0xe19611=await waitForXPath(_0x4d0638,_0x54d747,{..._0x3aa3a0,'timeout':_0x2b4ab5});if(!_0xe19611)throw new Error('XPath-Element\x20nicht\x20gefunden');_0x2528c8=_0xe19611;}else _0x2528c8=await _0x4d0638['waitForSelector'](_0x54d747,{..._0x3aa3a0,'timeout':_0x2b4ab5});return console['log']((_0x161883?'XPath':'Selector')+'\x20'+(_0x32c703+0x1)+'\x20gefunden!'),_0x2528c8;}catch(_0xea8f0){console['log']((_0x161883?'XPath':'Selector')+'\x20'+(_0x32c703+0x1)+'\x20nicht\x20gefunden:\x20'+_0xea8f0['message']);if(_0x32c703===_0x1b9af2['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x1b9af2['length']+'\x20Selektoren/XPath\x20konnte\x20gefunden\x20werden:\x20'+_0xea8f0['message']);}}throw new Error('Keine\x20Selektoren/XPath\x20angegeben');}async function waitForXPathAll(_0x5b3d2a,_0xb0530d,_0x5cf919={}){return await _0x5b3d2a['waitForFunction'](_0x30aa6d=>{return document['evaluate'](_0x30aa6d,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null)['snapshotLength']>0x0;},_0x5cf919,_0xb0530d),_0x5b3d2a['evaluateHandle'](_0x2670bb=>{const _0x5d6158=document['evaluate'](_0x2670bb,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null),_0x34efcc=[];for(let _0x55889e=0x0;_0x55889e<_0x5d6158['snapshotLength'];_0x55889e++){_0x34efcc['push'](_0x5d6158['snapshotItem'](_0x55889e));}return _0x34efcc;},_0xb0530d)['then'](_0xa2aa2f=>_0xa2aa2f['getProperties']());}async function checkLoginStatus(_0x4dd180){const _0x328d61=['[type=\x22password\x22]','//a[normalize-space(text())=\x27Log\x20In\x27]','//div[@role=\x27button\x27\x20and\x20normalize-space(.)=\x27Log\x20in\x27]','//h3[normalize-space(text())=\x27Something\x20went\x20wrong\x27]'];let _0x2b1b61=null;try{_0x2b1b61=await waitForSelectorWithFallbacks(_0x4dd180,_0x328d61,{'timeout':0x7d0});}catch(_0x1563f5){return console['log']('Eingeloggt,\x20kein\x20Login\x20notwendig:\x20'+_0x1563f5),!![];}if(_0x2b1b61){console['log']('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return![];}else return console['log']('Eingeloggt,\x20führe\x20keine\x20Login\x20durch'),!![];}async function send_message(_0x2159f7,_0xad59be,_0x40eff0,_0x2cc639,_0x33af6f,_0x41c286,_0x57cadd,_0x2db746,_0x1c35ef){return new Promise(async(_0x5abf70,_0x3e0c51)=>{_0x41c286=_0x41c286['split'](';'),console['log'](_0x41c286[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x33af6f);try{await setCookiesForUser(_0x2159f7,_0x41c286[0x0]);}catch(_0x2636ca){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x2636ca),_0x5abf70({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2636ca});return;}await delay(0x6a4,0x7d0);try{await _0x2159f7['goto']('https://www.instagram.com/'+_0xad59be+'/'),await delay(0x1b58,0x1d4c),await notificationClear(_0x2159f7);}catch(_0x470946){_0x5abf70({'status':0x1f5,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x470946});return;}try{await checkLoginStatus(_0x2159f7);}catch(_0xf1229){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0xf1229),_0x3e0c51('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return;}console['log']('UserSkip:\x20'+_0x57cadd);if(_0x57cadd==0x1)try{const _0x29d56d=await _0x2159f7['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x56e364=>_0x56e364['textContent']['trim']());console['log'](_0x29d56d);if(_0x29d56d==='Following'||_0x29d56d==='Folge\x20ich')return _0x5abf70({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0xfcb5ce){}try{const _0x1c80b5=await waitForSelectorWithFallbacks(_0x2159f7,K_DIRECT_MSG_BUTTON);await _0x1c80b5['click']();}catch(_0x29a0ad){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x29a0ad);try{try{const _0x2add76=await waitForSelectorWithFallbacks(_0x2159f7,K_OPTIONS_BUTTON);await _0x2add76['click']();}catch(_0x2c74cd){console['log']('Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x2c74cd),_0x5abf70({'status':0x1f6,'message':'Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x2c74cd});return;}await delay(0x1f4,0x320);const _0x1657f1=await waitForXPath(_0x2159f7,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x1657f1['click']();}catch(_0x2671a8){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x2671a8),_0x5abf70({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x2159f7);}catch(_0xe900d8){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0xe900d8);}try{const _0x55ce83=await waitForSelectorWithFallbacks(_0x2159f7,K_CHAT_INPUT_FIELD);if(_0x2db746){const _0xfd4521=await _0x2159f7['$'](K_ALREADY_CHATTED);if(_0xfd4521)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0xad59be),_0x5abf70({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x146011=await _0x2159f7['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x146011),_0x2cc639=_0x2cc639['replace']('{USERNAME}',_0xad59be);let _0x27d76a;if(_0x2cc639['includes']('{NAME}')||_0x2cc639['includes']('{name}'))try{const _0x61c47b=await extractFirstName(_0x146011,_0x1c35ef);console['log']('Response\x20Clearname\x20valid:\x20'+_0x61c47b['valid']),_0x61c47b['valid']?(_0x2cc639=_0x2cc639['replaceAll'](/{NAME}|{name}/g,_0x61c47b['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x61c47b['name']),_0x27d76a=_0x61c47b['name']):(_0x2cc639=_0x2cc639['replaceAll'](/ ?({NAME}|{name})/g,''),_0x27d76a='UNKNOWN_NAME');}catch(_0x12e893){console['log'](_0x12e893['message']),_0x27d76a=_0x12e893['message'];let _0x4c0cf6=_0x146011['replace'](/[^\p{L}\s]/gu,''),_0x396673=_0x4c0cf6['split']('\x20')[0x0];_0x396673['length']>0x2&&!_0x396673['includes']('Instagram')?_0x2cc639=_0x2cc639['replaceAll'](/{NAME}|{name}/g,_0x396673):_0x2cc639=_0x2cc639['replaceAll'](/ ?({NAME}|{name})/g,'');}console['log']('Nachricht\x20vor\x20dem\x20Senden:\x20'+_0x2cc639);const _0x360d4f=_0x2cc639['split']('\x0a');await _0x55ce83['type'](_0x360d4f[0x0],{'delay':getRnd(0x50,0x78)});for(let _0x1419fc=0x1;_0x1419fc<_0x360d4f['length'];_0x1419fc++){await _0x2159f7['keyboard']['down']('Shift'),await _0x2159f7['keyboard']['press']('Enter'),await _0x2159f7['keyboard']['up']('Shift'),await delay(0x64,0xc8),_0x360d4f[_0x1419fc]['length']>0x0&&await _0x55ce83['type'](_0x360d4f[_0x1419fc],{'delay':getRnd(0x50,0x78)});}console['log']('Nachricht\x20mit\x20Zeilenumbrüchen\x20gesendet'),await delay(0x320,0x3e8);try{const _0x95fa3b=await waitForSelectorWithFallbacks(_0x2159f7,K_SEND_MSG_BUTTON);await _0x95fa3b['click']();}catch(_0x39b4f4){console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x39b4f4),_0x5abf70({'status':0x195,'message':'Send\x20nicht\x20gefunden.\x20Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0xad59be+'\x20überspringen.','error':_0x39b4f4['message']});}await delay(0x320,0x3e8),_0x5abf70({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x146011,'extracted_clearname':_0x27d76a});}catch(_0x138a23){let _0xd408f0=_0x138a23;console['log']('Fehler\x20beim\x20Senden\x20der\x20Nachricht:\x20'+_0xd408f0),_0x5abf70({'status':0x1f4,'message':'Error\x20500:\x20'+_0xd408f0});}});}function handle_fail(_0x2b11a6){if(isStopping)return new Promise(_0x1a3165=>{_0x1a3165('Scraper\x20gestoppt.');});else{let _0x3e0885='';switch(_0x2b11a6){case 0x0:_0x3e0885='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x3e0885='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x3e0885='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x3e0885='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x39909e,_0x159b4c)=>{_0x159b4c(_0x3e0885);});}}async function fetch_account_details(_0x2a6b9d,_0x1d9cf8,_0x86c109,_0x45fc47){try{await setCookiesForUser(_0x2a6b9d,_0x86c109['username']);}catch(_0x45de1d){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x45de1d);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x45de1d);return handle_fail(0x0);}_0x2a6b9d['setDefaultNavigationTimeout'](0x7530),await _0x2a6b9d['goto']('https://www.instagram.com/'+_0x1d9cf8+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x2a6b9d);const _0x1d5d55=await _0x2a6b9d['evaluate'](()=>{const _0x29a615=document['querySelector']('meta[property=\x22og:image\x22]');return _0x29a615?_0x29a615['getAttribute']('content'):null;});await _0x2a6b9d['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x2e0e2c=await _0x2a6b9d['evaluate'](()=>{const _0x21f2be=document['querySelector']('meta[name=\x22description\x22]');if(!_0x21f2be)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x57d569=_0x21f2be['getAttribute']('content');if(!_0x57d569)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x57d569);const _0x4e273f=/\s*[–-]\s*/,_0x37876f=_0x57d569['split'](_0x4e273f);if(_0x37876f['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x26f4e2=_0x37876f[0x0],_0x2431da=_0x37876f[0x1],_0x204cb2=_0x26f4e2['split'](',\x20');if(_0x204cb2['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x5c80a8=_0x204cb2[0x0]['split']('\x20')[0x0],_0x3c0710=_0x204cb2[0x1]['split']('\x20')[0x0],_0x134c03=_0x204cb2[0x2]['split']('\x20')[0x0];let _0x59fb0c='',_0x3af5ab='';const _0x46f15d='\x20on\x20Instagram:\x20',_0x866e93=_0x2431da['split'](_0x46f15d);return _0x59fb0c=_0x866e93[0x0]['trim'](),_0x59fb0c=_0x59fb0c['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x866e93['length']>0x1&&(_0x3af5ab=_0x866e93[0x1]['trim'](),_0x3af5ab['startsWith']('\x22')&&_0x3af5ab['endsWith']('\x22')&&(_0x3af5ab=_0x3af5ab['substring'](0x1,_0x3af5ab['length']-0x1)['trim']()),_0x3af5ab=_0x3af5ab['replace'](/&quot;/g,'')['trim']()),{'followers':_0x5c80a8,'following':_0x3c0710,'posts':_0x134c03,'nameText':_0x59fb0c,'bio':_0x3af5ab};});console['log']('Extracted\x20profile\x20data:',_0x2e0e2c);const _0x271215=_0x2e0e2c['nameText'],_0x1fdcbb=_0x1d5d55,_0x5476f2=_0x2e0e2c['bio'],_0x3d461e=_0x2e0e2c['followers'],_0x22cca7=_0x2e0e2c['following'],_0x442e52=_0x2e0e2c['posts'],_0x442a79=![],_0x4deaca=![],_0x2ed4d7=![],_0x54087a='\x0a\x20\x20INSERT\x20INTO\x20'+_0x45fc47+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x54087a,[_0x1d9cf8,_0x271215,_0x1fdcbb,_0x5476f2,_0x3d461e,_0x22cca7,_0x442e52,_0x442a79,_0x4deaca,_0x2ed4d7],function(_0x278b2f){_0x278b2f?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x278b2f['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x576c36,_0x4d0821,_0x4bf316,_0x5c2e6e,_0x35ca07,_0x11470a,_0x2d350f){let _0x1b2502=0x4,_0x467892=0x0,_0x557013=0x0;try{await setCookiesForUser(_0x4d0821,_0x11470a['username']);}catch(_0x46f9fb){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x46f9fb);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x46f9fb);return handle_fail(0x0);}let _0x2ea093=0x0;try{await _0x4d0821['goto']('https://www.instagram.com/'+_0x4bf316+'/'),await notificationClear(_0x4d0821);try{if(_0x5c2e6e<=0x0){const _0x587e4f=await _0x4d0821['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x19da15=await _0x4d0821['evaluate'](_0x581f4a=>_0x581f4a['innerHTML'],_0x587e4f);_0x2ea093=Math['ceil'](_0x19da15/0x4);}else _0x2ea093=Math['ceil'](_0x5c2e6e/0x4);_0x1b2502+=_0x2ea093,_0x557013=Math['round'](++_0x467892/_0x1b2502*0x64),_0x576c36['sender']['send']('fetch-progress',_0x557013,!![]);let _0xa35bbb=await _0x4d0821['waitForSelector']('a[href=\x22/'+_0x4bf316+'/followers/\x22]');await delay(0xbb8,0x1388),await _0xa35bbb['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x4bf316+'\x20gesichtet'),_0x557013=Math['round'](++_0x467892/_0x1b2502*0x64),_0x576c36['sender']['send']('fetch-progress',_0x557013,!![]);}catch(_0x1f2fa5){console['log']('Follower\x20Liste\x20von\x20'+_0x4bf316+'\x20nicht\x20gefunden:'+_0x1f2fa5);throw new Error('Follower\x20Liste\x20von\x20'+_0x4bf316+'\x20nicht\x20gefunden:'+_0x1f2fa5);return handle_fail(0x0);}}catch(_0x5d8f95){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x5d8f95);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x5d8f95);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x2ea093),await scroll(_0x4d0821,FOLLOWER_FENSTER,_0x2ea093,_0x52ec51=>{_0x557013=Math['round'](++_0x467892/_0x1b2502*0x64),_0x576c36['sender']['send']('fetch-progress',_0x557013,!![]);}),await _0x4d0821['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x195df5=await _0x4d0821['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x13258c=await _0x4d0821['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x557013=Math['round'](++_0x467892/_0x1b2502*0x64),_0x576c36['sender']['send']('fetch-progress',_0x557013,!![]);_0x5c2e6e<=0x0&&(_0x5c2e6e=_0x195df5['length']);let _0x2358a4=[];for(let _0x3fe80a=0x0;_0x3fe80a<_0x195df5['length']&&_0x3fe80a<_0x5c2e6e;_0x3fe80a++){_0x2358a4['push'](await _0x195df5[_0x3fe80a]['evaluate'](_0x52a545=>_0x52a545['textContent']));const _0x39969f='INSERT\x20INTO\x20'+_0x35ca07+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x39969f,[await _0x195df5[_0x3fe80a]['evaluate'](_0x590f43=>_0x590f43['textContent']),await _0x13258c[_0x3fe80a]['evaluate'](_0x37e0a6=>_0x37e0a6['textContent'])],function(_0x15cdc2){_0x15cdc2?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x35ca07+'\x27:',_0x15cdc2['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x557013=Math['round'](++_0x467892/_0x1b2502*0x64),_0x576c36['sender']['send']('fetch-progress',_0x557013,!![]),_0x2d350f&&(_0x576c36['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x576c36,_0x4d0821,_0x11470a,_0x35ca07,_0x2358a4)),new Promise(_0x4ca22a=>{_0x4ca22a('Scraping\x20finished!');});}catch(_0x5b9200){if(_0x2d350f)throw new Error(_0x5b9200);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x4bf316+'\x20nicht\x20gefunden:\x20'+_0x5b9200);return handle_fail(0x0);}}async function fetch_details_from_list(_0x174fe9,_0x578f85,_0x3bcc78,_0x465ad2,_0x185341){let _0x4a05c6=0x0,_0x3c9629=0x0;for(let _0x2451b5=0x0;_0x2451b5<_0x185341['length'];_0x2451b5++){console['log']('Processing\x20profile:',_0x185341[_0x2451b5]);try{await fetch_account_details(_0x578f85,_0x185341[_0x2451b5],_0x3bcc78,_0x465ad2);}catch(_0x312f60){console['error']('Detailed\x20Scraping\x20von:\x20',_0x185341[_0x2451b5],_0x312f60);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x185341[_0x2451b5]+'\x20'+_0x312f60);}_0x3c9629=Math['round'](++_0x4a05c6/_0x185341['length']*0x64),_0x174fe9['sender']['send']('fetch-progress',_0x3c9629,!![],!![]);}}async function fetch_likers_from_post(_0x2f43ef,_0x119228,_0x310b15,_0x9f4d88,_0x1924f9,_0x1d5329,_0x3f7a7f){let _0x32176a=0x4,_0x3bfede=0x0,_0x3e90d5=0x0;try{await setCookiesForUser(_0x119228,_0x1d5329['username']);}catch(_0x114df0){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x114df0);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x114df0);return handle_fail(0x1);return;}_0x3e90d5=Math['round'](++_0x3bfede/_0x32176a*0x64),_0x2f43ef['sender']['send']('fetch-progress',_0x3e90d5,!![]);try{let _0x5bae44=_0x310b15['substring'](0x0,_0x310b15['lastIndexOf']('/'));_0x5bae44['includes']('/reel/')&&(_0x5bae44=_0x5bae44['replace']('/reel/','/p/'));let _0x3aa6c1=_0x5bae44+'/liked_by';console['log'](_0x3aa6c1),await _0x119228['goto'](_0x3aa6c1),await delay(0x7d0,0xfa0),await notificationClear(_0x119228),await delay(0xc8,0x1f4),_0x3e90d5=Math['round'](++_0x3bfede/_0x32176a*0x64),_0x2f43ef['sender']['send']('fetch-progress',_0x3e90d5,!![]),await _0x119228['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x127af9=await _0x119228['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x4b1211=await _0x119228['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x127af9['length']);let _0x28694d=path['join'](__dirname,'/likers.csv');_0x3e90d5=Math['round'](++_0x3bfede/_0x32176a*0x64),_0x2f43ef['sender']['send']('fetch-progress',_0x3e90d5,!![]);_0x9f4d88<=0x0&&(_0x9f4d88=_0x127af9['length']);try{let _0x20a680=[];for(let _0x940bce=0x0;_0x940bce<_0x127af9['length']&&_0x940bce<_0x9f4d88;_0x940bce++){_0x20a680['push'](await _0x127af9[_0x940bce]['evaluate'](_0x412a6a=>_0x412a6a['textContent']));try{const _0x3c5f43='INSERT\x20INTO\x20'+_0x1924f9+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x3c5f43,[await _0x127af9[_0x940bce]['evaluate'](_0x1ccc92=>_0x1ccc92['textContent']),await _0x4b1211[_0x940bce]['evaluate'](_0x476ac9=>_0x476ac9['textContent'])],function(_0x23b0ac){_0x23b0ac?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x1924f9+'\x27:',_0x23b0ac['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x6fd7d2){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x940bce+'\x20:\x20'+_0x6fd7d2);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x940bce+'\x20:\x20'+_0x6fd7d2);return handle_fail(0x1);}}return _0x3e90d5=Math['round'](++_0x3bfede/_0x32176a*0x64),_0x2f43ef['sender']['send']('fetch-progress',_0x3e90d5,!![]),_0x3f7a7f&&(_0x2f43ef['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x2f43ef,_0x119228,_0x1d5329,_0x1924f9,_0x20a680)),new Promise(_0x391e1a=>{_0x391e1a('Scraping\x20finished!');});}catch(_0x1a9307){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x1a9307);return handle_fail(0x1);}}catch(_0x564367){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x564367);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x564367);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x4bae1a,_0x2157a3,_0x5bf626,_0x5f30e7,_0x10292a,_0x174010,_0x102a78){let _0x3d16df=0x3,_0x2e4346=0x0,_0x1bea06=0x0;try{await setCookiesForUser(_0x2157a3,_0x174010['username']);}catch(_0x1304b1){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x1304b1);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x1304b1);return handle_fail(0x2);}try{console['log'](_0x5bf626),await _0x2157a3['goto'](_0x5bf626),await delay(0x7d0,0xfa0),await notificationClear(_0x2157a3),await delay(0xc8,0x1f4);const _0x557c36=COM_COMMENTS_BOX_BODY_DIV;let _0x18d534;const _0x5a36fb=await _0x2157a3['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x46c88c=await _0x2157a3['evaluate'](_0x581297=>_0x581297['innerHTML'],_0x5a36fb),_0x5a5341=String(_0x46c88c)['replace'](/[^0-9]/g,''),_0x573f64=Number(_0x5a5341)/0x14;_0x5f30e7<=0x0?_0x18d534=Math['ceil'](_0x573f64/0x3):_0x18d534=Math['ceil'](_0x5f30e7/0x3);_0x3d16df+=_0x18d534,_0x1bea06=Math['round'](++_0x2e4346/_0x3d16df*0x64),_0x4bae1a['sender']['send']('fetch-progress',_0x1bea06,!![]),console['log']('Auto-scrolls:\x20'+_0x18d534),await scroll(_0x2157a3,_0x557c36,_0x18d534,_0x38f501=>{_0x1bea06=Math['round'](++_0x2e4346/_0x3d16df*0x64),_0x4bae1a['sender']['send']('fetch-progress',_0x1bea06,!![]);});try{const _0x2006d4=COM_REPLY_BUTTON_SPAN,_0x185744=await waitForXPathAll(_0x2157a3,_0x2006d4);console['log']('Reply-Buttons\x20gefunden:\x20ANZAHL:\x20'+_0x185744['size']),await delay(0x1f4,0x320);let _0x1f493c=_0x185744['size'],_0x3b304b=[];for(const [_0x39694d,_0x2315a2]of _0x185744){_0x3b304b['push'](_0x2315a2);}console['log']('Alle\x20Reply-Buttons:',_0x3b304b['length']);try{for(let _0x3fbcbe=0x0;_0x3fbcbe<_0x1f493c;_0x3fbcbe++){await _0x3b304b[_0x3fbcbe]['click'](),await delay(0x320,0x5dc);}}catch(_0x1ea28a){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x1ea28a);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x1ea28a);return handle_fail(0x2);}}catch(_0x27939f){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x43fd32=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x2157a3['waitForSelector'](_0x43fd32),await delay(0x1f4,0x320),_0x1bea06=Math['round'](++_0x2e4346/_0x3d16df*0x64),_0x4bae1a['sender']['send']('fetch-progress',_0x1bea06,!![]);const _0xfb13b8=await _0x2157a3['$$'](_0x43fd32);let _0x1ab32b=path['join'](__dirname,'/comments.csv');_0x5f30e7<=0x0&&(_0x5f30e7=_0xfb13b8['length']);console['log']('fetch_limit:\x20'+_0x5f30e7),console['log']('comments_len:\x20'+_0xfb13b8['length']),_0x5f30e7++;try{let _0x3a8df1=[];for(let _0x48965b=0x1;_0x48965b<_0xfb13b8['length']&&_0x48965b<_0x5f30e7;_0x48965b++){try{_0x3a8df1['push'](await _0xfb13b8[_0x48965b]['evaluate'](_0x59e10f=>_0x59e10f['textContent']));const _0x3fae35=await db['prepare']('INSERT\x20INTO\x20'+_0x10292a+'\x20(username)\x20VALUES\x20(?)');await _0x3fae35['run'](await _0xfb13b8[_0x48965b]['evaluate'](_0x19b605=>_0x19b605['textContent']),function(_0x377a7a){_0x377a7a&&console['log']('error\x20in\x20add-user:'+_0x377a7a);}),await _0x3fae35['finalize']();}catch(_0x31b5a7){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x48965b+'\x20:\x20'+_0x31b5a7);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x48965b+'\x20:\x20'+_0x31b5a7);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x1bea06=Math['round'](++_0x2e4346/_0x3d16df*0x64),_0x4bae1a['sender']['send']('fetch-progress',_0x1bea06,!![]),_0x4bae1a['sender']['send']('fetch-progress',0x64,!![]),_0x102a78&&(_0x4bae1a['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x4bae1a,_0x2157a3,_0x174010,_0x10292a,_0x3a8df1)),_0x4bae1a['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x4cb762=>{_0x4cb762('Scraping\x20finished!');});}catch(_0x2aa692){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x2aa692);return handle_fail(0x2);}}catch(_0x5428d0){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x5428d0);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x5428d0);return handle_fail(0x2);}}async function set_clearname_from_username(_0x4755ad,_0x2c89ca,_0x288b2e=null){try{let _0x4442ab,_0x3475cd;const _0x31c923='SELECT\x20username\x20FROM\x20'+_0x2c89ca+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x31c923,[],(_0x3e7bf4,_0x344737)=>{_0x3e7bf4&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x3e7bf4['message']),_0x344737['length']===0x0&&(_0x3475cd=_0x344737['length']),_0x4442ab=_0x344737['map'](_0x3adb9a=>_0x3adb9a['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x3475cd);if(_0x3475cd===0x0){console['log']('Leave');return;}const _0x247a64=await _0x4755ad['waitForSelector'](IG_SEARCH_BUTTON);await _0x247a64['click'](),await delay(0x4b0,0x7d0);for(let _0x582850 of _0x4442ab){const _0x3684bb=await _0x4755ad['waitForSelector'](IG_SEARCH_INPUT);await _0x3684bb['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x4755ad['type'](IG_SEARCH_INPUT,_0x582850,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x75ef87=0x1;while(_0x75ef87!=0x14){console['log']('Schleife');try{let _0x7dc582=IG_NAME_SPAN_PART1+_0x75ef87+IG_USERNAME_SPAN_PART2;const _0x370a1e=await _0x4755ad['waitForSelector'](_0x7dc582),_0x28e8ba=await _0x4755ad['evaluate'](_0x17db31=>_0x17db31['innerHTML'],_0x370a1e);await delay(0xc8,0x1f4);if(_0x28e8ba==_0x582850){let _0x431572=IG_NAME_SPAN_PART1+_0x75ef87+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x2b28a0=await _0x4755ad['waitForSelector'](_0x431572);let _0x8edda2=await _0x4755ad['evaluate'](_0xb13e3e=>_0xb13e3e['innerHTML'],_0x2b28a0);const _0x517828=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x5f1ccf=_0x8edda2['match'](_0x517828);_0x5f1ccf?_0x8edda2=_0x5f1ccf[0x1]['trim']():_0x8edda2=_0x8edda2['trim']();_0x8edda2['includes']('•')&&(_0x8edda2=_0x8edda2['substring'](0x0,_0x8edda2['indexOf']('•')-0x1));const _0x4a1c32='UPDATE\x20'+_0x2c89ca+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x4a1c32,[_0x8edda2,_0x28e8ba],function(_0x3bfada){_0x3bfada&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x3bfada['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x75ef87++;}catch(_0x5da581){const _0x4d43db='UPDATE\x20'+_0x2c89ca+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x4d43db,['',_0x582850],function(_0x30f596){_0x30f596&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x30f596['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x5da581);break;}}_0x288b2e&&_0x288b2e();}await _0x247a64['click']();}catch(_0x418cb7){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x418cb7);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x5d24e8,_0x54dace)=>{const _0x287289='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x287289,[],(_0x209d92,_0x5e2b26)=>{_0x209d92?_0x54dace(_0x209d92):_0x5d24e8(_0x5e2b26);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x2480dd,_0x148c8f)=>{const _0x256b08='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x256b08,[],async(_0x36f5fb,_0x286883)=>{if(_0x36f5fb)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x36f5fb['message']),_0x148c8f({'status':'error','message':_0x36f5fb['message']});else try{const _0xf31a26=await Promise['all'](_0x286883['map'](_0x3d4761=>{return new Promise(_0x104dbc=>{if(!_0x3d4761['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x3d4761['campaign_name']),_0x104dbc({'campaign_name':_0x3d4761['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x27e4ab='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x3d4761['list_id'],_0x4d1bc8='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x3d4761['list_id']+'\x22';db['get'](_0x27e4ab,[],(_0x34ec1c,_0x5e6df7)=>{_0x34ec1c?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x3d4761['campaign_name']+':',_0x34ec1c['message']),_0x104dbc({'campaign_name':_0x3d4761['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x4d1bc8,[],(_0x405d57,_0x1bdda8)=>{_0x405d57?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x3d4761['campaign_name']+':',_0x405d57['message']),_0x104dbc({'campaign_name':_0x3d4761['campaign_name'],'lead_count':_0x5e6df7?_0x5e6df7['lead_count']:0x0,'contacted_count':'N/A'})):_0x104dbc({'campaign_name':_0x3d4761['campaign_name'],'lead_count':_0x5e6df7?_0x5e6df7['lead_count']:0x0,'contacted_count':_0x1bdda8?_0x1bdda8['contacted_count']:0x0});});});});}));_0x2480dd({'status':'success','campaigns':_0xf31a26});}catch(_0x1e40a2){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x1e40a2),_0x148c8f({'status':'error','message':_0x1e40a2['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x4f8d9e,_0x13ae14)=>{return new Promise((_0x39b260,_0x6a2a40)=>{const _0x28b9a7='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x28b9a7,[_0x13ae14],(_0x5f143a,_0x51dc96)=>{_0x5f143a?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x5f143a),_0x6a2a40(_0x5f143a)):(console['log']('ROWS'),console['log'](_0x51dc96),debugDatabaseContents(),_0x39b260(_0x51dc96));});});});const showTableContents=_0x32c44d=>{return new Promise((_0x2532f7,_0x146a9c)=>{const _0x212ece='SELECT\x20*\x20FROM\x20'+_0x32c44d+';';campaignDB['all'](_0x212ece,(_0x14f92c,_0x4d0252)=>{_0x14f92c?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x32c44d+':',_0x14f92c),_0x146a9c(_0x14f92c)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x32c44d+':',_0x4d0252),_0x2532f7({'status':'success','message':_0x4d0252}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0xc9d2fc){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0xc9d2fc);}}ipcMain['handle']('create-campaign',async(_0x425300,_0x40302e)=>{return new Promise((_0x54d8cf,_0x44bb3e)=>{const _0x2a5284='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x2a5284,[String(_0x40302e)],function(_0x5462dd){_0x5462dd?_0x44bb3e(_0x5462dd):_0x54d8cf({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x3baeb4,_0x1fd343)=>{return new Promise((_0x59f916,_0x2627bf)=>{const _0x330fd9='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x330fd9,[_0x1fd343],function(_0x376f22){_0x376f22?_0x2627bf(_0x376f22):_0x59f916({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x59d8d3,_0xc4ba9b,_0x4b5704,_0x2209eb,_0xb7b7dd,_0x3ada90,_0x57c9b1,_0xb89361)=>{const _0x367186=await createMessageID(_0xb7b7dd);return new Promise((_0x4ff584,_0x5ad6c6)=>{if(!_0xc4ba9b||!_0x4b5704||!_0x2209eb||!_0x367186||!_0x3ada90)return _0x5ad6c6({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x367186);const _0x3ef699='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x3ef699,[_0x4b5704,_0x2209eb,_0x367186,_0x3ada90,_0x57c9b1,_0xb89361,_0xc4ba9b],function(_0x4c0767){if(_0x4c0767)_0x5ad6c6({'status':'error','message':_0x4c0767['message']});else this['changes']===0x0?_0x5ad6c6({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x4ff584({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x53d8d0,_0x351c5b,_0x36d759,_0x2283a2,_0x4305cd)=>{return new Promise((_0x1311bf,_0x442f70)=>{const _0x2c16d9='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x2c16d9,[_0x351c5b,_0x36d759,_0x2283a2,_0x4305cd],function(_0x362844){return _0x362844?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x362844['message']),_0x442f70('insert-dm-response',{'success':![],'message':_0x362844['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x1311bf('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x24b9bf=>{return new Promise((_0x9d658d,_0x3e8f83)=>{const _0x4a9e76='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x4a9e76,[_0x24b9bf],(_0x41f54a,_0x18a64a)=>{if(_0x41f54a)_0x3e8f83({'status':'error','message':_0x41f54a['message']});else{if(_0x18a64a)_0x9d658d(_0x18a64a['message_id']);else{const _0x3d7b9c='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x3d7b9c,[_0x24b9bf],function(_0x3a9686){_0x3a9686?_0x3e8f83({'status':'error','message':_0x3a9686['message']}):_0x9d658d(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x54f272,_0x133921)=>{return new Promise((_0x1f940e,_0x361af0)=>{const _0x5da17b='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x133921;db['get'](_0x5da17b,(_0x4c9b44,_0x254bef)=>{_0x4c9b44?_0x361af0({'status':'error','message':_0x4c9b44['message']}):_0x1f940e({'status':'success','count':_0x254bef['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x5a5832,_0xe6405e){try{const _0x4c1dbb=await new Promise((_0x2ba812,_0x4915ec)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0xe6405e],(_0x31115e,_0x1c5236)=>{if(_0x31115e)_0x4915ec(_0x31115e);else{if(_0x1c5236['length']>0x0){let _0x38208a=JSON['parse'](_0x1c5236[0x0]['cookie']);console['log'](_0x38208a),_0x2ba812(_0x38208a);}else _0x4915ec(new Error('User\x20with\x20username\x20'+_0xe6405e+'\x20does\x20not\x20exist.'));}});});await _0x5a5832['setCookie'](..._0x4c1dbb),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x287056){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x287056);}}async function saveCookiesForUser(_0x3dffa3,_0x26b7f6){try{const _0xf9bbff=await _0x3dffa3['cookies']();if(!_0xf9bbff||_0xf9bbff['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x26b7f6);const _0x1091dc=JSON['stringify'](_0xf9bbff);if(_0x1091dc['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x26b7f6);return new Promise((_0x117fc0,_0x20a3f6)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x26b7f6],(_0x44dff4,_0x702caa)=>{if(_0x44dff4)return console['error']('Error\x20checking\x20user\x20existence:',_0x44dff4),_0x20a3f6(_0x44dff4);if(_0x702caa){const _0x39751c=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x39751c['run'](_0x1091dc,_0x26b7f6,function(_0x5392fe){return _0x5392fe?(console['error']('Error\x20updating\x20cookies:',_0x5392fe),_0x20a3f6(_0x5392fe)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x26b7f6),_0x117fc0());});}else{const _0x3f0090=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x3f0090['run'](_0x26b7f6,_0x1091dc,function(_0x8cbeeb){return _0x8cbeeb?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x8cbeeb),_0x20a3f6(_0x8cbeeb)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x26b7f6),_0x117fc0());});}});});}catch(_0x38eff7){console['error']('Error\x20fetching\x20cookies:',_0x38eff7);throw _0x38eff7;}}async function createUserIfNotExists(_0xc52392){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0xc52392],(_0x3bd4d1,_0x296239)=>{if(_0x3bd4d1){console['error']('Error\x20checking\x20user\x20existence:',_0x3bd4d1);throw _0x3bd4d1;}else{if(!_0x296239){const _0x28ea74=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x28ea74['run'](_0xc52392,function(_0x9aea5c){_0x9aea5c?console['error']('Error\x20inserting\x20new\x20user:',_0x9aea5c):console['log']('New\x20user\x20created:',_0xc52392);});}else console['log']('User\x20already\x20exists:',_0xc52392);}});}catch(_0x244e5b){console['error']('Error\x20creating\x20user:',_0x244e5b);throw _0x244e5b;}}ipcMain['handle']('create-relation',async(_0x51e5c0,_0x8cdd0e)=>{return new Promise((_0x2af69f,_0x5102be)=>{const _0x24fad4='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x8cdd0e+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x24fad4,function(_0x3e7169){_0x3e7169?_0x5102be(_0x3e7169):_0x2af69f({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x3509cd,_0x8f4a9)=>{return console['log']('droping\x20table'+_0x8f4a9),new Promise((_0x2f8b45,_0x21519a)=>{const _0x343a70='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x8f4a9;console['log']('droping\x20table'+_0x8f4a9),db['run'](_0x343a70,function(_0x3133ef){_0x3133ef?_0x21519a(_0x3133ef):_0x2f8b45({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x24d4ec=>{return new Promise((_0x5d75de,_0x54e944)=>{const _0x2c09db='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x2c09db,[],(_0x11a7b4,_0x467ea9)=>{_0x11a7b4?_0x54e944(_0x11a7b4):_0x5d75de(_0x467ea9['map'](_0x29b891=>_0x29b891['name']));});});}),ipcMain['handle']('add-user',async(_0x1debcd,_0x471425,_0x299a2e)=>{return new Promise(_0x3cb967=>{const _0x234974=db['prepare']('INSERT\x20INTO\x20'+_0x299a2e+'\x20(username)\x20VALUES\x20(?)');_0x234974['run'](_0x471425,function(_0x444b1a){_0x444b1a?console['log']('error\x20in\x20add-user:'+_0x444b1a):_0x3cb967({'status':'success','id':this['lastID']});}),_0x234974['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0xabd3f2,_0x183f9a)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x4129e0,_0x25d823)=>{if(_0x4129e0)_0x183f9a(_0x4129e0);else{_0xabd3f2({'status':'success','users':_0x25d823});for(_0x25d823 of _0x25d823){console['log'](_0x25d823['username']);}}});});}),ipcMain['handle']('get-data',async(_0x29ac05,_0x4e71c2)=>{return new Promise((_0x4854dc,_0x36f9de)=>{const _0x5e6cef='SELECT\x20*\x20FROM\x20'+_0x4e71c2;console['log'](_0x5e6cef),db['all'](_0x5e6cef,[],(_0x3be92c,_0x42882b)=>{_0x3be92c?_0x36f9de(_0x3be92c):_0x4854dc(_0x42882b);});});}),ipcMain['handle']('get-accounts',async _0xf28b61=>{return new Promise((_0x236c6f,_0x58c76e)=>{const _0x408f0c='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x408f0c),igaccountsDB['all'](_0x408f0c,[],(_0x139da6,_0x48c27e)=>{_0x139da6?_0x58c76e(_0x139da6):_0x236c6f(_0x48c27e);});});}),ipcMain['handle']('get-targets',async(_0xd29c37,_0x2fcb0c)=>{return getTargetProfiles(_0x2fcb0c);}),ipcMain['handle']('delete-user',async(_0x2d058a,_0x31cb4f,_0x30675f)=>{return new Promise((_0x24e8a2,_0x59fc60)=>{const _0x3c4435=db['prepare']('DELETE\x20FROM\x20'+_0x30675f+'\x20WHERE\x20username\x20=\x20?');_0x3c4435['run'](_0x31cb4f,function(_0x8c503f){_0x8c503f?_0x59fc60(_0x8c503f):_0x24e8a2({'status':'success','changes':this['changes']});}),_0x3c4435['finalize']();});}),ipcMain['handle']('delete-account',async(_0x1cf4dd,_0x1bce23)=>{const _0x28b875=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x28b875['run'](_0x1bce23,function(_0x3e3347){_0x3e3347&&console['log'](_0x3e3347);}),_0x28b875['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x486ee9,_0x2d789a)=>{const _0x5eec02='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x5eec02,[],(_0x10d90d,_0x32b77c)=>{_0x10d90d?_0x2d789a({'status':'error','message':_0x10d90d['message']}):_0x486ee9({'status':'success','contactedCount':_0x32b77c['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x31e472,_0x4f2fb3)=>{const _0x3097a3='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x3097a3,[],(_0x546b78,_0x5a41cb)=>{_0x546b78?_0x4f2fb3({'status':'error','message':_0x546b78['message']}):_0x31e472({'status':'success','contactedCount':_0x5a41cb['contactedCount']});});});});function exportDatabase(_0x57c3c5){return new Promise((_0x5be1d8,_0x47774d)=>{const _0x4834e7='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x57c3c5+'\x0a\x20\x20\x20\x20';db['all'](_0x4834e7,[],async(_0x226362,_0x25f74c)=>{if(_0x226362){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x226362['message']),_0x47774d(_0x226362);return;}if(!_0x25f74c||_0x25f74c['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x5be1d8();return;}const _0x3e971c=XLSX['utils']['json_to_sheet'](_0x25f74c),_0x19a2bd=XLSX['utils']['sheet_to_csv'](_0x3e971c);try{const {canceled:_0x29f947,filePath:_0x1b3702}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x57c3c5+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x29f947||!_0x1b3702){console['log']('Speichern\x20abgebrochen.'),_0x5be1d8();return;}fs['writeFile'](_0x1b3702,_0x19a2bd,'utf8',_0x14b776=>{_0x14b776?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x14b776['message']),_0x47774d(_0x14b776)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x1b3702),_0x5be1d8());});}catch(_0x499ccd){console['error']('Fehler\x20im\x20Speicherdialog:',_0x499ccd),_0x47774d(_0x499ccd);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x664923,_0x57191f)=>{shell['openExternal'](_0x57191f);});