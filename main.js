const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');async function extractFirstName(_0x57f037,_0x453442){try{const _0x4979a7=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x453442},'body':JSON['stringify']({'clearname':_0x57f037})});if(!_0x4979a7['ok']){const _0x1abf27=await _0x4979a7['text']();throw new Error(_0x4979a7['status']+':\x20'+_0x1abf27);}const _0x352c6f=await _0x4979a7['json']();return _0x352c6f;}catch(_0x2733d1){console['error']('Error\x20in\x20extractFirstName:',_0x2733d1);throw _0x2733d1;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div:has(>\x20div[style=\x22height:\x20auto;\x20overflow:\x20hidden\x20auto;\x22])',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Message\x27]','div.x9f619.xjbqb8w.x78zum5.x15mokao.x1ga7v0g.x16uus16.xbiv7yw.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div','div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div'],K_OPTIONS_BUTTON=['[aria-label=\x22Options\x22]','section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.x1jfgfrl\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div'],K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD='div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f',K_SEND_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Send\x27]','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_ALREADY_CHATTED=['[role=\x22button\x22][aria-label=\x22Double\x20tap\x20to\x20like\x22]','div.html-div.xdj266r.x14z9mp.xat24cr.x1lziwak.xexx8yu.xyri2b.x18d9i69.x1c1uobl.x6ikm8r.x10wlt62\x20>\x20div\x20>\x20span'],K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x1dc46f=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x1dc46f['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x1dc46f['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0xf39826){var _0x4744ab=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x465e2e){console['log']('window\x20id:'+_0x465e2e['id']),_0x465e2e['id']>0x1&&(_0x4744ab=!![]);}),console['log']('child\x20opened\x20='+_0x4744ab);if(!_0x4744ab){const _0x1da8b4=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x1da8b4['loadFile'](_0xf39826['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x61c1c8=require('fs'),_0x31e354=path['join'](app['getPath']('userData'),'data'),_0x41448b=['campaign.db','crm.db','igaccounts.db'],_0x5347c8=[];try{_0x61c1c8['mkdirSync'](_0x31e354,{'recursive':!![]});for(const _0x2ff92d of _0x41448b){const _0x7d0bee=path['join'](process['resourcesPath'],'app','build','data',_0x2ff92d),_0x5b6d3b=path['join'](_0x31e354,_0x2ff92d);!_0x61c1c8['existsSync'](_0x5b6d3b)?(_0x61c1c8['copyFileSync'](_0x7d0bee,_0x5b6d3b),console['log']('[InitDB]\x20Kopiert\x20'+_0x2ff92d+'\x20nach:\x20'+_0x5b6d3b)):console['log']('[InitDB]\x20'+_0x2ff92d+'\x20existiert\x20bereits:\x20'+_0x5b6d3b),_0x5347c8['push'](_0x5b6d3b);}}catch(_0x5e9d69){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x5e9d69);}return _0x5347c8;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x12d010,AppUpdate:_0x47bc90}=require('electron-updater');_0x12d010['autoDownload']=![],_0x12d010['autoInstallOnAppQuit']=!![],_0x12d010['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x12d010['on']('update-available',_0xfb3737=>{console['log']('Update\x20verfügbar:',_0xfb3737),_0x12d010['downloadUpdate']();}),_0x12d010['on']('update-downloaded',_0x4efa31=>{console['log']('Update\x20heruntergeladen:',_0x4efa31),_0x12d010['quitAndInstall']();}),_0x12d010['on']('error',_0x315186=>{console['error']('Fehler\x20beim\x20Updaten:',_0x315186);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x3cbf0c,AppUpdate:_0x3405ff}=require('electron-updater');_0x3cbf0c['autoDownload']=![],_0x3cbf0c['autoInstallOnAppQuit']=!![],_0x3cbf0c['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x3cbf0c['on']('update-available',_0x356f4d=>{console['log']('Update\x20verfügbar:',_0x356f4d),_0x3cbf0c['downloadUpdate']();}),_0x3cbf0c['on']('update-downloaded',_0x1b3dee=>{console['log']('Update\x20heruntergeladen:',_0x1b3dee),console['log']('Neustarten\x20zum\x20Updaten');}),_0x3cbf0c['on']('error',_0x2e9930=>{console['error']('Fehler\x20beim\x20Updaten:',_0x2e9930);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x1bef02='',_0x9f7480=null;if(process['platform']==='darwin')_0x1bef02=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x1bef02=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x1bef02}),_0x9f7480=await browser_login['newPage'](),_0x9f7480['setDefaultNavigationTimeout'](0x1d4c),_0x9f7480['setDefaultTimeout'](0x1d4c),await _0x9f7480['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x9f7480;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x18856a=0x1,_0x391c77=0x0){try{let _0x16939b='',_0x5b92ed=null;const _0x30f67d=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x16939b=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x16939b=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x18856a===0x0&&!pageStack[_0x391c77])return browser=await puppeteer['launch']({'headless':_0x30f67d,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x16939b}),_0x5b92ed=await browser['newPage'](),_0x5b92ed['setDefaultNavigationTimeout'](0x1d4c),_0x5b92ed['setDefaultTimeout'](0x1d4c),await _0x5b92ed['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x391c77]=_0x5b92ed,_0x5b92ed;return(browser===null||pageStack[_0x391c77]===null||pageStack[_0x391c77]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x30f67d,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x16939b})),(pageStack[_0x391c77]===null||pageStack[_0x391c77]['isClosed']())&&(_0x5b92ed=await browser['newPage'](),_0x5b92ed['setDefaultNavigationTimeout'](0x1d4c),_0x5b92ed['setDefaultTimeout'](0x1d4c),await _0x5b92ed['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x391c77]=_0x5b92ed),pageStack[_0x391c77];}catch(_0x2c8290){console['error']('Failed\x20to\x20launch\x20browser:',_0x2c8290);const _0xf7f5ce=new Error('Browser\x20konnte\x20nicht\x20gestartet\x20werden.\x20Bitte\x20starte\x20die\x20App\x20neu.\x20:\x20'+_0x2c8290);throw _0xf7f5ce;}}ipcMain['on']('login',async(_0x264370,_0x523a86)=>{const _0x51b3dc=await getBrowserPageLogin();await _0x51b3dc['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x51b3dc,_0x523a86),ipcMain['on']('setLoginCookies',async(_0xb5e620,_0x495cb6)=>{try{await set_login_cookies(_0x51b3dc,_0x495cb6);}catch(_0x3a9411){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x3a9411);}});}),ipcMain['on']('export-relation',async(_0x4de033,_0x35d63d)=>{try{await exportDatabase(_0x35d63d),_0x4de033['reply']('export-relation-response',{'success':!![]});}catch(_0x3451d5){console['error'](_0x3451d5),_0x4de033['reply']('export-relation-response',{'success':![],'message':_0x3451d5['message']});}}),ipcMain['handle']('sendMessage',async(_0x589a7f,_0x50419b,_0x1fa80b,_0x48945e,_0x1f2d29,_0x10eaf0,_0x568d9f,_0x3b6f20,_0x6cc54c,_0x4e55b3,_0x589bd7)=>{isStopping=![];let _0x1b07bd=null;return _0x568d9f?_0x1b07bd=await getBrowserPage(_0x1f2d29,_0x3b6f20):_0x1b07bd=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x50419b),send_message(_0x1b07bd,_0x50419b,_0x1fa80b,_0x48945e,_0x1f2d29,_0x10eaf0,_0x6cc54c,_0x4e55b3,_0x589bd7);}),ipcMain['handle']('stop-action',async(_0xe6a662,_0x254ab2)=>{isStopping=!![];const _0x51c9f2=await getBrowserPage(0x1,_0x254ab2);await _0x51c9f2['close']();}),ipcMain['handle']('fetch_followers',async(_0x47dd35,_0x148410,_0xbfb4c2,_0x37b5e2,_0x4bd820,_0xd26262)=>{isStopping=![];const _0x1d3c5f=await getBrowserPage();return fetch_followers_from_account(_0x47dd35,_0x1d3c5f,_0x148410,_0xbfb4c2,_0x37b5e2,_0x4bd820,_0xd26262);}),ipcMain['handle']('get-account-details',async(_0xeb120,_0x3a00d5,_0x58e61c,_0x5f285e)=>{isStopping=![];const _0x20727a=await getBrowserPage();return fetch_account_details(_0x20727a,_0x3a00d5,_0x58e61c,_0x5f285e);}),ipcMain['handle']('fetch_likes',async(_0x36e877,_0x4791d9,_0x2bb39d,_0x2a94c1,_0x4825f5,_0x1e0c90)=>{isStopping=![];const _0x2a146b=await getBrowserPage();return fetch_likers_from_post(_0x36e877,_0x2a146b,_0x4791d9,_0x2bb39d,_0x2a94c1,_0x4825f5,_0x1e0c90);}),ipcMain['handle']('fetch_comments',async(_0x2909b2,_0x448df4,_0x45afa6,_0x1783b8,_0x5dc69d,_0x32daa7)=>{isStopping=![];const _0x5bc07b=await getBrowserPage();return fetch_comments_from_post(_0x2909b2,_0x5bc07b,_0x448df4,_0x45afa6,_0x1783b8,_0x5dc69d,_0x32daa7);});async function updateAppSilent(){const {spawn:_0x24ce6}=require('child_process'),_0xf5c60d=require('path'),_0x16a707=require('electron-log');return _0x16a707['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x1dd6d5,_0x1d2af2)=>{const {updateElectronApp:_0x2356e1,UpdateSourceType:_0xfb1138}=require('update-electron-app');_0x2356e1({'updateSource':{'type':_0xfb1138['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x16a707}),_0x1dd6d5('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0xbbffcb,_0x2b93c3)=>{doFullElectronUpdateSilent(),_0xbbffcb('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x36f5f9}=require('child_process'),_0x54b176=require('path'),_0x44fe4a=require('electron-log');return _0x44fe4a['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x59b85e,_0x210aa0)=>{const {updateElectronApp:_0x4c4287,UpdateSourceType:_0x14ec1d}=require('update-electron-app');_0x4c4287({'updateSource':{'type':_0x14ec1d['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x44fe4a}),_0x59b85e('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x269240,_0x3e552e)=>{doFullElectronUpdate(),_0x269240('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0x3082ff,_0x310f5f)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x3082ff('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x78c226=path['join'](__dirname,'mac-updater-intern.sh'),_0xfbe9ed=spawn('/bin/bash',[_0x78c226],{'detached':!![],'stdio':'ignore'});_0xfbe9ed['unref'](),setTimeout(()=>{_0x3082ff('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0x310f5f(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0x170aa5=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x53fd42,_0x3b320d)=>{console['log']('Update\x20Silent:\x20'+_0x3b320d);if(_0x3b320d){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0x5b578b,_0x3293e6){return Math['random']()*(_0x3293e6-_0x5b578b+0x1)+_0x5b578b;}function delay(_0x1492a7,_0x3a7ca5){let _0x197a37=getRnd(_0x1492a7,_0x3a7ca5);return new Promise(function(_0x315da9){setTimeout(_0x315da9,_0x197a37);});}async function scroll(_0x3a1d24,_0x49c377,_0x5a3bb1=0x2,_0x8bcc23){const _0x58164c=await _0x3a1d24['waitForSelector'](_0x49c377);for(let _0x551f37=0x0;_0x551f37<_0x5a3bb1;_0x551f37++){console['log']('Scrolling\x20'+_0x551f37),await _0x3a1d24['evaluate'](_0x560c89=>{const _0x25eb2b=document['querySelector'](_0x560c89);_0x25eb2b&&_0x25eb2b['scrollBy'](0x0,0x190);},_0x49c377),await delay(0x320,0x5dc),_0x8bcc23();}}async function saveCookies(_0x57e257){let _0x42dfbf=await _0x57e257['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x42dfbf,null,0x2));}async function notificationClear(_0x270a89){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x270a89['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x270a89['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x5507b6){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x5507b6);}}async function getTargetProfiles(_0x53e2ee){return new Promise((_0x1776ec,_0x32d30a)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x53e2ee,(_0xfe158f,_0x1a874d)=>{_0xfe158f?_0x32d30a(_0xfe158f):_0x1776ec(_0x1a874d);});});}async function login_legacy(_0x314466,_0x67aa08,_0x22c17f){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x314466,_0x67aa08),await createUserIfNotExists(_0x67aa08,_0x22c17f);}catch(_0x4f4b5b){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4f4b5b);}try{await _0x314466['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x314466['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x314466['click']('button._a9--._ap36._a9_0');}catch(_0x17304d){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x314466['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x314466['type']('input[name=\x27username\x27]',_0x67aa08,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x314466['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x314466['type']('input[name=\x27password\x27]',_0x22c17f,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x314466['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x314466['click']('button[type=\x27submit\x27]');}catch(_0x2940f2){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x314466),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x314466,_0x67aa08);}catch(_0x193768){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x193768);}}catch(_0x331df8){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x331df8);}}async function login(_0x1d5c83,_0x3b9054){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x1d5c83,_0x3b9054),await createUserIfNotExists(_0x3b9054);}catch(_0xf7d3e2){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0xf7d3e2);}try{await _0x1d5c83['goto']('https://www.instagram.com/accounts/login/');}catch(_0x9846ce){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x9846ce);}}async function set_login_cookies(_0x5d490a,_0x59b501){try{await saveCookiesForUser(_0x5d490a,_0x59b501);}catch(_0xccaf67){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0xccaf67);}}async function waitForXPath(_0x40abc3,_0x500773,_0x3a6090={}){return await _0x40abc3['waitForFunction'](_0x5c7f46=>{return document['evaluate'](_0x5c7f46,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x3a6090,_0x500773),_0x40abc3['evaluateHandle'](_0x2b39e0=>document['evaluate'](_0x2b39e0,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x500773);}async function waitForSelectorWithFallbacks(_0x15f1bc,_0x1fe70c,_0x5cff10={}){!Array['isArray'](_0x1fe70c)&&(_0x1fe70c=[_0x1fe70c]);for(let _0xa4ab72=0x0;_0xa4ab72<_0x1fe70c['length'];_0xa4ab72++){const _0xc331be=_0x1fe70c[_0xa4ab72],_0x256b46=_0xc331be['startsWith']('//')||_0xc331be['startsWith']('(//');try{console['log']('Versuche\x20'+(_0x256b46?'XPath':'Selector')+'\x20'+(_0xa4ab72+0x1)+'/'+_0x1fe70c['length']+':\x20'+_0xc331be['substring'](0x0,0x32)+'...');const _0x4ee0e5=_0xa4ab72===0x0?_0x5cff10['timeout']||0x1388:0x7d0;let _0x5bceb2;if(_0x256b46){const _0x220dd3=await waitForXPath(_0x15f1bc,_0xc331be,{..._0x5cff10,'timeout':_0x4ee0e5});if(!_0x220dd3)throw new Error('XPath-Element\x20nicht\x20gefunden');_0x5bceb2=_0x220dd3;}else _0x5bceb2=await _0x15f1bc['waitForSelector'](_0xc331be,{..._0x5cff10,'timeout':_0x4ee0e5});return console['log']((_0x256b46?'XPath':'Selector')+'\x20'+(_0xa4ab72+0x1)+'\x20gefunden!'),_0x5bceb2;}catch(_0x5ef534){console['log']((_0x256b46?'XPath':'Selector')+'\x20'+(_0xa4ab72+0x1)+'\x20nicht\x20gefunden:\x20'+_0x5ef534['message']);if(_0xa4ab72===_0x1fe70c['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x1fe70c['length']+'\x20Selektoren/XPath\x20konnte\x20gefunden\x20werden:\x20'+_0x5ef534['message']);}}throw new Error('Keine\x20Selektoren/XPath\x20angegeben');}async function send_message(_0x18d988,_0x4fd976,_0x15cd11,_0x433646,_0x557f9f,_0x5533a2,_0x5c4548,_0x55aab0,_0x492efa){return new Promise(async(_0x3f4eec,_0xb0e082)=>{_0x5533a2=_0x5533a2['split'](';'),console['log'](_0x5533a2[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x557f9f);try{await setCookiesForUser(_0x18d988,_0x5533a2[0x0]);}catch(_0x3ede7f){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x3ede7f),_0x3f4eec({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x3ede7f});return;}try{await _0x18d988['goto']('https://www.instagram.com/'+_0x4fd976+'/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x18d988);}catch(_0x59bacf){_0x3f4eec({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x59bacf});return;}console['log']('UserSkip:\x20'+_0x5c4548);if(_0x5c4548==0x1)try{const _0xc6e8a6=await _0x18d988['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x3956d1=>_0x3956d1['textContent']['trim']());console['log'](_0xc6e8a6);if(_0xc6e8a6==='Following'||_0xc6e8a6==='Folge\x20ich')return _0x3f4eec({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x1db2da){}try{const _0x4f1e7=await waitForSelectorWithFallbacks(_0x18d988,K_DIRECT_MSG_BUTTON);await _0x4f1e7['click']();}catch(_0x4297fd){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x4297fd);try{try{const _0x2e1ca2=await waitForSelectorWithFallbacks(_0x18d988,K_OPTIONS_BUTTON);await _0x2e1ca2['click']();}catch(_0x3fbe36){console['log']('Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x3fbe36),_0x3f4eec({'status':0x1f4,'message':'Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x3fbe36});return;}await delay(0x1f4,0x320);const _0x598bcf=await waitForXPath(_0x18d988,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x598bcf['click']();}catch(_0x5e9d77){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x5e9d77),_0x3f4eec({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x18d988);}catch(_0x10feed){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x10feed);}try{const _0x289050=await _0x18d988['waitForSelector'](K_CHAT_INPUT_FIELD);if(_0x55aab0){const _0x56f964=await waitForSelectorWithFallbacks(_0x18d988,K_ALREADY_CHATTED);if(_0x56f964)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x4fd976),_0x3f4eec({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x212c2e=await _0x18d988['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x212c2e),_0x433646=_0x433646['replace']('{USERNAME}',_0x4fd976);let _0x3baad7;if(_0x433646['includes']('{NAME}')||_0x433646['includes']('{name}'))try{const _0x4af1fb=await extractFirstName(_0x212c2e,_0x492efa);console['log']('Response\x20Clearname\x20valid:\x20'+_0x4af1fb['valid']),_0x4af1fb['valid']?(_0x433646=_0x433646['replaceAll'](/{NAME}|{name}/g,_0x4af1fb['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x4af1fb['name']),_0x3baad7=_0x4af1fb['name']):(_0x433646=_0x433646['replaceAll'](/ ?({NAME}|{name})/g,''),_0x3baad7='UNKNOWN_NAME');}catch(_0xab436a){console['log'](_0xab436a['message']),_0x3baad7=_0xab436a['message'];let _0x21ef6c=_0x212c2e['replace'](/[^\p{L}\s]/gu,''),_0x133e38=_0x21ef6c['split']('\x20')[0x0];_0x133e38['length']>0x2&&!_0x133e38['includes']('Instagram')?_0x433646=_0x433646['replaceAll'](/{NAME}|{name}/g,_0x133e38):_0x433646=_0x433646['replaceAll'](/ ?({NAME}|{name})/g,'');}await _0x289050['type'](_0x433646,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0x5682b1=await waitForSelectorWithFallbacks(_0x18d988,K_SEND_MSG_BUTTON);await _0x5682b1['click'](),await delay(0x320,0x3e8),_0x3f4eec({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x212c2e,'extracted_clearname':_0x3baad7});}catch(_0x2cf041){try{await _0x18d988['waitForSelector'](K_MSG_DISABLED_LABEL);const _0xc84df5=await _0x18d988['evaluate'](_0x3c3073=>{return document['querySelector'](_0x3c3073)['textContent'];},K_MSG_DISABLED_LABEL);console['log']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20gefunden:\x20'+_0xc84df5),console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x2cf041),_0x3f4eec({'status':0x195,'message':'Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x4fd976+'\x20überspringen.'});}catch(_0xc43225){console['error']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20nicht\x20gefunden:\x20'+_0xc43225),console['error']('Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x4fd976+'\x20:\x20'+_0xc43225),_0x3f4eec({'status':0x196,'message':'Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x4fd976+'\x20:\x20'+_0xc43225});}}});}function handle_fail(_0x3392cc){if(isStopping)return new Promise(_0x52bde6=>{_0x52bde6('Scraper\x20gestoppt.');});else{let _0x84f1aa='';switch(_0x3392cc){case 0x0:_0x84f1aa='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x84f1aa='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x84f1aa='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x84f1aa='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x2a7720,_0x51fc01)=>{_0x51fc01(_0x84f1aa);});}}async function fetch_account_details(_0x427771,_0x1e4e7a,_0x4a00fe,_0x790a59){try{await setCookiesForUser(_0x427771,_0x4a00fe['username']);}catch(_0x27f30c){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x27f30c);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x27f30c);return handle_fail(0x0);}_0x427771['setDefaultNavigationTimeout'](0x7530),await _0x427771['goto']('https://www.instagram.com/'+_0x1e4e7a+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x427771);const _0x72f03b=await _0x427771['evaluate'](()=>{const _0x34a136=document['querySelector']('meta[property=\x22og:image\x22]');return _0x34a136?_0x34a136['getAttribute']('content'):null;});await _0x427771['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x21e1ae=await _0x427771['evaluate'](()=>{const _0x4c9d2e=document['querySelector']('meta[name=\x22description\x22]');if(!_0x4c9d2e)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0xb756e8=_0x4c9d2e['getAttribute']('content');if(!_0xb756e8)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0xb756e8);const _0x541f24=/\s*[–-]\s*/,_0x2f7aa3=_0xb756e8['split'](_0x541f24);if(_0x2f7aa3['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x55cb51=_0x2f7aa3[0x0],_0x2b7016=_0x2f7aa3[0x1],_0x370d37=_0x55cb51['split'](',\x20');if(_0x370d37['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x19de04=_0x370d37[0x0]['split']('\x20')[0x0],_0x3c3542=_0x370d37[0x1]['split']('\x20')[0x0],_0x283b54=_0x370d37[0x2]['split']('\x20')[0x0];let _0x5ac9e0='',_0x566390='';const _0x57db01='\x20on\x20Instagram:\x20',_0x48c011=_0x2b7016['split'](_0x57db01);return _0x5ac9e0=_0x48c011[0x0]['trim'](),_0x5ac9e0=_0x5ac9e0['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x48c011['length']>0x1&&(_0x566390=_0x48c011[0x1]['trim'](),_0x566390['startsWith']('\x22')&&_0x566390['endsWith']('\x22')&&(_0x566390=_0x566390['substring'](0x1,_0x566390['length']-0x1)['trim']()),_0x566390=_0x566390['replace'](/&quot;/g,'')['trim']()),{'followers':_0x19de04,'following':_0x3c3542,'posts':_0x283b54,'nameText':_0x5ac9e0,'bio':_0x566390};});console['log']('Extracted\x20profile\x20data:',_0x21e1ae);const _0xbf4b9f=_0x21e1ae['nameText'],_0x318fc9=_0x72f03b,_0x8f8a92=_0x21e1ae['bio'],_0x241b66=_0x21e1ae['followers'],_0x16bb6d=_0x21e1ae['following'],_0x165b9f=_0x21e1ae['posts'],_0x5022a8=![],_0x44f558=![],_0x52f8e9=![],_0x2af5d0='\x0a\x20\x20INSERT\x20INTO\x20'+_0x790a59+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x2af5d0,[_0x1e4e7a,_0xbf4b9f,_0x318fc9,_0x8f8a92,_0x241b66,_0x16bb6d,_0x165b9f,_0x5022a8,_0x44f558,_0x52f8e9],function(_0x4f05ee){_0x4f05ee?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x4f05ee['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x57e682,_0xba86d2,_0x485f61,_0x3cb0de,_0x4c28ce,_0x5ad872,_0x2112f2){let _0x489f54=0x4,_0x1618f8=0x0,_0x559e7e=0x0;try{await setCookiesForUser(_0xba86d2,_0x5ad872['username']);}catch(_0xfad58f){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0xfad58f);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0xfad58f);return handle_fail(0x0);}let _0x2a42b9=0x0;try{await _0xba86d2['goto']('https://www.instagram.com/'+_0x485f61+'/'),await notificationClear(_0xba86d2);try{if(_0x3cb0de<=0x0){const _0x157443=await _0xba86d2['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0xa72b3c=await _0xba86d2['evaluate'](_0x272a2c=>_0x272a2c['innerHTML'],_0x157443);_0x2a42b9=Math['ceil'](_0xa72b3c/0x4);}else _0x2a42b9=Math['ceil'](_0x3cb0de/0x4);_0x489f54+=_0x2a42b9,_0x559e7e=Math['round'](++_0x1618f8/_0x489f54*0x64),_0x57e682['sender']['send']('fetch-progress',_0x559e7e,!![]);let _0xea2626=await _0xba86d2['waitForSelector']('a[href=\x22/'+_0x485f61+'/followers/\x22]');await delay(0xbb8,0x1388),await _0xea2626['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x485f61+'\x20gesichtet'),_0x559e7e=Math['round'](++_0x1618f8/_0x489f54*0x64),_0x57e682['sender']['send']('fetch-progress',_0x559e7e,!![]);}catch(_0x5a9694){console['log']('Follower\x20Liste\x20von\x20'+_0x485f61+'\x20nicht\x20gefunden:'+_0x5a9694);throw new Error('Follower\x20Liste\x20von\x20'+_0x485f61+'\x20nicht\x20gefunden:'+_0x5a9694);return handle_fail(0x0);}}catch(_0x5116fc){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x5116fc);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x5116fc);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x2a42b9),await scroll(_0xba86d2,FOLLOWER_FENSTER,_0x2a42b9,_0x16449d=>{_0x559e7e=Math['round'](++_0x1618f8/_0x489f54*0x64),_0x57e682['sender']['send']('fetch-progress',_0x559e7e,!![]);}),await _0xba86d2['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x2fad05=await _0xba86d2['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x4b7780=await _0xba86d2['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x559e7e=Math['round'](++_0x1618f8/_0x489f54*0x64),_0x57e682['sender']['send']('fetch-progress',_0x559e7e,!![]);_0x3cb0de<=0x0&&(_0x3cb0de=_0x2fad05['length']);let _0x25856e=[];for(let _0x5cd249=0x0;_0x5cd249<_0x2fad05['length']&&_0x5cd249<_0x3cb0de;_0x5cd249++){_0x25856e['push'](await _0x2fad05[_0x5cd249]['evaluate'](_0x1ff1a2=>_0x1ff1a2['textContent']));const _0xbeeeeb='INSERT\x20INTO\x20'+_0x4c28ce+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0xbeeeeb,[await _0x2fad05[_0x5cd249]['evaluate'](_0x21dc16=>_0x21dc16['textContent']),await _0x4b7780[_0x5cd249]['evaluate'](_0x45d8cb=>_0x45d8cb['textContent'])],function(_0x520794){_0x520794?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x4c28ce+'\x27:',_0x520794['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x559e7e=Math['round'](++_0x1618f8/_0x489f54*0x64),_0x57e682['sender']['send']('fetch-progress',_0x559e7e,!![]),_0x2112f2&&(_0x57e682['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x57e682,_0xba86d2,_0x5ad872,_0x4c28ce,_0x25856e)),new Promise(_0xba20cd=>{_0xba20cd('Scraping\x20finished!');});}catch(_0x378e58){if(_0x2112f2)throw new Error(_0x378e58);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x485f61+'\x20nicht\x20gefunden:\x20'+_0x378e58);return handle_fail(0x0);}}async function fetch_details_from_list(_0x3571ed,_0x206c9c,_0x890ef5,_0x2d1327,_0x3ca6d6){let _0x45dbce=0x0,_0x39fac1=0x0;for(let _0x1f03ee=0x0;_0x1f03ee<_0x3ca6d6['length'];_0x1f03ee++){console['log']('Processing\x20profile:',_0x3ca6d6[_0x1f03ee]);try{await fetch_account_details(_0x206c9c,_0x3ca6d6[_0x1f03ee],_0x890ef5,_0x2d1327);}catch(_0x2831d6){console['error']('Detailed\x20Scraping\x20von:\x20',_0x3ca6d6[_0x1f03ee],_0x2831d6);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x3ca6d6[_0x1f03ee]+'\x20'+_0x2831d6);}_0x39fac1=Math['round'](++_0x45dbce/_0x3ca6d6['length']*0x64),_0x3571ed['sender']['send']('fetch-progress',_0x39fac1,!![],!![]);}}async function fetch_likers_from_post(_0x10182c,_0x558d35,_0x4d9e15,_0x5b8a66,_0x3869d9,_0x2301d9,_0x4b920f){let _0x58d2e7=0x4,_0x85922a=0x0,_0x3c9eb2=0x0;try{await setCookiesForUser(_0x558d35,_0x2301d9['username']);}catch(_0x4ccf6b){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x4ccf6b);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x4ccf6b);return handle_fail(0x1);return;}_0x3c9eb2=Math['round'](++_0x85922a/_0x58d2e7*0x64),_0x10182c['sender']['send']('fetch-progress',_0x3c9eb2,!![]);try{let _0x2b6894=_0x4d9e15['substring'](0x0,_0x4d9e15['lastIndexOf']('/'));_0x2b6894['includes']('/reel/')&&(_0x2b6894=_0x2b6894['replace']('/reel/','/p/'));let _0x2bddc1=_0x2b6894+'/liked_by';console['log'](_0x2bddc1),await _0x558d35['goto'](_0x2bddc1),await delay(0x7d0,0xfa0),await notificationClear(_0x558d35),await delay(0xc8,0x1f4),_0x3c9eb2=Math['round'](++_0x85922a/_0x58d2e7*0x64),_0x10182c['sender']['send']('fetch-progress',_0x3c9eb2,!![]),await _0x558d35['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x1c766b=await _0x558d35['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x34dcc8=await _0x558d35['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x1c766b['length']);let _0x398f02=path['join'](__dirname,'/likers.csv');_0x3c9eb2=Math['round'](++_0x85922a/_0x58d2e7*0x64),_0x10182c['sender']['send']('fetch-progress',_0x3c9eb2,!![]);_0x5b8a66<=0x0&&(_0x5b8a66=_0x1c766b['length']);try{let _0x42795a=[];for(let _0x5d953a=0x0;_0x5d953a<_0x1c766b['length']&&_0x5d953a<_0x5b8a66;_0x5d953a++){_0x42795a['push'](await _0x1c766b[_0x5d953a]['evaluate'](_0x4934a6=>_0x4934a6['textContent']));try{const _0x1755b0='INSERT\x20INTO\x20'+_0x3869d9+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x1755b0,[await _0x1c766b[_0x5d953a]['evaluate'](_0x517c8c=>_0x517c8c['textContent']),await _0x34dcc8[_0x5d953a]['evaluate'](_0x1cf965=>_0x1cf965['textContent'])],function(_0x5e41b3){_0x5e41b3?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x3869d9+'\x27:',_0x5e41b3['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x4dab7f){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x5d953a+'\x20:\x20'+_0x4dab7f);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x5d953a+'\x20:\x20'+_0x4dab7f);return handle_fail(0x1);}}return _0x3c9eb2=Math['round'](++_0x85922a/_0x58d2e7*0x64),_0x10182c['sender']['send']('fetch-progress',_0x3c9eb2,!![]),_0x4b920f&&(_0x10182c['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x10182c,_0x558d35,_0x2301d9,_0x3869d9,_0x42795a)),new Promise(_0x34489a=>{_0x34489a('Scraping\x20finished!');});}catch(_0x2f37b5){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x2f37b5);return handle_fail(0x1);}}catch(_0x492c3f){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x492c3f);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x492c3f);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x99d7ae,_0x48a673,_0x9b962d,_0x4bcc73,_0xc34ae9,_0x592fff,_0x17a1fa){let _0x68610b=0x3,_0x15f2fc=0x0,_0x40e00d=0x0;try{await setCookiesForUser(_0x48a673,_0x592fff['username']);}catch(_0x41ecd3){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x41ecd3);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x41ecd3);return handle_fail(0x2);}try{console['log'](_0x9b962d),await _0x48a673['goto'](_0x9b962d),await delay(0x7d0,0xfa0),await notificationClear(_0x48a673),await delay(0xc8,0x1f4);const _0xe0e047=COM_COMMENTS_BOX_BODY_DIV;let _0x3ca022;const _0x2be0fa=await _0x48a673['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x5b5f9c=await _0x48a673['evaluate'](_0x3ef5c5=>_0x3ef5c5['innerHTML'],_0x2be0fa),_0x9442d1=String(_0x5b5f9c)['replace'](/[^0-9]/g,''),_0x120839=Number(_0x9442d1)/0x14;_0x4bcc73<=0x0?_0x3ca022=Math['ceil'](_0x120839/0x3):_0x3ca022=Math['ceil'](_0x4bcc73/0x3);_0x68610b+=_0x3ca022,_0x40e00d=Math['round'](++_0x15f2fc/_0x68610b*0x64),_0x99d7ae['sender']['send']('fetch-progress',_0x40e00d,!![]),console['log']('Auto-scrolls:\x20'+_0x3ca022),await scroll(_0x48a673,_0xe0e047,_0x3ca022,_0x546213=>{_0x40e00d=Math['round'](++_0x15f2fc/_0x68610b*0x64),_0x99d7ae['sender']['send']('fetch-progress',_0x40e00d,!![]);});try{const _0x258fa4=COM_REPLY_BUTTON_SPAN;await _0x48a673['waitForSelector'](_0x258fa4),await delay(0x1f4,0x320);const _0x11f206=await _0x48a673['$$'](_0x258fa4);console['log'](_0x11f206);let _0x4f87c1=_0x11f206['length'];await delay(0xc8,0x1f4);try{for(let _0x561446=0x0;_0x561446<_0x4f87c1;_0x561446++){_0x11f206[_0x561446]['click'](),await delay(0x320,0x5dc);}}catch(_0x58ea53){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x58ea53);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x58ea53);return handle_fail(0x2);}}catch(_0x48573a){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x5bc338=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x48a673['waitForSelector'](_0x5bc338),await delay(0x1f4,0x320),_0x40e00d=Math['round'](++_0x15f2fc/_0x68610b*0x64),_0x99d7ae['sender']['send']('fetch-progress',_0x40e00d,!![]);const _0x5c8e69=await _0x48a673['$$'](_0x5bc338);let _0x53da02=path['join'](__dirname,'/comments.csv');_0x4bcc73<=0x0&&(_0x4bcc73=_0x5c8e69['length']);console['log']('fetch_limit:\x20'+_0x4bcc73),console['log']('comments_len:\x20'+_0x5c8e69['length']),_0x4bcc73++;try{let _0x267fbe=[];for(let _0x78e8c0=0x1;_0x78e8c0<_0x5c8e69['length']&&_0x78e8c0<_0x4bcc73;_0x78e8c0++){try{_0x267fbe['push'](await _0x5c8e69[_0x78e8c0]['evaluate'](_0x48edeb=>_0x48edeb['textContent']));const _0x392cca=await db['prepare']('INSERT\x20INTO\x20'+_0xc34ae9+'\x20(username)\x20VALUES\x20(?)');await _0x392cca['run'](await _0x5c8e69[_0x78e8c0]['evaluate'](_0x14a6d1=>_0x14a6d1['textContent']),function(_0x1344be){_0x1344be&&console['log']('error\x20in\x20add-user:'+_0x1344be);}),await _0x392cca['finalize']();}catch(_0x1873e8){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x78e8c0+'\x20:\x20'+_0x1873e8);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x78e8c0+'\x20:\x20'+_0x1873e8);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x40e00d=Math['round'](++_0x15f2fc/_0x68610b*0x64),_0x99d7ae['sender']['send']('fetch-progress',_0x40e00d,!![]),_0x99d7ae['sender']['send']('fetch-progress',0x64,!![]),_0x17a1fa&&(_0x99d7ae['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x99d7ae,_0x48a673,_0x592fff,_0xc34ae9,_0x267fbe)),_0x99d7ae['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x380a58=>{_0x380a58('Scraping\x20finished!');});}catch(_0x2d8d0f){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x2d8d0f);return handle_fail(0x2);}}catch(_0x83efd7){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x83efd7);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x83efd7);return handle_fail(0x2);}}async function set_clearname_from_username(_0x181cb8,_0x55196d,_0x16773d=null){try{let _0x5f2156,_0x3438ea;const _0x1a57c7='SELECT\x20username\x20FROM\x20'+_0x55196d+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x1a57c7,[],(_0xc08418,_0x27cdbe)=>{_0xc08418&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0xc08418['message']),_0x27cdbe['length']===0x0&&(_0x3438ea=_0x27cdbe['length']),_0x5f2156=_0x27cdbe['map'](_0xb3dbc=>_0xb3dbc['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x3438ea);if(_0x3438ea===0x0){console['log']('Leave');return;}const _0x346769=await _0x181cb8['waitForSelector'](IG_SEARCH_BUTTON);await _0x346769['click'](),await delay(0x4b0,0x7d0);for(let _0x68fb2 of _0x5f2156){const _0x1c5cb0=await _0x181cb8['waitForSelector'](IG_SEARCH_INPUT);await _0x1c5cb0['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x181cb8['type'](IG_SEARCH_INPUT,_0x68fb2,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x4b73ae=0x1;while(_0x4b73ae!=0x14){console['log']('Schleife');try{let _0x1ca22c=IG_NAME_SPAN_PART1+_0x4b73ae+IG_USERNAME_SPAN_PART2;const _0xad72bc=await _0x181cb8['waitForSelector'](_0x1ca22c),_0x16b323=await _0x181cb8['evaluate'](_0x3898cf=>_0x3898cf['innerHTML'],_0xad72bc);await delay(0xc8,0x1f4);if(_0x16b323==_0x68fb2){let _0x158c49=IG_NAME_SPAN_PART1+_0x4b73ae+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x5c2243=await _0x181cb8['waitForSelector'](_0x158c49);let _0x142f45=await _0x181cb8['evaluate'](_0x9fde71=>_0x9fde71['innerHTML'],_0x5c2243);const _0x22093b=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x397f49=_0x142f45['match'](_0x22093b);_0x397f49?_0x142f45=_0x397f49[0x1]['trim']():_0x142f45=_0x142f45['trim']();_0x142f45['includes']('•')&&(_0x142f45=_0x142f45['substring'](0x0,_0x142f45['indexOf']('•')-0x1));const _0xc028c5='UPDATE\x20'+_0x55196d+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0xc028c5,[_0x142f45,_0x16b323],function(_0x439385){_0x439385&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x439385['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x4b73ae++;}catch(_0x374b0c){const _0x4b7e95='UPDATE\x20'+_0x55196d+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x4b7e95,['',_0x68fb2],function(_0x566424){_0x566424&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x566424['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x374b0c);break;}}_0x16773d&&_0x16773d();}await _0x346769['click']();}catch(_0x4e714c){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x4e714c);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x17848b,_0x443fa2)=>{const _0x531210='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x531210,[],(_0x3bf27e,_0x4fb765)=>{_0x3bf27e?_0x443fa2(_0x3bf27e):_0x17848b(_0x4fb765);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x1d4d4c,_0x157e59)=>{const _0x264aff='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x264aff,[],async(_0x36439e,_0x30e6a7)=>{if(_0x36439e)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x36439e['message']),_0x157e59({'status':'error','message':_0x36439e['message']});else try{const _0x4702d4=await Promise['all'](_0x30e6a7['map'](_0x535cba=>{return new Promise(_0x418303=>{if(!_0x535cba['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x535cba['campaign_name']),_0x418303({'campaign_name':_0x535cba['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x632e06='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x535cba['list_id'],_0x109e56='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x535cba['list_id']+'\x22';db['get'](_0x632e06,[],(_0x1c57d0,_0x19b004)=>{_0x1c57d0?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x535cba['campaign_name']+':',_0x1c57d0['message']),_0x418303({'campaign_name':_0x535cba['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x109e56,[],(_0x1c047f,_0x200dc7)=>{_0x1c047f?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x535cba['campaign_name']+':',_0x1c047f['message']),_0x418303({'campaign_name':_0x535cba['campaign_name'],'lead_count':_0x19b004?_0x19b004['lead_count']:0x0,'contacted_count':'N/A'})):_0x418303({'campaign_name':_0x535cba['campaign_name'],'lead_count':_0x19b004?_0x19b004['lead_count']:0x0,'contacted_count':_0x200dc7?_0x200dc7['contacted_count']:0x0});});});});}));_0x1d4d4c({'status':'success','campaigns':_0x4702d4});}catch(_0x1c002d){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x1c002d),_0x157e59({'status':'error','message':_0x1c002d['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x2604d9,_0x1c2054)=>{return new Promise((_0xcea9b5,_0xe3fc61)=>{const _0xda4ae5='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0xda4ae5,[_0x1c2054],(_0x30f729,_0xb5fc9d)=>{_0x30f729?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x30f729),_0xe3fc61(_0x30f729)):(console['log']('ROWS'),console['log'](_0xb5fc9d),debugDatabaseContents(),_0xcea9b5(_0xb5fc9d));});});});const showTableContents=_0x40a5c4=>{return new Promise((_0x3d5be0,_0x5910f5)=>{const _0x1913f7='SELECT\x20*\x20FROM\x20'+_0x40a5c4+';';campaignDB['all'](_0x1913f7,(_0x26f5bc,_0x22a4b3)=>{_0x26f5bc?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x40a5c4+':',_0x26f5bc),_0x5910f5(_0x26f5bc)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x40a5c4+':',_0x22a4b3),_0x3d5be0({'status':'success','message':_0x22a4b3}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x3890f2){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x3890f2);}}ipcMain['handle']('create-campaign',async(_0x3a89ba,_0xc48113)=>{return new Promise((_0x31487f,_0x579d0a)=>{const _0xb3e563='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0xb3e563,[String(_0xc48113)],function(_0x20c23b){_0x20c23b?_0x579d0a(_0x20c23b):_0x31487f({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x5cbe82,_0x2797a8)=>{return new Promise((_0x441d4f,_0x3412c1)=>{const _0x149d7f='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x149d7f,[_0x2797a8],function(_0x42465f){_0x42465f?_0x3412c1(_0x42465f):_0x441d4f({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x1cb43d,_0x2ef201,_0x5e4cb3,_0x52e952,_0x4766ae,_0x51d8a6,_0x12d8ba,_0x2ece22)=>{const _0xd811a7=await createMessageID(_0x4766ae);return new Promise((_0x3c61ae,_0x5118e5)=>{if(!_0x2ef201||!_0x5e4cb3||!_0x52e952||!_0xd811a7||!_0x51d8a6)return _0x5118e5({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0xd811a7);const _0x208ecf='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x208ecf,[_0x5e4cb3,_0x52e952,_0xd811a7,_0x51d8a6,_0x12d8ba,_0x2ece22,_0x2ef201],function(_0x2c1378){if(_0x2c1378)_0x5118e5({'status':'error','message':_0x2c1378['message']});else this['changes']===0x0?_0x5118e5({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x3c61ae({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x44db2a,_0x5631cd,_0x360da5,_0x2246fa,_0x2509fd)=>{return new Promise((_0x17997d,_0x3fb9e2)=>{const _0x15dabc='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x15dabc,[_0x5631cd,_0x360da5,_0x2246fa,_0x2509fd],function(_0x3e4e98){return _0x3e4e98?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x3e4e98['message']),_0x3fb9e2('insert-dm-response',{'success':![],'message':_0x3e4e98['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x17997d('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x58d09e=>{return new Promise((_0x3eafaa,_0x45b5ec)=>{const _0x42343d='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x42343d,[_0x58d09e],(_0x3523c2,_0xc574d7)=>{if(_0x3523c2)_0x45b5ec({'status':'error','message':_0x3523c2['message']});else{if(_0xc574d7)_0x3eafaa(_0xc574d7['message_id']);else{const _0x4264d8='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x4264d8,[_0x58d09e],function(_0x2604bf){_0x2604bf?_0x45b5ec({'status':'error','message':_0x2604bf['message']}):_0x3eafaa(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x45a4c4,_0x1afa8d)=>{return new Promise((_0x2b1f5a,_0x6ea81a)=>{const _0x1dac3d='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x1afa8d;db['get'](_0x1dac3d,(_0x53287f,_0x14b8f8)=>{_0x53287f?_0x6ea81a({'status':'error','message':_0x53287f['message']}):_0x2b1f5a({'status':'success','count':_0x14b8f8['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x4d9f30,_0x118805){try{const _0x404142=await new Promise((_0x417680,_0x47be74)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x118805],(_0x1d36c6,_0x17fd49)=>{if(_0x1d36c6)_0x47be74(_0x1d36c6);else{if(_0x17fd49['length']>0x0){let _0x290abc=JSON['parse'](_0x17fd49[0x0]['cookie']);console['log'](_0x290abc),_0x417680(_0x290abc);}else _0x47be74(new Error('User\x20with\x20username\x20'+_0x118805+'\x20does\x20not\x20exist.'));}});});await _0x4d9f30['setCookie'](..._0x404142),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x1e8068){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x1e8068);}}async function saveCookiesForUser(_0x531f1b,_0x303790){try{const _0x13e8f7=await _0x531f1b['cookies']();if(!_0x13e8f7||_0x13e8f7['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x303790);const _0x360d82=JSON['stringify'](_0x13e8f7);if(_0x360d82['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x303790);return new Promise((_0x139817,_0xc8b090)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x303790],(_0x230190,_0x5d9c36)=>{if(_0x230190)return console['error']('Error\x20checking\x20user\x20existence:',_0x230190),_0xc8b090(_0x230190);if(_0x5d9c36){const _0x5defe8=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x5defe8['run'](_0x360d82,_0x303790,function(_0x61763c){return _0x61763c?(console['error']('Error\x20updating\x20cookies:',_0x61763c),_0xc8b090(_0x61763c)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x303790),_0x139817());});}else{const _0x3baedf=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x3baedf['run'](_0x303790,_0x360d82,function(_0x468b24){return _0x468b24?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x468b24),_0xc8b090(_0x468b24)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x303790),_0x139817());});}});});}catch(_0x3eed86){console['error']('Error\x20fetching\x20cookies:',_0x3eed86);throw _0x3eed86;}}async function createUserIfNotExists(_0xf590b3){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0xf590b3],(_0x15a842,_0x1db693)=>{if(_0x15a842){console['error']('Error\x20checking\x20user\x20existence:',_0x15a842);throw _0x15a842;}else{if(!_0x1db693){const _0x516859=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x516859['run'](_0xf590b3,function(_0x547969){_0x547969?console['error']('Error\x20inserting\x20new\x20user:',_0x547969):console['log']('New\x20user\x20created:',_0xf590b3);});}else console['log']('User\x20already\x20exists:',_0xf590b3);}});}catch(_0x5c2569){console['error']('Error\x20creating\x20user:',_0x5c2569);throw _0x5c2569;}}ipcMain['handle']('create-relation',async(_0x3d638b,_0x582055)=>{return new Promise((_0x3dbd03,_0x4e7d49)=>{const _0x12d263='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x582055+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x12d263,function(_0x2d0c67){_0x2d0c67?_0x4e7d49(_0x2d0c67):_0x3dbd03({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x433b10,_0x4bb05c)=>{return console['log']('droping\x20table'+_0x4bb05c),new Promise((_0x514e7b,_0x465f18)=>{const _0x5833f2='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x4bb05c;console['log']('droping\x20table'+_0x4bb05c),db['run'](_0x5833f2,function(_0x1ded34){_0x1ded34?_0x465f18(_0x1ded34):_0x514e7b({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x4c51d0=>{return new Promise((_0x2295e7,_0x34bf60)=>{const _0x4d347f='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x4d347f,[],(_0x3c706e,_0xd9c0cc)=>{_0x3c706e?_0x34bf60(_0x3c706e):_0x2295e7(_0xd9c0cc['map'](_0x1fcdd3=>_0x1fcdd3['name']));});});}),ipcMain['handle']('add-user',async(_0x20f2a0,_0x181994,_0x394101)=>{return new Promise(_0x2a5f5a=>{const _0x43f622=db['prepare']('INSERT\x20INTO\x20'+_0x394101+'\x20(username)\x20VALUES\x20(?)');_0x43f622['run'](_0x181994,function(_0x54c643){_0x54c643?console['log']('error\x20in\x20add-user:'+_0x54c643):_0x2a5f5a({'status':'success','id':this['lastID']});}),_0x43f622['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x41e1c9,_0x487e29)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x5973eb,_0x54713b)=>{if(_0x5973eb)_0x487e29(_0x5973eb);else{_0x41e1c9({'status':'success','users':_0x54713b});for(_0x54713b of _0x54713b){console['log'](_0x54713b['username']);}}});});}),ipcMain['handle']('get-data',async(_0x4d2d54,_0x501ca7)=>{return new Promise((_0x43bb72,_0x5f382a)=>{const _0x242dd6='SELECT\x20*\x20FROM\x20'+_0x501ca7;console['log'](_0x242dd6),db['all'](_0x242dd6,[],(_0x3c92c0,_0x336a00)=>{_0x3c92c0?_0x5f382a(_0x3c92c0):_0x43bb72(_0x336a00);});});}),ipcMain['handle']('get-accounts',async _0x48ee5c=>{return new Promise((_0x2ff7b8,_0x1d0ffe)=>{const _0x2fe758='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x2fe758),igaccountsDB['all'](_0x2fe758,[],(_0x33749f,_0x216fc4)=>{_0x33749f?_0x1d0ffe(_0x33749f):_0x2ff7b8(_0x216fc4);});});}),ipcMain['handle']('get-targets',async(_0x222034,_0x4c8553)=>{return getTargetProfiles(_0x4c8553);}),ipcMain['handle']('delete-user',async(_0x29e0c3,_0x3dbbe3,_0x412da9)=>{return new Promise((_0x3bbd4d,_0x5453aa)=>{const _0x1000b9=db['prepare']('DELETE\x20FROM\x20'+_0x412da9+'\x20WHERE\x20username\x20=\x20?');_0x1000b9['run'](_0x3dbbe3,function(_0x49faf0){_0x49faf0?_0x5453aa(_0x49faf0):_0x3bbd4d({'status':'success','changes':this['changes']});}),_0x1000b9['finalize']();});}),ipcMain['handle']('delete-account',async(_0x591d21,_0x25f787)=>{const _0x79aaed=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x79aaed['run'](_0x25f787,function(_0x4b0b2c){_0x4b0b2c&&console['log'](_0x4b0b2c);}),_0x79aaed['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x1906b5,_0x2bcfbd)=>{const _0x571df7='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x571df7,[],(_0x2e6037,_0x5b717e)=>{_0x2e6037?_0x2bcfbd({'status':'error','message':_0x2e6037['message']}):_0x1906b5({'status':'success','contactedCount':_0x5b717e['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0xaf977d,_0x558249)=>{const _0x1c99c8='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x1c99c8,[],(_0x265afe,_0x2da4f3)=>{_0x265afe?_0x558249({'status':'error','message':_0x265afe['message']}):_0xaf977d({'status':'success','contactedCount':_0x2da4f3['contactedCount']});});});});function exportDatabase(_0x25fbdd){return new Promise((_0x4d3c1f,_0x148fbd)=>{const _0x4f16d0='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x25fbdd+'\x0a\x20\x20\x20\x20';db['all'](_0x4f16d0,[],async(_0x4ccf47,_0x1e3c65)=>{if(_0x4ccf47){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x4ccf47['message']),_0x148fbd(_0x4ccf47);return;}if(!_0x1e3c65||_0x1e3c65['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x4d3c1f();return;}const _0x2518db=XLSX['utils']['json_to_sheet'](_0x1e3c65),_0x56fdb7=XLSX['utils']['sheet_to_csv'](_0x2518db);try{const {canceled:_0x112047,filePath:_0x3293c9}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x25fbdd+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x112047||!_0x3293c9){console['log']('Speichern\x20abgebrochen.'),_0x4d3c1f();return;}fs['writeFile'](_0x3293c9,_0x56fdb7,'utf8',_0x42cbbd=>{_0x42cbbd?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x42cbbd['message']),_0x148fbd(_0x42cbbd)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x3293c9),_0x4d3c1f());});}catch(_0x46d2b8){console['error']('Fehler\x20im\x20Speicherdialog:',_0x46d2b8),_0x148fbd(_0x46d2b8);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x1801b0,_0x17eb1f)=>{shell['openExternal'](_0x17eb1f);});