const {app,BrowserWindow,ipcMain,dialog}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div',K_OPTIONS_BUTTON='section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.xs5motx\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD='div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f',K_SEND_MSG_BUTTON='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x4c5f13=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x4c5f13['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x4c5f13['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x1f16c3){var _0x46d489=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x3a95aa){console['log']('window\x20id:'+_0x3a95aa['id']),_0x3a95aa['id']>0x1&&(_0x46d489=!![]);}),console['log']('child\x20opened\x20='+_0x46d489);if(!_0x46d489){const _0x468165=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x468165['loadFile'](_0x1f16c3['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0);});const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x560296='',_0x123d49=null;if(process['platform']==='darwin')_0x560296=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x560296=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x560296}),_0x123d49=await browser_login['newPage'](),_0x123d49['setDefaultNavigationTimeout'](0x1d4c),_0x123d49['setDefaultTimeout'](0x1d4c),_0x123d49;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x57663f=0x1,_0x1adda5=0x0){let _0x19023c='',_0x3bbafa=null;const _0x1517f1=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x19023c=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x19023c=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x57663f===0x0&&!pageStack[_0x1adda5])return browser=await puppeteer['launch']({'headless':_0x1517f1,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x19023c}),_0x3bbafa=await browser['newPage'](),_0x3bbafa['setDefaultNavigationTimeout'](0x1d4c),_0x3bbafa['setDefaultTimeout'](0x1d4c),pageStack[_0x1adda5]=_0x3bbafa,_0x3bbafa;return(browser===null||pageStack[_0x1adda5]===null||pageStack[_0x1adda5]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x1517f1,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x19023c})),(pageStack[_0x1adda5]===null||pageStack[_0x1adda5]['isClosed']())&&(_0x3bbafa=await browser['newPage'](),_0x3bbafa['setDefaultNavigationTimeout'](0x1d4c),_0x3bbafa['setDefaultTimeout'](0x1d4c),pageStack[_0x1adda5]=_0x3bbafa),pageStack[_0x1adda5];}ipcMain['on']('login',async(_0x4577b5,_0x5ec814)=>{const _0x5bb9f1=await getBrowserPageLogin();await _0x5bb9f1['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x5bb9f1,_0x5ec814),ipcMain['on']('setLoginCookies',async(_0x55e85b,_0x328267)=>{try{await set_login_cookies(_0x5bb9f1,_0x328267);}catch(_0x41e9ef){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x41e9ef);}});}),ipcMain['on']('export-relation',async(_0xd2795e,_0x5989ea)=>{try{await exportDatabase(_0x5989ea),_0xd2795e['reply']('export-relation-response',{'success':!![]});}catch(_0x4e29c5){console['error'](_0x4e29c5),_0xd2795e['reply']('export-relation-response',{'success':![],'message':_0x4e29c5['message']});}}),ipcMain['handle']('sendMessage',async(_0x1c52ba,_0x3744ce,_0x2517fe,_0x29d8a3,_0x2439f5,_0x12a7b6,_0x539d21,_0x18609c)=>{isStopping=![];let _0x37f791=null;return _0x539d21?_0x37f791=await getBrowserPage(_0x2439f5,_0x18609c):_0x37f791=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x3744ce),send_message(_0x37f791,_0x3744ce,_0x2517fe,_0x29d8a3,_0x2439f5,_0x12a7b6);}),ipcMain['handle']('stop-action',async(_0x56d8f6,_0x281e5f)=>{isStopping=!![];const _0x597c5d=await getBrowserPage(0x1,_0x281e5f);await _0x597c5d['close']();}),ipcMain['handle']('fetch_followers',async(_0x478555,_0x4bb940,_0x56556a,_0xc2e552,_0x3f9d16,_0x31ec26)=>{isStopping=![];const _0x53ec02=await getBrowserPage();return fetch_followers_from_account(_0x478555,_0x53ec02,_0x4bb940,_0x56556a,_0xc2e552,_0x3f9d16,_0x31ec26);}),ipcMain['handle']('get-account-details',async(_0x22571f,_0x2f37ff,_0x4c70c5,_0x5a3324)=>{isStopping=![];const _0x1862e2=await getBrowserPage();return fetch_account_details(_0x1862e2,_0x2f37ff,_0x4c70c5,_0x5a3324);}),ipcMain['handle']('fetch_likes',async(_0x25ebda,_0x4a6590,_0x353ce6,_0x5c40ee,_0x4c01ed,_0x328669)=>{isStopping=![];const _0x340d99=await getBrowserPage();return fetch_likers_from_post(_0x25ebda,_0x340d99,_0x4a6590,_0x353ce6,_0x5c40ee,_0x4c01ed,_0x328669);}),ipcMain['handle']('fetch_comments',async(_0x35553b,_0x922e57,_0x58a3d7,_0x3f8838,_0x1b7515,_0x221291)=>{isStopping=![];const _0x3fb933=await getBrowserPage();return fetch_comments_from_post(_0x35553b,_0x3fb933,_0x922e57,_0x58a3d7,_0x3f8838,_0x1b7515,_0x221291);}),ipcMain['handle']('update-app',async _0x803052=>{const {spawn:_0x22f3b6}=require('child_process'),_0x3a0ca8=require('path');return new Promise((_0xd0b81b,_0x4696f1)=>{(process['env']['NODE_ENV']==='development'||process['env']['SKIP_UPDATES']==='true')&&(console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0xd0b81b('Update\x20übersprungen'));if(process['platform']==='darwin'){const _0x526bb0=_0x3a0ca8['join'](__dirname,'mac-updater-intern.sh'),_0x37ceeb=_0x22f3b6('/bin/bash',[_0x526bb0]);_0x37ceeb['stdout']['on']('data',_0x128285=>{console['log']('stdout:\x20'+_0x128285);}),_0x37ceeb['stderr']['on']('data',_0x1a133f=>{console['error']('stderr:\x20'+_0x1a133f);}),_0x37ceeb['on']('close',_0x174f77=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x174f77),_0x174f77===0x0?_0xd0b81b('Update\x20erfolgreich\x20abgeschlossen.'):_0x4696f1(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x174f77));});}else{if(process['platform']==='win32'){const _0x556f98=_0x3a0ca8['join'](__dirname,'../','../','../');process['chdir'](_0x556f98),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x42a531='soft-ui-updater-windows.ps1',_0x394788=_0x22f3b6('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x42a531]);_0x394788['stdout']['on']('data',_0x250cab=>{console['log']('stdout:\x20'+_0x250cab);}),_0x394788['stderr']['on']('data',_0xc3e955=>{console['error']('stderr:\x20'+_0xc3e955);}),_0x394788['on']('close',_0x5250ca=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x5250ca),_0x5250ca===0x0?_0xd0b81b('Update\x20erfolgreich\x20abgeschlossen.'):_0x4696f1(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x5250ca));});}else _0x4696f1(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}});});function getRnd(_0x5cef21,_0x888044){return Math['random']()*(_0x888044-_0x5cef21+0x1)+_0x5cef21;}function delay(_0x3550c3,_0x54e164){let _0x5d4c39=getRnd(_0x3550c3,_0x54e164);return new Promise(function(_0x3451f7){setTimeout(_0x3451f7,_0x5d4c39);});}async function scroll(_0x520355,_0x51e6e8,_0x14056a=0x2,_0x536062){const _0x4a2dee=await _0x520355['waitForSelector'](_0x51e6e8);for(let _0x4ce367=0x0;_0x4ce367<_0x14056a;_0x4ce367++){console['log']('Scrolling\x20'+_0x4ce367),await _0x520355['evaluate'](_0x3299d4=>{const _0x440204=document['querySelector'](_0x3299d4);_0x440204&&_0x440204['scrollBy'](0x0,0x190);},_0x51e6e8),await delay(0x320,0x5dc),_0x536062();}}async function saveCookies(_0x34cb7f){let _0x1a4a0e=await _0x34cb7f['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x1a4a0e,null,0x2));}async function notificationClear(_0x3cbade){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x3cbade['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x3cbade['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x424f83){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x424f83);}}async function getTargetProfiles(_0x4c2e58){return new Promise((_0x4d9dd4,_0x441cb5)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x4c2e58,(_0x155f42,_0x101038)=>{_0x155f42?_0x441cb5(_0x155f42):_0x4d9dd4(_0x101038);});});}async function login_legacy(_0x536795,_0x140f7a,_0x17d6e1){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x536795,_0x140f7a),await createUserIfNotExists(_0x140f7a,_0x17d6e1);}catch(_0x3779ca){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x3779ca);}try{await _0x536795['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x536795['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x536795['click']('button._a9--._ap36._a9_0');}catch(_0x3a76f9){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x536795['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x536795['type']('input[name=\x27username\x27]',_0x140f7a,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x536795['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x536795['type']('input[name=\x27password\x27]',_0x17d6e1,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x536795['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x536795['click']('button[type=\x27submit\x27]');}catch(_0x1979e5){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x536795),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x536795,_0x140f7a);}catch(_0x2644b2){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x2644b2);}}catch(_0x4e4deb){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x4e4deb);}}async function login(_0x164f31,_0x4c9562){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x164f31,_0x4c9562),await createUserIfNotExists(_0x4c9562);}catch(_0x4ec30e){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4ec30e);}try{await _0x164f31['goto']('https://www.instagram.com/accounts/login/');}catch(_0x535bcf){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x535bcf);}}async function set_login_cookies(_0x23e7af,_0x53e3eb){try{await saveCookiesForUser(_0x23e7af,_0x53e3eb);}catch(_0x5d856d){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x5d856d);}}async function waitForXPath(_0x26ce40,_0x5d1468,_0xb1b576={}){return await _0x26ce40['waitForFunction'](_0x4b63cb=>{return document['evaluate'](_0x4b63cb,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0xb1b576,_0x5d1468),_0x26ce40['evaluateHandle'](_0xbd030c=>document['evaluate'](_0xbd030c,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x5d1468);}async function send_message(_0x57ef75,_0x301488,_0x18fc9d,_0x26cf6f,_0x336d0d,_0x5d863b){return new Promise(async(_0x246a3d,_0x12f046)=>{_0x5d863b=_0x5d863b['split'](';'),console['log'](_0x5d863b[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x336d0d);try{await setCookiesForUser(_0x57ef75,_0x5d863b[0x0]);}catch(_0x50e235){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x50e235),_0x12f046({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x50e235});return;}try{await _0x57ef75['goto']('https://www.instagram.com/'+_0x301488+'/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x57ef75);}catch(_0xa8aa9c){_0x12f046({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0xa8aa9c});return;}try{await _0x57ef75['waitForSelector'](K_DIRECT_MSG_BUTTON),await _0x57ef75['click'](K_DIRECT_MSG_BUTTON);}catch(_0x55b62d){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x55b62d);try{await _0x57ef75['waitForSelector'](K_OPTIONS_BUTTON),await _0x57ef75['click'](K_OPTIONS_BUTTON),await delay(0x1f4,0x320);const _0x21ffe6=await waitForXPath(_0x57ef75,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x21ffe6['click']();}catch(_0x3ac8a0){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x3ac8a0),_0x246a3d({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x57ef75);}catch(_0x7dfd27){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x7dfd27);}try{const _0x4688fe=await _0x57ef75['waitForSelector'](K_CHAT_INPUT_FIELD),_0xf6ebc=await _0x57ef75['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0xf6ebc),_0x26cf6f=_0x26cf6f['replace']('{USERNAME}',_0x301488);let _0x2f1cc3=_0xf6ebc['split']('\x20')[0x0];_0x26cf6f=_0x26cf6f['replace']('{NAME}',_0x2f1cc3),_0x26cf6f=_0x26cf6f['replace']('{name}',_0x2f1cc3),await _0x4688fe['type'](_0x26cf6f,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0x12359b=await _0x57ef75['waitForSelector'](K_SEND_MSG_BUTTON);await _0x12359b['click'](),await delay(0x320,0x3e8),_0x246a3d({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!'});}catch(_0x545ee8){console['error']('Nachricht\x20nicht\x20gesendet:\x20'+_0x545ee8),_0x12f046('Nachricht\x20nicht\x20gesendet:\x20'+_0x545ee8);}});}function handle_fail(_0x4b5b6e){if(isStopping)return new Promise(_0x1b4e9f=>{_0x1b4e9f('Scraper\x20gestoppt.');});else{let _0x2ee50e='';switch(_0x4b5b6e){case 0x0:_0x2ee50e='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x2ee50e='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x2ee50e='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x2ee50e='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x4369af,_0x3051bb)=>{_0x3051bb(_0x2ee50e);});}}async function fetch_account_details(_0xa1be3c,_0x1d0618,_0x2ec13e,_0x34f76d){try{await setCookiesForUser(_0xa1be3c,_0x2ec13e['username']);}catch(_0x4b8fac){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x4b8fac);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x4b8fac);return handle_fail(0x0);}_0xa1be3c['setDefaultNavigationTimeout'](0x7530),await _0xa1be3c['goto']('https://www.instagram.com/'+_0x1d0618+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0xa1be3c);const _0x2dc8fa=await _0xa1be3c['evaluate'](()=>{const _0x257fec=document['querySelector']('meta[property=\x22og:image\x22]');return _0x257fec?_0x257fec['getAttribute']('content'):null;});await _0xa1be3c['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x5d6cd4=await _0xa1be3c['evaluate'](()=>{const _0x5775bc=document['querySelector']('meta[name=\x22description\x22]');if(!_0x5775bc)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x368fa0=_0x5775bc['getAttribute']('content');if(!_0x368fa0)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x368fa0);const _0x2f258f=/\s*[–-]\s*/,_0x298ef4=_0x368fa0['split'](_0x2f258f);if(_0x298ef4['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x5935ee=_0x298ef4[0x0],_0x44b172=_0x298ef4[0x1],_0x2b9b5a=_0x5935ee['split'](',\x20');if(_0x2b9b5a['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x32d9c6=_0x2b9b5a[0x0]['split']('\x20')[0x0],_0x29c1bd=_0x2b9b5a[0x1]['split']('\x20')[0x0],_0x4d9d62=_0x2b9b5a[0x2]['split']('\x20')[0x0];let _0x43c66a='',_0x31d7b4='';const _0x82adc6='\x20on\x20Instagram:\x20',_0x4883b9=_0x44b172['split'](_0x82adc6);return _0x43c66a=_0x4883b9[0x0]['trim'](),_0x43c66a=_0x43c66a['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x4883b9['length']>0x1&&(_0x31d7b4=_0x4883b9[0x1]['trim'](),_0x31d7b4['startsWith']('\x22')&&_0x31d7b4['endsWith']('\x22')&&(_0x31d7b4=_0x31d7b4['substring'](0x1,_0x31d7b4['length']-0x1)['trim']()),_0x31d7b4=_0x31d7b4['replace'](/&quot;/g,'')['trim']()),{'followers':_0x32d9c6,'following':_0x29c1bd,'posts':_0x4d9d62,'nameText':_0x43c66a,'bio':_0x31d7b4};});console['log']('Extracted\x20profile\x20data:',_0x5d6cd4);const _0x21f133=_0x5d6cd4['nameText'],_0x48f55=_0x2dc8fa,_0x2e6cf6=_0x5d6cd4['bio'],_0x50dbae=_0x5d6cd4['followers'],_0x2b6f54=_0x5d6cd4['following'],_0x52ae0f=_0x5d6cd4['posts'],_0x3b83b3=![],_0x462668=![],_0x1269c8=![],_0x297c27='\x0a\x20\x20INSERT\x20INTO\x20'+_0x34f76d+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x297c27,[_0x1d0618,_0x21f133,_0x48f55,_0x2e6cf6,_0x50dbae,_0x2b6f54,_0x52ae0f,_0x3b83b3,_0x462668,_0x1269c8],function(_0x4903ad){_0x4903ad?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x4903ad['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x2709a7,_0x3df2d0,_0x522ab4,_0x3395b,_0xca12aa,_0x247ea9,_0x57adf6){let _0x1967df=0x4,_0x36987e=0x0,_0x2caa5f=0x0;try{await setCookiesForUser(_0x3df2d0,_0x247ea9['username']);}catch(_0xfba676){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0xfba676);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0xfba676);return handle_fail(0x0);}let _0x324e11=0x0;try{await _0x3df2d0['goto']('https://www.instagram.com/'+_0x522ab4+'/'),await notificationClear(_0x3df2d0);try{if(_0x3395b<=0x0){const _0x11bcfa=await _0x3df2d0['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x56c1a6=await _0x3df2d0['evaluate'](_0x494f41=>_0x494f41['innerHTML'],_0x11bcfa);_0x324e11=Math['ceil'](_0x56c1a6/0x4);}else _0x324e11=Math['ceil'](_0x3395b/0x4);_0x1967df+=_0x324e11,_0x2caa5f=Math['round'](++_0x36987e/_0x1967df*0x64),_0x2709a7['sender']['send']('fetch-progress',_0x2caa5f,!![]);let _0x3f0044=await _0x3df2d0['waitForSelector']('a[href=\x22/'+_0x522ab4+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x3f0044['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x522ab4+'\x20gesichtet'),_0x2caa5f=Math['round'](++_0x36987e/_0x1967df*0x64),_0x2709a7['sender']['send']('fetch-progress',_0x2caa5f,!![]);}catch(_0x314af9){console['log']('Follower\x20Liste\x20von\x20'+_0x522ab4+'\x20nicht\x20gefunden:'+_0x314af9);throw new Error('Follower\x20Liste\x20von\x20'+_0x522ab4+'\x20nicht\x20gefunden:'+_0x314af9);return handle_fail(0x0);}}catch(_0x4f4a76){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x4f4a76);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x4f4a76);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x324e11),await scroll(_0x3df2d0,FOLLOWER_FENSTER,_0x324e11,_0x58fde1=>{_0x2caa5f=Math['round'](++_0x36987e/_0x1967df*0x64),_0x2709a7['sender']['send']('fetch-progress',_0x2caa5f,!![]);}),await _0x3df2d0['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x512415=await _0x3df2d0['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x168bac=await _0x3df2d0['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x2caa5f=Math['round'](++_0x36987e/_0x1967df*0x64),_0x2709a7['sender']['send']('fetch-progress',_0x2caa5f,!![]),_0x3395b<=0x0&&(_0x3395b=_0x512415['length']);let _0x3d2996=[];for(let _0x3d8806=0x0;_0x3d8806<_0x512415['length']&&_0x3d8806<_0x3395b;_0x3d8806++){_0x3d2996['push'](await _0x512415[_0x3d8806]['evaluate'](_0x131b3=>_0x131b3['textContent']));const _0x5ab535='INSERT\x20INTO\x20'+_0xca12aa+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x5ab535,[await _0x512415[_0x3d8806]['evaluate'](_0x340255=>_0x340255['textContent']),await _0x168bac[_0x3d8806]['evaluate'](_0x4d9975=>_0x4d9975['textContent'])],function(_0x3c3b4b){_0x3c3b4b?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0xca12aa+'\x27:',_0x3c3b4b['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x2caa5f=Math['round'](++_0x36987e/_0x1967df*0x64),_0x2709a7['sender']['send']('fetch-progress',_0x2caa5f,!![]),_0x57adf6&&(_0x2709a7['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x2709a7,_0x3df2d0,_0x247ea9,_0xca12aa,_0x3d2996)),new Promise(_0x56fb0b=>{_0x56fb0b('Scraping\x20finished!');});}catch(_0x2e3a6f){if(_0x57adf6)throw new Error(_0x2e3a6f);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x522ab4+'\x20nicht\x20gefunden:\x20'+_0x2e3a6f);return handle_fail(0x0);}}async function fetch_details_from_list(_0x41be96,_0x536f41,_0x35f76b,_0x38a4b4,_0x242725){let _0x31aaa3=0x0,_0x3f9aa1=0x0;for(let _0x407114=0x0;_0x407114<_0x242725['length'];_0x407114++){console['log']('Processing\x20profile:',_0x242725[_0x407114]);try{await fetch_account_details(_0x536f41,_0x242725[_0x407114],_0x35f76b,_0x38a4b4);}catch(_0x372705){console['error']('Detailed\x20Scraping\x20von:\x20',_0x242725[_0x407114],_0x372705);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x242725[_0x407114]+'\x20'+_0x372705);}_0x3f9aa1=Math['round'](++_0x31aaa3/_0x242725['length']*0x64),_0x41be96['sender']['send']('fetch-progress',_0x3f9aa1,!![],!![]);}}async function fetch_likers_from_post(_0x116265,_0x3304a4,_0x35e3da,_0x40af7b,_0x361ca6,_0x1ba490,_0x3ccc37){let _0x160fbc=0x4,_0x1b30a8=0x0,_0x711bb3=0x0;try{await setCookiesForUser(_0x3304a4,_0x1ba490['username']);}catch(_0x22f884){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x22f884);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x22f884);return handle_fail(0x1);return;}_0x711bb3=Math['round'](++_0x1b30a8/_0x160fbc*0x64),_0x116265['sender']['send']('fetch-progress',_0x711bb3,!![]);try{let _0x349b4f=_0x35e3da['substring'](0x0,_0x35e3da['lastIndexOf']('/')),_0x3ebd52=_0x349b4f+'/liked_by';console['log'](_0x3ebd52),await _0x3304a4['goto'](_0x3ebd52),await delay(0x7d0,0xfa0),await notificationClear(_0x3304a4),await delay(0xc8,0x1f4),_0x711bb3=Math['round'](++_0x1b30a8/_0x160fbc*0x64),_0x116265['sender']['send']('fetch-progress',_0x711bb3,!![]),await _0x3304a4['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x958d27=await _0x3304a4['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x4f44e3=await _0x3304a4['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x958d27['length']);let _0x5660f9=path['join'](__dirname,'/likers.csv');_0x711bb3=Math['round'](++_0x1b30a8/_0x160fbc*0x64),_0x116265['sender']['send']('fetch-progress',_0x711bb3,!![]),_0x40af7b<=0x0&&(_0x40af7b=_0x958d27['length']);try{let _0x2d9c08=[];for(let _0x14823c=0x0;_0x14823c<_0x958d27['length']&&_0x14823c<_0x40af7b;_0x14823c++){_0x2d9c08['push'](await _0x958d27[_0x14823c]['evaluate'](_0x465df7=>_0x465df7['textContent']));try{const _0x1ed5ed='INSERT\x20INTO\x20'+_0x361ca6+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x1ed5ed,[await _0x958d27[_0x14823c]['evaluate'](_0x45a27f=>_0x45a27f['textContent']),await _0x4f44e3[_0x14823c]['evaluate'](_0x5b6a68=>_0x5b6a68['textContent'])],function(_0xf108a9){_0xf108a9?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x361ca6+'\x27:',_0xf108a9['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0xdbd977){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x14823c+'\x20:\x20'+_0xdbd977);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x14823c+'\x20:\x20'+_0xdbd977);return handle_fail(0x1);}}return _0x711bb3=Math['round'](++_0x1b30a8/_0x160fbc*0x64),_0x116265['sender']['send']('fetch-progress',_0x711bb3,!![]),_0x3ccc37&&(_0x116265['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x116265,_0x3304a4,_0x1ba490,_0x361ca6,_0x2d9c08)),new Promise(_0x490a13=>{_0x490a13('Scraping\x20finished!');});}catch(_0x2b62ce){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x2b62ce);return handle_fail(0x1);}}catch(_0xd5f208){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0xd5f208);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0xd5f208);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x1c4e45,_0x5a49be,_0x192983,_0x243bf2,_0x259491,_0x5c8002,_0x16b75b){let _0x3a4aa2=0x3,_0x3a542b=0x0,_0x545d52=0x0;try{await setCookiesForUser(_0x5a49be,_0x5c8002['username']);}catch(_0x588c7c){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x588c7c);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x588c7c);return handle_fail(0x2);}try{console['log'](_0x192983),await _0x5a49be['goto'](_0x192983),await delay(0x7d0,0xfa0),await notificationClear(_0x5a49be),await delay(0xc8,0x1f4);const _0x1b9588=COM_COMMENTS_BOX_BODY_DIV;let _0x42732c;const _0x35f4c4=await _0x5a49be['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x1fbca1=await _0x5a49be['evaluate'](_0xdd698b=>_0xdd698b['innerHTML'],_0x35f4c4),_0x486322=String(_0x1fbca1)['replace'](/[^0-9]/g,''),_0x2c5f5b=Number(_0x486322)/0x14;_0x243bf2<=0x0?_0x42732c=Math['ceil'](_0x2c5f5b/0x3):_0x42732c=Math['ceil'](_0x243bf2/0x3),(_0x3a4aa2+=_0x42732c,_0x545d52=Math['round'](++_0x3a542b/_0x3a4aa2*0x64),_0x1c4e45['sender']['send']('fetch-progress',_0x545d52,!![]),console['log']('Auto-scrolls:\x20'+_0x42732c),await scroll(_0x5a49be,_0x1b9588,_0x42732c,_0x451c53=>{_0x545d52=Math['round'](++_0x3a542b/_0x3a4aa2*0x64),_0x1c4e45['sender']['send']('fetch-progress',_0x545d52,!![]);}));try{const _0x25f9bd=COM_REPLY_BUTTON_SPAN;await _0x5a49be['waitForSelector'](_0x25f9bd),await delay(0x1f4,0x320);const _0x1d49a2=await _0x5a49be['$$'](_0x25f9bd);console['log'](_0x1d49a2);let _0x16d16d=_0x1d49a2['length'];await delay(0xc8,0x1f4);try{for(let _0x929826=0x0;_0x929826<_0x16d16d;_0x929826++){_0x1d49a2[_0x929826]['click'](),await delay(0x320,0x5dc);}}catch(_0x39bc96){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x39bc96);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x39bc96);return handle_fail(0x2);}}catch(_0x4d8cb9){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x2b6619=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x5a49be['waitForSelector'](_0x2b6619),await delay(0x1f4,0x320),_0x545d52=Math['round'](++_0x3a542b/_0x3a4aa2*0x64),_0x1c4e45['sender']['send']('fetch-progress',_0x545d52,!![]);const _0x3bc717=await _0x5a49be['$$'](_0x2b6619);let _0x2c6c31=path['join'](__dirname,'/comments.csv');_0x243bf2<=0x0&&(_0x243bf2=_0x3bc717['length']),(console['log']('fetch_limit:\x20'+_0x243bf2),console['log']('comments_len:\x20'+_0x3bc717['length']),_0x243bf2++);try{let _0x4e6278=[];for(let _0x44bec9=0x1;_0x44bec9<_0x3bc717['length']&&_0x44bec9<_0x243bf2;_0x44bec9++){try{_0x4e6278['push'](await _0x3bc717[_0x44bec9]['evaluate'](_0x8171af=>_0x8171af['textContent']));const _0x559b43=await db['prepare']('INSERT\x20INTO\x20'+_0x259491+'\x20(username)\x20VALUES\x20(?)');await _0x559b43['run'](await _0x3bc717[_0x44bec9]['evaluate'](_0xf1142d=>_0xf1142d['textContent']),function(_0x523ce6){_0x523ce6&&console['log']('error\x20in\x20add-user:'+_0x523ce6);}),await _0x559b43['finalize']();}catch(_0x4aaf5a){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x44bec9+'\x20:\x20'+_0x4aaf5a);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x44bec9+'\x20:\x20'+_0x4aaf5a);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x545d52=Math['round'](++_0x3a542b/_0x3a4aa2*0x64),_0x1c4e45['sender']['send']('fetch-progress',_0x545d52,!![]),_0x1c4e45['sender']['send']('fetch-progress',0x64,!![]),_0x16b75b&&(_0x1c4e45['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x1c4e45,_0x5a49be,_0x5c8002,_0x259491,_0x4e6278)),_0x1c4e45['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x3c1280=>{_0x3c1280('Scraping\x20finished!');});}catch(_0x5310d4){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x5310d4);return handle_fail(0x2);}}catch(_0x204e7d){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x204e7d);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x204e7d);return handle_fail(0x2);}}async function set_clearname_from_username(_0x159d76,_0x1b66cc,_0x528f6e=null){try{let _0x39bde6,_0x619cb4;const _0x13a24e='SELECT\x20username\x20FROM\x20'+_0x1b66cc+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x13a24e,[],(_0x3a2d8d,_0xa99cde)=>{_0x3a2d8d&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x3a2d8d['message']),_0xa99cde['length']===0x0&&(_0x619cb4=_0xa99cde['length']),_0x39bde6=_0xa99cde['map'](_0x2e55d0=>_0x2e55d0['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x619cb4);if(_0x619cb4===0x0){console['log']('Leave');return;}const _0x847c8c=await _0x159d76['waitForSelector'](IG_SEARCH_BUTTON);await _0x847c8c['click'](),await delay(0x4b0,0x7d0);for(let _0x424696 of _0x39bde6){const _0x948ed0=await _0x159d76['waitForSelector'](IG_SEARCH_INPUT);await _0x948ed0['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x159d76['type'](IG_SEARCH_INPUT,_0x424696,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x1f3ef4=0x1;while(_0x1f3ef4!=0x14){console['log']('Schleife');try{let _0x554281=IG_NAME_SPAN_PART1+_0x1f3ef4+IG_USERNAME_SPAN_PART2;const _0x231fb9=await _0x159d76['waitForSelector'](_0x554281),_0x2ac87f=await _0x159d76['evaluate'](_0x33206d=>_0x33206d['innerHTML'],_0x231fb9);await delay(0xc8,0x1f4);if(_0x2ac87f==_0x424696){let _0x44d6fe=IG_NAME_SPAN_PART1+_0x1f3ef4+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x319021=await _0x159d76['waitForSelector'](_0x44d6fe);let _0x183a37=await _0x159d76['evaluate'](_0x3209bf=>_0x3209bf['innerHTML'],_0x319021);const _0x19ce1e=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x143e34=_0x183a37['match'](_0x19ce1e);_0x143e34?_0x183a37=_0x143e34[0x1]['trim']():_0x183a37=_0x183a37['trim'](),_0x183a37['includes']('•')&&(_0x183a37=_0x183a37['substring'](0x0,_0x183a37['indexOf']('•')-0x1));const _0x522f35='UPDATE\x20'+_0x1b66cc+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x522f35,[_0x183a37,_0x2ac87f],function(_0x25ee36){_0x25ee36&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x25ee36['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x1f3ef4++;}catch(_0x5664fd){const _0x56302f='UPDATE\x20'+_0x1b66cc+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x56302f,['',_0x424696],function(_0x2cc80a){_0x2cc80a&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x2cc80a['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x5664fd);break;}}_0x528f6e&&_0x528f6e();}await _0x847c8c['click']();}catch(_0x4b83fb){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x4b83fb);}}const campaignPath=path['resolve'](__dirname,'data/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(campaign_name\x20TEXT\x20PRIMARY\x20KEY,\x20list_id\x20TEXT,\x20zeitabstand\x20REAL,\x20message_id\x20TEXT,\x20account\x20TEXT,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0xa7eed1,_0x3c99a2)=>{const _0x334cd7='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x334cd7,[],(_0x5a0fb2,_0x48cf2e)=>{_0x5a0fb2?_0x3c99a2(_0x5a0fb2):_0xa7eed1(_0x48cf2e);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x4e0e0b,_0x38905e)=>{const _0x291f09='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x291f09,[],async(_0x2ddfba,_0xfa9992)=>{if(_0x2ddfba)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x2ddfba['message']),_0x38905e({'status':'error','message':_0x2ddfba['message']});else try{const _0x5a9956=await Promise['all'](_0xfa9992['map'](_0x5d6379=>{return new Promise(_0x78d780=>{if(!_0x5d6379['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x5d6379['campaign_name']),_0x78d780({'campaign_name':_0x5d6379['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x1614ea='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x5d6379['list_id'],_0x4a0705='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x5d6379['list_id']+'\x22';db['get'](_0x1614ea,[],(_0x326ba2,_0x1a16d3)=>{_0x326ba2?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x5d6379['campaign_name']+':',_0x326ba2['message']),_0x78d780({'campaign_name':_0x5d6379['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x4a0705,[],(_0x185123,_0x463a6e)=>{_0x185123?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x5d6379['campaign_name']+':',_0x185123['message']),_0x78d780({'campaign_name':_0x5d6379['campaign_name'],'lead_count':_0x1a16d3?_0x1a16d3['lead_count']:0x0,'contacted_count':'N/A'})):_0x78d780({'campaign_name':_0x5d6379['campaign_name'],'lead_count':_0x1a16d3?_0x1a16d3['lead_count']:0x0,'contacted_count':_0x463a6e?_0x463a6e['contacted_count']:0x0});});});});}));_0x4e0e0b({'status':'success','campaigns':_0x5a9956});}catch(_0x3bff52){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x3bff52),_0x38905e({'status':'error','message':_0x3bff52['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x13ed6e,_0x14cb12)=>{return new Promise((_0x3fdaf3,_0x142287)=>{const _0x539180='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x539180,[_0x14cb12],(_0x578dc4,_0x5e3d26)=>{_0x578dc4?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x578dc4),_0x142287(_0x578dc4)):(console['log']('ROWS'),console['log'](_0x5e3d26),debugDatabaseContents(),_0x3fdaf3(_0x5e3d26));});});});const showTableContents=_0x14dd9d=>{return new Promise((_0x4dd940,_0x232468)=>{const _0x12ced2='SELECT\x20*\x20FROM\x20'+_0x14dd9d+';';campaignDB['all'](_0x12ced2,(_0x157153,_0xf20428)=>{_0x157153?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x14dd9d+':',_0x157153),_0x232468(_0x157153)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x14dd9d+':',_0xf20428),_0x4dd940({'status':'success','message':_0xf20428}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x598170){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x598170);}}ipcMain['handle']('create-campaign',async(_0x1886b5,_0x573b22)=>{return new Promise((_0x2a48d1,_0x2ea080)=>{const _0xbf3b86='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0xbf3b86,[String(_0x573b22)],function(_0x15d3c6){_0x15d3c6?_0x2ea080(_0x15d3c6):_0x2a48d1({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x1d82d7,_0x1b25e6)=>{return new Promise((_0x5f19a4,_0x172e7b)=>{const _0x568808='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x568808,[_0x1b25e6],function(_0x311926){_0x311926?_0x172e7b(_0x311926):_0x5f19a4({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x6a6ed3,_0x23579d,_0x18e182,_0x320f1a,_0x5508dd,_0x201e6b)=>{const _0x34837c=await createMessageID(_0x5508dd);return new Promise((_0x189f46,_0x225975)=>{if(!_0x23579d||!_0x18e182||!_0x320f1a||!_0x34837c||!_0x201e6b)return _0x225975({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x34837c);const _0x546562='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x546562,[_0x18e182,_0x320f1a,_0x34837c,_0x201e6b,_0x23579d],function(_0xf9d58c){if(_0xf9d58c)_0x225975({'status':'error','message':_0xf9d58c['message']});else this['changes']===0x0?_0x225975({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x189f46({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x201443,_0x1fd4a2,_0xb397d9,_0x2821ef,_0x5b3cf9)=>{return new Promise((_0x54a83b,_0x16212f)=>{const _0x188797='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x188797,[_0x1fd4a2,_0xb397d9,_0x2821ef,_0x5b3cf9],function(_0x2549ec){return _0x2549ec?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x2549ec['message']),_0x16212f('insert-dm-response',{'success':![],'message':_0x2549ec['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x54a83b('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0xafde2f=>{return new Promise((_0x554431,_0x6907b6)=>{const _0x299350='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x299350,[_0xafde2f],(_0x3c9c64,_0x3e3580)=>{if(_0x3c9c64)_0x6907b6({'status':'error','message':_0x3c9c64['message']});else{if(_0x3e3580)_0x554431(_0x3e3580['message_id']);else{const _0x5bf648='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x5bf648,[_0xafde2f],function(_0x12c4c4){_0x12c4c4?_0x6907b6({'status':'error','message':_0x12c4c4['message']}):_0x554431(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x487a4a,_0x5211d2)=>{return new Promise((_0x4f3568,_0x4e31e9)=>{const _0x1f8c7f='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x5211d2;db['get'](_0x1f8c7f,(_0x5d2971,_0x123c76)=>{_0x5d2971?_0x4e31e9({'status':'error','message':_0x5d2971['message']}):_0x4f3568({'status':'success','count':_0x123c76['count']});});});});const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x311f95,_0x2cc8bc){try{const _0x5ec6a2=await new Promise((_0x20bbfc,_0x155726)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x2cc8bc],(_0x4e8774,_0xc6e5a8)=>{if(_0x4e8774)_0x155726(_0x4e8774);else{if(_0xc6e5a8['length']>0x0){let _0x4cb9dd=JSON['parse'](_0xc6e5a8[0x0]['cookie']);console['log'](_0x4cb9dd),_0x20bbfc(_0x4cb9dd);}else _0x155726(new Error('User\x20with\x20username\x20'+_0x2cc8bc+'\x20does\x20not\x20exist.'));}});});await _0x311f95['setCookie'](..._0x5ec6a2),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x5cc6d1){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x5cc6d1);}}async function saveCookiesForUser(_0x4be093,_0x49b7a8){try{const _0x10fb89=await _0x4be093['cookies']();if(!_0x10fb89||_0x10fb89['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x49b7a8);const _0x4cb731=JSON['stringify'](_0x10fb89);if(_0x4cb731['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x49b7a8);return new Promise((_0x1eccc5,_0x67daef)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x49b7a8],(_0x24cd44,_0x45f88a)=>{if(_0x24cd44)return console['error']('Error\x20checking\x20user\x20existence:',_0x24cd44),_0x67daef(_0x24cd44);if(_0x45f88a){const _0x496d75=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x496d75['run'](_0x4cb731,_0x49b7a8,function(_0x293b0b){return _0x293b0b?(console['error']('Error\x20updating\x20cookies:',_0x293b0b),_0x67daef(_0x293b0b)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x49b7a8),_0x1eccc5());});}else{const _0x2570e8=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x2570e8['run'](_0x49b7a8,_0x4cb731,function(_0x17316a){return _0x17316a?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x17316a),_0x67daef(_0x17316a)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x49b7a8),_0x1eccc5());});}});});}catch(_0x4b190a){console['error']('Error\x20fetching\x20cookies:',_0x4b190a);throw _0x4b190a;}}async function createUserIfNotExists(_0x4736eb){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x4736eb],(_0x4c64e8,_0x37cc6a)=>{if(_0x4c64e8){console['error']('Error\x20checking\x20user\x20existence:',_0x4c64e8);throw _0x4c64e8;}else{if(!_0x37cc6a){const _0x33980c=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x33980c['run'](_0x4736eb,function(_0x4fe169){_0x4fe169?console['error']('Error\x20inserting\x20new\x20user:',_0x4fe169):console['log']('New\x20user\x20created:',_0x4736eb);});}else console['log']('User\x20already\x20exists:',_0x4736eb);}});}catch(_0x416968){console['error']('Error\x20creating\x20user:',_0x416968);throw _0x416968;}}ipcMain['handle']('create-relation',async(_0x81ec13,_0x2fb19a)=>{return new Promise((_0x270694,_0x5f416f)=>{const _0x48deae='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x2fb19a+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x48deae,function(_0x39eb96){_0x39eb96?_0x5f416f(_0x39eb96):_0x270694({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x20f9d0,_0x4bfa3d)=>{return console['log']('droping\x20table'+_0x4bfa3d),new Promise((_0x3ba231,_0x4345af)=>{const _0x40cf64='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x4bfa3d;console['log']('droping\x20table'+_0x4bfa3d),db['run'](_0x40cf64,function(_0x55fa21){_0x55fa21?_0x4345af(_0x55fa21):_0x3ba231({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x5dae79=>{return new Promise((_0x46fd17,_0x431b54)=>{const _0x52ca44='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x52ca44,[],(_0x1748f2,_0x32a8b7)=>{_0x1748f2?_0x431b54(_0x1748f2):_0x46fd17(_0x32a8b7['map'](_0x5125ca=>_0x5125ca['name']));});});}),ipcMain['handle']('add-user',async(_0xb8c131,_0x52617c,_0x532761)=>{return new Promise(_0x17fefc=>{const _0x255dc9=db['prepare']('INSERT\x20INTO\x20'+_0x532761+'\x20(username)\x20VALUES\x20(?)');_0x255dc9['run'](_0x52617c,function(_0x85231b){_0x85231b?console['log']('error\x20in\x20add-user:'+_0x85231b):_0x17fefc({'status':'success','id':this['lastID']});}),_0x255dc9['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x321249,_0x517984)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x94cb69,_0x40283b)=>{if(_0x94cb69)_0x517984(_0x94cb69);else{_0x321249({'status':'success','users':_0x40283b});for(_0x40283b of _0x40283b){console['log'](_0x40283b['username']);}}});});}),ipcMain['handle']('get-data',async(_0x35fc47,_0x4ec051)=>{return new Promise((_0x35550b,_0x50e782)=>{const _0x22daac='SELECT\x20*\x20FROM\x20'+_0x4ec051;console['log'](_0x22daac),db['all'](_0x22daac,[],(_0x1203e8,_0x53a88b)=>{_0x1203e8?_0x50e782(_0x1203e8):_0x35550b(_0x53a88b);});});}),ipcMain['handle']('get-accounts',async _0x20ab27=>{return new Promise((_0x5a168d,_0xf9378c)=>{const _0x26ddd8='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x26ddd8),igaccountsDB['all'](_0x26ddd8,[],(_0x1fa1ac,_0x3cfc59)=>{_0x1fa1ac?_0xf9378c(_0x1fa1ac):_0x5a168d(_0x3cfc59);});});}),ipcMain['handle']('get-targets',async(_0x198e40,_0x25595a)=>{return getTargetProfiles(_0x25595a);}),ipcMain['handle']('delete-user',async(_0x10673e,_0x32fd0e,_0x3eab58)=>{return new Promise((_0x555a17,_0x577f40)=>{const _0x33dad1=db['prepare']('DELETE\x20FROM\x20'+_0x3eab58+'\x20WHERE\x20username\x20=\x20?');_0x33dad1['run'](_0x32fd0e,function(_0x264b38){_0x264b38?_0x577f40(_0x264b38):_0x555a17({'status':'success','changes':this['changes']});}),_0x33dad1['finalize']();});}),ipcMain['handle']('delete-account',async(_0x407ab4,_0x5b0692)=>{const _0x536d73=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x536d73['run'](_0x5b0692,function(_0xfbcf2f){_0xfbcf2f&&console['log'](_0xfbcf2f);}),_0x536d73['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x48e4f5,_0x26c18b)=>{const _0x5e3669='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x5e3669,[],(_0x1bdc6e,_0x21ec87)=>{_0x1bdc6e?_0x26c18b({'status':'error','message':_0x1bdc6e['message']}):_0x48e4f5({'status':'success','contactedCount':_0x21ec87['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x36a1ed,_0x5bd9dc)=>{const _0xf40a17='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0xf40a17,[],(_0x14bae5,_0x5eb89e)=>{_0x14bae5?_0x5bd9dc({'status':'error','message':_0x14bae5['message']}):_0x36a1ed({'status':'success','contactedCount':_0x5eb89e['contactedCount']});});});});function exportDatabase(_0xb397a4){return new Promise((_0x5cd6be,_0x476c9d)=>{const _0x598e7a='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0xb397a4+'\x0a\x20\x20\x20\x20';db['all'](_0x598e7a,[],async(_0x59c7f0,_0x4f2d22)=>{if(_0x59c7f0){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x59c7f0['message']),_0x476c9d(_0x59c7f0);return;}if(!_0x4f2d22||_0x4f2d22['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x5cd6be();return;}const _0x1c9c6d=XLSX['utils']['json_to_sheet'](_0x4f2d22),_0x348cee=XLSX['utils']['sheet_to_csv'](_0x1c9c6d);try{const {canceled:_0x5df543,filePath:_0x841966}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0xb397a4+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x5df543||!_0x841966){console['log']('Speichern\x20abgebrochen.'),_0x5cd6be();return;}fs['writeFile'](_0x841966,_0x348cee,'utf8',_0x27c9fa=>{_0x27c9fa?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x27c9fa['message']),_0x476c9d(_0x27c9fa)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x841966),_0x5cd6be());});}catch(_0x52f51f){console['error']('Fehler\x20im\x20Speicherdialog:',_0x52f51f),_0x476c9d(_0x52f51f);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x167820,_0x2397aa)=>{const _0x4e477f=await getBrowserPageLogin();await _0x4e477f['goto'](_0x2397aa),console['log']('Stripe\x20startet');});