const {app,BrowserWindow,ipcMain,dialog}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div',K_OPTIONS_BUTTON='section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.xs5motx\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD='div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f',K_SEND_MSG_BUTTON='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x315e18=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x315e18['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x315e18['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x3140e4){var _0x9c9640=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x21c03c){console['log']('window\x20id:'+_0x21c03c['id']),_0x21c03c['id']>0x1&&(_0x9c9640=!![]);}),console['log']('child\x20opened\x20='+_0x9c9640);if(!_0x9c9640){const _0xc9f695=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0xc9f695['loadFile'](_0x3140e4['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0);});const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x58c11a='',_0xcf7094=null;if(process['platform']==='darwin')_0x58c11a=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x58c11a=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x58c11a}),_0xcf7094=await browser_login['newPage'](),_0xcf7094['setDefaultNavigationTimeout'](0x1d4c),_0xcf7094['setDefaultTimeout'](0x1d4c),_0xcf7094;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x1bb92a=0x1,_0x389fff=0x0){let _0xf1109b='',_0x34ef8e=null;const _0x43b129=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0xf1109b=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0xf1109b=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x1bb92a===0x0&&!pageStack[_0x389fff])return browser=await puppeteer['launch']({'headless':_0x43b129,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0xf1109b}),_0x34ef8e=await browser['newPage'](),_0x34ef8e['setDefaultNavigationTimeout'](0x1d4c),_0x34ef8e['setDefaultTimeout'](0x1d4c),pageStack[_0x389fff]=_0x34ef8e,_0x34ef8e;return(browser===null||pageStack[_0x389fff]===null||pageStack[_0x389fff]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x43b129,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0xf1109b})),(pageStack[_0x389fff]===null||pageStack[_0x389fff]['isClosed']())&&(_0x34ef8e=await browser['newPage'](),_0x34ef8e['setDefaultNavigationTimeout'](0x1d4c),_0x34ef8e['setDefaultTimeout'](0x1d4c),pageStack[_0x389fff]=_0x34ef8e),pageStack[_0x389fff];}ipcMain['on']('login',async(_0x3a27cf,_0x467163)=>{const _0x55ccd7=await getBrowserPageLogin();await _0x55ccd7['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x55ccd7,_0x467163),ipcMain['on']('setLoginCookies',async(_0x26b79d,_0x364821)=>{try{await set_login_cookies(_0x55ccd7,_0x364821);}catch(_0x14d81b){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x14d81b);}});}),ipcMain['on']('export-relation',async(_0x53d3ed,_0x410502)=>{try{await exportDatabase(_0x410502),_0x53d3ed['reply']('export-relation-response',{'success':!![]});}catch(_0x4a1f82){console['error'](_0x4a1f82),_0x53d3ed['reply']('export-relation-response',{'success':![],'message':_0x4a1f82['message']});}}),ipcMain['handle']('sendMessage',async(_0x4783c3,_0x447bc1,_0x116c73,_0x4986da,_0x21e3e0,_0x55d3d6,_0x49fcc3,_0x259039)=>{isStopping=![];let _0x5f34f0=null;return _0x49fcc3?_0x5f34f0=await getBrowserPage(_0x21e3e0,_0x259039):_0x5f34f0=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x447bc1),send_message(_0x5f34f0,_0x447bc1,_0x116c73,_0x4986da,_0x21e3e0,_0x55d3d6);}),ipcMain['handle']('stop-action',async(_0x5c2cdf,_0x33f4c3)=>{isStopping=!![];const _0x3efdd7=await getBrowserPage(0x1,_0x33f4c3);await _0x3efdd7['close']();}),ipcMain['handle']('fetch_followers',async(_0x4072d4,_0x5a78f6,_0x2edf04,_0x5aa0c1,_0xa20bd,_0x8358c6)=>{isStopping=![];const _0x16b82e=await getBrowserPage();return fetch_followers_from_account(_0x4072d4,_0x16b82e,_0x5a78f6,_0x2edf04,_0x5aa0c1,_0xa20bd,_0x8358c6);}),ipcMain['handle']('get-account-details',async(_0x1ffc4d,_0xe02b2a,_0x4411cc,_0x1788dd)=>{isStopping=![];const _0x329091=await getBrowserPage();return fetch_account_details(_0x329091,_0xe02b2a,_0x4411cc,_0x1788dd);}),ipcMain['handle']('fetch_likes',async(_0x582572,_0x3f3c47,_0x5c6b2a,_0x21e4ca,_0xdf105b,_0x222daa)=>{isStopping=![];const _0x3b9559=await getBrowserPage();return fetch_likers_from_post(_0x582572,_0x3b9559,_0x3f3c47,_0x5c6b2a,_0x21e4ca,_0xdf105b,_0x222daa);}),ipcMain['handle']('fetch_comments',async(_0x4d74f8,_0x5b50dc,_0x5775ca,_0x5d5f10,_0x46aa80,_0x36d645)=>{isStopping=![];const _0x3a721c=await getBrowserPage();return fetch_comments_from_post(_0x4d74f8,_0x3a721c,_0x5b50dc,_0x5775ca,_0x5d5f10,_0x46aa80,_0x36d645);}),ipcMain['handle']('update-app',async _0x22b9ad=>{const {spawn:_0x4ba9cd}=require('child_process'),_0x4b851d=require('path');return new Promise((_0x578c51,_0x174f01)=>{(process['env']['NODE_ENV']==='development'||process['env']['SKIP_UPDATES']==='true')&&(console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x578c51('Update\x20übersprungen'));if(process['platform']==='darwin'){const _0xa6f17f=_0x4b851d['join'](__dirname,'mac-updater-intern.sh'),_0x20a573=_0x4ba9cd('/bin/bash',[_0xa6f17f]);_0x20a573['stdout']['on']('data',_0x14ce01=>{console['log']('stdout:\x20'+_0x14ce01);}),_0x20a573['stderr']['on']('data',_0x2b1f2e=>{console['error']('stderr:\x20'+_0x2b1f2e);}),_0x20a573['on']('close',_0x30c3f7=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x30c3f7),_0x30c3f7===0x0?_0x578c51('Update\x20erfolgreich\x20abgeschlossen.'):_0x174f01(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x30c3f7));});}else{if(process['platform']==='win32'){const _0x515125=_0x4b851d['join'](__dirname,'../','../','../');process['chdir'](_0x515125),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x344946='soft-ui-updater-windows.ps1',_0x192beb=_0x4ba9cd('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x344946]);_0x192beb['stdout']['on']('data',_0x9184fc=>{console['log']('stdout:\x20'+_0x9184fc);}),_0x192beb['stderr']['on']('data',_0x3487b5=>{console['error']('stderr:\x20'+_0x3487b5);}),_0x192beb['on']('close',_0x1fca3a=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x1fca3a),_0x1fca3a===0x0?_0x578c51('Update\x20erfolgreich\x20abgeschlossen.'):_0x174f01(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x1fca3a));});}else _0x174f01(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}});});function getRnd(_0x4c3b83,_0x2051f0){return Math['random']()*(_0x2051f0-_0x4c3b83+0x1)+_0x4c3b83;}function delay(_0x1b060e,_0x137808){let _0x495568=getRnd(_0x1b060e,_0x137808);return new Promise(function(_0x3b7030){setTimeout(_0x3b7030,_0x495568);});}async function scroll(_0x1de8d4,_0x3b746b,_0x71bd2c=0x2,_0x856fb4){const _0x58623d=await _0x1de8d4['waitForSelector'](_0x3b746b);for(let _0x5934fc=0x0;_0x5934fc<_0x71bd2c;_0x5934fc++){console['log']('Scrolling\x20'+_0x5934fc),await _0x1de8d4['evaluate'](_0x9d08ab=>{const _0x5d33ca=document['querySelector'](_0x9d08ab);_0x5d33ca&&_0x5d33ca['scrollBy'](0x0,0x190);},_0x3b746b),await delay(0x320,0x5dc),_0x856fb4();}}async function saveCookies(_0x330719){let _0x8f6212=await _0x330719['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x8f6212,null,0x2));}async function notificationClear(_0x4f83b0){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x4f83b0['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x4f83b0['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x3e14dc){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x3e14dc);}}async function getTargetProfiles(_0x40e293){return new Promise((_0x2c44a5,_0x4a5667)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x40e293,(_0x2b3e05,_0x525f54)=>{_0x2b3e05?_0x4a5667(_0x2b3e05):_0x2c44a5(_0x525f54);});});}async function login_legacy(_0x4d9604,_0x5e58f4,_0x38b01a){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x4d9604,_0x5e58f4),await createUserIfNotExists(_0x5e58f4,_0x38b01a);}catch(_0x1a8392){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x1a8392);}try{await _0x4d9604['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x4d9604['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x4d9604['click']('button._a9--._ap36._a9_0');}catch(_0x411795){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x4d9604['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x4d9604['type']('input[name=\x27username\x27]',_0x5e58f4,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x4d9604['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x4d9604['type']('input[name=\x27password\x27]',_0x38b01a,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x4d9604['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x4d9604['click']('button[type=\x27submit\x27]');}catch(_0x45b8cd){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x4d9604),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x4d9604,_0x5e58f4);}catch(_0x50b1d3){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x50b1d3);}}catch(_0x5e7cf3){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x5e7cf3);}}async function login(_0xc29356,_0x23c3cb){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0xc29356,_0x23c3cb),await createUserIfNotExists(_0x23c3cb);}catch(_0x5d2c26){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5d2c26);}try{await _0xc29356['goto']('https://www.instagram.com/accounts/login/');}catch(_0x598ef2){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x598ef2);}}async function set_login_cookies(_0x26f459,_0x2e112b){try{await saveCookiesForUser(_0x26f459,_0x2e112b);}catch(_0x1215f5){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x1215f5);}}async function waitForXPath(_0x190cae,_0xa22f7a,_0x32553e={}){return await _0x190cae['waitForFunction'](_0x55af12=>{return document['evaluate'](_0x55af12,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x32553e,_0xa22f7a),_0x190cae['evaluateHandle'](_0x3af79a=>document['evaluate'](_0x3af79a,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0xa22f7a);}async function send_message(_0xcc4adf,_0x5ece3a,_0x4a5b6a,_0x398e04,_0x59cc4e,_0x1a6401){return new Promise(async(_0x3be82c,_0x370cc4)=>{_0x1a6401=_0x1a6401['split'](';'),console['log'](_0x1a6401[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x59cc4e);try{await setCookiesForUser(_0xcc4adf,_0x1a6401[0x0]);}catch(_0x2ae8f7){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x2ae8f7),_0x370cc4({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2ae8f7});return;}try{await _0xcc4adf['goto']('https://www.instagram.com/'+_0x5ece3a+'/'),await delay(0xfa0,0x1d4c),await notificationClear(_0xcc4adf);}catch(_0x1e446f){_0x370cc4({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x1e446f});return;}try{await _0xcc4adf['waitForSelector'](K_DIRECT_MSG_BUTTON),await _0xcc4adf['click'](K_DIRECT_MSG_BUTTON);}catch(_0x2ba850){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x2ba850);try{await _0xcc4adf['waitForSelector'](K_OPTIONS_BUTTON),await _0xcc4adf['click'](K_OPTIONS_BUTTON),await delay(0x1f4,0x320);const _0x4f892a=await waitForXPath(_0xcc4adf,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x4f892a['click']();}catch(_0x39fc4c){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x39fc4c),_0x3be82c({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0xcc4adf);}catch(_0xd9daab){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0xd9daab);}try{const _0x4c635f=await _0xcc4adf['waitForSelector'](K_CHAT_INPUT_FIELD),_0x223ede=await _0xcc4adf['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x223ede),_0x398e04=_0x398e04['replace']('{USERNAME}',_0x5ece3a);let _0x482b29=_0x223ede['split']('\x20')[0x0];_0x398e04=_0x398e04['replace']('{NAME}',_0x482b29),_0x398e04=_0x398e04['replace']('{name}',_0x482b29),await _0x4c635f['type'](_0x398e04,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0x1a8a04=await _0xcc4adf['waitForSelector'](K_SEND_MSG_BUTTON);await _0x1a8a04['click'](),await delay(0x320,0x3e8),_0x3be82c({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!'});}catch(_0x5833e3){console['error']('Nachricht\x20nicht\x20gesendet:\x20'+_0x5833e3),_0x370cc4('Nachricht\x20nicht\x20gesendet:\x20'+_0x5833e3);}});}function handle_fail(_0x24d471){if(isStopping)return new Promise(_0x56e245=>{_0x56e245('Scraper\x20gestoppt.');});else{let _0x417c71='';switch(_0x24d471){case 0x0:_0x417c71='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x417c71='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x417c71='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x417c71='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x200905,_0x45ef4e)=>{_0x45ef4e(_0x417c71);});}}async function fetch_account_details(_0x18ca73,_0x4c1175,_0x1c8115,_0x4356d7){try{await setCookiesForUser(_0x18ca73,_0x1c8115['username']);}catch(_0x1ccdc6){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x1ccdc6);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x1ccdc6);return handle_fail(0x0);}_0x18ca73['setDefaultNavigationTimeout'](0x7530),await _0x18ca73['goto']('https://www.instagram.com/'+_0x4c1175+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x18ca73);const _0x3d10e8=await _0x18ca73['evaluate'](()=>{const _0x5434f0=document['querySelector']('meta[property=\x22og:image\x22]');return _0x5434f0?_0x5434f0['getAttribute']('content'):null;});await _0x18ca73['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x52c3d5=await _0x18ca73['evaluate'](()=>{const _0x218855=document['querySelector']('meta[name=\x22description\x22]');if(!_0x218855)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x4b0ada=_0x218855['getAttribute']('content');if(!_0x4b0ada)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x4b0ada);const _0x1c7a3b=/\s*[–-]\s*/,_0x12cb82=_0x4b0ada['split'](_0x1c7a3b);if(_0x12cb82['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x4a495c=_0x12cb82[0x0],_0x2238c8=_0x12cb82[0x1],_0x25fe20=_0x4a495c['split'](',\x20');if(_0x25fe20['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x49e124=_0x25fe20[0x0]['split']('\x20')[0x0],_0x4657f8=_0x25fe20[0x1]['split']('\x20')[0x0],_0x2902ca=_0x25fe20[0x2]['split']('\x20')[0x0];let _0x5b7fe4='',_0x583377='';const _0x50a66c='\x20on\x20Instagram:\x20',_0xd07fa9=_0x2238c8['split'](_0x50a66c);return _0x5b7fe4=_0xd07fa9[0x0]['trim'](),_0x5b7fe4=_0x5b7fe4['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0xd07fa9['length']>0x1&&(_0x583377=_0xd07fa9[0x1]['trim'](),_0x583377['startsWith']('\x22')&&_0x583377['endsWith']('\x22')&&(_0x583377=_0x583377['substring'](0x1,_0x583377['length']-0x1)['trim']()),_0x583377=_0x583377['replace'](/&quot;/g,'')['trim']()),{'followers':_0x49e124,'following':_0x4657f8,'posts':_0x2902ca,'nameText':_0x5b7fe4,'bio':_0x583377};});console['log']('Extracted\x20profile\x20data:',_0x52c3d5);const _0xb3daf=_0x52c3d5['nameText'],_0x214e2=_0x3d10e8,_0x48291=_0x52c3d5['bio'],_0x189cc9=_0x52c3d5['followers'],_0x1dc660=_0x52c3d5['following'],_0x491cf4=_0x52c3d5['posts'],_0x271fff=![],_0xefe4e5=![],_0x20bcc2=![],_0x264253='\x0a\x20\x20INSERT\x20INTO\x20'+_0x4356d7+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x264253,[_0x4c1175,_0xb3daf,_0x214e2,_0x48291,_0x189cc9,_0x1dc660,_0x491cf4,_0x271fff,_0xefe4e5,_0x20bcc2],function(_0x146ffc){_0x146ffc?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x146ffc['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x2f71c9,_0x33411c,_0x2c8477,_0xbb674f,_0x3e8f3e,_0x32dab9,_0xcab055){let _0x41f18d=0x4,_0x440b17=0x0,_0x3a0be1=0x0;try{await setCookiesForUser(_0x33411c,_0x32dab9['username']);}catch(_0x5e4853){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x5e4853);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x5e4853);return handle_fail(0x0);}let _0x5e61ac=0x0;try{await _0x33411c['goto']('https://www.instagram.com/'+_0x2c8477+'/'),await notificationClear(_0x33411c);try{if(_0xbb674f<=0x0){const _0x3a9501=await _0x33411c['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x538d07=await _0x33411c['evaluate'](_0x33228a=>_0x33228a['innerHTML'],_0x3a9501);_0x5e61ac=Math['ceil'](_0x538d07/0x4);}else _0x5e61ac=Math['ceil'](_0xbb674f/0x4);_0x41f18d+=_0x5e61ac,_0x3a0be1=Math['round'](++_0x440b17/_0x41f18d*0x64),_0x2f71c9['sender']['send']('fetch-progress',_0x3a0be1,!![]);let _0xb0ff1a=await _0x33411c['waitForSelector']('a[href=\x22/'+_0x2c8477+'/followers/\x22]');await delay(0xbb8,0x1388),await _0xb0ff1a['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x2c8477+'\x20gesichtet'),_0x3a0be1=Math['round'](++_0x440b17/_0x41f18d*0x64),_0x2f71c9['sender']['send']('fetch-progress',_0x3a0be1,!![]);}catch(_0x49ba35){console['log']('Follower\x20Liste\x20von\x20'+_0x2c8477+'\x20nicht\x20gefunden:'+_0x49ba35);throw new Error('Follower\x20Liste\x20von\x20'+_0x2c8477+'\x20nicht\x20gefunden:'+_0x49ba35);return handle_fail(0x0);}}catch(_0x2dd349){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x2dd349);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x2dd349);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x5e61ac),await scroll(_0x33411c,FOLLOWER_FENSTER,_0x5e61ac,_0x3c6243=>{_0x3a0be1=Math['round'](++_0x440b17/_0x41f18d*0x64),_0x2f71c9['sender']['send']('fetch-progress',_0x3a0be1,!![]);}),await _0x33411c['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x291c4b=await _0x33411c['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x49b4a3=await _0x33411c['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x3a0be1=Math['round'](++_0x440b17/_0x41f18d*0x64),_0x2f71c9['sender']['send']('fetch-progress',_0x3a0be1,!![]);_0xbb674f<=0x0&&(_0xbb674f=_0x291c4b['length']);let _0x30af1e=[];for(let _0x161b96=0x0;_0x161b96<_0x291c4b['length']&&_0x161b96<_0xbb674f;_0x161b96++){_0x30af1e['push'](await _0x291c4b[_0x161b96]['evaluate'](_0x52482a=>_0x52482a['textContent']));const _0x44b088='INSERT\x20INTO\x20'+_0x3e8f3e+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x44b088,[await _0x291c4b[_0x161b96]['evaluate'](_0x3e7bdb=>_0x3e7bdb['textContent']),await _0x49b4a3[_0x161b96]['evaluate'](_0x25016f=>_0x25016f['textContent'])],function(_0x1159d0){_0x1159d0?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x3e8f3e+'\x27:',_0x1159d0['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x3a0be1=Math['round'](++_0x440b17/_0x41f18d*0x64),_0x2f71c9['sender']['send']('fetch-progress',_0x3a0be1,!![]),_0xcab055&&(_0x2f71c9['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x2f71c9,_0x33411c,_0x32dab9,_0x3e8f3e,_0x30af1e)),new Promise(_0x3b3416=>{_0x3b3416('Scraping\x20finished!');});}catch(_0xb93d47){if(_0xcab055)throw new Error(_0xb93d47);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x2c8477+'\x20nicht\x20gefunden:\x20'+_0xb93d47);return handle_fail(0x0);}}async function fetch_details_from_list(_0x88a1ec,_0x23a79f,_0x1679b5,_0x271f99,_0x3b4dca){let _0x4db338=0x0,_0xde80a5=0x0;for(let _0xabd5c6=0x0;_0xabd5c6<_0x3b4dca['length'];_0xabd5c6++){console['log']('Processing\x20profile:',_0x3b4dca[_0xabd5c6]);try{await fetch_account_details(_0x23a79f,_0x3b4dca[_0xabd5c6],_0x1679b5,_0x271f99);}catch(_0x493c3c){console['error']('Detailed\x20Scraping\x20von:\x20',_0x3b4dca[_0xabd5c6],_0x493c3c);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x3b4dca[_0xabd5c6]+'\x20'+_0x493c3c);}_0xde80a5=Math['round'](++_0x4db338/_0x3b4dca['length']*0x64),_0x88a1ec['sender']['send']('fetch-progress',_0xde80a5,!![],!![]);}}async function fetch_likers_from_post(_0x1403d3,_0x3e7cbb,_0x4698be,_0x492f99,_0x13c1cb,_0x577a9f,_0x4b9cfd){let _0x43a0d3=0x4,_0x42bc42=0x0,_0x379382=0x0;try{await setCookiesForUser(_0x3e7cbb,_0x577a9f['username']);}catch(_0x5283b4){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5283b4);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5283b4);return handle_fail(0x1);return;}_0x379382=Math['round'](++_0x42bc42/_0x43a0d3*0x64),_0x1403d3['sender']['send']('fetch-progress',_0x379382,!![]);try{let _0x3eca14=_0x4698be['substring'](0x0,_0x4698be['lastIndexOf']('/')),_0x58925e=_0x3eca14+'/liked_by';console['log'](_0x58925e),await _0x3e7cbb['goto'](_0x58925e),await delay(0x7d0,0xfa0),await notificationClear(_0x3e7cbb),await delay(0xc8,0x1f4),_0x379382=Math['round'](++_0x42bc42/_0x43a0d3*0x64),_0x1403d3['sender']['send']('fetch-progress',_0x379382,!![]),await _0x3e7cbb['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x2648cb=await _0x3e7cbb['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x3becfe=await _0x3e7cbb['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x2648cb['length']);let _0x209943=path['join'](__dirname,'/likers.csv');_0x379382=Math['round'](++_0x42bc42/_0x43a0d3*0x64),_0x1403d3['sender']['send']('fetch-progress',_0x379382,!![]);_0x492f99<=0x0&&(_0x492f99=_0x2648cb['length']);try{let _0x1fd700=[];for(let _0x4906f3=0x0;_0x4906f3<_0x2648cb['length']&&_0x4906f3<_0x492f99;_0x4906f3++){_0x1fd700['push'](await _0x2648cb[_0x4906f3]['evaluate'](_0x3ea686=>_0x3ea686['textContent']));try{const _0x1f1e6b='INSERT\x20INTO\x20'+_0x13c1cb+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x1f1e6b,[await _0x2648cb[_0x4906f3]['evaluate'](_0x48f088=>_0x48f088['textContent']),await _0x3becfe[_0x4906f3]['evaluate'](_0x156e6e=>_0x156e6e['textContent'])],function(_0x273c7d){_0x273c7d?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x13c1cb+'\x27:',_0x273c7d['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x29107b){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x4906f3+'\x20:\x20'+_0x29107b);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x4906f3+'\x20:\x20'+_0x29107b);return handle_fail(0x1);}}return _0x379382=Math['round'](++_0x42bc42/_0x43a0d3*0x64),_0x1403d3['sender']['send']('fetch-progress',_0x379382,!![]),_0x4b9cfd&&(_0x1403d3['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x1403d3,_0x3e7cbb,_0x577a9f,_0x13c1cb,_0x1fd700)),new Promise(_0x2e1105=>{_0x2e1105('Scraping\x20finished!');});}catch(_0x5401a3){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x5401a3);return handle_fail(0x1);}}catch(_0x23c004){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x23c004);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x23c004);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x1e1bbd,_0x2d6ec8,_0x4d4222,_0x1c8b71,_0x104407,_0x533d24,_0x1e49d3){let _0x380126=0x3,_0x565679=0x0,_0x768f82=0x0;try{await setCookiesForUser(_0x2d6ec8,_0x533d24['username']);}catch(_0x586bba){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x586bba);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x586bba);return handle_fail(0x2);}try{console['log'](_0x4d4222),await _0x2d6ec8['goto'](_0x4d4222),await delay(0x7d0,0xfa0),await notificationClear(_0x2d6ec8),await delay(0xc8,0x1f4);const _0x5aef8c=COM_COMMENTS_BOX_BODY_DIV;let _0x543abb;const _0x2e8a0a=await _0x2d6ec8['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x9a690e=await _0x2d6ec8['evaluate'](_0x7f3840=>_0x7f3840['innerHTML'],_0x2e8a0a),_0x3c54d5=String(_0x9a690e)['replace'](/[^0-9]/g,''),_0x587596=Number(_0x3c54d5)/0x14;_0x1c8b71<=0x0?_0x543abb=Math['ceil'](_0x587596/0x3):_0x543abb=Math['ceil'](_0x1c8b71/0x3);_0x380126+=_0x543abb,_0x768f82=Math['round'](++_0x565679/_0x380126*0x64),_0x1e1bbd['sender']['send']('fetch-progress',_0x768f82,!![]),console['log']('Auto-scrolls:\x20'+_0x543abb),await scroll(_0x2d6ec8,_0x5aef8c,_0x543abb,_0x186d32=>{_0x768f82=Math['round'](++_0x565679/_0x380126*0x64),_0x1e1bbd['sender']['send']('fetch-progress',_0x768f82,!![]);});try{const _0x2cb038=COM_REPLY_BUTTON_SPAN;await _0x2d6ec8['waitForSelector'](_0x2cb038),await delay(0x1f4,0x320);const _0x44f3ff=await _0x2d6ec8['$$'](_0x2cb038);console['log'](_0x44f3ff);let _0x1ce019=_0x44f3ff['length'];await delay(0xc8,0x1f4);try{for(let _0x5ea422=0x0;_0x5ea422<_0x1ce019;_0x5ea422++){_0x44f3ff[_0x5ea422]['click'](),await delay(0x320,0x5dc);}}catch(_0x2a6105){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x2a6105);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x2a6105);return handle_fail(0x2);}}catch(_0x2f0d9a){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x5e4e20=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x2d6ec8['waitForSelector'](_0x5e4e20),await delay(0x1f4,0x320),_0x768f82=Math['round'](++_0x565679/_0x380126*0x64),_0x1e1bbd['sender']['send']('fetch-progress',_0x768f82,!![]);const _0x571f40=await _0x2d6ec8['$$'](_0x5e4e20);let _0x9b9eab=path['join'](__dirname,'/comments.csv');_0x1c8b71<=0x0&&(_0x1c8b71=_0x571f40['length']);console['log']('fetch_limit:\x20'+_0x1c8b71),console['log']('comments_len:\x20'+_0x571f40['length']),_0x1c8b71++;try{let _0x4fbef6=[];for(let _0xd7941d=0x1;_0xd7941d<_0x571f40['length']&&_0xd7941d<_0x1c8b71;_0xd7941d++){try{_0x4fbef6['push'](await _0x571f40[_0xd7941d]['evaluate'](_0x2720ae=>_0x2720ae['textContent']));const _0x260a7c=await db['prepare']('INSERT\x20INTO\x20'+_0x104407+'\x20(username)\x20VALUES\x20(?)');await _0x260a7c['run'](await _0x571f40[_0xd7941d]['evaluate'](_0x400f2b=>_0x400f2b['textContent']),function(_0x1d57c4){_0x1d57c4&&console['log']('error\x20in\x20add-user:'+_0x1d57c4);}),await _0x260a7c['finalize']();}catch(_0x871ceb){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0xd7941d+'\x20:\x20'+_0x871ceb);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0xd7941d+'\x20:\x20'+_0x871ceb);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x768f82=Math['round'](++_0x565679/_0x380126*0x64),_0x1e1bbd['sender']['send']('fetch-progress',_0x768f82,!![]),_0x1e1bbd['sender']['send']('fetch-progress',0x64,!![]),_0x1e49d3&&(_0x1e1bbd['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x1e1bbd,_0x2d6ec8,_0x533d24,_0x104407,_0x4fbef6)),_0x1e1bbd['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x112c34=>{_0x112c34('Scraping\x20finished!');});}catch(_0x127278){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x127278);return handle_fail(0x2);}}catch(_0x29474e){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x29474e);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x29474e);return handle_fail(0x2);}}async function set_clearname_from_username(_0x2656b4,_0x591b8b,_0x4ed615=null){try{let _0x2abf91,_0xc5392a;const _0xed4a48='SELECT\x20username\x20FROM\x20'+_0x591b8b+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0xed4a48,[],(_0x5213f5,_0xc96276)=>{_0x5213f5&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x5213f5['message']),_0xc96276['length']===0x0&&(_0xc5392a=_0xc96276['length']),_0x2abf91=_0xc96276['map'](_0x2c3ac4=>_0x2c3ac4['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0xc5392a);if(_0xc5392a===0x0){console['log']('Leave');return;}const _0x331c53=await _0x2656b4['waitForSelector'](IG_SEARCH_BUTTON);await _0x331c53['click'](),await delay(0x4b0,0x7d0);for(let _0x3537bb of _0x2abf91){const _0x2e518c=await _0x2656b4['waitForSelector'](IG_SEARCH_INPUT);await _0x2e518c['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x2656b4['type'](IG_SEARCH_INPUT,_0x3537bb,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x3c16a4=0x1;while(_0x3c16a4!=0x14){console['log']('Schleife');try{let _0x56cb83=IG_NAME_SPAN_PART1+_0x3c16a4+IG_USERNAME_SPAN_PART2;const _0x2b07f5=await _0x2656b4['waitForSelector'](_0x56cb83),_0x4154fa=await _0x2656b4['evaluate'](_0x1e7f27=>_0x1e7f27['innerHTML'],_0x2b07f5);await delay(0xc8,0x1f4);if(_0x4154fa==_0x3537bb){let _0x529543=IG_NAME_SPAN_PART1+_0x3c16a4+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x9b6809=await _0x2656b4['waitForSelector'](_0x529543);let _0x10d171=await _0x2656b4['evaluate'](_0x38833a=>_0x38833a['innerHTML'],_0x9b6809);const _0x36196b=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x21659b=_0x10d171['match'](_0x36196b);_0x21659b?_0x10d171=_0x21659b[0x1]['trim']():_0x10d171=_0x10d171['trim']();_0x10d171['includes']('•')&&(_0x10d171=_0x10d171['substring'](0x0,_0x10d171['indexOf']('•')-0x1));const _0x3a4db1='UPDATE\x20'+_0x591b8b+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x3a4db1,[_0x10d171,_0x4154fa],function(_0x2a9ddf){_0x2a9ddf&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x2a9ddf['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x3c16a4++;}catch(_0x51f85c){const _0x977f11='UPDATE\x20'+_0x591b8b+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x977f11,['',_0x3537bb],function(_0x31933e){_0x31933e&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x31933e['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x51f85c);break;}}_0x4ed615&&_0x4ed615();}await _0x331c53['click']();}catch(_0x3b9195){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x3b9195);}}const campaignPath=path['resolve'](__dirname,'data/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(campaign_name\x20TEXT\x20PRIMARY\x20KEY,\x20list_id\x20TEXT,\x20zeitabstand\x20REAL,\x20message_id\x20TEXT,\x20account\x20TEXT,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x2ec375,_0x127ae8)=>{const _0x285f72='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x285f72,[],(_0x37f1b5,_0x3ac960)=>{_0x37f1b5?_0x127ae8(_0x37f1b5):_0x2ec375(_0x3ac960);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x3ebd2d,_0x5154f0)=>{const _0x5456f5='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x5456f5,[],async(_0x4e6e66,_0x289e55)=>{if(_0x4e6e66)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x4e6e66['message']),_0x5154f0({'status':'error','message':_0x4e6e66['message']});else try{const _0x5bb991=await Promise['all'](_0x289e55['map'](_0x285045=>{return new Promise(_0xe0f019=>{if(!_0x285045['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x285045['campaign_name']),_0xe0f019({'campaign_name':_0x285045['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x1eba79='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x285045['list_id'],_0x5ecbef='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x285045['list_id']+'\x22';db['get'](_0x1eba79,[],(_0x1d84cf,_0x59c2e2)=>{_0x1d84cf?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x285045['campaign_name']+':',_0x1d84cf['message']),_0xe0f019({'campaign_name':_0x285045['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x5ecbef,[],(_0x52c941,_0x2daece)=>{_0x52c941?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x285045['campaign_name']+':',_0x52c941['message']),_0xe0f019({'campaign_name':_0x285045['campaign_name'],'lead_count':_0x59c2e2?_0x59c2e2['lead_count']:0x0,'contacted_count':'N/A'})):_0xe0f019({'campaign_name':_0x285045['campaign_name'],'lead_count':_0x59c2e2?_0x59c2e2['lead_count']:0x0,'contacted_count':_0x2daece?_0x2daece['contacted_count']:0x0});});});});}));_0x3ebd2d({'status':'success','campaigns':_0x5bb991});}catch(_0xd5c8ed){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0xd5c8ed),_0x5154f0({'status':'error','message':_0xd5c8ed['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x73a8d6,_0xa27fea)=>{return new Promise((_0x2d1e1a,_0x293e32)=>{const _0x4f975b='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x4f975b,[_0xa27fea],(_0x4b2794,_0x5010ed)=>{_0x4b2794?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x4b2794),_0x293e32(_0x4b2794)):(console['log']('ROWS'),console['log'](_0x5010ed),debugDatabaseContents(),_0x2d1e1a(_0x5010ed));});});});const showTableContents=_0x4ff663=>{return new Promise((_0x1cf97e,_0xcf42d3)=>{const _0x5cc908='SELECT\x20*\x20FROM\x20'+_0x4ff663+';';campaignDB['all'](_0x5cc908,(_0xb1f0cf,_0x26c271)=>{_0xb1f0cf?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x4ff663+':',_0xb1f0cf),_0xcf42d3(_0xb1f0cf)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x4ff663+':',_0x26c271),_0x1cf97e({'status':'success','message':_0x26c271}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x1278f4){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x1278f4);}}ipcMain['handle']('create-campaign',async(_0x52d677,_0x172cfe)=>{return new Promise((_0x5da655,_0x269583)=>{const _0x1b1e34='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x1b1e34,[String(_0x172cfe)],function(_0x398f33){_0x398f33?_0x269583(_0x398f33):_0x5da655({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x146056,_0x231578)=>{return new Promise((_0x2e1212,_0x34fcfb)=>{const _0x291776='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x291776,[_0x231578],function(_0x25b92e){_0x25b92e?_0x34fcfb(_0x25b92e):_0x2e1212({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x10b946,_0x3e2842,_0x2f3c29,_0x4764f2,_0x15215f,_0x414809)=>{const _0x2b278c=await createMessageID(_0x15215f);return new Promise((_0x2e1fa8,_0x22d9a9)=>{if(!_0x3e2842||!_0x2f3c29||!_0x4764f2||!_0x2b278c||!_0x414809)return _0x22d9a9({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x2b278c);const _0x330e59='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x330e59,[_0x2f3c29,_0x4764f2,_0x2b278c,_0x414809,_0x3e2842],function(_0xea742e){if(_0xea742e)_0x22d9a9({'status':'error','message':_0xea742e['message']});else this['changes']===0x0?_0x22d9a9({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x2e1fa8({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x55c14e,_0x4fb32d,_0x3adbc4,_0x11b637,_0x35e06f)=>{return new Promise((_0x50bff8,_0x2e30b1)=>{const _0x33c8c4='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x33c8c4,[_0x4fb32d,_0x3adbc4,_0x11b637,_0x35e06f],function(_0x4c5c8d){return _0x4c5c8d?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x4c5c8d['message']),_0x2e30b1('insert-dm-response',{'success':![],'message':_0x4c5c8d['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x50bff8('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x88b55b=>{return new Promise((_0x2b70af,_0x2f6c13)=>{const _0x22d8d1='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x22d8d1,[_0x88b55b],(_0xee705e,_0x4f73fd)=>{if(_0xee705e)_0x2f6c13({'status':'error','message':_0xee705e['message']});else{if(_0x4f73fd)_0x2b70af(_0x4f73fd['message_id']);else{const _0x59e307='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x59e307,[_0x88b55b],function(_0x173397){_0x173397?_0x2f6c13({'status':'error','message':_0x173397['message']}):_0x2b70af(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x23b04b,_0x480875)=>{return new Promise((_0x5d9a89,_0x36e34b)=>{const _0x4fd40a='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x480875;db['get'](_0x4fd40a,(_0xdb4349,_0x2f5f5f)=>{_0xdb4349?_0x36e34b({'status':'error','message':_0xdb4349['message']}):_0x5d9a89({'status':'success','count':_0x2f5f5f['count']});});});});const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x5b3f04,_0x388580){try{const _0x39da13=await new Promise((_0x5bed08,_0x12e80b)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x388580],(_0x4e7976,_0x33eb74)=>{if(_0x4e7976)_0x12e80b(_0x4e7976);else{if(_0x33eb74['length']>0x0){let _0x44b97e=JSON['parse'](_0x33eb74[0x0]['cookie']);console['log'](_0x44b97e),_0x5bed08(_0x44b97e);}else _0x12e80b(new Error('User\x20with\x20username\x20'+_0x388580+'\x20does\x20not\x20exist.'));}});});await _0x5b3f04['setCookie'](..._0x39da13),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x340a0d){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x340a0d);}}async function saveCookiesForUser(_0x4acee9,_0x109763){try{const _0x343f45=await _0x4acee9['cookies']();if(!_0x343f45||_0x343f45['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x109763);const _0x4cc1d5=JSON['stringify'](_0x343f45);if(_0x4cc1d5['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x109763);return new Promise((_0x55deaa,_0x20abe1)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x109763],(_0x2ace5a,_0x19de01)=>{if(_0x2ace5a)return console['error']('Error\x20checking\x20user\x20existence:',_0x2ace5a),_0x20abe1(_0x2ace5a);if(_0x19de01){const _0x2ebdb6=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x2ebdb6['run'](_0x4cc1d5,_0x109763,function(_0x583fb6){return _0x583fb6?(console['error']('Error\x20updating\x20cookies:',_0x583fb6),_0x20abe1(_0x583fb6)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x109763),_0x55deaa());});}else{const _0x1cc6aa=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x1cc6aa['run'](_0x109763,_0x4cc1d5,function(_0x52c77d){return _0x52c77d?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x52c77d),_0x20abe1(_0x52c77d)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x109763),_0x55deaa());});}});});}catch(_0x540c23){console['error']('Error\x20fetching\x20cookies:',_0x540c23);throw _0x540c23;}}async function createUserIfNotExists(_0xaf7154){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0xaf7154],(_0x18427c,_0x4caaab)=>{if(_0x18427c){console['error']('Error\x20checking\x20user\x20existence:',_0x18427c);throw _0x18427c;}else{if(!_0x4caaab){const _0x12c745=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x12c745['run'](_0xaf7154,function(_0x154f36){_0x154f36?console['error']('Error\x20inserting\x20new\x20user:',_0x154f36):console['log']('New\x20user\x20created:',_0xaf7154);});}else console['log']('User\x20already\x20exists:',_0xaf7154);}});}catch(_0x27fb7c){console['error']('Error\x20creating\x20user:',_0x27fb7c);throw _0x27fb7c;}}ipcMain['handle']('create-relation',async(_0x563250,_0x44cba0)=>{return new Promise((_0x581bee,_0x4319f6)=>{const _0x5f31eb='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x44cba0+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x5f31eb,function(_0x46e70c){_0x46e70c?_0x4319f6(_0x46e70c):_0x581bee({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x8432cf,_0x11973c)=>{return console['log']('droping\x20table'+_0x11973c),new Promise((_0x54b6ca,_0x54e231)=>{const _0x50cc1b='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x11973c;console['log']('droping\x20table'+_0x11973c),db['run'](_0x50cc1b,function(_0x151238){_0x151238?_0x54e231(_0x151238):_0x54b6ca({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x295339=>{return new Promise((_0x54362f,_0x3dc09d)=>{const _0x5af918='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x5af918,[],(_0x6cc954,_0x317c50)=>{_0x6cc954?_0x3dc09d(_0x6cc954):_0x54362f(_0x317c50['map'](_0x1e7844=>_0x1e7844['name']));});});}),ipcMain['handle']('add-user',async(_0x406cdb,_0x39f1a2,_0x28ee6c)=>{return new Promise(_0x3e1919=>{const _0x20b85f=db['prepare']('INSERT\x20INTO\x20'+_0x28ee6c+'\x20(username)\x20VALUES\x20(?)');_0x20b85f['run'](_0x39f1a2,function(_0x13ad54){_0x13ad54?console['log']('error\x20in\x20add-user:'+_0x13ad54):_0x3e1919({'status':'success','id':this['lastID']});}),_0x20b85f['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x28eb8d,_0xc65b0)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x27c6e5,_0x231446)=>{if(_0x27c6e5)_0xc65b0(_0x27c6e5);else{_0x28eb8d({'status':'success','users':_0x231446});for(_0x231446 of _0x231446){console['log'](_0x231446['username']);}}});});}),ipcMain['handle']('get-data',async(_0x2692aa,_0x536881)=>{return new Promise((_0x405d31,_0x9012dd)=>{const _0x3bb88d='SELECT\x20*\x20FROM\x20'+_0x536881;console['log'](_0x3bb88d),db['all'](_0x3bb88d,[],(_0x1d50ce,_0x5ba3ff)=>{_0x1d50ce?_0x9012dd(_0x1d50ce):_0x405d31(_0x5ba3ff);});});}),ipcMain['handle']('get-accounts',async _0x2c60f2=>{return new Promise((_0xfca74b,_0xaae91b)=>{const _0x597668='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x597668),igaccountsDB['all'](_0x597668,[],(_0x1c96af,_0x377cb6)=>{_0x1c96af?_0xaae91b(_0x1c96af):_0xfca74b(_0x377cb6);});});}),ipcMain['handle']('get-targets',async(_0x582c3d,_0x40c690)=>{return getTargetProfiles(_0x40c690);}),ipcMain['handle']('delete-user',async(_0x41cca8,_0x42f502,_0x5475a0)=>{return new Promise((_0x1f8f8e,_0x203996)=>{const _0x2ee9c1=db['prepare']('DELETE\x20FROM\x20'+_0x5475a0+'\x20WHERE\x20username\x20=\x20?');_0x2ee9c1['run'](_0x42f502,function(_0xa70b60){_0xa70b60?_0x203996(_0xa70b60):_0x1f8f8e({'status':'success','changes':this['changes']});}),_0x2ee9c1['finalize']();});}),ipcMain['handle']('delete-account',async(_0x32bdd4,_0x18c2b8)=>{const _0x3282eb=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x3282eb['run'](_0x18c2b8,function(_0x5a82ee){_0x5a82ee&&console['log'](_0x5a82ee);}),_0x3282eb['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x3b2be7,_0x3158a5)=>{const _0x176c9d='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x176c9d,[],(_0x41efc1,_0x1951d9)=>{_0x41efc1?_0x3158a5({'status':'error','message':_0x41efc1['message']}):_0x3b2be7({'status':'success','contactedCount':_0x1951d9['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x3d53e9,_0x5f4e67)=>{const _0x326dc5='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x326dc5,[],(_0xbc9d6c,_0x20ba67)=>{_0xbc9d6c?_0x5f4e67({'status':'error','message':_0xbc9d6c['message']}):_0x3d53e9({'status':'success','contactedCount':_0x20ba67['contactedCount']});});});});function exportDatabase(_0x29109f){return new Promise((_0x49ca06,_0x58812c)=>{const _0x18c61e='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x29109f+'\x0a\x20\x20\x20\x20';db['all'](_0x18c61e,[],async(_0x1ea1cb,_0x28cd99)=>{if(_0x1ea1cb){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x1ea1cb['message']),_0x58812c(_0x1ea1cb);return;}if(!_0x28cd99||_0x28cd99['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x49ca06();return;}const _0x4199c2=XLSX['utils']['json_to_sheet'](_0x28cd99),_0x423350=XLSX['utils']['sheet_to_csv'](_0x4199c2);try{const {canceled:_0xfe7655,filePath:_0x3b1870}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x29109f+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0xfe7655||!_0x3b1870){console['log']('Speichern\x20abgebrochen.'),_0x49ca06();return;}fs['writeFile'](_0x3b1870,_0x423350,'utf8',_0x4d243b=>{_0x4d243b?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x4d243b['message']),_0x58812c(_0x4d243b)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x3b1870),_0x49ca06());});}catch(_0x3b0a35){console['error']('Fehler\x20im\x20Speicherdialog:',_0x3b0a35),_0x58812c(_0x3b0a35);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x314f2c,_0x57d758)=>{const _0x1a22e9=await getBrowserPageLogin();await _0x1a22e9['goto'](_0x57d758),console['log']('Stripe\x20startet');});