const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs'),ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div',K_OPTIONS_BUTTON='section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.xs5motx\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD='div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f',K_SEND_MSG_BUTTON='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x1e094f=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x1e094f['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x1e094f['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x3d0f24){var _0x36d8b9=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x3e4e20){console['log']('window\x20id:'+_0x3e4e20['id']),_0x3e4e20['id']>0x1&&(_0x36d8b9=!![]);}),console['log']('child\x20opened\x20='+_0x36d8b9);if(!_0x36d8b9){const _0x4e55ee=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x4e55ee['loadFile'](_0x3d0f24['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));});function initializeDatabase(){const _0x559494=require('fs'),_0x539958=path['join'](app['getPath']('userData'),'data'),_0x107e79=['campaign.db','crm.db','igaccounts.db'],_0x50b945=[];try{_0x559494['mkdirSync'](_0x539958,{'recursive':!![]});for(const _0x2426eb of _0x107e79){const _0x3fbc61=path['join'](process['resourcesPath'],'app','build','data',_0x2426eb),_0x47c674=path['join'](_0x539958,_0x2426eb);!_0x559494['existsSync'](_0x47c674)?(_0x559494['copyFileSync'](_0x3fbc61,_0x47c674),console['log']('[InitDB]\x20Kopiert\x20'+_0x2426eb+'\x20nach:\x20'+_0x47c674)):console['log']('[InitDB]\x20'+_0x2426eb+'\x20existiert\x20bereits:\x20'+_0x47c674),_0x50b945['push'](_0x47c674);}}catch(_0x492d72){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x492d72);}return _0x50b945;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x74f39f,AppUpdate:_0x3d9bb7}=require('electron-updater');_0x74f39f['autoDownload']=![],_0x74f39f['autoInstallOnAppQuit']=!![],_0x74f39f['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x74f39f['on']('update-available',_0x5b1ef0=>{console['log']('Update\x20verfügbar:',_0x5b1ef0),_0x74f39f['downloadUpdate']();}),_0x74f39f['on']('update-downloaded',_0x46de3f=>{console['log']('Update\x20heruntergeladen:',_0x46de3f),_0x74f39f['quitAndInstall']();}),_0x74f39f['on']('error',_0x425038=>{console['error']('Fehler\x20beim\x20Updaten:',_0x425038);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x502616,AppUpdate:_0x2cd763}=require('electron-updater');_0x502616['autoDownload']=![],_0x502616['autoInstallOnAppQuit']=!![],_0x502616['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x502616['on']('update-available',_0xfcb230=>{console['log']('Update\x20verfügbar:',_0xfcb230),_0x502616['downloadUpdate']();}),_0x502616['on']('update-downloaded',_0x251c24=>{console['log']('Update\x20heruntergeladen:',_0x251c24),console['log']('Neustarten\x20zum\x20Updaten');}),_0x502616['on']('error',_0x4ce3a1=>{console['error']('Fehler\x20beim\x20Updaten:',_0x4ce3a1);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x235be1='',_0x50e19a=null;if(process['platform']==='darwin')_0x235be1=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x235be1=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x235be1}),_0x50e19a=await browser_login['newPage'](),_0x50e19a['setDefaultNavigationTimeout'](0x1d4c),_0x50e19a['setDefaultTimeout'](0x1d4c),await _0x50e19a['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x50e19a;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x4f7f31=0x1,_0x366360=0x0){let _0x53567f='',_0x12a583=null;const _0x327dc7=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x53567f=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x53567f=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x4f7f31===0x0&&!pageStack[_0x366360])return browser=await puppeteer['launch']({'headless':_0x327dc7,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x53567f}),_0x12a583=await browser['newPage'](),_0x12a583['setDefaultNavigationTimeout'](0x1d4c),_0x12a583['setDefaultTimeout'](0x1d4c),await _0x12a583['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x366360]=_0x12a583,_0x12a583;return(browser===null||pageStack[_0x366360]===null||pageStack[_0x366360]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x327dc7,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x53567f})),(pageStack[_0x366360]===null||pageStack[_0x366360]['isClosed']())&&(_0x12a583=await browser['newPage'](),_0x12a583['setDefaultNavigationTimeout'](0x1d4c),_0x12a583['setDefaultTimeout'](0x1d4c),await _0x12a583['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x366360]=_0x12a583),pageStack[_0x366360];}ipcMain['on']('login',async(_0x2086f7,_0x2cfbf3)=>{const _0xc94bc0=await getBrowserPageLogin();await _0xc94bc0['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0xc94bc0,_0x2cfbf3),ipcMain['on']('setLoginCookies',async(_0x4417c4,_0x4412eb)=>{try{await set_login_cookies(_0xc94bc0,_0x4412eb);}catch(_0x5008eb){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x5008eb);}});}),ipcMain['on']('export-relation',async(_0x1456af,_0x2b754f)=>{try{await exportDatabase(_0x2b754f),_0x1456af['reply']('export-relation-response',{'success':!![]});}catch(_0xdbf654){console['error'](_0xdbf654),_0x1456af['reply']('export-relation-response',{'success':![],'message':_0xdbf654['message']});}}),ipcMain['handle']('sendMessage',async(_0x35ee8f,_0x18b93e,_0x3b7fd9,_0x4941d1,_0x49345b,_0xd8e25c,_0x8e5945,_0x4097d2,_0x4d10fe,_0x2e782b)=>{isStopping=![];let _0x11cbba=null;return _0x8e5945?_0x11cbba=await getBrowserPage(_0x49345b,_0x4097d2):_0x11cbba=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x18b93e),send_message(_0x11cbba,_0x18b93e,_0x3b7fd9,_0x4941d1,_0x49345b,_0xd8e25c,_0x4d10fe,_0x2e782b);}),ipcMain['handle']('stop-action',async(_0x4bce62,_0xf68293)=>{isStopping=!![];const _0x376d5f=await getBrowserPage(0x1,_0xf68293);await _0x376d5f['close']();}),ipcMain['handle']('fetch_followers',async(_0x56bb8f,_0x31c4ae,_0x1f5799,_0x42aee7,_0x2c497d,_0x21412d)=>{isStopping=![];const _0x3355c7=await getBrowserPage();return fetch_followers_from_account(_0x56bb8f,_0x3355c7,_0x31c4ae,_0x1f5799,_0x42aee7,_0x2c497d,_0x21412d);}),ipcMain['handle']('get-account-details',async(_0x47bf82,_0x36fb29,_0x338988,_0x14e638)=>{isStopping=![];const _0x330370=await getBrowserPage();return fetch_account_details(_0x330370,_0x36fb29,_0x338988,_0x14e638);}),ipcMain['handle']('fetch_likes',async(_0x25005a,_0x51d510,_0x25986a,_0x3863d3,_0x4906f4,_0x3f51aa)=>{isStopping=![];const _0x4ca057=await getBrowserPage();return fetch_likers_from_post(_0x25005a,_0x4ca057,_0x51d510,_0x25986a,_0x3863d3,_0x4906f4,_0x3f51aa);}),ipcMain['handle']('fetch_comments',async(_0x302273,_0x598445,_0x6a459d,_0x14c5da,_0xad71af,_0x44389d)=>{isStopping=![];const _0x4051c0=await getBrowserPage();return fetch_comments_from_post(_0x302273,_0x4051c0,_0x598445,_0x6a459d,_0x14c5da,_0xad71af,_0x44389d);});async function updateAppSilent(){const {spawn:_0x2b608e}=require('child_process'),_0x26d5ab=require('path'),_0x4fe4de=require('electron-log');return _0x4fe4de['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x8a1d3a,_0x16c20f)=>{const {updateElectronApp:_0x512ca0,UpdateSourceType:_0x568b62}=require('update-electron-app');_0x512ca0({'updateSource':{'type':_0x568b62['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x4fe4de}),_0x8a1d3a('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0xc98ed0,_0x1a2787)=>{doFullElectronUpdateSilent(),_0xc98ed0('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x8ab55d}=require('child_process'),_0x2b202c=require('path'),_0x30a383=require('electron-log');return _0x30a383['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x1cbb4e,_0x3c73ba)=>{const {updateElectronApp:_0x1f59e4,UpdateSourceType:_0x29f5f4}=require('update-electron-app');_0x1f59e4({'updateSource':{'type':_0x29f5f4['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x30a383}),_0x1cbb4e('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x5bba9e,_0x4412af)=>{doFullElectronUpdate(),_0x5bba9e('Update\x20erfolgreich\x20abgeschlossen.');});}ipcMain['handle']('update-app',async(_0x452598,_0x289c7f)=>{console['log']('Update\x20Silent:\x20'+_0x289c7f);if(_0x289c7f)!(process['platform']==='darwin')&&(await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet'));else{if(!(process['platform']==='darwin'))await updateApp();else return new Promise((_0x51902d,_0x573a7e)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x51902d('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x2bedae=path['join'](__dirname,'mac-updater-intern.sh'),_0x2ee895=spawn('/bin/bash',[_0x2bedae]);_0x2ee895['stdout']['on']('data',_0x4bfe33=>{console['log']('stdout:\x20'+_0x4bfe33);}),_0x2ee895['stderr']['on']('data',_0x1db4da=>{console['error']('stderr:\x20'+_0x1db4da);}),_0x2ee895['on']('close',_0x3a4f72=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x3a4f72),_0x3a4f72===0x0?_0x51902d('Update\x20erfolgreich\x20abgeschlossen.'):_0x573a7e(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x3a4f72));});}else{if(process['platform']==='win32'){const _0x5e4076=path['join'](__dirname,'../','../','../');process['chdir'](_0x5e4076),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x72a1da='soft-ui-updater-windows.ps1',_0x1b2392=spawn('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x72a1da]);_0x1b2392['stdout']['on']('data',_0x1afe1f=>{console['log']('stdout:\x20'+_0x1afe1f);}),_0x1b2392['stderr']['on']('data',_0x1886be=>{console['error']('stderr:\x20'+_0x1886be);}),_0x1b2392['on']('close',_0x38e498=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x38e498),_0x38e498===0x0?_0x51902d('Update\x20erfolgreich\x20abgeschlossen.'):_0x573a7e(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x38e498));});}else _0x573a7e(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}});function getRnd(_0x3fb397,_0x20b99f){return Math['random']()*(_0x20b99f-_0x3fb397+0x1)+_0x3fb397;}function delay(_0x18b09c,_0x17e6c4){let _0x2d7758=getRnd(_0x18b09c,_0x17e6c4);return new Promise(function(_0x1c1784){setTimeout(_0x1c1784,_0x2d7758);});}async function scroll(_0x33b4e9,_0x5c7b4b,_0x94c457=0x2,_0x106c99){const _0x3b6962=await _0x33b4e9['waitForSelector'](_0x5c7b4b);for(let _0x341885=0x0;_0x341885<_0x94c457;_0x341885++){console['log']('Scrolling\x20'+_0x341885),await _0x33b4e9['evaluate'](_0x4639b3=>{const _0x5c8fe4=document['querySelector'](_0x4639b3);_0x5c8fe4&&_0x5c8fe4['scrollBy'](0x0,0x190);},_0x5c7b4b),await delay(0x320,0x5dc),_0x106c99();}}async function saveCookies(_0x24f943){let _0x1c0fb6=await _0x24f943['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x1c0fb6,null,0x2));}async function notificationClear(_0x3dfae1){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x3dfae1['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x3dfae1['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x4035cf){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x4035cf);}}async function getTargetProfiles(_0x3c5225){return new Promise((_0x2397c3,_0x59431a)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x3c5225,(_0x1b74b1,_0x2647a2)=>{_0x1b74b1?_0x59431a(_0x1b74b1):_0x2397c3(_0x2647a2);});});}async function login_legacy(_0x32a1b1,_0x13dba4,_0x27b28e){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x32a1b1,_0x13dba4),await createUserIfNotExists(_0x13dba4,_0x27b28e);}catch(_0x511cc6){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x511cc6);}try{await _0x32a1b1['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x32a1b1['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x32a1b1['click']('button._a9--._ap36._a9_0');}catch(_0x4cc7b0){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x32a1b1['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x32a1b1['type']('input[name=\x27username\x27]',_0x13dba4,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x32a1b1['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x32a1b1['type']('input[name=\x27password\x27]',_0x27b28e,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x32a1b1['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x32a1b1['click']('button[type=\x27submit\x27]');}catch(_0x404879){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x32a1b1),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x32a1b1,_0x13dba4);}catch(_0x5440e6){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x5440e6);}}catch(_0x46a516){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x46a516);}}async function login(_0x2ce6d4,_0x2a7ab1){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x2ce6d4,_0x2a7ab1),await createUserIfNotExists(_0x2a7ab1);}catch(_0x595294){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x595294);}try{await _0x2ce6d4['goto']('https://www.instagram.com/accounts/login/');}catch(_0x44b701){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x44b701);}}async function set_login_cookies(_0x3c6ac5,_0x30b28f){try{await saveCookiesForUser(_0x3c6ac5,_0x30b28f);}catch(_0x1ca644){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x1ca644);}}async function waitForXPath(_0x44dd59,_0x41854e,_0x58c327={}){return await _0x44dd59['waitForFunction'](_0x4f1039=>{return document['evaluate'](_0x4f1039,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x58c327,_0x41854e),_0x44dd59['evaluateHandle'](_0x2cc115=>document['evaluate'](_0x2cc115,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x41854e);}async function send_message(_0x513dcd,_0x2c2e30,_0x1992e6,_0x28bc5c,_0x53d19f,_0x5749ee,_0x1558c7,_0x1bd8b5){return new Promise(async(_0x43feca,_0x5991f0)=>{_0x5749ee=_0x5749ee['split'](';'),console['log'](_0x5749ee[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x53d19f);try{await setCookiesForUser(_0x513dcd,_0x5749ee[0x0]);}catch(_0x20dc6c){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x20dc6c),_0x5991f0({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x20dc6c});return;}try{await _0x513dcd['goto']('https://www.instagram.com/'+_0x2c2e30+'/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x513dcd);}catch(_0x201115){_0x5991f0({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x201115});return;}console['log']('UserSkip:\x20'+_0x1558c7);if(_0x1558c7==0x1)try{const _0x2dd8cd=await _0x513dcd['$eval']('._ap3a._aaco._aacw._aad6._aade',_0xf16a49=>_0xf16a49['textContent']['trim']());console['log'](_0x2dd8cd);if(_0x2dd8cd==='Following'||_0x2dd8cd==='Folge\x20ich')return _0x43feca({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x216d76){}try{await _0x513dcd['waitForSelector'](K_DIRECT_MSG_BUTTON),await _0x513dcd['click'](K_DIRECT_MSG_BUTTON);}catch(_0x16795f){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x16795f);try{await _0x513dcd['waitForSelector'](K_OPTIONS_BUTTON),await _0x513dcd['click'](K_OPTIONS_BUTTON),await delay(0x1f4,0x320);const _0x4b1ce4=await waitForXPath(_0x513dcd,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x4b1ce4['click']();}catch(_0x537b20){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x537b20),_0x43feca({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x513dcd);}catch(_0x14961d){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x14961d);}try{const _0xb51452=await _0x513dcd['waitForSelector'](K_CHAT_INPUT_FIELD);if(_0x1bd8b5){const _0x109cb5=await _0x513dcd['$']('div.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x6ikm8r.x10wlt62');if(_0x109cb5)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x2c2e30),_0x43feca({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x1b81d9=await _0x513dcd['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x1b81d9),_0x28bc5c=_0x28bc5c['replace']('{USERNAME}',_0x2c2e30);let _0x302766=_0x1b81d9['replace'](/[^\p{L}\s]/gu,''),_0x4d0294=_0x302766['split']('\x20')[0x0];console['log']('Extrahierter\x20Clearname\x20mit\x20Len:\x20'+_0x4d0294['length']+'nach\x20Split:\x20'+_0x4d0294);_0x4d0294['length']>0x2&&!_0x4d0294['includes']('Instagram')?(_0x28bc5c=_0x28bc5c['replaceAll']('{NAME}',_0x4d0294),_0x28bc5c=_0x28bc5c['replaceAll']('{name}',_0x4d0294)):(_0x28bc5c=_0x28bc5c['replaceAll']('\x20{NAME}',''),_0x28bc5c=_0x28bc5c['replaceAll']('\x20{name}',''),_0x28bc5c=_0x28bc5c['replaceAll']('{NAME}',''),_0x28bc5c=_0x28bc5c['replaceAll']('{name}',''));await _0xb51452['type'](_0x28bc5c,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0x53c485=await _0x513dcd['waitForSelector'](K_SEND_MSG_BUTTON);await _0x53c485['click'](),await delay(0x320,0x3e8),_0x43feca({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!'});}catch(_0x4336d4){try{await _0x513dcd['waitForSelector'](K_MSG_DISABLED_LABEL);const _0x5cd9be=await _0x513dcd['evaluate'](_0x179cd1=>{return document['querySelector'](_0x179cd1)['textContent'];},K_MSG_DISABLED_LABEL);console['log']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20gefunden:\x20'+_0x5cd9be),console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x4336d4),_0x43feca({'status':0x195,'message':'Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x2c2e30+'\x20überspringen.'});}catch(_0xf547ff){console['error']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20nicht\x20gefunden:\x20'+_0xf547ff),console['error']('Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x2c2e30+'\x20:\x20'+_0xf547ff),_0x43feca({'status':0x196,'message':'Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x2c2e30+'\x20:\x20'+_0xf547ff});}}});}function handle_fail(_0x2124c7){if(isStopping)return new Promise(_0x9d62b6=>{_0x9d62b6('Scraper\x20gestoppt.');});else{let _0x3ef630='';switch(_0x2124c7){case 0x0:_0x3ef630='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x3ef630='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x3ef630='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x3ef630='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x2d2d5b,_0x2ff71d)=>{_0x2ff71d(_0x3ef630);});}}async function fetch_account_details(_0x3080a2,_0x58152b,_0x479df9,_0x5bf7ec){try{await setCookiesForUser(_0x3080a2,_0x479df9['username']);}catch(_0x2110be){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2110be);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2110be);return handle_fail(0x0);}_0x3080a2['setDefaultNavigationTimeout'](0x7530),await _0x3080a2['goto']('https://www.instagram.com/'+_0x58152b+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x3080a2);const _0x359579=await _0x3080a2['evaluate'](()=>{const _0xb4f7b0=document['querySelector']('meta[property=\x22og:image\x22]');return _0xb4f7b0?_0xb4f7b0['getAttribute']('content'):null;});await _0x3080a2['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x172954=await _0x3080a2['evaluate'](()=>{const _0x27383e=document['querySelector']('meta[name=\x22description\x22]');if(!_0x27383e)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x3ee8c5=_0x27383e['getAttribute']('content');if(!_0x3ee8c5)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x3ee8c5);const _0x4f2ece=/\s*[–-]\s*/,_0x16ce7f=_0x3ee8c5['split'](_0x4f2ece);if(_0x16ce7f['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x5475b4=_0x16ce7f[0x0],_0x4eb8ee=_0x16ce7f[0x1],_0x11f5da=_0x5475b4['split'](',\x20');if(_0x11f5da['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x3e4e73=_0x11f5da[0x0]['split']('\x20')[0x0],_0x2e6b39=_0x11f5da[0x1]['split']('\x20')[0x0],_0x483d57=_0x11f5da[0x2]['split']('\x20')[0x0];let _0x3fc522='',_0x57631a='';const _0x302da3='\x20on\x20Instagram:\x20',_0x4e4ee6=_0x4eb8ee['split'](_0x302da3);return _0x3fc522=_0x4e4ee6[0x0]['trim'](),_0x3fc522=_0x3fc522['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x4e4ee6['length']>0x1&&(_0x57631a=_0x4e4ee6[0x1]['trim'](),_0x57631a['startsWith']('\x22')&&_0x57631a['endsWith']('\x22')&&(_0x57631a=_0x57631a['substring'](0x1,_0x57631a['length']-0x1)['trim']()),_0x57631a=_0x57631a['replace'](/&quot;/g,'')['trim']()),{'followers':_0x3e4e73,'following':_0x2e6b39,'posts':_0x483d57,'nameText':_0x3fc522,'bio':_0x57631a};});console['log']('Extracted\x20profile\x20data:',_0x172954);const _0x1a761e=_0x172954['nameText'],_0x3c5dd7=_0x359579,_0x38d45b=_0x172954['bio'],_0x162eee=_0x172954['followers'],_0x51bcea=_0x172954['following'],_0x1214cf=_0x172954['posts'],_0x563cee=![],_0x40b618=![],_0x36524f=![],_0x2c5376='\x0a\x20\x20INSERT\x20INTO\x20'+_0x5bf7ec+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x2c5376,[_0x58152b,_0x1a761e,_0x3c5dd7,_0x38d45b,_0x162eee,_0x51bcea,_0x1214cf,_0x563cee,_0x40b618,_0x36524f],function(_0x14b3b8){_0x14b3b8?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x14b3b8['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x80dbb4,_0x241c76,_0x53482b,_0x2e8835,_0x5799d7,_0x201bb0,_0x5bac4e){let _0x90c328=0x4,_0x2b983f=0x0,_0x1d3a4e=0x0;try{await setCookiesForUser(_0x241c76,_0x201bb0['username']);}catch(_0x42ad22){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x42ad22);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x42ad22);return handle_fail(0x0);}let _0x3e9fc3=0x0;try{await _0x241c76['goto']('https://www.instagram.com/'+_0x53482b+'/'),await notificationClear(_0x241c76);try{if(_0x2e8835<=0x0){const _0x2c6426=await _0x241c76['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x300e5b=await _0x241c76['evaluate'](_0x45b732=>_0x45b732['innerHTML'],_0x2c6426);_0x3e9fc3=Math['ceil'](_0x300e5b/0x4);}else _0x3e9fc3=Math['ceil'](_0x2e8835/0x4);_0x90c328+=_0x3e9fc3,_0x1d3a4e=Math['round'](++_0x2b983f/_0x90c328*0x64),_0x80dbb4['sender']['send']('fetch-progress',_0x1d3a4e,!![]);let _0x2207d7=await _0x241c76['waitForSelector']('a[href=\x22/'+_0x53482b+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x2207d7['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x53482b+'\x20gesichtet'),_0x1d3a4e=Math['round'](++_0x2b983f/_0x90c328*0x64),_0x80dbb4['sender']['send']('fetch-progress',_0x1d3a4e,!![]);}catch(_0x4fcca1){console['log']('Follower\x20Liste\x20von\x20'+_0x53482b+'\x20nicht\x20gefunden:'+_0x4fcca1);throw new Error('Follower\x20Liste\x20von\x20'+_0x53482b+'\x20nicht\x20gefunden:'+_0x4fcca1);return handle_fail(0x0);}}catch(_0x2c5227){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x2c5227);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x2c5227);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x3e9fc3),await scroll(_0x241c76,FOLLOWER_FENSTER,_0x3e9fc3,_0x46b5e7=>{_0x1d3a4e=Math['round'](++_0x2b983f/_0x90c328*0x64),_0x80dbb4['sender']['send']('fetch-progress',_0x1d3a4e,!![]);}),await _0x241c76['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x5e0a2e=await _0x241c76['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x219dec=await _0x241c76['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x1d3a4e=Math['round'](++_0x2b983f/_0x90c328*0x64),_0x80dbb4['sender']['send']('fetch-progress',_0x1d3a4e,!![]);_0x2e8835<=0x0&&(_0x2e8835=_0x5e0a2e['length']);let _0x26ef13=[];for(let _0xdd2978=0x0;_0xdd2978<_0x5e0a2e['length']&&_0xdd2978<_0x2e8835;_0xdd2978++){_0x26ef13['push'](await _0x5e0a2e[_0xdd2978]['evaluate'](_0x58c5bb=>_0x58c5bb['textContent']));const _0x3a3134='INSERT\x20INTO\x20'+_0x5799d7+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x3a3134,[await _0x5e0a2e[_0xdd2978]['evaluate'](_0x51b893=>_0x51b893['textContent']),await _0x219dec[_0xdd2978]['evaluate'](_0x5a3be0=>_0x5a3be0['textContent'])],function(_0x122bcb){_0x122bcb?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x5799d7+'\x27:',_0x122bcb['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x1d3a4e=Math['round'](++_0x2b983f/_0x90c328*0x64),_0x80dbb4['sender']['send']('fetch-progress',_0x1d3a4e,!![]),_0x5bac4e&&(_0x80dbb4['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x80dbb4,_0x241c76,_0x201bb0,_0x5799d7,_0x26ef13)),new Promise(_0xba197f=>{_0xba197f('Scraping\x20finished!');});}catch(_0x58353d){if(_0x5bac4e)throw new Error(_0x58353d);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x53482b+'\x20nicht\x20gefunden:\x20'+_0x58353d);return handle_fail(0x0);}}async function fetch_details_from_list(_0x5804f2,_0x202649,_0x11743a,_0x5b5d7a,_0x2725d9){let _0x28bbf5=0x0,_0x237d4b=0x0;for(let _0x53b9c8=0x0;_0x53b9c8<_0x2725d9['length'];_0x53b9c8++){console['log']('Processing\x20profile:',_0x2725d9[_0x53b9c8]);try{await fetch_account_details(_0x202649,_0x2725d9[_0x53b9c8],_0x11743a,_0x5b5d7a);}catch(_0x8d0019){console['error']('Detailed\x20Scraping\x20von:\x20',_0x2725d9[_0x53b9c8],_0x8d0019);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x2725d9[_0x53b9c8]+'\x20'+_0x8d0019);}_0x237d4b=Math['round'](++_0x28bbf5/_0x2725d9['length']*0x64),_0x5804f2['sender']['send']('fetch-progress',_0x237d4b,!![],!![]);}}async function fetch_likers_from_post(_0x1bbc38,_0x571d11,_0x438a39,_0x564394,_0x35815f,_0x539575,_0x17f3a2){let _0x32fd42=0x4,_0x530fd3=0x0,_0xd675de=0x0;try{await setCookiesForUser(_0x571d11,_0x539575['username']);}catch(_0x23190e){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x23190e);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x23190e);return handle_fail(0x1);return;}_0xd675de=Math['round'](++_0x530fd3/_0x32fd42*0x64),_0x1bbc38['sender']['send']('fetch-progress',_0xd675de,!![]);try{let _0x4fce71=_0x438a39['substring'](0x0,_0x438a39['lastIndexOf']('/')),_0xf9f61e=_0x4fce71+'/liked_by';console['log'](_0xf9f61e),await _0x571d11['goto'](_0xf9f61e),await delay(0x7d0,0xfa0),await notificationClear(_0x571d11),await delay(0xc8,0x1f4),_0xd675de=Math['round'](++_0x530fd3/_0x32fd42*0x64),_0x1bbc38['sender']['send']('fetch-progress',_0xd675de,!![]),await _0x571d11['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x59b474=await _0x571d11['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x19b7bd=await _0x571d11['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x59b474['length']);let _0xbbf51b=path['join'](__dirname,'/likers.csv');_0xd675de=Math['round'](++_0x530fd3/_0x32fd42*0x64),_0x1bbc38['sender']['send']('fetch-progress',_0xd675de,!![]);_0x564394<=0x0&&(_0x564394=_0x59b474['length']);try{let _0x498ec6=[];for(let _0x8d700=0x0;_0x8d700<_0x59b474['length']&&_0x8d700<_0x564394;_0x8d700++){_0x498ec6['push'](await _0x59b474[_0x8d700]['evaluate'](_0x3a2783=>_0x3a2783['textContent']));try{const _0x5ce51f='INSERT\x20INTO\x20'+_0x35815f+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x5ce51f,[await _0x59b474[_0x8d700]['evaluate'](_0x270626=>_0x270626['textContent']),await _0x19b7bd[_0x8d700]['evaluate'](_0x179a2a=>_0x179a2a['textContent'])],function(_0x3e25f7){_0x3e25f7?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x35815f+'\x27:',_0x3e25f7['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x4efd21){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x8d700+'\x20:\x20'+_0x4efd21);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x8d700+'\x20:\x20'+_0x4efd21);return handle_fail(0x1);}}return _0xd675de=Math['round'](++_0x530fd3/_0x32fd42*0x64),_0x1bbc38['sender']['send']('fetch-progress',_0xd675de,!![]),_0x17f3a2&&(_0x1bbc38['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x1bbc38,_0x571d11,_0x539575,_0x35815f,_0x498ec6)),new Promise(_0x4a21f4=>{_0x4a21f4('Scraping\x20finished!');});}catch(_0x485138){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x485138);return handle_fail(0x1);}}catch(_0x1113e6){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x1113e6);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x1113e6);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x297508,_0x3ea1d9,_0x424046,_0x1abd7c,_0x2a939b,_0x81a5b1,_0x4df2d0){let _0x226777=0x3,_0x2540a6=0x0,_0x2ade9a=0x0;try{await setCookiesForUser(_0x3ea1d9,_0x81a5b1['username']);}catch(_0x1f3156){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x1f3156);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x1f3156);return handle_fail(0x2);}try{console['log'](_0x424046),await _0x3ea1d9['goto'](_0x424046),await delay(0x7d0,0xfa0),await notificationClear(_0x3ea1d9),await delay(0xc8,0x1f4);const _0x10732e=COM_COMMENTS_BOX_BODY_DIV;let _0x254168;const _0xa01ecf=await _0x3ea1d9['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x4e6046=await _0x3ea1d9['evaluate'](_0x1c794b=>_0x1c794b['innerHTML'],_0xa01ecf),_0x45d07b=String(_0x4e6046)['replace'](/[^0-9]/g,''),_0x177ffa=Number(_0x45d07b)/0x14;_0x1abd7c<=0x0?_0x254168=Math['ceil'](_0x177ffa/0x3):_0x254168=Math['ceil'](_0x1abd7c/0x3);_0x226777+=_0x254168,_0x2ade9a=Math['round'](++_0x2540a6/_0x226777*0x64),_0x297508['sender']['send']('fetch-progress',_0x2ade9a,!![]),console['log']('Auto-scrolls:\x20'+_0x254168),await scroll(_0x3ea1d9,_0x10732e,_0x254168,_0xe0dd21=>{_0x2ade9a=Math['round'](++_0x2540a6/_0x226777*0x64),_0x297508['sender']['send']('fetch-progress',_0x2ade9a,!![]);});try{const _0x48289a=COM_REPLY_BUTTON_SPAN;await _0x3ea1d9['waitForSelector'](_0x48289a),await delay(0x1f4,0x320);const _0x5d7552=await _0x3ea1d9['$$'](_0x48289a);console['log'](_0x5d7552);let _0x223398=_0x5d7552['length'];await delay(0xc8,0x1f4);try{for(let _0x442df9=0x0;_0x442df9<_0x223398;_0x442df9++){_0x5d7552[_0x442df9]['click'](),await delay(0x320,0x5dc);}}catch(_0x3f815c){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x3f815c);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x3f815c);return handle_fail(0x2);}}catch(_0x2c98a6){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x40dbad=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x3ea1d9['waitForSelector'](_0x40dbad),await delay(0x1f4,0x320),_0x2ade9a=Math['round'](++_0x2540a6/_0x226777*0x64),_0x297508['sender']['send']('fetch-progress',_0x2ade9a,!![]);const _0x4fc6d5=await _0x3ea1d9['$$'](_0x40dbad);let _0xd4b34f=path['join'](__dirname,'/comments.csv');_0x1abd7c<=0x0&&(_0x1abd7c=_0x4fc6d5['length']);console['log']('fetch_limit:\x20'+_0x1abd7c),console['log']('comments_len:\x20'+_0x4fc6d5['length']),_0x1abd7c++;try{let _0x486f3d=[];for(let _0x1c28cf=0x1;_0x1c28cf<_0x4fc6d5['length']&&_0x1c28cf<_0x1abd7c;_0x1c28cf++){try{_0x486f3d['push'](await _0x4fc6d5[_0x1c28cf]['evaluate'](_0x5bbb86=>_0x5bbb86['textContent']));const _0x3620db=await db['prepare']('INSERT\x20INTO\x20'+_0x2a939b+'\x20(username)\x20VALUES\x20(?)');await _0x3620db['run'](await _0x4fc6d5[_0x1c28cf]['evaluate'](_0x1c78bc=>_0x1c78bc['textContent']),function(_0x6ca992){_0x6ca992&&console['log']('error\x20in\x20add-user:'+_0x6ca992);}),await _0x3620db['finalize']();}catch(_0x2fd74d){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x1c28cf+'\x20:\x20'+_0x2fd74d);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x1c28cf+'\x20:\x20'+_0x2fd74d);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x2ade9a=Math['round'](++_0x2540a6/_0x226777*0x64),_0x297508['sender']['send']('fetch-progress',_0x2ade9a,!![]),_0x297508['sender']['send']('fetch-progress',0x64,!![]),_0x4df2d0&&(_0x297508['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x297508,_0x3ea1d9,_0x81a5b1,_0x2a939b,_0x486f3d)),_0x297508['sender']['send']('fetch-progress',0x64,![]),new Promise(_0xa65211=>{_0xa65211('Scraping\x20finished!');});}catch(_0x425f18){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x425f18);return handle_fail(0x2);}}catch(_0x5bb46c){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x5bb46c);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x5bb46c);return handle_fail(0x2);}}async function set_clearname_from_username(_0x2674d8,_0x56c504,_0x534a37=null){try{let _0x3f128a,_0x2a9b4d;const _0x133e99='SELECT\x20username\x20FROM\x20'+_0x56c504+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x133e99,[],(_0x182094,_0xa1a465)=>{_0x182094&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x182094['message']),_0xa1a465['length']===0x0&&(_0x2a9b4d=_0xa1a465['length']),_0x3f128a=_0xa1a465['map'](_0x17ac63=>_0x17ac63['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x2a9b4d);if(_0x2a9b4d===0x0){console['log']('Leave');return;}const _0x4ba882=await _0x2674d8['waitForSelector'](IG_SEARCH_BUTTON);await _0x4ba882['click'](),await delay(0x4b0,0x7d0);for(let _0x36a80d of _0x3f128a){const _0x5b05b5=await _0x2674d8['waitForSelector'](IG_SEARCH_INPUT);await _0x5b05b5['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x2674d8['type'](IG_SEARCH_INPUT,_0x36a80d,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x6250cb=0x1;while(_0x6250cb!=0x14){console['log']('Schleife');try{let _0x2b94e9=IG_NAME_SPAN_PART1+_0x6250cb+IG_USERNAME_SPAN_PART2;const _0x2f7a5e=await _0x2674d8['waitForSelector'](_0x2b94e9),_0x504b42=await _0x2674d8['evaluate'](_0xfecb50=>_0xfecb50['innerHTML'],_0x2f7a5e);await delay(0xc8,0x1f4);if(_0x504b42==_0x36a80d){let _0x56d6c4=IG_NAME_SPAN_PART1+_0x6250cb+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x7c038f=await _0x2674d8['waitForSelector'](_0x56d6c4);let _0x4fea1d=await _0x2674d8['evaluate'](_0x546216=>_0x546216['innerHTML'],_0x7c038f);const _0x20126a=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x47a434=_0x4fea1d['match'](_0x20126a);_0x47a434?_0x4fea1d=_0x47a434[0x1]['trim']():_0x4fea1d=_0x4fea1d['trim']();_0x4fea1d['includes']('•')&&(_0x4fea1d=_0x4fea1d['substring'](0x0,_0x4fea1d['indexOf']('•')-0x1));const _0x4db421='UPDATE\x20'+_0x56c504+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x4db421,[_0x4fea1d,_0x504b42],function(_0x5f2d02){_0x5f2d02&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x5f2d02['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x6250cb++;}catch(_0x221d09){const _0x46f718='UPDATE\x20'+_0x56c504+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x46f718,['',_0x36a80d],function(_0x562d78){_0x562d78&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x562d78['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x221d09);break;}}_0x534a37&&_0x534a37();}await _0x4ba882['click']();}catch(_0x2c15d2){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x2c15d2);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x15cc4a,_0x230f55)=>{const _0x433b70='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x433b70,[],(_0x1cb940,_0xec435e)=>{_0x1cb940?_0x230f55(_0x1cb940):_0x15cc4a(_0xec435e);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x5b4fd7,_0x58555c)=>{const _0x29adf1='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x29adf1,[],async(_0x552571,_0x473e5b)=>{if(_0x552571)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x552571['message']),_0x58555c({'status':'error','message':_0x552571['message']});else try{const _0x56e5f0=await Promise['all'](_0x473e5b['map'](_0x1ac420=>{return new Promise(_0x5dca3f=>{if(!_0x1ac420['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x1ac420['campaign_name']),_0x5dca3f({'campaign_name':_0x1ac420['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x4358a3='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x1ac420['list_id'],_0x5fa1ae='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x1ac420['list_id']+'\x22';db['get'](_0x4358a3,[],(_0x1af9c,_0x14e440)=>{_0x1af9c?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x1ac420['campaign_name']+':',_0x1af9c['message']),_0x5dca3f({'campaign_name':_0x1ac420['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x5fa1ae,[],(_0x4976a1,_0x238b82)=>{_0x4976a1?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x1ac420['campaign_name']+':',_0x4976a1['message']),_0x5dca3f({'campaign_name':_0x1ac420['campaign_name'],'lead_count':_0x14e440?_0x14e440['lead_count']:0x0,'contacted_count':'N/A'})):_0x5dca3f({'campaign_name':_0x1ac420['campaign_name'],'lead_count':_0x14e440?_0x14e440['lead_count']:0x0,'contacted_count':_0x238b82?_0x238b82['contacted_count']:0x0});});});});}));_0x5b4fd7({'status':'success','campaigns':_0x56e5f0});}catch(_0x4f0c98){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x4f0c98),_0x58555c({'status':'error','message':_0x4f0c98['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x452c79,_0x4bdfa1)=>{return new Promise((_0xb942f4,_0x475610)=>{const _0x4c8c83='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x4c8c83,[_0x4bdfa1],(_0x50e3f4,_0x2876e3)=>{_0x50e3f4?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x50e3f4),_0x475610(_0x50e3f4)):(console['log']('ROWS'),console['log'](_0x2876e3),debugDatabaseContents(),_0xb942f4(_0x2876e3));});});});const showTableContents=_0x30beb0=>{return new Promise((_0x1fb3d9,_0x35ad61)=>{const _0x327372='SELECT\x20*\x20FROM\x20'+_0x30beb0+';';campaignDB['all'](_0x327372,(_0x5a1d91,_0x501bbb)=>{_0x5a1d91?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x30beb0+':',_0x5a1d91),_0x35ad61(_0x5a1d91)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x30beb0+':',_0x501bbb),_0x1fb3d9({'status':'success','message':_0x501bbb}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x4c415e){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x4c415e);}}ipcMain['handle']('create-campaign',async(_0x28efb8,_0x57f939)=>{return new Promise((_0xe18e75,_0x14ce09)=>{const _0x271cd5='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x271cd5,[String(_0x57f939)],function(_0x3b2d9c){_0x3b2d9c?_0x14ce09(_0x3b2d9c):_0xe18e75({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x51ec9b,_0x7556a8)=>{return new Promise((_0x3f5583,_0x439ad5)=>{const _0x5739ed='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x5739ed,[_0x7556a8],function(_0x29a140){_0x29a140?_0x439ad5(_0x29a140):_0x3f5583({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x4ea2e7,_0x125c2e,_0x22051e,_0x4b6175,_0x45c537,_0x5b26ea,_0x4e1b14,_0x3a26be)=>{const _0x2b2c11=await createMessageID(_0x45c537);return new Promise((_0x3f62ab,_0x5183b6)=>{if(!_0x125c2e||!_0x22051e||!_0x4b6175||!_0x2b2c11||!_0x5b26ea)return _0x5183b6({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x2b2c11);const _0x42cb3e='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x42cb3e,[_0x22051e,_0x4b6175,_0x2b2c11,_0x5b26ea,_0x4e1b14,_0x3a26be,_0x125c2e],function(_0x44e395){if(_0x44e395)_0x5183b6({'status':'error','message':_0x44e395['message']});else this['changes']===0x0?_0x5183b6({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x3f62ab({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x52cede,_0x525a83,_0x20e4d1,_0x9a9ad8,_0x4bc586)=>{return new Promise((_0x11ca56,_0x5c6b32)=>{const _0x14049b='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x14049b,[_0x525a83,_0x20e4d1,_0x9a9ad8,_0x4bc586],function(_0x3f74f8){return _0x3f74f8?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x3f74f8['message']),_0x5c6b32('insert-dm-response',{'success':![],'message':_0x3f74f8['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x11ca56('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x589b1a=>{return new Promise((_0x3973a3,_0x3a5ac4)=>{const _0x3276f6='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x3276f6,[_0x589b1a],(_0x22c34e,_0x4ea188)=>{if(_0x22c34e)_0x3a5ac4({'status':'error','message':_0x22c34e['message']});else{if(_0x4ea188)_0x3973a3(_0x4ea188['message_id']);else{const _0x43cbbb='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x43cbbb,[_0x589b1a],function(_0x9b44b9){_0x9b44b9?_0x3a5ac4({'status':'error','message':_0x9b44b9['message']}):_0x3973a3(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x123b54,_0x4ce0d7)=>{return new Promise((_0xf7249a,_0x24d4cf)=>{const _0x432c9a='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x4ce0d7;db['get'](_0x432c9a,(_0x2fadc0,_0x4f3caa)=>{_0x2fadc0?_0x24d4cf({'status':'error','message':_0x2fadc0['message']}):_0xf7249a({'status':'success','count':_0x4f3caa['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x1eb7b8,_0x1c8dd7){try{const _0x155373=await new Promise((_0x5900a2,_0x4d9040)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x1c8dd7],(_0x5a8f3c,_0x13fd00)=>{if(_0x5a8f3c)_0x4d9040(_0x5a8f3c);else{if(_0x13fd00['length']>0x0){let _0x118a19=JSON['parse'](_0x13fd00[0x0]['cookie']);console['log'](_0x118a19),_0x5900a2(_0x118a19);}else _0x4d9040(new Error('User\x20with\x20username\x20'+_0x1c8dd7+'\x20does\x20not\x20exist.'));}});});await _0x1eb7b8['setCookie'](..._0x155373),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0xb81f6){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0xb81f6);}}async function saveCookiesForUser(_0x42caa1,_0x3f1c3c){try{const _0x5cf5a9=await _0x42caa1['cookies']();if(!_0x5cf5a9||_0x5cf5a9['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x3f1c3c);const _0x5e77d1=JSON['stringify'](_0x5cf5a9);if(_0x5e77d1['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x3f1c3c);return new Promise((_0x34edaa,_0x1fdc7f)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x3f1c3c],(_0x389d81,_0x9386df)=>{if(_0x389d81)return console['error']('Error\x20checking\x20user\x20existence:',_0x389d81),_0x1fdc7f(_0x389d81);if(_0x9386df){const _0x3a6695=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x3a6695['run'](_0x5e77d1,_0x3f1c3c,function(_0x9977ed){return _0x9977ed?(console['error']('Error\x20updating\x20cookies:',_0x9977ed),_0x1fdc7f(_0x9977ed)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x3f1c3c),_0x34edaa());});}else{const _0x436559=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x436559['run'](_0x3f1c3c,_0x5e77d1,function(_0x34bfa8){return _0x34bfa8?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x34bfa8),_0x1fdc7f(_0x34bfa8)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x3f1c3c),_0x34edaa());});}});});}catch(_0x1d5f45){console['error']('Error\x20fetching\x20cookies:',_0x1d5f45);throw _0x1d5f45;}}async function createUserIfNotExists(_0xbf4850){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0xbf4850],(_0x58760a,_0x5e4580)=>{if(_0x58760a){console['error']('Error\x20checking\x20user\x20existence:',_0x58760a);throw _0x58760a;}else{if(!_0x5e4580){const _0x312e6f=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x312e6f['run'](_0xbf4850,function(_0x1c7ae5){_0x1c7ae5?console['error']('Error\x20inserting\x20new\x20user:',_0x1c7ae5):console['log']('New\x20user\x20created:',_0xbf4850);});}else console['log']('User\x20already\x20exists:',_0xbf4850);}});}catch(_0x45ae02){console['error']('Error\x20creating\x20user:',_0x45ae02);throw _0x45ae02;}}ipcMain['handle']('create-relation',async(_0x4cb9a3,_0xac39de)=>{return new Promise((_0x47889d,_0x4a7bc1)=>{const _0x27d676='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0xac39de+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x27d676,function(_0x5d90cf){_0x5d90cf?_0x4a7bc1(_0x5d90cf):_0x47889d({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0xcf8804,_0x2c641d)=>{return console['log']('droping\x20table'+_0x2c641d),new Promise((_0x40bc51,_0x342189)=>{const _0x29ddc0='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x2c641d;console['log']('droping\x20table'+_0x2c641d),db['run'](_0x29ddc0,function(_0x3d6e55){_0x3d6e55?_0x342189(_0x3d6e55):_0x40bc51({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x114986=>{return new Promise((_0x265e0e,_0x2e842a)=>{const _0xd5152='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0xd5152,[],(_0xfb63f2,_0x297402)=>{_0xfb63f2?_0x2e842a(_0xfb63f2):_0x265e0e(_0x297402['map'](_0x57980b=>_0x57980b['name']));});});}),ipcMain['handle']('add-user',async(_0xb86d34,_0x5d08fb,_0x45872d)=>{return new Promise(_0x333635=>{const _0x5bacf3=db['prepare']('INSERT\x20INTO\x20'+_0x45872d+'\x20(username)\x20VALUES\x20(?)');_0x5bacf3['run'](_0x5d08fb,function(_0x2abf5b){_0x2abf5b?console['log']('error\x20in\x20add-user:'+_0x2abf5b):_0x333635({'status':'success','id':this['lastID']});}),_0x5bacf3['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x20f40e,_0x51a1df)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x44174d,_0x48170e)=>{if(_0x44174d)_0x51a1df(_0x44174d);else{_0x20f40e({'status':'success','users':_0x48170e});for(_0x48170e of _0x48170e){console['log'](_0x48170e['username']);}}});});}),ipcMain['handle']('get-data',async(_0x5a2c93,_0x183265)=>{return new Promise((_0x4153b0,_0xa3a7e2)=>{const _0x1ca44c='SELECT\x20*\x20FROM\x20'+_0x183265;console['log'](_0x1ca44c),db['all'](_0x1ca44c,[],(_0x3f7fc3,_0x49346b)=>{_0x3f7fc3?_0xa3a7e2(_0x3f7fc3):_0x4153b0(_0x49346b);});});}),ipcMain['handle']('get-accounts',async _0x7ea1ed=>{return new Promise((_0x2683bf,_0x15414b)=>{const _0x1a75c4='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x1a75c4),igaccountsDB['all'](_0x1a75c4,[],(_0x42e026,_0xcd14ac)=>{_0x42e026?_0x15414b(_0x42e026):_0x2683bf(_0xcd14ac);});});}),ipcMain['handle']('get-targets',async(_0x3ec91a,_0x392c52)=>{return getTargetProfiles(_0x392c52);}),ipcMain['handle']('delete-user',async(_0x4ec08f,_0x256b7a,_0x24aefd)=>{return new Promise((_0x2e1922,_0x3c6baa)=>{const _0x428cb9=db['prepare']('DELETE\x20FROM\x20'+_0x24aefd+'\x20WHERE\x20username\x20=\x20?');_0x428cb9['run'](_0x256b7a,function(_0x2156d){_0x2156d?_0x3c6baa(_0x2156d):_0x2e1922({'status':'success','changes':this['changes']});}),_0x428cb9['finalize']();});}),ipcMain['handle']('delete-account',async(_0xc2bb14,_0x4fa4e4)=>{const _0x464eea=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x464eea['run'](_0x4fa4e4,function(_0x57fc63){_0x57fc63&&console['log'](_0x57fc63);}),_0x464eea['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x38b46e,_0x28aca1)=>{const _0x4aea33='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x4aea33,[],(_0x2444bb,_0x21bf95)=>{_0x2444bb?_0x28aca1({'status':'error','message':_0x2444bb['message']}):_0x38b46e({'status':'success','contactedCount':_0x21bf95['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x4cb23f,_0x464710)=>{const _0x5694ed='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x5694ed,[],(_0xd83c6f,_0x3ea0ac)=>{_0xd83c6f?_0x464710({'status':'error','message':_0xd83c6f['message']}):_0x4cb23f({'status':'success','contactedCount':_0x3ea0ac['contactedCount']});});});});function exportDatabase(_0x542161){return new Promise((_0x5d8964,_0x3d663e)=>{const _0xad2d98='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x542161+'\x0a\x20\x20\x20\x20';db['all'](_0xad2d98,[],async(_0xade6f6,_0x7c3357)=>{if(_0xade6f6){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0xade6f6['message']),_0x3d663e(_0xade6f6);return;}if(!_0x7c3357||_0x7c3357['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x5d8964();return;}const _0x27338c=XLSX['utils']['json_to_sheet'](_0x7c3357),_0x4bcd03=XLSX['utils']['sheet_to_csv'](_0x27338c);try{const {canceled:_0x5c5abe,filePath:_0x19f015}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x542161+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x5c5abe||!_0x19f015){console['log']('Speichern\x20abgebrochen.'),_0x5d8964();return;}fs['writeFile'](_0x19f015,_0x4bcd03,'utf8',_0x5c1f7a=>{_0x5c1f7a?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x5c1f7a['message']),_0x3d663e(_0x5c1f7a)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x19f015),_0x5d8964());});}catch(_0x5bc514){console['error']('Fehler\x20im\x20Speicherdialog:',_0x5bc514),_0x3d663e(_0x5bc514);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x8d884d,_0x172d70)=>{shell['openExternal'](_0x172d70);});