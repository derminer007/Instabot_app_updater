const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');async function extractFirstName(_0xbf7171,_0x5d1bb5){try{const _0x4b2af2=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x5d1bb5},'body':JSON['stringify']({'clearname':_0xbf7171})});if(!_0x4b2af2['ok']){const _0x5572fd=await _0x4b2af2['text']();throw new Error(_0x4b2af2['status']+':\x20'+_0x5572fd);}const _0x19abe2=await _0x4b2af2['json']();return _0x19abe2;}catch(_0x11d696){console['error']('Error\x20in\x20extractFirstName:',_0x11d696);throw _0x11d696;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div:has(>\x20div[style=\x22height:\x20auto;\x20overflow:\x20hidden\x20auto;\x22])',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='[style=\x22line-height:\x2018px;\x22]',COM_COMMENTS_BOX_BODY_DIV='div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='//span[contains(.,\x20\x27View\x20all\x27)\x20and\x20contains(.,\x20\x27replies\x27)]',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Message\x27]','div.x9f619.xjbqb8w.x78zum5.x15mokao.x1ga7v0g.x16uus16.xbiv7yw.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div','div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div'],K_OPTIONS_BUTTON=['[aria-label=\x22Options\x22]','section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.x1jfgfrl\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div'],K_EXPAND_MSG_BUTTON='[aria-label=\x22Expand\x22]',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD=['[aria-label=\x22Message\x22]','div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f'],K_SEND_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Send\x27]','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_ALREADY_CHATTED='[aria-label=\x22Like\x22]',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',K_BEITRAG_ARRAY_SELECTOR='._aagv',K_BEITRAG_LIKE_BUTTON='section\x20>\x20span\x20>\x20div\x20>\x20div',K_STORY_ARRAY_SELECTOR='._acaz',K_STORY_LIKE_BUTTON='div.x6s0dn4.x78zum5.x67bb7w\x20>\x20div.x78zum5.xvc5jky\x20>\x20span\x20>\x20div\x20>\x20div',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x151ba9=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x151ba9['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x151ba9['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x599cb2){var _0x52c52b=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x37c2f1){console['log']('window\x20id:'+_0x37c2f1['id']),_0x37c2f1['id']>0x1&&(_0x52c52b=!![]);}),console['log']('child\x20opened\x20='+_0x52c52b);if(!_0x52c52b){const _0x310151=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x310151['loadFile'](_0x599cb2['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x107881=require('fs'),_0x2d9dfd=path['join'](app['getPath']('userData'),'data'),_0x487cca=['campaign.db','crm.db','igaccounts.db'],_0x4ab0a3=[];try{_0x107881['mkdirSync'](_0x2d9dfd,{'recursive':!![]});for(const _0x6b22fb of _0x487cca){const _0x4c899a=path['join'](process['resourcesPath'],'app','build','data',_0x6b22fb),_0x558e54=path['join'](_0x2d9dfd,_0x6b22fb);!_0x107881['existsSync'](_0x558e54)?(_0x107881['copyFileSync'](_0x4c899a,_0x558e54),console['log']('[InitDB]\x20Kopiert\x20'+_0x6b22fb+'\x20nach:\x20'+_0x558e54)):console['log']('[InitDB]\x20'+_0x6b22fb+'\x20existiert\x20bereits:\x20'+_0x558e54),_0x4ab0a3['push'](_0x558e54);}}catch(_0x57edb1){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x57edb1);}return _0x4ab0a3;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x25c8d9,AppUpdate:_0x2f9cde}=require('electron-updater');_0x25c8d9['autoDownload']=![],_0x25c8d9['autoInstallOnAppQuit']=!![],_0x25c8d9['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x25c8d9['on']('update-available',_0x4f38a8=>{console['log']('Update\x20verfügbar:',_0x4f38a8),_0x25c8d9['downloadUpdate']();}),_0x25c8d9['on']('update-downloaded',_0x18da77=>{console['log']('Update\x20heruntergeladen:',_0x18da77),_0x25c8d9['quitAndInstall']();}),_0x25c8d9['on']('error',_0x237d83=>{console['error']('Fehler\x20beim\x20Updaten:',_0x237d83);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x1f8ee,AppUpdate:_0x380325}=require('electron-updater');_0x1f8ee['autoDownload']=![],_0x1f8ee['autoInstallOnAppQuit']=!![],_0x1f8ee['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x1f8ee['on']('update-available',_0x1392c6=>{console['log']('Update\x20verfügbar:',_0x1392c6),_0x1f8ee['downloadUpdate']();}),_0x1f8ee['on']('update-downloaded',_0x3c6b4a=>{console['log']('Update\x20heruntergeladen:',_0x3c6b4a),console['log']('Neustarten\x20zum\x20Updaten');}),_0x1f8ee['on']('error',_0x45d270=>{console['error']('Fehler\x20beim\x20Updaten:',_0x45d270);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let isHeadless=!![],browser_login=null;async function getBrowserPageLogin(){let _0x585a46='',_0x30ea52=null;if(process['platform']==='darwin')_0x585a46=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x585a46=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x585a46}),_0x30ea52=await browser_login['newPage'](),_0x30ea52['setDefaultNavigationTimeout'](0x3a98),_0x30ea52['setDefaultTimeout'](0x3a98),await _0x30ea52['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x30ea52;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x4bdfb6=0x1,_0x35854e=0x0){try{let _0x1c3819='',_0x573654=null;const _0x4246e0=isHeadless;if(process['platform']==='darwin')_0x1c3819=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x1c3819=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x4bdfb6===0x0&&!pageStack[_0x35854e])return browser=await puppeteer['launch']({'headless':_0x4246e0,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x1c3819}),_0x573654=await browser['newPage'](),_0x573654['setDefaultNavigationTimeout'](0x3a98),_0x573654['setDefaultTimeout'](0x3a98),await _0x573654['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x35854e]=_0x573654,_0x573654;return(browser===null||pageStack[_0x35854e]===null||pageStack[_0x35854e]['isClosed']())&&(browser=await puppeteer['launch']({'headless':isHeadless,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x1c3819})),(pageStack[_0x35854e]===null||pageStack[_0x35854e]['isClosed']())&&(_0x573654=await browser['newPage'](),_0x573654['setDefaultNavigationTimeout'](0x3a98),_0x573654['setDefaultTimeout'](0x3a98),await _0x573654['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x35854e]=_0x573654),pageStack[_0x35854e];}catch(_0xcf2cb8){console['error']('Failed\x20to\x20launch\x20browser:',_0xcf2cb8);const _0x9ce808=new Error('Browser\x20konnte\x20nicht\x20gestartet\x20werden.\x20Bitte\x20starte\x20die\x20App\x20neu.\x20:\x20'+_0xcf2cb8);throw _0x9ce808;}}ipcMain['on']('login',async(_0x1fac39,_0x3b8bd8)=>{const _0x509341=await getBrowserPageLogin();await _0x509341['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x509341,_0x3b8bd8),ipcMain['on']('setLoginCookies',async(_0x4086fe,_0x235369)=>{try{await set_login_cookies(_0x509341,_0x235369);}catch(_0x4e547f){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x4e547f);}});}),ipcMain['handle']('set-headless',async(_0x4b8470,_0x5a2a16)=>{return isHeadless=!!_0x5a2a16,console['log']('[MAIN]\x20isHeadless\x20gesetzt\x20auf:',isHeadless),{'ok':!![],'headless':isHeadless};}),ipcMain['handle']('get-headless',async()=>{return{'headless':isHeadless};}),ipcMain['on']('export-relation',async(_0x48084c,_0x197b23)=>{try{await exportDatabase(_0x197b23),_0x48084c['reply']('export-relation-response',{'success':!![]});}catch(_0x388a52){console['error'](_0x388a52),_0x48084c['reply']('export-relation-response',{'success':![],'message':_0x388a52['message']});}}),ipcMain['handle']('sendMessage',async(_0x564a64,_0x6034fc,_0x5bfeff,_0x271dc1,_0x54e2b9,_0xce59cc,_0x4cd706,_0x506f2c,_0xc3f063,_0x202af1,_0x5e4f29,_0x387ee5,_0x4a1b94)=>{isStopping=![];let _0x568da4=null;return _0x4cd706?_0x568da4=await getBrowserPage(_0x54e2b9,_0x506f2c):_0x568da4=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x6034fc),send_message(_0x568da4,_0x6034fc,_0x5bfeff,_0x271dc1,_0x54e2b9,_0xce59cc,_0xc3f063,_0x202af1,_0x5e4f29,_0x387ee5,_0x4a1b94);}),ipcMain['handle']('stop-action',async(_0x162a7e,_0x18babc)=>{isStopping=!![];const _0x540f18=await getBrowserPage(0x1,_0x18babc);await _0x540f18['close']();}),ipcMain['handle']('fetch_followers',async(_0x184267,_0x535a80,_0x16e81f,_0x1ac740,_0x588471,_0x1a5d4f,_0x1db12c)=>{isStopping=![];const _0x566559=await getBrowserPage();return fetch_followers_from_account(_0x184267,_0x566559,_0x535a80,_0x16e81f,_0x1ac740,_0x588471,_0x1a5d4f,_0x1db12c);}),ipcMain['handle']('get-account-details',async(_0x432b17,_0xe32e2f,_0x155a35,_0x1e2814)=>{isStopping=![];const _0xd6db7=await getBrowserPage();return fetch_account_details(_0xd6db7,_0xe32e2f,_0x155a35,_0x1e2814);}),ipcMain['handle']('fetch_likes',async(_0x368a0a,_0x47830,_0x35989e,_0x1ce84c,_0x3dabae,_0x1debff,_0x29bd44)=>{isStopping=![];const _0x4529ca=await getBrowserPage();return fetch_likers_from_post(_0x368a0a,_0x4529ca,_0x47830,_0x35989e,_0x1ce84c,_0x3dabae,_0x1debff,_0x29bd44);}),ipcMain['handle']('fetch_comments',async(_0x46f790,_0xc2dd58,_0x3c578e,_0x132fde,_0xd95efd,_0x2f9a48,_0x26dca0)=>{isStopping=![];const _0x8b4518=await getBrowserPage();return fetch_comments_from_post(_0x46f790,_0x8b4518,_0xc2dd58,_0x3c578e,_0x132fde,_0xd95efd,_0x2f9a48,_0x26dca0);});async function updateAppSilent(){const {spawn:_0x491b3}=require('child_process'),_0x107b09=require('path'),_0x120a0f=require('electron-log');return _0x120a0f['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x2bd42a,_0xf618e6)=>{const {updateElectronApp:_0x1b22ff,UpdateSourceType:_0x2ff885}=require('update-electron-app');_0x1b22ff({'updateSource':{'type':_0x2ff885['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x120a0f}),_0x2bd42a('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x5748a9,_0x4cc8cf)=>{doFullElectronUpdateSilent(),_0x5748a9('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x410631}=require('child_process'),_0x2b95f9=require('path'),_0x1338be=require('electron-log');return _0x1338be['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x4b3378,_0x272299)=>{const {updateElectronApp:_0x5e3edf,UpdateSourceType:_0x3d3f8b}=require('update-electron-app');_0x5e3edf({'updateSource':{'type':_0x3d3f8b['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x1338be}),_0x4b3378('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x20dbeb,_0x1d13d1)=>{doFullElectronUpdate(),_0x20dbeb('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0x231c4c,_0x228884)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x231c4c('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0xef8745=path['join'](__dirname,'mac-updater-intern.sh'),_0x485c80=spawn('/bin/bash',[_0xef8745],{'detached':!![],'stdio':'ignore'});_0x485c80['unref'](),setTimeout(()=>{_0x231c4c('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0x228884(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0x5e0d14=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x20e778,_0x26514a)=>{console['log']('Update\x20Silent:\x20'+_0x26514a);if(_0x26514a){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0x8e38b2,_0x5409f6){return Math['random']()*(_0x5409f6-_0x8e38b2+0x1)+_0x8e38b2;}function delay(_0x43df9f,_0x38ce59){let _0x15e494=getRnd(_0x43df9f,_0x38ce59);return new Promise(function(_0x1f144f){setTimeout(_0x1f144f,_0x15e494);});}async function scroll(_0x87ac5b,_0x135ec6,_0x2041f7=0x2,_0x458e92){const _0x51dc09=await _0x87ac5b['waitForSelector'](_0x135ec6);for(let _0x5586b4=0x0;_0x5586b4<_0x2041f7;_0x5586b4++){console['log']('Scrolling\x20'+_0x5586b4),await _0x87ac5b['evaluate'](_0x3ecc97=>{const _0x3707e0=document['querySelector'](_0x3ecc97);_0x3707e0&&_0x3707e0['scrollBy'](0x0,0x190);},_0x135ec6),await delay(0x320,0x5dc),_0x458e92();}}async function saveCookies(_0x380b61){let _0x484fb4=await _0x380b61['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x484fb4,null,0x2));}async function notificationClear(_0x1b1a33){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xfa0,0x1388),await _0x1b1a33['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x1b1a33['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x22b8cc){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x22b8cc);}}async function getTargetProfiles(_0x6e4c5e){return new Promise((_0x527901,_0x31d005)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x6e4c5e,(_0x358b7a,_0xc7e982)=>{_0x358b7a?_0x31d005(_0x358b7a):_0x527901(_0xc7e982);});});}async function login_legacy(_0x18dbf5,_0x1a2c11,_0x453647){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x18dbf5,_0x1a2c11),await createUserIfNotExists(_0x1a2c11,_0x453647);}catch(_0x5bcaba){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5bcaba);}try{await _0x18dbf5['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x18dbf5['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x18dbf5['click']('button._a9--._ap36._a9_0');}catch(_0x447865){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x18dbf5['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x18dbf5['type']('input[name=\x27username\x27]',_0x1a2c11,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x18dbf5['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x18dbf5['type']('input[name=\x27password\x27]',_0x453647,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x18dbf5['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x18dbf5['click']('button[type=\x27submit\x27]');}catch(_0x5e5c85){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x18dbf5),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x18dbf5,_0x1a2c11);}catch(_0x18b68d){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x18b68d);}}catch(_0x1c9761){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x1c9761);}}async function login(_0x2fa4b1,_0x8cf5ec){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x2fa4b1,_0x8cf5ec),await createUserIfNotExists(_0x8cf5ec);}catch(_0x157a58){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x157a58);}try{await _0x2fa4b1['goto']('https://www.instagram.com/accounts/login/');}catch(_0x57ca47){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x57ca47);}}async function set_login_cookies(_0x5a5bbf,_0x1653d5){try{await saveCookiesForUser(_0x5a5bbf,_0x1653d5);}catch(_0x33ba97){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x33ba97);}}async function waitForXPath(_0x31d2c0,_0x5df529,_0xd98675={}){return await _0x31d2c0['waitForFunction'](_0x2811fe=>{return document['evaluate'](_0x2811fe,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0xd98675,_0x5df529),_0x31d2c0['evaluateHandle'](_0x2a4d93=>document['evaluate'](_0x2a4d93,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x5df529);}async function waitForSelectorWithFallbacks(_0x23a956,_0x517d01,_0x1c87dd={}){!Array['isArray'](_0x517d01)&&(_0x517d01=[_0x517d01]);for(let _0x12a77d=0x0;_0x12a77d<_0x517d01['length'];_0x12a77d++){const _0x7f6402=_0x517d01[_0x12a77d],_0x30747f=_0x7f6402['startsWith']('//')||_0x7f6402['startsWith']('(//');try{console['log']('Versuche\x20'+(_0x30747f?'XPath':'Selector')+'\x20'+(_0x12a77d+0x1)+'/'+_0x517d01['length']+':\x20'+_0x7f6402['substring'](0x0,0x32)+'...');const _0x740086=_0x12a77d===0x0?_0x1c87dd['timeout']||0x1388:0x7d0;let _0xb12cd;if(_0x30747f){const _0x24d0a9=await waitForXPath(_0x23a956,_0x7f6402,{..._0x1c87dd,'timeout':_0x740086});if(!_0x24d0a9)throw new Error('XPath-Element\x20nicht\x20gefunden');_0xb12cd=_0x24d0a9;}else _0xb12cd=await _0x23a956['waitForSelector'](_0x7f6402,{..._0x1c87dd,'timeout':_0x740086});return console['log']((_0x30747f?'XPath':'Selector')+'\x20'+(_0x12a77d+0x1)+'\x20gefunden!'),_0xb12cd;}catch(_0x3268f4){console['log']((_0x30747f?'XPath':'Selector')+'\x20'+(_0x12a77d+0x1)+'\x20nicht\x20gefunden:\x20'+_0x3268f4['message']);if(_0x12a77d===_0x517d01['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x517d01['length']+'\x20Selektoren/XPath\x20konnte\x20gefunden\x20werden:\x20'+_0x3268f4['message']);}}throw new Error('Keine\x20Selektoren/XPath\x20angegeben');}async function waitForXPathAll(_0x5de719,_0x51807d,_0x28f547={}){return await _0x5de719['waitForFunction'](_0x31d3ad=>{return document['evaluate'](_0x31d3ad,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null)['snapshotLength']>0x0;},_0x28f547,_0x51807d),_0x5de719['evaluateHandle'](_0x5f350e=>{const _0x25ce5a=document['evaluate'](_0x5f350e,document,null,XPathResult['ORDERED_NODE_SNAPSHOT_TYPE'],null),_0x524304=[];for(let _0x372e64=0x0;_0x372e64<_0x25ce5a['snapshotLength'];_0x372e64++){_0x524304['push'](_0x25ce5a['snapshotItem'](_0x372e64));}return _0x524304;},_0x51807d)['then'](_0x4e25fc=>_0x4e25fc['getProperties']());}ipcMain['handle']('check-login',async(_0x1c7427,_0x3445d4)=>{if(pageStack[0x0]){try{await pageStack[0x0]['close']();}catch(_0x9022bb){}pageStack[0x0]=null;}if(browser){try{await browser['close']();}catch(_0x29a9c4){}browser=null;}const _0x3c8923=await getBrowserPage(0x0,0x0),_0x1eb5be=await checkCookiesSession(_0x3c8923,_0x3445d4);return _0x1eb5be;});async function checkCookiesSession(_0x1dad78,_0x4b3585){try{await setCookiesForUser(_0x1dad78,_0x4b3585),console['log']('Cookies\x20für\x20'+_0x4b3585+'\x20erfolgreich\x20geladen');}catch(_0x5d0605){return console['error']('Fehler\x20beim\x20Laden\x20der\x20Cookies\x20für\x20'+_0x4b3585+':',_0x5d0605),![];}try{await _0x1dad78['goto']('https://www.instagram.com/',{'timeout':0x3a98});}catch(_0x39d2cb){console['error']('Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x39d2cb);}await delay(0x6a4,0x7d0);try{const _0x38ea9a=await checkLoginStatus(_0x1dad78);return console['log']('Login-Status\x20für\x20'+_0x4b3585+':\x20'+_0x38ea9a),_0x38ea9a;}catch(_0x2a95a2){return console['warn']('Login-Prüfung\x20fehlgeschlagen\x20für\x20'+_0x4b3585+':',_0x2a95a2['message']),![];}}async function checkLoginStatus(_0xe7f86f){const _0x30abbf=['[type=\x22password\x22]','//a[normalize-space(text())=\x27Log\x20In\x27]','//div[@role=\x27button\x27\x20and\x20normalize-space(.)=\x27Log\x20in\x27]','//h3[normalize-space(text())=\x27Something\x20went\x20wrong\x27]'];let _0x27f19f=null;try{_0x27f19f=await waitForSelectorWithFallbacks(_0xe7f86f,_0x30abbf,{'timeout':0x7d0});}catch(_0x111282){return console['log']('Eingeloggt,\x20kein\x20Login\x20notwendig:\x20'+_0x111282),!![];}if(_0x27f19f){console['log']('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return![];}else return console['log']('Eingeloggt,\x20führe\x20keine\x20Login\x20durch'),!![];}async function checkPageExists(_0x3321b2){const _0x87f9a4=['//span[contains(normalize-space(.),\x22Sorry,\x20this\x20page\x20isn\x27t\x20available\x22)]'];let _0x255a8b=null;try{_0x255a8b=await waitForSelectorWithFallbacks(_0x3321b2,_0x87f9a4,{'timeout':0x7d0});}catch(_0x2a92bd){return console['log']('Seite\x20existiert:\x20'+_0x2a92bd),!![];}if(_0x255a8b){console['log']('Angegbene\x20Seite\x20existiert\x20nicht');throw new Error('Angegbene\x20Seite\x20existiert\x20nicht');return![];}else return console['log']('Seite\x20existiert'),!![];}async function likeFirstPost(_0x259279){try{const _0xc7b57c=await _0x259279['$$'](K_BEITRAG_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Posts\x20gefunden:\x20'+_0xc7b57c['length']);if(_0xc7b57c&&_0xc7b57c['length']>0x0){const _0x62e9ee=_0xc7b57c[0x0];await _0x62e9ee['click'](),await delay(0xaf0,0xbb8);const _0x2a9d63=await _0x259279['evaluate'](()=>{const _0x66a65c=document['querySelector']('section\x20>\x20span\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20svg[aria-label=\x22Like\x22]');return!!_0x66a65c;});if(_0x2a9d63){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus');const _0x42a35e=await _0x259279['$$'](K_BEITRAG_LIKE_BUTTON),_0x3afeab=_0x42a35e[0x0];await delay(0x514,0x5dc),await _0x259279['evaluate'](_0x5b985a=>{_0x5b985a['click']();},_0x3afeab);}else console['log']('Beitrag\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x259279['goBack'](),await delay(0x7d0,0x898);}}catch(_0x5e7b4d){console['log']('Fehler\x20beim\x20Liken\x20des\x20ersten\x20Posts:',_0x5e7b4d);throw new Error('Like_Posts:\x20'+_0x5e7b4d);}}async function likeFirstStory(_0x561219){try{const _0x548f85=await _0x561219['$$'](K_STORY_ARRAY_SELECTOR);console['log']('Anzahl\x20der\x20Stories\x20gefunden:\x20'+_0x548f85['length']);if(_0x548f85&&_0x548f85['length']>0x0){const _0x221d42=_0x548f85[0x0];await _0x221d42['click'](),await delay(0xaf0,0xbb8);const _0x584767=await _0x561219['evaluate'](()=>{const _0x37366b=document['querySelector']('[aria-label=\x22Like\x22]');return!!_0x37366b;});if(_0x584767){console['log']('Like-Button\x20gefunden\x20-\x20führe\x20Like\x20aus'),await delay(0x514,0x5dc);try{const _0x1d9c8f=await _0x561219['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0x561219['click'](_0x1d9c8f);}catch(_0x4093c3){console['log']('Direkter\x20Klick\x20fehlgeschlagen,\x20versuche\x20alternative\x20Methoden:',_0x4093c3);try{const _0x3ae4a0=await _0x561219['waitForSelector'](K_STORY_LIKE_BUTTON,{'visible':!![]});await _0x561219['evaluateHandle'](_0x177cc5=>{_0x177cc5['click']();},_0x3ae4a0);}catch(_0x4545ea){console['log']('Evaluatehandle\x20fehlgeschlagen,\x20versuche\x20JS-Click:',_0x4545ea),await _0x561219['evaluate'](()=>{const _0x33e780=document['querySelector']('[aria-label=\x22Like\x22]');if(_0x33e780)_0x33e780['click']();else throw new Error('Element\x20nicht\x20gefunden');});}}}else console['log']('Story\x20wurde\x20bereits\x20geliked\x20-\x20überspringe\x20Like-Aktion');await delay(0x10cc,0x1194),await _0x561219['goBack'](),await delay(0x7d0,0x898);}}catch(_0x5ae338){console['log']('Fehler\x20beim\x20Liken\x20der\x20ersten\x20Story:',_0x5ae338);throw new Error('Like_Storys:\x20'+_0x5ae338);}}async function send_message(_0xec09da,_0x54800c,_0x5c02c4,_0x26c768,_0xed46b0,_0x27bee1,_0x340068,_0xc417e4,_0x409c53,_0x170338,_0x1a0779){return new Promise(async(_0x4ad4aa,_0x49db22)=>{_0x27bee1=_0x27bee1['split'](';'),console['log'](_0x27bee1[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0xed46b0);if(_0x26c768===null||_0x26c768===undefined){console['log']('Nachricht\x20ist\x20null\x20oder\x20undefined'),_0x49db22('Nachricht\x20darf\x20nicht\x20leer\x20sein');return;}try{await setCookiesForUser(_0xec09da,_0x27bee1[0x0]);}catch(_0x43a7be){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x43a7be),_0x4ad4aa({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x43a7be});return;}await delay(0x6a4,0x7d0);try{await _0xec09da['goto']('https://www.instagram.com/'+_0x54800c+'/'),await delay(0x1b58,0x1d4c),await notificationClear(_0xec09da);}catch(_0x3d38ab){_0x4ad4aa({'status':0x1f5,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x3d38ab});return;}try{await checkLoginStatus(_0xec09da);}catch(_0x519911){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x519911),_0x49db22('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');return;}if(_0x409c53==0x1)try{await likeFirstPost(_0xec09da);}catch(_0xf930bd){_0x49db22(_0xf930bd);}if(_0x170338==0x1)try{await likeFirstStory(_0xec09da);}catch(_0x244b52){_0x49db22(_0x244b52);}console['log']('UserSkip:\x20'+_0x340068);if(_0x340068==0x1)try{const _0x500ab3=await _0xec09da['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x402d85=>_0x402d85['textContent']['trim']());console['log'](_0x500ab3);if(_0x500ab3==='Following'||_0x500ab3==='Folge\x20ich')return _0x4ad4aa({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x139a5d){}await delay(0x6a4,0x7d0);try{const _0x108b7f=await waitForSelectorWithFallbacks(_0xec09da,K_DIRECT_MSG_BUTTON);await _0x108b7f['click'](),await delay(0xa8c,0xdac);try{const _0x55de0c=await waitForSelectorWithFallbacks(_0xec09da,K_EXPAND_MSG_BUTTON);await _0x55de0c['click']();}catch(_0x397c76){console['log']('Expand-Button\x20nicht\x20gefunden.\x20Überspringen:\x20'+_0x397c76);}}catch(_0x5acc41){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x5acc41);try{await delay(0xa8c,0xbb8);try{const _0x1c8771=await waitForSelectorWithFallbacks(_0xec09da,K_OPTIONS_BUTTON);await _0x1c8771['click']();}catch(_0x3b224b){console['log']('Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x3b224b),_0x4ad4aa({'status':0x1f6,'message':'Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x3b224b});return;}await delay(0xa8c,0xbb8);const _0x58b6fa=await waitForXPath(_0xec09da,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x58b6fa['click']();}catch(_0x47b0da){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x47b0da),_0x4ad4aa({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x708,0x7d0),await notificationClear(_0xec09da);}catch(_0x2e2da9){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x2e2da9);}try{await delay(0xaf0,0xdac);const _0x23b6d3=await waitForSelectorWithFallbacks(_0xec09da,K_CHAT_INPUT_FIELD,{'timeout':0x3a98});if(_0xc417e4){const _0x1a8985=await _0xec09da['$'](K_ALREADY_CHATTED);if(_0x1a8985)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x54800c),_0x4ad4aa({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x1448b2=await _0xec09da['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x1448b2),_0x26c768=_0x26c768['replace']('{USERNAME}',_0x54800c);let _0x550634;if(_0x26c768['includes']('{NAME}')||_0x26c768['includes']('{name}'))try{const _0x3751cd=await extractFirstName(_0x1448b2,_0x1a0779);console['log']('Response\x20Clearname\x20valid:\x20'+_0x3751cd['valid']),_0x3751cd['valid']?(_0x26c768=_0x26c768['replaceAll'](/{NAME}|{name}/g,_0x3751cd['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x3751cd['name']),_0x550634=_0x3751cd['name']):(_0x26c768=_0x26c768['replaceAll'](/ ?({NAME}|{name})/g,''),_0x550634='UNKNOWN_NAME');}catch(_0x1d5862){console['log'](_0x1d5862['message']),_0x550634=_0x1d5862['message'];const _0x463332=_0x1448b2?_0x1448b2['replace'](/[^\p{L}\s]/gu,''):'',_0x39c135=_0x463332['split']('\x20')[0x0]||'';_0x39c135['length']>0x2&&!_0x39c135['includes']('Instagram')?_0x26c768=_0x26c768['replaceAll'](/{NAME}|{name}/g,_0x39c135):_0x26c768=_0x26c768['replaceAll'](/ ?({NAME}|{name})/g,'');}console['log']('Nachricht\x20vor\x20dem\x20Senden:\x20'+_0x26c768);const _0x4d2e84=_0x26c768['split']('\x0a');await _0x23b6d3['type'](_0x4d2e84[0x0],{'delay':getRnd(0x50,0x78)});for(let _0x3cee0f=0x1;_0x3cee0f<_0x4d2e84['length'];_0x3cee0f++){await _0xec09da['keyboard']['down']('Shift'),await _0xec09da['keyboard']['press']('Enter'),await _0xec09da['keyboard']['up']('Shift'),await delay(0x64,0xc8),_0x4d2e84[_0x3cee0f]['length']>0x0&&await _0x23b6d3['type'](_0x4d2e84[_0x3cee0f],{'delay':getRnd(0x50,0x78)});}console['log']('Nachricht\x20mit\x20Zeilenumbrüchen\x20gesendet'),await delay(0x320,0x3e8);try{const _0x234a55=await waitForSelectorWithFallbacks(_0xec09da,K_SEND_MSG_BUTTON);await _0x234a55['click']();}catch(_0x31b2ad){console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x31b2ad),_0x4ad4aa({'status':0x195,'message':'Send\x20nicht\x20gefunden.\x20Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x54800c+'\x20überspringen.','error':_0x31b2ad['message']});}await delay(0x320,0x3e8),_0x4ad4aa({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x1448b2,'extracted_clearname':_0x550634});}catch(_0x5bab8b){let _0x4b7b9c=_0x5bab8b;console['log']('Fehler\x20beim\x20Senden\x20der\x20Nachricht:\x20'+_0x4b7b9c),_0x4ad4aa({'status':0x1f4,'message':'Error\x20500:\x20'+_0x4b7b9c});}});}function handle_fail(_0x37879a){if(isStopping)return new Promise(_0x11b993=>{_0x11b993('Scraper\x20gestoppt.');});else{let _0x16032a='';switch(_0x37879a){case 0x0:_0x16032a='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x16032a='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x16032a='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x16032a='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x71fd4b,_0x567c9c)=>{_0x567c9c(_0x16032a);});}}async function fetch_account_details(_0x4ceabc,_0x1ba916,_0x48438f,_0x14e07f){try{await setCookiesForUser(_0x4ceabc,_0x48438f['username']);}catch(_0x2f5e01){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2f5e01);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x2f5e01);return handle_fail(0x0);}_0x4ceabc['setDefaultNavigationTimeout'](0x7530),await _0x4ceabc['goto']('https://www.instagram.com/'+_0x1ba916+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x4ceabc);const _0x40ba56=await _0x4ceabc['evaluate'](()=>{const _0x48202f=document['querySelector']('meta[property=\x22og:image\x22]');return _0x48202f?_0x48202f['getAttribute']('content'):null;});await _0x4ceabc['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x5b8dda=await _0x4ceabc['evaluate'](()=>{const _0xabfdb2=document['querySelector']('meta[name=\x22description\x22]');if(!_0xabfdb2)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x19872e=_0xabfdb2['getAttribute']('content');if(!_0x19872e)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x19872e);const _0x2adb6c=/\s*[–-]\s*/,_0x48b1b5=_0x19872e['split'](_0x2adb6c);if(_0x48b1b5['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x44acc2=_0x48b1b5[0x0],_0x4af3be=_0x48b1b5[0x1],_0x216952=_0x44acc2['split'](',\x20');if(_0x216952['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x4b6e80=_0x216952[0x0]['split']('\x20')[0x0],_0x213208=_0x216952[0x1]['split']('\x20')[0x0],_0x4491fc=_0x216952[0x2]['split']('\x20')[0x0];let _0x5a5596='',_0x1d4ac1='';const _0x531dfc='\x20on\x20Instagram:\x20',_0x10d99c=_0x4af3be['split'](_0x531dfc);return _0x5a5596=_0x10d99c[0x0]['trim'](),_0x5a5596=_0x5a5596['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x10d99c['length']>0x1&&(_0x1d4ac1=_0x10d99c[0x1]['trim'](),_0x1d4ac1['startsWith']('\x22')&&_0x1d4ac1['endsWith']('\x22')&&(_0x1d4ac1=_0x1d4ac1['substring'](0x1,_0x1d4ac1['length']-0x1)['trim']()),_0x1d4ac1=_0x1d4ac1['replace'](/&quot;/g,'')['trim']()),{'followers':_0x4b6e80,'following':_0x213208,'posts':_0x4491fc,'nameText':_0x5a5596,'bio':_0x1d4ac1};});console['log']('Extracted\x20profile\x20data:',_0x5b8dda);const _0x4ab483=_0x5b8dda['nameText'],_0x4a70b4=_0x40ba56,_0x235724=_0x5b8dda['bio'],_0x6bccde=_0x5b8dda['followers'],_0x5a9680=_0x5b8dda['following'],_0x2af0e4=_0x5b8dda['posts'],_0x3d2bb2=![],_0x344a05=![],_0x5c9eb9=![],_0x44e084='\x0a\x20\x20INSERT\x20INTO\x20'+_0x14e07f+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x44e084,[_0x1ba916,_0x4ab483,_0x4a70b4,_0x235724,_0x6bccde,_0x5a9680,_0x2af0e4,_0x3d2bb2,_0x344a05,_0x5c9eb9],function(_0x56298a){_0x56298a?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x56298a['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x58c292,_0x3a81de,_0x4ad7d2,_0x3218e9,_0x59076e,_0x1057c0,_0x27a3e6,_0x55c24d){let _0x10cc47=0x4,_0x3a861e=0x0,_0x1472cb=0x0;try{await setCookiesForUser(_0x3a81de,_0x1057c0['username']);}catch(_0x59f6e2){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x59f6e2);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x59f6e2);return handle_fail(0x0);}let _0x4c20f4=0x0;try{await _0x3a81de['goto']('https://www.instagram.com/'+_0x4ad7d2+'/'),await notificationClear(_0x3a81de);try{await checkLoginStatus(_0x3a81de);}catch(_0x52cfaf){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x52cfaf);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x3a81de);}catch(_0x27024a){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x27024a);throw new Error('Username\x20nicht\x20gefunden.\x20Existiert\x20der\x20Account?');}try{if(_0x3218e9<=0x0){const _0x492ba5=await _0x3a81de['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x1456bb=await _0x3a81de['evaluate'](_0xfc674=>_0xfc674['innerHTML'],_0x492ba5);_0x4c20f4=Math['ceil'](_0x1456bb/0x4);}else _0x4c20f4=Math['ceil'](_0x3218e9/0x4);_0x10cc47+=_0x4c20f4,_0x1472cb=Math['round'](++_0x3a861e/_0x10cc47*0x64),_0x58c292['sender']['send']('fetch-progress',_0x1472cb,!![]);let _0x376384=await _0x3a81de['waitForSelector']('a[href=\x22/'+_0x4ad7d2+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x376384['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x4ad7d2+'\x20gesichtet'),_0x1472cb=Math['round'](++_0x3a861e/_0x10cc47*0x64),_0x58c292['sender']['send']('fetch-progress',_0x1472cb,!![]);}catch(_0x11cd7e){console['log']('Follower\x20Liste\x20von\x20'+_0x4ad7d2+'\x20nicht\x20gefunden:'+_0x11cd7e);throw new Error('Follower\x20Liste\x20von\x20'+_0x4ad7d2+'\x20nicht\x20gefunden:'+_0x11cd7e);return handle_fail(0x0);}}catch(_0x24d9d9){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x24d9d9);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x24d9d9);return handle_fail(0x0);}try{await delay(0x12c0,0x1388),console['log']('Auto-scrolls:\x20'+_0x4c20f4);try{await scroll(_0x3a81de,FOLLOWER_FENSTER,_0x4c20f4,_0xa073e=>{});}catch{console['log']('Fallback\x20div:has\x20ausgelöst'),await scroll(_0x3a81de,'div.x6nl9eh.x1a5l9x9.x7vuprf.x1mg3h75.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',_0x4c20f4,_0x197bd0=>{});}_0x1472cb=Math['round'](++_0x3a861e/_0x10cc47*0x64),_0x58c292['sender']['send']('fetch-progress',_0x1472cb,!![]),await _0x3a81de['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x2ec198=await _0x3a81de['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x3095a0=await _0x3a81de['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x1472cb=Math['round'](++_0x3a861e/_0x10cc47*0x64),_0x58c292['sender']['send']('fetch-progress',_0x1472cb,!![]);_0x3218e9<=0x0&&(_0x3218e9=_0x2ec198['length']);let _0x431c18=[];for(let _0x3d9dd4=0x0;_0x3d9dd4<_0x2ec198['length']&&_0x3d9dd4<_0x3218e9;_0x3d9dd4++){const _0x175302=await _0x2ec198[_0x3d9dd4]['evaluate'](_0x571ee9=>_0x571ee9['textContent']),_0x2720b6=await _0x3095a0[_0x3d9dd4]['evaluate'](_0x46c935=>_0x46c935['textContent']);if(_0x55c24d){const _0xd1dc0d=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x1057c0['username'],_0x175302]);if(_0xd1dc0d){console['log']('Skipping\x20already\x20contacted\x20follower:\x20'+_0x175302);continue;}}_0x431c18['push'](_0x175302);const _0x491203='INSERT\x20INTO\x20'+_0x59076e+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x491203,[_0x175302,_0x2720b6],function(_0x2bef4f){_0x2bef4f?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x59076e+'\x27:',_0x2bef4f['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x1472cb=Math['round'](++_0x3a861e/_0x10cc47*0x64),_0x58c292['sender']['send']('fetch-progress',_0x1472cb,!![]),_0x27a3e6&&(_0x58c292['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x58c292,_0x3a81de,_0x1057c0,_0x59076e,_0x431c18)),new Promise(_0x2286b0=>{_0x2286b0('Scraping\x20finished!');});}catch(_0x5a49ef){if(_0x27a3e6)throw new Error(_0x5a49ef);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x4ad7d2+'\x20nicht\x20gefunden:\x20'+_0x5a49ef);return handle_fail(0x0);}}async function fetch_details_from_list(_0x2b0914,_0x6ee3,_0x2db0b4,_0x3c9925,_0x576fd5){let _0x1045c5=0x0,_0x30a4ee=0x0;for(let _0x204e94=0x0;_0x204e94<_0x576fd5['length'];_0x204e94++){console['log']('Processing\x20profile:',_0x576fd5[_0x204e94]);try{await fetch_account_details(_0x6ee3,_0x576fd5[_0x204e94],_0x2db0b4,_0x3c9925);}catch(_0x5180b3){console['error']('Detailed\x20Scraping\x20von:\x20',_0x576fd5[_0x204e94],_0x5180b3);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x576fd5[_0x204e94]+'\x20'+_0x5180b3);}_0x30a4ee=Math['round'](++_0x1045c5/_0x576fd5['length']*0x64),_0x2b0914['sender']['send']('fetch-progress',_0x30a4ee,!![],!![]);}}async function fetch_likers_from_post(_0x14995f,_0x1f9fb2,_0x525ebd,_0x5417d3,_0x311f81,_0x44671b,_0x5a6e14,_0x18ed95){let _0x298450=0x4,_0x146b8f=0x0,_0x191488=0x0;try{await setCookiesForUser(_0x1f9fb2,_0x44671b['username']);}catch(_0x1b7cc5){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x1b7cc5);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x1b7cc5);return handle_fail(0x1);}_0x191488=Math['round'](++_0x146b8f/_0x298450*0x64),_0x14995f['sender']['send']('fetch-progress',_0x191488,!![]);try{let _0x4c574f=_0x525ebd['substring'](0x0,_0x525ebd['lastIndexOf']('/'));_0x4c574f['includes']('/reel/')&&(_0x4c574f=_0x4c574f['replace']('/reel/','/p/'));let _0x35dda9=_0x4c574f+'/liked_by';console['log'](_0x35dda9),await _0x1f9fb2['goto'](_0x35dda9),await delay(0x7d0,0xfa0),await notificationClear(_0x1f9fb2),await delay(0xc8,0x1f4);try{await checkLoginStatus(_0x1f9fb2);}catch(_0x358045){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x358045);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x1f9fb2);}catch(_0x5f2384){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x5f2384);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}_0x191488=Math['round'](++_0x146b8f/_0x298450*0x64),_0x14995f['sender']['send']('fetch-progress',_0x191488,!![]),await _0x1f9fb2['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x45c3e0=await _0x1f9fb2['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x4a920a=await _0x1f9fb2['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x45c3e0['length']);let _0x87a7d7=path['join'](__dirname,'/likers.csv');_0x191488=Math['round'](++_0x146b8f/_0x298450*0x64),_0x14995f['sender']['send']('fetch-progress',_0x191488,!![]);_0x5417d3<=0x0&&(_0x5417d3=_0x45c3e0['length']);try{let _0x230281=[];for(let _0x4380e4=0x0;_0x4380e4<_0x45c3e0['length']&&_0x4380e4<_0x5417d3;_0x4380e4++){const _0x2da220=await _0x45c3e0[_0x4380e4]['evaluate'](_0x2fe014=>_0x2fe014['textContent']),_0x3f585f=await _0x4a920a[_0x4380e4]['evaluate'](_0x18a388=>_0x18a388['textContent']);if(_0x18ed95){const _0x2b545a=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x44671b['username'],_0x2da220]);if(_0x2b545a){console['log']('Skipping\x20already\x20contacted\x20liker:\x20'+_0x2da220);continue;}}_0x230281['push'](_0x2da220);const _0x324514='INSERT\x20INTO\x20'+_0x311f81+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x324514,[_0x2da220,_0x3f585f],function(_0x5338c3){_0x5338c3?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x311f81+'\x27:',_0x5338c3['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x191488=Math['round'](++_0x146b8f/_0x298450*0x64),_0x14995f['sender']['send']('fetch-progress',_0x191488,!![]),_0x5a6e14&&(_0x14995f['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x14995f,_0x1f9fb2,_0x44671b,_0x311f81,_0x230281)),new Promise(_0x5e7154=>{_0x5e7154('Scraping\x20finished!');});}catch(_0x869e6){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x869e6);return handle_fail(0x1);}}catch(_0x55f381){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x55f381);throw new Error('Like-Seite\x20nicht\x20geöffnet:\x20'+_0x55f381);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x348601,_0x1a1da0,_0x2bbccc,_0x382580,_0x2759e5,_0x547839,_0x1599b9,_0x4c88c2){let _0x22e1f6=0x3,_0xbefd42=0x0,_0x59118b=0x0;try{await setCookiesForUser(_0x1a1da0,_0x547839['username']);}catch(_0x3dcd11){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x3dcd11);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x3dcd11);return handle_fail(0x2);}try{console['log'](_0x2bbccc),await _0x1a1da0['goto'](_0x2bbccc),await delay(0x7d0,0xfa0),await notificationClear(_0x1a1da0),await delay(0xc8,0x1f4);const _0x33029d=COM_COMMENTS_BOX_BODY_DIV;try{await checkLoginStatus(_0x1a1da0);}catch(_0x4cb80f){console['log']('Login-Status\x20nicht\x20ok:\x20'+_0x4cb80f);throw new Error('Nicht\x20eingeloggt,\x20bitte\x20neu\x20bei\x20Instagram\x20anmelden');}try{await checkPageExists(_0x1a1da0);}catch(_0x302c49){console['log']('Beitrags-Link\x20nicht\x20gefunden:\x20'+_0x302c49);throw new Error('Beitrags-Link\x20nicht\x20gefunden.\x20Existiert\x20der\x20Beitrag?');}let _0x43e16d;const _0x426e64=await _0x1a1da0['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x1614a6=await _0x1a1da0['evaluate'](_0x191dce=>_0x191dce['innerHTML'],_0x426e64),_0x449939=String(_0x1614a6)['replace'](/[^0-9]/g,''),_0x5206e9=Number(_0x449939)/0x14;_0x382580<=0x0?_0x43e16d=Math['ceil'](_0x5206e9/0x3):_0x43e16d=Math['ceil'](_0x382580/0x3);_0x22e1f6+=_0x43e16d,_0x59118b=Math['round'](++_0xbefd42/_0x22e1f6*0x64),_0x348601['sender']['send']('fetch-progress',_0x59118b,!![]),console['log']('Auto-scrolls:\x20'+_0x43e16d),await scroll(_0x1a1da0,_0x33029d,_0x43e16d,_0x38b41f=>{_0x59118b=Math['round'](++_0xbefd42/_0x22e1f6*0x64),_0x348601['sender']['send']('fetch-progress',_0x59118b,!![]);});try{const _0x11e7d9=COM_REPLY_BUTTON_SPAN,_0x406df6=await waitForXPathAll(_0x1a1da0,_0x11e7d9);console['log']('Reply-Buttons\x20gefunden:\x20ANZAHL:\x20'+_0x406df6['size']),await delay(0x1f4,0x320);let _0xe0e221=_0x406df6['size'],_0x38089d=[];for(const [_0x3a51d6,_0x35278f]of _0x406df6){_0x38089d['push'](_0x35278f);}console['log']('Alle\x20Reply-Buttons:',_0x38089d['length']);try{for(let _0x3c5731=0x0;_0x3c5731<_0xe0e221;_0x3c5731++){await _0x38089d[_0x3c5731]['click'](),await delay(0x320,0x5dc);}}catch(_0x5bbeb7){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x5bbeb7);throw new Error('Nicht\x20auf\x20Replies\x20geklickt:\x20'+_0x5bbeb7);return handle_fail(0x2);}}catch(_0x3abfff){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x16c039=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x1a1da0['waitForSelector'](_0x16c039),await delay(0x1f4,0x320),_0x59118b=Math['round'](++_0xbefd42/_0x22e1f6*0x64),_0x348601['sender']['send']('fetch-progress',_0x59118b,!![]);const _0x3fa868=await _0x1a1da0['$$'](_0x16c039);let _0x41dfa2=path['join'](__dirname,'/comments.csv');_0x382580<=0x0&&(_0x382580=_0x3fa868['length']);console['log']('fetch_limit:\x20'+_0x382580),console['log']('comments_len:\x20'+_0x3fa868['length']),_0x382580++;try{let _0x20bd3f=[];for(let _0x508be9=0x1;_0x508be9<_0x3fa868['length']&&_0x508be9<_0x382580;_0x508be9++){const _0x1dc995=await _0x3fa868[_0x508be9]['evaluate'](_0x1d3590=>_0x1d3590['textContent']);if(_0x4c88c2){const _0x37b5fb=await sqlGet(campaignDB,'SELECT\x20dm_id\x20FROM\x20dm\x20WHERE\x20account=?\x20AND\x20username=?',[_0x547839['username'],_0x1dc995]);if(_0x37b5fb){console['log']('Skipping\x20already\x20contacted\x20commenter:\x20'+_0x1dc995);continue;}}try{_0x20bd3f['push'](_0x1dc995);const _0x566eff='INSERT\x20INTO\x20'+_0x2759e5+'\x20(username)\x20VALUES\x20(?)';db['run'](_0x566eff,[_0x1dc995],function(_0x178362){_0x178362&&console['log']('error\x20in\x20add-user:'+_0x178362);});}catch(_0x570826){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x508be9+'\x20:\x20'+_0x570826);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x508be9+'\x20:\x20'+_0x570826);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x59118b=Math['round'](++_0xbefd42/_0x22e1f6*0x64),_0x348601['sender']['send']('fetch-progress',_0x59118b,!![]),_0x348601['sender']['send']('fetch-progress',0x64,!![]),_0x1599b9&&(_0x348601['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x348601,_0x1a1da0,_0x547839,_0x2759e5,_0x20bd3f)),_0x348601['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x269f18=>{_0x269f18('Scraping\x20finished!');});}catch(_0xc70245){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0xc70245);return handle_fail(0x2);}}catch(_0x56c682){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x56c682);throw new Error('Comments-Seite\x20nicht\x20geöffnet:\x20'+_0x56c682);return handle_fail(0x2);}}async function set_clearname_from_username(_0x5a6d04,_0x2c2c69,_0x3d1616=null){try{let _0x900954,_0x2c8660;const _0x10965d='SELECT\x20username\x20FROM\x20'+_0x2c2c69+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x10965d,[],(_0x34462b,_0x2450c1)=>{_0x34462b&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x34462b['message']),_0x2450c1['length']===0x0&&(_0x2c8660=_0x2450c1['length']),_0x900954=_0x2450c1['map'](_0x2fa617=>_0x2fa617['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x2c8660);if(_0x2c8660===0x0){console['log']('Leave');return;}const _0x3f9d0e=await _0x5a6d04['waitForSelector'](IG_SEARCH_BUTTON);await _0x3f9d0e['click'](),await delay(0x4b0,0x7d0);for(let _0x122839 of _0x900954){const _0x1e29fb=await _0x5a6d04['waitForSelector'](IG_SEARCH_INPUT);await _0x1e29fb['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x5a6d04['type'](IG_SEARCH_INPUT,_0x122839,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x4d74db=0x1;while(_0x4d74db!=0x14){console['log']('Schleife');try{let _0x4513d0=IG_NAME_SPAN_PART1+_0x4d74db+IG_USERNAME_SPAN_PART2;const _0x5d4378=await _0x5a6d04['waitForSelector'](_0x4513d0),_0x40dae6=await _0x5a6d04['evaluate'](_0x334ea0=>_0x334ea0['innerHTML'],_0x5d4378);await delay(0xc8,0x1f4);if(_0x40dae6==_0x122839){let _0x4b21ea=IG_NAME_SPAN_PART1+_0x4d74db+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x3e7ebf=await _0x5a6d04['waitForSelector'](_0x4b21ea);let _0x1bc3fa=await _0x5a6d04['evaluate'](_0x531143=>_0x531143['innerHTML'],_0x3e7ebf);const _0x46a360=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x1ce1ce=_0x1bc3fa['match'](_0x46a360);_0x1ce1ce?_0x1bc3fa=_0x1ce1ce[0x1]['trim']():_0x1bc3fa=_0x1bc3fa['trim']();_0x1bc3fa['includes']('•')&&(_0x1bc3fa=_0x1bc3fa['substring'](0x0,_0x1bc3fa['indexOf']('•')-0x1));const _0x4e1f45='UPDATE\x20'+_0x2c2c69+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x4e1f45,[_0x1bc3fa,_0x40dae6],function(_0xa14118){_0xa14118&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0xa14118['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x4d74db++;}catch(_0x1cd8d5){const _0x22a2d6='UPDATE\x20'+_0x2c2c69+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x22a2d6,['',_0x122839],function(_0x4ede0d){_0x4ede0d&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x4ede0d['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x1cd8d5);break;}}_0x3d1616&&_0x3d1616();}await _0x3f9d0e['click']();}catch(_0x575f2f){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x575f2f);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likePost\x20\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20likeStory\x20\x20\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likePost\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20likeStory\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x318538,_0x580a38)=>{const _0x392e2a='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x392e2a,[],(_0x181df2,_0x4fbc8e)=>{_0x181df2?_0x580a38(_0x181df2):_0x318538(_0x4fbc8e);});});});const sqlGet=(_0x4a5f30,_0x5d0f8b,_0x3e0078=[])=>new Promise((_0x57d97b,_0x54b017)=>_0x4a5f30['get'](_0x5d0f8b,_0x3e0078,(_0x2cac17,_0x26b98c)=>_0x2cac17?_0x54b017(_0x2cac17):_0x57d97b(_0x26b98c))),sqlAll=(_0x246708,_0x1c82b6,_0x55447d=[])=>new Promise((_0x175c7a,_0x2b6432)=>_0x246708['all'](_0x1c82b6,_0x55447d,(_0x106e2a,_0x58d6ce)=>_0x106e2a?_0x2b6432(_0x106e2a):_0x175c7a(_0x58d6ce)));ipcMain['handle']('get-campaign-details',async()=>{try{const _0x497def=await sqlAll(campaignDB,'SELECT\x20campaign_name,\x20list_id,\x20zeitabstand,\x20account\x20FROM\x20campaign'),_0x3d8f58=await Promise['all'](_0x497def['map'](async _0x1c42e5=>{const _0x25cd6d=[];if(!_0x1c42e5['list_id'])_0x25cd6d['push']('Liste');if(!_0x1c42e5['zeitabstand'])_0x25cd6d['push']('Zeitabstand');if(!_0x1c42e5['account'])_0x25cd6d['push']('Instagram\x20Account');if(_0x1c42e5['account'])try{const _0x5c4080=await sqlGet(igaccountsDB,'SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x1c42e5['account']]);if(!_0x5c4080)_0x25cd6d['push']('Instagram\x20Login\x20nicht\x20möglich');else{const _0xda746d=_0x5c4080['cookie']&&_0x5c4080['cookie']['trim']()!==''&&_0x5c4080['cookie']['trim']()!=='[]';if(!_0xda746d)_0x25cd6d['push']('Instagram\x20Login');}}catch(_0x3dd550){console['error']('Account-Prüfung\x20SQL-Fehler:',_0x3dd550['message']),_0x25cd6d['push']('Instagram\x20Account');}let _0x19ec03='N/A',_0x90ec19='N/A';if(!_0x25cd6d['includes']('Liste')){try{const _0x21d8e5=await sqlGet(db,'SELECT\x20COUNT(*)\x20AS\x20lead_count\x20FROM\x20'+_0x1c42e5['list_id']);_0x19ec03=_0x21d8e5?.['lead_count']??0x0;}catch(_0x4ee033){if(/no such table/i['test'](_0x4ee033['message']))_0x25cd6d['push']('Liste\x20nicht\x20vorhanden');}try{const _0x4ef84a=await sqlGet(campaignDB,'SELECT\x20COUNT(*)\x20AS\x20contacted_count\x20FROM\x20dm\x20WHERE\x20list_id\x20=\x20?',[_0x1c42e5['list_id']]);_0x90ec19=_0x4ef84a?.['contacted_count']??0x0;}catch(_0x278f20){}}return{'campaign_name':_0x1c42e5['campaign_name'],'lead_count':_0x19ec03,'contacted_count':_0x90ec19,'status':_0x25cd6d['length']===0x0?'Positiv':'Fehler:\x20'+_0x25cd6d['join'](',\x20')};}));return{'status':'success','campaigns':_0x3d8f58};}catch(_0xa69786){return console['error']('get-campaign-details\x20fehlgeschlagen:',_0xa69786['message']),{'status':'error','message':_0xa69786['message']};}}),ipcMain['handle']('get-campaign-writer-information',async(_0x543d22,_0x2dc2ce)=>{return new Promise((_0x15230a,_0x5aecf6)=>{const _0x5ae7ac='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted,\x20likePost,\x20likeStory\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x5ae7ac,[_0x2dc2ce],(_0x1c6f28,_0x53dbae)=>{_0x1c6f28?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x1c6f28),_0x5aecf6(_0x1c6f28)):(console['log']('ROWS'),console['log'](_0x53dbae),debugDatabaseContents(),_0x15230a(_0x53dbae));});});});const showTableContents=_0x4e5124=>{return new Promise((_0x498f29,_0x3f02f1)=>{const _0x5e6eab='SELECT\x20*\x20FROM\x20'+_0x4e5124+';';campaignDB['all'](_0x5e6eab,(_0x15ac4c,_0x2d9e87)=>{_0x15ac4c?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x4e5124+':',_0x15ac4c),_0x3f02f1(_0x15ac4c)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x4e5124+':',_0x2d9e87),_0x498f29({'status':'success','message':_0x2d9e87}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x206bc1){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x206bc1);}}ipcMain['handle']('create-campaign',async(_0x2b7312,_0x3e7437)=>{return new Promise((_0x15a202,_0x3facff)=>{const _0x30db69='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x30db69,[String(_0x3e7437)],function(_0xa71a2c){_0xa71a2c?_0x3facff(_0xa71a2c):_0x15a202({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x4c2558,_0x40b4d4)=>{return new Promise((_0x335caa,_0x26a6fd)=>{const _0x1c4f47='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x1c4f47,[_0x40b4d4],function(_0x3b7edb){_0x3b7edb?_0x26a6fd(_0x3b7edb):_0x335caa({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x514720,_0x3a3e16,_0x531c95,_0x208353,_0x124aec,_0x104328,_0x1347df,_0x4f8c6f,_0x41260e,_0x12b5d0)=>{const _0x40fa51=await createMessageID(_0x124aec);return new Promise((_0x102735,_0x292deb)=>{console['log']('ZEITABSTAND:\x20'+_0x208353);if(!_0x3a3e16||!_0x531c95||_0x208353===undefined||_0x208353===null||_0x208353===''||!_0x40fa51||!_0x104328)return _0x292deb({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x40fa51);const _0x3060f0='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?,\x20likePost\x20=\x20?,\x20likeStory\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x3060f0,[_0x531c95,_0x208353,_0x40fa51,_0x104328,_0x1347df,_0x4f8c6f,_0x41260e,_0x12b5d0,_0x3a3e16],function(_0x4ff4cc){if(_0x4ff4cc)_0x292deb({'status':'error','message':_0x4ff4cc['message']});else this['changes']===0x0?_0x292deb({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x102735({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x2b424f,_0x51fd81,_0xd6977,_0x213d4f,_0x2f08e9)=>{return new Promise((_0x4dc212,_0x57106f)=>{const _0x30f73f='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x30f73f,[_0x51fd81,_0xd6977,_0x213d4f,_0x2f08e9],function(_0x50c8c7){return _0x50c8c7?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x50c8c7['message']),_0x57106f('insert-dm-response',{'success':![],'message':_0x50c8c7['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x4dc212('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x5af1fd=>{return new Promise((_0x268923,_0x564c6d)=>{const _0x5e8145='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x5e8145,[_0x5af1fd],(_0x3fc631,_0x52d5bb)=>{if(_0x3fc631)_0x564c6d({'status':'error','message':_0x3fc631['message']});else{if(_0x52d5bb)_0x268923(_0x52d5bb['message_id']);else{const _0x1846a5='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x1846a5,[_0x5af1fd],function(_0x10d03f){_0x10d03f?_0x564c6d({'status':'error','message':_0x10d03f['message']}):_0x268923(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x50b31d,_0x58e7be)=>{return new Promise((_0x28b735,_0x24f123)=>{const _0x4a4080='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x58e7be;db['get'](_0x4a4080,(_0x54ca6e,_0x28a81f)=>{_0x54ca6e?_0x24f123({'status':'error','message':_0x54ca6e['message']}):_0x28b735({'status':'success','count':_0x28a81f['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x43b077,_0x336080){try{const _0x4188da=await new Promise((_0x1917e9,_0x52c04f)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x336080],(_0x536db0,_0x438f3c)=>{if(_0x536db0)_0x52c04f(_0x536db0);else{if(_0x438f3c['length']>0x0){let _0x594fe2=JSON['parse'](_0x438f3c[0x0]['cookie']);console['log'](_0x594fe2),_0x1917e9(_0x594fe2);}else _0x52c04f(new Error('User\x20with\x20username\x20'+_0x336080+'\x20does\x20not\x20exist.'));}});});await _0x43b077['setCookie'](..._0x4188da),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x345915){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x345915);}}async function saveCookiesForUser(_0x376bd7,_0xbac618){try{const _0x11ac9c=await _0x376bd7['cookies']();if(!_0x11ac9c||_0x11ac9c['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0xbac618);const _0x22501c=JSON['stringify'](_0x11ac9c);if(_0x22501c['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0xbac618);return new Promise((_0x525d2f,_0x10bc50)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0xbac618],(_0x37ad05,_0x731a7a)=>{if(_0x37ad05)return console['error']('Error\x20checking\x20user\x20existence:',_0x37ad05),_0x10bc50(_0x37ad05);if(_0x731a7a){const _0x38c006=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x38c006['run'](_0x22501c,_0xbac618,function(_0x355eb2){return _0x355eb2?(console['error']('Error\x20updating\x20cookies:',_0x355eb2),_0x10bc50(_0x355eb2)):(console['log']('Cookies\x20updated\x20for\x20user:',_0xbac618),_0x525d2f());});}else{const _0x2dd3de=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x2dd3de['run'](_0xbac618,_0x22501c,function(_0x341809){return _0x341809?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x341809),_0x10bc50(_0x341809)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0xbac618),_0x525d2f());});}});});}catch(_0x43cbfb){console['error']('Error\x20fetching\x20cookies:',_0x43cbfb);throw _0x43cbfb;}}async function createUserIfNotExists(_0xa88766){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0xa88766],(_0x12898f,_0x484167)=>{if(_0x12898f){console['error']('Error\x20checking\x20user\x20existence:',_0x12898f);throw _0x12898f;}else{if(!_0x484167){const _0x4b204f=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x4b204f['run'](_0xa88766,function(_0x40f8f6){_0x40f8f6?console['error']('Error\x20inserting\x20new\x20user:',_0x40f8f6):console['log']('New\x20user\x20created:',_0xa88766);});}else console['log']('User\x20already\x20exists:',_0xa88766);}});}catch(_0x2ad15){console['error']('Error\x20creating\x20user:',_0x2ad15);throw _0x2ad15;}}ipcMain['handle']('create-relation',async(_0x3f122d,_0x392371)=>{return new Promise((_0x1ab99d,_0x1eb3f0)=>{const _0x244631='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x392371+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x244631,function(_0x29fbd1){_0x29fbd1?_0x1eb3f0(_0x29fbd1):_0x1ab99d({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x3660a3,_0x359a90)=>{return console['log']('droping\x20table'+_0x359a90),new Promise((_0x59ab49,_0x1a7afe)=>{const _0x4c79b3='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x359a90;console['log']('droping\x20table'+_0x359a90),db['run'](_0x4c79b3,function(_0x54202b){_0x54202b?_0x1a7afe(_0x54202b):_0x59ab49({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x37d8ac=>{return new Promise((_0x46697b,_0x39d340)=>{const _0x11142c='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x11142c,[],(_0xc69370,_0x5c2365)=>{_0xc69370?_0x39d340(_0xc69370):_0x46697b(_0x5c2365['map'](_0x28f273=>_0x28f273['name']));});});}),ipcMain['handle']('add-user',async(_0x470ba4,_0xaac7e8,_0x775c88)=>{return new Promise(_0x38c173=>{const _0xc7c941=db['prepare']('INSERT\x20INTO\x20'+_0x775c88+'\x20(username)\x20VALUES\x20(?)');_0xc7c941['run'](_0xaac7e8,function(_0x5524d3){_0x5524d3?console['log']('error\x20in\x20add-user:'+_0x5524d3):_0x38c173({'status':'success','id':this['lastID']});}),_0xc7c941['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x74b669,_0x36a5fe)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x3fcad9,_0x15fad1)=>{if(_0x3fcad9)_0x36a5fe(_0x3fcad9);else{_0x74b669({'status':'success','users':_0x15fad1});for(_0x15fad1 of _0x15fad1){console['log'](_0x15fad1['username']);}}});});}),ipcMain['handle']('get-data',async(_0x3a544b,_0x503955)=>{return new Promise((_0x54570c,_0x21bed1)=>{const _0x54892f='SELECT\x20*\x20FROM\x20'+_0x503955;console['log'](_0x54892f),db['all'](_0x54892f,[],(_0x5b34fe,_0x16dffd)=>{_0x5b34fe?_0x21bed1(_0x5b34fe):_0x54570c(_0x16dffd);});});}),ipcMain['handle']('get-accounts',async _0x5d57d8=>{return new Promise((_0x104f3e,_0x17030e)=>{const _0x193e4e='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x193e4e),igaccountsDB['all'](_0x193e4e,[],(_0x422bc6,_0x2dc90d)=>{_0x422bc6?_0x17030e(_0x422bc6):_0x104f3e(_0x2dc90d);});});}),ipcMain['handle']('get-targets',async(_0x3a7c84,_0x43a2bb)=>{return getTargetProfiles(_0x43a2bb);}),ipcMain['handle']('delete-user',async(_0x4fb0aa,_0x7e5e62,_0x5266a9)=>{return new Promise((_0x4205d3,_0x6fa2ce)=>{const _0x5850cb=db['prepare']('DELETE\x20FROM\x20'+_0x5266a9+'\x20WHERE\x20username\x20=\x20?');_0x5850cb['run'](_0x7e5e62,function(_0xff3ea5){_0xff3ea5?_0x6fa2ce(_0xff3ea5):_0x4205d3({'status':'success','changes':this['changes']});}),_0x5850cb['finalize']();});}),ipcMain['handle']('delete-account',async(_0x2030fa,_0x121265)=>{const _0x5d8542=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x5d8542['run'](_0x121265,function(_0x268344){_0x268344&&console['log'](_0x268344);}),_0x5d8542['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0xc432c7,_0x58e8e4)=>{const _0x4a38e0='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x4a38e0,[],(_0x4945c8,_0x3c4d2f)=>{_0x4945c8?_0x58e8e4({'status':'error','message':_0x4945c8['message']}):_0xc432c7({'status':'success','contactedCount':_0x3c4d2f['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x316d8d,_0x45a80b)=>{const _0x52f3ae='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x52f3ae,[],(_0x267849,_0x38a3dd)=>{_0x267849?_0x45a80b({'status':'error','message':_0x267849['message']}):_0x316d8d({'status':'success','contactedCount':_0x38a3dd['contactedCount']});});});});function exportDatabase(_0x24df8){return new Promise((_0xfd914d,_0x4b80a7)=>{const _0x44f159='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x24df8+'\x0a\x20\x20\x20\x20';db['all'](_0x44f159,[],async(_0x2f2a9d,_0x4afb7a)=>{if(_0x2f2a9d){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x2f2a9d['message']),_0x4b80a7(_0x2f2a9d);return;}if(!_0x4afb7a||_0x4afb7a['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0xfd914d();return;}const _0x25760a=XLSX['utils']['json_to_sheet'](_0x4afb7a),_0x51b49c=XLSX['utils']['sheet_to_csv'](_0x25760a);try{const {canceled:_0x18f985,filePath:_0x1fc279}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x24df8+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x18f985||!_0x1fc279){console['log']('Speichern\x20abgebrochen.'),_0xfd914d();return;}fs['writeFile'](_0x1fc279,_0x51b49c,'utf8',_0x3d6a21=>{_0x3d6a21?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x3d6a21['message']),_0x4b80a7(_0x3d6a21)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x1fc279),_0xfd914d());});}catch(_0x1899aa){console['error']('Fehler\x20im\x20Speicherdialog:',_0x1899aa),_0x4b80a7(_0x1899aa);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x25971f,_0x137be7)=>{shell['openExternal'](_0x137be7);});