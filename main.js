const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');async function extractFirstName(_0x44543d,_0x257271){try{const _0x82f1cc=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x257271},'body':JSON['stringify']({'clearname':_0x44543d})});if(!_0x82f1cc['ok']){const _0x29b2ad=await _0x82f1cc['text']();throw new Error(_0x82f1cc['status']+':\x20'+_0x29b2ad);}const _0x20312f=await _0x82f1cc['json']();return _0x20312f;}catch(_0x467d2c){console['error']('Error\x20in\x20extractFirstName:',_0x467d2c);throw _0x467d2c;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div',K_OPTIONS_BUTTON='section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.xs5motx\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD='div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f',K_SEND_MSG_BUTTON='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5',K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x4f22c5=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x4f22c5['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x4f22c5['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x1535a2){var _0x5a1b88=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x255ced){console['log']('window\x20id:'+_0x255ced['id']),_0x255ced['id']>0x1&&(_0x5a1b88=!![]);}),console['log']('child\x20opened\x20='+_0x5a1b88);if(!_0x5a1b88){const _0x1925dc=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x1925dc['loadFile'](_0x1535a2['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));});function initializeDatabase(){const _0x111808=require('fs'),_0x520dd1=path['join'](app['getPath']('userData'),'data'),_0x53e8ac=['campaign.db','crm.db','igaccounts.db'],_0x180624=[];try{_0x111808['mkdirSync'](_0x520dd1,{'recursive':!![]});for(const _0x230171 of _0x53e8ac){const _0x5b0690=path['join'](process['resourcesPath'],'app','build','data',_0x230171),_0x276341=path['join'](_0x520dd1,_0x230171);!_0x111808['existsSync'](_0x276341)?(_0x111808['copyFileSync'](_0x5b0690,_0x276341),console['log']('[InitDB]\x20Kopiert\x20'+_0x230171+'\x20nach:\x20'+_0x276341)):console['log']('[InitDB]\x20'+_0x230171+'\x20existiert\x20bereits:\x20'+_0x276341),_0x180624['push'](_0x276341);}}catch(_0x5af6ea){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x5af6ea);}return _0x180624;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x57bee2,AppUpdate:_0x2e52bf}=require('electron-updater');_0x57bee2['autoDownload']=![],_0x57bee2['autoInstallOnAppQuit']=!![],_0x57bee2['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x57bee2['on']('update-available',_0x224971=>{console['log']('Update\x20verfügbar:',_0x224971),_0x57bee2['downloadUpdate']();}),_0x57bee2['on']('update-downloaded',_0x30950b=>{console['log']('Update\x20heruntergeladen:',_0x30950b),_0x57bee2['quitAndInstall']();}),_0x57bee2['on']('error',_0x3a4535=>{console['error']('Fehler\x20beim\x20Updaten:',_0x3a4535);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x574583,AppUpdate:_0x85ab2}=require('electron-updater');_0x574583['autoDownload']=![],_0x574583['autoInstallOnAppQuit']=!![],_0x574583['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x574583['on']('update-available',_0x47ac33=>{console['log']('Update\x20verfügbar:',_0x47ac33),_0x574583['downloadUpdate']();}),_0x574583['on']('update-downloaded',_0x3b2737=>{console['log']('Update\x20heruntergeladen:',_0x3b2737),console['log']('Neustarten\x20zum\x20Updaten');}),_0x574583['on']('error',_0xac8ec=>{console['error']('Fehler\x20beim\x20Updaten:',_0xac8ec);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x1e9942='',_0x40c1a9=null;if(process['platform']==='darwin')_0x1e9942=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x1e9942=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x1e9942}),_0x40c1a9=await browser_login['newPage'](),_0x40c1a9['setDefaultNavigationTimeout'](0x1d4c),_0x40c1a9['setDefaultTimeout'](0x1d4c),await _0x40c1a9['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x40c1a9;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x2dafbc=0x1,_0x2cf6b2=0x0){let _0x4262d5='',_0x2ac554=null;const _0x22cbe8=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x4262d5=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x4262d5=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x2dafbc===0x0&&!pageStack[_0x2cf6b2])return browser=await puppeteer['launch']({'headless':_0x22cbe8,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x4262d5}),_0x2ac554=await browser['newPage'](),_0x2ac554['setDefaultNavigationTimeout'](0x1d4c),_0x2ac554['setDefaultTimeout'](0x1d4c),await _0x2ac554['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x2cf6b2]=_0x2ac554,_0x2ac554;return(browser===null||pageStack[_0x2cf6b2]===null||pageStack[_0x2cf6b2]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x22cbe8,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x4262d5})),(pageStack[_0x2cf6b2]===null||pageStack[_0x2cf6b2]['isClosed']())&&(_0x2ac554=await browser['newPage'](),_0x2ac554['setDefaultNavigationTimeout'](0x1d4c),_0x2ac554['setDefaultTimeout'](0x1d4c),await _0x2ac554['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x2cf6b2]=_0x2ac554),pageStack[_0x2cf6b2];}ipcMain['on']('login',async(_0x112246,_0x5139ee)=>{const _0x2486e8=await getBrowserPageLogin();await _0x2486e8['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x2486e8,_0x5139ee),ipcMain['on']('setLoginCookies',async(_0xdab5a7,_0x312479)=>{try{await set_login_cookies(_0x2486e8,_0x312479);}catch(_0x329b6a){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x329b6a);}});}),ipcMain['on']('export-relation',async(_0x639422,_0x56115a)=>{try{await exportDatabase(_0x56115a),_0x639422['reply']('export-relation-response',{'success':!![]});}catch(_0x55c6f4){console['error'](_0x55c6f4),_0x639422['reply']('export-relation-response',{'success':![],'message':_0x55c6f4['message']});}}),ipcMain['handle']('sendMessage',async(_0x1e27b5,_0x165182,_0x177475,_0x43550a,_0x527a36,_0x3dab9e,_0xaa2c9e,_0x214dac,_0x111d35,_0x54275f,_0x328c2f)=>{isStopping=![];let _0x45e37f=null;return _0xaa2c9e?_0x45e37f=await getBrowserPage(_0x527a36,_0x214dac):_0x45e37f=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x165182),send_message(_0x45e37f,_0x165182,_0x177475,_0x43550a,_0x527a36,_0x3dab9e,_0x111d35,_0x54275f,_0x328c2f);}),ipcMain['handle']('stop-action',async(_0x4f5a90,_0x1319dd)=>{isStopping=!![];const _0x4807af=await getBrowserPage(0x1,_0x1319dd);await _0x4807af['close']();}),ipcMain['handle']('fetch_followers',async(_0x25436b,_0x3fa852,_0x2c8cc,_0x3adce0,_0x2a11f8,_0x33566e)=>{isStopping=![];const _0x3eb4c7=await getBrowserPage();return fetch_followers_from_account(_0x25436b,_0x3eb4c7,_0x3fa852,_0x2c8cc,_0x3adce0,_0x2a11f8,_0x33566e);}),ipcMain['handle']('get-account-details',async(_0x323e66,_0x1bc681,_0x526cd6,_0x4f2681)=>{isStopping=![];const _0x29a742=await getBrowserPage();return fetch_account_details(_0x29a742,_0x1bc681,_0x526cd6,_0x4f2681);}),ipcMain['handle']('fetch_likes',async(_0x27562c,_0x3ea7ba,_0x5872a4,_0x4ccd35,_0x44cb7e,_0x5f4d4b)=>{isStopping=![];const _0x6fadb9=await getBrowserPage();return fetch_likers_from_post(_0x27562c,_0x6fadb9,_0x3ea7ba,_0x5872a4,_0x4ccd35,_0x44cb7e,_0x5f4d4b);}),ipcMain['handle']('fetch_comments',async(_0xede206,_0x8565cd,_0x48e781,_0x11b30d,_0x1a83d0,_0x193ae1)=>{isStopping=![];const _0x24c220=await getBrowserPage();return fetch_comments_from_post(_0xede206,_0x24c220,_0x8565cd,_0x48e781,_0x11b30d,_0x1a83d0,_0x193ae1);});async function updateAppSilent(){const {spawn:_0x7aab24}=require('child_process'),_0xe1af55=require('path'),_0x2b586e=require('electron-log');return _0x2b586e['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x47b0d8,_0x4aef3a)=>{const {updateElectronApp:_0x46018f,UpdateSourceType:_0x2af6d0}=require('update-electron-app');_0x46018f({'updateSource':{'type':_0x2af6d0['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x2b586e}),_0x47b0d8('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x5c1f93,_0x48813c)=>{doFullElectronUpdateSilent(),_0x5c1f93('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x4cecd0}=require('child_process'),_0x36549c=require('path'),_0x5797cb=require('electron-log');return _0x5797cb['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x5c1e83,_0x35925d)=>{const {updateElectronApp:_0x244ad2,UpdateSourceType:_0x41207a}=require('update-electron-app');_0x244ad2({'updateSource':{'type':_0x41207a['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x5797cb}),_0x5c1e83('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x433a53,_0x4ee13f)=>{doFullElectronUpdate(),_0x433a53('Update\x20erfolgreich\x20abgeschlossen.');});}ipcMain['handle']('update-app',async(_0x5ec20b,_0x3f0daa)=>{console['log']('Update\x20Silent:\x20'+_0x3f0daa);if(_0x3f0daa)!(process['platform']==='darwin')&&(await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet'));else{if(!(process['platform']==='darwin'))await updateApp();else return new Promise((_0x44629e,_0xf3cbf9)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x44629e('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x20494b=path['join'](__dirname,'mac-updater-intern.sh'),_0x873889=spawn('/bin/bash',[_0x20494b]);_0x873889['stdout']['on']('data',_0x102438=>{console['log']('stdout:\x20'+_0x102438);}),_0x873889['stderr']['on']('data',_0x19a418=>{console['error']('stderr:\x20'+_0x19a418);}),_0x873889['on']('close',_0x1ee008=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x1ee008),_0x1ee008===0x0?_0x44629e('Update\x20erfolgreich\x20abgeschlossen.'):_0xf3cbf9(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x1ee008));});}else{if(process['platform']==='win32'){const _0x19055d=path['join'](__dirname,'../','../','../');process['chdir'](_0x19055d),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x4d8809='soft-ui-updater-windows.ps1',_0x5a91f6=spawn('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x4d8809]);_0x5a91f6['stdout']['on']('data',_0xc4c69d=>{console['log']('stdout:\x20'+_0xc4c69d);}),_0x5a91f6['stderr']['on']('data',_0x55314f=>{console['error']('stderr:\x20'+_0x55314f);}),_0x5a91f6['on']('close',_0x38c4cb=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x38c4cb),_0x38c4cb===0x0?_0x44629e('Update\x20erfolgreich\x20abgeschlossen.'):_0xf3cbf9(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x38c4cb));});}else _0xf3cbf9(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}});function getRnd(_0x4c8f6d,_0x4556a9){return Math['random']()*(_0x4556a9-_0x4c8f6d+0x1)+_0x4c8f6d;}function delay(_0x2ffb7,_0xb9cd28){let _0x3f2321=getRnd(_0x2ffb7,_0xb9cd28);return new Promise(function(_0x2744bd){setTimeout(_0x2744bd,_0x3f2321);});}async function scroll(_0x57f998,_0x138610,_0x490b56=0x2,_0x5de58c){const _0x5cb236=await _0x57f998['waitForSelector'](_0x138610);for(let _0x3e9f28=0x0;_0x3e9f28<_0x490b56;_0x3e9f28++){console['log']('Scrolling\x20'+_0x3e9f28),await _0x57f998['evaluate'](_0x340548=>{const _0xfb1cce=document['querySelector'](_0x340548);_0xfb1cce&&_0xfb1cce['scrollBy'](0x0,0x190);},_0x138610),await delay(0x320,0x5dc),_0x5de58c();}}async function saveCookies(_0x193d71){let _0x5acc6b=await _0x193d71['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x5acc6b,null,0x2));}async function notificationClear(_0x3537ed){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x3537ed['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x3537ed['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x5b6b3e){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x5b6b3e);}}async function getTargetProfiles(_0x3e7de5){return new Promise((_0x38e92f,_0x384dbe)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x3e7de5,(_0x32ca97,_0x2fa2e1)=>{_0x32ca97?_0x384dbe(_0x32ca97):_0x38e92f(_0x2fa2e1);});});}async function login_legacy(_0x3e1f5e,_0x4cd014,_0xdd3370){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x3e1f5e,_0x4cd014),await createUserIfNotExists(_0x4cd014,_0xdd3370);}catch(_0x2d24c2){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x2d24c2);}try{await _0x3e1f5e['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x3e1f5e['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x3e1f5e['click']('button._a9--._ap36._a9_0');}catch(_0x305209){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x3e1f5e['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x3e1f5e['type']('input[name=\x27username\x27]',_0x4cd014,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x3e1f5e['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x3e1f5e['type']('input[name=\x27password\x27]',_0xdd3370,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x3e1f5e['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x3e1f5e['click']('button[type=\x27submit\x27]');}catch(_0x3ef774){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x3e1f5e),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x3e1f5e,_0x4cd014);}catch(_0x1db4f0){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x1db4f0);}}catch(_0x35a25e){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x35a25e);}}async function login(_0x7270af,_0x26c08a){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x7270af,_0x26c08a),await createUserIfNotExists(_0x26c08a);}catch(_0x38c152){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x38c152);}try{await _0x7270af['goto']('https://www.instagram.com/accounts/login/');}catch(_0x4a98cd){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x4a98cd);}}async function set_login_cookies(_0xc65195,_0x4f8f53){try{await saveCookiesForUser(_0xc65195,_0x4f8f53);}catch(_0x396197){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x396197);}}async function waitForXPath(_0x22219d,_0xec556e,_0x1f924a={}){return await _0x22219d['waitForFunction'](_0x1d536f=>{return document['evaluate'](_0x1d536f,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x1f924a,_0xec556e),_0x22219d['evaluateHandle'](_0x4f323b=>document['evaluate'](_0x4f323b,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0xec556e);}async function send_message(_0x470e96,_0x527455,_0x493b06,_0x145d5f,_0xb5fe43,_0x52a909,_0x38747e,_0x51a585,_0x57ab63){return new Promise(async(_0x5ae3e8,_0x1d7626)=>{_0x52a909=_0x52a909['split'](';'),console['log'](_0x52a909[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0xb5fe43);try{await setCookiesForUser(_0x470e96,_0x52a909[0x0]);}catch(_0x1bd0d5){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x1bd0d5),_0x1d7626({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x1bd0d5});return;}try{await _0x470e96['goto']('https://www.instagram.com/'+_0x527455+'/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x470e96);}catch(_0x272265){_0x1d7626({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x272265});return;}console['log']('UserSkip:\x20'+_0x38747e);if(_0x38747e==0x1)try{const _0x118786=await _0x470e96['$eval']('._ap3a._aaco._aacw._aad6._aade',_0xeb9810=>_0xeb9810['textContent']['trim']());console['log'](_0x118786);if(_0x118786==='Following'||_0x118786==='Folge\x20ich')return _0x5ae3e8({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0x2cc52e){}try{await _0x470e96['waitForSelector'](K_DIRECT_MSG_BUTTON),await _0x470e96['click'](K_DIRECT_MSG_BUTTON);}catch(_0x85385a){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x85385a);try{await _0x470e96['waitForSelector'](K_OPTIONS_BUTTON),await _0x470e96['click'](K_OPTIONS_BUTTON),await delay(0x1f4,0x320);const _0x23b3c7=await waitForXPath(_0x470e96,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x23b3c7['click']();}catch(_0x1693bb){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x1693bb),_0x5ae3e8({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x470e96);}catch(_0x515dc6){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x515dc6);}try{const _0x3162cb=await _0x470e96['waitForSelector'](K_CHAT_INPUT_FIELD);if(_0x51a585){const _0x175111=await _0x470e96['$']('div.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x6ikm8r.x10wlt62');if(_0x175111)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0x527455),_0x5ae3e8({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x272ddc=await _0x470e96['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x272ddc),_0x145d5f=_0x145d5f['replace']('{USERNAME}',_0x527455);let _0x59bbb9;if(_0x145d5f['includes']('{NAME}')||_0x145d5f['includes']('{name}'))try{const _0x499355=await extractFirstName(_0x272ddc,_0x57ab63);console['log']('Response\x20Clearname\x20valid:\x20'+_0x499355['valid']),_0x499355['valid']?(_0x145d5f=_0x145d5f['replaceAll'](/{NAME}|{name}/g,_0x499355['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x499355['name']),_0x59bbb9=_0x499355['name']):(_0x145d5f=_0x145d5f['replaceAll'](/ ?({NAME}|{name})/g,''),_0x59bbb9='UNKNOWN_NAME');}catch(_0x2592d3){console['log'](_0x2592d3['message']),_0x59bbb9=_0x2592d3['message'];let _0x45abdb=_0x272ddc['replace'](/[^\p{L}\s]/gu,''),_0x544df0=_0x45abdb['split']('\x20')[0x0];_0x544df0['length']>0x2&&!_0x544df0['includes']('Instagram')?_0x145d5f=_0x145d5f['replaceAll'](/{NAME}|{name}/g,_0x544df0):_0x145d5f=_0x145d5f['replaceAll'](/ ?({NAME}|{name})/g,'');}await _0x3162cb['type'](_0x145d5f,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0x356a42=await _0x470e96['waitForSelector'](K_SEND_MSG_BUTTON);await _0x356a42['click'](),await delay(0x320,0x3e8),_0x5ae3e8({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x272ddc,'extracted_clearname':_0x59bbb9});}catch(_0x33faad){try{await _0x470e96['waitForSelector'](K_MSG_DISABLED_LABEL);const _0x58272=await _0x470e96['evaluate'](_0x1fa46e=>{return document['querySelector'](_0x1fa46e)['textContent'];},K_MSG_DISABLED_LABEL);console['log']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20gefunden:\x20'+_0x58272),console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x33faad),_0x5ae3e8({'status':0x195,'message':'Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0x527455+'\x20überspringen.'});}catch(_0x960acc){console['error']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20nicht\x20gefunden:\x20'+_0x960acc),console['error']('Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x527455+'\x20:\x20'+_0x960acc),_0x5ae3e8({'status':0x196,'message':'Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0x527455+'\x20:\x20'+_0x960acc});}}});}function handle_fail(_0x10805b){if(isStopping)return new Promise(_0x186ca0=>{_0x186ca0('Scraper\x20gestoppt.');});else{let _0x1b45cf='';switch(_0x10805b){case 0x0:_0x1b45cf='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x1b45cf='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x1b45cf='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x1b45cf='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x5910da,_0x3460ef)=>{_0x3460ef(_0x1b45cf);});}}async function fetch_account_details(_0xccbe28,_0x54c9b1,_0x2e65ab,_0x2f1788){try{await setCookiesForUser(_0xccbe28,_0x2e65ab['username']);}catch(_0x376883){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x376883);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x376883);return handle_fail(0x0);}_0xccbe28['setDefaultNavigationTimeout'](0x7530),await _0xccbe28['goto']('https://www.instagram.com/'+_0x54c9b1+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0xccbe28);const _0x13d769=await _0xccbe28['evaluate'](()=>{const _0x59da97=document['querySelector']('meta[property=\x22og:image\x22]');return _0x59da97?_0x59da97['getAttribute']('content'):null;});await _0xccbe28['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x10f2a2=await _0xccbe28['evaluate'](()=>{const _0x6af9ae=document['querySelector']('meta[name=\x22description\x22]');if(!_0x6af9ae)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x33ece7=_0x6af9ae['getAttribute']('content');if(!_0x33ece7)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x33ece7);const _0x40cf87=/\s*[–-]\s*/,_0x5ea837=_0x33ece7['split'](_0x40cf87);if(_0x5ea837['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x26bc3f=_0x5ea837[0x0],_0x2d9eab=_0x5ea837[0x1],_0x35b7fd=_0x26bc3f['split'](',\x20');if(_0x35b7fd['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x4465f4=_0x35b7fd[0x0]['split']('\x20')[0x0],_0x4bd868=_0x35b7fd[0x1]['split']('\x20')[0x0],_0x1b9d76=_0x35b7fd[0x2]['split']('\x20')[0x0];let _0x5a334d='',_0x3953f5='';const _0x4bd7ba='\x20on\x20Instagram:\x20',_0x1d16e7=_0x2d9eab['split'](_0x4bd7ba);return _0x5a334d=_0x1d16e7[0x0]['trim'](),_0x5a334d=_0x5a334d['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x1d16e7['length']>0x1&&(_0x3953f5=_0x1d16e7[0x1]['trim'](),_0x3953f5['startsWith']('\x22')&&_0x3953f5['endsWith']('\x22')&&(_0x3953f5=_0x3953f5['substring'](0x1,_0x3953f5['length']-0x1)['trim']()),_0x3953f5=_0x3953f5['replace'](/&quot;/g,'')['trim']()),{'followers':_0x4465f4,'following':_0x4bd868,'posts':_0x1b9d76,'nameText':_0x5a334d,'bio':_0x3953f5};});console['log']('Extracted\x20profile\x20data:',_0x10f2a2);const _0xac3f75=_0x10f2a2['nameText'],_0x37244a=_0x13d769,_0x5b0205=_0x10f2a2['bio'],_0x59a07c=_0x10f2a2['followers'],_0x5a1b49=_0x10f2a2['following'],_0x24bd72=_0x10f2a2['posts'],_0x5f0413=![],_0x5258d3=![],_0x1252dd=![],_0x489263='\x0a\x20\x20INSERT\x20INTO\x20'+_0x2f1788+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x489263,[_0x54c9b1,_0xac3f75,_0x37244a,_0x5b0205,_0x59a07c,_0x5a1b49,_0x24bd72,_0x5f0413,_0x5258d3,_0x1252dd],function(_0x1fe395){_0x1fe395?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x1fe395['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x4b9736,_0x6ce22c,_0x7e434b,_0x85ba61,_0x511aa8,_0x4ef801,_0x3e41a2){let _0x5b8ace=0x4,_0x120677=0x0,_0xbfb8c5=0x0;try{await setCookiesForUser(_0x6ce22c,_0x4ef801['username']);}catch(_0xb8e113){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0xb8e113);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0xb8e113);return handle_fail(0x0);}let _0x26bfdb=0x0;try{await _0x6ce22c['goto']('https://www.instagram.com/'+_0x7e434b+'/'),await notificationClear(_0x6ce22c);try{if(_0x85ba61<=0x0){const _0x34744f=await _0x6ce22c['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x255173=await _0x6ce22c['evaluate'](_0x4eadbb=>_0x4eadbb['innerHTML'],_0x34744f);_0x26bfdb=Math['ceil'](_0x255173/0x4);}else _0x26bfdb=Math['ceil'](_0x85ba61/0x4);_0x5b8ace+=_0x26bfdb,_0xbfb8c5=Math['round'](++_0x120677/_0x5b8ace*0x64),_0x4b9736['sender']['send']('fetch-progress',_0xbfb8c5,!![]);let _0x1eb70c=await _0x6ce22c['waitForSelector']('a[href=\x22/'+_0x7e434b+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x1eb70c['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x7e434b+'\x20gesichtet'),_0xbfb8c5=Math['round'](++_0x120677/_0x5b8ace*0x64),_0x4b9736['sender']['send']('fetch-progress',_0xbfb8c5,!![]);}catch(_0x1675cc){console['log']('Follower\x20Liste\x20von\x20'+_0x7e434b+'\x20nicht\x20gefunden:'+_0x1675cc);throw new Error('Follower\x20Liste\x20von\x20'+_0x7e434b+'\x20nicht\x20gefunden:'+_0x1675cc);return handle_fail(0x0);}}catch(_0x23edc9){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x23edc9);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x23edc9);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x26bfdb),await scroll(_0x6ce22c,FOLLOWER_FENSTER,_0x26bfdb,_0x206d5f=>{_0xbfb8c5=Math['round'](++_0x120677/_0x5b8ace*0x64),_0x4b9736['sender']['send']('fetch-progress',_0xbfb8c5,!![]);}),await _0x6ce22c['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x5682f9=await _0x6ce22c['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x1854bf=await _0x6ce22c['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0xbfb8c5=Math['round'](++_0x120677/_0x5b8ace*0x64),_0x4b9736['sender']['send']('fetch-progress',_0xbfb8c5,!![]);_0x85ba61<=0x0&&(_0x85ba61=_0x5682f9['length']);let _0x406b80=[];for(let _0x1adfd3=0x0;_0x1adfd3<_0x5682f9['length']&&_0x1adfd3<_0x85ba61;_0x1adfd3++){_0x406b80['push'](await _0x5682f9[_0x1adfd3]['evaluate'](_0x644707=>_0x644707['textContent']));const _0x4038a9='INSERT\x20INTO\x20'+_0x511aa8+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x4038a9,[await _0x5682f9[_0x1adfd3]['evaluate'](_0x1852e7=>_0x1852e7['textContent']),await _0x1854bf[_0x1adfd3]['evaluate'](_0x2d3807=>_0x2d3807['textContent'])],function(_0x55fa92){_0x55fa92?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x511aa8+'\x27:',_0x55fa92['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0xbfb8c5=Math['round'](++_0x120677/_0x5b8ace*0x64),_0x4b9736['sender']['send']('fetch-progress',_0xbfb8c5,!![]),_0x3e41a2&&(_0x4b9736['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x4b9736,_0x6ce22c,_0x4ef801,_0x511aa8,_0x406b80)),new Promise(_0x546f78=>{_0x546f78('Scraping\x20finished!');});}catch(_0x4d538d){if(_0x3e41a2)throw new Error(_0x4d538d);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x7e434b+'\x20nicht\x20gefunden:\x20'+_0x4d538d);return handle_fail(0x0);}}async function fetch_details_from_list(_0x55176e,_0x2f3bc0,_0x3092d2,_0x5f0a3f,_0x37d771){let _0x3f8ec9=0x0,_0x33eabd=0x0;for(let _0x396558=0x0;_0x396558<_0x37d771['length'];_0x396558++){console['log']('Processing\x20profile:',_0x37d771[_0x396558]);try{await fetch_account_details(_0x2f3bc0,_0x37d771[_0x396558],_0x3092d2,_0x5f0a3f);}catch(_0x33229b){console['error']('Detailed\x20Scraping\x20von:\x20',_0x37d771[_0x396558],_0x33229b);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x37d771[_0x396558]+'\x20'+_0x33229b);}_0x33eabd=Math['round'](++_0x3f8ec9/_0x37d771['length']*0x64),_0x55176e['sender']['send']('fetch-progress',_0x33eabd,!![],!![]);}}async function fetch_likers_from_post(_0x15556d,_0x2d8dad,_0x23b8a5,_0x2460ec,_0x45358a,_0x5e1a0e,_0x4d5d51){let _0x3c4f8e=0x4,_0x5c1433=0x0,_0xd3f654=0x0;try{await setCookiesForUser(_0x2d8dad,_0x5e1a0e['username']);}catch(_0x4a8af6){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4a8af6);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x4a8af6);return handle_fail(0x1);return;}_0xd3f654=Math['round'](++_0x5c1433/_0x3c4f8e*0x64),_0x15556d['sender']['send']('fetch-progress',_0xd3f654,!![]);try{let _0x7504bb=_0x23b8a5['substring'](0x0,_0x23b8a5['lastIndexOf']('/')),_0x2d738e=_0x7504bb+'/liked_by';console['log'](_0x2d738e),await _0x2d8dad['goto'](_0x2d738e),await delay(0x7d0,0xfa0),await notificationClear(_0x2d8dad),await delay(0xc8,0x1f4),_0xd3f654=Math['round'](++_0x5c1433/_0x3c4f8e*0x64),_0x15556d['sender']['send']('fetch-progress',_0xd3f654,!![]),await _0x2d8dad['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x509a6b=await _0x2d8dad['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x200419=await _0x2d8dad['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x509a6b['length']);let _0x38079c=path['join'](__dirname,'/likers.csv');_0xd3f654=Math['round'](++_0x5c1433/_0x3c4f8e*0x64),_0x15556d['sender']['send']('fetch-progress',_0xd3f654,!![]);_0x2460ec<=0x0&&(_0x2460ec=_0x509a6b['length']);try{let _0x2421b2=[];for(let _0x548aca=0x0;_0x548aca<_0x509a6b['length']&&_0x548aca<_0x2460ec;_0x548aca++){_0x2421b2['push'](await _0x509a6b[_0x548aca]['evaluate'](_0x47fad1=>_0x47fad1['textContent']));try{const _0x579b9a='INSERT\x20INTO\x20'+_0x45358a+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x579b9a,[await _0x509a6b[_0x548aca]['evaluate'](_0x18283d=>_0x18283d['textContent']),await _0x200419[_0x548aca]['evaluate'](_0x5136b3=>_0x5136b3['textContent'])],function(_0x45feb3){_0x45feb3?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x45358a+'\x27:',_0x45feb3['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x2a1c90){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x548aca+'\x20:\x20'+_0x2a1c90);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x548aca+'\x20:\x20'+_0x2a1c90);return handle_fail(0x1);}}return _0xd3f654=Math['round'](++_0x5c1433/_0x3c4f8e*0x64),_0x15556d['sender']['send']('fetch-progress',_0xd3f654,!![]),_0x4d5d51&&(_0x15556d['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x15556d,_0x2d8dad,_0x5e1a0e,_0x45358a,_0x2421b2)),new Promise(_0x272388=>{_0x272388('Scraping\x20finished!');});}catch(_0x3210ce){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x3210ce);return handle_fail(0x1);}}catch(_0x5d2a65){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x5d2a65);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x5d2a65);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x244f7,_0x1be07b,_0x46c1a9,_0x4761ff,_0x552c6c,_0x564555,_0x386a1a){let _0x52376a=0x3,_0x36f9e1=0x0,_0x2d85c3=0x0;try{await setCookiesForUser(_0x1be07b,_0x564555['username']);}catch(_0x5a03d4){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5a03d4);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5a03d4);return handle_fail(0x2);}try{console['log'](_0x46c1a9),await _0x1be07b['goto'](_0x46c1a9),await delay(0x7d0,0xfa0),await notificationClear(_0x1be07b),await delay(0xc8,0x1f4);const _0x20e324=COM_COMMENTS_BOX_BODY_DIV;let _0x3749e7;const _0x35e132=await _0x1be07b['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x421e2f=await _0x1be07b['evaluate'](_0x360142=>_0x360142['innerHTML'],_0x35e132),_0x393922=String(_0x421e2f)['replace'](/[^0-9]/g,''),_0x6603a9=Number(_0x393922)/0x14;_0x4761ff<=0x0?_0x3749e7=Math['ceil'](_0x6603a9/0x3):_0x3749e7=Math['ceil'](_0x4761ff/0x3);_0x52376a+=_0x3749e7,_0x2d85c3=Math['round'](++_0x36f9e1/_0x52376a*0x64),_0x244f7['sender']['send']('fetch-progress',_0x2d85c3,!![]),console['log']('Auto-scrolls:\x20'+_0x3749e7),await scroll(_0x1be07b,_0x20e324,_0x3749e7,_0x342c19=>{_0x2d85c3=Math['round'](++_0x36f9e1/_0x52376a*0x64),_0x244f7['sender']['send']('fetch-progress',_0x2d85c3,!![]);});try{const _0x11de8a=COM_REPLY_BUTTON_SPAN;await _0x1be07b['waitForSelector'](_0x11de8a),await delay(0x1f4,0x320);const _0x51258a=await _0x1be07b['$$'](_0x11de8a);console['log'](_0x51258a);let _0x220db2=_0x51258a['length'];await delay(0xc8,0x1f4);try{for(let _0x13cc18=0x0;_0x13cc18<_0x220db2;_0x13cc18++){_0x51258a[_0x13cc18]['click'](),await delay(0x320,0x5dc);}}catch(_0x9545d){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x9545d);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x9545d);return handle_fail(0x2);}}catch(_0x1743db){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0xf07c21=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x1be07b['waitForSelector'](_0xf07c21),await delay(0x1f4,0x320),_0x2d85c3=Math['round'](++_0x36f9e1/_0x52376a*0x64),_0x244f7['sender']['send']('fetch-progress',_0x2d85c3,!![]);const _0x4a7928=await _0x1be07b['$$'](_0xf07c21);let _0x43b2d1=path['join'](__dirname,'/comments.csv');_0x4761ff<=0x0&&(_0x4761ff=_0x4a7928['length']);console['log']('fetch_limit:\x20'+_0x4761ff),console['log']('comments_len:\x20'+_0x4a7928['length']),_0x4761ff++;try{let _0x536dcd=[];for(let _0xc05959=0x1;_0xc05959<_0x4a7928['length']&&_0xc05959<_0x4761ff;_0xc05959++){try{_0x536dcd['push'](await _0x4a7928[_0xc05959]['evaluate'](_0xc848f0=>_0xc848f0['textContent']));const _0x12b337=await db['prepare']('INSERT\x20INTO\x20'+_0x552c6c+'\x20(username)\x20VALUES\x20(?)');await _0x12b337['run'](await _0x4a7928[_0xc05959]['evaluate'](_0x51d634=>_0x51d634['textContent']),function(_0x4f665d){_0x4f665d&&console['log']('error\x20in\x20add-user:'+_0x4f665d);}),await _0x12b337['finalize']();}catch(_0x196bb3){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0xc05959+'\x20:\x20'+_0x196bb3);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0xc05959+'\x20:\x20'+_0x196bb3);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x2d85c3=Math['round'](++_0x36f9e1/_0x52376a*0x64),_0x244f7['sender']['send']('fetch-progress',_0x2d85c3,!![]),_0x244f7['sender']['send']('fetch-progress',0x64,!![]),_0x386a1a&&(_0x244f7['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x244f7,_0x1be07b,_0x564555,_0x552c6c,_0x536dcd)),_0x244f7['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x22146b=>{_0x22146b('Scraping\x20finished!');});}catch(_0x255901){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x255901);return handle_fail(0x2);}}catch(_0xc5cbd0){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0xc5cbd0);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0xc5cbd0);return handle_fail(0x2);}}async function set_clearname_from_username(_0x11378b,_0x1e3898,_0x52fedd=null){try{let _0x14d361,_0x3d3862;const _0x3d3df0='SELECT\x20username\x20FROM\x20'+_0x1e3898+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x3d3df0,[],(_0x5eacd4,_0x93501d)=>{_0x5eacd4&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x5eacd4['message']),_0x93501d['length']===0x0&&(_0x3d3862=_0x93501d['length']),_0x14d361=_0x93501d['map'](_0x351d84=>_0x351d84['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x3d3862);if(_0x3d3862===0x0){console['log']('Leave');return;}const _0x548138=await _0x11378b['waitForSelector'](IG_SEARCH_BUTTON);await _0x548138['click'](),await delay(0x4b0,0x7d0);for(let _0x1228fe of _0x14d361){const _0x5d4282=await _0x11378b['waitForSelector'](IG_SEARCH_INPUT);await _0x5d4282['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x11378b['type'](IG_SEARCH_INPUT,_0x1228fe,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x4c5f80=0x1;while(_0x4c5f80!=0x14){console['log']('Schleife');try{let _0x3e3c9b=IG_NAME_SPAN_PART1+_0x4c5f80+IG_USERNAME_SPAN_PART2;const _0x2a1f0e=await _0x11378b['waitForSelector'](_0x3e3c9b),_0x138e6b=await _0x11378b['evaluate'](_0x3e811e=>_0x3e811e['innerHTML'],_0x2a1f0e);await delay(0xc8,0x1f4);if(_0x138e6b==_0x1228fe){let _0x701e45=IG_NAME_SPAN_PART1+_0x4c5f80+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x4ca874=await _0x11378b['waitForSelector'](_0x701e45);let _0x41e2c9=await _0x11378b['evaluate'](_0x1d4f52=>_0x1d4f52['innerHTML'],_0x4ca874);const _0x288964=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x46fb2a=_0x41e2c9['match'](_0x288964);_0x46fb2a?_0x41e2c9=_0x46fb2a[0x1]['trim']():_0x41e2c9=_0x41e2c9['trim']();_0x41e2c9['includes']('•')&&(_0x41e2c9=_0x41e2c9['substring'](0x0,_0x41e2c9['indexOf']('•')-0x1));const _0x2760bd='UPDATE\x20'+_0x1e3898+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x2760bd,[_0x41e2c9,_0x138e6b],function(_0x501014){_0x501014&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x501014['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x4c5f80++;}catch(_0xb85782){const _0x1c75db='UPDATE\x20'+_0x1e3898+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x1c75db,['',_0x1228fe],function(_0x12e0cf){_0x12e0cf&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x12e0cf['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0xb85782);break;}}_0x52fedd&&_0x52fedd();}await _0x548138['click']();}catch(_0x1ff9cf){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x1ff9cf);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x4cea4b,_0x2847c6)=>{const _0x38e5ba='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x38e5ba,[],(_0x3e0117,_0x4cb9c5)=>{_0x3e0117?_0x2847c6(_0x3e0117):_0x4cea4b(_0x4cb9c5);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x4e82b2,_0x5ee69c)=>{const _0x24a7a3='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x24a7a3,[],async(_0x510a0e,_0x378710)=>{if(_0x510a0e)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x510a0e['message']),_0x5ee69c({'status':'error','message':_0x510a0e['message']});else try{const _0x5e666e=await Promise['all'](_0x378710['map'](_0x6968da=>{return new Promise(_0x5f4d50=>{if(!_0x6968da['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x6968da['campaign_name']),_0x5f4d50({'campaign_name':_0x6968da['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x27425f='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x6968da['list_id'],_0x4d0d28='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x6968da['list_id']+'\x22';db['get'](_0x27425f,[],(_0x2845bf,_0x21a0be)=>{_0x2845bf?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x6968da['campaign_name']+':',_0x2845bf['message']),_0x5f4d50({'campaign_name':_0x6968da['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x4d0d28,[],(_0x31ee41,_0x21fcc1)=>{_0x31ee41?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x6968da['campaign_name']+':',_0x31ee41['message']),_0x5f4d50({'campaign_name':_0x6968da['campaign_name'],'lead_count':_0x21a0be?_0x21a0be['lead_count']:0x0,'contacted_count':'N/A'})):_0x5f4d50({'campaign_name':_0x6968da['campaign_name'],'lead_count':_0x21a0be?_0x21a0be['lead_count']:0x0,'contacted_count':_0x21fcc1?_0x21fcc1['contacted_count']:0x0});});});});}));_0x4e82b2({'status':'success','campaigns':_0x5e666e});}catch(_0x5048d3){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x5048d3),_0x5ee69c({'status':'error','message':_0x5048d3['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x52394b,_0x525ec0)=>{return new Promise((_0x5e157c,_0x26a624)=>{const _0x23a3b2='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x23a3b2,[_0x525ec0],(_0x5895f9,_0x198615)=>{_0x5895f9?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x5895f9),_0x26a624(_0x5895f9)):(console['log']('ROWS'),console['log'](_0x198615),debugDatabaseContents(),_0x5e157c(_0x198615));});});});const showTableContents=_0xcc29f1=>{return new Promise((_0xd846ef,_0x1746f5)=>{const _0x3fb09f='SELECT\x20*\x20FROM\x20'+_0xcc29f1+';';campaignDB['all'](_0x3fb09f,(_0x341742,_0x5cccb2)=>{_0x341742?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0xcc29f1+':',_0x341742),_0x1746f5(_0x341742)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0xcc29f1+':',_0x5cccb2),_0xd846ef({'status':'success','message':_0x5cccb2}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x1c78bf){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x1c78bf);}}ipcMain['handle']('create-campaign',async(_0x23e4bc,_0x46b3e1)=>{return new Promise((_0x32fad2,_0x423964)=>{const _0x259c2f='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x259c2f,[String(_0x46b3e1)],function(_0x12c82c){_0x12c82c?_0x423964(_0x12c82c):_0x32fad2({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x4caf45,_0x32d7d8)=>{return new Promise((_0x1a0b37,_0x159a32)=>{const _0x52d65c='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x52d65c,[_0x32d7d8],function(_0x13fb04){_0x13fb04?_0x159a32(_0x13fb04):_0x1a0b37({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x3fde19,_0x9bb228,_0x4c17b5,_0x8e9db,_0x1c0cee,_0x58483d,_0xd5110f,_0x123238)=>{const _0x5b499c=await createMessageID(_0x1c0cee);return new Promise((_0x131787,_0x5e2d8c)=>{if(!_0x9bb228||!_0x4c17b5||!_0x8e9db||!_0x5b499c||!_0x58483d)return _0x5e2d8c({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x5b499c);const _0x32dd65='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x32dd65,[_0x4c17b5,_0x8e9db,_0x5b499c,_0x58483d,_0xd5110f,_0x123238,_0x9bb228],function(_0x3d582d){if(_0x3d582d)_0x5e2d8c({'status':'error','message':_0x3d582d['message']});else this['changes']===0x0?_0x5e2d8c({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x131787({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x31ee95,_0x27b126,_0x1d1867,_0x51ed11,_0x151437)=>{return new Promise((_0x258e32,_0xb2561e)=>{const _0x4f0d28='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x4f0d28,[_0x27b126,_0x1d1867,_0x51ed11,_0x151437],function(_0x4a7d20){return _0x4a7d20?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x4a7d20['message']),_0xb2561e('insert-dm-response',{'success':![],'message':_0x4a7d20['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x258e32('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x84cb1b=>{return new Promise((_0x87e542,_0x4da32f)=>{const _0x28ecbe='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x28ecbe,[_0x84cb1b],(_0x39b8f5,_0x5b1289)=>{if(_0x39b8f5)_0x4da32f({'status':'error','message':_0x39b8f5['message']});else{if(_0x5b1289)_0x87e542(_0x5b1289['message_id']);else{const _0x9f01c7='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x9f01c7,[_0x84cb1b],function(_0x29953f){_0x29953f?_0x4da32f({'status':'error','message':_0x29953f['message']}):_0x87e542(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x1c5ff8,_0x352dc2)=>{return new Promise((_0x5d7285,_0x5f1322)=>{const _0x1b4477='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x352dc2;db['get'](_0x1b4477,(_0x5946f8,_0x3efaff)=>{_0x5946f8?_0x5f1322({'status':'error','message':_0x5946f8['message']}):_0x5d7285({'status':'success','count':_0x3efaff['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x5f2816,_0x66f3f2){try{const _0x556955=await new Promise((_0x465ebd,_0x1033c2)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x66f3f2],(_0x29e677,_0x43c673)=>{if(_0x29e677)_0x1033c2(_0x29e677);else{if(_0x43c673['length']>0x0){let _0x19029f=JSON['parse'](_0x43c673[0x0]['cookie']);console['log'](_0x19029f),_0x465ebd(_0x19029f);}else _0x1033c2(new Error('User\x20with\x20username\x20'+_0x66f3f2+'\x20does\x20not\x20exist.'));}});});await _0x5f2816['setCookie'](..._0x556955),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x18839e){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x18839e);}}async function saveCookiesForUser(_0x370e6f,_0x60a586){try{const _0x1c5af5=await _0x370e6f['cookies']();if(!_0x1c5af5||_0x1c5af5['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x60a586);const _0x58061a=JSON['stringify'](_0x1c5af5);if(_0x58061a['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x60a586);return new Promise((_0x4e1d38,_0x4e22ad)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x60a586],(_0xdf2db0,_0x1acefd)=>{if(_0xdf2db0)return console['error']('Error\x20checking\x20user\x20existence:',_0xdf2db0),_0x4e22ad(_0xdf2db0);if(_0x1acefd){const _0x26dbbd=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x26dbbd['run'](_0x58061a,_0x60a586,function(_0xdce401){return _0xdce401?(console['error']('Error\x20updating\x20cookies:',_0xdce401),_0x4e22ad(_0xdce401)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x60a586),_0x4e1d38());});}else{const _0x5d0ba4=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x5d0ba4['run'](_0x60a586,_0x58061a,function(_0x5d942){return _0x5d942?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x5d942),_0x4e22ad(_0x5d942)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x60a586),_0x4e1d38());});}});});}catch(_0x168c5d){console['error']('Error\x20fetching\x20cookies:',_0x168c5d);throw _0x168c5d;}}async function createUserIfNotExists(_0x483c1e){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x483c1e],(_0x3bb422,_0x5461a8)=>{if(_0x3bb422){console['error']('Error\x20checking\x20user\x20existence:',_0x3bb422);throw _0x3bb422;}else{if(!_0x5461a8){const _0x194f0b=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x194f0b['run'](_0x483c1e,function(_0x2c4b52){_0x2c4b52?console['error']('Error\x20inserting\x20new\x20user:',_0x2c4b52):console['log']('New\x20user\x20created:',_0x483c1e);});}else console['log']('User\x20already\x20exists:',_0x483c1e);}});}catch(_0x29963f){console['error']('Error\x20creating\x20user:',_0x29963f);throw _0x29963f;}}ipcMain['handle']('create-relation',async(_0x117669,_0x19b838)=>{return new Promise((_0x5eba47,_0x3846e0)=>{const _0x361cc4='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x19b838+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x361cc4,function(_0x1672b1){_0x1672b1?_0x3846e0(_0x1672b1):_0x5eba47({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x449a01,_0x5b972f)=>{return console['log']('droping\x20table'+_0x5b972f),new Promise((_0x75822,_0x420ae5)=>{const _0x783893='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x5b972f;console['log']('droping\x20table'+_0x5b972f),db['run'](_0x783893,function(_0x8e3b32){_0x8e3b32?_0x420ae5(_0x8e3b32):_0x75822({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x4a565f=>{return new Promise((_0xb1ae1,_0x4743bf)=>{const _0x7ffa28='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x7ffa28,[],(_0x3a9503,_0xcac54e)=>{_0x3a9503?_0x4743bf(_0x3a9503):_0xb1ae1(_0xcac54e['map'](_0x3ba63a=>_0x3ba63a['name']));});});}),ipcMain['handle']('add-user',async(_0x2d52fd,_0x39c950,_0x1b3cd8)=>{return new Promise(_0x60990e=>{const _0x35418f=db['prepare']('INSERT\x20INTO\x20'+_0x1b3cd8+'\x20(username)\x20VALUES\x20(?)');_0x35418f['run'](_0x39c950,function(_0x54bd1){_0x54bd1?console['log']('error\x20in\x20add-user:'+_0x54bd1):_0x60990e({'status':'success','id':this['lastID']});}),_0x35418f['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x49b32f,_0x4576ec)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x55cb36,_0x5de408)=>{if(_0x55cb36)_0x4576ec(_0x55cb36);else{_0x49b32f({'status':'success','users':_0x5de408});for(_0x5de408 of _0x5de408){console['log'](_0x5de408['username']);}}});});}),ipcMain['handle']('get-data',async(_0x54aad2,_0x367065)=>{return new Promise((_0x10a89f,_0x5159cf)=>{const _0x3e5087='SELECT\x20*\x20FROM\x20'+_0x367065;console['log'](_0x3e5087),db['all'](_0x3e5087,[],(_0x53695d,_0x3525f9)=>{_0x53695d?_0x5159cf(_0x53695d):_0x10a89f(_0x3525f9);});});}),ipcMain['handle']('get-accounts',async _0x4622d5=>{return new Promise((_0xbe4488,_0x508120)=>{const _0x4e9d6c='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x4e9d6c),igaccountsDB['all'](_0x4e9d6c,[],(_0x34aee7,_0x1040b0)=>{_0x34aee7?_0x508120(_0x34aee7):_0xbe4488(_0x1040b0);});});}),ipcMain['handle']('get-targets',async(_0x511d52,_0x41438d)=>{return getTargetProfiles(_0x41438d);}),ipcMain['handle']('delete-user',async(_0x23fed3,_0x12f4f4,_0x186742)=>{return new Promise((_0x3de662,_0x2d8cbe)=>{const _0x14e01b=db['prepare']('DELETE\x20FROM\x20'+_0x186742+'\x20WHERE\x20username\x20=\x20?');_0x14e01b['run'](_0x12f4f4,function(_0x295f0e){_0x295f0e?_0x2d8cbe(_0x295f0e):_0x3de662({'status':'success','changes':this['changes']});}),_0x14e01b['finalize']();});}),ipcMain['handle']('delete-account',async(_0x23a3e7,_0x1a4269)=>{const _0x37a8ef=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x37a8ef['run'](_0x1a4269,function(_0x30cd8d){_0x30cd8d&&console['log'](_0x30cd8d);}),_0x37a8ef['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x11167b,_0x3284cd)=>{const _0x47447b='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x47447b,[],(_0x2222fe,_0x4f39bc)=>{_0x2222fe?_0x3284cd({'status':'error','message':_0x2222fe['message']}):_0x11167b({'status':'success','contactedCount':_0x4f39bc['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x5b4a29,_0x3ed12f)=>{const _0x539e56='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x539e56,[],(_0x4ecc39,_0x5b2573)=>{_0x4ecc39?_0x3ed12f({'status':'error','message':_0x4ecc39['message']}):_0x5b4a29({'status':'success','contactedCount':_0x5b2573['contactedCount']});});});});function exportDatabase(_0x595aae){return new Promise((_0xd9f78a,_0x4aa98d)=>{const _0x53f0ba='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x595aae+'\x0a\x20\x20\x20\x20';db['all'](_0x53f0ba,[],async(_0x22fefe,_0x5b5d3e)=>{if(_0x22fefe){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x22fefe['message']),_0x4aa98d(_0x22fefe);return;}if(!_0x5b5d3e||_0x5b5d3e['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0xd9f78a();return;}const _0x36979d=XLSX['utils']['json_to_sheet'](_0x5b5d3e),_0x332106=XLSX['utils']['sheet_to_csv'](_0x36979d);try{const {canceled:_0x3dbcf9,filePath:_0x191a17}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x595aae+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x3dbcf9||!_0x191a17){console['log']('Speichern\x20abgebrochen.'),_0xd9f78a();return;}fs['writeFile'](_0x191a17,_0x332106,'utf8',_0x51a745=>{_0x51a745?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x51a745['message']),_0x4aa98d(_0x51a745)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x191a17),_0xd9f78a());});}catch(_0x17c069){console['error']('Fehler\x20im\x20Speicherdialog:',_0x17c069),_0x4aa98d(_0x17c069);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x173cf6,_0x28390f)=>{shell['openExternal'](_0x28390f);});