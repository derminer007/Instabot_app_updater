const {app,BrowserWindow,ipcMain,dialog}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),ANZAHL_FOLLOWER_BUTTON='div.x9f619.x1n2onr6\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_NEW_MSG_BUTTON='div.x1i10hfl.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.x6s0dn4.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x1ypdohk.x78zum5.xl56j7k.x1y1aw1k.x1sxyh0.xwib8y2.xurb0ha.xcdnw81',K_SEARCH_BAR_INPUT='body\x20>\x20div.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x1k90msu.x6o7n8i.x1qfuztq.x10l6tqk.x17qophe.x13vifvy.x1hc1fzr.x71s49j.xh8yej3\x20>\x20div\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.x1q0g3np.x1a02dak.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20input',K_USERNAME_SPALTE_PART1='div:nth-child(',K_CLEARNAME_SPALTE_PART2=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1pi30zi.x1swvt13.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span\x20>\x20span',K_CHAT_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.x972fbf.xcfux6l.x1qhh985.xm0m39n.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.xexx8yu.x18d9i69.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1lq5wgf.xgqcy7u.x30kzoy.x9jhf4c.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x9bdzbf.x1ypdohk.x78zum5.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x1n2onr6.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xn3w4p2.x5ib6vp.xc73u3c.x1tu34mt.xzloghq',K_NACHRICHT_SCHREIBEN_INPUT_DIV='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1i64zmx.xw3qccf.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f.notranslate',K_SENDEN_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.xfs2ol5[role=\x22button\x22][tabindex=\x220\x22]',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x29e792=new BrowserWindow({'width':0x320,'height':0x258,'webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x29e792['loadFile'](path['join'](__dirname,'index.html'));}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x408beb){var _0x34600e=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x3c4c7e){console['log']('window\x20id:'+_0x3c4c7e['id']),_0x3c4c7e['id']>0x1&&(_0x34600e=!![]);}),console['log']('child\x20opened\x20='+_0x34600e);if(!_0x34600e){const _0x4aa531=new BrowserWindow({'width':0x320,'height':0x258,'webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x4aa531['loadFile'](_0x408beb['url']);}else console['log']('child\x20window\x20opened\x20already');}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x55f852=0x1,_0x1ad746=0x0){let _0xdd785c='',_0xfe2f98=null;if(process['platform']==='darwin')_0xdd785c='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome';else{if(process['platform']==='win32')_0xdd785c='chromium_local/chrome-win/chrome.exe';else{if(process['platform']==='linux'){}}}if(_0x55f852===0x0&&!pageStack[_0x1ad746])return browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0xdd785c}),_0xfe2f98=await browser['newPage'](),_0xfe2f98['setDefaultNavigationTimeout'](0x1d4c),_0xfe2f98['setDefaultTimeout'](0x1d4c),pageStack[_0x1ad746]=_0xfe2f98,_0xfe2f98;return(browser===null||pageStack[_0x1ad746]['isClosed']())&&(browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0xdd785c})),(pageStack[_0x1ad746]===null||pageStack[_0x1ad746]['isClosed']())&&(_0xfe2f98=await browser['newPage'](),_0xfe2f98['setDefaultNavigationTimeout'](0x1d4c),_0xfe2f98['setDefaultTimeout'](0x1d4c),pageStack[_0x1ad746]=_0xfe2f98),pageStack[_0x1ad746];}ipcMain['on']('login',async(_0x3832a0,_0x193ec9,_0x35617a)=>{const _0x1ff150=await getBrowserPage();await _0x1ff150['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x1ff150,_0x193ec9,_0x35617a),setTimeout(async()=>{await browser['close']();},0x1388);}),ipcMain['handle']('sendMessage',async(_0x5b96b6,_0x241608,_0x5cf545,_0x21dea7,_0x3f0292,_0x367516,_0x5dbefe,_0x44b0c7)=>{isStopping=![];let _0x158774=null;return _0x5dbefe?_0x158774=await getBrowserPage(_0x3f0292,_0x44b0c7):_0x158774=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x241608),new Promise((_0x4d1eaf,_0x4b42bb)=>{send_message(_0x158774,_0x241608,_0x5cf545,_0x21dea7,_0x3f0292,_0x367516)['then'](_0x555482=>_0x4d1eaf(_0x555482))['catch'](_0x2b6738=>_0x4b42bb(_0x2b6738));});}),ipcMain['handle']('stop-action',async(_0x2cb426,_0x3b8215)=>{isStopping=!![];const _0x1af113=await getBrowserPage(0x1,_0x3b8215);await _0x1af113['close']();}),ipcMain['handle']('fetch_followers',async(_0x3b6d1d,_0x250f07,_0x2d22c2,_0x6d1a24,_0x5e441c)=>{isStopping=![];const _0x46b2f6=await getBrowserPage();return fetch_followers_from_account(_0x46b2f6,_0x250f07,_0x2d22c2,_0x6d1a24,_0x5e441c);}),ipcMain['handle']('fetch_likes',async(_0x5af0fe,_0x82744c,_0x767c15,_0x13ca3b,_0x3dbe8f)=>{isStopping=![];const _0x5a699b=await getBrowserPage();return fetch_likers_from_post(_0x5a699b,_0x82744c,_0x767c15,_0x13ca3b,_0x3dbe8f);}),ipcMain['handle']('fetch_comments',async(_0x7b17ba,_0x1c46b2,_0x577b87,_0x574f90,_0x273120)=>{isStopping=![];const _0x17c406=await getBrowserPage();return fetch_comments_from_post(_0x17c406,_0x1c46b2,_0x577b87,_0x574f90,_0x273120);}),ipcMain['handle']('update-app',async _0x145cf8=>{const {spawn:_0x12e099}=require('child_process'),_0x2d9db1=require('path');if(process['platform']==='darwin'){const _0x3a3d50=_0x2d9db1['join'](__dirname,'mac-updater-intern.sh'),_0x35cfe2=_0x12e099('/bin/bash',[_0x3a3d50]);_0x35cfe2['stdout']['on']('data',_0x1aac3e=>{console['log']('stdout:\x20'+_0x1aac3e);}),_0x35cfe2['stderr']['on']('data',_0x1acae9=>{console['error']('stderr:\x20'+_0x1acae9);}),_0x35cfe2['on']('close',_0x2c20da=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x2c20da);});}else{if(process['platform']==='win32'){const _0x444409=_0x2d9db1['join'](__dirname,'../','../','../');process['chdir'](_0x444409),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x554a62='soft-ui-updater-windows.ps1',_0xf79eb7='soft-ui-updater-windows.exe',_0x42acd6=_0x12e099('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x554a62]);console['log']('Windows\x20Pfad:\x20'+_0x444409),_0x42acd6['stdout']['on']('data',_0x52a3f6=>{console['log']('stdout:\x20'+_0x52a3f6);}),_0x42acd6['stderr']['on']('data',_0x4c874b=>{console['error']('stderr:\x20'+_0x4c874b);}),_0x42acd6['on']('close',_0x4bbc7=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x4bbc7);});}}});function getRnd(_0x548455,_0x556730){return Math['random']()*(_0x556730-_0x548455+0x1)+_0x548455;}function delay(_0x41c055,_0x566288){let _0x35d529=getRnd(_0x41c055,_0x566288);return new Promise(function(_0x388642){setTimeout(_0x388642,_0x35d529);});}async function scroll(_0x3b9fc4,_0x1eee09,_0xf27d6d=0x2){const _0x8d17ed=await _0x3b9fc4['waitForSelector'](_0x1eee09);for(let _0x1ec6f0=0x0;_0x1ec6f0<_0xf27d6d;_0x1ec6f0++){console['log']('Scrolling\x20'+_0x1ec6f0),await _0x3b9fc4['evaluate'](_0x178473=>{const _0x58fc90=document['querySelector'](_0x178473);_0x58fc90&&_0x58fc90['scrollBy'](0x0,0x190);},_0x1eee09),await delay(0x320,0x5dc);}}async function saveCookies(_0x13705b){let _0x54585f=await _0x13705b['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x54585f,null,0x2));}async function notificationClear(_0x2196fe){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x2196fe['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x2196fe['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x315afe){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x315afe);}}async function getTargetProfiles(_0x5bd8b6){return new Promise((_0x2be50e,_0x27fb44)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x5bd8b6,(_0x360e94,_0x298109)=>{_0x360e94?_0x27fb44(_0x360e94):_0x2be50e(_0x298109);});});}async function login(_0x53881b,_0x4886ef,_0x4d8b41){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x53881b,_0x4886ef),await createUserIfNotExists(_0x4886ef,_0x4d8b41);}catch(_0x7d3c22){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x7d3c22);}try{await _0x53881b['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x53881b['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x53881b['click']('button._a9--._ap36._a9_0');}catch(_0x48eb53){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x53881b['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x53881b['type']('input[name=\x27username\x27]',_0x4886ef,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x53881b['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x53881b['type']('input[name=\x27password\x27]',_0x4d8b41,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x53881b['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x53881b['click']('button[type=\x27submit\x27]');}catch(_0x5ac4ca){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x53881b),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x53881b,_0x4886ef);}catch(_0x51ec88){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x51ec88);}}catch(_0x12f981){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x12f981);}}async function send_message(_0x472e6a,_0x4aaa6c,_0x711cf9,_0x5ccb60,_0x543167,_0x484652){_0x484652=_0x484652['split'](';'),console['log'](_0x484652[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x543167);if(_0x543167==0x0){try{await login(_0x472e6a,_0x484652[0x0],_0x484652[0x1]);}catch(_0x3a41b0){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x3a41b0);return;}await _0x472e6a['goto']('https://www.instagram.com/direct/inbox/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x472e6a);}let _0x1d0968;await set_clearname_from_username(_0x472e6a,_0x711cf9);const _0xd72e1a='SELECT\x20clearname\x20FROM\x20'+_0x711cf9+'\x20WHERE\x20username\x20IS\x20?';db['all'](_0xd72e1a,[_0x4aaa6c],(_0x2091c7,_0xd309cd)=>{_0x2091c7&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x2091c7['message']);if(_0xd309cd['length']===0x0)return;_0x1d0968=_0xd309cd['map'](_0x285a88=>_0x285a88['clearname']);});try{try{const _0x343154=K_NEW_MSG_BUTTON;await delay(0xfa0,0x1d4c),await _0x472e6a['waitForSelector'](_0x343154),await _0x472e6a['click'](_0x343154),console['log']('Message-Button\x20geklickt'),console['log'](_0x4aaa6c+'\x20'+_0x5ccb60),await delay(0xfa0,0x1d4c);try{const _0x413dd3='input[name=\x22queryBox\x22]',_0x57cfbc=K_SEARCH_BAR_INPUT;await _0x472e6a['waitForSelector'](_0x57cfbc),await _0x472e6a['click'](_0x57cfbc),await delay(0xfa0,0x1d4c),await _0x472e6a['waitForSelector'](_0x413dd3),await _0x472e6a['click'](_0x413dd3),await delay(0xfa0,0x1d4c),await _0x472e6a['type'](_0x413dd3,_0x4aaa6c,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),console['log']('Account\x20Name\x20eingefügt');const _0x31c593=K_USERNAME_SPALTE_PART1,_0x4928ae=K_CLEARNAME_SPALTE_PART2;let _0x179200=0x1;try{while(_0x179200!=0x14){console['log']('Schleife');let _0x2936c5=_0x31c593+_0x179200+_0x4928ae;const _0x34b5b7=await _0x472e6a['waitForSelector'](_0x2936c5),_0x31ab65=await _0x472e6a['evaluate'](_0x40475c=>_0x40475c['innerHTML'],_0x34b5b7);console['log'](_0x31ab65+';'+_0x1d0968+';'+_0x4aaa6c),delay(0x3e8,0xbb8);if(_0x31ab65==_0x1d0968){console['log']('Account\x20gefunden'),await _0x472e6a['click'](_0x2936c5);break;}else{if(_0x31ab65==_0x4aaa6c){console['log']('Account\x20gefunden'),await _0x472e6a['click'](_0x2936c5);break;}}_0x179200++;}try{await delay(0xbb8,0x1388);const _0xd99a5d=await _0x472e6a['waitForSelector'](K_CHAT_BUTTON_DIV);console['log'](_0xd99a5d),await delay(0xbb8,0x1388),await _0xd99a5d['click']();try{await delay(0xbb8,0x1388);const _0x2d5fbb=await _0x472e6a['waitForSelector'](K_NACHRICHT_SCHREIBEN_INPUT_DIV);await _0x2d5fbb['type'](_0x5ccb60,{'delay':getRnd(0x50,0x78)}),await delay(0xbb8,0x1388);try{const _0x1f9592=await _0x472e6a['waitForSelector'](K_SENDEN_BUTTON_DIV);return await _0x1f9592['click'](),await delay(0xbb8,0x1388),new Promise(_0x40e996=>{_0x40e996('Nachricht\x20erfolgreich\x20verschickt!');});}catch(_0x1af72a){console['log']('Message-Button\x20nicht\x20geklickt:\x20'+_0x1af72a);}}catch(_0x33aa4){console['log']('Chat-Fenster\x20nicht\x20gefunden:\x20'+_0x33aa4);}}catch(_0x3566f6){console['log']('error:\x20'+_0x3566f6);}}catch(_0x2ac67e){return console['log']('User\x20nicht\x20gefunden:'+_0x2ac67e),await _0x472e6a['goto']('https://www.instagram.com/direct/inbox/'),new Promise((_0x4ecdb0,_0x484e00)=>{_0x484e00('user_not_found');});}}catch(_0x3ab515){console['log']('DM-Fenster\x20nicht\x20gefunden:'+_0x3ab515);}}catch(_0x2e26a4){console['log']('Message-Button\x20nicht\x20geklickt:'+_0x2e26a4);}}catch(_0x2725d2){console['log']('Nachricht\x20senden\x20fehlgeschlagen:\x20'+_0x2725d2);}return console['log']('Ende'),await _0x472e6a['goto']('https://www.instagram.com/direct/inbox/'),new Promise((_0x4dd928,_0x36050d)=>{_0x36050d('ig_update');});}function handle_fail(_0x4836d6){if(isStopping)return new Promise(_0x58918e=>{_0x58918e('Scraper\x20gestoppt.');});else{let _0x422e57='';switch(_0x4836d6){case 0x0:_0x422e57='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x422e57='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x422e57='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x422e57='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x257829,_0x169dcb)=>{_0x169dcb(_0x422e57);});}}async function fetch_followers_from_account(_0x5cd798,_0xffdeb9,_0x219690,_0x1c54a5,_0x2af822){try{await login(_0x5cd798,_0x2af822['username'],_0x2af822['password']);}catch(_0x2bb220){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x2bb220),handle_fail(0x0);}let _0x1e7dcd=0x0;try{await _0x5cd798['goto']('https://www.instagram.com/'+_0xffdeb9+'/'),await notificationClear(_0x5cd798);try{if(_0x219690<=0x0){const _0x4abf04=await _0x5cd798['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x1c68a6=await _0x5cd798['evaluate'](_0x22a527=>_0x22a527['innerHTML'],_0x4abf04);_0x1e7dcd=Math['ceil'](_0x1c68a6/0x4);}else _0x1e7dcd=Math['ceil'](_0x219690/0x4);let _0x25636a=await _0x5cd798['waitForSelector'](FOLLOWER_BUTTON);await delay(0xbb8,0x1388),await _0x25636a['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0xffdeb9+'\x20gesichtet');}catch(_0x31fdd2){return console['log']('Follower\x20Liste\x20von\x20'+_0xffdeb9+'\x20nicht\x20gefunden:'+_0x31fdd2),handle_fail(0x0);}}catch(_0x578c20){return console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x578c20),handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x1e7dcd),await scroll(_0x5cd798,FOLLOWER_FENSTER,_0x1e7dcd),await _0x5cd798['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x1d6b20=await _0x5cd798['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x3bb72d=await _0x5cd798['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x219690<=0x0&&(_0x219690=_0x1d6b20['length']);for(let _0x325c5d=0x0;_0x325c5d<_0x1d6b20['length']&&_0x325c5d<_0x219690;_0x325c5d++){console['log'](await _0x1d6b20[_0x325c5d]['evaluate'](_0x100563=>_0x100563['textContent']));const _0x28c6a5='INSERT\x20INTO\x20'+_0x1c54a5+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x28c6a5,[await _0x1d6b20[_0x325c5d]['evaluate'](_0x381abd=>_0x381abd['textContent']),await _0x3bb72d[_0x325c5d]['evaluate'](_0x491ed7=>_0x491ed7['textContent'])],function(_0x16301a){_0x16301a?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x1c54a5+'\x27:',_0x16301a['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return new Promise(_0x51ed02=>{_0x51ed02('Scraping\x20finished!');});}catch(_0x2d1840){return console['log']('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0xffdeb9+'\x20nicht\x20gefunden:'+_0x2d1840),handle_fail(0x0);}}async function fetch_likers_from_post(_0x469ba6,_0xffccf1,_0x56364d,_0x50c910,_0x175ba3){try{await login(_0x469ba6,_0x175ba3['username'],_0x175ba3['password']);}catch(_0x42c6d7){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x42c6d7);return handle_fail(0x1);return;}try{let _0xe0ac84=_0xffccf1['substring'](0x0,_0xffccf1['lastIndexOf']('/')),_0x16bfd1=_0xe0ac84+'/liked_by';console['log'](_0x16bfd1),await _0x469ba6['goto'](_0x16bfd1),await delay(0x7d0,0xfa0),await notificationClear(_0x469ba6),await delay(0xc8,0x1f4),await _0x469ba6['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x3ebb2b=await _0x469ba6['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x1c7a77=await _0x469ba6['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x3ebb2b['length']);let _0x1d8da0=path['join'](__dirname,'/likers.csv');_0x56364d<=0x0&&(_0x56364d=_0x3ebb2b['length']);try{for(let _0x3390cc=0x0;_0x3390cc<_0x3ebb2b['length']&&_0x3390cc<_0x56364d;_0x3390cc++){console['log'](await _0x3ebb2b[_0x3390cc]['evaluate'](_0x4c2374=>_0x4c2374['textContent']));try{const _0x1e08b0='INSERT\x20INTO\x20'+_0x50c910+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x1e08b0,[await _0x3ebb2b[_0x3390cc]['evaluate'](_0x1d726b=>_0x1d726b['textContent']),await _0x1c7a77[_0x3390cc]['evaluate'](_0x5da0d0=>_0x5da0d0['textContent'])],function(_0x3cedc7){_0x3cedc7?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x50c910+'\x27:',_0x3cedc7['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x4b4d8b){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x3390cc+'\x20:\x20'+_0x4b4d8b),handle_fail(0x1);}}return new Promise(_0x5702ea=>{_0x5702ea('Scraping\x20finished!');});}catch(_0x49df2c){return console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben'),handle_fail(0x1);}}catch(_0x1b93cf){return console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x1b93cf),handle_fail(0x1);}}async function fetch_comments_from_post(_0xddd906,_0x47fe07,_0x557372,_0x5d10a2,_0x2abc14){try{await login(_0xddd906,_0x2abc14['username'],_0x2abc14['password']);}catch(_0x57faab){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x57faab),handle_fail(0x2);}try{console['log'](_0x47fe07),await _0xddd906['goto'](_0x47fe07),await delay(0x7d0,0xfa0),await notificationClear(_0xddd906),await delay(0xc8,0x1f4);const _0x30d245=COM_COMMENTS_BOX_BODY_DIV;let _0xb81eb3;if(_0x557372<=0x0){const _0x18f7c5=await _0xddd906['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x237cc8=await _0xddd906['evaluate'](_0x1ac561=>_0x1ac561['innerHTML'],_0x18f7c5),_0x257346=String(_0x237cc8)['replace'](/[^0-9]/g,''),_0x451ac3=Number(_0x257346)/0x14;_0xb81eb3=Math['ceil'](_0x451ac3/0x3);}else _0xb81eb3=Math['ceil'](_0x557372/0x3);console['log']('Auto-scrolls:\x20'+_0xb81eb3),await scroll(_0xddd906,_0x30d245,_0xb81eb3);try{const _0x26e948=COM_REPLY_BUTTON_SPAN;await _0xddd906['waitForSelector'](_0x26e948),await delay(0x1f4,0x320);const _0x5b20d8=await _0xddd906['$$'](_0x26e948);console['log'](_0x5b20d8),await delay(0xc8,0x1f4);try{for(let _0x136561=0x0;_0x136561<_0x5b20d8['length'];_0x136561++){_0x5b20d8[_0x136561]['click'](),await delay(0x320,0x5dc);}}catch(_0x402970){return console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x402970),handle_fail(0x2);}}catch(_0x12b4cd){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x2ae432=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0xddd906['waitForSelector'](_0x2ae432),await delay(0x1f4,0x320);const _0x48cf1c=await _0xddd906['$$'](_0x2ae432);let _0x1ceb6b=path['join'](__dirname,'/comments.csv');_0x557372<=0x0&&(_0x557372=_0x48cf1c['length']);console['log']('fetch_limit:\x20'+_0x557372),console['log']('comments_len:\x20'+_0x48cf1c['length']),_0x557372++;try{for(let _0x486aa6=0x1;_0x486aa6<_0x48cf1c['length']&&_0x486aa6<_0x557372;_0x486aa6++){try{console['log'](await _0x48cf1c[_0x486aa6]['evaluate'](_0x25ecab=>_0x25ecab['textContent']));const _0x30037c=await db['prepare']('INSERT\x20INTO\x20'+_0x5d10a2+'\x20(username)\x20VALUES\x20(?)');await _0x30037c['run'](await _0x48cf1c[_0x486aa6]['evaluate'](_0x5e825c=>_0x5e825c['textContent']),function(_0x563178){_0x563178&&console['log']('error\x20in\x20add-user:'+_0x563178);}),await _0x30037c['finalize']();}catch(_0x1ea2a2){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x486aa6+'\x20:\x20'+_0x1ea2a2),handle_fail(0x2);}}await delay(0x4b0,0x7d0);try{await set_clearname_from_username(_0xddd906,_0x5d10a2);}catch(_0x384014){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x384014);}return new Promise(_0x4a2461=>{_0x4a2461('Scraping\x20finished!');});}catch(_0x346f6b){return console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben'),handle_fail(0x2);}}catch(_0x202a0c){return console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x202a0c),handle_fail(0x2);}}async function set_clearname_from_username(_0x3c2006,_0x275767){try{let _0x5c2995,_0x591844;const _0x290283='SELECT\x20username\x20FROM\x20'+_0x275767+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x290283,[],(_0x3cd9a6,_0x280541)=>{_0x3cd9a6&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x3cd9a6['message']),_0x280541['length']===0x0&&(_0x591844=_0x280541['length']),_0x5c2995=_0x280541['map'](_0x260bca=>_0x260bca['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x591844);if(_0x591844===0x0){console['log']('Leave');return;}const _0x55a964=await _0x3c2006['waitForSelector'](IG_SEARCH_BUTTON);await _0x55a964['click'](),await delay(0x4b0,0x7d0);for(let _0x53654a of _0x5c2995){const _0x7c9796=await _0x3c2006['waitForSelector'](IG_SEARCH_INPUT);await _0x7c9796['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x3c2006['type'](IG_SEARCH_INPUT,_0x53654a,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x2c16d6=0x1;while(_0x2c16d6!=0x14){console['log']('Schleife');try{let _0x1554b4=IG_NAME_SPAN_PART1+_0x2c16d6+IG_USERNAME_SPAN_PART2;const _0x194898=await _0x3c2006['waitForSelector'](_0x1554b4),_0x16339c=await _0x3c2006['evaluate'](_0x385b64=>_0x385b64['innerHTML'],_0x194898);await delay(0xc8,0x1f4);if(_0x16339c==_0x53654a){let _0x194b4b=IG_NAME_SPAN_PART1+_0x2c16d6+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x755077=await _0x3c2006['waitForSelector'](_0x194b4b);let _0x330b77=await _0x3c2006['evaluate'](_0x4951b4=>_0x4951b4['innerHTML'],_0x755077);const _0xc99a54=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x360f2e=_0x330b77['match'](_0xc99a54);_0x360f2e?_0x330b77=_0x360f2e[0x1]['trim']():_0x330b77=_0x330b77['trim']();const _0x2f908b='UPDATE\x20'+_0x275767+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x2f908b,[_0x330b77,_0x16339c],function(_0x4531ed){_0x4531ed&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x4531ed['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x2c16d6++;}catch(_0x222c45){const _0x1a78d6='UPDATE\x20'+_0x275767+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x1a78d6,['',_0x53654a],function(_0x23e923){_0x23e923&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x23e923['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x222c45);break;}}}await _0x55a964['click']();}catch(_0x17d030){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x17d030);}}const campaignPath=path['resolve'](__dirname,'data/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(campaign_name\x20TEXT\x20PRIMARY\x20KEY,\x20list_id\x20TEXT,\x20zeitabstand\x20REAL,\x20message_id\x20TEXT,\x20account\x20TEXT,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x268e17,_0x1cf125)=>{const _0x594cb8='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x594cb8,[],(_0x5b3236,_0x57a7b2)=>{_0x5b3236?_0x1cf125(_0x5b3236):_0x268e17(_0x57a7b2);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x583ace,_0x33cb37)=>{const _0x78b9a2='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x78b9a2,[],async(_0x39f4c8,_0x4bd834)=>{if(_0x39f4c8)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x39f4c8['message']),_0x33cb37({'status':'error','message':_0x39f4c8['message']});else try{const _0x476f9e=await Promise['all'](_0x4bd834['map'](_0x3c226f=>{return new Promise(_0x43bfd2=>{if(!_0x3c226f['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x3c226f['campaign_name']),_0x43bfd2({'campaign_name':_0x3c226f['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x332183='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x3c226f['list_id'],_0x2b7e76='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20'+_0x3c226f['list_id']+'\x20WHERE\x20contacted\x20=\x201';db['get'](_0x332183,[],(_0x573681,_0x55b0b6)=>{_0x573681?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x3c226f['campaign_name']+':',_0x573681['message']),_0x43bfd2({'campaign_name':_0x3c226f['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):db['get'](_0x2b7e76,[],(_0x4baf65,_0x5d6cba)=>{_0x4baf65?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x3c226f['campaign_name']+':',_0x4baf65['message']),_0x43bfd2({'campaign_name':_0x3c226f['campaign_name'],'lead_count':_0x55b0b6?_0x55b0b6['lead_count']:0x0,'contacted_count':'N/A'})):_0x43bfd2({'campaign_name':_0x3c226f['campaign_name'],'lead_count':_0x55b0b6?_0x55b0b6['lead_count']:0x0,'contacted_count':_0x5d6cba?_0x5d6cba['contacted_count']:0x0});});});});}));_0x583ace({'status':'success','campaigns':_0x476f9e});}catch(_0x159338){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x159338),_0x33cb37({'status':'error','message':_0x159338['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x2299a9,_0x55fb70)=>{return new Promise((_0x3290b6,_0x28d5bc)=>{const _0x3ad7e1='SELECT\x20campaign.list_id,\x20message.message_text,\x20campaign.zeitabstand,\x20campaign.account\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x3ad7e1,[_0x55fb70],(_0x1b4919,_0x40ebf7)=>{_0x1b4919?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x1b4919),_0x28d5bc(_0x1b4919)):(console['log']('ROWS'),console['log'](_0x40ebf7),debugDatabaseContents(),_0x3290b6(_0x40ebf7));});});});const showTableContents=_0x4177c3=>{return new Promise((_0x45a621,_0xac72aa)=>{const _0x22eabb='SELECT\x20*\x20FROM\x20'+_0x4177c3+';';campaignDB['all'](_0x22eabb,(_0x4f09e6,_0x3f86e5)=>{_0x4f09e6?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x4177c3+':',_0x4f09e6),_0xac72aa(_0x4f09e6)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x4177c3+':',_0x3f86e5),_0x45a621({'status':'success','message':_0x3f86e5}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x1b9419){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x1b9419);}}ipcMain['handle']('create-campaign',async(_0x1982ba,_0x3e688a)=>{return new Promise((_0x11351b,_0x56b2df)=>{const _0x80a99c='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x80a99c,[String(_0x3e688a)],function(_0x1ea3a7){_0x1ea3a7?_0x56b2df(_0x1ea3a7):_0x11351b({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x26d945,_0x436c7a)=>{return new Promise((_0x473c84,_0x48c526)=>{const _0x5af199='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x5af199,[_0x436c7a],function(_0x540fc0){_0x540fc0?_0x48c526(_0x540fc0):_0x473c84({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x31c307,_0x514e7e,_0x5b8165,_0x20621f,_0x2f6ca9,_0x4d054d)=>{const _0x201d1f=await createMessageID(_0x2f6ca9);return new Promise((_0xf5d686,_0x150703)=>{if(!_0x514e7e||!_0x5b8165||!_0x20621f||!_0x201d1f||!_0x4d054d)return _0x150703({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x201d1f);const _0x288260='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x288260,[_0x5b8165,_0x20621f,_0x201d1f,_0x4d054d,_0x514e7e],function(_0x43e462){if(_0x43e462)_0x150703({'status':'error','message':_0x43e462['message']});else this['changes']===0x0?_0x150703({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0xf5d686({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x588c25,_0x5ee6b9,_0x2e791c,_0x187d55)=>{return new Promise((_0x6d9290,_0x448260)=>{const _0x16abc0='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username)\x20VALUES\x20(?,\x20?,\x20?)';campaignDB['run'](_0x16abc0,[_0x5ee6b9,_0x2e791c,_0x187d55],function(_0x3d9f60){return _0x3d9f60?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x3d9f60['message']),_0x448260('insert-dm-response',{'success':![],'message':_0x3d9f60['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x6d9290('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x251f72=>{return new Promise((_0x2586c8,_0x62b740)=>{const _0x618cc='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x618cc,[_0x251f72],(_0x4d90f5,_0x3ad027)=>{if(_0x4d90f5)_0x62b740({'status':'error','message':_0x4d90f5['message']});else{if(_0x3ad027)_0x2586c8(_0x3ad027['message_id']);else{const _0x330c7e='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x330c7e,[_0x251f72],function(_0x20ccdb){_0x20ccdb?_0x62b740({'status':'error','message':_0x20ccdb['message']}):_0x2586c8(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x45810c,_0x230813)=>{return new Promise((_0x1fc482,_0x4d6807)=>{const _0x34900e='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x230813;db['get'](_0x34900e,(_0x382404,_0x46b5fc)=>{_0x382404?_0x4d6807({'status':'error','message':_0x382404['message']}):_0x1fc482({'status':'success','count':_0x46b5fc['count']});});});});const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20password\x20TEXT,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x3590d1,_0x4a74e9){try{const _0x544e12=await new Promise((_0x22581d,_0x512d71)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x4a74e9],(_0x68e0f0,_0x258376)=>{if(_0x68e0f0)_0x512d71(_0x68e0f0);else{if(_0x258376['length']>0x0){let _0x45e281=JSON['parse'](_0x258376[0x0]['cookie']);console['log'](_0x45e281),_0x22581d(_0x45e281);}else _0x512d71(new Error('User\x20with\x20username\x20'+_0x4a74e9+'\x20does\x20not\x20exist.'));}});});await _0x3590d1['setCookie'](..._0x544e12),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x572a09){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x572a09);}}async function saveCookiesForUser(_0xd2fcf8,_0x3f434a){try{let _0x4d2846=await _0xd2fcf8['cookies']();_0x4d2846=JSON['stringify'](_0x4d2846),igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x3f434a],(_0x307bdb,_0x544abb)=>{if(_0x307bdb){console['error']('Error\x20checking\x20user\x20existence:',_0x307bdb);throw _0x307bdb;}else{if(_0x544abb){const _0x5d1c0c=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x5d1c0c['run'](_0x4d2846,_0x3f434a,function(_0x5827af){_0x5827af?console['error']('Error\x20updating\x20cookies:',_0x5827af):console['log']('Cookies\x20updated\x20for\x20user:',_0x3f434a);});}else{const _0x40f58a=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x40f58a['run'](_0x3f434a,_0x4d2846,function(_0x330ea3){_0x330ea3?console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x330ea3):console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x3f434a);});}}});}catch(_0x5be2ed){console['error']('Error\x20fetching\x20cookies:',_0x5be2ed);throw _0x5be2ed;}}async function createUserIfNotExists(_0x129a45,_0x40a6ee){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x129a45],(_0x5ea5d4,_0x21b426)=>{if(_0x5ea5d4){console['error']('Error\x20checking\x20user\x20existence:',_0x5ea5d4);throw _0x5ea5d4;}else{if(!_0x21b426){const _0x1c2691=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20password)\x20VALUES\x20(?,\x20?)');_0x1c2691['run'](_0x129a45,_0x40a6ee,function(_0x9d50e9){_0x9d50e9?console['error']('Error\x20inserting\x20new\x20user:',_0x9d50e9):console['log']('New\x20user\x20created:',_0x129a45);});}else console['log']('User\x20already\x20exists:',_0x129a45);}});}catch(_0x559641){console['error']('Error\x20creating\x20user:',_0x559641);throw _0x559641;}}ipcMain['handle']('create-relation',async(_0x36510d,_0x1c214c)=>{return new Promise((_0x13f613,_0x10c442)=>{const _0x43fc95='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x1c214c+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT)';db['run'](_0x43fc95,function(_0x264ff0){_0x264ff0?_0x10c442(_0x264ff0):_0x13f613({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x5b6086,_0x3d57c6)=>{return console['log']('droping\x20table'+_0x3d57c6),new Promise((_0x160e86,_0x1b732d)=>{const _0x32338c='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x3d57c6;console['log']('droping\x20table'+_0x3d57c6),db['run'](_0x32338c,function(_0x6dc86c){_0x6dc86c?_0x1b732d(_0x6dc86c):_0x160e86({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x1ff4e9=>{return new Promise((_0x4293f3,_0xe21a13)=>{const _0x460e90='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x460e90,[],(_0x273f6e,_0x1773b9)=>{_0x273f6e?_0xe21a13(_0x273f6e):_0x4293f3(_0x1773b9['map'](_0x519a4b=>_0x519a4b['name']));});});}),ipcMain['handle']('add-user',async(_0x583b0a,_0x200a3c,_0x1d19d1)=>{return new Promise(_0x2cbd69=>{const _0x317f3c=db['prepare']('INSERT\x20INTO\x20'+_0x1d19d1+'\x20(username)\x20VALUES\x20(?)');_0x317f3c['run'](_0x200a3c,function(_0x48b674){_0x48b674?console['log']('error\x20in\x20add-user:'+_0x48b674):_0x2cbd69({'status':'success','id':this['lastID']});}),_0x317f3c['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x39b630,_0x2d0f7f)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x2aa810,_0x3fbdc9)=>{if(_0x2aa810)_0x2d0f7f(_0x2aa810);else{_0x39b630({'status':'success','users':_0x3fbdc9});for(_0x3fbdc9 of _0x3fbdc9){console['log'](_0x3fbdc9['username']);}}});});}),ipcMain['handle']('get-data',async(_0x29ff03,_0x3c751f)=>{return new Promise((_0x1d5648,_0x11874c)=>{const _0x38771d='SELECT\x20*\x20FROM\x20'+_0x3c751f;console['log'](_0x38771d),db['all'](_0x38771d,[],(_0x5559e8,_0x3ccdfe)=>{_0x5559e8?_0x11874c(_0x5559e8):_0x1d5648(_0x3ccdfe);});});}),ipcMain['handle']('get-accounts',async _0x27d691=>{return new Promise((_0x262390,_0x3904c8)=>{const _0x308612='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x308612),igaccountsDB['all'](_0x308612,[],(_0x568a77,_0x43b1c6)=>{_0x568a77?_0x3904c8(_0x568a77):_0x262390(_0x43b1c6);});});}),ipcMain['handle']('get-targets',async(_0x2dc377,_0x52ee0d)=>{return getTargetProfiles(_0x52ee0d);}),ipcMain['handle']('delete-user',async(_0x2ec078,_0x98de25,_0x4f6459)=>{return new Promise((_0x76a8f,_0x657212)=>{const _0x5446bd=db['prepare']('DELETE\x20FROM\x20'+_0x4f6459+'\x20WHERE\x20username\x20=\x20?');_0x5446bd['run'](_0x98de25,function(_0x34760e){_0x34760e?_0x657212(_0x34760e):_0x76a8f({'status':'success','changes':this['changes']});}),_0x5446bd['finalize']();});}),ipcMain['handle']('delete-account',async(_0x37d06e,_0x52b94a)=>{const _0x3c83ce=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x3c83ce['run'](_0x52b94a,function(_0x4bf052){_0x4bf052&&console['log'](_0x4bf052);}),_0x3c83ce['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x598ede,_0x14d143)=>{const _0x20844d='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x20844d,[],(_0x5103be,_0x35f4a7)=>{_0x5103be?_0x14d143({'status':'error','message':_0x5103be['message']}):_0x598ede({'status':'success','contactedCount':_0x35f4a7['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x593d06,_0x177ff4)=>{const _0x50570e='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x50570e,[],(_0x4a932a,_0x33492e)=>{_0x4a932a?_0x177ff4({'status':'error','message':_0x4a932a['message']}):_0x593d06({'status':'success','contactedCount':_0x33492e['contactedCount']});});});});