const {app,BrowserWindow,ipcMain,dialog,shell,powerSaveBlocker}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),fs_no_promise=require('fs');async function extractFirstName(_0x5f0ab2,_0x503553){try{const _0x4c1702=await fetch('https://extractfirstname-dnfofjyvnq-uc.a.run.app',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x503553},'body':JSON['stringify']({'clearname':_0x5f0ab2})});if(!_0x4c1702['ok']){const _0x3fe6f7=await _0x4c1702['text']();throw new Error(_0x4c1702['status']+':\x20'+_0x3fe6f7);}const _0x2bbc8c=await _0x4c1702['json']();return _0x2bbc8c;}catch(_0x29bf94){console['error']('Error\x20in\x20extractFirstName:',_0x29bf94);throw _0x29bf94;}}const ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Message\x27]','div.x9f619.xjbqb8w.x78zum5.x15mokao.x1ga7v0g.x16uus16.xbiv7yw.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div','div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div'],K_OPTIONS_BUTTON=['[aria-label=\x22Options\x22]','section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.x1jfgfrl\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div'],K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD='div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f',K_SEND_MSG_BUTTON=['//div[@role=\x27button\x27\x20and\x20normalize-space(text())=\x27Send\x27]','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.x5c86q.x18br7mf.x1i0vuye.xl0gqc1.xr5sc7.xlal1re.x14jxsvd.xt0b8zv.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x7fd4wk.x1sfzahb.xfs2ol5','div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5'],K_ALREADY_CHATTED=['[role=\x22button\x22][aria-label=\x22Double\x20tap\x20to\x20like\x22]','div.html-div.xdj266r.x14z9mp.xat24cr.x1lziwak.xexx8yu.xyri2b.x18d9i69.x1c1uobl.x6ikm8r.x10wlt62\x20>\x20div\x20>\x20span'],K_MSG_DISABLED_LABEL='div.x6s0dn4.x1yvgwvq.x1dqoszc.x1ixjvfu.xhk4uv.x13fuv20.xu3j5b3.x1q0q8m5.x26u7qi.x178xt8z.xm81vs4.xso031l.xy80clv.x78zum5.x1gg8mnh\x20>\x20div\x20>\x20span',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x50071b=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x50071b['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x50071b['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x34f060){var _0x3ce145=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x33ef1c){console['log']('window\x20id:'+_0x33ef1c['id']),_0x33ef1c['id']>0x1&&(_0x3ce145=!![]);}),console['log']('child\x20opened\x20='+_0x3ce145);if(!_0x3ce145){const _0x1eb4b5=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x1eb4b5['loadFile'](_0x34f060['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{process['platform']==='darwin'&&(console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0));});let powerSaveBlockerId;app['on']('ready',()=>{powerSaveBlockerId=powerSaveBlocker['start']('prevent-app-suspension'),console['log']('Power\x20Save\x20Blocker\x20gestartet\x20mit\x20ID:\x20'+powerSaveBlockerId);}),app['on']('before-quit',()=>{powerSaveBlocker['isStarted'](powerSaveBlockerId)&&(powerSaveBlocker['stop'](powerSaveBlockerId),console['log']('Power\x20Save\x20Blocker\x20gestoppt.'));if(process['defaultApp']){console['log']('Testmodus\x20–\x20Update\x20wird\x20übersprungen');return;}customUpdateMacApp();});function initializeDatabase(){const _0x4d8f11=require('fs'),_0x2ebac5=path['join'](app['getPath']('userData'),'data'),_0x12e651=['campaign.db','crm.db','igaccounts.db'],_0x35546e=[];try{_0x4d8f11['mkdirSync'](_0x2ebac5,{'recursive':!![]});for(const _0x4a53ae of _0x12e651){const _0x10c677=path['join'](process['resourcesPath'],'app','build','data',_0x4a53ae),_0x3c7c97=path['join'](_0x2ebac5,_0x4a53ae);!_0x4d8f11['existsSync'](_0x3c7c97)?(_0x4d8f11['copyFileSync'](_0x10c677,_0x3c7c97),console['log']('[InitDB]\x20Kopiert\x20'+_0x4a53ae+'\x20nach:\x20'+_0x3c7c97)):console['log']('[InitDB]\x20'+_0x4a53ae+'\x20existiert\x20bereits:\x20'+_0x3c7c97),_0x35546e['push'](_0x3c7c97);}}catch(_0x1c335f){console['error']('[InitDB]\x20Fehler\x20beim\x20Kopieren\x20der\x20Datenbanken:',_0x1c335f);}return _0x35546e;}function getSqlDataPath(){return console['log']('MAC\x20Pfad:\x20',app['getPath']('userData')),console['log']('Default\x20App:\x20'+process['defaultApp']),process['platform']==='darwin'?(!process['defaultApp']&&initializeDatabase(),process['defaultApp']?path['join'](__dirname,'data'):path['join'](app['getPath']('userData'),'data')):process['defaultApp']?path['join'](__dirname,'data'):path['join'](process['resourcesPath'],'app.asar.unpacked','build','data');}console['log']('Datenpfad\x20SQL:\x20'+getSqlDataPath());const SqlDataDirectory=getSqlDataPath();function doFullElectronUpdate(){const {autoUpdater:_0x5bf355,AppUpdate:_0x4d8bf3}=require('electron-updater');_0x5bf355['autoDownload']=![],_0x5bf355['autoInstallOnAppQuit']=!![],_0x5bf355['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x5bf355['on']('update-available',_0x4316a9=>{console['log']('Update\x20verfügbar:',_0x4316a9),_0x5bf355['downloadUpdate']();}),_0x5bf355['on']('update-downloaded',_0x3a511a=>{console['log']('Update\x20heruntergeladen:',_0x3a511a),_0x5bf355['quitAndInstall']();}),_0x5bf355['on']('error',_0x587584=>{console['error']('Fehler\x20beim\x20Updaten:',_0x587584);});}function doFullElectronUpdateSilent(){const {autoUpdater:_0x4f2fa7,AppUpdate:_0x47a881}=require('electron-updater');_0x4f2fa7['autoDownload']=![],_0x4f2fa7['autoInstallOnAppQuit']=!![],_0x4f2fa7['checkForUpdates'](),console['log']('Überprüfe\x20auf\x20Updates...'),_0x4f2fa7['on']('update-available',_0x34763a=>{console['log']('Update\x20verfügbar:',_0x34763a),_0x4f2fa7['downloadUpdate']();}),_0x4f2fa7['on']('update-downloaded',_0x13c710=>{console['log']('Update\x20heruntergeladen:',_0x13c710),console['log']('Neustarten\x20zum\x20Updaten');}),_0x4f2fa7['on']('error',_0x52be67=>{console['error']('Fehler\x20beim\x20Updaten:',_0x52be67);});}const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0xe68938='',_0x54f6cd=null;if(process['platform']==='darwin')_0xe68938=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0xe68938=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0xe68938}),_0x54f6cd=await browser_login['newPage'](),_0x54f6cd['setDefaultNavigationTimeout'](0x1d4c),_0x54f6cd['setDefaultTimeout'](0x1d4c),await _0x54f6cd['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),_0x54f6cd;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x33b8c0=0x1,_0x193107=0x0){try{let _0x1f3014='',_0x4c47ff=null;const _0x510201=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x1f3014=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x1f3014=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x33b8c0===0x0&&!pageStack[_0x193107])return browser=await puppeteer['launch']({'headless':_0x510201,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x1f3014}),_0x4c47ff=await browser['newPage'](),_0x4c47ff['setDefaultNavigationTimeout'](0x1d4c),_0x4c47ff['setDefaultTimeout'](0x1d4c),await _0x4c47ff['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x193107]=_0x4c47ff,_0x4c47ff;return(browser===null||pageStack[_0x193107]===null||pageStack[_0x193107]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x510201,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x1f3014})),(pageStack[_0x193107]===null||pageStack[_0x193107]['isClosed']())&&(_0x4c47ff=await browser['newPage'](),_0x4c47ff['setDefaultNavigationTimeout'](0x1d4c),_0x4c47ff['setDefaultTimeout'](0x1d4c),await _0x4c47ff['setExtraHTTPHeaders']({'Accept-Language':'en-US,en'}),pageStack[_0x193107]=_0x4c47ff),pageStack[_0x193107];}catch(_0x2d74cf){console['error']('Failed\x20to\x20launch\x20browser:',_0x2d74cf);const _0x40cc04=new Error('Browser\x20konnte\x20nicht\x20gestartet\x20werden.\x20Bitte\x20starte\x20die\x20App\x20neu.\x20:\x20'+_0x2d74cf);throw _0x40cc04;}}ipcMain['on']('login',async(_0x2b7490,_0x5141ac)=>{const _0x4a7db4=await getBrowserPageLogin();await _0x4a7db4['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x4a7db4,_0x5141ac),ipcMain['on']('setLoginCookies',async(_0x1a0435,_0x3ee942)=>{try{await set_login_cookies(_0x4a7db4,_0x3ee942);}catch(_0x4773c8){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x4773c8);}});}),ipcMain['on']('export-relation',async(_0x5e7ccc,_0x1f2f95)=>{try{await exportDatabase(_0x1f2f95),_0x5e7ccc['reply']('export-relation-response',{'success':!![]});}catch(_0x4583ca){console['error'](_0x4583ca),_0x5e7ccc['reply']('export-relation-response',{'success':![],'message':_0x4583ca['message']});}}),ipcMain['handle']('sendMessage',async(_0x172a0e,_0x19a032,_0x34fc2b,_0x2b954d,_0x5de70f,_0x38537d,_0x3a1e21,_0x53acee,_0x3b7326,_0x2e3411,_0x4db2b7)=>{isStopping=![];let _0x29f6dd=null;return _0x3a1e21?_0x29f6dd=await getBrowserPage(_0x5de70f,_0x53acee):_0x29f6dd=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x19a032),send_message(_0x29f6dd,_0x19a032,_0x34fc2b,_0x2b954d,_0x5de70f,_0x38537d,_0x3b7326,_0x2e3411,_0x4db2b7);}),ipcMain['handle']('stop-action',async(_0x58751d,_0x4d302d)=>{isStopping=!![];const _0x143266=await getBrowserPage(0x1,_0x4d302d);await _0x143266['close']();}),ipcMain['handle']('fetch_followers',async(_0x36aa8b,_0x37f894,_0x2a23df,_0x220e4b,_0x172765,_0x286dc7)=>{isStopping=![];const _0x1bcba9=await getBrowserPage();return fetch_followers_from_account(_0x36aa8b,_0x1bcba9,_0x37f894,_0x2a23df,_0x220e4b,_0x172765,_0x286dc7);}),ipcMain['handle']('get-account-details',async(_0x404169,_0x38a98e,_0x448d2e,_0x150afa)=>{isStopping=![];const _0x35707c=await getBrowserPage();return fetch_account_details(_0x35707c,_0x38a98e,_0x448d2e,_0x150afa);}),ipcMain['handle']('fetch_likes',async(_0x37fcb9,_0x3c3674,_0x80b04e,_0x37730b,_0x2ebd86,_0x7ca1a1)=>{isStopping=![];const _0x5a380e=await getBrowserPage();return fetch_likers_from_post(_0x37fcb9,_0x5a380e,_0x3c3674,_0x80b04e,_0x37730b,_0x2ebd86,_0x7ca1a1);}),ipcMain['handle']('fetch_comments',async(_0x237a56,_0x31b01b,_0x570b25,_0x58b660,_0x430be0,_0x522bf9)=>{isStopping=![];const _0x4bd1f8=await getBrowserPage();return fetch_comments_from_post(_0x237a56,_0x4bd1f8,_0x31b01b,_0x570b25,_0x58b660,_0x430be0,_0x522bf9);});async function updateAppSilent(){const {spawn:_0x30caff}=require('child_process'),_0xd8579a=require('path'),_0x12fadd=require('electron-log');return _0x12fadd['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x32a028,_0x5d369b)=>{const {updateElectronApp:_0x58f0b1,UpdateSourceType:_0x1548e4}=require('update-electron-app');_0x58f0b1({'updateSource':{'type':_0x1548e4['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x12fadd}),_0x32a028('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x3648da,_0x37fd39)=>{doFullElectronUpdateSilent(),_0x3648da('Update\x20erfolgreich\x20abgeschlossen.');});}async function updateApp(){const {spawn:_0x222975}=require('child_process'),_0x5665fc=require('path'),_0x38fb22=require('electron-log');return _0x38fb22['transports']['console']['level']='debug',process['platform']==='darwin'?new Promise((_0x4657f3,_0x14bfb6)=>{const {updateElectronApp:_0x3be5ae,UpdateSourceType:_0x4557af}=require('update-electron-app');_0x3be5ae({'updateSource':{'type':_0x4557af['ElectronPublicUpdateService'],'repo':'derminer007/Instabot_app_updater'},'updateInterval':'10\x20minutes','logger':_0x38fb22}),_0x4657f3('Update\x20erfolgreich\x20abgeschlossen.');}):new Promise((_0x2689f0,_0x106046)=>{doFullElectronUpdate(),_0x2689f0('Update\x20erfolgreich\x20abgeschlossen.');});}async function customUpdateMacApp(){return new Promise((_0x19ee2f,_0x527be4)=>{if(process['defaultApp'])console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x19ee2f('Update\x20übersprungen');else{if(process['platform']==='darwin'){const _0x8671df=path['join'](__dirname,'mac-updater-intern.sh'),_0x7d1c86=spawn('/bin/bash',[_0x8671df],{'detached':!![],'stdio':'ignore'});_0x7d1c86['unref'](),setTimeout(()=>{_0x19ee2f('Update-Prozess\x20im\x20detached\x20Modus\x20gestartet.');},0x1388);}else{if(process['platform']==='win32'){}else _0x527be4(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}}});}ipcMain['handle']('get-os-system',async _0xbf0f31=>{return{'platform':process['platform'],'arch':process['arch']};}),ipcMain['handle']('update-app',async(_0x384385,_0x458ee7)=>{console['log']('Update\x20Silent:\x20'+_0x458ee7);if(_0x458ee7){if(!(process['platform']==='darwin'))await updateAppSilent(),console['log']('Autoupdate\x20für\x20Mac\x20ausgeschaltet');else return await customUpdateMacApp();}else{if(!(process['platform']==='darwin'))await updateApp();else return await customUpdateMacApp();}});function getRnd(_0x5018ba,_0x188431){return Math['random']()*(_0x188431-_0x5018ba+0x1)+_0x5018ba;}function delay(_0x431237,_0xddefff){let _0x311dc8=getRnd(_0x431237,_0xddefff);return new Promise(function(_0x3c19bd){setTimeout(_0x3c19bd,_0x311dc8);});}async function scroll(_0x1cd49e,_0x2fe5f9,_0x22ac5c=0x2,_0x3254e6){const _0x38613e=await _0x1cd49e['waitForSelector'](_0x2fe5f9);for(let _0x2a7684=0x0;_0x2a7684<_0x22ac5c;_0x2a7684++){console['log']('Scrolling\x20'+_0x2a7684),await _0x1cd49e['evaluate'](_0x1c77e5=>{const _0x380139=document['querySelector'](_0x1c77e5);_0x380139&&_0x380139['scrollBy'](0x0,0x190);},_0x2fe5f9),await delay(0x320,0x5dc),_0x3254e6();}}async function saveCookies(_0x283149){let _0x37b532=await _0x283149['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x37b532,null,0x2));}async function notificationClear(_0x51d621){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x51d621['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x51d621['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x6aaf3a){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x6aaf3a);}}async function getTargetProfiles(_0x55793f){return new Promise((_0x4d067b,_0x582707)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x55793f,(_0xf7f31d,_0x12188e)=>{_0xf7f31d?_0x582707(_0xf7f31d):_0x4d067b(_0x12188e);});});}async function login_legacy(_0xaa41b9,_0x299c1c,_0x12d01b){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0xaa41b9,_0x299c1c),await createUserIfNotExists(_0x299c1c,_0x12d01b);}catch(_0x13e4b0){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x13e4b0);}try{await _0xaa41b9['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0xaa41b9['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0xaa41b9['click']('button._a9--._ap36._a9_0');}catch(_0x157408){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0xaa41b9['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0xaa41b9['type']('input[name=\x27username\x27]',_0x299c1c,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0xaa41b9['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0xaa41b9['type']('input[name=\x27password\x27]',_0x12d01b,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0xaa41b9['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0xaa41b9['click']('button[type=\x27submit\x27]');}catch(_0x332659){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0xaa41b9),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0xaa41b9,_0x299c1c);}catch(_0x2a0156){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x2a0156);}}catch(_0x1a88be){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x1a88be);}}async function login(_0x1c6f61,_0x6ec6a6){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x1c6f61,_0x6ec6a6),await createUserIfNotExists(_0x6ec6a6);}catch(_0x157717){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x157717);}try{await _0x1c6f61['goto']('https://www.instagram.com/accounts/login/');}catch(_0x29594f){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x29594f);}}async function set_login_cookies(_0x5c1a9a,_0x3db64e){try{await saveCookiesForUser(_0x5c1a9a,_0x3db64e);}catch(_0x2cdb3a){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x2cdb3a);}}async function waitForXPath(_0x237068,_0x476961,_0xdc436={}){return await _0x237068['waitForFunction'](_0x2e5299=>{return document['evaluate'](_0x2e5299,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0xdc436,_0x476961),_0x237068['evaluateHandle'](_0x6c4175=>document['evaluate'](_0x6c4175,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x476961);}async function waitForSelectorWithFallbacks(_0x125810,_0x3bc6f0,_0x5d4588={}){!Array['isArray'](_0x3bc6f0)&&(_0x3bc6f0=[_0x3bc6f0]);for(let _0xaa507b=0x0;_0xaa507b<_0x3bc6f0['length'];_0xaa507b++){const _0x1f8cef=_0x3bc6f0[_0xaa507b],_0x57a488=_0x1f8cef['startsWith']('//')||_0x1f8cef['startsWith']('(//');try{console['log']('Versuche\x20'+(_0x57a488?'XPath':'Selector')+'\x20'+(_0xaa507b+0x1)+'/'+_0x3bc6f0['length']+':\x20'+_0x1f8cef['substring'](0x0,0x32)+'...');const _0x31ea69=_0xaa507b===0x0?_0x5d4588['timeout']||0x1388:0x7d0;let _0x52bd82;if(_0x57a488){const _0x52af21=await waitForXPath(_0x125810,_0x1f8cef,{..._0x5d4588,'timeout':_0x31ea69});if(!_0x52af21)throw new Error('XPath-Element\x20nicht\x20gefunden');_0x52bd82=_0x52af21;}else _0x52bd82=await _0x125810['waitForSelector'](_0x1f8cef,{..._0x5d4588,'timeout':_0x31ea69});return console['log']((_0x57a488?'XPath':'Selector')+'\x20'+(_0xaa507b+0x1)+'\x20gefunden!'),_0x52bd82;}catch(_0x50b2fb){console['log']((_0x57a488?'XPath':'Selector')+'\x20'+(_0xaa507b+0x1)+'\x20nicht\x20gefunden:\x20'+_0x50b2fb['message']);if(_0xaa507b===_0x3bc6f0['length']-0x1)throw new Error('Keiner\x20der\x20'+_0x3bc6f0['length']+'\x20Selektoren/XPath\x20konnte\x20gefunden\x20werden:\x20'+_0x50b2fb['message']);}}throw new Error('Keine\x20Selektoren/XPath\x20angegeben');}async function send_message(_0x581cdd,_0xb68200,_0x2fe3b2,_0x2aab46,_0x4f4d3d,_0x5f1590,_0x42d4a3,_0x8e7f63,_0x3fd393){return new Promise(async(_0x5d3f82,_0x13b957)=>{_0x5f1590=_0x5f1590['split'](';'),console['log'](_0x5f1590[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x4f4d3d);try{await setCookiesForUser(_0x581cdd,_0x5f1590[0x0]);}catch(_0x342e10){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x342e10),_0x5d3f82({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x342e10});return;}try{await _0x581cdd['goto']('https://www.instagram.com/'+_0xb68200+'/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x581cdd);}catch(_0xb3c3e8){_0x5d3f82({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0xb3c3e8});return;}console['log']('UserSkip:\x20'+_0x42d4a3);if(_0x42d4a3==0x1)try{const _0x340060=await _0x581cdd['$eval']('._ap3a._aaco._aacw._aad6._aade',_0x31aa1c=>_0x31aa1c['textContent']['trim']());console['log'](_0x340060);if(_0x340060==='Following'||_0x340060==='Folge\x20ich')return _0x5d3f82({'status':0x199,'message':'Überspringe\x20User:\x20Bereits\x20gefolgt\x20→\x20überspringen'});}catch(_0xb17e5){}try{const _0x5ea297=await waitForSelectorWithFallbacks(_0x581cdd,K_DIRECT_MSG_BUTTON);await _0x5ea297['click']();}catch(_0x5b1cb1){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x5b1cb1);try{try{const _0x3ef7d4=await waitForSelectorWithFallbacks(_0x581cdd,K_OPTIONS_BUTTON);await _0x3ef7d4['click']();}catch(_0x265613){console['log']('Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x265613),_0x5d3f82({'status':0x1f4,'message':'Options-Button\x20nicht\x20gefunden.\x20Nutzer\x20überspringen:\x20'+_0x265613});return;}await delay(0x1f4,0x320);const _0x5bed44=await waitForXPath(_0x581cdd,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x5bed44['click']();}catch(_0x212f89){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x212f89),_0x5d3f82({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x581cdd);}catch(_0x19902d){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x19902d);}try{const _0x12fd00=await _0x581cdd['waitForSelector'](K_CHAT_INPUT_FIELD);if(_0x8e7f63){const _0x3c6ac7=await waitForSelectorWithFallbacks(_0x581cdd,K_ALREADY_CHATTED);if(_0x3c6ac7)return console['log']('Already\x20chatted\x20with\x20this\x20user,\x20skipping:',_0xb68200),_0x5d3f82({'status':0x19a,'message':'Überspringe\x20User:\x20Bereits\x20gechattet\x20→\x20überspringen'});}const _0x3680ad=await _0x581cdd['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x3680ad),_0x2aab46=_0x2aab46['replace']('{USERNAME}',_0xb68200);let _0xd64c1f;if(_0x2aab46['includes']('{NAME}')||_0x2aab46['includes']('{name}'))try{const _0x328f0f=await extractFirstName(_0x3680ad,_0x3fd393);console['log']('Response\x20Clearname\x20valid:\x20'+_0x328f0f['valid']),_0x328f0f['valid']?(_0x2aab46=_0x2aab46['replaceAll'](/{NAME}|{name}/g,_0x328f0f['name']),console['log']('Response\x20Clearname\x20name:\x20'+_0x328f0f['name']),_0xd64c1f=_0x328f0f['name']):(_0x2aab46=_0x2aab46['replaceAll'](/ ?({NAME}|{name})/g,''),_0xd64c1f='UNKNOWN_NAME');}catch(_0x427e8f){console['log'](_0x427e8f['message']),_0xd64c1f=_0x427e8f['message'];let _0x5a22e9=_0x3680ad['replace'](/[^\p{L}\s]/gu,''),_0x328a43=_0x5a22e9['split']('\x20')[0x0];_0x328a43['length']>0x2&&!_0x328a43['includes']('Instagram')?_0x2aab46=_0x2aab46['replaceAll'](/{NAME}|{name}/g,_0x328a43):_0x2aab46=_0x2aab46['replaceAll'](/ ?({NAME}|{name})/g,'');}await _0x12fd00['type'](_0x2aab46,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0xdae42=await waitForSelectorWithFallbacks(_0x581cdd,K_SEND_MSG_BUTTON);await _0xdae42['click'](),await delay(0x320,0x3e8),_0x5d3f82({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!','clearname':_0x3680ad,'extracted_clearname':_0xd64c1f});}catch(_0x407b1a){try{await _0x581cdd['waitForSelector'](K_MSG_DISABLED_LABEL);const _0x2487eb=await _0x581cdd['evaluate'](_0x2c111d=>{return document['querySelector'](_0x2c111d)['textContent'];},K_MSG_DISABLED_LABEL);console['log']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20gefunden:\x20'+_0x2487eb),console['error']('Nicht\x20anschreibbaren\x20Nutzer\x20überspringen:\x20'+_0x407b1a),_0x5d3f82({'status':0x195,'message':'Nicht\x20anschreibbaren\x20Nutzer:\x20'+_0xb68200+'\x20überspringen.'});}catch(_0x57e341){console['error']('Label\x20\x27Not\x20everyone\x20can\x20message\x20this\x20account\x27\x20nicht\x20gefunden:\x20'+_0x57e341),console['error']('Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0xb68200+'\x20:\x20'+_0x57e341),_0x5d3f82({'status':0x196,'message':'Nachricht\x20nicht\x20gesendet\x20an:\x20'+_0xb68200+'\x20:\x20'+_0x57e341});}}});}function handle_fail(_0x3a2290){if(isStopping)return new Promise(_0x255019=>{_0x255019('Scraper\x20gestoppt.');});else{let _0x591114='';switch(_0x3a2290){case 0x0:_0x591114='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x591114='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x591114='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x591114='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x15b865,_0xb26b31)=>{_0xb26b31(_0x591114);});}}async function fetch_account_details(_0x416985,_0x4f7150,_0x5bde54,_0x3f70c2){try{await setCookiesForUser(_0x416985,_0x5bde54['username']);}catch(_0x1e585d){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x1e585d);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x1e585d);return handle_fail(0x0);}_0x416985['setDefaultNavigationTimeout'](0x7530),await _0x416985['goto']('https://www.instagram.com/'+_0x4f7150+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x416985);const _0x4dba42=await _0x416985['evaluate'](()=>{const _0x3d7605=document['querySelector']('meta[property=\x22og:image\x22]');return _0x3d7605?_0x3d7605['getAttribute']('content'):null;});await _0x416985['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x160496=await _0x416985['evaluate'](()=>{const _0x5b5ed5=document['querySelector']('meta[name=\x22description\x22]');if(!_0x5b5ed5)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x5f24b4=_0x5b5ed5['getAttribute']('content');if(!_0x5f24b4)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x5f24b4);const _0x275166=/\s*[–-]\s*/,_0x1ee9ac=_0x5f24b4['split'](_0x275166);if(_0x1ee9ac['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x3fc86b=_0x1ee9ac[0x0],_0x4125b0=_0x1ee9ac[0x1],_0x40b006=_0x3fc86b['split'](',\x20');if(_0x40b006['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x46703f=_0x40b006[0x0]['split']('\x20')[0x0],_0x390e5c=_0x40b006[0x1]['split']('\x20')[0x0],_0x1b8b07=_0x40b006[0x2]['split']('\x20')[0x0];let _0x8e0b7e='',_0x5ac9ec='';const _0x2dd954='\x20on\x20Instagram:\x20',_0x559554=_0x4125b0['split'](_0x2dd954);return _0x8e0b7e=_0x559554[0x0]['trim'](),_0x8e0b7e=_0x8e0b7e['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x559554['length']>0x1&&(_0x5ac9ec=_0x559554[0x1]['trim'](),_0x5ac9ec['startsWith']('\x22')&&_0x5ac9ec['endsWith']('\x22')&&(_0x5ac9ec=_0x5ac9ec['substring'](0x1,_0x5ac9ec['length']-0x1)['trim']()),_0x5ac9ec=_0x5ac9ec['replace'](/&quot;/g,'')['trim']()),{'followers':_0x46703f,'following':_0x390e5c,'posts':_0x1b8b07,'nameText':_0x8e0b7e,'bio':_0x5ac9ec};});console['log']('Extracted\x20profile\x20data:',_0x160496);const _0x5a18e6=_0x160496['nameText'],_0x1d846c=_0x4dba42,_0x289059=_0x160496['bio'],_0x1b7bdf=_0x160496['followers'],_0x4ccc5e=_0x160496['following'],_0x26b362=_0x160496['posts'],_0x33b2c3=![],_0x143429=![],_0x29d639=![],_0x53e520='\x0a\x20\x20INSERT\x20INTO\x20'+_0x3f70c2+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0x53e520,[_0x4f7150,_0x5a18e6,_0x1d846c,_0x289059,_0x1b7bdf,_0x4ccc5e,_0x26b362,_0x33b2c3,_0x143429,_0x29d639],function(_0x1c4945){_0x1c4945?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x1c4945['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x44a628,_0x35cb89,_0xaef61f,_0x2e2053,_0x3aff03,_0x192740,_0x3701e6){let _0x9ccaec=0x4,_0x3db78b=0x0,_0x1a92d3=0x0;try{await setCookiesForUser(_0x35cb89,_0x192740['username']);}catch(_0x50840e){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x50840e);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x50840e);return handle_fail(0x0);}let _0x2a16d9=0x0;try{await _0x35cb89['goto']('https://www.instagram.com/'+_0xaef61f+'/'),await notificationClear(_0x35cb89);try{if(_0x2e2053<=0x0){const _0x22ce8f=await _0x35cb89['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x1917cf=await _0x35cb89['evaluate'](_0xb94e3f=>_0xb94e3f['innerHTML'],_0x22ce8f);_0x2a16d9=Math['ceil'](_0x1917cf/0x4);}else _0x2a16d9=Math['ceil'](_0x2e2053/0x4);_0x9ccaec+=_0x2a16d9,_0x1a92d3=Math['round'](++_0x3db78b/_0x9ccaec*0x64),_0x44a628['sender']['send']('fetch-progress',_0x1a92d3,!![]);let _0x10d393=await _0x35cb89['waitForSelector']('a[href=\x22/'+_0xaef61f+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x10d393['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0xaef61f+'\x20gesichtet'),_0x1a92d3=Math['round'](++_0x3db78b/_0x9ccaec*0x64),_0x44a628['sender']['send']('fetch-progress',_0x1a92d3,!![]);}catch(_0x5491d3){console['log']('Follower\x20Liste\x20von\x20'+_0xaef61f+'\x20nicht\x20gefunden:'+_0x5491d3);throw new Error('Follower\x20Liste\x20von\x20'+_0xaef61f+'\x20nicht\x20gefunden:'+_0x5491d3);return handle_fail(0x0);}}catch(_0x10f1ce){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x10f1ce);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x10f1ce);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x2a16d9),await scroll(_0x35cb89,FOLLOWER_FENSTER,_0x2a16d9,_0x25ac36=>{_0x1a92d3=Math['round'](++_0x3db78b/_0x9ccaec*0x64),_0x44a628['sender']['send']('fetch-progress',_0x1a92d3,!![]);}),await _0x35cb89['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x4aa460=await _0x35cb89['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x472743=await _0x35cb89['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x1a92d3=Math['round'](++_0x3db78b/_0x9ccaec*0x64),_0x44a628['sender']['send']('fetch-progress',_0x1a92d3,!![]);_0x2e2053<=0x0&&(_0x2e2053=_0x4aa460['length']);let _0x12bc39=[];for(let _0x423a5f=0x0;_0x423a5f<_0x4aa460['length']&&_0x423a5f<_0x2e2053;_0x423a5f++){_0x12bc39['push'](await _0x4aa460[_0x423a5f]['evaluate'](_0x2540e2=>_0x2540e2['textContent']));const _0x45e387='INSERT\x20INTO\x20'+_0x3aff03+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x45e387,[await _0x4aa460[_0x423a5f]['evaluate'](_0x50554c=>_0x50554c['textContent']),await _0x472743[_0x423a5f]['evaluate'](_0x5c48b8=>_0x5c48b8['textContent'])],function(_0xa3b6eb){_0xa3b6eb?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x3aff03+'\x27:',_0xa3b6eb['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x1a92d3=Math['round'](++_0x3db78b/_0x9ccaec*0x64),_0x44a628['sender']['send']('fetch-progress',_0x1a92d3,!![]),_0x3701e6&&(_0x44a628['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x44a628,_0x35cb89,_0x192740,_0x3aff03,_0x12bc39)),new Promise(_0x373537=>{_0x373537('Scraping\x20finished!');});}catch(_0x341db4){if(_0x3701e6)throw new Error(_0x341db4);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0xaef61f+'\x20nicht\x20gefunden:\x20'+_0x341db4);return handle_fail(0x0);}}async function fetch_details_from_list(_0x1a35ae,_0x1e7458,_0x1f79dd,_0xb52748,_0x10ac54){let _0x1cd962=0x0,_0x3188bd=0x0;for(let _0x3e05d0=0x0;_0x3e05d0<_0x10ac54['length'];_0x3e05d0++){console['log']('Processing\x20profile:',_0x10ac54[_0x3e05d0]);try{await fetch_account_details(_0x1e7458,_0x10ac54[_0x3e05d0],_0x1f79dd,_0xb52748);}catch(_0x19e735){console['error']('Detailed\x20Scraping\x20von:\x20',_0x10ac54[_0x3e05d0],_0x19e735);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x10ac54[_0x3e05d0]+'\x20'+_0x19e735);}_0x3188bd=Math['round'](++_0x1cd962/_0x10ac54['length']*0x64),_0x1a35ae['sender']['send']('fetch-progress',_0x3188bd,!![],!![]);}}async function fetch_likers_from_post(_0x332f70,_0xe8a5c3,_0x3ff589,_0x17a996,_0x4bf691,_0x5f4c69,_0x2f52cc){let _0x35c02a=0x4,_0x5211f0=0x0,_0xd08e84=0x0;try{await setCookiesForUser(_0xe8a5c3,_0x5f4c69['username']);}catch(_0x132454){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x132454);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x132454);return handle_fail(0x1);return;}_0xd08e84=Math['round'](++_0x5211f0/_0x35c02a*0x64),_0x332f70['sender']['send']('fetch-progress',_0xd08e84,!![]);try{let _0x930a1f=_0x3ff589['substring'](0x0,_0x3ff589['lastIndexOf']('/'));_0x930a1f['includes']('/reel/')&&(_0x930a1f=_0x930a1f['replace']('/reel/','/p/'));let _0x551381=_0x930a1f+'/liked_by';console['log'](_0x551381),await _0xe8a5c3['goto'](_0x551381),await delay(0x7d0,0xfa0),await notificationClear(_0xe8a5c3),await delay(0xc8,0x1f4),_0xd08e84=Math['round'](++_0x5211f0/_0x35c02a*0x64),_0x332f70['sender']['send']('fetch-progress',_0xd08e84,!![]),await _0xe8a5c3['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x2cbfc0=await _0xe8a5c3['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x46eacb=await _0xe8a5c3['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x2cbfc0['length']);let _0x344aa4=path['join'](__dirname,'/likers.csv');_0xd08e84=Math['round'](++_0x5211f0/_0x35c02a*0x64),_0x332f70['sender']['send']('fetch-progress',_0xd08e84,!![]);_0x17a996<=0x0&&(_0x17a996=_0x2cbfc0['length']);try{let _0x50dc05=[];for(let _0x7e60a0=0x0;_0x7e60a0<_0x2cbfc0['length']&&_0x7e60a0<_0x17a996;_0x7e60a0++){_0x50dc05['push'](await _0x2cbfc0[_0x7e60a0]['evaluate'](_0x1eeacc=>_0x1eeacc['textContent']));try{const _0x476c0e='INSERT\x20INTO\x20'+_0x4bf691+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x476c0e,[await _0x2cbfc0[_0x7e60a0]['evaluate'](_0x55a9d4=>_0x55a9d4['textContent']),await _0x46eacb[_0x7e60a0]['evaluate'](_0x5d5ac4=>_0x5d5ac4['textContent'])],function(_0x3c5caf){_0x3c5caf?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x4bf691+'\x27:',_0x3c5caf['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x2eb449){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x7e60a0+'\x20:\x20'+_0x2eb449);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x7e60a0+'\x20:\x20'+_0x2eb449);return handle_fail(0x1);}}return _0xd08e84=Math['round'](++_0x5211f0/_0x35c02a*0x64),_0x332f70['sender']['send']('fetch-progress',_0xd08e84,!![]),_0x2f52cc&&(_0x332f70['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x332f70,_0xe8a5c3,_0x5f4c69,_0x4bf691,_0x50dc05)),new Promise(_0x4eb00f=>{_0x4eb00f('Scraping\x20finished!');});}catch(_0x9902a6){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x9902a6);return handle_fail(0x1);}}catch(_0x168c83){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x168c83);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0x168c83);return handle_fail(0x1);}}async function fetch_comments_from_post(_0xf6f758,_0x1d980e,_0x418c82,_0xffbc36,_0x213bfc,_0x208ed5,_0x5c617f){let _0x38a9ba=0x3,_0x13493=0x0,_0x45acc0=0x0;try{await setCookiesForUser(_0x1d980e,_0x208ed5['username']);}catch(_0x1dcea9){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x1dcea9);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x1dcea9);return handle_fail(0x2);}try{console['log'](_0x418c82),await _0x1d980e['goto'](_0x418c82),await delay(0x7d0,0xfa0),await notificationClear(_0x1d980e),await delay(0xc8,0x1f4);const _0x41f412=COM_COMMENTS_BOX_BODY_DIV;let _0x289847;const _0x2cc993=await _0x1d980e['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x4b4c64=await _0x1d980e['evaluate'](_0x1a704a=>_0x1a704a['innerHTML'],_0x2cc993),_0xe69459=String(_0x4b4c64)['replace'](/[^0-9]/g,''),_0x2c7732=Number(_0xe69459)/0x14;_0xffbc36<=0x0?_0x289847=Math['ceil'](_0x2c7732/0x3):_0x289847=Math['ceil'](_0xffbc36/0x3);_0x38a9ba+=_0x289847,_0x45acc0=Math['round'](++_0x13493/_0x38a9ba*0x64),_0xf6f758['sender']['send']('fetch-progress',_0x45acc0,!![]),console['log']('Auto-scrolls:\x20'+_0x289847),await scroll(_0x1d980e,_0x41f412,_0x289847,_0x389247=>{_0x45acc0=Math['round'](++_0x13493/_0x38a9ba*0x64),_0xf6f758['sender']['send']('fetch-progress',_0x45acc0,!![]);});try{const _0xe1a0b8=COM_REPLY_BUTTON_SPAN;await _0x1d980e['waitForSelector'](_0xe1a0b8),await delay(0x1f4,0x320);const _0x6428fb=await _0x1d980e['$$'](_0xe1a0b8);console['log'](_0x6428fb);let _0x2c6253=_0x6428fb['length'];await delay(0xc8,0x1f4);try{for(let _0x51eaf8=0x0;_0x51eaf8<_0x2c6253;_0x51eaf8++){_0x6428fb[_0x51eaf8]['click'](),await delay(0x320,0x5dc);}}catch(_0x3c600a){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x3c600a);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x3c600a);return handle_fail(0x2);}}catch(_0x3af2e1){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x176954=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x1d980e['waitForSelector'](_0x176954),await delay(0x1f4,0x320),_0x45acc0=Math['round'](++_0x13493/_0x38a9ba*0x64),_0xf6f758['sender']['send']('fetch-progress',_0x45acc0,!![]);const _0x42ac50=await _0x1d980e['$$'](_0x176954);let _0x4e587d=path['join'](__dirname,'/comments.csv');_0xffbc36<=0x0&&(_0xffbc36=_0x42ac50['length']);console['log']('fetch_limit:\x20'+_0xffbc36),console['log']('comments_len:\x20'+_0x42ac50['length']),_0xffbc36++;try{let _0x22ff8a=[];for(let _0x307b78=0x1;_0x307b78<_0x42ac50['length']&&_0x307b78<_0xffbc36;_0x307b78++){try{_0x22ff8a['push'](await _0x42ac50[_0x307b78]['evaluate'](_0x5a1f02=>_0x5a1f02['textContent']));const _0x4bef63=await db['prepare']('INSERT\x20INTO\x20'+_0x213bfc+'\x20(username)\x20VALUES\x20(?)');await _0x4bef63['run'](await _0x42ac50[_0x307b78]['evaluate'](_0x2226a0=>_0x2226a0['textContent']),function(_0x285773){_0x285773&&console['log']('error\x20in\x20add-user:'+_0x285773);}),await _0x4bef63['finalize']();}catch(_0x9fc8cd){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x307b78+'\x20:\x20'+_0x9fc8cd);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x307b78+'\x20:\x20'+_0x9fc8cd);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x45acc0=Math['round'](++_0x13493/_0x38a9ba*0x64),_0xf6f758['sender']['send']('fetch-progress',_0x45acc0,!![]),_0xf6f758['sender']['send']('fetch-progress',0x64,!![]),_0x5c617f&&(_0xf6f758['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0xf6f758,_0x1d980e,_0x208ed5,_0x213bfc,_0x22ff8a)),_0xf6f758['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x280b89=>{_0x280b89('Scraping\x20finished!');});}catch(_0x41e376){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x41e376);return handle_fail(0x2);}}catch(_0x24245b){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x24245b);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x24245b);return handle_fail(0x2);}}async function set_clearname_from_username(_0x3b5724,_0x263197,_0x337f37=null){try{let _0x5abdfd,_0x350e27;const _0x4891d5='SELECT\x20username\x20FROM\x20'+_0x263197+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x4891d5,[],(_0x8f476d,_0x15addb)=>{_0x8f476d&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x8f476d['message']),_0x15addb['length']===0x0&&(_0x350e27=_0x15addb['length']),_0x5abdfd=_0x15addb['map'](_0x5b51f9=>_0x5b51f9['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x350e27);if(_0x350e27===0x0){console['log']('Leave');return;}const _0x5c0f7e=await _0x3b5724['waitForSelector'](IG_SEARCH_BUTTON);await _0x5c0f7e['click'](),await delay(0x4b0,0x7d0);for(let _0x43695e of _0x5abdfd){const _0x1d6704=await _0x3b5724['waitForSelector'](IG_SEARCH_INPUT);await _0x1d6704['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x3b5724['type'](IG_SEARCH_INPUT,_0x43695e,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x5e9c4e=0x1;while(_0x5e9c4e!=0x14){console['log']('Schleife');try{let _0x584f21=IG_NAME_SPAN_PART1+_0x5e9c4e+IG_USERNAME_SPAN_PART2;const _0x39d709=await _0x3b5724['waitForSelector'](_0x584f21),_0x4ce9df=await _0x3b5724['evaluate'](_0x5aee8d=>_0x5aee8d['innerHTML'],_0x39d709);await delay(0xc8,0x1f4);if(_0x4ce9df==_0x43695e){let _0x2b3dfb=IG_NAME_SPAN_PART1+_0x5e9c4e+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x2dba2f=await _0x3b5724['waitForSelector'](_0x2b3dfb);let _0x34caae=await _0x3b5724['evaluate'](_0x31d792=>_0x31d792['innerHTML'],_0x2dba2f);const _0x5492be=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x1b8103=_0x34caae['match'](_0x5492be);_0x1b8103?_0x34caae=_0x1b8103[0x1]['trim']():_0x34caae=_0x34caae['trim']();_0x34caae['includes']('•')&&(_0x34caae=_0x34caae['substring'](0x0,_0x34caae['indexOf']('•')-0x1));const _0x18691c='UPDATE\x20'+_0x263197+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x18691c,[_0x34caae,_0x4ce9df],function(_0x2a64a3){_0x2a64a3&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x2a64a3['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x5e9c4e++;}catch(_0xbcdd13){const _0x3ebf5b='UPDATE\x20'+_0x263197+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x3ebf5b,['',_0x43695e],function(_0x253b5e){_0x253b5e&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x253b5e['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0xbcdd13);break;}}_0x337f37&&_0x337f37();}await _0x5c0f7e['click']();}catch(_0xdd4bf9){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0xdd4bf9);}}const campaignPath=path['join'](SqlDataDirectory,'/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('\x0a\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(\x0a\x20\x20\x20\x20\x20\x20campaign_name\x20\x20\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20list_id\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20zeitabstand\x20\x20\x20\x20\x20REAL,\x0a\x20\x20\x20\x20\x20\x20message_id\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20account\x20\x20\x20\x20\x20\x20\x20\x20\x20TEXT,\x0a\x20\x20\x20\x20\x20\x20skipFollowing\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20skipChatted\x20\x20\x20\x20\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20FOREIGN\x20KEY(message_id)\x20REFERENCES\x20messages(message_id)\x0a\x20\x20\x20\x20)\x0a\x20\x20'),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipFollowing\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('ALTER\x20TABLE\x20campaign\x20ADD\x20COLUMN\x20skipChatted\x20INTEGER\x20DEFAULT\x200',()=>{}),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x4b4c1c,_0x565e5d)=>{const _0x251b6b='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x251b6b,[],(_0x5bebda,_0x565da1)=>{_0x5bebda?_0x565e5d(_0x5bebda):_0x4b4c1c(_0x565da1);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x58b939,_0x1fc3e6)=>{const _0x5b880b='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x5b880b,[],async(_0x3be57e,_0x51658e)=>{if(_0x3be57e)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x3be57e['message']),_0x1fc3e6({'status':'error','message':_0x3be57e['message']});else try{const _0x209de7=await Promise['all'](_0x51658e['map'](_0xb71169=>{return new Promise(_0x47bfc0=>{if(!_0xb71169['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0xb71169['campaign_name']),_0x47bfc0({'campaign_name':_0xb71169['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x3381e3='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0xb71169['list_id'],_0x2250fa='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0xb71169['list_id']+'\x22';db['get'](_0x3381e3,[],(_0x14990e,_0x210e01)=>{_0x14990e?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0xb71169['campaign_name']+':',_0x14990e['message']),_0x47bfc0({'campaign_name':_0xb71169['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x2250fa,[],(_0xb4b6d7,_0x49f9c4)=>{_0xb4b6d7?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0xb71169['campaign_name']+':',_0xb4b6d7['message']),_0x47bfc0({'campaign_name':_0xb71169['campaign_name'],'lead_count':_0x210e01?_0x210e01['lead_count']:0x0,'contacted_count':'N/A'})):_0x47bfc0({'campaign_name':_0xb71169['campaign_name'],'lead_count':_0x210e01?_0x210e01['lead_count']:0x0,'contacted_count':_0x49f9c4?_0x49f9c4['contacted_count']:0x0});});});});}));_0x58b939({'status':'success','campaigns':_0x209de7});}catch(_0x1d2052){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x1d2052),_0x1fc3e6({'status':'error','message':_0x1d2052['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x31404f,_0x5da562)=>{return new Promise((_0x316e57,_0x32fdd5)=>{const _0x86e06d='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account,\x20skipFollowing,\x20skipChatted\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x86e06d,[_0x5da562],(_0x2aef87,_0x135ac2)=>{_0x2aef87?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x2aef87),_0x32fdd5(_0x2aef87)):(console['log']('ROWS'),console['log'](_0x135ac2),debugDatabaseContents(),_0x316e57(_0x135ac2));});});});const showTableContents=_0x3442dc=>{return new Promise((_0x4c741c,_0x2f7f2e)=>{const _0x180299='SELECT\x20*\x20FROM\x20'+_0x3442dc+';';campaignDB['all'](_0x180299,(_0xda0965,_0x45ba7b)=>{_0xda0965?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x3442dc+':',_0xda0965),_0x2f7f2e(_0xda0965)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x3442dc+':',_0x45ba7b),_0x4c741c({'status':'success','message':_0x45ba7b}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x5dc919){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x5dc919);}}ipcMain['handle']('create-campaign',async(_0x4d1af3,_0x400985)=>{return new Promise((_0x4a879f,_0x4fc4de)=>{const _0x3ba7da='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x3ba7da,[String(_0x400985)],function(_0x2bbdcc){_0x2bbdcc?_0x4fc4de(_0x2bbdcc):_0x4a879f({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x2ec278,_0x58584f)=>{return new Promise((_0x504b67,_0x54b1f0)=>{const _0x2da965='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x2da965,[_0x58584f],function(_0x367d5d){_0x367d5d?_0x54b1f0(_0x367d5d):_0x504b67({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x4fd4f2,_0x3453b4,_0x1a3417,_0x246e62,_0x1b36a1,_0x5b5768,_0x5284a4,_0x4ea1ec)=>{const _0x1d1c17=await createMessageID(_0x1b36a1);return new Promise((_0xe18eea,_0x91574f)=>{if(!_0x3453b4||!_0x1a3417||!_0x246e62||!_0x1d1c17||!_0x5b5768)return _0x91574f({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x1d1c17);const _0x351a5e='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?,\x20skipFollowing\x20=\x20?,\x20skipChatted\x20=\x20?\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x351a5e,[_0x1a3417,_0x246e62,_0x1d1c17,_0x5b5768,_0x5284a4,_0x4ea1ec,_0x3453b4],function(_0x176a1d){if(_0x176a1d)_0x91574f({'status':'error','message':_0x176a1d['message']});else this['changes']===0x0?_0x91574f({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0xe18eea({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x1b2cdb,_0x3e8521,_0x4ceeb5,_0x26c844,_0x5b5434)=>{return new Promise((_0x4bfcb0,_0x386ce5)=>{const _0x303908='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x303908,[_0x3e8521,_0x4ceeb5,_0x26c844,_0x5b5434],function(_0x46eb2c){return _0x46eb2c?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x46eb2c['message']),_0x386ce5('insert-dm-response',{'success':![],'message':_0x46eb2c['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x4bfcb0('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x274007=>{return new Promise((_0xabd9db,_0x35c75e)=>{const _0x267443='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x267443,[_0x274007],(_0x3edda2,_0x3f364a)=>{if(_0x3edda2)_0x35c75e({'status':'error','message':_0x3edda2['message']});else{if(_0x3f364a)_0xabd9db(_0x3f364a['message_id']);else{const _0x1dcf3f='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x1dcf3f,[_0x274007],function(_0x3f3497){_0x3f3497?_0x35c75e({'status':'error','message':_0x3f3497['message']}):_0xabd9db(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x4f3124,_0x2b5048)=>{return new Promise((_0x30419b,_0x7d035e)=>{const _0x4ece1e='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x2b5048;db['get'](_0x4ece1e,(_0x2a2450,_0x4f8a6e)=>{_0x2a2450?_0x7d035e({'status':'error','message':_0x2a2450['message']}):_0x30419b({'status':'success','count':_0x4f8a6e['count']});});});});const dbPath=path['join'](SqlDataDirectory,'/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['join'](SqlDataDirectory,'/igaccounts.db');console['log']('igaccountsPath:\x20'+igaccountsPath);const igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x5032ac,_0x33ce87){try{const _0x8465a6=await new Promise((_0x417f24,_0x53e935)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x33ce87],(_0x4b9d94,_0x473318)=>{if(_0x4b9d94)_0x53e935(_0x4b9d94);else{if(_0x473318['length']>0x0){let _0x305cdc=JSON['parse'](_0x473318[0x0]['cookie']);console['log'](_0x305cdc),_0x417f24(_0x305cdc);}else _0x53e935(new Error('User\x20with\x20username\x20'+_0x33ce87+'\x20does\x20not\x20exist.'));}});});await _0x5032ac['setCookie'](..._0x8465a6),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x4fa9fd){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x4fa9fd);}}async function saveCookiesForUser(_0x333805,_0x5c940a){try{const _0x56390b=await _0x333805['cookies']();if(!_0x56390b||_0x56390b['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0x5c940a);const _0x40a8c5=JSON['stringify'](_0x56390b);if(_0x40a8c5['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0x5c940a);return new Promise((_0x24f0e1,_0x1d8c78)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x5c940a],(_0x34da26,_0x580d0c)=>{if(_0x34da26)return console['error']('Error\x20checking\x20user\x20existence:',_0x34da26),_0x1d8c78(_0x34da26);if(_0x580d0c){const _0x575d40=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x575d40['run'](_0x40a8c5,_0x5c940a,function(_0x4a571d){return _0x4a571d?(console['error']('Error\x20updating\x20cookies:',_0x4a571d),_0x1d8c78(_0x4a571d)):(console['log']('Cookies\x20updated\x20for\x20user:',_0x5c940a),_0x24f0e1());});}else{const _0x5dffbd=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x5dffbd['run'](_0x5c940a,_0x40a8c5,function(_0x7e1632){return _0x7e1632?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x7e1632),_0x1d8c78(_0x7e1632)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x5c940a),_0x24f0e1());});}});});}catch(_0x380691){console['error']('Error\x20fetching\x20cookies:',_0x380691);throw _0x380691;}}async function createUserIfNotExists(_0xc5174e){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0xc5174e],(_0x7335e8,_0xa7fb2a)=>{if(_0x7335e8){console['error']('Error\x20checking\x20user\x20existence:',_0x7335e8);throw _0x7335e8;}else{if(!_0xa7fb2a){const _0x5da299=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x5da299['run'](_0xc5174e,function(_0x1b5465){_0x1b5465?console['error']('Error\x20inserting\x20new\x20user:',_0x1b5465):console['log']('New\x20user\x20created:',_0xc5174e);});}else console['log']('User\x20already\x20exists:',_0xc5174e);}});}catch(_0xa4456c){console['error']('Error\x20creating\x20user:',_0xa4456c);throw _0xa4456c;}}ipcMain['handle']('create-relation',async(_0x14acab,_0x467288)=>{return new Promise((_0x5ac5fe,_0xf565bc)=>{const _0x407094='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x467288+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x407094,function(_0x47f7a2){_0x47f7a2?_0xf565bc(_0x47f7a2):_0x5ac5fe({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x4dbcbf,_0x16eb98)=>{return console['log']('droping\x20table'+_0x16eb98),new Promise((_0x56a57d,_0x3c6d2b)=>{const _0x49e4e8='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x16eb98;console['log']('droping\x20table'+_0x16eb98),db['run'](_0x49e4e8,function(_0x38289b){_0x38289b?_0x3c6d2b(_0x38289b):_0x56a57d({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0xf2d6bf=>{return new Promise((_0x2e2cae,_0xbad637)=>{const _0x4454bf='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x4454bf,[],(_0x293e3d,_0x52cfbc)=>{_0x293e3d?_0xbad637(_0x293e3d):_0x2e2cae(_0x52cfbc['map'](_0x3f3cf0=>_0x3f3cf0['name']));});});}),ipcMain['handle']('add-user',async(_0xae54e5,_0xeca609,_0x3406b3)=>{return new Promise(_0x160d20=>{const _0x5e8dc8=db['prepare']('INSERT\x20INTO\x20'+_0x3406b3+'\x20(username)\x20VALUES\x20(?)');_0x5e8dc8['run'](_0xeca609,function(_0x192ccc){_0x192ccc?console['log']('error\x20in\x20add-user:'+_0x192ccc):_0x160d20({'status':'success','id':this['lastID']});}),_0x5e8dc8['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x4ee466,_0x281d04)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x5b81fe,_0x1fd15c)=>{if(_0x5b81fe)_0x281d04(_0x5b81fe);else{_0x4ee466({'status':'success','users':_0x1fd15c});for(_0x1fd15c of _0x1fd15c){console['log'](_0x1fd15c['username']);}}});});}),ipcMain['handle']('get-data',async(_0x577639,_0xe12de3)=>{return new Promise((_0x29dcbb,_0x25a3a8)=>{const _0x53aeb2='SELECT\x20*\x20FROM\x20'+_0xe12de3;console['log'](_0x53aeb2),db['all'](_0x53aeb2,[],(_0x419ae7,_0x455bec)=>{_0x419ae7?_0x25a3a8(_0x419ae7):_0x29dcbb(_0x455bec);});});}),ipcMain['handle']('get-accounts',async _0x5101d0=>{return new Promise((_0x425d25,_0x142904)=>{const _0x73bb94='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x73bb94),igaccountsDB['all'](_0x73bb94,[],(_0x7f1cf4,_0x202f52)=>{_0x7f1cf4?_0x142904(_0x7f1cf4):_0x425d25(_0x202f52);});});}),ipcMain['handle']('get-targets',async(_0x2eab5e,_0xd5d907)=>{return getTargetProfiles(_0xd5d907);}),ipcMain['handle']('delete-user',async(_0x121a85,_0xd7d15f,_0x43fbfd)=>{return new Promise((_0xd5f862,_0xd2873f)=>{const _0x17a254=db['prepare']('DELETE\x20FROM\x20'+_0x43fbfd+'\x20WHERE\x20username\x20=\x20?');_0x17a254['run'](_0xd7d15f,function(_0x90aafc){_0x90aafc?_0xd2873f(_0x90aafc):_0xd5f862({'status':'success','changes':this['changes']});}),_0x17a254['finalize']();});}),ipcMain['handle']('delete-account',async(_0x5ed6c4,_0x11713a)=>{const _0x6712c=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x6712c['run'](_0x11713a,function(_0x13bef1){_0x13bef1&&console['log'](_0x13bef1);}),_0x6712c['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x5c4627,_0x9a0878)=>{const _0x53048b='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x53048b,[],(_0x196921,_0x229ca4)=>{_0x196921?_0x9a0878({'status':'error','message':_0x196921['message']}):_0x5c4627({'status':'success','contactedCount':_0x229ca4['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x1933ae,_0x8f3925)=>{const _0x16b008='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x16b008,[],(_0x1d4c65,_0xcbc91c)=>{_0x1d4c65?_0x8f3925({'status':'error','message':_0x1d4c65['message']}):_0x1933ae({'status':'success','contactedCount':_0xcbc91c['contactedCount']});});});});function exportDatabase(_0x611d19){return new Promise((_0x1f34f1,_0xb237a)=>{const _0x18c4ba='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x611d19+'\x0a\x20\x20\x20\x20';db['all'](_0x18c4ba,[],async(_0x52e1a8,_0x1e8b29)=>{if(_0x52e1a8){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x52e1a8['message']),_0xb237a(_0x52e1a8);return;}if(!_0x1e8b29||_0x1e8b29['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x1f34f1();return;}const _0x3c3f68=XLSX['utils']['json_to_sheet'](_0x1e8b29),_0xaa4bdd=XLSX['utils']['sheet_to_csv'](_0x3c3f68);try{const {canceled:_0x423563,filePath:_0x52049d}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x611d19+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x423563||!_0x52049d){console['log']('Speichern\x20abgebrochen.'),_0x1f34f1();return;}fs['writeFile'](_0x52049d,_0xaa4bdd,'utf8',_0x51deb0=>{_0x51deb0?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x51deb0['message']),_0xb237a(_0x51deb0)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x52049d),_0x1f34f1());});}catch(_0x55c3a7){console['error']('Fehler\x20im\x20Speicherdialog:',_0x55c3a7),_0xb237a(_0x55c3a7);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x3a5353,_0x50aee1)=>{shell['openExternal'](_0x50aee1);});