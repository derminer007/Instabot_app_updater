const {app,BrowserWindow,ipcMain,dialog,shell}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),XLSX=require('xlsx'),ANZAHL_FOLLOWER_BUTTON='section.xc3tme8.x1xdureb.x18wylqe.x13vxnyz.xvxrpd7\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20div\x20>\x20a\x20>\x20div\x20>\x20div\x20>\x20span',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_DIRECT_MSG_BUTTON='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1n2onr6.x6ikm8r.x10wlt62.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div',K_OPTIONS_BUTTON='section.x1xdureb.x1agbcgv.xieb3on.x1lhsz42.xr1yuqi.x6ikm8r.x10wlt62.xs5motx\x20>\x20div\x20>\x20div\x20>\x20div:nth-child(3)\x20>\x20div',K_INNER_MSG_BUTTON='button:nth-child(6)',K_CHAT_INPUT_FIELD='div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f',K_SEND_MSG_BUTTON='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.x7fd4wk.x1sfzahb.xfs2ol5',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x1ae04b=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x1ae04b['loadFile'](path['join'](__dirname,'index.html')),process['env']['NODE_ENV']==='development'&&_0x1ae04b['webContents']['openDevTools']();}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x5582c2){var _0x4ce4c4=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x5ae938){console['log']('window\x20id:'+_0x5ae938['id']),_0x5ae938['id']>0x1&&(_0x4ce4c4=!![]);}),console['log']('child\x20opened\x20='+_0x4ce4c4);if(!_0x4ce4c4){const _0xeeb2b2=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0xeeb2b2['loadFile'](_0x5582c2['url']);}else console['log']('child\x20window\x20opened\x20already');}ipcMain['on']('restart-app',()=>{console['log']('Neustart\x20der\x20Anwendung'),app['relaunch'](),app['exit'](0x0);});const MAC_BROWSER_PATH='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome',WIN_BROWSER_PATH='chromium_local/chrome-win/chrome.exe';let browser_login=null;async function getBrowserPageLogin(){let _0x46b8e8='',_0x5a47bb=null;if(process['platform']==='darwin')_0x46b8e8=MAC_BROWSER_PATH;else{if(process['platform']==='win32')_0x46b8e8=WIN_BROWSER_PATH;else{if(process['platform']==='linux'){}}}return browser_login=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x46b8e8}),_0x5a47bb=await browser_login['newPage'](),_0x5a47bb['setDefaultNavigationTimeout'](0x1d4c),_0x5a47bb['setDefaultTimeout'](0x1d4c),_0x5a47bb;}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x2d3810=0x1,_0xe65351=0x0){let _0x36bd45='',_0x271ba3=null;const _0x490ded=process['env']['NODE_ENV']==='development'?![]:!![];if(process['platform']==='darwin')_0x36bd45=MAC_BROWSER_PATH;else{if(process['platform']==='win32'){_0x36bd45=WIN_BROWSER_PATH;;}else{if(process['platform']==='linux'){}}}if(_0x2d3810===0x0&&!pageStack[_0xe65351])return browser=await puppeteer['launch']({'headless':_0x490ded,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x36bd45}),_0x271ba3=await browser['newPage'](),_0x271ba3['setDefaultNavigationTimeout'](0x1d4c),_0x271ba3['setDefaultTimeout'](0x1d4c),pageStack[_0xe65351]=_0x271ba3,_0x271ba3;return(browser===null||pageStack[_0xe65351]===null||pageStack[_0xe65351]['isClosed']())&&(browser=await puppeteer['launch']({'headless':_0x490ded,'ignoreHTTPSErrors':!![],'defaultViewport':null,'args':['--lang=en-US'],'executablePath':_0x36bd45})),(pageStack[_0xe65351]===null||pageStack[_0xe65351]['isClosed']())&&(_0x271ba3=await browser['newPage'](),_0x271ba3['setDefaultNavigationTimeout'](0x1d4c),_0x271ba3['setDefaultTimeout'](0x1d4c),pageStack[_0xe65351]=_0x271ba3),pageStack[_0xe65351];}ipcMain['on']('login',async(_0x483a52,_0x536420)=>{const _0x26f8e9=await getBrowserPageLogin();await _0x26f8e9['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0x26f8e9,_0x536420),ipcMain['on']('setLoginCookies',async(_0x4e31c6,_0x5545f1)=>{try{await set_login_cookies(_0x26f8e9,_0x5545f1);}catch(_0x51fc2d){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x51fc2d);}});}),ipcMain['on']('export-relation',async(_0x39f799,_0x105b96)=>{try{await exportDatabase(_0x105b96),_0x39f799['reply']('export-relation-response',{'success':!![]});}catch(_0x4075d4){console['error'](_0x4075d4),_0x39f799['reply']('export-relation-response',{'success':![],'message':_0x4075d4['message']});}}),ipcMain['handle']('sendMessage',async(_0x5ef183,_0x4aae9b,_0x4333ad,_0x20e8da,_0x4698fd,_0x3ec37a,_0x1a81b9,_0x11b1c7)=>{isStopping=![];let _0x4252b9=null;return _0x1a81b9?_0x4252b9=await getBrowserPage(_0x4698fd,_0x11b1c7):_0x4252b9=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x4aae9b),send_message(_0x4252b9,_0x4aae9b,_0x4333ad,_0x20e8da,_0x4698fd,_0x3ec37a);}),ipcMain['handle']('stop-action',async(_0x2a3d4f,_0x3365b6)=>{isStopping=!![];const _0xeb3e24=await getBrowserPage(0x1,_0x3365b6);await _0xeb3e24['close']();}),ipcMain['handle']('fetch_followers',async(_0x1fd7ac,_0x2902ed,_0x378352,_0x8ed741,_0x3d655c,_0x35c387)=>{isStopping=![];const _0x109fd9=await getBrowserPage();return fetch_followers_from_account(_0x1fd7ac,_0x109fd9,_0x2902ed,_0x378352,_0x8ed741,_0x3d655c,_0x35c387);}),ipcMain['handle']('get-account-details',async(_0x476212,_0x4c05b2,_0xc345ba,_0x360a87)=>{isStopping=![];const _0xf614e7=await getBrowserPage();return fetch_account_details(_0xf614e7,_0x4c05b2,_0xc345ba,_0x360a87);}),ipcMain['handle']('fetch_likes',async(_0xb74b1f,_0x2c433e,_0x442d00,_0x3466a2,_0x262e25,_0x5b496b)=>{isStopping=![];const _0x1fc8e8=await getBrowserPage();return fetch_likers_from_post(_0xb74b1f,_0x1fc8e8,_0x2c433e,_0x442d00,_0x3466a2,_0x262e25,_0x5b496b);}),ipcMain['handle']('fetch_comments',async(_0x245ec9,_0x3fb784,_0xa4ccac,_0x514433,_0x5f1ff4,_0x594773)=>{isStopping=![];const _0x9db7f9=await getBrowserPage();return fetch_comments_from_post(_0x245ec9,_0x9db7f9,_0x3fb784,_0xa4ccac,_0x514433,_0x5f1ff4,_0x594773);}),ipcMain['handle']('update-app',async _0x1ddf15=>{const {spawn:_0x534546}=require('child_process'),_0x3f1d99=require('path');return new Promise((_0x506193,_0x293e5e)=>{(process['env']['NODE_ENV']==='development'||process['env']['SKIP_UPDATES']==='true')&&(console['log']('Update\x20übersprungen\x20im\x20Testmodus.'),_0x506193('Update\x20übersprungen'));if(process['platform']==='darwin'){const _0x34ab76=_0x3f1d99['join'](__dirname,'mac-updater-intern.sh'),_0x5a66e7=_0x534546('/bin/bash',[_0x34ab76]);_0x5a66e7['stdout']['on']('data',_0xf65480=>{console['log']('stdout:\x20'+_0xf65480);}),_0x5a66e7['stderr']['on']('data',_0x133de4=>{console['error']('stderr:\x20'+_0x133de4);}),_0x5a66e7['on']('close',_0x590073=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x590073),_0x590073===0x0?_0x506193('Update\x20erfolgreich\x20abgeschlossen.'):_0x293e5e(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x590073));});}else{if(process['platform']==='win32'){const _0x1af3d9=_0x3f1d99['join'](__dirname,'../','../','../');process['chdir'](_0x1af3d9),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x17ba98='soft-ui-updater-windows.ps1',_0x3f5db1=_0x534546('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x17ba98]);_0x3f5db1['stdout']['on']('data',_0x736058=>{console['log']('stdout:\x20'+_0x736058);}),_0x3f5db1['stderr']['on']('data',_0x55b40d=>{console['error']('stderr:\x20'+_0x55b40d);}),_0x3f5db1['on']('close',_0x1710fe=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x1710fe),_0x1710fe===0x0?_0x506193('Update\x20erfolgreich\x20abgeschlossen.'):_0x293e5e(new Error('Update\x20fehlgeschlagen.\x20Exit\x20Code\x20'+_0x1710fe));});}else _0x293e5e(new Error('Update\x20nicht\x20für\x20diese\x20Plattform\x20unterstützt.'));}});});function getRnd(_0x37df71,_0x51d62b){return Math['random']()*(_0x51d62b-_0x37df71+0x1)+_0x37df71;}function delay(_0x5ec139,_0x1c543f){let _0x504a41=getRnd(_0x5ec139,_0x1c543f);return new Promise(function(_0x2bc9f6){setTimeout(_0x2bc9f6,_0x504a41);});}async function scroll(_0xd35ef5,_0x3fa200,_0x20815c=0x2,_0x56a8e1){const _0x4aa259=await _0xd35ef5['waitForSelector'](_0x3fa200);for(let _0xc27b86=0x0;_0xc27b86<_0x20815c;_0xc27b86++){console['log']('Scrolling\x20'+_0xc27b86),await _0xd35ef5['evaluate'](_0x15f513=>{const _0x5a8da4=document['querySelector'](_0x15f513);_0x5a8da4&&_0x5a8da4['scrollBy'](0x0,0x190);},_0x3fa200),await delay(0x320,0x5dc),_0x56a8e1();}}async function saveCookies(_0x4c4bf1){let _0x472b69=await _0x4c4bf1['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x472b69,null,0x2));}async function notificationClear(_0x4fb5ff){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x4fb5ff['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x4fb5ff['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x5a21e5){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x5a21e5);}}async function getTargetProfiles(_0x41a985){return new Promise((_0x1609f1,_0x51e9b8)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x41a985,(_0xd07591,_0x411a68)=>{_0xd07591?_0x51e9b8(_0xd07591):_0x1609f1(_0x411a68);});});}async function login_legacy(_0x5bc077,_0x4d3cfa,_0x530647){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x5bc077,_0x4d3cfa),await createUserIfNotExists(_0x4d3cfa,_0x530647);}catch(_0x56c820){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x56c820);}try{await _0x5bc077['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x5bc077['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x5bc077['click']('button._a9--._ap36._a9_0');}catch(_0x286a78){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x5bc077['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x5bc077['type']('input[name=\x27username\x27]',_0x4d3cfa,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x5bc077['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x5bc077['type']('input[name=\x27password\x27]',_0x530647,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x5bc077['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x5bc077['click']('button[type=\x27submit\x27]');}catch(_0x5fb6db){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x5bc077),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x5bc077,_0x4d3cfa);}catch(_0x356a22){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x356a22);}}catch(_0x1a9389){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x1a9389);}}async function login(_0x1891ce,_0x3d7ebb){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x1891ce,_0x3d7ebb),await createUserIfNotExists(_0x3d7ebb);}catch(_0x31254a){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x31254a);}try{await _0x1891ce['goto']('https://www.instagram.com/accounts/login/');}catch(_0x1d2a07){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x1d2a07);}}async function set_login_cookies(_0x1e7ac5,_0x34e270){try{await saveCookiesForUser(_0x1e7ac5,_0x34e270);}catch(_0x499d8a){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x499d8a);}}async function waitForXPath(_0x499370,_0x21fc8f,_0x5bb46e={}){return await _0x499370['waitForFunction'](_0x25806b=>{return document['evaluate'](_0x25806b,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue']!==null;},_0x5bb46e,_0x21fc8f),_0x499370['evaluateHandle'](_0x1edd9c=>document['evaluate'](_0x1edd9c,document,null,XPathResult['FIRST_ORDERED_NODE_TYPE'],null)['singleNodeValue'],_0x21fc8f);}async function send_message(_0x3f586b,_0x114f0f,_0x4fe69d,_0x350fa7,_0x23e093,_0xaad51b){return new Promise(async(_0x24e22e,_0xe97025)=>{_0xaad51b=_0xaad51b['split'](';'),console['log'](_0xaad51b[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x23e093);try{await setCookiesForUser(_0x3f586b,_0xaad51b[0x0]);}catch(_0x127080){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x127080),_0xe97025({'status':0x190,'message':'Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x127080});return;}try{await _0x3f586b['goto']('https://www.instagram.com/'+_0x114f0f+'/'),await delay(0xfa0,0x1d4c),await notificationClear(_0x3f586b);}catch(_0x23657a){_0xe97025({'status':0x1f4,'message':'Fehler\x20beim\x20Aufruf\x20der\x20Seite:\x20'+_0x23657a});return;}try{await _0x3f586b['waitForSelector'](K_DIRECT_MSG_BUTTON),await _0x3f586b['click'](K_DIRECT_MSG_BUTTON);}catch(_0x4e046c){console['log']('1.\x20MsgButton\x20nicht\x20gefunden.\x20Teste\x202.\x20Button'+_0x4e046c);try{await _0x3f586b['waitForSelector'](K_OPTIONS_BUTTON),await _0x3f586b['click'](K_OPTIONS_BUTTON),await delay(0x1f4,0x320);const _0x1c7b4a=await waitForXPath(_0x3f586b,'//button[contains(text(),\x27Send\x20message\x27)]');await _0x1c7b4a['click']();}catch(_0x4bfb52){console['log']('2.\x20MsgButton\x20nicht\x20gefunden.\x20Nutzer\x20überspringen'+_0x4bfb52),_0x24e22e({'status':0x194,'message':'UserSkip:\x20Nicht\x20anschreibbaren\x20Nutzer\x20überspringen'});return;}}try{await delay(0x320,0x3e8),await notificationClear(_0x3f586b);}catch(_0x2580eb){console['log']('NotificationClear\x20fehlerhaft:\x20'+_0x2580eb);}try{const _0x512500=await _0x3f586b['waitForSelector'](K_CHAT_INPUT_FIELD),_0x30f1a2=await _0x3f586b['evaluate'](()=>{return document['querySelector']('h2\x20>\x20span\x20>\x20span')['textContent'];});console['log']('Extrahierter\x20Clearname:\x20'+_0x30f1a2),_0x350fa7=_0x350fa7['replace']('{USERNAME}',_0x114f0f);let _0x378925=_0x30f1a2['replace'](/[^\p{L}\s]/gu,''),_0x432bc2=_0x378925['split']('\x20')[0x0];console['log']('Extrahierter\x20Clearname\x20mit\x20Len:\x20'+_0x432bc2['length']+'nach\x20Split:\x20'+_0x432bc2);_0x432bc2['length']>0x2&&!_0x432bc2['includes']('Instagram')?(_0x350fa7=_0x350fa7['replaceAll']('{NAME}',_0x432bc2),_0x350fa7=_0x350fa7['replaceAll']('{name}',_0x432bc2)):(_0x350fa7=_0x350fa7['replaceAll']('\x20{NAME}',''),_0x350fa7=_0x350fa7['replaceAll']('\x20{name}',''),_0x350fa7=_0x350fa7['replaceAll']('{NAME}',''),_0x350fa7=_0x350fa7['replaceAll']('{name}',''));await _0x512500['type'](_0x350fa7,{'delay':getRnd(0x50,0x78)}),await delay(0x320,0x3e8);const _0x4e0a33=await _0x3f586b['waitForSelector'](K_SEND_MSG_BUTTON);await _0x4e0a33['click'](),await delay(0x320,0x3e8),_0x24e22e({'status':0xc8,'message':'Nachricht\x20erfolgreich\x20gesendet!'});}catch(_0x4dcf05){console['error']('Nachricht\x20nicht\x20gesendet:\x20'+_0x4dcf05),_0xe97025('Nachricht\x20nicht\x20gesendet:\x20'+_0x4dcf05);}});}function handle_fail(_0x270aee){if(isStopping)return new Promise(_0xbffecd=>{_0xbffecd('Scraper\x20gestoppt.');});else{let _0x26db9a='';switch(_0x270aee){case 0x0:_0x26db9a='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x26db9a='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x26db9a='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x26db9a='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0x224af2,_0x2131e7)=>{_0x2131e7(_0x26db9a);});}}async function fetch_account_details(_0x260016,_0x2a599a,_0x177e1d,_0x27c3a5){try{await setCookiesForUser(_0x260016,_0x177e1d['username']);}catch(_0x92ce37){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x92ce37);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x92ce37);return handle_fail(0x0);}_0x260016['setDefaultNavigationTimeout'](0x7530),await _0x260016['goto']('https://www.instagram.com/'+_0x2a599a+'/',{'waitUntil':'networkidle2','timeout':0x7530}),await notificationClear(_0x260016);const _0x7f0cd2=await _0x260016['evaluate'](()=>{const _0xaf8f25=document['querySelector']('meta[property=\x22og:image\x22]');return _0xaf8f25?_0xaf8f25['getAttribute']('content'):null;});await _0x260016['waitForSelector']('meta[name=\x22description\x22]',{'timeout':0x3a98});const _0x2feea9=await _0x260016['evaluate'](()=>{const _0x479863=document['querySelector']('meta[name=\x22description\x22]');if(!_0x479863)return console['log']('Meta-Tag\x20nicht\x20gefunden'),null;let _0x44535a=_0x479863['getAttribute']('content');if(!_0x44535a)return console['log']('Meta-Content\x20ist\x20leer'),null;console['log']('Meta\x20content:',_0x44535a);const _0x5588c0=/\s*[–-]\s*/,_0xd4002b=_0x44535a['split'](_0x5588c0);if(_0xd4002b['length']<0x2)return console['log']('Kein\x20gültiger\x20Separator\x20gefunden'),null;const _0x57e8f7=_0xd4002b[0x0],_0x22462f=_0xd4002b[0x1],_0x25abdc=_0x57e8f7['split'](',\x20');if(_0x25abdc['length']<0x3)return console['log']('Nicht\x20genügend\x20Zählwerte\x20gefunden'),null;const _0x5bd425=_0x25abdc[0x0]['split']('\x20')[0x0],_0x3ff67d=_0x25abdc[0x1]['split']('\x20')[0x0],_0x3f0faf=_0x25abdc[0x2]['split']('\x20')[0x0];let _0x14a9be='',_0x103959='';const _0x207e23='\x20on\x20Instagram:\x20',_0x4a923b=_0x22462f['split'](_0x207e23);return _0x14a9be=_0x4a923b[0x0]['trim'](),_0x14a9be=_0x14a9be['replace'](/\s*\(?@[\w_]+\)?/g,'')['trim'](),_0x4a923b['length']>0x1&&(_0x103959=_0x4a923b[0x1]['trim'](),_0x103959['startsWith']('\x22')&&_0x103959['endsWith']('\x22')&&(_0x103959=_0x103959['substring'](0x1,_0x103959['length']-0x1)['trim']()),_0x103959=_0x103959['replace'](/&quot;/g,'')['trim']()),{'followers':_0x5bd425,'following':_0x3ff67d,'posts':_0x3f0faf,'nameText':_0x14a9be,'bio':_0x103959};});console['log']('Extracted\x20profile\x20data:',_0x2feea9);const _0x3cfe23=_0x2feea9['nameText'],_0x36a6d9=_0x7f0cd2,_0x232281=_0x2feea9['bio'],_0x5061fb=_0x2feea9['followers'],_0x499950=_0x2feea9['following'],_0x572f40=_0x2feea9['posts'],_0x4715dc=![],_0x5b0e5e=![],_0x460f66=![],_0xd55ee='\x0a\x20\x20INSERT\x20INTO\x20'+_0x27c3a5+'\x20(\x0a\x20\x20\x20\x20username,\x20clearname,\x20ProfilePic,\x20Bio,\x20\x0a\x20\x20\x20\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20\x0a\x20\x20\x20\x20Isverified,\x20Isprivat,\x20IsBusiness\x0a\x20\x20)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20ON\x20CONFLICT(username)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20clearname\x20=\x20excluded.clearname,\x0a\x20\x20\x20\x20ProfilePic\x20=\x20excluded.ProfilePic,\x0a\x20\x20\x20\x20Bio\x20=\x20excluded.Bio,\x0a\x20\x20\x20\x20Follower_Count\x20=\x20excluded.Follower_Count,\x0a\x20\x20\x20\x20Following_Count\x20=\x20excluded.Following_Count,\x0a\x20\x20\x20\x20Post_Count\x20=\x20excluded.Post_Count,\x0a\x20\x20\x20\x20Isverified\x20=\x20excluded.Isverified,\x0a\x20\x20\x20\x20Isprivat\x20=\x20excluded.Isprivat,\x0a\x20\x20\x20\x20IsBusiness\x20=\x20excluded.IsBusiness;\x0a';db['run'](_0xd55ee,[_0x2a599a,_0x3cfe23,_0x36a6d9,_0x232281,_0x5061fb,_0x499950,_0x572f40,_0x4715dc,_0x5b0e5e,_0x460f66],function(_0x200dcd){_0x200dcd?console['error']('Fehler\x20beim\x20Upsert\x20in\x20die\x20Datenbank:\x20'+_0x200dcd['message']):console['log']('Eintrag\x20erfolgreich\x20upserted.\x20Letzte\x20ID:\x20'+this['lastID']);});}async function fetch_followers_from_account(_0x5ecad2,_0x467fe8,_0x1e712c,_0x39e134,_0x58f401,_0x3a5832,_0x139088){let _0x2a70ba=0x4,_0x3434df=0x0,_0x356525=0x0;try{await setCookiesForUser(_0x467fe8,_0x3a5832['username']);}catch(_0x28e7f3){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:'+_0x28e7f3);throw new Error('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x28e7f3);return handle_fail(0x0);}let _0x50bc61=0x0;try{await _0x467fe8['goto']('https://www.instagram.com/'+_0x1e712c+'/'),await notificationClear(_0x467fe8);try{if(_0x39e134<=0x0){const _0x3724a3=await _0x467fe8['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x58bf37=await _0x467fe8['evaluate'](_0xab5436=>_0xab5436['innerHTML'],_0x3724a3);_0x50bc61=Math['ceil'](_0x58bf37/0x4);}else _0x50bc61=Math['ceil'](_0x39e134/0x4);_0x2a70ba+=_0x50bc61,_0x356525=Math['round'](++_0x3434df/_0x2a70ba*0x64),_0x5ecad2['sender']['send']('fetch-progress',_0x356525,!![]);let _0x30bd5f=await _0x467fe8['waitForSelector']('a[href=\x22/'+_0x1e712c+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x30bd5f['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x1e712c+'\x20gesichtet'),_0x356525=Math['round'](++_0x3434df/_0x2a70ba*0x64),_0x5ecad2['sender']['send']('fetch-progress',_0x356525,!![]);}catch(_0x150090){console['log']('Follower\x20Liste\x20von\x20'+_0x1e712c+'\x20nicht\x20gefunden:'+_0x150090);throw new Error('Follower\x20Liste\x20von\x20'+_0x1e712c+'\x20nicht\x20gefunden:'+_0x150090);return handle_fail(0x0);}}catch(_0x312b1c){console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x312b1c);throw new Error('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x312b1c);return handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x50bc61),await scroll(_0x467fe8,FOLLOWER_FENSTER,_0x50bc61,_0x9cd526=>{_0x356525=Math['round'](++_0x3434df/_0x2a70ba*0x64),_0x5ecad2['sender']['send']('fetch-progress',_0x356525,!![]);}),await _0x467fe8['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x1b2c61=await _0x467fe8['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x531ff7=await _0x467fe8['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x356525=Math['round'](++_0x3434df/_0x2a70ba*0x64),_0x5ecad2['sender']['send']('fetch-progress',_0x356525,!![]);_0x39e134<=0x0&&(_0x39e134=_0x1b2c61['length']);let _0xfc5208=[];for(let _0x59d613=0x0;_0x59d613<_0x1b2c61['length']&&_0x59d613<_0x39e134;_0x59d613++){_0xfc5208['push'](await _0x1b2c61[_0x59d613]['evaluate'](_0x53e09d=>_0x53e09d['textContent']));const _0x5b054d='INSERT\x20INTO\x20'+_0x58f401+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x5b054d,[await _0x1b2c61[_0x59d613]['evaluate'](_0x3fa014=>_0x3fa014['textContent']),await _0x531ff7[_0x59d613]['evaluate'](_0x5d448f=>_0x5d448f['textContent'])],function(_0x3f69ba){_0x3f69ba?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x58f401+'\x27:',_0x3f69ba['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return _0x356525=Math['round'](++_0x3434df/_0x2a70ba*0x64),_0x5ecad2['sender']['send']('fetch-progress',_0x356525,!![]),_0x139088&&(_0x5ecad2['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x5ecad2,_0x467fe8,_0x3a5832,_0x58f401,_0xfc5208)),new Promise(_0x118a34=>{_0x118a34('Scraping\x20finished!');});}catch(_0x15b00b){if(_0x139088)throw new Error(_0x15b00b);else throw new Error('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x1e712c+'\x20nicht\x20gefunden:\x20'+_0x15b00b);return handle_fail(0x0);}}async function fetch_details_from_list(_0x53a8a0,_0xb639ab,_0x2b2dbf,_0x2a8456,_0x1e3e12){let _0x23869a=0x0,_0x44e311=0x0;for(let _0x4ec75b=0x0;_0x4ec75b<_0x1e3e12['length'];_0x4ec75b++){console['log']('Processing\x20profile:',_0x1e3e12[_0x4ec75b]);try{await fetch_account_details(_0xb639ab,_0x1e3e12[_0x4ec75b],_0x2b2dbf,_0x2a8456);}catch(_0x332464){console['error']('Detailed\x20Scraping\x20von:\x20',_0x1e3e12[_0x4ec75b],_0x332464);throw new Error('Detailed\x20Scraping\x20von:\x20'+_0x1e3e12[_0x4ec75b]+'\x20'+_0x332464);}_0x44e311=Math['round'](++_0x23869a/_0x1e3e12['length']*0x64),_0x53a8a0['sender']['send']('fetch-progress',_0x44e311,!![],!![]);}}async function fetch_likers_from_post(_0x205a63,_0x513019,_0x281e7a,_0x33a9eb,_0x54d2dc,_0x92f06a,_0x36d04f){let _0x512803=0x4,_0x32c856=0x0,_0x5d3b04=0x0;try{await setCookiesForUser(_0x513019,_0x92f06a['username']);}catch(_0x9165a6){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x9165a6);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x9165a6);return handle_fail(0x1);return;}_0x5d3b04=Math['round'](++_0x32c856/_0x512803*0x64),_0x205a63['sender']['send']('fetch-progress',_0x5d3b04,!![]);try{let _0xd53c63=_0x281e7a['substring'](0x0,_0x281e7a['lastIndexOf']('/')),_0x49ee4f=_0xd53c63+'/liked_by';console['log'](_0x49ee4f),await _0x513019['goto'](_0x49ee4f),await delay(0x7d0,0xfa0),await notificationClear(_0x513019),await delay(0xc8,0x1f4),_0x5d3b04=Math['round'](++_0x32c856/_0x512803*0x64),_0x205a63['sender']['send']('fetch-progress',_0x5d3b04,!![]),await _0x513019['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0x5847e1=await _0x513019['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x267c66=await _0x513019['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0x5847e1['length']);let _0x48b4ad=path['join'](__dirname,'/likers.csv');_0x5d3b04=Math['round'](++_0x32c856/_0x512803*0x64),_0x205a63['sender']['send']('fetch-progress',_0x5d3b04,!![]);_0x33a9eb<=0x0&&(_0x33a9eb=_0x5847e1['length']);try{let _0x591486=[];for(let _0x5f18ef=0x0;_0x5f18ef<_0x5847e1['length']&&_0x5f18ef<_0x33a9eb;_0x5f18ef++){_0x591486['push'](await _0x5847e1[_0x5f18ef]['evaluate'](_0x15121c=>_0x15121c['textContent']));try{const _0x8d573='INSERT\x20INTO\x20'+_0x54d2dc+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x8d573,[await _0x5847e1[_0x5f18ef]['evaluate'](_0x158c92=>_0x158c92['textContent']),await _0x267c66[_0x5f18ef]['evaluate'](_0x1037a4=>_0x1037a4['textContent'])],function(_0x11c6c9){_0x11c6c9?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x54d2dc+'\x27:',_0x11c6c9['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0x518266){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x5f18ef+'\x20:\x20'+_0x518266);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x5f18ef+'\x20:\x20'+_0x518266);return handle_fail(0x1);}}return _0x5d3b04=Math['round'](++_0x32c856/_0x512803*0x64),_0x205a63['sender']['send']('fetch-progress',_0x5d3b04,!![]),_0x36d04f&&(_0x205a63['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x205a63,_0x513019,_0x92f06a,_0x54d2dc,_0x591486)),new Promise(_0x2880cd=>{_0x2880cd('Scraping\x20finished!');});}catch(_0x16eaa3){console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben');throw new Error(_0x16eaa3);return handle_fail(0x1);}}catch(_0xea9197){console['log']('Like-Seite\x20nicht\x20geöffnet'+_0xea9197);throw new Error('Like-Seite\x20nicht\x20geöffnet'+_0xea9197);return handle_fail(0x1);}}async function fetch_comments_from_post(_0x5ba77a,_0x58e793,_0x4fce1f,_0x6c7e75,_0x496f23,_0x491680,_0x3dbc3d){let _0x22ec3d=0x3,_0x26a2b3=0x0,_0x327dd2=0x0;try{await setCookiesForUser(_0x58e793,_0x491680['username']);}catch(_0xd35f92){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0xd35f92);throw new Error('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0xd35f92);return handle_fail(0x2);}try{console['log'](_0x4fce1f),await _0x58e793['goto'](_0x4fce1f),await delay(0x7d0,0xfa0),await notificationClear(_0x58e793),await delay(0xc8,0x1f4);const _0xd18437=COM_COMMENTS_BOX_BODY_DIV;let _0x1ff52c;const _0x55379e=await _0x58e793['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x559635=await _0x58e793['evaluate'](_0x15aeac=>_0x15aeac['innerHTML'],_0x55379e),_0x4643aa=String(_0x559635)['replace'](/[^0-9]/g,''),_0x4cf460=Number(_0x4643aa)/0x14;_0x6c7e75<=0x0?_0x1ff52c=Math['ceil'](_0x4cf460/0x3):_0x1ff52c=Math['ceil'](_0x6c7e75/0x3);_0x22ec3d+=_0x1ff52c,_0x327dd2=Math['round'](++_0x26a2b3/_0x22ec3d*0x64),_0x5ba77a['sender']['send']('fetch-progress',_0x327dd2,!![]),console['log']('Auto-scrolls:\x20'+_0x1ff52c),await scroll(_0x58e793,_0xd18437,_0x1ff52c,_0x1c8176=>{_0x327dd2=Math['round'](++_0x26a2b3/_0x22ec3d*0x64),_0x5ba77a['sender']['send']('fetch-progress',_0x327dd2,!![]);});try{const _0x3d134a=COM_REPLY_BUTTON_SPAN;await _0x58e793['waitForSelector'](_0x3d134a),await delay(0x1f4,0x320);const _0x4422cc=await _0x58e793['$$'](_0x3d134a);console['log'](_0x4422cc);let _0x117dfb=_0x4422cc['length'];await delay(0xc8,0x1f4);try{for(let _0x2015b0=0x0;_0x2015b0<_0x117dfb;_0x2015b0++){_0x4422cc[_0x2015b0]['click'](),await delay(0x320,0x5dc);}}catch(_0x2f429a){console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x2f429a);throw new Error('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x2f429a);return handle_fail(0x2);}}catch(_0x4d8610){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x5f5c69=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x58e793['waitForSelector'](_0x5f5c69),await delay(0x1f4,0x320),_0x327dd2=Math['round'](++_0x26a2b3/_0x22ec3d*0x64),_0x5ba77a['sender']['send']('fetch-progress',_0x327dd2,!![]);const _0xc81868=await _0x58e793['$$'](_0x5f5c69);let _0xa0d995=path['join'](__dirname,'/comments.csv');_0x6c7e75<=0x0&&(_0x6c7e75=_0xc81868['length']);console['log']('fetch_limit:\x20'+_0x6c7e75),console['log']('comments_len:\x20'+_0xc81868['length']),_0x6c7e75++;try{let _0x2846d2=[];for(let _0x3d511e=0x1;_0x3d511e<_0xc81868['length']&&_0x3d511e<_0x6c7e75;_0x3d511e++){try{_0x2846d2['push'](await _0xc81868[_0x3d511e]['evaluate'](_0x2872a1=>_0x2872a1['textContent']));const _0x4657fc=await db['prepare']('INSERT\x20INTO\x20'+_0x496f23+'\x20(username)\x20VALUES\x20(?)');await _0x4657fc['run'](await _0xc81868[_0x3d511e]['evaluate'](_0x2aa989=>_0x2aa989['textContent']),function(_0xfa3c1d){_0xfa3c1d&&console['log']('error\x20in\x20add-user:'+_0xfa3c1d);}),await _0x4657fc['finalize']();}catch(_0x464214){console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x3d511e+'\x20:\x20'+_0x464214);throw new Error('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x3d511e+'\x20:\x20'+_0x464214);return handle_fail(0x2);}}return await delay(0x4b0,0x7d0),_0x327dd2=Math['round'](++_0x26a2b3/_0x22ec3d*0x64),_0x5ba77a['sender']['send']('fetch-progress',_0x327dd2,!![]),_0x5ba77a['sender']['send']('fetch-progress',0x64,!![]),_0x3dbc3d&&(_0x5ba77a['sender']['send']('fetch-progress',0x0,!![],!![]),await fetch_details_from_list(_0x5ba77a,_0x58e793,_0x491680,_0x496f23,_0x2846d2)),_0x5ba77a['sender']['send']('fetch-progress',0x64,![]),new Promise(_0x39f106=>{_0x39f106('Scraping\x20finished!');});}catch(_0x4b76eb){console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben');throw new Error(_0x4b76eb);return handle_fail(0x2);}}catch(_0x1d22e){console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0x1d22e);throw new Error('Comments-Seite\x20nicht\x20geöffnet'+_0x1d22e);return handle_fail(0x2);}}async function set_clearname_from_username(_0x45e616,_0x43e922,_0x1eba00=null){try{let _0x131fa1,_0xafb0c6;const _0x61c7b5='SELECT\x20username\x20FROM\x20'+_0x43e922+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x61c7b5,[],(_0x30174a,_0x1c32db)=>{_0x30174a&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x30174a['message']),_0x1c32db['length']===0x0&&(_0xafb0c6=_0x1c32db['length']),_0x131fa1=_0x1c32db['map'](_0x2b599a=>_0x2b599a['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0xafb0c6);if(_0xafb0c6===0x0){console['log']('Leave');return;}const _0x1b354e=await _0x45e616['waitForSelector'](IG_SEARCH_BUTTON);await _0x1b354e['click'](),await delay(0x4b0,0x7d0);for(let _0x3659ef of _0x131fa1){const _0x2ad39f=await _0x45e616['waitForSelector'](IG_SEARCH_INPUT);await _0x2ad39f['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x45e616['type'](IG_SEARCH_INPUT,_0x3659ef,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x2d8dfd=0x1;while(_0x2d8dfd!=0x14){console['log']('Schleife');try{let _0x57d7a7=IG_NAME_SPAN_PART1+_0x2d8dfd+IG_USERNAME_SPAN_PART2;const _0x215e1c=await _0x45e616['waitForSelector'](_0x57d7a7),_0x100b9f=await _0x45e616['evaluate'](_0x4780b5=>_0x4780b5['innerHTML'],_0x215e1c);await delay(0xc8,0x1f4);if(_0x100b9f==_0x3659ef){let _0x27ec9e=IG_NAME_SPAN_PART1+_0x2d8dfd+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0xb34fdc=await _0x45e616['waitForSelector'](_0x27ec9e);let _0x549df6=await _0x45e616['evaluate'](_0x2d3cae=>_0x2d3cae['innerHTML'],_0xb34fdc);const _0x406f8e=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x44a31c=_0x549df6['match'](_0x406f8e);_0x44a31c?_0x549df6=_0x44a31c[0x1]['trim']():_0x549df6=_0x549df6['trim']();_0x549df6['includes']('•')&&(_0x549df6=_0x549df6['substring'](0x0,_0x549df6['indexOf']('•')-0x1));const _0x2e4dec='UPDATE\x20'+_0x43e922+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x2e4dec,[_0x549df6,_0x100b9f],function(_0x275406){_0x275406&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x275406['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x2d8dfd++;}catch(_0x62b5dc){const _0x1963f8='UPDATE\x20'+_0x43e922+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x1963f8,['',_0x3659ef],function(_0x650791){_0x650791&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x650791['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x62b5dc);break;}}_0x1eba00&&_0x1eba00();}await _0x1b354e['click']();}catch(_0x21f2f4){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x21f2f4);}}const campaignPath=path['resolve'](__dirname,'data/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(campaign_name\x20TEXT\x20PRIMARY\x20KEY,\x20list_id\x20TEXT,\x20zeitabstand\x20REAL,\x20message_id\x20TEXT,\x20account\x20TEXT,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x50d793,_0x597502)=>{const _0x2c4dec='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x2c4dec,[],(_0x50866a,_0x53f050)=>{_0x50866a?_0x597502(_0x50866a):_0x50d793(_0x53f050);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x39c13c,_0x1d09b7)=>{const _0x303d4e='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x303d4e,[],async(_0x30b501,_0x41a25d)=>{if(_0x30b501)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x30b501['message']),_0x1d09b7({'status':'error','message':_0x30b501['message']});else try{const _0x401291=await Promise['all'](_0x41a25d['map'](_0x324ed2=>{return new Promise(_0x358e46=>{if(!_0x324ed2['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x324ed2['campaign_name']),_0x358e46({'campaign_name':_0x324ed2['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x2762af='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x324ed2['list_id'],_0x5b06ea='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20campaign\x20LEFT\x20JOIN\x20dm\x20ON\x20campaign.list_id\x20=\x20dm.list_id\x20WHERE\x20dm.list_id\x20=\x20\x22'+_0x324ed2['list_id']+'\x22';db['get'](_0x2762af,[],(_0x10a8ac,_0x255a8f)=>{_0x10a8ac?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x324ed2['campaign_name']+':',_0x10a8ac['message']),_0x358e46({'campaign_name':_0x324ed2['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):campaignDB['get'](_0x5b06ea,[],(_0x2490c4,_0x53cf78)=>{_0x2490c4?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x324ed2['campaign_name']+':',_0x2490c4['message']),_0x358e46({'campaign_name':_0x324ed2['campaign_name'],'lead_count':_0x255a8f?_0x255a8f['lead_count']:0x0,'contacted_count':'N/A'})):_0x358e46({'campaign_name':_0x324ed2['campaign_name'],'lead_count':_0x255a8f?_0x255a8f['lead_count']:0x0,'contacted_count':_0x53cf78?_0x53cf78['contacted_count']:0x0});});});});}));_0x39c13c({'status':'success','campaigns':_0x401291});}catch(_0x496347){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x496347),_0x1d09b7({'status':'error','message':_0x496347['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x3c4f7b,_0x39d2bf)=>{return new Promise((_0x2eaebd,_0x449da4)=>{const _0x95dcf9='SELECT\x20campaign.list_id,\x20message.message_text,\x20message.message_id,\x20campaign.zeitabstand,\x20campaign.account\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x95dcf9,[_0x39d2bf],(_0x32979c,_0x930cb)=>{_0x32979c?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x32979c),_0x449da4(_0x32979c)):(console['log']('ROWS'),console['log'](_0x930cb),debugDatabaseContents(),_0x2eaebd(_0x930cb));});});});const showTableContents=_0x536d8b=>{return new Promise((_0x445cab,_0x572446)=>{const _0x283369='SELECT\x20*\x20FROM\x20'+_0x536d8b+';';campaignDB['all'](_0x283369,(_0x364663,_0x131c0f)=>{_0x364663?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x536d8b+':',_0x364663),_0x572446(_0x364663)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x536d8b+':',_0x131c0f),_0x445cab({'status':'success','message':_0x131c0f}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x7d1537){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x7d1537);}}ipcMain['handle']('create-campaign',async(_0x590b95,_0x1f2d5c)=>{return new Promise((_0x332aa7,_0x28ae37)=>{const _0x3fde59='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x3fde59,[String(_0x1f2d5c)],function(_0x195ec9){_0x195ec9?_0x28ae37(_0x195ec9):_0x332aa7({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x20af23,_0x288b87)=>{return new Promise((_0x512694,_0x399d4f)=>{const _0x36a289='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x36a289,[_0x288b87],function(_0x29b82d){_0x29b82d?_0x399d4f(_0x29b82d):_0x512694({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x5a115f,_0x126816,_0x2418c2,_0x2f2557,_0x13f7a4,_0x29a3c1)=>{const _0x4acb8e=await createMessageID(_0x13f7a4);return new Promise((_0x3912db,_0x3384c6)=>{if(!_0x126816||!_0x2418c2||!_0x2f2557||!_0x4acb8e||!_0x29a3c1)return _0x3384c6({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x4acb8e);const _0x2a20b0='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x2a20b0,[_0x2418c2,_0x2f2557,_0x4acb8e,_0x29a3c1,_0x126816],function(_0x1e5338){if(_0x1e5338)_0x3384c6({'status':'error','message':_0x1e5338['message']});else this['changes']===0x0?_0x3384c6({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x3912db({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x593b65,_0x164505,_0x4bbb6b,_0x363436,_0x1123fd)=>{return new Promise((_0x47285b,_0x9e89b7)=>{const _0x37ed79='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username,\x20list_id)\x20VALUES\x20(?,\x20?,\x20?,\x20?)';campaignDB['run'](_0x37ed79,[_0x164505,_0x4bbb6b,_0x363436,_0x1123fd],function(_0x32bf58){return _0x32bf58?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0x32bf58['message']),_0x9e89b7('insert-dm-response',{'success':![],'message':_0x32bf58['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0x47285b('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x9d8596=>{return new Promise((_0x570749,_0x4123c1)=>{const _0x4d7664='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x4d7664,[_0x9d8596],(_0x47c2f8,_0x1fff35)=>{if(_0x47c2f8)_0x4123c1({'status':'error','message':_0x47c2f8['message']});else{if(_0x1fff35)_0x570749(_0x1fff35['message_id']);else{const _0x1f1394='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x1f1394,[_0x9d8596],function(_0x2c2b7c){_0x2c2b7c?_0x4123c1({'status':'error','message':_0x2c2b7c['message']}):_0x570749(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x17e038,_0x2f857e)=>{return new Promise((_0x44b0fb,_0x14e79a)=>{const _0xf9c0fb='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x2f857e;db['get'](_0xf9c0fb,(_0x3d8c49,_0x365633)=>{_0x3d8c49?_0x14e79a({'status':'error','message':_0x3d8c49['message']}):_0x44b0fb({'status':'success','count':_0x365633['count']});});});});const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x31143f,_0x2bdad9){try{const _0x31d6f0=await new Promise((_0x2cab66,_0x23d646)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x2bdad9],(_0x2b1510,_0x1928e1)=>{if(_0x2b1510)_0x23d646(_0x2b1510);else{if(_0x1928e1['length']>0x0){let _0x1b88e1=JSON['parse'](_0x1928e1[0x0]['cookie']);console['log'](_0x1b88e1),_0x2cab66(_0x1b88e1);}else _0x23d646(new Error('User\x20with\x20username\x20'+_0x2bdad9+'\x20does\x20not\x20exist.'));}});});await _0x31143f['setCookie'](..._0x31d6f0),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x4c446c){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x4c446c);}}async function saveCookiesForUser(_0x30427d,_0xbf66cd){try{const _0x20b2ed=await _0x30427d['cookies']();if(!_0x20b2ed||_0x20b2ed['length']===0x0)throw new Error('Keine\x20gültigen\x20Cookies\x20gefunden\x20für\x20'+_0xbf66cd);const _0x53ed4f=JSON['stringify'](_0x20b2ed);if(_0x53ed4f['trim']()==='[]')throw new Error('Cookies\x20sind\x20leer\x20für\x20'+_0xbf66cd);return new Promise((_0x2fbb05,_0x596582)=>{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0xbf66cd],(_0x44d2ed,_0x1c712f)=>{if(_0x44d2ed)return console['error']('Error\x20checking\x20user\x20existence:',_0x44d2ed),_0x596582(_0x44d2ed);if(_0x1c712f){const _0x2dcf4c=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x2dcf4c['run'](_0x53ed4f,_0xbf66cd,function(_0x29a6bb){return _0x29a6bb?(console['error']('Error\x20updating\x20cookies:',_0x29a6bb),_0x596582(_0x29a6bb)):(console['log']('Cookies\x20updated\x20for\x20user:',_0xbf66cd),_0x2fbb05());});}else{const _0x4409d4=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x4409d4['run'](_0xbf66cd,_0x53ed4f,function(_0x10bb34){return _0x10bb34?(console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x10bb34),_0x596582(_0x10bb34)):(console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0xbf66cd),_0x2fbb05());});}});});}catch(_0x3ff970){console['error']('Error\x20fetching\x20cookies:',_0x3ff970);throw _0x3ff970;}}async function createUserIfNotExists(_0x202db7){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x202db7],(_0x38f9e3,_0xdb26a)=>{if(_0x38f9e3){console['error']('Error\x20checking\x20user\x20existence:',_0x38f9e3);throw _0x38f9e3;}else{if(!_0xdb26a){const _0x3c209b=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username)\x20VALUES\x20(?)');_0x3c209b['run'](_0x202db7,function(_0xa3d767){_0xa3d767?console['error']('Error\x20inserting\x20new\x20user:',_0xa3d767):console['log']('New\x20user\x20created:',_0x202db7);});}else console['log']('User\x20already\x20exists:',_0x202db7);}});}catch(_0x3ce8e9){console['error']('Error\x20creating\x20user:',_0x3ce8e9);throw _0x3ce8e9;}}ipcMain['handle']('create-relation',async(_0x5c8de7,_0xa810c8)=>{return new Promise((_0x1bc187,_0x34b07e)=>{const _0x26dd14='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0xa810c8+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT,\x20ProfilePic\x20TEXT,\x20Bio\x20TEXT,\x20Follower_Count\x20Integer,\x20Following_Count\x20Integer,\x20Post_Count\x20Integer,\x20Isverified\x20Boolean,\x20Isprivat\x20Boolean,\x20IsBusiness\x20Boolean)';db['run'](_0x26dd14,function(_0x6fbe29){_0x6fbe29?_0x34b07e(_0x6fbe29):_0x1bc187({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x116d8c,_0xc91797)=>{return console['log']('droping\x20table'+_0xc91797),new Promise((_0x436548,_0x16bf96)=>{const _0x1fa025='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0xc91797;console['log']('droping\x20table'+_0xc91797),db['run'](_0x1fa025,function(_0x58feb9){_0x58feb9?_0x16bf96(_0x58feb9):_0x436548({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0x35444e=>{return new Promise((_0x4edbd7,_0x26e02e)=>{const _0x55caac='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x55caac,[],(_0x3f28cf,_0x22d9a7)=>{_0x3f28cf?_0x26e02e(_0x3f28cf):_0x4edbd7(_0x22d9a7['map'](_0x59fb51=>_0x59fb51['name']));});});}),ipcMain['handle']('add-user',async(_0x529a5a,_0x18b059,_0x171a34)=>{return new Promise(_0x5850d3=>{const _0x394528=db['prepare']('INSERT\x20INTO\x20'+_0x171a34+'\x20(username)\x20VALUES\x20(?)');_0x394528['run'](_0x18b059,function(_0x1fe991){_0x1fe991?console['log']('error\x20in\x20add-user:'+_0x1fe991):_0x5850d3({'status':'success','id':this['lastID']});}),_0x394528['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x3f9d1f,_0x5e8e5d)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x350d8c,_0x248fd6)=>{if(_0x350d8c)_0x5e8e5d(_0x350d8c);else{_0x3f9d1f({'status':'success','users':_0x248fd6});for(_0x248fd6 of _0x248fd6){console['log'](_0x248fd6['username']);}}});});}),ipcMain['handle']('get-data',async(_0x4e5ad5,_0x2b5658)=>{return new Promise((_0x376a91,_0x4475e8)=>{const _0x2743bc='SELECT\x20*\x20FROM\x20'+_0x2b5658;console['log'](_0x2743bc),db['all'](_0x2743bc,[],(_0x147e9d,_0x1339b8)=>{_0x147e9d?_0x4475e8(_0x147e9d):_0x376a91(_0x1339b8);});});}),ipcMain['handle']('get-accounts',async _0x3c0a1b=>{return new Promise((_0x49e970,_0xad44bd)=>{const _0x482ba0='SELECT\x20*\x20FROM\x20accounts';console['log'](_0x482ba0),igaccountsDB['all'](_0x482ba0,[],(_0x2deb34,_0x3c59e4)=>{_0x2deb34?_0xad44bd(_0x2deb34):_0x49e970(_0x3c59e4);});});}),ipcMain['handle']('get-targets',async(_0x149dca,_0x4442c1)=>{return getTargetProfiles(_0x4442c1);}),ipcMain['handle']('delete-user',async(_0x22e598,_0x316401,_0x5e6c5d)=>{return new Promise((_0x6183e,_0x57afba)=>{const _0x343967=db['prepare']('DELETE\x20FROM\x20'+_0x5e6c5d+'\x20WHERE\x20username\x20=\x20?');_0x343967['run'](_0x316401,function(_0x510e90){_0x510e90?_0x57afba(_0x510e90):_0x6183e({'status':'success','changes':this['changes']});}),_0x343967['finalize']();});}),ipcMain['handle']('delete-account',async(_0x17e0c8,_0x1c60ef)=>{const _0x1bf148=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x1bf148['run'](_0x1c60ef,function(_0xc8ec76){_0xc8ec76&&console['log'](_0xc8ec76);}),_0x1bf148['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x406729,_0x7a68a0)=>{const _0x53de71='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x53de71,[],(_0x351254,_0x13bbdf)=>{_0x351254?_0x7a68a0({'status':'error','message':_0x351254['message']}):_0x406729({'status':'success','contactedCount':_0x13bbdf['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x383072,_0x37fb28)=>{const _0x49a2ac='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x49a2ac,[],(_0x4407ed,_0x27868c)=>{_0x4407ed?_0x37fb28({'status':'error','message':_0x4407ed['message']}):_0x383072({'status':'success','contactedCount':_0x27868c['contactedCount']});});});});function exportDatabase(_0x2d326f){return new Promise((_0x4720cf,_0x49cdfb)=>{const _0x2d9071='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20username,\x20Follower_Count,\x20Following_Count,\x20Post_Count,\x20clearname,\x20Bio\x0a\x20\x20\x20\x20\x20\x20FROM\x20'+_0x2d326f+'\x0a\x20\x20\x20\x20';db['all'](_0x2d9071,[],async(_0x57aaf2,_0x1a2f1c)=>{if(_0x57aaf2){console['error']('Fehler\x20bei\x20der\x20Abfrage:',_0x57aaf2['message']),_0x49cdfb(_0x57aaf2);return;}if(!_0x1a2f1c||_0x1a2f1c['length']===0x0){console['log']('Keine\x20Daten\x20gefunden.'),_0x4720cf();return;}const _0x23a89f=XLSX['utils']['json_to_sheet'](_0x1a2f1c),_0x257106=XLSX['utils']['sheet_to_csv'](_0x23a89f);try{const {canceled:_0x53a352,filePath:_0x39fdc8}=await dialog['showSaveDialog']({'title':'CSV-Datei\x20exportieren','defaultPath':path['join'](app['getPath']('documents'),_0x2d326f+'.csv'),'buttonLabel':'Speichern','filters':[{'name':'CSV\x20Files','extensions':['csv']},{'name':'All\x20Files','extensions':['*']}]});if(_0x53a352||!_0x39fdc8){console['log']('Speichern\x20abgebrochen.'),_0x4720cf();return;}fs['writeFile'](_0x39fdc8,_0x257106,'utf8',_0x3fd79c=>{_0x3fd79c?(console['error']('Fehler\x20beim\x20Schreiben\x20der\x20Datei:',_0x3fd79c['message']),_0x49cdfb(_0x3fd79c)):(console['log']('CSV-Datei\x20erfolgreich\x20exportiert:',_0x39fdc8),_0x4720cf());});}catch(_0x5bf0cb){console['error']('Fehler\x20im\x20Speicherdialog:',_0x5bf0cb),_0x49cdfb(_0x5bf0cb);}});});}ipcMain['handle']('start-stripe-checkout',async(_0x43e70d,_0x33a7f6)=>{shell['openExternal'](_0x33a7f6);});