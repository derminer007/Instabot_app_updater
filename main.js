const {app,BrowserWindow,ipcMain,dialog}=require('electron'),path=require('path'),puppeteer=require('puppeteer'),fs=require('fs')['promises'],{convertArrayToCSV}=require('convert-array-to-csv'),{replace}=require('formik'),{spawn}=require('child_process'),sqlite3=require('sqlite3')['verbose'](),ANZAHL_FOLLOWER_BUTTON='div.x9f619.x1n2onr6\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a\x20>\x20span\x20>\x20span',FOLLOWER_BUTTON='div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.x1ja2u2z\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20header\x20>\x20section.xc3tme8\x20>\x20ul\x20>\x20li:nth-child(2)\x20>\x20div\x20>\x20a',FOLLOWER_FENSTER='div.xyi19xy.x1ccrb07.xtf3nb5.x1pc53ja.x1lliihq.x1iyjqo2.xs83m0k.xz65tgg.x1rife3k.x1n2onr6',FOLLOWER_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',FOLLOWER_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',LIKERS_USERNAME_SPALTEN_ARRAY='a.x1i10hfl.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.x1ypdohk.xt0psk2.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.notranslate._a6hd',LIKERS_CLEARNAME_SPALTEN_ARRAY='div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',COM_ANZAHL_LIKERS_SPAN='div.x78zum5.xdt5ytf.x1ja2u2z\x20>\x20div.x9f619.xvbhtw8\x20>\x20div.x1gryazu\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x1xp8e9x\x20>\x20section.x12nagc\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20a\x20>\x20span\x20>\x20span',COM_COMMENTS_BOX_BODY_DIV='.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div\x20>\x20div.x78zum5.xdt5ytf.x1t2pt76.x1n2onr6.x1ja2u2z.x10cihs4\x20>\x20div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x1gryazu.xh8yej3.x10o80wk.x14k21rp.x17snn68.x6osk4m.x1porb0y\x20>\x20section\x20>\x20main\x20>\x20div\x20>\x20div.x6s0dn4.x78zum5.xdt5ytf.xdj266r.xkrivgy.xat24cr.x1gryazu.x1n2onr6.xh8yej3\x20>\x20div\x20>\x20div.x4h1yfo\x20>\x20div\x20>\x20div.x5yr21d.xw2csxc.x1odjw0f.x1n2onr6',COM_REPLY_BUTTON_SPAN='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x540dpk\x20>\x20div\x20>\x20div\x20>\x20span',COM_COMMENTS_USERNAME_ARRAY_SPAN='span._ap3a._aaco._aacw._aacx._aad7._aade',K_NEW_MSG_BUTTON='div.x1i10hfl.x972fbf.xcfux6l.x1qhh985.xm0m39n.x9f619.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x16tdsg8.x1hl2dhg.xggy1nq.x1a2a7pz.x6s0dn4.xjbqb8w.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x1ypdohk.x78zum5.xl56j7k.x1y1aw1k.x1sxyh0.xwib8y2.xurb0ha.xcdnw81',K_SEARCH_BAR_INPUT='body\x20>\x20div.x1n2onr6.xzkaem6\x20>\x20div.x9f619.x1n2onr6.x1ja2u2z\x20>\x20div\x20>\x20div.x1uvtmcs.x4k7w5x.x1h91t0o.x1beo9mf.xaigb6o.x12ejxvf.x3igimt.xarpa2k.xedcshv.x1lytzrv.x1t2pt76.x7ja8zs.x1n2onr6.x1qrby5j.x1jfb8zj\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x1k90msu.x6o7n8i.x1qfuztq.x10l6tqk.x17qophe.x13vifvy.x1hc1fzr.x71s49j.xh8yej3\x20>\x20div\x20>\x20div:nth-child(2)\x20>\x20div\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.x1q0g3np.x1a02dak.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20input',K_USERNAME_SPALTE_PART1='div:nth-child(',K_CLEARNAME_SPALTE_PART2=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1pi30zi.x1swvt13.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span\x20>\x20span',K_CHAT_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.x972fbf.xcfux6l.x1qhh985.xm0m39n.xdl72j9.x2lah0s.xe8uvvx.xdj266r.x11i5rnm.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.xexx8yu.x18d9i69.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1lq5wgf.xgqcy7u.x30kzoy.x9jhf4c.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x9bdzbf.x1ypdohk.x78zum5.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x1n2onr6.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xn3w4p2.x5ib6vp.xc73u3c.x1tu34mt.xzloghq',K_NACHRICHT_SCHREIBEN_INPUT_DIV='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1i64zmx.xw3qccf.x1uhb9sk.x1plvlek.xryxfnj.x1iyjqo2.x2lwn1j.xeuugli.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div.xzsf02u.x1a2a7pz.x1n2onr6.x14wi4xw.x1iyjqo2.x1gh3ibb.xisnujt.xeuugli.x1odjw0f.notranslate',K_SENDEN_BUTTON_DIV='div.x1i10hfl.xjqpnuy.xa49m3k.xqeqjp1.x2hbi6w.xdl72j9.x2lah0s.xe8uvvx.xdj266r.xat24cr.x1mh8g0r.x2lwn1j.xeuugli.x1hl2dhg.xggy1nq.x1ja2u2z.x1t137rt.x1q0g3np.x1lku1pv.x1a2a7pz.x6s0dn4.xjyslct.x1ejq31n.xd10rxx.x1sy0etr.x17r0tee.x9f619.x1ypdohk.x1f6kntn.xwhw2v2.xl56j7k.x17ydfre.x2b8uid.xlyipyv.x87ps6o.x14atkfc.xcdnw81.x1i0vuye.xjbqb8w.xm3z3ea.x1x8b98j.x131883w.x16mih1h.x972fbf.xcfux6l.x1qhh985.xm0m39n.xt0psk2.xt7dq6l.xexx8yu.x4uap5.x18d9i69.xkhd6sd.x1n2onr6.x1n5bzlp.x173jzuc.x1yc6y37.xfs2ol5[role=\x22button\x22][tabindex=\x220\x22]',IG_NAME_SPAN_PART1='a:nth-child(',IG_USERNAME_CLEANAME_PART2_BOX=')\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xxbr6pl.xbbxn1n.xwib8y2.x1y1aw1k.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20div.x9f619.x1ja2u2z.x78zum5.x1n2onr6.x1iyjqo2.xs83m0k.xeuugli.x1qughib.x6s0dn4.x1a02dak.x1q0g3np.xdl72j9',IG_USERNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20span',IG_CLEARNAME_SPAN_PART2=IG_USERNAME_CLEANAME_PART2_BOX+'\x20>\x20div\x20>\x20div\x20>\x20span\x20>\x20span',IG_SEARCH_INPUT='div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1d52u69.xktsk01.x1n2onr6.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1\x20>\x20div\x20>\x20div\x20>\x20input',IG_SEARCH_BUTTON='div.x9f619.xvbhtw8.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.x1uhb9sk.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.x1q0g3np.xqjyukv.x1qjc9v5.x1oa3qoh.x1qughib\x20>\x20div.x9f619.xjbqb8w.x78zum5.x168nmei.x13lgxp2.x5pf9jr.xo71vjh.xixxii4.x13vifvy.x1plvlek.xryxfnj.x1c4vz4f.x2lah0s.xdt5ytf.xqjyukv.x1qjc9v5.x1oa3qoh.x1nhvcw1.x1dr59a3.xeq5yr9.x1n327nk\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div\x20>\x20div.x1iyjqo2.xh8yej3\x20>\x20div:nth-child(2)\x20>\x20span\x20>\x20div';function createWindow(){const _0x58732a=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'preload':path['join'](__dirname,'preload.js'),'contextIsolation':!![],'enableRemoteModule':![]}});console['log'](__dirname),_0x58732a['loadFile'](path['join'](__dirname,'index.html'));}app['whenReady']()['then'](createWindow),app['on']('window-all-closed',()=>{app['quit']();}),app['on']('activate',()=>{BrowserWindow['getAllWindows']()['length']===0x0&&createWindow();});function createChildWindow(_0x4b9010){var _0x86154f=![];BrowserWindow['getAllWindows']()['forEach'](function(_0x28555b){console['log']('window\x20id:'+_0x28555b['id']),_0x28555b['id']>0x1&&(_0x86154f=!![]);}),console['log']('child\x20opened\x20='+_0x86154f);if(!_0x86154f){const _0x320f2f=new BrowserWindow({'width':0x320,'height':0x258,'title':'Odano','webPreferences':{'nodeIntegration':!![],'enableRemoteModule':!![],'contextBridge':!![],'nativeWindowOpen':!![],'nodeIntegrationInSubFrames':!![],'parent':win,'preload':path['join'](__dirname,'preload.js')}});_0x320f2f['loadFile'](_0x4b9010['url']);}else console['log']('child\x20window\x20opened\x20already');}let browser=null,pageStack=[null],isStopping=![];async function getBrowserPage(_0x21f75e=0x1,_0x43bf5e=0x0){let _0x4df7a9='',_0x24aef3=null;if(process['platform']==='darwin')_0x4df7a9='/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome';else{if(process['platform']==='win32')_0x4df7a9='chromium_local/chrome-win/chrome.exe';else{if(process['platform']==='linux'){}}}if(_0x21f75e===0x0&&!pageStack[_0x43bf5e])return browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0x4df7a9}),_0x24aef3=await browser['newPage'](),_0x24aef3['setDefaultNavigationTimeout'](0x1d4c),_0x24aef3['setDefaultTimeout'](0x1d4c),pageStack[_0x43bf5e]=_0x24aef3,_0x24aef3;return(browser===null||pageStack[_0x43bf5e]['isClosed']())&&(browser=await puppeteer['launch']({'headless':![],'ignoreHTTPSErrors':!![],'defaultViewport':null,'executablePath':_0x4df7a9})),(pageStack[_0x43bf5e]===null||pageStack[_0x43bf5e]['isClosed']())&&(_0x24aef3=await browser['newPage'](),_0x24aef3['setDefaultNavigationTimeout'](0x1d4c),_0x24aef3['setDefaultTimeout'](0x1d4c),pageStack[_0x43bf5e]=_0x24aef3),pageStack[_0x43bf5e];}ipcMain['on']('login',async(_0x1e9743,_0x786a80,_0x278e34)=>{const _0xb3d624=await getBrowserPage();await _0xb3d624['goto']('https://www.instagram.com/accounts/login/'),console['log']('Login\x20startet'),await login(_0xb3d624,_0x786a80,_0x278e34);}),ipcMain['handle']('sendMessage',async(_0x160bbe,_0x55884d,_0x399de1,_0x112a16,_0x468eed,_0x18a922,_0x2121e5,_0x5411d5)=>{isStopping=![];let _0x580b6c=null;return _0x2121e5?_0x580b6c=await getBrowserPage(_0x468eed,_0x5411d5):_0x580b6c=await getBrowserPage(),console['log']('send\x20Message\x20gestartet'),console['log'](_0x55884d),new Promise((_0x77292a,_0x35db4e)=>{send_message(_0x580b6c,_0x55884d,_0x399de1,_0x112a16,_0x468eed,_0x18a922)['then'](_0x4db4aa=>_0x77292a(_0x4db4aa))['catch'](_0x58f496=>_0x35db4e(_0x58f496));});}),ipcMain['handle']('stop-action',async(_0x3c3039,_0x13757e)=>{isStopping=!![];const _0x537e05=await getBrowserPage(0x1,_0x13757e);await _0x537e05['close']();}),ipcMain['handle']('fetch_followers',async(_0x2cff36,_0x4a9cb6,_0x42638e,_0x5b0efa,_0x3d2465)=>{isStopping=![];const _0x4be236=await getBrowserPage();return fetch_followers_from_account(_0x4be236,_0x4a9cb6,_0x42638e,_0x5b0efa,_0x3d2465);}),ipcMain['handle']('fetch_likes',async(_0x1d197e,_0x962429,_0x2d30ad,_0x10389e,_0x31f8f3)=>{isStopping=![];const _0x382bf7=await getBrowserPage();return fetch_likers_from_post(_0x382bf7,_0x962429,_0x2d30ad,_0x10389e,_0x31f8f3);}),ipcMain['handle']('fetch_comments',async(_0xfbd05a,_0x49fe0a,_0x38173d,_0x5a8004,_0x4acfb7)=>{isStopping=![];const _0x55d2a6=await getBrowserPage();return fetch_comments_from_post(_0x55d2a6,_0x49fe0a,_0x38173d,_0x5a8004,_0x4acfb7);}),ipcMain['handle']('update-app',async _0x25f3f0=>{const {spawn:_0x1312f2}=require('child_process'),_0x56385d=require('path');if(process['platform']==='darwin'){const _0x2c8c99=_0x56385d['join'](__dirname,'mac-updater-intern.sh'),_0x3b5b06=_0x1312f2('/bin/bash',[_0x2c8c99]);_0x3b5b06['stdout']['on']('data',_0xbfc9f3=>{console['log']('stdout:\x20'+_0xbfc9f3);}),_0x3b5b06['stderr']['on']('data',_0x33d3a7=>{console['error']('stderr:\x20'+_0x33d3a7);}),_0x3b5b06['on']('close',_0x26ec89=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x26ec89);});}else{if(process['platform']==='win32'){const _0x27fcd4=_0x56385d['join'](__dirname,'../','../','../');process['chdir'](_0x27fcd4),console['log']('Aktuelles\x20Verzeichnis:\x20'+process['cwd']());const _0x292726='soft-ui-updater-windows.ps1',_0x15660f='soft-ui-updater-windows.exe',_0x5c4f13=_0x1312f2('powershell.exe',['-ExecutionPolicy','Bypass','-File',_0x292726]);console['log']('Windows\x20Pfad:\x20'+_0x27fcd4),_0x5c4f13['stdout']['on']('data',_0xee6932=>{console['log']('stdout:\x20'+_0xee6932);}),_0x5c4f13['stderr']['on']('data',_0x57603c=>{console['error']('stderr:\x20'+_0x57603c);}),_0x5c4f13['on']('close',_0x100e90=>{console['log']('Skript\x20beendete\x20sich\x20mit\x20Code\x20'+_0x100e90);});}}});function getRnd(_0x28b0df,_0x4e6989){return Math['random']()*(_0x4e6989-_0x28b0df+0x1)+_0x28b0df;}function delay(_0x16b392,_0x5f9ebc){let _0x253e0e=getRnd(_0x16b392,_0x5f9ebc);return new Promise(function(_0x177c09){setTimeout(_0x177c09,_0x253e0e);});}async function scroll(_0x55f462,_0x511ebd,_0x29691b=0x2){const _0xcec820=await _0x55f462['waitForSelector'](_0x511ebd);for(let _0x5433e6=0x0;_0x5433e6<_0x29691b;_0x5433e6++){console['log']('Scrolling\x20'+_0x5433e6),await _0x55f462['evaluate'](_0x1adb98=>{const _0x19541c=document['querySelector'](_0x1adb98);_0x19541c&&_0x19541c['scrollBy'](0x0,0x190);},_0x511ebd),await delay(0x320,0x5dc);}}async function saveCookies(_0x35d0bf){let _0x17ef70=await _0x35d0bf['cookies']();await fs['writeFile']('public/cookies.json',JSON['stringify'](_0x17ef70,null,0x2));}async function notificationClear(_0x3e51d8){console['log']('Suche\x20nach\x20Notification-Button');try{await delay(0xbb8,0x1388),await _0x3e51d8['waitForSelector']('button._a9--._ap36._a9_1',{'visible':!![]}),await _0x3e51d8['click']('button._a9--._ap36._a9_1'),console['log']('Notification-Button\x20gefunden');}catch(_0x579b3e){console['log']('Notification-Feld\x20übersprungen:\x20'+_0x579b3e);}}async function getTargetProfiles(_0x2b82cb){return new Promise((_0x43a0f1,_0x452bc6)=>{db['all']('SELECT\x20*\x20FROM\x20'+_0x2b82cb,(_0x27d432,_0x48748e)=>{_0x27d432?_0x452bc6(_0x27d432):_0x43a0f1(_0x48748e);});});}async function login(_0x490002,_0x6f1bec,_0x18afb6){console['log']('Starte\x20Login\x20Prozess');try{await setCookiesForUser(_0x490002,_0x6f1bec),await createUserIfNotExists(_0x6f1bec,_0x18afb6);}catch(_0xe6e049){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0xe6e049);}try{await _0x490002['goto']('https://www.instagram.com/accounts/login/');try{await delay(0x7d0,0x1388),await _0x490002['waitForSelector']('button._a9--._ap36._a9_0',{'visible':!![]}),await _0x490002['click']('button._a9--._ap36._a9_0');}catch(_0x3725e0){console['log']('Cookie\x20Fenster\x20überspringen');}await delay(0xfa0,0x1d4c);try{await _0x490002['waitForSelector']('input[name=\x27username\x27]'),console['log']('Benutzername-Feld\x20gefunden'),await _0x490002['type']('input[name=\x27username\x27]',_0x6f1bec,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x490002['waitForSelector']('input[name=\x27password\x27]'),console['log']('Passwort-Feld\x20gefunden'),await _0x490002['type']('input[name=\x27password\x27]',_0x18afb6,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),await _0x490002['waitForSelector']('button[type=\x27submit\x27]'),console['log']('Login-Button\x20gefunden'),await _0x490002['click']('button[type=\x27submit\x27]');}catch(_0x2b2ad5){console['log']('Anmeldeformular\x20nicht\x20gefunden');}await notificationClear(_0x490002),await delay(0x1388,0x1b58);try{await saveCookiesForUser(_0x490002,_0x6f1bec);}catch(_0x21d7b3){console['log']('Fehler\x20bei\x20Cookie\x20speichern:\x20'+_0x21d7b3);}}catch(_0x57a74c){console['log']('Login\x20nicht\x20durgeführt:\x20'+_0x57a74c);}}async function send_message(_0xd49266,_0x4a0421,_0x45c1d0,_0x3dada8,_0x173a7f,_0x560d13){_0x560d13=_0x560d13['split'](';'),console['log'](_0x560d13[0x0]),console['log']('Anfang'),console['log']('Counter:\x20'+_0x173a7f);if(_0x173a7f==0x0){try{await login(_0xd49266,_0x560d13[0x0],_0x560d13[0x1]);}catch(_0x353cd3){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x353cd3);return;}await _0xd49266['goto']('https://www.instagram.com/direct/inbox/'),await delay(0xfa0,0x1d4c),await notificationClear(_0xd49266);}let _0x371bdd;await set_clearname_from_username(_0xd49266,_0x45c1d0);const _0x1327a5='SELECT\x20clearname\x20FROM\x20'+_0x45c1d0+'\x20WHERE\x20username\x20IS\x20?';db['all'](_0x1327a5,[_0x4a0421],(_0x7c1e6d,_0x27d5bd)=>{_0x7c1e6d&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x7c1e6d['message']);if(_0x27d5bd['length']===0x0)return;_0x371bdd=_0x27d5bd['map'](_0x164a02=>_0x164a02['clearname']);});try{try{const _0x5b6994=K_NEW_MSG_BUTTON;await delay(0xfa0,0x1d4c),await _0xd49266['waitForSelector'](_0x5b6994),await _0xd49266['click'](_0x5b6994),console['log']('Message-Button\x20geklickt'),console['log'](_0x4a0421+'\x20'+_0x3dada8),await delay(0xfa0,0x1d4c);try{const _0x5bd9f1='input[name=\x22queryBox\x22]',_0x1b0442=K_SEARCH_BAR_INPUT;await _0xd49266['waitForSelector'](_0x1b0442),await _0xd49266['click'](_0x1b0442),await delay(0xfa0,0x1d4c),await _0xd49266['waitForSelector'](_0x5bd9f1),await _0xd49266['click'](_0x5bd9f1),await delay(0xfa0,0x1d4c),await _0xd49266['type'](_0x5bd9f1,_0x4a0421,{'delay':getRnd(0x50,0x78)}),await delay(0xfa0,0x1d4c),console['log']('Account\x20Name\x20eingefügt');const _0x526cee=K_USERNAME_SPALTE_PART1,_0x927cca=K_CLEARNAME_SPALTE_PART2;let _0x5732fb=0x1;try{while(_0x5732fb!=0x14){console['log']('Schleife');let _0x36534f=_0x526cee+_0x5732fb+_0x927cca;const _0x4fdaec=await _0xd49266['waitForSelector'](_0x36534f),_0x29cd1c=await _0xd49266['evaluate'](_0x354c92=>_0x354c92['innerHTML'],_0x4fdaec);console['log'](_0x29cd1c+';'+_0x371bdd+';'+_0x4a0421),delay(0x3e8,0xbb8);if(_0x29cd1c==_0x371bdd){console['log']('Account\x20gefunden'),await _0xd49266['click'](_0x36534f);break;}else{if(_0x29cd1c==_0x4a0421){console['log']('Account\x20gefunden'),await _0xd49266['click'](_0x36534f);break;}}_0x5732fb++;}try{await delay(0xbb8,0x1388);const _0x2dcc30=await _0xd49266['waitForSelector'](K_CHAT_BUTTON_DIV);console['log'](_0x2dcc30),await delay(0xbb8,0x1388),await _0x2dcc30['click']();try{await delay(0xbb8,0x1388);const _0x5e0b70=await _0xd49266['waitForSelector'](K_NACHRICHT_SCHREIBEN_INPUT_DIV);await _0x5e0b70['type'](_0x3dada8,{'delay':getRnd(0x50,0x78)}),await delay(0xbb8,0x1388);try{const _0x451311=await _0xd49266['waitForSelector'](K_SENDEN_BUTTON_DIV);return await _0x451311['click'](),await delay(0xbb8,0x1388),new Promise(_0x49dbe2=>{_0x49dbe2('Nachricht\x20erfolgreich\x20verschickt!');});}catch(_0x2377ea){console['log']('Message-Button\x20nicht\x20geklickt:\x20'+_0x2377ea);}}catch(_0x224283){console['log']('Chat-Fenster\x20nicht\x20gefunden:\x20'+_0x224283);}}catch(_0x3d58d3){console['log']('error:\x20'+_0x3d58d3);}}catch(_0x2935ed){return console['log']('User\x20nicht\x20gefunden:'+_0x2935ed),await _0xd49266['goto']('https://www.instagram.com/direct/inbox/'),new Promise((_0x3a38b9,_0x2f3555)=>{_0x2f3555('user_not_found');});}}catch(_0x11deac){console['log']('DM-Fenster\x20nicht\x20gefunden:'+_0x11deac);}}catch(_0x85b9df){console['log']('Message-Button\x20nicht\x20geklickt:'+_0x85b9df);}}catch(_0x1cd0f4){console['log']('Nachricht\x20senden\x20fehlgeschlagen:\x20'+_0x1cd0f4);}return console['log']('Ende'),await _0xd49266['goto']('https://www.instagram.com/direct/inbox/'),new Promise((_0x5c0b2f,_0x3dd02a)=>{_0x3dd02a('ig_update');});}function handle_fail(_0x3f0bae){if(isStopping)return new Promise(_0x3d8ae6=>{_0x3d8ae6('Scraper\x20gestoppt.');});else{let _0x450d54='';switch(_0x3f0bae){case 0x0:_0x450d54='Fehler\x20beim\x20Follower\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x1:_0x450d54='Fehler\x20beim\x20Liker\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;case 0x2:_0x450d54='Fehler\x20beim\x20Comments\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;default:_0x450d54='Fehler\x20beim\x20Scraper.\x20Bitte\x20lade\x20die\x20neuste\x20Version\x20herunter.';break;}return new Promise((_0xd2a1de,_0x4cc229)=>{_0x4cc229(_0x450d54);});}}async function fetch_followers_from_account(_0x3d6286,_0x25aa10,_0x9a9d40,_0x56b56a,_0x511e2a){try{await login(_0x3d6286,_0x511e2a['username'],_0x511e2a['password']);}catch(_0x5cbf76){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x5cbf76),handle_fail(0x0);}let _0x41b217=0x0;try{await _0x3d6286['goto']('https://www.instagram.com/'+_0x25aa10+'/'),await notificationClear(_0x3d6286);try{if(_0x9a9d40<=0x0){const _0x4f2fd3=await _0x3d6286['waitForSelector'](ANZAHL_FOLLOWER_BUTTON);await delay(0x12c,0x320);const _0x550580=await _0x3d6286['evaluate'](_0x224771=>_0x224771['innerHTML'],_0x4f2fd3);_0x41b217=Math['ceil'](_0x550580/0x4);}else _0x41b217=Math['ceil'](_0x9a9d40/0x4);let _0x27e151=await _0x3d6286['waitForSelector']('a[href=\x22/'+_0x25aa10+'/followers/\x22]');await delay(0xbb8,0x1388),await _0x27e151['click'](),console['log']('Follower\x20Liste\x20von\x20'+_0x25aa10+'\x20gesichtet');}catch(_0x5cc795){return console['log']('Follower\x20Liste\x20von\x20'+_0x25aa10+'\x20nicht\x20gefunden:'+_0x5cc795),handle_fail(0x0);}}catch(_0x43d9cf){return console['log']('User\x20besuchen\x20fehlgeschlagen:\x20'+_0x43d9cf),handle_fail(0x0);}try{await delay(0xbb8,0x1388),console['log']('Auto-scrolls:\x20'+_0x41b217),await scroll(_0x3d6286,FOLLOWER_FENSTER,_0x41b217),await _0x3d6286['waitForSelector'](FOLLOWER_USERNAME_SPALTEN_ARRAY);const _0x5952f0=await _0x3d6286['$$'](FOLLOWER_USERNAME_SPALTEN_ARRAY),_0x53c68b=await _0x3d6286['$$'](FOLLOWER_CLEARNAME_SPALTEN_ARRAY);_0x9a9d40<=0x0&&(_0x9a9d40=_0x5952f0['length']);for(let _0x44bd51=0x0;_0x44bd51<_0x5952f0['length']&&_0x44bd51<_0x9a9d40;_0x44bd51++){console['log'](await _0x5952f0[_0x44bd51]['evaluate'](_0x10d20e=>_0x10d20e['textContent']));const _0x5c42cc='INSERT\x20INTO\x20'+_0x56b56a+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x5c42cc,[await _0x5952f0[_0x44bd51]['evaluate'](_0x462e40=>_0x462e40['textContent']),await _0x53c68b[_0x44bd51]['evaluate'](_0x1d3898=>_0x1d3898['textContent'])],function(_0x3e4081){_0x3e4081?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x56b56a+'\x27:',_0x3e4081['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}return new Promise(_0x15fdf4=>{_0x15fdf4('Scraping\x20finished!');});}catch(_0x2b1a69){return console['log']('Fehler\x20bei\x20der\x20Followerliste\x20von\x20'+_0x25aa10+'\x20nicht\x20gefunden:'+_0x2b1a69),handle_fail(0x0);}}async function fetch_likers_from_post(_0x424b4d,_0x81c9da,_0x1e2828,_0x355e8a,_0x5a5ef5){try{await login(_0x424b4d,_0x5a5ef5['username'],_0x5a5ef5['password']);}catch(_0x2213c8){console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x2213c8);return handle_fail(0x1);return;}try{let _0x46eb64=_0x81c9da['substring'](0x0,_0x81c9da['lastIndexOf']('/')),_0x104592=_0x46eb64+'/liked_by';console['log'](_0x104592),await _0x424b4d['goto'](_0x104592),await delay(0x7d0,0xfa0),await notificationClear(_0x424b4d),await delay(0xc8,0x1f4),await _0x424b4d['waitForSelector'](LIKERS_USERNAME_SPALTEN_ARRAY),await delay(0x1f4,0x320);const _0xbb9dac=await _0x424b4d['$$'](LIKERS_USERNAME_SPALTEN_ARRAY),_0x11f633=await _0x424b4d['$$'](LIKERS_CLEARNAME_SPALTEN_ARRAY);await delay(0x1f4,0x320),console['log'](_0xbb9dac['length']);let _0x2e88d2=path['join'](__dirname,'/likers.csv');_0x1e2828<=0x0&&(_0x1e2828=_0xbb9dac['length']);try{for(let _0x4519ce=0x0;_0x4519ce<_0xbb9dac['length']&&_0x4519ce<_0x1e2828;_0x4519ce++){console['log'](await _0xbb9dac[_0x4519ce]['evaluate'](_0x11757f=>_0x11757f['textContent']));try{const _0x13b117='INSERT\x20INTO\x20'+_0x355e8a+'\x20(username,\x20clearname)\x20VALUES\x20(?,\x20?)';db['run'](_0x13b117,[await _0xbb9dac[_0x4519ce]['evaluate'](_0x1310f2=>_0x1310f2['textContent']),await _0x11f633[_0x4519ce]['evaluate'](_0x2d88bc=>_0x2d88bc['textContent'])],function(_0x3a4c89){_0x3a4c89?console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27'+_0x355e8a+'\x27:',_0x3a4c89['message']):console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']);});}catch(_0xea8258){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x4519ce+'\x20:\x20'+_0xea8258),handle_fail(0x1);}}return new Promise(_0x1dca65=>{_0x1dca65('Scraping\x20finished!');});}catch(_0x2cdd5a){return console['log']('Nicht\x20in\x20Likers\x20Datei\x20geschrieben'),handle_fail(0x1);}}catch(_0x135003){return console['log']('Like-Seite\x20nicht\x20geöffnet'+_0x135003),handle_fail(0x1);}}async function fetch_comments_from_post(_0x357d31,_0x2e8a83,_0x30cb45,_0x23c9d7,_0x17f209){try{await login(_0x357d31,_0x17f209['username'],_0x17f209['password']);}catch(_0x55e746){return console['log']('Cookies\x20konnten\x20nicht\x20hinzuefügt\x20werden:'+_0x55e746),handle_fail(0x2);}try{console['log'](_0x2e8a83),await _0x357d31['goto'](_0x2e8a83),await delay(0x7d0,0xfa0),await notificationClear(_0x357d31),await delay(0xc8,0x1f4);const _0x54f940=COM_COMMENTS_BOX_BODY_DIV;let _0x57b0b4;if(_0x30cb45<=0x0){const _0x343d99=await _0x357d31['waitForSelector'](COM_ANZAHL_LIKERS_SPAN);await delay(0x12c,0x320);let _0x28b5c4=await _0x357d31['evaluate'](_0x322c3b=>_0x322c3b['innerHTML'],_0x343d99),_0xd2c02c=String(_0x28b5c4)['replace'](/[^0-9]/g,''),_0xfa2dc5=Number(_0xd2c02c)/0x14;_0x57b0b4=Math['ceil'](_0xfa2dc5/0x3);}else _0x57b0b4=Math['ceil'](_0x30cb45/0x3);console['log']('Auto-scrolls:\x20'+_0x57b0b4),await scroll(_0x357d31,_0x54f940,_0x57b0b4);try{const _0x4075d7=COM_REPLY_BUTTON_SPAN;await _0x357d31['waitForSelector'](_0x4075d7),await delay(0x1f4,0x320);const _0x21e771=await _0x357d31['$$'](_0x4075d7);console['log'](_0x21e771),await delay(0xc8,0x1f4);try{for(let _0x16adfd=0x0;_0x16adfd<_0x21e771['length'];_0x16adfd++){_0x21e771[_0x16adfd]['click'](),await delay(0x320,0x5dc);}}catch(_0x3a7b57){return console['log']('Nicht\x20auf\x20Replies\x20geklickt\x20'+_0x3a7b57),handle_fail(0x2);}}catch(_0x33cb8f){console['log']('Kein\x20Reply-Button\x20gefunden.\x20Überspringe\x20Schritt');}const _0x5335cd=COM_COMMENTS_USERNAME_ARRAY_SPAN;await _0x357d31['waitForSelector'](_0x5335cd),await delay(0x1f4,0x320);const _0x13ea48=await _0x357d31['$$'](_0x5335cd);let _0x5c486d=path['join'](__dirname,'/comments.csv');_0x30cb45<=0x0&&(_0x30cb45=_0x13ea48['length']);console['log']('fetch_limit:\x20'+_0x30cb45),console['log']('comments_len:\x20'+_0x13ea48['length']),_0x30cb45++;try{for(let _0x4576ad=0x1;_0x4576ad<_0x13ea48['length']&&_0x4576ad<_0x30cb45;_0x4576ad++){try{console['log'](await _0x13ea48[_0x4576ad]['evaluate'](_0x663a81=>_0x663a81['textContent']));const _0x441f00=await db['prepare']('INSERT\x20INTO\x20'+_0x23c9d7+'\x20(username)\x20VALUES\x20(?)');await _0x441f00['run'](await _0x13ea48[_0x4576ad]['evaluate'](_0x20bcbd=>_0x20bcbd['textContent']),function(_0x2cdbd2){_0x2cdbd2&&console['log']('error\x20in\x20add-user:'+_0x2cdbd2);}),await _0x441f00['finalize']();}catch(_0x421d7f){return console['log']('Fehler\x20innerhalb\x20des\x20Fetchen\x20bei\x20i='+_0x4576ad+'\x20:\x20'+_0x421d7f),handle_fail(0x2);}}await delay(0x4b0,0x7d0);try{await set_clearname_from_username(_0x357d31,_0x23c9d7);}catch(_0x2741f8){console['log']('Username\x20nicht\x20gefunden:\x20'+_0x2741f8);}return new Promise(_0x4a7d6d=>{_0x4a7d6d('Scraping\x20finished!');});}catch(_0x2f1d16){return console['log']('Nicht\x20in\x20Comments\x20Datei\x20geschrieben'),handle_fail(0x2);}}catch(_0xfb027c){return console['log']('Comments-Seite\x20nicht\x20geöffnet'+_0xfb027c),handle_fail(0x2);}}async function set_clearname_from_username(_0x12ec54,_0xb05984){try{let _0x3cb08b,_0x48104d;const _0x5c73d6='SELECT\x20username\x20FROM\x20'+_0xb05984+'\x20WHERE\x20clearname\x20IS\x20NULL';db['all'](_0x5c73d6,[],(_0x5791ce,_0x56331e)=>{_0x5791ce&&console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten:',_0x5791ce['message']),_0x56331e['length']===0x0&&(_0x48104d=_0x56331e['length']),_0x3cb08b=_0x56331e['map'](_0x19156a=>_0x19156a['username']);}),await delay(0x4b0,0x7d0),console['log']('USERNAME:\x20'+_0x48104d);if(_0x48104d===0x0){console['log']('Leave');return;}const _0x12c012=await _0x12ec54['waitForSelector'](IG_SEARCH_BUTTON);await _0x12c012['click'](),await delay(0x4b0,0x7d0);for(let _0x24aa03 of _0x3cb08b){const _0x431ee2=await _0x12ec54['waitForSelector'](IG_SEARCH_INPUT);await _0x431ee2['click']({'clickCount':0x3}),await delay(0x320,0x3e8),await _0x12ec54['type'](IG_SEARCH_INPUT,_0x24aa03,{'delay':getRnd(0x50,0x78)}),await delay(0x4b0,0x7d0);let _0x44abf1=0x1;while(_0x44abf1!=0x14){console['log']('Schleife');try{let _0x1f5c6c=IG_NAME_SPAN_PART1+_0x44abf1+IG_USERNAME_SPAN_PART2;const _0x2a21a6=await _0x12ec54['waitForSelector'](_0x1f5c6c),_0x28e4b1=await _0x12ec54['evaluate'](_0xb9156b=>_0xb9156b['innerHTML'],_0x2a21a6);await delay(0xc8,0x1f4);if(_0x28e4b1==_0x24aa03){let _0x4b9e08=IG_NAME_SPAN_PART1+_0x44abf1+IG_CLEARNAME_SPAN_PART2;console['log']('Username\x20gefunden');const _0x3cc72e=await _0x12ec54['waitForSelector'](_0x4b9e08);let _0x3cd834=await _0x12ec54['evaluate'](_0x40b5ad=>_0x40b5ad['innerHTML'],_0x3cc72e);const _0x1f444e=/^(.*?)(?:\s*•\s*)(\d+[,.]?\d*\s*(Tsd\.|Mio\.|Mrd\.)?\s*Follower)$/,_0x2aaf0d=_0x3cd834['match'](_0x1f444e);_0x2aaf0d?_0x3cd834=_0x2aaf0d[0x1]['trim']():_0x3cd834=_0x3cd834['trim']();const _0x497db0='UPDATE\x20'+_0xb05984+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x497db0,[_0x3cd834,_0x28e4b1],function(_0x39cd68){_0x39cd68&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x39cd68['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');});break;}_0x44abf1++;}catch(_0x497024){const _0x264fd8='UPDATE\x20'+_0xb05984+'\x20SET\x20clearname\x20=\x20?\x20WHERE\x20username\x20=\x20?';db['run'](_0x264fd8,['',_0x24aa03],function(_0x6594f3){_0x6594f3&&console['error']('Fehler\x20beim\x20Aktualisieren\x20von\x20clearname:',_0x6594f3['message']),this['changes']===0x0&&console['log']('Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20konnte.'),console['log']('Eintrag\x20erfolgreich\x20aktualisiert.');}),console['log']('User\x20nicht\x20gefunden:'+_0x497024);break;}}}await _0x12c012['click']();}catch(_0x5ef170){console['log']('Keine\x20Usernames\x20mit\x20NULL-Clearnames\x20gefunden.\x20Überspringen.'),console['log']('Info:\x20'+_0x5ef170);}}const campaignPath=path['resolve'](__dirname,'data/campaign.db'),campaignDB=new sqlite3['Database'](campaignPath);campaignDB['serialize'](()=>{campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20campaign\x20(campaign_name\x20TEXT\x20PRIMARY\x20KEY,\x20list_id\x20TEXT,\x20zeitabstand\x20REAL,\x20message_id\x20TEXT,\x20account\x20TEXT,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20message\x20(message_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_text\x20TEXT)'),campaignDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20dm\x20(dm_id\x20INTEGER\x20PRIMARY\x20KEY,\x20message_id\x20INTEGER,\x20account\x20TEXT,\x20username\x20TEXT,\x20list_id\x20TEXT,\x20date\x20TIMESTAMP\x20DEFAULT\x20CURRENT_TIMESTAMP,\x20FOREIGN\x20KEY\x20(message_id)\x20REFERENCES\x20messages\x20(message_id))');}),ipcMain['handle']('get-campaigns',async()=>{return new Promise((_0x5880cf,_0x27f982)=>{const _0x21999a='SELECT\x20campaign_name\x20FROM\x20campaign';campaignDB['all'](_0x21999a,[],(_0x55616a,_0x49bd6e)=>{_0x55616a?_0x27f982(_0x55616a):_0x5880cf(_0x49bd6e);});});}),ipcMain['handle']('get-campaign-details',async()=>{return new Promise((_0x27c634,_0x43c775)=>{const _0x31ea48='SELECT\x20campaign_name,\x20list_id\x20FROM\x20campaign';campaignDB['all'](_0x31ea48,[],async(_0x12456b,_0x24e38e)=>{if(_0x12456b)console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnen:',_0x12456b['message']),_0x43c775({'status':'error','message':_0x12456b['message']});else try{const _0x2cd720=await Promise['all'](_0x24e38e['map'](_0x3c5f1f=>{return new Promise(_0x4b5ce6=>{if(!_0x3c5f1f['list_id']){console['warn']('Fehlende\x20list_id\x20für\x20Kampagne:\x20'+_0x3c5f1f['campaign_name']),_0x4b5ce6({'campaign_name':_0x3c5f1f['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'});return;}const _0x1f284a='SELECT\x20COUNT(*)\x20as\x20lead_count\x20FROM\x20'+_0x3c5f1f['list_id'],_0x45cb21='SELECT\x20COUNT(*)\x20as\x20contacted_count\x20FROM\x20'+_0x3c5f1f['list_id']+'\x20WHERE\x20contacted\x20=\x201';db['get'](_0x1f284a,[],(_0x283624,_0x4a66c6)=>{_0x283624?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Leads\x20für\x20'+_0x3c5f1f['campaign_name']+':',_0x283624['message']),_0x4b5ce6({'campaign_name':_0x3c5f1f['campaign_name'],'lead_count':'N/A','contacted_count':'N/A'})):db['get'](_0x45cb21,[],(_0x34eea8,_0xe4b571)=>{_0x34eea8?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20kontaktierten\x20Nutzer\x20für\x20'+_0x3c5f1f['campaign_name']+':',_0x34eea8['message']),_0x4b5ce6({'campaign_name':_0x3c5f1f['campaign_name'],'lead_count':_0x4a66c6?_0x4a66c6['lead_count']:0x0,'contacted_count':'N/A'})):_0x4b5ce6({'campaign_name':_0x3c5f1f['campaign_name'],'lead_count':_0x4a66c6?_0x4a66c6['lead_count']:0x0,'contacted_count':_0xe4b571?_0xe4b571['contacted_count']:0x0});});});});}));_0x27c634({'status':'success','campaigns':_0x2cd720});}catch(_0x3f5b20){console['error']('Fehler\x20bei\x20der\x20Verarbeitung\x20der\x20Kampagnendetails:',_0x3f5b20),_0x43c775({'status':'error','message':_0x3f5b20['message']});}});});}),ipcMain['handle']('get-campaign-writer-information',async(_0x53d828,_0x34b8fe)=>{return new Promise((_0x3e3a1d,_0x4faf99)=>{const _0x5b8d2b='SELECT\x20campaign.list_id,\x20message.message_text,\x20campaign.zeitabstand,\x20campaign.account\x20FROM\x20campaign\x20LEFT\x20JOIN\x20message\x20ON\x20campaign.message_id\x20=\x20message.message_id\x20WHERE\x20campaign.campaign_name\x20=\x20?;';campaignDB['all'](_0x5b8d2b,[_0x34b8fe],(_0x2533c2,_0x207cab)=>{_0x2533c2?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Kampagnendetails:',_0x2533c2),_0x4faf99(_0x2533c2)):(console['log']('ROWS'),console['log'](_0x207cab),debugDatabaseContents(),_0x3e3a1d(_0x207cab));});});});const showTableContents=_0x464ce9=>{return new Promise((_0xcaa3fc,_0x3f5f4c)=>{const _0x2fa3fb='SELECT\x20*\x20FROM\x20'+_0x464ce9+';';campaignDB['all'](_0x2fa3fb,(_0x522827,_0x208f52)=>{_0x522827?(console['error']('Fehler\x20beim\x20Abrufen\x20der\x20Daten\x20aus\x20'+_0x464ce9+':',_0x522827),_0x3f5f4c(_0x522827)):(console['log']('Inhalt\x20der\x20Tabelle\x20'+_0x464ce9+':',_0x208f52),_0xcaa3fc({'status':'success','message':_0x208f52}));});});};async function debugDatabaseContents(){try{console['log']('Inhalt\x20der\x20Tabelle\x20\x27campaign\x27:'),await showTableContents('campaign'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27message\x27:'),await showTableContents('message'),console['log']('Inhalt\x20der\x20Tabelle\x20\x27dm\x27:'),await showTableContents('dm');}catch(_0x35667c){console['error']('Fehler\x20beim\x20Debuggen\x20der\x20Tabelleninhalte:',_0x35667c);}}ipcMain['handle']('create-campaign',async(_0x52fd3f,_0x59bf3b)=>{return new Promise((_0x4c5948,_0x3046da)=>{const _0x11f193='INSERT\x20INTO\x20campaign\x20(campaign_name)\x20VALUES\x20(?)';campaignDB['run'](_0x11f193,[String(_0x59bf3b)],function(_0x583af1){_0x583af1?_0x3046da(_0x583af1):_0x4c5948({'status':'success','message':'Campaign\x20created\x20successfully'});});});}),ipcMain['handle']('delete-campaign',async(_0x80a0ff,_0x1f4702)=>{return new Promise((_0x3243ba,_0x163d61)=>{const _0x4c4e52='DELETE\x20FROM\x20campaign\x20WHERE\x20campaign_name\x20=\x20?';campaignDB['run'](_0x4c4e52,[_0x1f4702],function(_0x34fb17){_0x34fb17?_0x163d61(_0x34fb17):_0x3243ba({'status':'success','message':'Campaign\x20deleted\x20successfully'});});});}),ipcMain['handle']('update-campaign',async(_0x5095dd,_0x44f429,_0x822117,_0x5d8b9,_0x3069f0,_0x3f843b)=>{const _0x2c0961=await createMessageID(_0x3069f0);return new Promise((_0x35e16a,_0x530eae)=>{if(!_0x44f429||!_0x822117||!_0x5d8b9||!_0x2c0961||!_0x3f843b)return _0x530eae({'status':'error','message':'Fehlende\x20Eingabe,\x20bitte\x20prüfen!'});console['log']('Message-ID:\x20'+_0x2c0961);const _0x193328='\x0a\x20\x20\x20\x20\x20\x20UPDATE\x20campaign\x20\x0a\x20\x20\x20\x20\x20\x20SET\x20list_id\x20=\x20?,\x20zeitabstand\x20=\x20?,\x20message_id\x20=\x20?,\x20account\x20=\x20?\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x20campaign_name\x20=\x20?\x0a\x20\x20\x20\x20';campaignDB['run'](_0x193328,[_0x822117,_0x5d8b9,_0x2c0961,_0x3f843b,_0x44f429],function(_0x2b5acf){if(_0x2b5acf)_0x530eae({'status':'error','message':_0x2b5acf['message']});else this['changes']===0x0?_0x530eae({'status':'error','message':'Kein\x20Eintrag\x20gefunden,\x20der\x20aktualisiert\x20werden\x20kann.'}):_0x35e16a({'status':'success','message':'Kampagne\x20erfolgreich\x20aktualisiert!'});});});}),ipcMain['handle']('update-dm',(_0x1286e3,_0xf64c92,_0x5dd1b6,_0x1c2810)=>{return new Promise((_0xd484dd,_0x25f1e4)=>{const _0x4831f2='INSERT\x20INTO\x20dm\x20(message_id,\x20account,\x20username)\x20VALUES\x20(?,\x20?,\x20?)';campaignDB['run'](_0x4831f2,[_0xf64c92,_0x5dd1b6,_0x1c2810],function(_0xcfdd5c){return _0xcfdd5c?(console['error']('Fehler\x20beim\x20Einfügen\x20in\x20die\x20Tabelle\x20\x27dm\x27:',_0xcfdd5c['message']),_0x25f1e4('insert-dm-response',{'success':![],'message':_0xcfdd5c['message']})):(console['log']('Eintrag\x20erfolgreich\x20hinzugefügt:',this['lastID']),_0xd484dd('insert-dm-response',{'success':!![],'message':'Eintrag\x20erfolgreich\x20hinzugefügt'}));});});});const createMessageID=_0x5afa5a=>{return new Promise((_0x87fb42,_0x3a445c)=>{const _0x2c3593='SELECT\x20message_id\x20FROM\x20message\x20WHERE\x20message_text\x20=\x20?';campaignDB['get'](_0x2c3593,[_0x5afa5a],(_0x1b559f,_0x1b58ec)=>{if(_0x1b559f)_0x3a445c({'status':'error','message':_0x1b559f['message']});else{if(_0x1b58ec)_0x87fb42(_0x1b58ec['message_id']);else{const _0x498b5e='INSERT\x20INTO\x20message\x20(message_text)\x20VALUES\x20(?)';campaignDB['run'](_0x498b5e,[_0x5afa5a],function(_0x3cb5d1){_0x3cb5d1?_0x3a445c({'status':'error','message':_0x3cb5d1['message']}):_0x87fb42(this['lastID']);});}}});});};ipcMain['handle']('get-lead_count',async(_0x39685f,_0x2bf2d5)=>{return new Promise((_0x3048f2,_0x53ec79)=>{const _0x222648='SELECT\x20COUNT(*)\x20as\x20count\x20FROM\x20'+_0x2bf2d5;db['get'](_0x222648,(_0x58c1b9,_0x17d50b)=>{_0x58c1b9?_0x53ec79({'status':'error','message':_0x58c1b9['message']}):_0x3048f2({'status':'success','count':_0x17d50b['count']});});});});const dbPath=path['resolve'](__dirname,'data/crm.db'),db=new sqlite3['Database'](dbPath);db['serialize'](()=>{db['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20leads\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT)');});const igaccountsPath=path['resolve'](__dirname,'data/igaccounts.db'),igaccountsDB=new sqlite3['Database'](igaccountsPath);igaccountsDB['serialize'](()=>{igaccountsDB['run']('CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20accounts\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20password\x20TEXT,\x20cookie\x20TEXT)');});async function setCookiesForUser(_0x5012c2,_0x50ea0e){try{const _0x1fc5e7=await new Promise((_0x19287a,_0x560146)=>{igaccountsDB['all']('SELECT\x20cookie\x20FROM\x20accounts\x20WHERE\x20username=?',[_0x50ea0e],(_0x4084df,_0x32d174)=>{if(_0x4084df)_0x560146(_0x4084df);else{if(_0x32d174['length']>0x0){let _0xcf41dd=JSON['parse'](_0x32d174[0x0]['cookie']);console['log'](_0xcf41dd),_0x19287a(_0xcf41dd);}else _0x560146(new Error('User\x20with\x20username\x20'+_0x50ea0e+'\x20does\x20not\x20exist.'));}});});await _0x5012c2['setCookie'](..._0x1fc5e7),console['log']('Cookies\x20were\x20successfully\x20added.');}catch(_0x5e3b9e){console['log']('Cookies\x20konnten\x20nicht\x20hinzugefügt\x20werden:\x20'+_0x5e3b9e);}}async function saveCookiesForUser(_0x1d5c4e,_0x3aea91){try{let _0x5d2312=await _0x1d5c4e['cookies']();_0x5d2312=JSON['stringify'](_0x5d2312),igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x3aea91],(_0x14becc,_0x1c537d)=>{if(_0x14becc){console['error']('Error\x20checking\x20user\x20existence:',_0x14becc);throw _0x14becc;}else{if(_0x1c537d){const _0x49f10d=igaccountsDB['prepare']('UPDATE\x20accounts\x20SET\x20cookie\x20=\x20?\x20WHERE\x20username\x20=\x20?');_0x49f10d['run'](_0x5d2312,_0x3aea91,function(_0x109520){_0x109520?console['error']('Error\x20updating\x20cookies:',_0x109520):console['log']('Cookies\x20updated\x20for\x20user:',_0x3aea91);});}else{const _0x3a2cf8=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20cookie)\x20VALUES\x20(?,\x20?)');_0x3a2cf8['run'](_0x3aea91,_0x5d2312,function(_0x4498aa){_0x4498aa?console['error']('Error\x20inserting\x20new\x20user\x20and\x20cookies:',_0x4498aa):console['log']('New\x20user\x20created\x20and\x20cookies\x20saved\x20for\x20user:',_0x3aea91);});}}});}catch(_0x2beb86){console['error']('Error\x20fetching\x20cookies:',_0x2beb86);throw _0x2beb86;}}async function createUserIfNotExists(_0x31eb32,_0x5f2462){try{igaccountsDB['get']('SELECT\x20username\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?',[_0x31eb32],(_0x4d05a1,_0x3a054a)=>{if(_0x4d05a1){console['error']('Error\x20checking\x20user\x20existence:',_0x4d05a1);throw _0x4d05a1;}else{if(!_0x3a054a){const _0x33f6e0=igaccountsDB['prepare']('INSERT\x20INTO\x20accounts\x20(username,\x20password)\x20VALUES\x20(?,\x20?)');_0x33f6e0['run'](_0x31eb32,_0x5f2462,function(_0x49272b){_0x49272b?console['error']('Error\x20inserting\x20new\x20user:',_0x49272b):console['log']('New\x20user\x20created:',_0x31eb32);});}else console['log']('User\x20already\x20exists:',_0x31eb32);}});}catch(_0x1dfa83){console['error']('Error\x20creating\x20user:',_0x1dfa83);throw _0x1dfa83;}}ipcMain['handle']('create-relation',async(_0x13d895,_0x14f65a)=>{return new Promise((_0x143f9f,_0x38d94b)=>{const _0x225354='CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20'+_0x14f65a+'\x20(username\x20TEXT\x20PRIMARY\x20KEY,\x20clearname\x20TEXT)';db['run'](_0x225354,function(_0x214ddf){_0x214ddf?_0x38d94b(_0x214ddf):_0x143f9f({'status':'success'});});});}),ipcMain['handle']('delete-relation',async(_0x53f4aa,_0x3f9525)=>{return console['log']('droping\x20table'+_0x3f9525),new Promise((_0x2a6c28,_0x3ae9b3)=>{const _0x4f5379='DROP\x20TABLE\x20IF\x20EXISTS\x20'+_0x3f9525;console['log']('droping\x20table'+_0x3f9525),db['run'](_0x4f5379,function(_0x17b56f){_0x17b56f?_0x3ae9b3(_0x17b56f):_0x2a6c28({'status':'success'});});});}),ipcMain['handle']('get-relations',async _0xbeca26=>{return new Promise((_0x1f25e3,_0x56fe15)=>{const _0x13bf2c='SELECT\x20name\x20FROM\x20sqlite_master\x20WHERE\x20type=\x27table\x27';db['all'](_0x13bf2c,[],(_0x2f4ba9,_0x7c0678)=>{_0x2f4ba9?_0x56fe15(_0x2f4ba9):_0x1f25e3(_0x7c0678['map'](_0x2d32a5=>_0x2d32a5['name']));});});}),ipcMain['handle']('add-user',async(_0x251fa2,_0xc51d4e,_0x59548d)=>{return new Promise(_0x3a8c9a=>{const _0x34dbec=db['prepare']('INSERT\x20INTO\x20'+_0x59548d+'\x20(username)\x20VALUES\x20(?)');_0x34dbec['run'](_0xc51d4e,function(_0x269440){_0x269440?console['log']('error\x20in\x20add-user:'+_0x269440):_0x3a8c9a({'status':'success','id':this['lastID']});}),_0x34dbec['finalize']();});}),ipcMain['handle']('get-users',async()=>{return new Promise((_0x32467c,_0x29be4b)=>{db['all']('SELECT\x20*\x20FROM\x20leads',(_0x206d2b,_0x2898d6)=>{if(_0x206d2b)_0x29be4b(_0x206d2b);else{_0x32467c({'status':'success','users':_0x2898d6});for(_0x2898d6 of _0x2898d6){console['log'](_0x2898d6['username']);}}});});}),ipcMain['handle']('get-data',async(_0x3240ed,_0x5e7986)=>{return new Promise((_0x3103f3,_0x3cea93)=>{const _0x7fb276='SELECT\x20*\x20FROM\x20'+_0x5e7986;console['log'](_0x7fb276),db['all'](_0x7fb276,[],(_0x542f8c,_0x3ec7cb)=>{_0x542f8c?_0x3cea93(_0x542f8c):_0x3103f3(_0x3ec7cb);});});}),ipcMain['handle']('get-accounts',async _0x17c9ee=>{return new Promise((_0x25572b,_0x252edf)=>{const _0xa750eb='SELECT\x20*\x20FROM\x20accounts';console['log'](_0xa750eb),igaccountsDB['all'](_0xa750eb,[],(_0x1ece5a,_0x28e6e4)=>{_0x1ece5a?_0x252edf(_0x1ece5a):_0x25572b(_0x28e6e4);});});}),ipcMain['handle']('get-targets',async(_0x181948,_0x18e8e4)=>{return getTargetProfiles(_0x18e8e4);}),ipcMain['handle']('delete-user',async(_0x3a089d,_0x571033,_0x1fe13a)=>{return new Promise((_0x553307,_0x4723c6)=>{const _0x2d45a2=db['prepare']('DELETE\x20FROM\x20'+_0x1fe13a+'\x20WHERE\x20username\x20=\x20?');_0x2d45a2['run'](_0x571033,function(_0x124649){_0x124649?_0x4723c6(_0x124649):_0x553307({'status':'success','changes':this['changes']});}),_0x2d45a2['finalize']();});}),ipcMain['handle']('delete-account',async(_0x339126,_0xbbee78)=>{const _0x2a1cd7=igaccountsDB['prepare']('DELETE\x20FROM\x20accounts\x20WHERE\x20username\x20=\x20?');_0x2a1cd7['run'](_0xbbee78,function(_0x3503c5){_0x3503c5&&console['log'](_0x3503c5);}),_0x2a1cd7['finalize']();}),ipcMain['handle']('get-contacted-count-this-month',async()=>{return new Promise((_0x45595a,_0x4dd68e)=>{const _0x175d27='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20strftime(\x27%Y-%m\x27,\x20date)\x20=\x20strftime(\x27%Y-%m\x27,\x20\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x175d27,[],(_0x47b69c,_0x16f893)=>{_0x47b69c?_0x4dd68e({'status':'error','message':_0x47b69c['message']}):_0x45595a({'status':'success','contactedCount':_0x16f893['contactedCount']});});});}),ipcMain['handle']('get-contacted-count-today',async()=>{return new Promise((_0x1f37d2,_0x8e74ef)=>{const _0x4a478e='\x0a\x20\x20\x20\x20\x20\x20SELECT\x20COUNT(*)\x20as\x20contactedCount\x0a\x20\x20\x20\x20\x20\x20FROM\x20dm\x0a\x20\x20\x20\x20\x20\x20WHERE\x20date(date)\x20=\x20date(\x27now\x27)\x0a\x20\x20\x20\x20';campaignDB['get'](_0x4a478e,[],(_0xb6edc7,_0xc6506c)=>{_0xb6edc7?_0x8e74ef({'status':'error','message':_0xb6edc7['message']}):_0x1f37d2({'status':'success','contactedCount':_0xc6506c['contactedCount']});});});});